{
  "topic_metadata": {
    "id": 2062,
    "title": "How to remove label of an elements?",
    "slug": "how-to-remove-label-of-an-elements",
    "posts_count": 2,
    "created_at": "2024-12-12T13:14:17.164Z",
    "last_posted_at": "2024-12-30T14:14:19.886Z",
    "views": 113,
    "like_count": 0,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "scripting",
      "math"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 477
  },
  "posts": [
    {
      "id": 6554,
      "post_number": 1,
      "username": "Pakorn",
      "name": "Pakorn",
      "created_at": "2024-12-12T13:14:17.399Z",
      "updated_at": "2024-12-12T13:14:17.399Z",
      "cooked": "<p>For example, I have an equation that is printed repeatedly on a presentation. When I want to reference it, the compiler says that the label occurs multiple times in the document.  This is understandable, since the presentation subslides must be printed repeatedly. So I want to remove all of the label after the first subslide is printed, how I can do that?<br>\nI have tried using <code>show math.equation: it =&gt; { .. }</code> but it cannot remove the label without reconstructing the equation. Is there any suggestion?</p>",
      "raw": "For example, I have an equation that is printed repeatedly on a presentation. When I want to reference it, the compiler says that the label occurs multiple times in the document.  This is understandable, since the presentation subslides must be printed repeatedly. So I want to remove all of the label after the first subslide is printed, how I can do that? \nI have tried using `show math.equation: it => { .. }` but it cannot remove the label without reconstructing the equation. Is there any suggestion?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 290.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 819
    },
    {
      "id": 7063,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-30T14:14:19.886Z",
      "updated_at": "2024-12-30T14:16:09.655Z",
      "cooked": "<p>I just created a minimal example based on the <a href=\"https://touying-typ.github.io/docs/start\">Touying docs</a> and had no problem with an equation (or a reference to one) appearing more than once:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/touying:0.5.5\": *\n#import themes.simple: *\n\n#show: simple-theme.with(aspect-ratio: \"16-9\")\n\n#set math.equation(numbering: \"(1)\")\n\n= Title\n\n== First Slide\n\n$ a = b $ &lt;foo&gt;\n\n#pause\n\nHello @foo!\n\n#pause\n\nMore!\n</code></pre>\n<p>So I reproduced the problem manually:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set math.equation(numbering: \"(1)\")\n\n#let eq = [$ a = b $ &lt;foo&gt;]\n\n#eq\n#eq\n\nHello @foo!\n</code></pre>\n<p>When should an equation be labelled? If it is the first appearance of that label in the document, i.e. when there are no occurrences of the label earlier. We can write that like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let eq = context {\n  let raw-eq = $ a = b $\n  let lbl = &lt;foo&gt;\n\n  if query(selector(lbl).before(here())).len() == 0 {\n    [#raw-eq #lbl]\n  } else {\n    raw-eq\n  }\n}\n</code></pre>\n<p>Since you probably want that for multiple equations, it would be nice to put that in a function. In the course of that, I also solve the “it cannot remove the label without reconstructing the equation” problem:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let uniquify(body) = {\n  // content functions for validation\n  let sequence = [a ].func()\n  let space = [ ].func()\n\n  // validate the body to avoid misuse\n  assert.eq(type(body), content, message: \"body is not content but must be an equation\")\n  if body.func() == sequence {\n    // extract the single non-space child, if there is only one\n    let children = body.children.filter(it =&gt; it.func() != space)\n    assert.eq(children.len(), 1, message: \"body is a sequence but must be a single equation\")\n\n    body = children.first()\n  }\n  assert.eq(body.func(), math.equation, message: \"body is not an equation\")\n\n  let (body: eq-body, ..fields) = body.fields()\n  // not labelled, just return the original equation\n  if \"label\" not in fields {\n    return body\n  }\n\n  // we remove the label, so the rest of the fields\n  // can now be used to reconstruct the equation (if needed)\n  let lbl = fields.remove(\"label\")\n  context if query(selector(lbl).before(here())).len() == 0 {\n    // return the original labelled equation\n    body\n  } else {\n    // make a new equation with all the same settings, but without label\n    math.equation(eq-body, ..fields)\n  }\n}\n\n#let eq = uniquify[$ a = b $ &lt;foo&gt;]\n</code></pre>\n<p>This does not fix other issues with displaying the same equation multiple times (especially increasing equation numbers) which Touying also handles, but the narrow subject of the question is solved.</p>",
      "raw": "I just created a minimal example based on the [Touying docs](https://touying-typ.github.io/docs/start) and had no problem with an equation (or a reference to one) appearing more than once:\n\n```typ\n#import \"@preview/touying:0.5.5\": *\n#import themes.simple: *\n\n#show: simple-theme.with(aspect-ratio: \"16-9\")\n\n#set math.equation(numbering: \"(1)\")\n\n= Title\n\n== First Slide\n\n$ a = b $ <foo>\n\n#pause\n\nHello @foo!\n\n#pause\n\nMore!\n```\n\nSo I reproduced the problem manually:\n\n```typ\n#set math.equation(numbering: \"(1)\")\n\n#let eq = [$ a = b $ <foo>]\n\n#eq\n#eq\n\nHello @foo!\n```\n\nWhen should an equation be labelled? If it is the first appearance of that label in the document, i.e. when there are no occurrences of the label earlier. We can write that like this:\n\n```typ\n#let eq = context {\n  let raw-eq = $ a = b $\n  let lbl = <foo>\n\n  if query(selector(lbl).before(here())).len() == 0 {\n    [#raw-eq #lbl]\n  } else {\n    raw-eq\n  }\n}\n```\n\nSince you probably want that for multiple equations, it would be nice to put that in a function. In the course of that, I also solve the \"it cannot remove the label without reconstructing the equation\" problem:\n\n```typ\n#let uniquify(body) = {\n  // content functions for validation\n  let sequence = [a ].func()\n  let space = [ ].func()\n\n  // validate the body to avoid misuse\n  assert.eq(type(body), content, message: \"body is not content but must be an equation\")\n  if body.func() == sequence {\n    // extract the single non-space child, if there is only one\n    let children = body.children.filter(it => it.func() != space)\n    assert.eq(children.len(), 1, message: \"body is a sequence but must be a single equation\")\n\n    body = children.first()\n  }\n  assert.eq(body.func(), math.equation, message: \"body is not an equation\")\n\n  let (body: eq-body, ..fields) = body.fields()\n  // not labelled, just return the original equation\n  if \"label\" not in fields {\n    return body\n  }\n\n  // we remove the label, so the rest of the fields\n  // can now be used to reconstruct the equation (if needed)\n  let lbl = fields.remove(\"label\")\n  context if query(selector(lbl).before(here())).len() == 0 {\n    // return the original labelled equation\n    body\n  } else {\n    // make a new equation with all the same settings, but without label\n    math.equation(eq-body, ..fields)\n  }\n}\n\n#let eq = uniquify[$ a = b $ <foo>]\n```\n\nThis does not fix other issues with displaying the same equation multiple times (especially increasing equation numbers) which Touying also handles, but the narrow subject of the question is solved.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 23.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:53:42.530724"
}
{
  "topic_metadata": {
    "id": 2065,
    "title": "How to export locations through command line query?",
    "slug": "how-to-export-locations-through-command-line-query",
    "posts_count": 4,
    "created_at": "2024-12-12T14:38:43.723Z",
    "last_posted_at": "2024-12-13T21:53:47.401Z",
    "views": 103,
    "like_count": 3,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Hannes",
    "tags": [
      "cli",
      "query"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 241
  },
  "posts": [
    {
      "id": 6558,
      "post_number": 1,
      "username": "jkwchui",
      "name": "Jon Chui",
      "created_at": "2024-12-12T14:38:43.894Z",
      "updated_at": "2024-12-15T10:20:41.900Z",
      "cooked": "<p>I am experimenting with preparing a checklist, and then being able to scan the print and identify whether particular items are checked off.  (Think poor man’s optical multiple choice bubble sheets.)</p>\n<p>To draw and locate the circle is straight-forward:</p>\n<pre><code class=\"lang-auto\">#circle(radius: 10mm)&lt;my_circle&gt;\n\n#context [\n  circle location: #locate(&lt;my_circle&gt;).position()\n]&lt;circle_locator&gt;\n</code></pre>\n<p>However, when I introspect from the command-line using <code>typst query test.typ \"&lt;circle_locator&gt;\"</code>, hoping to be able to pick out a <code>value</code>, it only returns that <code>&lt;circle_locator&gt;</code> is a context.</p>\n<pre><code class=\"lang-auto\">[{\n    \"func\":\"context\", \n    \"label\":\"&lt;circle_locator&gt;\" \n}]\n</code></pre>\n<p>I then tried a variety of more and more contorted wrap in <code>metadata</code> and so on, but it seems what’s inside the context is completely opaque.</p>\n<p><strong>Is there a way to pull out location of objects on the command line query?</strong></p>",
      "raw": "I am experimenting with preparing a checklist, and then being able to scan the print and identify whether particular items are checked off.  (Think poor man's optical multiple choice bubble sheets.)\n\nTo draw and locate the circle is straight-forward:\n\n```\n#circle(radius: 10mm)<my_circle>\n\n#context [\n  circle location: #locate(<my_circle>).position()\n]<circle_locator>\n```\n\nHowever, when I introspect from the command-line using `typst query test.typ \"<circle_locator>\"`, hoping to be able to pick out a `value`, it only returns that `<circle_locator>` is a context.\n\n```\n[{\n    \"func\":\"context\", \n    \"label\":\"<circle_locator>\" \n}]\n```\n\nI then tried a variety of more and more contorted wrap in `metadata` and so on, but it seems what's inside the context is completely opaque.\n\n**Is there a way to pull out location of objects on the command line query?**",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 155.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 254
    },
    {
      "id": 6561,
      "post_number": 2,
      "username": "Hannes",
      "name": "Hannes",
      "created_at": "2024-12-12T17:45:59.599Z",
      "updated_at": "2024-12-12T19:36:18.645Z",
      "cooked": "<p>Hi, the following should work:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#circle(radius: 10mm)&lt;my_circle&gt;\n\n#context [\n  // Just wrap it inside anything that can be queried\n  #metadata(\n    (\n      circle-location: locate(&lt;my_circle&gt;).position()\n    )\n  )&lt;circle_locator&gt; // Moved the label inside of the context block\n]\n</code></pre>\n<p>Giving the following output:</p>\n<pre data-code-wrap=\"bash\"><code class=\"lang-bash\">typst query tmp.typ '&lt;circle_locator&gt;'\n[{\n  \"func\" : \"metadata\",\n  \"value\" : {\n    \"circle-location\" : {\n      \"page\" : 1,\n      \"x\" : \"70.87pt\",\n      \"y\" : \"70.87pt\"\n    }\n  },\n  \"label\" : \"&lt;circle_locator&gt;\"\n}]\n</code></pre>",
      "raw": "Hi, the following should work:\n```typ\n#circle(radius: 10mm)<my_circle>\n\n#context [\n  // Just wrap it inside anything that can be queried\n  #metadata(\n    (\n      circle-location: locate(<my_circle>).position()\n    )\n  )<circle_locator> // Moved the label inside of the context block\n]\n```\nGiving the following output:\n```bash\ntypst query tmp.typ '<circle_locator>'\n[{\n  \"func\" : \"metadata\",\n  \"value\" : {\n    \"circle-location\" : {\n      \"page\" : 1,\n      \"x\" : \"70.87pt\",\n      \"y\" : \"70.87pt\"\n    }\n  },\n  \"label\" : \"<circle_locator>\"\n}]\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 25,
      "score": 75.0,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 922
    },
    {
      "id": 6573,
      "post_number": 3,
      "username": "jkwchui",
      "name": "Jon Chui",
      "created_at": "2024-12-13T01:32:23.834Z",
      "updated_at": "2024-12-13T01:32:23.834Z",
      "cooked": "<p>Thank you!</p>\n<p>What is the inner parenthesis doing inside the <code>metatdata()</code>?</p>",
      "raw": "Thank you!\n\nWhat is the inner parenthesis doing inside the `metatdata()`?",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 14.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 254
    },
    {
      "id": 6613,
      "post_number": 4,
      "username": "Hannes",
      "name": "Hannes",
      "created_at": "2024-12-13T21:53:47.401Z",
      "updated_at": "2024-12-13T21:53:47.401Z",
      "cooked": "<p>The inner expression creates a <a href=\"https://typst.app/docs/reference/foundations/dictionary/\">dictionary</a>, in this case with the single key <code>circle-location</code>. I was just mimicking the text you had before. You could also put the location directly into the metadata.</p>",
      "raw": "The inner expression creates a [dictionary](https://typst.app/docs/reference/foundations/dictionary/), in this case with the single key `circle-location`. I was just mimicking the text you had before. You could also put the location directly into the metadata.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 19,
      "score": 23.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 922
    }
  ],
  "scraped_at": "2025-06-10T09:53:41.811512"
}
{
  "topic_metadata": {
    "id": 2070,
    "title": "How to Draw a Custom Mark at Specific Points on the CetZ Canvas?",
    "slug": "how-to-draw-a-custom-mark-at-specific-points-on-the-cetz-canvas",
    "posts_count": 5,
    "created_at": "2024-12-12T20:01:50.963Z",
    "last_posted_at": "2025-06-06T00:34:03.588Z",
    "views": 394,
    "like_count": 2,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "jwolf",
    "tags": [
      "graphics",
      "cetz"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 255
  },
  "posts": [
    {
      "id": 6564,
      "post_number": 1,
      "username": "Raul_Durand",
      "name": "Raul Durand",
      "created_at": "2024-12-12T20:01:51.116Z",
      "updated_at": "2024-12-15T10:19:26.282Z",
      "cooked": "<p>Hi everyone!</p>\n<p>I’m trying to draw individual marks, such as a circle, at specific points on a canvas. However, I’ve run into a challenge: it seems there’s no direct way to place a mark exactly where I want.</p>\n<p>Initially, I tried drawing an invisible line with a mark at the endpoint, but the mark doesn’t align precisely with the line’s endpoint coordinates. As a temporary solution, I used a Unicode character for the mark, as shown below:</p>\n<pre><code class=\"lang-auto\">content(X, anchor:\"center\", text(size:size, fill:color)[⬤])\n</code></pre>\n<p>This works, but it doesn’t scale properly when I change the canvas scale.</p>\n<p>Is there a better way to achieve this? Any advice would be greatly appreciated!</p>\n<p>Thanks in advance!</p>",
      "raw": "Hi everyone!\n\nI’m trying to draw individual marks, such as a circle, at specific points on a canvas. However, I’ve run into a challenge: it seems there’s no direct way to place a mark exactly where I want.\n\nInitially, I tried drawing an invisible line with a mark at the endpoint, but the mark doesn’t align precisely with the line’s endpoint coordinates. As a temporary solution, I used a Unicode character for the mark, as shown below:\n```\ncontent(X, anchor:\"center\", text(size:size, fill:color)[⬤])\n```\nThis works, but it doesn’t scale properly when I change the canvas scale.\n\nIs there a better way to achieve this? Any advice would be greatly appreciated!\n\nThanks in advance!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 53,
      "score": 1405.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 583
    },
    {
      "id": 6615,
      "post_number": 2,
      "username": "jwolf",
      "name": "Johannes Wolf",
      "created_at": "2024-12-14T00:37:43.494Z",
      "updated_at": "2024-12-14T00:38:33.724Z",
      "cooked": "<p>Using marks <code>anchor</code> style-attribute (possible values are: <code>center</code>, <code>tip</code>, <code>base</code>), you should be able to control the positioning:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#canvas({\n  import draw: *\n\n  grid((-1,-1), (1,1), stroke: .25pt + gray)\n\n  //            ,---- Direction to point at\n  mark((0, 0), (1,0), symbol: \"o\", anchor: \"center\")\n  //   ^--- Position of the mark\n})\n</code></pre>\n<p>Gives:<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/c/c4d6b2a9700ba6f354f1b95b2ba55fce8bb69ffa.png\" alt=\"grafik\" data-base62-sha1=\"s5jzu2WwIg1dAd5KmvelnxRcQ4y\" width=\"334\" height=\"325\"></p>",
      "raw": "Using marks `anchor` style-attribute (possible values are: `center`, `tip`, `base`), you should be able to control the positioning:\n```typst\n#canvas({\n  import draw: *\n\n  grid((-1,-1), (1,1), stroke: .25pt + gray)\n\n  //            ,---- Direction to point at\n  mark((0, 0), (1,0), symbol: \"o\", anchor: \"center\")\n  //   ^--- Position of the mark\n})\n```\n\nGives:\n![grafik|334x325](upload://s5jzu2WwIg1dAd5KmvelnxRcQ4y.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 49,
      "score": 209.6,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 72
    },
    {
      "id": 13604,
      "post_number": 3,
      "username": "Raul_Durand",
      "name": "Raul Durand",
      "created_at": "2025-06-02T22:17:53.011Z",
      "updated_at": "2025-06-02T22:17:53.011Z",
      "cooked": "<p>Very cool. Now, is there a way to avoid the transformation on marks after a rotation?</p>\n<p>In a 3d view, I get a perspective of the mark but I would like to see an actual circle.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/f/f8d20e8900142cf23501ebec64c8d8d6ae85c419.png\" data-download-href=\"https://forum.typst.app/uploads/default/f8d20e8900142cf23501ebec64c8d8d6ae85c419\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/original/2X/f/f8d20e8900142cf23501ebec64c8d8d6ae85c419.png\" alt=\"image\" data-base62-sha1=\"zvaslDHG4AJjx8SxwT6XMtvukop\" width=\"549\" height=\"400\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">549×400 3.95 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "Very cool. Now, is there a way to avoid the transformation on marks after a rotation?\n\nIn a 3d view, I get a perspective of the mark but I would like to see an actual circle.\n\n![image|549x400](upload://zvaslDHG4AJjx8SxwT6XMtvukop.png)",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 3.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 583
    },
    {
      "id": 13605,
      "post_number": 4,
      "username": "Mathemensch",
      "name": "Alexander Schulz",
      "created_at": "2025-06-02T23:10:14.244Z",
      "updated_at": "2025-06-02T23:10:14.244Z",
      "cooked": "<p>You can find a solution here:</p><aside class=\"quote\" data-post=\"2\" data-topic=\"2312\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/sillyfreak/48/1483_2.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/how-to-prevent-2d-shapes-from-being-distorted-in-a-3d-cetz-coordinate-system/2312/2\">How to prevent 2D shapes from being distorted in a 3D CetZ coordinate system?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    I think that means that you want to effectively want to draw on the xy plane: <a href=\"https://cetz-package.github.io/docs/api/draw-functions/projections/on-xy\" class=\"inline-onebox\">on-xy | CeTZ Documentation</a> \nif you want a circle at (x, y, z), you would use on-xy(z: z, circle((x, y))). (Admittedly I didn’t test it, if it doesn’t work could you include a minimal example so that it’s easier to test further attempts?)\n  </blockquote>\n</aside>\n",
      "raw": "You can find a solution here:\nhttps://forum.typst.app/t/how-to-prevent-2d-shapes-from-being-distorted-in-a-3d-cetz-coordinate-system/2312/2?u=mathemensch",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 23.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 307
    },
    {
      "id": 13801,
      "post_number": 5,
      "username": "Raul_Durand",
      "name": "Raul Durand",
      "created_at": "2025-06-06T00:34:03.588Z",
      "updated_at": "2025-06-06T00:34:03.588Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/mathemensch\">@Mathemensch</a> that thread is for shapes, not for marks.</p>",
      "raw": "@Mathemensch that thread is for shapes, not for marks.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 14,
      "score": 2.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 583
    }
  ],
  "scraped_at": "2025-06-10T09:53:40.990814"
}
{
  "topic_metadata": {
    "id": 2078,
    "title": "How to get the entire title when referencing headings?",
    "slug": "how-to-get-the-entire-title-when-referencing-headings",
    "posts_count": 2,
    "created_at": "2024-12-13T06:27:11.846Z",
    "last_posted_at": "2024-12-13T07:02:53.992Z",
    "views": 242,
    "like_count": 0,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 217
  },
  "posts": [
    {
      "id": 6577,
      "post_number": 1,
      "username": "Akshay_Raj_Gollahall",
      "name": "Akshay Raj Gollahalli",
      "created_at": "2024-12-13T06:27:11.982Z",
      "updated_at": "2024-12-13T06:57:40.050Z",
      "cooked": "<p>For example, here is a code that references a title:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set heading(numbering: \"1.\")\n\n== Colours &lt;sub:colours&gt;\n\n@sub:colours is a title\n</code></pre>\n<p>Instead of referencing as <code>Section 0.1 is a title</code> can I get something like - <code>Colours is a title</code>?</p>",
      "raw": "For example, here is a code that references a title:\n\n```typ\n#set heading(numbering: \"1.\")\n\n== Colours <sub:colours>\n\n@sub:colours is a title\n```\n\nInstead of referencing as `Section 0.1 is a title` can I get something like - `Colours is a title`?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 37,
      "score": 947.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 106
    },
    {
      "id": 6578,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-13T07:02:53.992Z",
      "updated_at": "2024-12-13T07:02:53.992Z",
      "cooked": "<p>Hello!<br>\nI have changed your question to “How to get the entire title when referencing headings?”, if that’s wrong, please correct it!</p>\n<p>The syntax <code>@label</code> is called a reference. See <a href=\"https://typst.app/docs/reference/model/ref/\"><code>ref</code></a> for more details, and in particular, you can read the section on <a href=\"https://typst.app/docs/reference/model/ref/#:~:text=Chapter%5D.-,Customization,-If%20you%20write\">Customization</a>.</p>\n<p>Inspecting the content of <code>it</code> inside the conditional statement, gives you</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">ref(\n    target: &lt;sub:colours&gt;,\n    supplement: auto, \n    form: \"normal\",\n    citation: cite(key: &lt;sub:colours&gt;, supplement: none),\n    element: heading(\n        level: 2,\n        depth: 2,\n        offset: 0,\n        numbering: \"1.\",\n        supplement: [Section],\n        outlined: true,\n        bookmarked: auto,\n        hanging-indent: auto,\n        body: [Colours],\n    ),\n)\n</code></pre>\n<p>where you can see that the <code>heading</code> is in fact the <code>element</code> of <code>ref</code> (<code>it</code>). Accessing the title of the heading is as simple as writing <code>it.element.body</code>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set heading(numbering: \"1.\")\n#show ref: it =&gt; {\n  let el = it.element\n  if el != none and el.func() == heading {\n    link(el.location(), el.body)\n  }\n}\n== Colours &lt;sub:colours&gt;\n@sub:colours is a title\n</code></pre>",
      "raw": "Hello!\nI have changed your question to \"How to get the entire title when referencing headings?\", if that's wrong, please correct it!\n\nThe syntax `@label` is called a reference. See [`ref`](https://typst.app/docs/reference/model/ref/) for more details, and in particular, you can read the section on [Customization](https://typst.app/docs/reference/model/ref/#:~:text=Chapter%5D.-,Customization,-If%20you%20write).\n\nInspecting the content of `it` inside the conditional statement, gives you\n\n```typ\nref(\n    target: <sub:colours>,\n    supplement: auto, \n    form: \"normal\",\n    citation: cite(key: <sub:colours>, supplement: none),\n    element: heading(\n        level: 2,\n        depth: 2,\n        offset: 0,\n        numbering: \"1.\",\n        supplement: [Section],\n        outlined: true,\n        bookmarked: auto,\n        hanging-indent: auto,\n        body: [Colours],\n    ),\n)\n```\n\nwhere you can see that the `heading` is in fact the `element` of `ref` (`it`). Accessing the title of the heading is as simple as writing `it.element.body`.\n\n```typ\n#set heading(numbering: \"1.\")\n#show ref: it => {\n  let el = it.element\n  if el != none and el.func() == heading {\n    link(el.location(), el.body)\n  }\n}\n== Colours <sub:colours>\n@sub:colours is a title\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 36,
      "score": 52.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    }
  ],
  "scraped_at": "2025-06-10T09:53:40.287264"
}
{
  "topic_metadata": {
    "id": 2080,
    "title": "How to conditionally set heading block parameters?",
    "slug": "how-to-conditionally-set-heading-block-parameters",
    "posts_count": 5,
    "created_at": "2024-12-13T10:26:21.846Z",
    "last_posted_at": "2025-04-13T14:09:22.460Z",
    "views": 355,
    "like_count": 10,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "sjfhsjfh",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 575
  },
  "posts": [
    {
      "id": 6582,
      "post_number": 1,
      "username": "Amman_Algenib",
      "name": "Amman",
      "created_at": "2024-12-13T10:26:22.003Z",
      "updated_at": "2024-12-13T10:26:22.003Z",
      "cooked": "<p>Hello typstologists,</p>\n<p>I am struggeling to come up with a conditional setting for block parameters in headings. In detail, a heading of level 1 should be shown as follows:</p>\n<pre><code class=\"lang-auto\">#show heading.where(level:1): it =&gt; {\n  set block(above: 2em)\n  it\n}\n</code></pre>\n<p>The heading of level 2 should be shown as follows:</p>\n<pre><code class=\"lang-auto\">#show heading.where(level: 2): it =&gt; {\n  set block(above: 2em)\n  it\n}\n</code></pre>\n<p>However, whenever a level-1-heading directly precedes a level-2-heading I want the <code>above</code> parameter of the latter to be just <code>0.4em</code> as in the following reprex:</p>\n<pre><code class=\"lang-auto\">Random stuff being written here.\n\n= A brilliant level 1 heading\n== followed directly by a mediocre level 2 heading\nThis being followed by some random text.\n</code></pre>\n<p>Of course, I could set the <code>above</code> parameter of the level-2-heading accordingly whenever the above mentioned situation occurs, but I was looking for a smarter solution. <em>Is it possible to formulate a conditional <code>show</code> rule in which I could tell typst “show level-2-heading like this, whenever a level-1-heading preceeds”?</em></p>\n<p>Happy to tap your brains and many thanks in advance<br>\nAmman</p>",
      "raw": "Hello typstologists,\n\nI am struggeling to come up with a conditional setting for block parameters in headings. In detail, a heading of level 1 should be shown as follows:\n\n```\n#show heading.where(level:1): it => {\n  set block(above: 2em)\n  it\n}\n```\n\nThe heading of level 2 should be shown as follows:\n```\n#show heading.where(level: 2): it => {\n  set block(above: 2em)\n  it\n}\n```\n\nHowever, whenever a level-1-heading directly precedes a level-2-heading I want the `above` parameter of the latter to be just `0.4em` as in the following reprex:\n\n```\nRandom stuff being written here.\n\n= A brilliant level 1 heading\n== followed directly by a mediocre level 2 heading\nThis being followed by some random text.\n```\n\nOf course, I could set the `above` parameter of the level-2-heading accordingly whenever the above mentioned situation occurs, but I was looking for a smarter solution. *Is it possible to formulate a conditional `show` rule in which I could tell typst \"show level-2-heading like this, whenever a level-1-heading preceeds\"?*\n\nHappy to tap your brains and many thanks in advance\nAmman",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 49,
      "score": 1074.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 926
    },
    {
      "id": 6610,
      "post_number": 2,
      "username": "miles-1",
      "name": "miles",
      "created_at": "2024-12-13T17:27:42.036Z",
      "updated_at": "2024-12-13T17:27:42.036Z",
      "cooked": "<p>I’ve thought about this as well (e.g., <a href=\"https://forum.typst.app/t/how-to-have-first-line-indent-in-a-new-paragraph-after-a-math-block/1985/2\">this post</a> where I was hoping to add spacing conditional on what followed the content). I think such conditional typesetting is currently not very easy in Typst. If it were to be done via show rules, I think there would have to be something like a <code>next()</code> function that can be used with <code>context</code> to find what the next element is that follows the current one.</p>\n<p>Perhaps there is some way to do this that I’m unaware of (maybe with <code>query</code>), or maybe such functionality is in the works already? Regardless, the best way I can think of solving your issue is to pass all content of the document to a function, which checks the content and inserts spacing around headers conditionally, like below. <strong>This code abuses <code>repr</code> and sidesteps Typst’s normal structure for showing. It should not be used.</strong></p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let get_header_depth(elem) = {\n  if repr(elem.func()) == \"heading\" { // this abuses repr and should not be used but I don't know an alternative\n    return elem.depth\n  }\n  return none\n}\n\n#let add_conditional_header_spaces(txt) = {\n  if not txt.has(\"children\") {return txt}\n  let elems = txt.children.filter(x =&gt; x != [ ])\n  for (indx, elem) in elems.enumerate() {\n    if get_header_depth(elem) == 1 {\n      if indx != elems.len() - 1 and get_header_depth(elems.at(indx + 1)) == 2 {\n        [#elem \\[SMALL SPACE HERE\\] ]\n      } else {\n        [#elem \\[LARGE SPACE HERE\\] ]\n      }\n    } else {\n      elem\n    }\n  }\n}\n\n#add_conditional_header_spaces[= hello\n#lorem(10)\n\n= goodbye\n== a subheading\n#lorem(10)\n\n= foo\n#lorem(10)\n== a subheading\n#lorem(10)]\n</code></pre>\n<p>If anyone has suggestions on how conditional <code>set</code>ing or <code>show</code>ing might be completed based off of neighboring elements I would love to hear it.</p>",
      "raw": "I've thought about this as well (e.g., [this post](https://forum.typst.app/t/how-to-have-first-line-indent-in-a-new-paragraph-after-a-math-block/1985/2?u=miles-1) where I was hoping to add spacing conditional on what followed the content). I think such conditional typesetting is currently not very easy in Typst. If it were to be done via show rules, I think there would have to be something like a `next()` function that can be used with `context` to find what the next element is that follows the current one.\n\nPerhaps there is some way to do this that I'm unaware of (maybe with `query`), or maybe such functionality is in the works already? Regardless, the best way I can think of solving your issue is to pass all content of the document to a function, which checks the content and inserts spacing around headers conditionally, like below. **This code abuses `repr` and sidesteps Typst's normal structure for showing. It should not be used.**\n\n```typst\n#let get_header_depth(elem) = {\n  if repr(elem.func()) == \"heading\" { // this abuses repr and should not be used but I don't know an alternative\n    return elem.depth\n  }\n  return none\n}\n\n#let add_conditional_header_spaces(txt) = {\n  if not txt.has(\"children\") {return txt}\n  let elems = txt.children.filter(x => x != [ ])\n  for (indx, elem) in elems.enumerate() {\n    if get_header_depth(elem) == 1 {\n      if indx != elems.len() - 1 and get_header_depth(elems.at(indx + 1)) == 2 {\n        [#elem \\[SMALL SPACE HERE\\] ]\n      } else {\n        [#elem \\[LARGE SPACE HERE\\] ]\n      }\n    } else {\n      elem\n    }\n  }\n}\n\n#add_conditional_header_spaces[= hello\n#lorem(10)\n\n= goodbye\n== a subheading\n#lorem(10)\n\n= foo\n#lorem(10)\n== a subheading\n#lorem(10)]\n```\n\nIf anyone has suggestions on how conditional `set`ing or `show`ing might be completed based off of neighboring elements I would love to hear it.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 43,
      "score": 138.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 177
    },
    {
      "id": 6635,
      "post_number": 3,
      "username": "sjfhsjfh",
      "name": "sjfhsjfh",
      "created_at": "2024-12-14T18:36:35.283Z",
      "updated_at": "2024-12-14T18:36:50.210Z",
      "cooked": "<p>According to the <a href=\"https://typst.app/docs/reference/layout/v/#parameters-weak\">documentation</a>, weak spacings will always collapse adjacent paragraph spacing, even if the paragraph spacing is larger. I guess this is also the case for <code>heading</code> block spacing.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading: it =&gt; {\n  set block(above: 2em)\n  it\n  v(0.4em, weak: true)\n}\n</code></pre>",
      "raw": "According to the [documentation](https://typst.app/docs/reference/layout/v/#parameters-weak), weak spacings will always collapse adjacent paragraph spacing, even if the paragraph spacing is larger. I guess this is also the case for `heading` block spacing.\n\n```typ\n#show heading: it => {\n  set block(above: 2em)\n  it\n  v(0.4em, weak: true)\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 5,
      "reads": 39,
      "score": 117.8,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 120
    },
    {
      "id": 6641,
      "post_number": 4,
      "username": "Amman_Algenib",
      "name": "Amman",
      "created_at": "2024-12-15T07:49:38.685Z",
      "updated_at": "2024-12-15T07:50:06.611Z",
      "cooked": "<p>Sometimes life can be so simple <img src=\"https://forum.typst.app/images/emoji/apple/sunrise.png?v=12\" title=\":sunrise:\" class=\"emoji\" alt=\":sunrise:\" loading=\"lazy\" width=\"20\" height=\"20\">. How could I forget about weak spacings. Thanks a lot for your answer, <a class=\"mention\" href=\"/u/sjfhsjfh\">@sjfhsjfh</a> . That solved the issue.</p>",
      "raw": "Sometimes life can be so simple :sunrise:. How could I forget about weak spacings. Thanks a lot for your answer, @sjfhsjfh . That solved the issue.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 36,
      "score": 37.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 926
    },
    {
      "id": 10986,
      "post_number": 5,
      "username": "akoller",
      "name": "Alexander Koller",
      "created_at": "2025-04-13T14:09:22.460Z",
      "updated_at": "2025-04-13T14:09:22.460Z",
      "cooked": "<p>What an excellent and absurdly simple solution for a problem that I, too, have struggled with for months. Thanks!</p>",
      "raw": "What an excellent and absurdly simple solution for a problem that I, too, have struggled with for months. Thanks!",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 4.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1363
    }
  ],
  "scraped_at": "2025-06-10T09:53:39.590197"
}
{
  "topic_metadata": {
    "id": 2086,
    "title": "How to reset the line number counter?",
    "slug": "how-to-reset-the-line-number-counter",
    "posts_count": 5,
    "created_at": "2024-12-13T22:25:02.521Z",
    "last_posted_at": "2024-12-15T20:40:59.990Z",
    "views": 283,
    "like_count": 3,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "PgBiel",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 540
  },
  "posts": [
    {
      "id": 6614,
      "post_number": 1,
      "username": "Timo",
      "name": "Timo",
      "created_at": "2024-12-13T22:25:02.640Z",
      "updated_at": "2024-12-15T06:59:20.916Z",
      "cooked": "<p>Hello,</p>\n<p>I am currently writing a document where I have some appendix which requires to be have line numbers. Unfortunately, I have 4 chapters which need line numbers individually (each chapter starting from 1 again). I know this might be possible with raw text, but I really would like to use normal text and just reset the counter if possible.</p>\n<p>What I tried was using <code>#set par.line(numbering-scope: \"page\")</code>, but this resulted in the start of new numbers on every new page. This does not work for me, because my content is longer than one page. I also tried resetting the counter like so <code>#counter(par.line).update(0)</code>, but this did not have any effect as well.</p>\n<p>Did any of you faced this issue before or know a solution to my problem?</p>\n<p>Thanks!</p>",
      "raw": "Hello,\n\nI am currently writing a document where I have some appendix which requires to be have line numbers. Unfortunately, I have 4 chapters which need line numbers individually (each chapter starting from 1 again). I know this might be possible with raw text, but I really would like to use normal text and just reset the counter if possible.\n\nWhat I tried was using `#set par.line(numbering-scope: \"page\")`, but this resulted in the start of new numbers on every new page. This does not work for me, because my content is longer than one page. I also tried resetting the counter like so `#counter(par.line).update(0)`, but this did not have any effect as well.\n\nDid any of you faced this issue before or know a solution to my problem?\n\nThanks!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 42,
      "score": 1133.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 130
    },
    {
      "id": 6616,
      "post_number": 2,
      "username": "ParaN3xus",
      "name": "ParaN3xus",
      "created_at": "2024-12-14T03:12:46.880Z",
      "updated_at": "2024-12-14T03:12:46.880Z",
      "cooked": "<p>I think this is currently not possible. According to the <a href=\"https://github.com/typst/typst/blob/a3ad0a0bba3ce3abb1d8ed84656f54cc2d74be25/crates/typst-layout/src/flow/compose.rs#L836\">comments</a> for <code>layout-line-number</code> in <code>crates/typst-layout/src/flow/compose.rs</code> , the <code>par.line</code> counter is currently different from normal counters, so this counter is not exposed to users through <code>counter(par.line)</code> or any other means.</p>",
      "raw": "I think this is currently not possible. According to the [comments](https://github.com/typst/typst/blob/a3ad0a0bba3ce3abb1d8ed84656f54cc2d74be25/crates/typst-layout/src/flow/compose.rs#L836) for `layout-line-number` in `crates/typst-layout/src/flow/compose.rs` , the `par.line` counter is currently different from normal counters, so this counter is not exposed to users through `counter(par.line)` or any other means.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 40,
      "score": 73.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 14
    },
    {
      "id": 6639,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-15T07:01:36.568Z",
      "updated_at": "2024-12-15T07:01:36.568Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/timo\">@Timo</a>, welcome to the forum! In addition to adding a tag to your post, I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Timo, welcome to the forum! In addition to adding a tag to your post, I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 34,
      "score": 36.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6640,
      "post_number": 4,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-15T07:11:56.449Z",
      "updated_at": "2024-12-15T07:11:56.449Z",
      "cooked": "<p>As explained by <a class=\"mention\" href=\"/u/paran3xus\">@ParaN3xus</a> above, this is not currently possible due to technical limitations in the compiler. However, <strong>you can do it manually,</strong> if you don’t mind adding some extra code before your chapters. Note that this extra code <strong>has to be updated for a chapter each time you add more text to the previous chapter,</strong> so there’s a bit of a maintenance burden, but it can at least provide the results you are expecting.</p>\n<p>The core idea is that you will add the following code before each chapter:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// N is the last line number in the previous chapter\n#show: reset-line-numbers-from(N)\n</code></pre>\n<p>You will have to update N manually as you add more lines. (You don’t have to do this all the time - you can choose to only do it when exporting, for example.)</p>\n<p>Here’s the code, and some sample usage:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// /!\\ Pick your numbering format here /!\\\n#let num-format = \"1.\"\n#set par.line(numbering: num-format)\n\n#let reset-line-numbers-from(n, format: num-format) = doc =&gt; context {\n  let previous-n = counter(\"par-line-reset\").get().first()\n  set par.line(numbering: line =&gt; numbering(format, line - n - previous-n))\n  counter(\"par-line-reset\").update(count =&gt; count + n)\n  doc\n}\n\n// Sample usage:\n\n= ABC\n\nHello world\n\n// Replace '2' with the last line number before here\n#show: reset-line-numbers-from(2)\n\n= Other chapter\n\nHello\n\nworld \\\na \\\na \\\na \\\nb\n\n// Line number of 'b' was 7\n#show: reset-line-numbers-from(7)\n\n= My own chapter\n\nThis\n\nis a\n\nchapter\n\n#show: reset-line-numbers-from(4)\n\n= My own chapter\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/1/1debb74af9ef1738f05281279096fda6b3973b19.png\" alt=\"output: line numbers reset at each chapter\" data-base62-sha1=\"4gGRGcC4kkgDbdRsq2q8GLFMiBH\" width=\"284\" height=\"472\"></p>",
      "raw": "As explained by @ParaN3xus above, this is not currently possible due to technical limitations in the compiler. However, **you can do it manually,** if you don't mind adding some extra code before your chapters. Note that this extra code **has to be updated for a chapter each time you add more text to the previous chapter,** so there's a bit of a maintenance burden, but it can at least provide the results you are expecting.\n\nThe core idea is that you will add the following code before each chapter:\n\n```typ\n// N is the last line number in the previous chapter\n#show: reset-line-numbers-from(N)\n```\n\nYou will have to update N manually as you add more lines. (You don't have to do this all the time - you can choose to only do it when exporting, for example.)\n\nHere's the code, and some sample usage:\n\n```typ\n// /!\\ Pick your numbering format here /!\\\n#let num-format = \"1.\"\n#set par.line(numbering: num-format)\n\n#let reset-line-numbers-from(n, format: num-format) = doc => context {\n  let previous-n = counter(\"par-line-reset\").get().first()\n  set par.line(numbering: line => numbering(format, line - n - previous-n))\n  counter(\"par-line-reset\").update(count => count + n)\n  doc\n}\n\n// Sample usage:\n\n= ABC\n\nHello world\n\n// Replace '2' with the last line number before here\n#show: reset-line-numbers-from(2)\n\n= Other chapter\n\nHello\n\nworld \\\na \\\na \\\na \\\nb\n\n// Line number of 'b' was 7\n#show: reset-line-numbers-from(7)\n\n= My own chapter\n\nThis\n\nis a\n\nchapter\n\n#show: reset-line-numbers-from(4)\n\n= My own chapter\n```\n\n![output: line numbers reset at each chapter|284x472](upload://4gGRGcC4kkgDbdRsq2q8GLFMiBH.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 32,
      "score": 46.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6661,
      "post_number": 5,
      "username": "Timo",
      "name": "Timo",
      "created_at": "2024-12-15T20:40:59.990Z",
      "updated_at": "2024-12-15T20:40:59.990Z",
      "cooked": "<p>Thanks, I will make sure next time <img src=\"https://forum.typst.app/images/emoji/apple/smiley.png?v=12\" title=\":smiley:\" class=\"emoji\" alt=\":smiley:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Thanks, I will make sure next time :smiley:",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 4.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 130
    }
  ],
  "scraped_at": "2025-06-10T09:53:38.850244"
}
{
  "topic_metadata": {
    "id": 2093,
    "title": "How to add colored underline in the math mode?",
    "slug": "how-to-add-colored-underline-in-the-math-mode",
    "posts_count": 5,
    "created_at": "2024-12-14T12:27:52.998Z",
    "last_posted_at": "2024-12-15T11:48:41.735Z",
    "views": 216,
    "like_count": 4,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "sjfhsjfh",
    "tags": [
      "math",
      "graphics"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 278
  },
  "posts": [
    {
      "id": 6625,
      "post_number": 1,
      "username": "Ignat",
      "name": "Ignat",
      "created_at": "2024-12-14T12:27:53.396Z",
      "updated_at": "2024-12-14T12:27:53.396Z",
      "cooked": "<p>Hello, I want to underline parts of math equation with colorful strokes but sadly function <a class=\"hashtag-cooked\" href=\"/tag/math\" data-type=\"tag\" data-slug=\"math\" data-id=\"74\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>math</span></a>.underline only accepts body as a parameter. Is there a way to do it or a package implementing it?</p>",
      "raw": "Hello, I want to underline parts of math equation with colorful strokes but sadly function #math.underline only accepts body as a parameter. Is there a way to do it or a package implementing it?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 766.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 934
    },
    {
      "id": 6634,
      "post_number": 2,
      "username": "sjfhsjfh",
      "name": "sjfhsjfh",
      "created_at": "2024-12-14T18:21:35.896Z",
      "updated_at": "2024-12-14T18:21:35.896Z",
      "cooked": "<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show math.underline: set text(fill: red)\n</code></pre>",
      "raw": "```typ\n#show math.underline: set text(fill: red)\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 30.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 120
    },
    {
      "id": 6643,
      "post_number": 3,
      "username": "Ignat",
      "name": "Ignat",
      "created_at": "2024-12-15T10:08:13.831Z",
      "updated_at": "2024-12-15T10:08:13.831Z",
      "cooked": "<p>Thanks, this has particially helped me.<br>\nHow can I filter different math content for underline? Cause I want to have underlines of different color in one equation.</p>\n<p>That is what I’ve tried to do:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#show math.underline.where([$2 A_2$]): set text(fill: blue)\n$ underline(2 A_2) + A_2 x^2 + A_1 x + A_0 = x^2 - 1 $\n$ cases(A_2 = 1\\ A_1 = 0\\ 2 A_2 + A_0 = -1) &lt;=&gt; cases(A_2 = 1\\ A_1 = 0\\ A_0 = -3) $\n</code></pre>\n<p>But I can’t understand how to manage with “where” if the function(“math.underline”) has only one unnamed argument “content” and it has kind of mathematical type.</p>",
      "raw": "Thanks, this has particially helped me.\nHow can I filter different math content for underline? Cause I want to have underlines of different color in one equation.\n\nThat is what I've tried to do:\n```typst\n#show math.underline.where([$2 A_2$]): set text(fill: blue)\n$ underline(2 A_2) + A_2 x^2 + A_1 x + A_0 = x^2 - 1 $\n$ cases(A_2 = 1\\ A_1 = 0\\ 2 A_2 + A_0 = -1) <=> cases(A_2 = 1\\ A_1 = 0\\ A_0 = -3) $\n```\nBut I can't understand how to manage with \"where\" if the function(\"math.underline\") has only one unnamed argument \"content\" and it has kind of mathematical type.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 14.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 934
    },
    {
      "id": 6645,
      "post_number": 4,
      "username": "flokl",
      "name": "",
      "created_at": "2024-12-15T10:29:04.067Z",
      "updated_at": "2024-12-15T10:30:04.718Z",
      "cooked": "<p>I wanted to do something similar in the past but gave up in the end. The code splits the equation, which causes misalignments. Perhaps you can find a way to make it work.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let colorunderline(color: black, equation) = block(\n  stroke: (bottom: .5pt + color), \n  outset: (bottom: 1.5pt), \n  $ equation $\n)\n\n$\n  colorunderline(a =) colorunderline(color: #red, a +) colorunderline(color: #green, b / c ) \\\n  \n  colorunderline(color: #orange, a =) colorunderline(color: #gradient.linear(..color.map.rainbow), a + b / c) \\\n  \n  sum_i x_i/2 = colorunderline(sum_i x_i )\\\n$\n</code></pre>\n<details>\n<summary>\nOutput</summary>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/d/d64e7f4e156993ff33b5a7434d1a0b51880265d7.png\" data-download-href=\"https://forum.typst.app/uploads/default/d64e7f4e156993ff33b5a7434d1a0b51880265d7\" title=\"test\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/d/d64e7f4e156993ff33b5a7434d1a0b51880265d7_2_441x500.png\" alt=\"test\" data-base62-sha1=\"uzQmdr1ZjAH8TOdLkN2FFa3mgvl\" width=\"441\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/d/d64e7f4e156993ff33b5a7434d1a0b51880265d7_2_441x500.png, https://forum.typst.app/uploads/default/optimized/2X/d/d64e7f4e156993ff33b5a7434d1a0b51880265d7_2_661x750.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/d/d64e7f4e156993ff33b5a7434d1a0b51880265d7_2_882x1000.png 2x\" data-dominant-color=\"F8F7F7\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">test</span><span class=\"informations\">1007×1141 77.9 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>",
      "raw": "I wanted to do something similar in the past but gave up in the end. The code splits the equation, which causes misalignments. Perhaps you can find a way to make it work.\n\n```typst\n#let colorunderline(color: black, equation) = block(\n  stroke: (bottom: .5pt + color), \n  outset: (bottom: 1.5pt), \n  $ equation $\n)\n\n$\n  colorunderline(a =) colorunderline(color: #red, a +) colorunderline(color: #green, b / c ) \\\n  \n  colorunderline(color: #orange, a =) colorunderline(color: #gradient.linear(..color.map.rainbow), a + b / c) \\\n  \n  sum_i x_i/2 = colorunderline(sum_i x_i )\\\n$\n```\n\n[details=\"Output\"]\n![test|441x500](upload://uzQmdr1ZjAH8TOdLkN2FFa3mgvl.png)\n[/details]",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 19,
      "score": 23.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 6648,
      "post_number": 5,
      "username": "sjfhsjfh",
      "name": "sjfhsjfh",
      "created_at": "2024-12-15T11:48:41.735Z",
      "updated_at": "2024-12-15T11:48:41.735Z",
      "cooked": "<p>In that case, you might define some custom underline functions, e.g.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let myuline(fill: black, it) = {\n  set text(fill: fill)\n  math.underline(it)\n}\n</code></pre>\n<p>Then you can have</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$ myuline(fill: #blue, A + B) = myuline(fill: #red, C + D) $\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/4/4b4664098c3cf69e594328b75824cc8d03c35738.png\" alt=\"Result\" data-base62-sha1=\"aJUCyfLEDGZjho6jenoNKWUWXfW\" width=\"359\" height=\"88\"></p>",
      "raw": "In that case, you might define some custom underline functions, e.g.\n```typ\n#let myuline(fill: black, it) = {\n  set text(fill: fill)\n  math.underline(it)\n}\n```\n\nThen you can have\n\n```typ\n$ myuline(fill: #blue, A + B) = myuline(fill: #red, C + D) $\n```\n\n![Result|359x88](upload://aJUCyfLEDGZjho6jenoNKWUWXfW.png)",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 19,
      "score": 53.8,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 120
    }
  ],
  "scraped_at": "2025-06-10T09:53:38.053529"
}
{
  "topic_metadata": {
    "id": 2098,
    "title": "Is the Bitcoin symbol available?",
    "slug": "is-the-bitcoin-symbol-available",
    "posts_count": 5,
    "created_at": "2024-12-15T09:49:57.415Z",
    "last_posted_at": "2024-12-15T23:00:13.458Z",
    "views": 113,
    "like_count": 6,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "flokl",
    "tags": [
      "symbols"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 113
  },
  "posts": [
    {
      "id": 6642,
      "post_number": 1,
      "username": "Dr_Joachim",
      "name": "Joachim Hein",
      "created_at": "2024-12-15T09:49:57.759Z",
      "updated_at": "2024-12-15T20:47:51.198Z",
      "cooked": "<p>Did somebody find the symbol of Bitcoin in typst?<br>\nsimilar to the classical Dollar Symbol <img src=\"https://forum.typst.app/images/emoji/apple/currency_exchange.png?v=12\" title=\":currency_exchange:\" class=\"emoji\" alt=\":currency_exchange:\" loading=\"lazy\" width=\"20\" height=\"20\"> <img src=\"https://forum.typst.app/images/emoji/apple/heavy_dollar_sign.png?v=12\" title=\":heavy_dollar_sign:\" class=\"emoji\" alt=\":heavy_dollar_sign:\" loading=\"lazy\" width=\"20\" height=\"20\"><br>\nThanks! Would be nice.</p>",
      "raw": "Did somebody find the symbol of Bitcoin in typst? \nsimilar to the classical Dollar Symbol :currency_exchange: :heavy_dollar_sign:\nThanks! Would be nice.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 46,
      "score": 54.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 736
    },
    {
      "id": 6644,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2024-12-15T10:15:45.506Z",
      "updated_at": "2024-12-15T11:48:09.412Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/dr_joachim\">@Dr_Joachim</a>,</p>\n<p>you can search for symbols by name in the <a href=\"https://typst.app/docs/reference/symbols/sym/\"> sym documentation</a>, you can try to find them by drawing with <a href=\"https://detypify.quarticcat.com/\">detypify</a>, and you can insert Unicode symbols directly or by code point.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#sym.bitcoin\n\n₿\n\n\\u{20BF}\n</code></pre>",
      "raw": "Hi @Dr_Joachim,\n\nyou can search for symbols by name in the [ sym documentation](https://typst.app/docs/reference/symbols/sym/), you can try to find them by drawing with [detypify](https://detypify.quarticcat.com/), and you can insert Unicode symbols directly or by code point.\n\n```typst\n#sym.bitcoin\n\n₿\n\n\\u{20BF}\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 5,
      "reads": 46,
      "score": 89.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 6647,
      "post_number": 3,
      "username": "Dr_Joachim",
      "name": "Joachim Hein",
      "created_at": "2024-12-15T11:37:49.559Z",
      "updated_at": "2024-12-15T11:37:49.559Z",
      "cooked": "<p>Thanks a lot!! nice!</p>",
      "raw": "Thanks a lot!! nice!",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 43,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 736
    },
    {
      "id": 6662,
      "post_number": 4,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-15T20:48:36.174Z",
      "updated_at": "2024-12-15T20:48:36.174Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/dr_joachim\">@Dr_Joachim</a>, if <a class=\"mention\" href=\"/u/flokl\">@flokl</a>’s answer solved your request, please mark it as a solution (click the <img src=\"https://forum.typst.app/images/emoji/apple/white_check_mark.png?v=12\" title=\":white_check_mark:\" class=\"emoji\" alt=\":white_check_mark:\" loading=\"lazy\" width=\"20\" height=\"20\">), otherwise let us know if you still need help. Thanks!</p>",
      "raw": "Hey @Dr_Joachim, if @flokl's answer solved your request, please mark it as a solution (click the :white_check_mark:), otherwise let us know if you still need help. Thanks!",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 10.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6668,
      "post_number": 5,
      "username": "Dr_Joachim",
      "name": "Joachim Hein",
      "created_at": "2024-12-15T23:00:13.458Z",
      "updated_at": "2024-12-15T23:00:13.458Z",
      "cooked": "<p>yes, my apologies!<br>\nI sank to deep in my rabbithole… ;-)</p>",
      "raw": "yes, my apologies! \nI sank to deep in my rabbithole.... ;-)",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 25,
      "score": 50.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 736
    }
  ],
  "scraped_at": "2025-06-10T09:53:37.328030"
}
{
  "topic_metadata": {
    "id": 2099,
    "title": "How can I reference a table that has been rotated?",
    "slug": "how-can-i-reference-a-table-that-has-been-rotated",
    "posts_count": 5,
    "created_at": "2024-12-15T11:35:51.800Z",
    "last_posted_at": "2024-12-15T16:26:07.779Z",
    "views": 67,
    "like_count": 3,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 6,
    "accepted_answer_username": "flokl",
    "tags": [
      "tables"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 348
  },
  "posts": [
    {
      "id": 6646,
      "post_number": 1,
      "username": "Dr_Joachim",
      "name": "Joachim Hein",
      "created_at": "2024-12-15T11:35:51.956Z",
      "updated_at": "2024-12-15T13:45:08.407Z",
      "cooked": "<p>I want to rotate a table. The table guide works fine, except the referencing of this rotated table.<br>\nI says: “Cannot reference rotate …”<br>\nIs this impossible or do you know a way around?<br>\nI would really like to reference this rotated table in an orderly way. Thanks a lot!</p>",
      "raw": "I want to rotate a table. The table guide works fine, except the referencing of this rotated table.\nI says: \"Cannot reference rotate ..\"\nIs this impossible or do you know a way around?\nI would really like to reference this rotated table in an orderly way. Thanks a lot!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 105.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 736
    },
    {
      "id": 6651,
      "post_number": 3,
      "username": "flokl",
      "name": "",
      "created_at": "2024-12-15T12:07:02.550Z",
      "updated_at": "2024-12-15T16:29:12.743Z",
      "cooked": "<p>You have probably attached the label directly to <code>rotate</code>, but you have to use a <code>figure</code> like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#figure(\n  rotate(\n    -90deg,\n    reflow: true,\n  \n    table(\n      columns: 2,\n      \n      [T], [1],\n      [T], [2],\n    ),\n  ),\n  caption: [A caption]\n) &lt;mytable&gt;\n\nReference to mytable @mytable\n</code></pre>\n<details>\n<summary>\nOutput</summary>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/d/d3a9954edc0ed87e100e085d1dc3d0d504de0227.png\" alt=\"test\" data-base62-sha1=\"ucs4KIoCoglQ9DVgIGVm8rN83Ur\" width=\"373\" height=\"246\"></p>\n</details>\n<p>Edit: added output with a caption</p>",
      "raw": "You have probably attached the label directly to `rotate`, but you have to use a `figure` like this:\n\n```typ\n#figure(\n  rotate(\n    -90deg,\n    reflow: true,\n  \n    table(\n      columns: 2,\n      \n      [T], [1],\n      [T], [2],\n    ),\n  ),\n  caption: [A caption]\n) <mytable>\n\nReference to mytable @mytable\n```\n\n[details=\"Output\"]\n![test|373x246](upload://ucs4KIoCoglQ9DVgIGVm8rN83Ur.png)\n[/details]\nEdit: added output with a caption",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 35.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 6653,
      "post_number": 4,
      "username": "Dr_Joachim",
      "name": "Joachim Hein",
      "created_at": "2024-12-15T15:29:13.705Z",
      "updated_at": "2024-12-15T16:58:32.260Z",
      "cooked": "<p>Thanks.<br>\nI was using a close variation of the table guide like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(\"a4\", columns:  1, numbering: \"— 1 —\")\n#show table.cell.where(y: 0): set text(weight: \"bold\")\n\n#rotate(\n  -90deg,\n  reflow: true,\n\n  table(\n    columns: (1fr,) + 3 * (1fr,),\n    inset: (x: 0.6em,),\n    stroke: (_, y) =&gt; (\n      x: 1pt,\n      top: if y &lt;= 1 { 1pt } else { 0pt },\n      bottom: 1pt,\n    ),\n    align: (center, left, left, left, right, left),\n\n    table.header(\n      [P],\n      [I], [Cn],\n      [N],\n    ),\n \n    [],  [], [], [],\n    [],  [], [], [],\n    [],  [], [], [],\n  ),\n  caption: [results for design B],\n) &lt;probe-b&gt;\n</code></pre>\n<p>… and finally the caption and the referencing via  did not work.<br>\nMay be space was not sufficient with all my text? Even with less text it was not ok.<br>\nThanks a lot! Very helpful!</p>",
      "raw": "Thanks.\nI was using a close variation of the table guide like this:\n```typ\n#set page(\"a4\", columns:  1, numbering: \"— 1 —\")\n#show table.cell.where(y: 0): set text(weight: \"bold\")\n\n#rotate(\n  -90deg,\n  reflow: true,\n\n  table(\n    columns: (1fr,) + 3 * (1fr,),\n    inset: (x: 0.6em,),\n    stroke: (_, y) => (\n      x: 1pt,\n      top: if y <= 1 { 1pt } else { 0pt },\n      bottom: 1pt,\n    ),\n    align: (center, left, left, left, right, left),\n\n    table.header(\n      [P],\n      [I], [Cn],\n      [N],\n    ),\n \n    [],  [], [], [],\n    [],  [], [], [],\n    [],  [], [], [],\n  ),\n  caption: [results for design B],\n) <probe-b>\n```\n... and finally the caption and the referencing via <probe-b> did not work.\nMay be space was not sufficient with all my text? Even with less text it was not ok. \nThanks a lot! Very helpful!",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 5.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 736
    },
    {
      "id": 6654,
      "post_number": 5,
      "username": "Dr_Joachim",
      "name": "Joachim Hein",
      "created_at": "2024-12-15T15:54:08.842Z",
      "updated_at": "2024-12-15T15:54:08.842Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"flokl\" data-post=\"3\" data-topic=\"2099\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/flokl/48/28_2.png\" class=\"avatar\"> flokl:</div>\n<blockquote>\n<pre><code class=\"lang-auto\">#figure(\n  rotate(\n    -90deg,\n    reflow: true,\n  \n    table(\n      columns: 2,\n      \n      [T], [1],\n      [T], [2],\n    ),\n  )\n) &lt;mytable&gt;\n\nReference to mytable @mytable\n</code></pre>\n</blockquote>\n</aside>\n<p>Thanks, it works!!! Lovely.<br>\nThe figure caption itself is not in rotation, but that´s fine. May I Ask: How do I include the Table Nr. and the accompaning caption in the rotation?</p>",
      "raw": "[quote=\"flokl, post:3, topic:2099\"]\n```\n#figure(\n  rotate(\n    -90deg,\n    reflow: true,\n  \n    table(\n      columns: 2,\n      \n      [T], [1],\n      [T], [2],\n    ),\n  )\n) <mytable>\n\nReference to mytable @mytable\n```\n[/quote]\n\nThanks, it works!!! Lovely.\nThe figure caption itself is not in rotation, but that´s fine. May I Ask: How do I include the Table Nr. and the accompaning caption in the rotation?",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 22,
      "score": 4.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 736
    },
    {
      "id": 6655,
      "post_number": 6,
      "username": "flokl",
      "name": "",
      "created_at": "2024-12-15T16:26:07.779Z",
      "updated_at": "2024-12-15T16:26:07.779Z",
      "cooked": "<p>It is not enough to put the <code>figure</code> inside the <code>rotation</code> because the <code>label</code> can only be attached to an element in content mode. So you have to do it like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#rotate(\n  -90deg,\n  reflow: true\n)[\n  #figure(\n    table(\n      columns: 2,\n      \n      [T], [1],\n      [T], [2],\n    ),\n    caption: [A caption]\n  ) &lt;mytable&gt;\n]\n\nReference to mytable @mytable\n</code></pre>\n<details>\n<summary>\nOutput</summary>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/b/b42ecf93336c60bccf782601522a58684194c939.png\" alt=\"test\" data-base62-sha1=\"pHYeESUwruNJEBqtirb8E6I50md\" width=\"373\" height=\"317\"></p>\n</details>\n<p>Please use code blocks in your posts like this:</p>\n<pre><code class=\"lang-auto\">```typ\nyour code goes here\n```\n</code></pre>",
      "raw": "It is not enough to put the `figure` inside the `rotation` because the `label` can only be attached to an element in content mode. So you have to do it like this:\n```typ\n#rotate(\n  -90deg,\n  reflow: true\n)[\n  #figure(\n    table(\n      columns: 2,\n      \n      [T], [1],\n      [T], [2],\n    ),\n    caption: [A caption]\n  ) <mytable>\n]\n\nReference to mytable @mytable\n```\n\n[details=\"Output\"]\n![test|373x317](upload://pHYeESUwruNJEBqtirb8E6I50md.png)\n[/details]\n\nPlease use code blocks in your posts like this:\n````\n```typ\nyour code goes here\n```\n````",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 22,
      "score": 69.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    }
  ],
  "scraped_at": "2025-06-10T09:53:36.640912"
}
{
  "topic_metadata": {
    "id": 2103,
    "title": "How to reference a figure from a variable?",
    "slug": "how-to-reference-a-figure-from-a-variable",
    "posts_count": 3,
    "created_at": "2024-12-15T20:00:54.623Z",
    "last_posted_at": "2024-12-15T22:01:43.706Z",
    "views": 230,
    "like_count": 0,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "flokl",
    "tags": [
      "scripting",
      "figures"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 264
  },
  "posts": [
    {
      "id": 6658,
      "post_number": 1,
      "username": "Stine",
      "name": "Stine",
      "created_at": "2024-12-15T20:00:54.780Z",
      "updated_at": "2024-12-16T05:44:06.059Z",
      "cooked": "<p>I’m trying to refer to my figure, but the figure label name is stored in a variable.</p>\n<p>If I did not have a mix of tables and figures in my document <code>counter(figure).at(label(\"sample_c\"))</code> would work. However as I have a table first this is included in the counter.</p>\n<p>Here is my attempts:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#figure(\n  table(columns:2,[test],[test]),\n  caption: [A table],\n  kind: table\n) &lt;table_1&gt;\n\n#let samples = ((tag:\"a\"),(tag:\"b\"),(tag:\"c\"),)\n#for s in samples {\n  block([\n  #figure(\n    [Some figure],\n    caption: [Statistics for measurement #s.tag.],\n    ) #label(\"sample_\" + s.tag)        \n  ])\n}\n\n// The below of cause works as expected\n@sample_c \\\n@table_1\n\n// But if I have the lable name in a variable I struggle to get the correct figure number\n// The counter does not differentiate between tables and figures.\n#context locate(label(\"sample_c\")).position()\n\n#context counter(figure).at(label(\"sample_c\")) // The figure number is 3 - Returns 4 as the table is counted as well\n</code></pre>",
      "raw": "I'm trying to refer to my figure, but the figure label name is stored in a variable.\n\nIf I did not have a mix of tables and figures in my document ``` counter(figure).at(label(\"sample_c\")) ``` would work. However as I have a table first this is included in the counter.\n\nHere is my attempts:\n\n```typ\n#figure(\n  table(columns:2,[test],[test]),\n  caption: [A table],\n  kind: table\n) <table_1>\n\n#let samples = ((tag:\"a\"),(tag:\"b\"),(tag:\"c\"),)\n#for s in samples {\n  block([\n  #figure(\n    [Some figure],\n    caption: [Statistics for measurement #s.tag.],\n    ) #label(\"sample_\" + s.tag)        \n  ])\n}\n\n// The below of cause works as expected\n@sample_c \\\n@table_1\n\n// But if I have the lable name in a variable I struggle to get the correct figure number\n// The counter does not differentiate between tables and figures.\n#context locate(label(\"sample_c\")).position()\n\n#context counter(figure).at(label(\"sample_c\")) // The figure number is 3 - Returns 4 as the table is counted as well\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 1020.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 937
    },
    {
      "id": 6663,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2024-12-15T20:52:01.887Z",
      "updated_at": "2024-12-15T20:54:18.698Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/stine\">@Stine</a>,</p>\n<p><code>figure</code> includes all <code>kinds</code> of figures, the built-in kinds <code>image</code>, <code>table</code>, and <code>raw</code>, and custom ones. Typst automatically uses the build in ones: if you wrap a table with a figure, it automatically creates a figure of kind <code>table</code>. By default, and in your case, the 3 figures generated by the <code>for</code> loop are of kind <code>image</code>.</p>\n<p>You can get the correct counter with <code>.where(kind: image)</code>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#context counter(figure.where(kind: image)).at(label(\"sample_c\"))\n</code></pre>\n<p>If you do something special with your figures I would recommend to use a custom <code>kind</code>.</p>",
      "raw": "Hi @Stine,\n\n`figure` includes all `kinds` of figures, the built-in kinds `image`, `table`, and `raw`, and custom ones. Typst automatically uses the build in ones: if you wrap a table with a figure, it automatically creates a figure of kind `table`. By default, and in your case, the 3 figures generated by the `for` loop are of kind `image`.\n\nYou can get the correct counter with `.where(kind: image)`.\n```typ\n#context counter(figure.where(kind: image)).at(label(\"sample_c\"))\n```\nIf you do something special with your figures I would recommend to use a custom `kind`.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 25.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 6666,
      "post_number": 3,
      "username": "Stine",
      "name": "Stine",
      "created_at": "2024-12-15T22:01:43.706Z",
      "updated_at": "2024-12-15T22:01:43.706Z",
      "cooked": "<p>Thanks a lot for your time, this was just what I needed.</p>",
      "raw": "Thanks a lot for your time, this was just what I needed.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 5.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 937
    }
  ],
  "scraped_at": "2025-06-10T09:53:35.874323"
}
{
  "topic_metadata": {
    "id": 2115,
    "title": "Canonical neovim console workflow as of 2024 with live(ish) output view?",
    "slug": "canonical-neovim-console-workflow-as-of-2024-with-live-ish-output-view",
    "posts_count": 4,
    "created_at": "2024-12-16T12:06:24.731Z",
    "last_posted_at": "2024-12-16T13:25:29.808Z",
    "views": 180,
    "like_count": 3,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "Daniel",
    "tags": [
      "tooling",
      "neovim"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 253
  },
  "posts": [
    {
      "id": 6681,
      "post_number": 1,
      "username": "Vegabook",
      "name": "vegabook",
      "created_at": "2024-12-16T12:06:24.844Z",
      "updated_at": "2024-12-16T19:43:06.744Z",
      "cooked": "<p>I’m evaluating this great-sounding project, and while some of my colleagues will love the web app, I and a few programmers are dedicated terminal junkies. I recall that there was a workflow where you’d type your Typst document in your text editor, and it would live update in your browser whenever you save. I assume it used <code>inotify</code> on Linux and something else on MacOS, but also, what does one run in the browser to get an auto page-refresh? What’s the cleanest way of achieving this?</p>",
      "raw": "I'm evaluating this great-sounding project, and while some of my colleagues will love the web app, I and a few programmers are dedicated terminal junkies. I recall that there was a workflow where you'd type your Typst document in your text editor, and it would live update in your browser whenever you save. I assume it used `inotify` on Linux and something else on MacOS, but also, what does one run in the browser to get an auto page-refresh? What's the cleanest way of achieving this?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 34,
      "score": 456.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 942
    },
    {
      "id": 6683,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-16T12:23:36.149Z",
      "updated_at": "2024-12-16T12:25:21.819Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/vegabook\">@Vegabook</a>,</p>\n<p>if you wish to watch the document, then <code>typst watch</code> is your friend. Instant updates would require your text editor to be configured with near-instant save after write. In neovim, that’s the <a href=\"https://neovim.io/doc/user/options.html#'autowriteall'\"><code>autowriteall</code></a> option.</p>\n<pre data-code-wrap=\"shell\"><code class=\"lang-shell\">❯ typst watch -h\nWatches an input file and recompiles on changes\n\nUsage: typst watch [OPTIONS] &lt;INPUT&gt; [OUTPUT]\n\nArguments:`autowriteall`\n  &lt;INPUT&gt;   Path to input Typst file. Use `-` to read input from stdin\n  [OUTPUT]  Path to output file (PDF, PNG, SVG, or HTML). Use `-` to write\n            output to stdout\n</code></pre>",
      "raw": "Hello @Vegabook,\n\nif you wish to watch the document, then `typst watch` is your friend. Instant updates would require your text editor to be configured with near-instant save after write. In neovim, that's the [`autowriteall`](https://neovim.io/doc/user/options.html#'autowriteall') option.\n\n\n```shell\n❯ typst watch -h\nWatches an input file and recompiles on changes\n\nUsage: typst watch [OPTIONS] <INPUT> [OUTPUT]\n\nArguments:`autowriteall`\n  <INPUT>   Path to input Typst file. Use `-` to read input from stdin\n  [OUTPUT]  Path to output file (PDF, PNG, SVG, or HTML). Use `-` to write\n            output to stdout\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 34,
      "score": 56.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6684,
      "post_number": 3,
      "username": "Daniel",
      "name": "Daniel Cook",
      "created_at": "2024-12-16T12:56:13.744Z",
      "updated_at": "2024-12-16T12:56:13.744Z",
      "cooked": "<p>I had this in a makefile for a bigger project recently, requires the tinymist cli:</p>\n<pre><code class=\"lang-auto\">preview:\n\topen -a firefox \"http://127.0.0.1:23627\"\n\ttinymist preview --no-open $(MAIN)\n</code></pre>\n<p>I use mac, but Safari won’t auto refresh. Firefox worked.</p>",
      "raw": "I had this in a makefile for a bigger project recently, requires the tinymist cli:\n\n\n```\npreview:\n\topen -a firefox \"http://127.0.0.1:23627\"\n\ttinymist preview --no-open $(MAIN)\n```\n\nI use mac, but Safari won't auto refresh. Firefox worked.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 32,
      "score": 76.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 94
    },
    {
      "id": 6685,
      "post_number": 4,
      "username": "Vegabook",
      "name": "vegabook",
      "created_at": "2024-12-16T13:25:29.808Z",
      "updated_at": "2024-12-16T13:25:29.808Z",
      "cooked": "<p><a href=\"https://search.nixos.org/packages?channel=24.11&amp;show=tinymist&amp;from=0&amp;size=50&amp;sort=relevance&amp;type=packages&amp;query=tinymist\" rel=\"noopener nofollow ugc\">Excellent</a>. That’s what I’ll use.</p>",
      "raw": "[Excellent](https://search.nixos.org/packages?channel=24.11&show=tinymist&from=0&size=50&sort=relevance&type=packages&query=tinymist). That's what I'll use.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 11.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 942
    }
  ],
  "scraped_at": "2025-06-10T09:53:35.170811"
}
{
  "topic_metadata": {
    "id": 2119,
    "title": "How do I count words in a paragraph or the whole text?",
    "slug": "how-do-i-count-words-in-a-paragraph-or-the-whole-text",
    "posts_count": 4,
    "created_at": "2024-12-16T20:37:37.752Z",
    "last_posted_at": "2024-12-18T18:58:37.590Z",
    "views": 389,
    "like_count": 1,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 96
  },
  "posts": [
    {
      "id": 6689,
      "post_number": 1,
      "username": "Dr_Joachim",
      "name": "Joachim Hein",
      "created_at": "2024-12-16T20:37:37.861Z",
      "updated_at": "2024-12-17T06:46:53.617Z",
      "cooked": "<p>To determine the number of words and characters in an paper, what is the function for this?<br>\nThanks!</p>",
      "raw": "To determine the number of words and characters in an paper, what is the function for this?\nThanks!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 44,
      "score": 2113.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 736
    },
    {
      "id": 6691,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-17T06:46:38.584Z",
      "updated_at": "2024-12-17T06:46:38.584Z",
      "cooked": "<p>Hello!</p>\n<p>This is possible (with limits) using <a href=\"https://typst.app/universe/package/wordometer\"><code>wordometer</code></a>. See the topic on character counting for more details.</p>\n<aside class=\"quote quote-modified\" data-post=\"6\" data-topic=\"489\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/d/9335FF/48.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/character-count-of-body-text/489/6\">Character count of body text?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    I’ve been using wordometer for word count. It does character count as well. \nThere are some things it can’t count properly. Look at some open issues on GitHub. \nA follow up question: what is your use case? Do you need the count in your rendered document, or outside just as a metric? \nI think at the moment the more accurate way to go about a whole document character count will be to use an external script after rendering a PDF. So, have a toggle to disable some things you don’t want counted (page…\n  </blockquote>\n</aside>\n\n<p>I have also changed your question to “How do I count words in a paragraph or the whole text?”, thank you!</p>",
      "raw": "Hello!\n\nThis is possible (with limits) using [`wordometer`](https://typst.app/universe/package/wordometer). See the topic on character counting for more details.\n\nhttps://forum.typst.app/t/character-count-of-body-text/489/6?u=quachpas\n\nI have also changed your question to \"How do I count words in a paragraph or the whole text?\", thank you!",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 41,
      "score": 48.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6697,
      "post_number": 3,
      "username": "Dr_Joachim",
      "name": "Joachim Hein",
      "created_at": "2024-12-17T12:27:33.687Z",
      "updated_at": "2024-12-17T12:27:33.687Z",
      "cooked": "<p>Thanks a lot! Very helpful hint.</p>",
      "raw": "Thanks a lot! Very helpful hint.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 11.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 736
    },
    {
      "id": 6742,
      "post_number": 4,
      "username": "Dr_Joachim",
      "name": "Joachim Hein",
      "created_at": "2024-12-18T18:58:37.590Z",
      "updated_at": "2024-12-18T18:58:37.590Z",
      "cooked": "<p>I finally got it, Thank you for your help! Solution button was finally hit!<br>\n;-)</p>",
      "raw": "I finally got it, Thank you for your help! Solution button was finally hit! \n;-)",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 27,
      "score": 30.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 736
    }
  ],
  "scraped_at": "2025-06-10T09:53:34.470062"
}
{
  "topic_metadata": {
    "id": 2121,
    "title": "How to mutate bibliography access-date of specific references?",
    "slug": "how-to-mutate-bibliography-access-date-of-specific-references",
    "posts_count": 2,
    "created_at": "2024-12-17T09:26:34.052Z",
    "last_posted_at": "2024-12-17T10:04:18.083Z",
    "views": 114,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "scripting",
      "literature",
      "bibtex"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 488
  },
  "posts": [
    {
      "id": 6694,
      "post_number": 1,
      "username": "MartyByrde",
      "name": "MartyByrde",
      "created_at": "2024-12-17T09:26:34.227Z",
      "updated_at": "2025-02-05T15:01:35.338Z",
      "cooked": "<p>Hey guys I am using typst for writing all of my reports in my daily life and I am very happy with it.</p>\n<p>Something that I have been wondering for quite some time, when using it for scientific papers and reports, is the following. When I use for example online references using e.g. a <code>references.bib</code> file that stores my references in the bibtex format. Then I usually have to update the urlDate property of these references manually. Meaning that whenever I make changes to my document I should also update the access date (<code>urlDate</code> property) of these references to conform with the citation requirements.</p>\n<p>This means that my question is whether it is possible to somehow manipulate / change this property when showing the bibliography in the document. I am thinking about something like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show bibliography.entry: it =&gt; {\n  if (type(it) == \"Online\") {\n     it.urlDate = new Date()\n  }\n  it\n}\n</code></pre>\n<p>However, I was yet unable to achieve something similar because it seems like there is no <code>entry</code> property for the bibliography command. Also, I guess it would not be possible to mutate the <code>urlDate</code> property of an entry. However, it may be possible to achieve the desired behavior without having to mutate the <code>it</code> element, somehow.</p>\n<p>Have you guys, by any chance, thought of something similar before or perhaps even done so in the past? Looking forward to reading your thoughts on this.</p>",
      "raw": "Hey guys I am using typst for writing all of my reports in my daily life and I am very happy with it. \n\nSomething that I have been wondering for quite some time, when using it for scientific papers and reports, is the following. When I use for example online references using e.g. a `references.bib` file that stores my references in the bibtex format. Then I usually have to update the urlDate property of these references manually. Meaning that whenever I make changes to my document I should also update the access date (`urlDate` property) of these references to conform with the citation requirements.\n\nThis means that my question is whether it is possible to somehow manipulate / change this property when showing the bibliography in the document. I am thinking about something like this:\n\n```typ\n#show bibliography.entry: it => {\n  if (type(it) == \"Online\") {\n     it.urlDate = new Date()\n  }\n  it\n}\n```\n\nHowever, I was yet unable to achieve something similar because it seems like there is no `entry` property for the bibliography command. Also, I guess it would not be possible to mutate the `urlDate` property of an entry. However, it may be possible to achieve the desired behavior without having to mutate the `it` element, somehow.\n\nHave you guys, by any chance, thought of something similar before or perhaps even done so in the past? Looking forward to reading your thoughts on this.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 479.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 689
    },
    {
      "id": 6695,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-17T10:04:18.083Z",
      "updated_at": "2024-12-17T10:09:25.555Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/martybyrde\">@MartyByrde</a>, it might be possible to use a combination of regexp to detect online entries in your bibliography and replace the access dates accordingly, however I do not recommend it for the following reasons:</p>\n<ul>\n<li>the ground truth is your bibfile (or whichever software you use to manage your references), not your Typst document. If you want to update the <code>urlDate</code> property, then you should update your ground truth.</li>\n<li>Websites are not immutable, hence you cannot guarantee that the website is identical to your previous reference if you change the access date. I recommend simply adding a new reference with a more recent access date. Best case scenario, you can cite from a digital archive like <a href=\"http://archive.org\">archive.org</a>. From the Chicago Manual of Style, you can read about online references (if you need a specific version)\n<blockquote>\n<p><a href=\"https://www.chicagomanualofstyle.org/qanda/data/faq/topics/Documentation.html#:~:text=If%20you%20do%20not%20cite%20an%20archived%20version%2C%20you%20will%20need%20to%20include%20an%20access%20date.\">If you do not cite an archived version, you will need to include an access date.</a></p>\n</blockquote>\n</li>\n<li>If you use Zotero with Better BibTeX, you can generate a unique citation key for onlines entries using the following formula<pre><code class=\"lang-auto\">(type(webpage)\n+ auth.lower + '_' + (month ? month + '_': '') + year + '_accessed_' + \nAccessDate.formatDate\n) | (auth.lower + shorttitle(3,3) + year)\n)\n</code></pre>\nYou will obtain something similar to <code>carpenter_jul_2024_accessed_2024-07-11</code>.</li>\n</ul>\n<p>I understand it does not answer the original question, but I think this is a classic case of a <a href=\"https://en.wikipedia.org/wiki/XY_problem\">XY problem</a>!</p>",
      "raw": "Hello @MartyByrde, it might be possible to use a combination of regexp to detect online entries in your bibliography and replace the access dates accordingly, however I do not recommend it for the following reasons:\n- the ground truth is your bibfile (or whichever software you use to manage your references), not your Typst document. If you want to update the `urlDate` property, then you should update your ground truth.\n- Websites are not immutable, hence you cannot guarantee that the website is identical to your previous reference if you change the access date. I recommend simply adding a new reference with a more recent access date. Best case scenario, you can cite from a digital archive like archive.org. From the Chicago Manual of Style, you can read about online references (if you need a specific version)\n   > [If you do not cite an archived version, you will need to include an access date.](https://www.chicagomanualofstyle.org/qanda/data/faq/topics/Documentation.html#:~:text=If%20you%20do%20not%20cite%20an%20archived%20version%2C%20you%20will%20need%20to%20include%20an%20access%20date.)\n- If you use Zotero with Better BibTeX, you can generate a unique citation key for onlines entries using the following formula\n   ```\n   (type(webpage)\n   + auth.lower + '_' + (month ? month + '_': '') + year + '_accessed_' + \n   AccessDate.formatDate\n   ) | (auth.lower + shorttitle(3,3) + year)\n   )\n   ```\n   You will obtain something similar to `carpenter_jul_2024_accessed_2024-07-11`.\n\nI understand it does not answer the original question, but I think this is a classic case of a [XY problem](https://en.wikipedia.org/wiki/XY_problem)!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 21,
      "score": 74.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    }
  ],
  "scraped_at": "2025-06-10T09:53:33.773165"
}
{
  "topic_metadata": {
    "id": 2129,
    "title": "In math mode, does the space character between tokens have a meaning?",
    "slug": "in-math-mode-does-the-space-character-between-tokens-have-a-meaning",
    "posts_count": 5,
    "created_at": "2024-12-17T21:55:56.664Z",
    "last_posted_at": "2024-12-18T20:06:28.682Z",
    "views": 258,
    "like_count": 7,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "ParaN3xus",
    "tags": [
      "math"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 533
  },
  "posts": [
    {
      "id": 6728,
      "post_number": 1,
      "username": "Gilles",
      "name": "Gilles",
      "created_at": "2024-12-17T21:55:56.829Z",
      "updated_at": "2024-12-17T21:55:56.829Z",
      "cooked": "<p>Like many around here, I am a long-time LaTeX user delighted to see a nice and consistent alternative to it!</p>\n<p>I was under the impression that, in math mode, the space character has no meaning, except of course to separate tokens. I nevertheless encountered a case where it seems to impact spacing. To define Galois Fields, I’d write</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">define $\"GF\" ( p^n )$ as the field with $p^n$ elements\n</code></pre>\n<p>But Typst renders the expression with a fairly large extra space between the F and the opening bracket that I would like to avoid. The solution is to write <code>$\"GF\"( p^n )$</code> instead, i.e., no space character between the second quote and the opening bracket, and the extra space disappears in the rendering.</p>\n<p>On the other hand, if I write</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$cos(theta)$ vs $cos ( theta )$\n</code></pre>\n<p>there does not seem to be any difference in the rendering.</p>\n<p>So, are there some rules related to the space character in math mode that I am missing here? And, alternatively, is there a better way to write the GF in the expression above?</p>\n<p>Many thanks already!</p>",
      "raw": "Like many around here, I am a long-time LaTeX user delighted to see a nice and consistent alternative to it!\n\nI was under the impression that, in math mode, the space character has no meaning, except of course to separate tokens. I nevertheless encountered a case where it seems to impact spacing. To define Galois Fields, I'd write\n```typ\ndefine $\"GF\" ( p^n )$ as the field with $p^n$ elements\n```\nBut Typst renders the expression with a fairly large extra space between the F and the opening bracket that I would like to avoid. The solution is to write `$\"GF\"( p^n )$` instead, i.e., no space character between the second quote and the opening bracket, and the extra space disappears in the rendering.\n\nOn the other hand, if I write\n```typ\n$cos(theta)$ vs $cos ( theta )$\n```\nthere does not seem to be any difference in the rendering.\n\nSo, are there some rules related to the space character in math mode that I am missing here? And, alternatively, is there a better way to write the GF in the expression above?\n\nMany thanks already!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 36,
      "score": 952.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 948
    },
    {
      "id": 6729,
      "post_number": 2,
      "username": "ParaN3xus",
      "name": "ParaN3xus",
      "created_at": "2024-12-18T05:28:12.044Z",
      "updated_at": "2024-12-18T05:44:20.706Z",
      "cooked": "<p>This is related to the symbol’s <a href=\"https://typst.app/docs/reference/math/class/\">math class</a>. You can try and observe it’s behavior with code below.</p>\n<details>\n<summary>\nCode and preview</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let classes = (\"normal\", \"punctuation\", \"opening\", \"closing\", \"fence\", \"large\", \"relation\", \"unary\", \"binary\", \"vary\")\n\n#table(\n  columns: 2,\n  align: center + horizon,\n  \"class\", \"behavior\",\n  ..classes\n    .map(c =&gt; {\n      let symbol = math.class(c, \"test\")\n      (\n        c,\n        $\n          \"with space:\" &amp;a symbol b \\\n          \"without space:\" &amp;a#symbol;b\n        $,\n      )\n    })\n    .flatten()\n)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/8abd6dd37c1a6fba9d25dc7f6d5cfe85e2d09f66.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/8abd6dd37c1a6fba9d25dc7f6d5cfe85e2d09f66\" title=\"test\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/8abd6dd37c1a6fba9d25dc7f6d5cfe85e2d09f66_2_309x500.jpeg\" alt=\"test\" data-base62-sha1=\"jNlJVfDPjNiDgFQskHqbpndk59k\" width=\"309\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/8/8abd6dd37c1a6fba9d25dc7f6d5cfe85e2d09f66_2_309x500.jpeg, https://forum.typst.app/uploads/default/optimized/2X/8/8abd6dd37c1a6fba9d25dc7f6d5cfe85e2d09f66_2_463x750.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/8/8abd6dd37c1a6fba9d25dc7f6d5cfe85e2d09f66_2_618x1000.jpeg 2x\" data-dominant-color=\"F3F3F3\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">test</span><span class=\"informations\">651×1052 74.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>\n<p>The math class of <code>\"GF\"</code> is <code>normal</code> so spaces around it counts.</p>",
      "raw": "This is related to the symbol's [math class](https://typst.app/docs/reference/math/class/). You can try and observe it's behavior with code below.\n\n[details=\"Code and preview\"]\n```typ\n#let classes = (\"normal\", \"punctuation\", \"opening\", \"closing\", \"fence\", \"large\", \"relation\", \"unary\", \"binary\", \"vary\")\n\n#table(\n  columns: 2,\n  align: center + horizon,\n  \"class\", \"behavior\",\n  ..classes\n    .map(c => {\n      let symbol = math.class(c, \"test\")\n      (\n        c,\n        $\n          \"with space:\" &a symbol b \\\n          \"without space:\" &a#symbol;b\n        $,\n      )\n    })\n    .flatten()\n)\n```\n![test|309x500](upload://jNlJVfDPjNiDgFQskHqbpndk59k.jpeg)\n[/details]\n\nThe math class of `\"GF\"` is `normal` so spaces around it counts.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 34,
      "score": 66.8,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 14
    },
    {
      "id": 6730,
      "post_number": 3,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-18T07:06:04.579Z",
      "updated_at": "2024-12-19T10:36:44.605Z",
      "cooked": "<p>Hello! My advice here is to use <s>change the math class</s> <a href=\"https://typst.app/docs/reference/math/op/\">text operator</a>.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let GF = math.op(\"GF\")\ndefine $GF ( p^n )$ as the field with $p^n$ elements\ndefine $GF( p^n )$ as the field with $p^n$ elements\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/2/2892cbdb7ab5a9aca1d11751719e2c49c1bcf409.png\" alt=\"image\" data-base62-sha1=\"5MVBIZoxZZEbqHMVEHZtLH0kNoR\" width=\"333\" height=\"66\"></p>",
      "raw": "Hello! My advice here is to use ~~change the math class~~ [text operator](https://typst.app/docs/reference/math/op/).\n\n```typst\n#let GF = math.op(\"GF\")\ndefine $GF ( p^n )$ as the field with $p^n$ elements\ndefine $GF( p^n )$ as the field with $p^n$ elements\n```\n![image|333x66](upload://5MVBIZoxZZEbqHMVEHZtLH0kNoR.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 33,
      "score": 71.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6733,
      "post_number": 4,
      "username": "Gilles",
      "name": "Gilles",
      "created_at": "2024-12-18T09:04:59.156Z",
      "updated_at": "2024-12-18T09:04:59.156Z",
      "cooked": "<p>Very clear. Thank you both!</p>",
      "raw": "Very clear. Thank you both!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 5.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 948
    },
    {
      "id": 6743,
      "post_number": 5,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2024-12-18T20:06:28.682Z",
      "updated_at": "2024-12-18T20:12:30.721Z",
      "cooked": "<p>This is not entirely correct. While it’s true that <code>\"GF\"</code> by default has the <code>\"normal\"</code> class, it’s not what is responsible for the spacing. Any single-letter variable (like <code>p</code> or <code>theta</code>) also has the <code>\"normal\"</code> class. It is only because <code>\"GF\"</code> is in a string (with quotes), that it’s sensitive to spaces around it. The same is true for other elements which create a new frame, e.g. <code>box</code> or <code>block</code>.</p>\n<p>For more detail, see the <a href=\"https://github.com/typst/typst/blob/db06dbf9763d6c610d1f7a267597ecdad309048a/crates/typst-layout/src/math/fragment.rs#L134-L147\" rel=\"noopener nofollow ugc\"><code>is_spaced</code></a> function in the compiler’s source code.</p>\n<p>A space is then only kept if at least one of the elements around it is <code>spaced</code>. One (slightly hacky) workaround to remove the “spacedness” of an element, while keeping it of class <code>\"normal\"</code>, is by doing something like</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let symbol = math.class(\"normal\", \"GF\" + h(0pt))\n$ a symbol b $\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/3/397247c9c7c0248fa6838b5f3e771e459c2ef07b.png\" alt=\"image\" data-base62-sha1=\"8cc3KwVxeDus6ieeHemwdeHd12P\" width=\"66\" height=\"28\"></p>\n<p>See also <a href=\"https://github.com/typst/typst/issues/3379#issuecomment-2013886558\" rel=\"noopener nofollow ugc\">this comment</a> on GitHub.</p>\n<p><em>(For this case, you should follow what <a class=\"mention\" href=\"/u/quachpas\">@quachpas</a> suggested though, as that is exactly what the <code>op</code> function is for.)</em></p>",
      "raw": "This is not entirely correct. While it's true that `\"GF\"` by default has the `\"normal\"` class, it's not what is responsible for the spacing. Any single-letter variable (like `p` or `theta`) also has the `\"normal\"` class. It is only because `\"GF\"` is in a string (with quotes), that it's sensitive to spaces around it. The same is true for other elements which create a new frame, e.g. `box` or `block`.\n\nFor more detail, see the [`is_spaced`](https://github.com/typst/typst/blob/db06dbf9763d6c610d1f7a267597ecdad309048a/crates/typst-layout/src/math/fragment.rs#L134-L147) function in the compiler's source code.\n\nA space is then only kept if at least one of the elements around it is `spaced`. One (slightly hacky) workaround to remove the \"spacedness\" of an element, while keeping it of class `\"normal\"`, is by doing something like\n```typ\n#let symbol = math.class(\"normal\", \"GF\" + h(0pt))\n$ a symbol b $\n```\n![image|88x38, 75%](upload://8cc3KwVxeDus6ieeHemwdeHd12P.png)\n\nSee also [this comment](https://github.com/typst/typst/issues/3379#issuecomment-2013886558) on GitHub.\n\n_(For this case, you should follow what @quachpas suggested though, as that is exactly what the `op` function is for.)_",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 24,
      "score": 49.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 88
    }
  ],
  "scraped_at": "2025-06-10T09:53:33.090137"
}
{
  "topic_metadata": {
    "id": 2135,
    "title": "How to ensure headings in passed content don't affect outline or PDF bookmarks?",
    "slug": "how-to-ensure-headings-in-passed-content-dont-affect-outline-or-pdf-bookmarks",
    "posts_count": 4,
    "created_at": "2024-12-18T14:12:09.123Z",
    "last_posted_at": "2024-12-20T00:11:16.084Z",
    "views": 174,
    "like_count": 3,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "sijo",
    "tags": [
      "scripting",
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 845
  },
  "posts": [
    {
      "id": 6737,
      "post_number": 1,
      "username": "Fevol",
      "name": "Fevol",
      "created_at": "2024-12-18T14:12:09.271Z",
      "updated_at": "2024-12-20T00:10:11.358Z",
      "cooked": "<p>I have the following minimal example:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let exclude-heading(content) = context {\n  set heading(outlined: false, bookmarked: false)\n  let original_nr = counter(heading).get()\n  {\n    show heading: it =&gt; {\n      it.numbering + [ ] + it.body + linebreak()\n    }\n    content\n  }\n  counter(heading).update(original_nr)\n}\n\n#set heading(numbering: \"1.\")\n#outline(indent: 16pt)\n\n= Donkey\n== Dog\n#exclude-heading[\n  = Lorem Stone\n  #lorem(5)\n]\n=== Cat\n#exclude-heading[\n  = Epsum lorem\n  == Lorem Epsum\n  #lorem(5)\n]\n\n= Donkey\n== Dog\n=== Cat\n</code></pre>\n<p>I am trying to include a bunch of documents (represented by the <code>exclude-heading</code> here), but I do not want any of the headings of these documents to actually be outlined <em>or</em> bookmarked. For all intends and purposes, they should be just be seen as regular text (the style should stay identical, though!).</p>\n<p>I <em>sort</em> of managed to bodge my way around this by resetting the counter and adding a show rule. This fixes the outline numbering and displaying (numberings are broken but the numberings don’t matter for me luckily).</p>\n<p>However, the bookmarks <em>are</em> incorrect, I am expecting a bookmark structure in the form of:</p>\n<ul>\n<li>Donkey\n<ul>\n<li>Dog\n<ul>\n<li>Cat</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>But instead I am getting:</p>\n<ul>\n<li>Donkey\n<ul>\n<li>Dog</li>\n</ul>\n</li>\n<li>Cat</li>\n</ul>\n<p>This is probably due to the fact that <code>Cat</code> is internally still counted as <code>2.1.1</code>, and not <code>1.1.1</code>; even if the outline properly reflects the count.</p>\n<p>Is there anything I can do to bypass this issue? Is this a bug (specifically, the bookmark and outline counters not matching)?</p>\n<p>See the picture below for the output of the code and the mismatched bookmarks (to be clear, this is not a PDF reader issue, as it gives the same output on Chrome/Firefox)<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/7/7d602acf3d756db930bea21a4e405345f97590a4.png\" data-download-href=\"https://forum.typst.app/uploads/default/7d602acf3d756db930bea21a4e405345f97590a4\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/7/7d602acf3d756db930bea21a4e405345f97590a4_2_690x405.png\" alt=\"image\" data-base62-sha1=\"hT7II2DoqgjnYizWzVER9IsSzQM\" width=\"690\" height=\"405\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/7/7d602acf3d756db930bea21a4e405345f97590a4_2_690x405.png, https://forum.typst.app/uploads/default/optimized/2X/7/7d602acf3d756db930bea21a4e405345f97590a4_2_1035x607.png 1.5x, https://forum.typst.app/uploads/default/original/2X/7/7d602acf3d756db930bea21a4e405345f97590a4.png 2x\" data-dominant-color=\"D6D4D7\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1130×664 59 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>My best guess is that this issue is also related to <a href=\"https://github.com/typst/typst/issues/2416\" rel=\"noopener nofollow ugc\">https://github.com/typst/typst/issues/2416</a></p>",
      "raw": "I have the following minimal example:\n```typ\n#let exclude-heading(content) = context {\n  set heading(outlined: false, bookmarked: false)\n  let original_nr = counter(heading).get()\n  {\n    show heading: it => {\n      it.numbering + [ ] + it.body + linebreak()\n    }\n    content\n  }\n  counter(heading).update(original_nr)\n}\n\n#set heading(numbering: \"1.\")\n#outline(indent: 16pt)\n\n= Donkey\n== Dog\n#exclude-heading[\n  = Lorem Stone\n  #lorem(5)\n]\n=== Cat\n#exclude-heading[\n  = Epsum lorem\n  == Lorem Epsum\n  #lorem(5)\n]\n\n= Donkey\n== Dog\n=== Cat\n```\n\nI am trying to include a bunch of documents (represented by the `exclude-heading` here), but I do not want any of the headings of these documents to actually be outlined *or* bookmarked. For all intends and purposes, they should be just be seen as regular text (the style should stay identical, though!).\n\nI *sort* of managed to bodge my way around this by resetting the counter and adding a show rule. This fixes the outline numbering and displaying (numberings are broken but the numberings don't matter for me luckily).\n\nHowever, the bookmarks *are* incorrect, I am expecting a bookmark structure in the form of:\n- Donkey\n   - Dog\n      - Cat\n \nBut instead I am getting:\n- Donkey\n   - Dog\n- Cat\n\nThis is probably due to the fact that `Cat` is internally still counted as `2.1.1`, and not `1.1.1`; even if the outline properly reflects the count.\n\nIs there anything I can do to bypass this issue? Is this a bug (specifically, the bookmark and outline counters not matching)?\n\nSee the picture below for the output of the code and the mismatched bookmarks (to be clear, this is not a PDF reader issue, as it gives the same output on Chrome/Firefox)\n![image|690x405](upload://hT7II2DoqgjnYizWzVER9IsSzQM.png)\n\n\nMy best guess is that this issue is also related to <https://github.com/typst/typst/issues/2416>",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 46,
      "score": 489.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 22
    },
    {
      "id": 6738,
      "post_number": 2,
      "username": "sijo",
      "name": "",
      "created_at": "2024-12-18T16:03:00.507Z",
      "updated_at": "2024-12-18T16:03:00.507Z",
      "cooked": "<p>I don’t think it’s related to that issue. The problem is rather in the hierarchy of your headings: the level 3 section “Cat” is not under the level 2 section “Dog”, it’s under the level 1 section “Lorem Stone”. Excluding the heading from the outline doesn’t change that.</p>\n<p>A hack to work around this issue is to put these headings at a high level that you normally don’t use, for example with offset 10 (so headings will start at 11). Then we have to manually increase the text size to have levels 11 and 12 look like level 1 or 2.</p>\n<p>There’s also the problem that you update the state in the context block based on its own value. This triggers new iterations so if you use <code>exclude-heading</code> a few more times you will have a convergence failure.</p>\n<p>To avoid this issue, instead of states we can simply disable numbering for these special headings:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let exclude-heading(content) = context {\n  let n = heading.numbering\n  set heading(outlined: false, numbering: none, offset: 10)\n  show heading.where(level: 11): set text(1.4em)\n  show heading.where(level: 12): set text(1.2em)\n  show heading: it =&gt; {\n    n + [ ] + it.body + linebreak()\n  }\n  content\n}\n</code></pre>\n<p>This shows the actual <code>numbering</code> value (always 1) as in your example. I don’t know if that’s actually what you want.</p>",
      "raw": "I don't think it's related to that issue. The problem is rather in the hierarchy of your headings: the level 3 section \"Cat\" is not under the level 2 section \"Dog\", it's under the level 1 section \"Lorem Stone\". Excluding the heading from the outline doesn't change that.\n\nA hack to work around this issue is to put these headings at a high level that you normally don't use, for example with offset 10 (so headings will start at 11). Then we have to manually increase the text size to have levels 11 and 12 look like level 1 or 2.\n\nThere's also the problem that you update the state in the context block based on its own value. This triggers new iterations so if you use `exclude-heading` a few more times you will have a convergence failure.\n\nTo avoid this issue, instead of states we can simply disable numbering for these special headings:\n\n```typ\n#let exclude-heading(content) = context {\n  let n = heading.numbering\n  set heading(outlined: false, numbering: none, offset: 10)\n  show heading.where(level: 11): set text(1.4em)\n  show heading.where(level: 12): set text(1.2em)\n  show heading: it => {\n    n + [ ] + it.body + linebreak()\n  }\n  content\n}\n```\n\nThis shows the actual `numbering` value (always 1) as in your example. I don't know if that's actually what you want.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 39,
      "score": 32.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 6785,
      "post_number": 3,
      "username": "Fevol",
      "name": "Fevol",
      "created_at": "2024-12-19T18:07:27.671Z",
      "updated_at": "2024-12-19T22:20:34.847Z",
      "cooked": "<p>Sorry for the late reply, thank you very much for your answer!<br>\nI was indeed mistaken to refer to that issue, I think I got tripped up by the fact that the bookmark of <code>Cat</code> is level one (and not three), so I assumed it has something to do with counters.</p>\n<blockquote>\n<p>A hack to work around this issue is to put these headings at a high level that you normally don’t use, for example with offset 10 (so headings will start at 11). Then we have to manually increase the text size to have levels 11 and 12 look like level 1 or 2.</p>\n</blockquote>\n<p>This is a fantastic &amp; elegant solution, and does minimally conflicts with the content I’m trying to handle.</p>\n<blockquote>\n<p>There’s also the problem that you update the state in the context block based on its own value. This triggers new iterations so if you use <code>exclude-heading</code> a few more times you will have a convergence failure.</p>\n</blockquote>\n<p>Thanks for bringing that up! I’ll need to brush up on state/counter management (again).</p>\n<blockquote>\n<p>This shows the actual numbering value (always 1) as in your example. I don’t know if that’s actually what you want.</p>\n</blockquote>\n<p>Yeah, that is not entirely what I wanted, but I managed to find a fix quickly enough by reconstructing the numbering (see below).</p>\n<pre><code class=\"lang-auto\">set heading(outlined: false, numbering: none, offset: 10)\nshow heading.where(level: 11): set text(1.4em)\nshow heading.where(level: 12): set text(1.2em)\nshow heading: it =&gt; {\n  if it.numbering != none { numbering(\"1.\", ..counter(heading).get().slice(10)) } + [ ] + it.body + linebreak()\n}\n</code></pre>\n<p>Thank you again for your solution! I appreciate it!</p>",
      "raw": "Sorry for the late reply, thank you very much for your answer!\nI was indeed mistaken to refer to that issue, I think I got tripped up by the fact that the bookmark of `Cat` is level one (and not three), so I assumed it has something to do with counters. \n\n> A hack to work around this issue is to put these headings at a high level that you normally don’t use, for example with offset 10 (so headings will start at 11). Then we have to manually increase the text size to have levels 11 and 12 look like level 1 or 2.\n\nThis is a fantastic & elegant solution, and does minimally conflicts with the content I'm trying to handle.\n\n> There’s also the problem that you update the state in the context block based on its own value. This triggers new iterations so if you use `exclude-heading` a few more times you will have a convergence failure.\n\nThanks for bringing that up! I'll need to brush up on state/counter management (again).\n\n> This shows the actual numbering value (always 1) as in your example. I don’t know if that’s actually what you want.\n\nYeah, that is not entirely what I wanted, but I managed to find a fix quickly enough by reconstructing the numbering (see below).\n\n```\nset heading(outlined: false, numbering: none, offset: 10)\nshow heading.where(level: 11): set text(1.4em)\nshow heading.where(level: 12): set text(1.2em)\nshow heading: it => {\n  if it.numbering != none { numbering(\"1.\", ..counter(heading).get().slice(10)) } + [ ] + it.body + linebreak()\n}\n```\n\nThank you again for your solution! I appreciate it!",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 32,
      "score": 31.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 22
    },
    {
      "id": 6791,
      "post_number": 4,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-20T00:11:16.084Z",
      "updated_at": "2024-12-20T00:11:16.084Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/fevol\">@Fevol</a>, glad you got an answer! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, please make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Fevol, glad you got an answer! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, please make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 25,
      "score": 30.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:53:32.379839"
}
{
  "topic_metadata": {
    "id": 2140,
    "title": "How to import a custom counter in multiple files correctly?",
    "slug": "how-to-import-a-custom-counter-in-multiple-files-correctly",
    "posts_count": 3,
    "created_at": "2024-12-19T00:07:23.724Z",
    "last_posted_at": "2024-12-19T04:22:27.173Z",
    "views": 57,
    "like_count": 1,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "ziggy",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 181
  },
  "posts": [
    {
      "id": 6749,
      "post_number": 1,
      "username": "ziggy",
      "name": "ziggy",
      "created_at": "2024-12-19T00:07:23.845Z",
      "updated_at": "2024-12-19T04:22:06.885Z",
      "cooked": "<p>Hi,</p>\n<p>I have defined a custom counter sin my <code>main.typ</code> file as follows:</p>\n<pre><code class=\"lang-auto\">\n#let c = counter(\"theorem\")\n#let theorem(it) = block[\n  #c.step()\n  *Theorem #context c.display():*\n  #it\n]\n\n#let d = counter(\"definition\")\n#let definition(it) = block[\n  #d.step()\n  *Definition #context d.display():*\n  #it\n]\n\n#include \"vector_spaces.typ\"\n\n#include \"linear_span.typ\"\n\n</code></pre>\n<p>I now have want to use the counter in my <code>vector_spaces.typ</code> and <code>linear_span.typ</code> file in a consistent way so that the number increments correctly across the files.</p>\n<p>How can I do so?</p>\n<p>I tried importing from my main file to each section file, but that did not work.</p>\n<p>Any guidance would be much appreciated!</p>",
      "raw": "Hi,\n\nI have defined a custom counter sin my `main.typ` file as follows:\n\n```\n\n#let c = counter(\"theorem\")\n#let theorem(it) = block[\n  #c.step()\n  *Theorem #context c.display():*\n  #it\n]\n\n#let d = counter(\"definition\")\n#let definition(it) = block[\n  #d.step()\n  *Definition #context d.display():*\n  #it\n]\n\n#include \"vector_spaces.typ\"\n\n#include \"linear_span.typ\"\n\n```\n\nI now have want to use the counter in my `vector_spaces.typ` and `linear_span.typ` file in a consistent way so that the number increments correctly across the files.\n\nHow can I do so?\n\nI tried importing from my main file to each section file, but that did not work.\n\nAny guidance would be much appreciated!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 209.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 953
    },
    {
      "id": 6751,
      "post_number": 2,
      "username": "ziggy",
      "name": "ziggy",
      "created_at": "2024-12-19T01:05:31.988Z",
      "updated_at": "2024-12-19T01:05:31.988Z",
      "cooked": "<p>Actually I figured it out - I just extracted the functions to a separate utils file and imported it into all the included files.</p>",
      "raw": "Actually I figured it out - I just extracted the functions to a separate utils file and imported it into all the included files.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 18.8,
      "accepted_answer": true,
      "trust_level": 0,
      "user_id": 953
    },
    {
      "id": 6758,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-19T04:22:27.173Z",
      "updated_at": "2024-12-19T04:22:27.173Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/ziggy\">@ziggy</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, please make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @ziggy, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, please make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 20,
      "score": 19.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:53:31.630044"
}
{
  "topic_metadata": {
    "id": 2143,
    "title": "How to format Roman O in math mode?",
    "slug": "how-to-format-roman-o-in-math-mode",
    "posts_count": 7,
    "created_at": "2024-12-19T01:39:14.857Z",
    "last_posted_at": "2024-12-20T14:40:27.090Z",
    "views": 153,
    "like_count": 3,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "Mark_Dean",
    "tags": [
      "math"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 450
  },
  "posts": [
    {
      "id": 6753,
      "post_number": 1,
      "username": "Mark_Dean",
      "name": "Mark Dean",
      "created_at": "2024-12-19T01:39:15.021Z",
      "updated_at": "2024-12-19T04:22:59.271Z",
      "cooked": "<p>I want to write a simple chemical formula of the type:</p>\n<p>$“Cu”_2\"O\"_2$</p>\n<p>Why does typst format the O as italic and not Roman as it should be when enclosed with “”?</p>",
      "raw": "I want to write a simple chemical formula of the type:\n\n$\"Cu\"_2\"O\"_2$\n\nWhy does typst format the O as italic and not Roman as it should be when enclosed with \"\"?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 221.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 954
    },
    {
      "id": 6759,
      "post_number": 2,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-19T04:23:10.190Z",
      "updated_at": "2024-12-19T04:23:10.190Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/mark_dean\">@Mark_Dean</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Mark_Dean, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 26.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6760,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-19T04:31:59.643Z",
      "updated_at": "2024-12-19T04:32:27.275Z",
      "cooked": "<p>This is a known bug and there have been several attempts to fix it, without success so far. It is an interaction with how typing a single letter (e.g. <code>x</code>) produces a variable.</p>\n<p>You can work around this by typing <code>upright(\"O\")</code>, or even (in a pinch) <code>\" O\"</code> or similar.</p>\n<p>But given your intentions, as you appear to be typesetting chemical equations, I’ll first and foremost recommend the <code>whalogen</code> package, which seems to be made for this: <a href=\"https://typst.app/universe/package/whalogen\" class=\"inline-onebox\">whalogen – Typst Universe</a></p>\n<p>If it doesn’t satisfy your needs, however, here are several alternatives. You can use variables to save some typing:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// Alternative 1 (requires '#' to disambiguate with variables, more annoying)\n#let O = $upright(\"O\")$\n\n// Alternative 2 (does not require '#', better)\n#let Ox = $upright(\"O\")$\n\n// Also, just for completeness:\n#let Cu = $\"Cu\"$\n\n// Usage of both:\n\n// Requires semicolon as \"#O_2\" is a valid variable name...\n$ Cu_2 #O;_2 $\n\n// A bit saner in my opinion\n$ Cu_2 Ox_2 $\n</code></pre>\n<p>An alternative is to use a show rule to ensure all isolated 'O’s in math mode are typeset as upright. I’d recommend isolating the show rule in a dedicated function in this case, to not affect mathematical equations:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let ce(body) = {\n  show math.equation: it =&gt; {\n     show regex(\"\\bO\\b\"): math.upright\n     it\n  }\n  body\n}\n\n\n#ce($ \"Cu\"_2 O_2 $)\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/3/3477e0885fa1d4f089f015ba6afbc4d80bbc9244.png\" alt=\"Cu2O2 (no italic O)\" data-base62-sha1=\"7u9Fa7PO33h0k7mqgmrnlHjl8dm\" width=\"263\" height=\"152\"></p>\n<p>(<strong>By the way:</strong> You can also insert syntax-highlighted Typst code snippets with ```typ SOME CODE HERE``` , try it out!)</p>",
      "raw": "This is a known bug and there have been several attempts to fix it, without success so far. It is an interaction with how typing a single letter (e.g. `x`) produces a variable.\n\n\n\nYou can work around this by typing `upright(\"O\")`, or even (in a pinch) `\" O\"` or similar.\n\nBut given your intentions, as you appear to be typesetting chemical equations, I'll first and foremost recommend the `whalogen` package, which seems to be made for this: https://typst.app/universe/package/whalogen\n\nIf it doesn't satisfy your needs, however, here are several alternatives. You can use variables to save some typing:\n\n\n```typ\n// Alternative 1 (requires '#' to disambiguate with variables, more annoying)\n#let O = $upright(\"O\")$\n\n// Alternative 2 (does not require '#', better)\n#let Ox = $upright(\"O\")$\n\n// Also, just for completeness:\n#let Cu = $\"Cu\"$\n\n// Usage of both:\n\n// Requires semicolon as \"#O_2\" is a valid variable name...\n$ Cu_2 #O;_2 $\n\n// A bit saner in my opinion\n$ Cu_2 Ox_2 $\n```\n\nAn alternative is to use a show rule to ensure all isolated 'O's in math mode are typeset as upright. I'd recommend isolating the show rule in a dedicated function in this case, to not affect mathematical equations:\n\n```typ\n#let ce(body) = {\n  show math.equation: it => {\n     show regex(\"\\bO\\b\"): math.upright\n     it\n  }\n  body\n}\n\n\n#ce($ \"Cu\"_2 O_2 $)\n```\n![Cu2O2 (no italic O)|263x152](upload://7u9Fa7PO33h0k7mqgmrnlHjl8dm.png)\n\n(**By the way:** You can also insert syntax-highlighted Typst code snippets with \\`\\`\\`typ SOME CODE HERE\\`\\`\\` , try it out!)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 34,
      "score": 36.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6770,
      "post_number": 4,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-19T10:43:36.453Z",
      "updated_at": "2024-12-19T10:44:48.757Z",
      "cooked": "<p>FYI, there exists another package for that purpose by <a class=\"mention\" href=\"/u/james\">@James</a> (I think), which seems to support more notations than whalogen (at least on the upstream version).</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/chem-par:0.0.1\": *\n#show: chem-style\nCu2O2\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/9/91ce9f6b1479b9d8aa26807600029703b4402e70.png\" alt=\"image\" data-base62-sha1=\"kNRV3Tl3cbQEG9AC2Ru6hYfLK6c\" width=\"606\" height=\"298\"></p>",
      "raw": "FYI, there exists another package for that purpose by @James (I think), which seems to support more notations than whalogen (at least on the upstream version).\n\n```typ\n#import \"@preview/chem-par:0.0.1\": *\n#show: chem-style\nCu2O2\n```\n![image|606x298](upload://kNRV3Tl3cbQEG9AC2Ru6hYfLK6c.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 31,
      "score": 21.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6779,
      "post_number": 5,
      "username": "Mark_Dean",
      "name": "Mark Dean",
      "created_at": "2024-12-19T15:58:51.324Z",
      "updated_at": "2024-12-19T15:58:51.324Z",
      "cooked": "<p>Thank you all.</p>\n<p>I’m writing a CV without any math, and without much desire to include more dependencies. For me, it is sufficient to suppress all math mode italic O.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show math.equation: it =&gt; {\n     show regex(\"\\bO\\b\"): math.upright\n     it\n  }\n</code></pre>",
      "raw": "Thank you all. \n\nI'm writing a CV without any math, and without much desire to include more dependencies. For me, it is sufficient to suppress all math mode italic O. \n\n```typ\n#show math.equation: it => {\n     show regex(\"\\bO\\b\"): math.upright\n     it\n  }\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 4.8,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 954
    },
    {
      "id": 6795,
      "post_number": 6,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-20T05:20:47.177Z",
      "updated_at": "2024-12-20T05:20:47.177Z",
      "cooked": "<p>Sounds great <a class=\"mention\" href=\"/u/mark_dean\">@Mark_Dean</a>. If a particular reply solved your problem, would you mind marking it as a solution with the <img src=\"https://forum.typst.app/images/emoji/apple/white_check_mark.png?v=12\" title=\":white_check_mark:\" class=\"emoji\" alt=\":white_check_mark:\" loading=\"lazy\" width=\"20\" height=\"20\"> (check mark) button? Thanks!</p>",
      "raw": "Sounds great @Mark_Dean. If a particular reply solved your problem, would you mind marking it as a solution with the :white_check_mark: (check mark) button? Thanks!",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 9.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6801,
      "post_number": 7,
      "username": "Mark_Dean",
      "name": "Mark Dean",
      "created_at": "2024-12-20T14:40:27.090Z",
      "updated_at": "2024-12-20T14:40:27.090Z",
      "cooked": "<p>I just ticked it. Thanks for the help.</p>",
      "raw": "I just ticked it. Thanks for the help.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 19,
      "score": 48.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 954
    }
  ],
  "scraped_at": "2025-06-10T09:53:30.803695"
}
{
  "topic_metadata": {
    "id": 2171,
    "title": "How to write from right to left?",
    "slug": "how-to-write-from-right-to-left",
    "posts_count": 4,
    "created_at": "2024-12-21T12:23:50.087Z",
    "last_posted_at": "2024-12-25T08:12:42.242Z",
    "views": 183,
    "like_count": 1,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "laurmaedje",
    "tags": [
      "scripting",
      "layout"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 156
  },
  "posts": [
    {
      "id": 6817,
      "post_number": 1,
      "username": "Ahmad",
      "name": "Ahmad",
      "created_at": "2024-12-21T12:23:50.239Z",
      "updated_at": "2024-12-23T01:05:35.525Z",
      "cooked": "<p>I am new to the typst and latex environment, how can I make the text appear in the pdf from right to left (I usually don’t type in English)</p>",
      "raw": "I am new to the typst and latex environment, how can I make the text appear in the pdf from right to left (I usually don't type in English)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 37,
      "score": 492.4,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 965
    },
    {
      "id": 6818,
      "post_number": 2,
      "username": "laurmaedje",
      "name": "Laurenz Mädje",
      "created_at": "2024-12-21T12:40:19.837Z",
      "updated_at": "2024-12-21T12:40:43.721Z",
      "cooked": "<p>Try <code>#set text(lang: \"ar\")</code> (potentially replacing ar with the language code for your language). This will configure the text language and the text direction as well.</p>\n<p>You can also write just <code>#set text(dir: rtl)</code> but setting the language directly is better as other subsystems can also adjust themselves.</p>",
      "raw": "Try `#set text(lang: \"ar\")` (potentially replacing ar with the language code for your language). This will configure the text language and the text direction as well. \n\nYou can also write just `#set text(dir: rtl)` but setting the language directly is better as other subsystems can also adjust themselves.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 36,
      "score": 57.2,
      "accepted_answer": true,
      "trust_level": 4,
      "user_id": 2
    },
    {
      "id": 6905,
      "post_number": 3,
      "username": "RoseL",
      "name": "RoseL",
      "created_at": "2024-12-25T07:54:33.477Z",
      "updated_at": "2024-12-25T07:54:33.477Z",
      "cooked": "<p>I also want to ask that how to write from up to down like traditional Chinese articles — where if arabic numbers and latin characters occurs, they will rotate a right angle clockwise.</p>",
      "raw": "I also want to ask that how to write from up to down like traditional Chinese articles --- where if arabic numbers and latin characters occurs, they will rotate a right angle clockwise.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 19.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 149
    },
    {
      "id": 6907,
      "post_number": 4,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-25T08:12:42.242Z",
      "updated_at": "2024-12-25T08:12:42.242Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/rosel\">@RoseL</a> and welcome! I think your post deserves a separate topic (I think this can be split by one of the mods).</p>\n<p>Vertical typsetting is not supported yet for non latin scripts, see the tracking issue: <a href=\"https://github.com/typst/typst/issues/193\" class=\"inline-onebox\">Advanced East-Asian layout features · Issue #193 · typst/typst · GitHub</a>.</p>",
      "raw": "Hello @RoseL and welcome! I think your post deserves a separate topic (I think this can be split by one of the mods).\n\nVertical typsetting is not supported yet for non latin scripts, see the tracking issue: https://github.com/typst/typst/issues/193.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 9.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    }
  ],
  "scraped_at": "2025-06-10T09:53:30.092513"
}
{
  "topic_metadata": {
    "id": 2173,
    "title": "How to connect `where`-clauses with `or`?",
    "slug": "how-to-connect-where-clauses-with-or",
    "posts_count": 8,
    "created_at": "2024-12-21T17:57:40.078Z",
    "last_posted_at": "2024-12-28T16:39:52.231Z",
    "views": 360,
    "like_count": 12,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "xkevio",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 325
  },
  "posts": [
    {
      "id": 6823,
      "post_number": 1,
      "username": "Roland_Schatzle",
      "name": "Roland Schätzle",
      "created_at": "2024-12-21T17:57:40.204Z",
      "updated_at": "2024-12-22T14:17:38.516Z",
      "cooked": "<p>It may be a trivial question, but I have no clue on how to connect several <code>where</code>-selectors with <code>or</code>. I have the following show-rule</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show outline.entry.where(level: 2): it =&gt; {\n</code></pre>\n<p>and would like to apply it not only to <code>level: 2</code>, but also to <code>level: 3</code>. I’ve tried different variations with <code>or.</code>, but non of them worked.</p>",
      "raw": "It may be a trivial question, but I have no clue on how to connect several `where`-selectors with `or`. I have the following show-rule\n\n```typ\n#show outline.entry.where(level: 2): it => {\n```\n\nand would like to apply it not only to `level: 2`, but also to `level: 3`. I've tried different variations with `or.`, but non of them worked.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 62,
      "score": 1232.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 966
    },
    {
      "id": 6826,
      "post_number": 2,
      "username": "xkevio",
      "name": "Kevio",
      "created_at": "2024-12-21T19:31:03.098Z",
      "updated_at": "2024-12-21T19:31:03.098Z",
      "cooked": "<p>You have to basically re-specify the full element, like so:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show outline.entry.where(level: 2).or(outline.entry.where(level: 3)): ...\n</code></pre>",
      "raw": "You have to basically re-specify the full element, like so:\n```typ\n#show outline.entry.where(level: 2).or(outline.entry.where(level: 3)): ...\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 62,
      "score": 72.2,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 21
    },
    {
      "id": 6827,
      "post_number": 3,
      "username": "Roland_Schatzle",
      "name": "Roland Schätzle",
      "created_at": "2024-12-21T19:51:42.395Z",
      "updated_at": "2024-12-21T19:51:42.395Z",
      "cooked": "<p>Ah thanks, indeed, that does the trick <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Ah thanks, indeed, that does the trick :slight_smile:",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 60,
      "score": 16.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 966
    },
    {
      "id": 6839,
      "post_number": 4,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-22T14:17:50.137Z",
      "updated_at": "2024-12-22T14:17:50.137Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/roland_schatzle\">@Roland_Schatzle</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Roland_Schatzle, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 51,
      "score": 15.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6998,
      "post_number": 5,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-28T14:24:05.343Z",
      "updated_at": "2024-12-28T14:24:05.343Z",
      "cooked": "<p>Note that you can also use a loop (or more precisely, the <code>array.map()</code> method) to generate the selector:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show selector.or(..(2, 3).map(level =&gt; outline.entry.where(level: level)): ...\n</code></pre>\n<p>this makes it easier to specify multiple levels</p>",
      "raw": "Note that you can also use a loop (or more precisely, the `array.map()` method) to generate the selector:\n```typ\n#show selector.or(..(2, 3).map(level => outline.entry.where(level: level)): ...\n```\nthis makes it easier to specify multiple levels",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 5,
      "reads": 34,
      "score": 166.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7004,
      "post_number": 6,
      "username": "Roland_Schatzle",
      "name": "Roland Schätzle",
      "created_at": "2024-12-28T14:36:53.761Z",
      "updated_at": "2024-12-28T14:37:29.171Z",
      "cooked": "<p>That’s an interesting approach! But I have difficulties understanding it. What is the precedence of the operations <code>or</code>, <code>..</code> and <code>map</code>?</p>",
      "raw": "That's an interesting approach! But I have difficulties understanding it. What is the precedence of the operations `or`, `..` and `map`?",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 16.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 966
    },
    {
      "id": 7014,
      "post_number": 7,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-28T15:17:39.792Z",
      "updated_at": "2024-12-28T15:17:39.792Z",
      "cooked": "<p>Let’s break it down:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// this is a function that takes a number as a parameter,\n// and returns a selector for a specific outline entry level\n#let mapper = level =&gt; outline.entry.where(level: level)\n// this is an array of multiple selectors, created by taking\n// each number in the original array, giving it to the function,\n// then putting all the results together in a new array\n#let levels = (2, 3).map(mapper)\n// this is the combination of all the selectors. The or()\n// function takes any number of parameters, and .. separates\n// the array elements into separate parameters\n#let complete = selector.or(..levels)\n// this selector is used for the show rule\n#show complete: ...\n</code></pre>",
      "raw": "Let's break it down:\n```typ\n// this is a function that takes a number as a parameter,\n// and returns a selector for a specific outline entry level\n#let mapper = level => outline.entry.where(level: level)\n// this is an array of multiple selectors, created by taking\n// each number in the original array, giving it to the function,\n// then putting all the results together in a new array\n#let levels = (2, 3).map(mapper)\n// this is the combination of all the selectors. The or()\n// function takes any number of parameters, and .. separates\n// the array elements into separate parameters\n#let complete = selector.or(..levels)\n// this selector is used for the show rule\n#show complete: ...\n```",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 32,
      "score": 66.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7018,
      "post_number": 8,
      "username": "Roland_Schatzle",
      "name": "Roland Schätzle",
      "created_at": "2024-12-28T16:39:52.231Z",
      "updated_at": "2024-12-28T16:39:52.231Z",
      "cooked": "<p>Ok, thanks, now I understand it in detail!</p>",
      "raw": "Ok, thanks, now I understand it in detail!",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 5.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 966
    }
  ],
  "scraped_at": "2025-06-10T09:53:29.382756"
}
{
  "topic_metadata": {
    "id": 2175,
    "title": "How to display a short version of a heading inside the header?",
    "slug": "how-to-display-a-short-version-of-a-heading-inside-the-header",
    "posts_count": 8,
    "created_at": "2024-12-21T18:58:11.093Z",
    "last_posted_at": "2024-12-22T18:06:27.694Z",
    "views": 256,
    "like_count": 3,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 8,
    "accepted_answer_username": "flokl",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 578
  },
  "posts": [
    {
      "id": 6825,
      "post_number": 1,
      "username": "jlb",
      "name": "Jean-Louis",
      "created_at": "2024-12-21T18:58:11.206Z",
      "updated_at": "2024-12-23T01:05:00.127Z",
      "cooked": "<p>I have very long titles in a document and I would like to have shorter versions in the header.</p>\n<p>Example:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">= Chapter 1: My chapter title is very long and I want a shorter title in the header\n</code></pre>\n<p>If possible, I would like to have a short and a long string for each chapter: the long string in the body of the document and the short string in the header.</p>\n<p>I don’t know how to do this with the hydra package or just typst.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let chapter(long_title:\"\", short_title:\"\") = {\n\t[= #long_title]\n}\n\n#chapter(long_title:\"= Chapter 1: My chapter title is very long and I want a shorter title in the header\", short_title:\"My short title\")\n</code></pre>\n<p>How to do have short_title in the header ?</p>",
      "raw": "I have very long titles in a document and I would like to have shorter versions in the header.\n\nExample:\n```typ\n= Chapter 1: My chapter title is very long and I want a shorter title in the header\n```\nIf possible, I would like to have a short and a long string for each chapter: the long string in the body of the document and the short string in the header.\n\nI don't know how to do this with the hydra package or just typst.\n\n```typst\n#let chapter(long_title:\"\", short_title:\"\") = {\n\t[= #long_title]\n}\n\n#chapter(long_title:\"= Chapter 1: My chapter title is very long and I want a shorter title in the header\", short_title:\"My short title\")\n```\n\nHow to do have short_title in the header ?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 56,
      "score": 711.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 809
    },
    {
      "id": 6831,
      "post_number": 3,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-22T11:21:04.241Z",
      "updated_at": "2024-12-22T13:52:07.089Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/jlb\">@jlb</a>, this is possible using a combination of queries in the page header. You will find below a full example that also supports numbering, which is trickier in the header as it is right before the heading.</p>\n<aside class=\"quote no-group\" data-username=\"laurmaedje\" data-post=\"10\" data-topic=\"1924\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/laurmaedje/48/14_2.png\" class=\"avatar\"><a href=\"https://forum.typst.app/t/how-to-reset-the-page-counter-after-every-section/1924/10\">How to reset the page counter after every section?</a></div>\n<blockquote>\n<p>The counter is resolved based on the logical order of things: The header is logically before the page content, which is followed by the footer.</p>\n</blockquote>\n</aside>\n<p>Queries are very powerful indeed, don’t hesitate to play with them. You can also inspect the content of queries directly by hovering over the variable. See</p><aside class=\"quote quote-modified\" data-post=\"1\" data-topic=\"1311\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/sebastianjl/48/870_2.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/what-are-the-values-that-are-shown-when-hovering-over-a-variable/1311\">What are the values that are shown when hovering over a variable?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    Oh I never knew that. What are the many different versions that it shows? Just examples? \n <a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/9cf71c52d85faeabda153394ed276467d1b609a6.png\" data-download-href=\"https://forum.typst.app/uploads/default/9cf71c52d85faeabda153394ed276467d1b609a6\" title=\"image\">[image]</a> \nOn the image you can only see two, but there are around 9 available with scrolling.\n  </blockquote>\n</aside>\n\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set heading(numbering: \"1.1\")\n#show heading.where(level: 1): set heading(supplement: \"Chapter\")\n#set page(header: context {\n  let h = query(selector(heading.where(level: 1)).before(here()))\n  if h.len() == 0 {\n    h = query(selector(heading.where(level: 1)).after(here())).first()\n  } else {\n    h = h.last()\n  }\n  let s = query(selector(metadata).after(h.location())).filter(it =&gt; it.value.children.first().text  == \"h:\").first()\n  let short = s.value.children.slice(1).first()\n  align(center, {\n    h.supplement\n    \" \"\n    if h.numbering != none { numbering(h.numbering, ..counter(heading).at(s.location())) }\n    [ -- ]\n    short\n  })\n})\n#let chapter(long, short) = {\n  heading(long) \n  metadata(\"h:\" + short)\n}\n\n#chapter[This is a very long title][Short 1]\n\n#pagebreak()\n\n#chapter[Long][Short 2]\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/3/38af046a003eed9221df6d8a4b6f34ca4cc24167.png\" data-download-href=\"https://forum.typst.app/uploads/default/38af046a003eed9221df6d8a4b6f34ca4cc24167\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/3/38af046a003eed9221df6d8a4b6f34ca4cc24167_2_690x44.png\" alt=\"image\" data-base62-sha1=\"85rI5iXYeEw8RwIbeRb7ZoH5ZFZ\" width=\"690\" height=\"44\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/3/38af046a003eed9221df6d8a4b6f34ca4cc24167_2_690x44.png, https://forum.typst.app/uploads/default/optimized/2X/3/38af046a003eed9221df6d8a4b6f34ca4cc24167_2_1035x66.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/3/38af046a003eed9221df6d8a4b6f34ca4cc24167_2_1380x88.png 2x\" data-dominant-color=\"FCFCFC\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1771×115 10.2 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "Hello @jlb, this is possible using a combination of queries in the page header. You will find below a full example that also supports numbering, which is trickier in the header as it is right before the heading.\n[quote=\"laurmaedje, post:10, topic:1924\"]\nThe counter is resolved based on the logical order of things: The header is logically before the page content, which is followed by the footer.\n[/quote]\n\nQueries are very powerful indeed, don't hesitate to play with them. You can also inspect the content of queries directly by hovering over the variable. See\nhttps://forum.typst.app/t/what-are-the-values-that-are-shown-when-hovering-over-a-variable/1311\n\n```typ\n#set heading(numbering: \"1.1\")\n#show heading.where(level: 1): set heading(supplement: \"Chapter\")\n#set page(header: context {\n  let h = query(selector(heading.where(level: 1)).before(here()))\n  if h.len() == 0 {\n    h = query(selector(heading.where(level: 1)).after(here())).first()\n  } else {\n    h = h.last()\n  }\n  let s = query(selector(metadata).after(h.location())).filter(it => it.value.children.first().text  == \"h:\").first()\n  let short = s.value.children.slice(1).first()\n  align(center, {\n    h.supplement\n    \" \"\n    if h.numbering != none { numbering(h.numbering, ..counter(heading).at(s.location())) }\n    [ -- ]\n    short\n  })\n})\n#let chapter(long, short) = {\n  heading(long) \n  metadata(\"h:\" + short)\n}\n\n#chapter[This is a very long title][Short 1]\n\n#pagebreak()\n\n#chapter[Long][Short 2]\n```\n![image|690x44](upload://85rI5iXYeEw8RwIbeRb7ZoH5ZFZ.png)",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 47,
      "score": 44.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6835,
      "post_number": 4,
      "username": "jlb",
      "name": "Jean-Louis",
      "created_at": "2024-12-22T13:31:43.981Z",
      "updated_at": "2024-12-22T13:33:27.188Z",
      "cooked": "<p>Thanks a lot.</p>\n<p>But it doesn’t work with this markup :</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#chapter[Long title 1][Short 1]\n#lorem(2000)\n\n#chapter[Long title 2][Short 2]\n#lorem(2000)\n\n#chapter[Long title 3][Short 3]\n#lorem(2000)\n</code></pre>",
      "raw": "Thanks a lot.\n\nBut it doesn't work with this markup : \n\n```typst\n#chapter[Long title 1][Short 1]\n#lorem(2000)\n\n#chapter[Long title 2][Short 2]\n#lorem(2000)\n\n#chapter[Long title 3][Short 3]\n#lorem(2000)\n```",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 12.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 809
    },
    {
      "id": 6836,
      "post_number": 5,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-22T13:51:49.225Z",
      "updated_at": "2024-12-22T13:52:19.858Z",
      "cooked": "<aside class=\"quote no-group quote-modified\" data-username=\"quachpas\" data-post=\"3\" data-topic=\"2175\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/q/662200/48.png\" class=\"avatar\"> quachpas:</div>\n<blockquote>\n<pre><code class=\"lang-auto\">  let h = query(selector(heading.where(level: 1)).after(here())).first()\n</code></pre>\n</blockquote>\n</aside>\n<p>I updated the implementation to fix this <img src=\"https://forum.typst.app/images/emoji/apple/smiley.png?v=12\" title=\":smiley:\" class=\"emoji\" alt=\":smiley:\" loading=\"lazy\" width=\"20\" height=\"20\">. It was missing edge cases, thanks for the reply</p>",
      "raw": "[quote=\"quachpas, post:3, topic:2175\"]\n```\n  let h = query(selector(heading.where(level: 1)).after(here())).first()\n```\n[/quote]\n\nI updated the implementation to fix this :smiley:. It was missing edge cases, thanks for the reply",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 34,
      "score": 11.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6838,
      "post_number": 6,
      "username": "jlb",
      "name": "Jean-Louis",
      "created_at": "2024-12-22T14:09:19.550Z",
      "updated_at": "2024-12-22T14:10:48.039Z",
      "cooked": "<p>Sorry, I have another problem with this markup :</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#chapter[Long title 1][Short 1]\n#lorem(2000)\n\n#chapter[Long title 2][Short 2]\n#lorem(2000)\n\n#chapter[Long title 3][Short 3]\n#lorem(2000)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/7/786e48d21e30d174c3585de6b4a55e08595e80eb.png\" data-download-href=\"https://forum.typst.app/uploads/default/786e48d21e30d174c3585de6b4a55e08595e80eb\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/7/786e48d21e30d174c3585de6b4a55e08595e80eb_2_690x126.png\" alt=\"image\" data-base62-sha1=\"hbnzWNiNZuRDCJKFOJHG7gzNMAb\" width=\"690\" height=\"126\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/7/786e48d21e30d174c3585de6b4a55e08595e80eb_2_690x126.png, https://forum.typst.app/uploads/default/optimized/2X/7/786e48d21e30d174c3585de6b4a55e08595e80eb_2_1035x189.png 1.5x, https://forum.typst.app/uploads/default/original/2X/7/786e48d21e30d174c3585de6b4a55e08595e80eb.png 2x\" data-dominant-color=\"F5F5F5\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1253×230 33 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>“Chapter 1 - Short 1” header with \"“Chapter 2 - Short 2” heading</p>",
      "raw": "Sorry, I have another problem with this markup : \n\n```typst \n#chapter[Long title 1][Short 1]\n#lorem(2000)\n\n#chapter[Long title 2][Short 2]\n#lorem(2000)\n\n#chapter[Long title 3][Short 3]\n#lorem(2000)\n```\n\n![image|690x126](upload://hbnzWNiNZuRDCJKFOJHG7gzNMAb.png)\n\n\"Chapter 1 - Short 1\" header with \"\"Chapter 2 - Short 2\" heading",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 21.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 809
    },
    {
      "id": 6841,
      "post_number": 7,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-22T14:24:37.246Z",
      "updated_at": "2024-12-22T14:24:37.246Z",
      "cooked": "<p>Hmmm, I think that should be achievable by checking the page number to ensure correctness. I don’t have time atm, so if someone else passes by, feel free to try.</p>",
      "raw": "Hmmm, I think that should be achievable by checking the page number to ensure correctness. I don't have time atm, so if someone else passes by, feel free to try.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 16.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6845,
      "post_number": 8,
      "username": "flokl",
      "name": "",
      "created_at": "2024-12-22T17:35:14.839Z",
      "updated_at": "2024-12-22T17:36:32.670Z",
      "cooked": "<p>Hi,</p>\n<p>here is a solution using hydra.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/hydra:0.5.1\": hydra, selectors\n#import selectors: custom\n\n#let chapter(long, short) = {\n  [#metadata(short)&lt;short&gt;]\n  heading(long)\n}\n\n#set page(\n  header: context hydra(\n    skip-starting: false,\n    custom(&lt;short&gt;),\n    display: (_, elem) =&gt; {\n      elem.value\n    }\n  )\n)\n\n#chapter[Long title 1][Short 1]\n#lorem(2000)\n\n#chapter[Long title 2][Short 2]\n#lorem(2000)\n\n#chapter[Long title 3][Short 3]\n#lorem(2000)\n</code></pre>",
      "raw": "Hi,\n\nhere is a solution using hydra.\n\n```typ\n#import \"@preview/hydra:0.5.1\": hydra, selectors\n#import selectors: custom\n\n#let chapter(long, short) = {\n  [#metadata(short)<short>]\n  heading(long)\n}\n\n#set page(\n  header: context hydra(\n    skip-starting: false,\n    custom(<short>),\n    display: (_, elem) => {\n      elem.value\n    }\n  )\n)\n\n#chapter[Long title 1][Short 1]\n#lorem(2000)\n\n#chapter[Long title 2][Short 2]\n#lorem(2000)\n\n#chapter[Long title 3][Short 3]\n#lorem(2000)\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 32,
      "score": 66.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 6846,
      "post_number": 9,
      "username": "jlb",
      "name": "Jean-Louis",
      "created_at": "2024-12-22T18:06:27.694Z",
      "updated_at": "2024-12-22T18:06:27.694Z",
      "cooked": "<p>Yes, it works, thanks a lot.</p>",
      "raw": "Yes, it works, thanks a lot.",
      "reply_to_post_number": 8,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 6.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 809
    }
  ],
  "scraped_at": "2025-06-10T09:53:28.673124"
}
{
  "topic_metadata": {
    "id": 2178,
    "title": "How to change spacing between a paragraph and the next subheading?",
    "slug": "how-to-change-spacing-between-a-paragraph-and-the-next-subheading",
    "posts_count": 4,
    "created_at": "2024-12-22T12:40:24.105Z",
    "last_posted_at": "2024-12-23T13:08:59.557Z",
    "views": 197,
    "like_count": 3,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "Eric",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 232
  },
  "posts": [
    {
      "id": 6834,
      "post_number": 1,
      "username": "jddotdk",
      "name": "Jannik Derval",
      "created_at": "2024-12-22T12:40:24.268Z",
      "updated_at": "2024-12-22T20:47:05.439Z",
      "cooked": "<p>Hi everybody, I’m new to Typst and have a layout question:</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/5/5731d13eff91aab07dc6fbba436afd3e45165290.png\" alt=\"image\" data-base62-sha1=\"crmgVYw7RiPY4Qu3VpBpFetHJ9S\" width=\"665\" height=\"198\"></p>\n<p>As you can see in the image, the spacing above and below my list isn’t equal. I have <span class=\"hashtag-raw\">#set</span> par(spacing: 2em) so the spacing between paragraphs is 2 em. But this doesn’t apply to the space between a paragraph/list and the next subheading. How do I make this space (below the list) 2 em as well?</p>\n<p>Thanks.</p>",
      "raw": "Hi everybody, I'm new to Typst and have a layout question:\n\n![image|665x198](upload://crmgVYw7RiPY4Qu3VpBpFetHJ9S.png)\n\nAs you can see in the image, the spacing above and below my list isn't equal. I have #set par(spacing: 2em) so the spacing between paragraphs is 2 em. But this doesn't apply to the space between a paragraph/list and the next subheading. How do I make this space (below the list) 2 em as well?\n\nThanks.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 35,
      "score": 626.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 967
    },
    {
      "id": 6840,
      "post_number": 2,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-22T14:19:05.742Z",
      "updated_at": "2024-12-22T14:19:05.742Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/jddotdk\">@jddotdk</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, please make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @jddotdk, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, please make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 35,
      "score": 31.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6848,
      "post_number": 3,
      "username": "jddotdk",
      "name": "Jannik Derval",
      "created_at": "2024-12-22T21:19:51.702Z",
      "updated_at": "2024-12-22T21:19:51.702Z",
      "cooked": "<p>Hi again,</p>\n<p>I fixed the spacing by putting <code>#v(2em, weak: true)</code> after the list.</p>",
      "raw": "Hi again,\n\nI fixed the spacing by putting `#v(2em, weak: true)` after the list.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 11.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 967
    },
    {
      "id": 6875,
      "post_number": 4,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2024-12-23T13:08:59.557Z",
      "updated_at": "2024-12-23T13:08:59.557Z",
      "cooked": "<p>If you don’t want to insert the spacing elements by hand all the time, you can also set the spacing around headings once via a show-set rule. You can then also filter them by level:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading: set block(above: 2em, below: 1em)\n#show heading.where(level: 1): set block(spacing: 2em) // both above and below\n</code></pre>\n<p>Note that when using <code>em</code> units here, they are relative to the heading’s font size, which is usually larger than the font size of the main text!</p>",
      "raw": "If you don't want to insert the spacing elements by hand all the time, you can also set the spacing around headings once via a show-set rule. You can then also filter them by level:\n\n```typ\n#show heading: set block(above: 2em, below: 1em)\n#show heading.where(level: 1): set block(spacing: 2em) // both above and below\n```\n\nNote that when using `em` units here, they are relative to the heading's font size, which is usually larger than the font size of the main text!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 25,
      "score": 44.8,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    }
  ],
  "scraped_at": "2025-06-10T09:53:27.962656"
}
{
  "topic_metadata": {
    "id": 2187,
    "title": "How can I get rid of the spacing after an in document reference?",
    "slug": "how-can-i-get-rid-of-the-spacing-after-an-in-document-reference",
    "posts_count": 3,
    "created_at": "2024-12-23T15:23:48.770Z",
    "last_posted_at": "2024-12-24T11:16:03.652Z",
    "views": 182,
    "like_count": 1,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "flokl",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 433
  },
  "posts": [
    {
      "id": 6876,
      "post_number": 1,
      "username": "Timo",
      "name": "Timo",
      "created_at": "2024-12-23T15:23:48.881Z",
      "updated_at": "2024-12-25T03:11:03.094Z",
      "cooked": "<p>I am trying to reference a chapter which I labeled e.g.:<br>\n<code>== Chapter &lt;chapter_label&gt;</code></p>\n<p>Now when I try to reference it and use a supplement, it will add a whitespace afterwards like this:<br>\n<strong>Code</strong></p>\n<pre><code class=\"lang-auto\">#set heading(\n  numbering: none\n)\nDummy Text (@chapter_label[Chapter x,y,z - text]). More Text\n</code></pre>\n<p><strong>It will look like this:</strong></p>\n<pre><code class=\"lang-auto\">Dummy Text (Chapter x,y,z - text ). More Text\n</code></pre>\n<p>How can I remove that whitespace? I think that is has something to do with the numbering being set to none, but I am not sure. I need the numbering to be set to none, so I can supply my own description of the ref. Anyone got an idea?</p>\n<p>Thanks!</p>",
      "raw": "I am trying to reference a chapter which I labeled e.g.:\n`== Chapter <chapter_label>`\n\nNow when I try to reference it and use a supplement, it will add a whitespace afterwards like this:\n**Code**\n```\n#set heading(\n  numbering: none\n)\nDummy Text (@chapter_label[Chapter x,y,z - text]). More Text\n```\n\n**It will look like this:**\n```\nDummy Text (Chapter x,y,z - text ). More Text\n```\n\nHow can I remove that whitespace? I think that is has something to do with the numbering being set to none, but I am not sure. I need the numbering to be set to none, so I can supply my own description of the ref. Anyone got an idea?\n\nThanks!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 587.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 130
    },
    {
      "id": 6894,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2024-12-24T09:15:31.673Z",
      "updated_at": "2024-12-24T09:15:31.673Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/timo\">@Timo</a>,</p>\n<p>I think you want to customize the <a href=\"https://typst.app/docs/reference/model/ref/#customization\">reference</a> element to show only your supplement.</p>\n<h2><a name=\"p-6894-direct-solution-1\" class=\"anchor\" href=\"#p-6894-direct-solution-1\"></a>Direct Solution</h2>\n<p>The 1:1 solution would be the following, but I would recommend taking a look at the second solution.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set heading(numbering: \"1.1\")\n\n#show ref: it =&gt; {\n  if it.element != none and it.element.func() == heading {\n    if it.supplement != auto {\n     link(it.element.location(), it.supplement)\n    }\n  } else {\n    it\n  }\n}\n\n= MyChapter &lt;chapter_label&gt;\n\nDummy Text (@chapter_label[Chapter x,y,z - text]). More Text\n</code></pre>\n<details>\n<summary>\nOutput</summary>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/6/656d68de9082e81390335a41cce951527b7aefdf.png\" alt=\"test\" data-base62-sha1=\"etgDhyQKkzFem4dZSCwwOHrF2ub\" width=\"521\" height=\"164\"></p>\n</details>\n<h2><a name=\"p-6894-alternative-solution-2\" class=\"anchor\" href=\"#p-6894-alternative-solution-2\"></a>Alternative Solution</h2>\n<p>I think, depending on your use case, this solution is probably better.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set heading(numbering: \"1.1\")\n\n#show ref: it =&gt; {\n  if it.element != none and it.element.func() == heading {\n    link(it.element.location(), {\n      it.element.body\n      \" \"\n      numbering(\n        it.element.numbering, \n        ..counter(heading).at(it.element.location())\n      )\n      if it.supplement != auto {\n        \" - \" + it.supplement\n      }\n    })\n  } else {\n    it\n  }\n}\n\n= MyChapter &lt;chapter_label&gt;\n\nDummy Text (@chapter_label[my supplement text]). More Text\n</code></pre>\n<details>\n<summary>\nOutput</summary>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/2/2b6e67fabfe214e8cbd355551e37ed44c7a32e86.png\" alt=\"test\" data-base62-sha1=\"6cd4FFLCFzwMJf0F8iIXD0T9Gmy\" width=\"668\" height=\"164\"></p>\n</details>",
      "raw": "Hello @Timo,\n\nI think you want to customize the [reference](https://typst.app/docs/reference/model/ref/#customization) element to show only your supplement.\n\n## Direct Solution\nThe 1:1 solution would be the following, but I would recommend taking a look at the second solution.\n```typst\n#set heading(numbering: \"1.1\")\n\n#show ref: it => {\n  if it.element != none and it.element.func() == heading {\n    if it.supplement != auto {\n     link(it.element.location(), it.supplement)\n    }\n  } else {\n    it\n  }\n}\n\n= MyChapter <chapter_label>\n\nDummy Text (@chapter_label[Chapter x,y,z - text]). More Text\n```\n\n[details=\"Output\"]\n![test|521x164](upload://etgDhyQKkzFem4dZSCwwOHrF2ub.png)\n[/details]\n\n## Alternative Solution\nI think, depending on your use case, this solution is probably better.\n```typst\n#set heading(numbering: \"1.1\")\n\n#show ref: it => {\n  if it.element != none and it.element.func() == heading {\n    link(it.element.location(), {\n      it.element.body\n      \" \"\n      numbering(\n        it.element.numbering, \n        ..counter(heading).at(it.element.location())\n      )\n      if it.supplement != auto {\n        \" - \" + it.supplement\n      }\n    })\n  } else {\n    it\n  }\n}\n\n= MyChapter <chapter_label>\n\nDummy Text (@chapter_label[my supplement text]). More Text\n```\n\n[details=\"Output\"]\n![test|668x164](upload://6cd4FFLCFzwMJf0F8iIXD0T9Gmy.png)\n\n[/details]",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 50.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 6895,
      "post_number": 3,
      "username": "Timo",
      "name": "Timo",
      "created_at": "2024-12-24T11:16:03.652Z",
      "updated_at": "2024-12-24T11:18:08.517Z",
      "cooked": "<p>Thank you very much <a class=\"mention\" href=\"/u/flokl\">@flokl</a>. I opted to use your first option as this worked better for me, but modified it to suit my needs better. It now looks like this:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#show ref: it =&gt; {\n  if it.element != none and it.supplement != none and it.element.func() == heading {\n    if it.supplement != auto {\n     link(it.element.location(), it.supplement)\n    } else {\n      it\n    }\n  } else {\n    it\n  }\n}\n</code></pre>\n<p>I have three types of references that I have to manage: .bib references, normal chapter references and attachment references (which is were I had the problem with).</p>\n<p>I added the condition that if no supplement is specified, it will go to the default case. Also I had some custom auto supplements which I needed to add an else statement for to have them shown correctly. Right now it looks like it works just fine. If I find a more elegant solution to my problem, I will post it here.</p>",
      "raw": "Thank you very much @flokl. I opted to use your first option as this worked better for me, but modified it to suit my needs better. It now looks like this:\n\n```typst\n#show ref: it => {\n  if it.element != none and it.supplement != none and it.element.func() == heading {\n    if it.supplement != auto {\n     link(it.element.location(), it.supplement)\n    } else {\n      it\n    }\n  } else {\n    it\n  }\n}\n```\nI have three types of references that I have to manage: .bib references, normal chapter references and attachment references (which is were I had the problem with).\n\nI added the condition that if no supplement is specified, it will go to the default case. Also I had some custom auto supplements which I needed to add an else statement for to have them shown correctly. Right now it looks like it works just fine. If I find a more elegant solution to my problem, I will post it here.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 14.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 130
    }
  ],
  "scraped_at": "2025-06-10T09:53:27.249938"
}
