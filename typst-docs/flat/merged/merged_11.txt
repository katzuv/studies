{
  "topic_metadata": {
    "id": 1881,
    "title": "How do I make a plot with errorbars using CeTZ plot?",
    "slug": "how-do-i-make-a-plot-with-errorbars-using-cetz-plot",
    "posts_count": 5,
    "created_at": "2024-11-25T13:18:31.583Z",
    "last_posted_at": "2024-11-25T15:21:47.790Z",
    "views": 173,
    "like_count": 0,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "ParaN3xus",
    "tags": [
      "cetz"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 265
  },
  "posts": [
    {
      "id": 6066,
      "post_number": 1,
      "username": "SolidTux",
      "name": "Daniel Hauck",
      "created_at": "2024-11-25T13:18:31.725Z",
      "updated_at": "2024-11-25T13:18:31.725Z",
      "cooked": "<p>I’m trying to plot data with errorbars. In cetz-plot, there is a function <code>add-errobars</code>, but there is no example, and I don’t understand the documentation.</p>",
      "raw": "I'm trying to plot data with errorbars. In cetz-plot, there is a function `add-errobars`, but there is no example, and I don't understand the documentation.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 736.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 572
    },
    {
      "id": 6074,
      "post_number": 2,
      "username": "ParaN3xus",
      "name": "ParaN3xus",
      "created_at": "2024-11-25T15:14:34.445Z",
      "updated_at": "2024-11-25T15:14:34.445Z",
      "cooked": "<p>For example:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">plot.add-errorbar(\n  x-error: ex,\n  y-error: ey,\n  (x, y),\n)\n</code></pre>\n<p>This will draw an error bar on the <code>plot</code> centered at <code>(x, y)</code>, with the x-direction error being <code>ex</code> and the y-direction error being <code>ey</code>. (If you don’t need the x-direction error, you can simply omit the <code>x-error</code> parameter.)</p>\n<p>However, if you want to plot in bulk, for example, if you have a bar chart with many errors to display, you can use the <code>error-key</code> parameter of <code>add-bar</code> to achieve this. But you’ll need to pre-zip the <code>x</code>, <code>y</code>, and <code>error</code> data into the same <code>array</code> (or <code>dict</code>) and specify the positions of these three types of data within the <code>array</code> (or <code>dict</code>):</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.1\"\n#import \"@preview/cetz-plot:0.1.0\"\n\n#let m = (3, 1, 4, 1, 5, 9)\n#let e = (2, 6, 5, 3, 5, 8).map(x =&gt; x * 0.1)\n\n#let data = range(m.len()).zip(m, e)\n\n#cetz.canvas({\n  import cetz-plot: *\n  plot.plot(\n    size: (11, 5),\n    {\n      plot.add-bar(\n        bar-width: .5,\n        x-key: 0,\n        y-key: 1,\n        error-key: 2,\n        data,\n      )\n    },\n  )\n})\n</code></pre>",
      "raw": "For example:\n\n```typc\nplot.add-errorbar(\n  x-error: ex,\n  y-error: ey,\n  (x, y),\n)\n```\n\nThis will draw an error bar on the `plot` centered at `(x, y)`, with the x-direction error being `ex` and the y-direction error being `ey`. (If you don’t need the x-direction error, you can simply omit the `x-error` parameter.)\n\nHowever, if you want to plot in bulk, for example, if you have a bar chart with many errors to display, you can use the `error-key` parameter of `add-bar` to achieve this. But you'll need to pre-zip the `x`, `y`, and `error` data into the same `array` (or `dict`) and specify the positions of these three types of data within the `array` (or `dict`):\n\n```typ\n#import \"@preview/cetz:0.3.1\"\n#import \"@preview/cetz-plot:0.1.0\"\n\n#let m = (3, 1, 4, 1, 5, 9)\n#let e = (2, 6, 5, 3, 5, 8).map(x => x * 0.1)\n\n#let data = range(m.len()).zip(m, e)\n\n#cetz.canvas({\n  import cetz-plot: *\n  plot.plot(\n    size: (11, 5),\n    {\n      plot.add-bar(\n        bar-width: .5,\n        x-key: 0,\n        y-key: 1,\n        error-key: 2,\n        data,\n      )\n    },\n  )\n})\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 46.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 14
    },
    {
      "id": 6075,
      "post_number": 3,
      "username": "SolidTux",
      "name": "Daniel Hauck",
      "created_at": "2024-11-25T15:16:41.803Z",
      "updated_at": "2024-11-25T15:16:41.803Z",
      "cooked": "<p>I’m not interested in a bar plot, but a scatter plot with error bars.</p>",
      "raw": "I'm not interested in a bar plot, but a scatter plot with error bars.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 10.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 572
    },
    {
      "id": 6076,
      "post_number": 4,
      "username": "ParaN3xus",
      "name": "ParaN3xus",
      "created_at": "2024-11-25T15:17:59.810Z",
      "updated_at": "2024-11-25T15:17:59.810Z",
      "cooked": "<p>Then use <code>add-errorbar</code> with a <code>for</code> loop.</p>",
      "raw": "Then use `add-errorbar` with a `for` loop.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 35.8,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 14
    },
    {
      "id": 6078,
      "post_number": 5,
      "username": "SolidTux",
      "name": "Daniel Hauck",
      "created_at": "2024-11-25T15:21:47.790Z",
      "updated_at": "2024-11-25T15:21:47.790Z",
      "cooked": "<p>Thanks! That works, but is quite annoying because it steps forward in the cycle of styles by default.</p>",
      "raw": "Thanks! That works, but is quite annoying because it steps forward in the cycle of styles by default.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 10.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 572
    }
  ],
  "scraped_at": "2025-06-10T09:54:24.697553"
}
{
  "topic_metadata": {
    "id": 1885,
    "title": "How to pass an array of to #grid?",
    "slug": "how-to-pass-an-array-of-to-grid",
    "posts_count": 5,
    "created_at": "2024-11-25T15:20:48.329Z",
    "last_posted_at": "2024-11-25T16:08:16.403Z",
    "views": 213,
    "like_count": 5,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "quachpas",
    "tags": [
      "grids"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 236
  },
  "posts": [
    {
      "id": 6077,
      "post_number": 1,
      "username": "Alseidon_Diaphore",
      "name": "Alseïdon Diaphore",
      "created_at": "2024-11-25T15:20:48.567Z",
      "updated_at": "2024-11-25T15:21:09.623Z",
      "cooked": "<p>I have this bit of code for displaying multiple images in a figure :</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let img_dir = \"../imgs/\"\n\n#let figure_two_images(path1, path2, caption) = figure(\n  grid(\n    columns: 2, gutter: 2mm,\n    image(img_dir + path1),\n    image(img_dir + path2),\n  ),\n  caption: caption\n)\n</code></pre>\n<p>Would it be possible to extend this to an array with an arbitrary number of paths ? Equivalent to</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#grid(\n  columns: 2, gutter: 2mm,\n  image(img_dir + path1),\n  image(img_dir + path2),\n  image(img_dir + path3),\n  etc.\n)\n</code></pre>\n<p>My try was the following:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let paths = (\n  \"path/to/img/1.png\",\n  \"path/to/img/2.png\"\n)\n#grid(\n  columns: 2,\n  for path in paths {\n    image(img_dir + path, width:30%)\n  }\n)\n</code></pre>\n<p>but the loop returns content, displaying it in a single column.</p>",
      "raw": "I have this bit of code for displaying multiple images in a figure :\n```typ\n#let img_dir = \"../imgs/\"\n\n#let figure_two_images(path1, path2, caption) = figure(\n  grid(\n    columns: 2, gutter: 2mm,\n    image(img_dir + path1),\n    image(img_dir + path2),\n  ),\n  caption: caption\n)\n```\nWould it be possible to extend this to an array with an arbitrary number of paths ? Equivalent to\n```typ\n#grid(\n  columns: 2, gutter: 2mm,\n  image(img_dir + path1),\n  image(img_dir + path2),\n  image(img_dir + path3),\n  etc.\n)\n```\n\nMy try was the following:\n```typ\n#let paths = (\n  \"path/to/img/1.png\",\n  \"path/to/img/2.png\"\n)\n#grid(\n  columns: 2,\n  for path in paths {\n    image(img_dir + path, width:30%)\n  }\n)\n```\nbut the loop returns content, displaying it in a single column.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 32,
      "score": 1001.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 403
    },
    {
      "id": 6080,
      "post_number": 2,
      "username": "ParaN3xus",
      "name": "ParaN3xus",
      "created_at": "2024-11-25T15:37:58.060Z",
      "updated_at": "2024-11-25T15:37:58.060Z",
      "cooked": "<p>Solution:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let img_dir = \"./\"\n\n#let figure_two_images(caption, ..pathes) = figure(\n  grid(\n    columns: 2,\n    gutter: 2mm,\n    ..pathes.pos().map(path =&gt; image(img_dir + path)),\n  ),\n  caption: caption,\n)\n\n#figure_two_images(\"Images\", \"1.png\", \"2.png\", \"3.png\")\n</code></pre>\n<p>The key concept is using <code>..</code> to define a function with arbitrary parameters and to spread an array.</p>\n<p>For more details, check out my other <a href=\"https://forum.typst.app/t/how-to-spread-a-2d-array-in-table/1197/4\">post</a> and the related Typst documentation <a href=\"https://typst.app/docs/reference/foundations/arguments/\">page</a>.</p>",
      "raw": "Solution: \n```typ\n#let img_dir = \"./\"\n\n#let figure_two_images(caption, ..pathes) = figure(\n  grid(\n    columns: 2,\n    gutter: 2mm,\n    ..pathes.pos().map(path => image(img_dir + path)),\n  ),\n  caption: caption,\n)\n\n#figure_two_images(\"Images\", \"1.png\", \"2.png\", \"3.png\")\n```\nThe key concept is using `..` to define a function with arbitrary parameters and to spread an array. \n\nFor more details, check out my other [post](https://forum.typst.app/t/how-to-spread-a-2d-array-in-table/1197/4?u=paran3xus) and the related Typst documentation [page](https://typst.app/docs/reference/foundations/arguments/).",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 61.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 14
    },
    {
      "id": 6081,
      "post_number": 3,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-25T15:38:07.895Z",
      "updated_at": "2024-11-25T15:38:07.895Z",
      "cooked": "<p>You were nearly there!</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#grid(\n  columns: 2,\n  ..for path in paths {\n    (image(img_dir + path, width:30%),)\n  }\n)\n</code></pre>",
      "raw": "You were nearly there!\n```typ\n#grid(\n  columns: 2,\n  ..for path in paths {\n    (image(img_dir + path, width:30%),)\n  }\n)\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 29,
      "score": 90.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6083,
      "post_number": 4,
      "username": "Alseidon_Diaphore",
      "name": "Alseïdon Diaphore",
      "created_at": "2024-11-25T16:03:52.931Z",
      "updated_at": "2024-11-25T16:03:52.931Z",
      "cooked": "<p>So this was all that was missing… Thank you!</p>",
      "raw": "So this was all that was missing... Thank you!",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 5.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 403
    },
    {
      "id": 6084,
      "post_number": 5,
      "username": "Alseidon_Diaphore",
      "name": "Alseïdon Diaphore",
      "created_at": "2024-11-25T16:08:16.403Z",
      "updated_at": "2024-11-25T16:08:16.403Z",
      "cooked": "<p>Thank you for the links, they are indeed what I failed to find!</p>",
      "raw": "Thank you for the links, they are indeed what I failed to find!",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 5.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 403
    }
  ],
  "scraped_at": "2025-06-10T09:54:23.951445"
}
{
  "topic_metadata": {
    "id": 1890,
    "title": "How to avoid nested enum items breaking at the end of the page?",
    "slug": "how-to-avoid-nested-enum-items-breaking-at-the-end-of-the-page",
    "posts_count": 4,
    "created_at": "2024-11-25T21:14:59.164Z",
    "last_posted_at": "2025-06-04T21:59:06.272Z",
    "views": 141,
    "like_count": 2,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "scripting",
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 545
  },
  "posts": [
    {
      "id": 6096,
      "post_number": 1,
      "username": "Anemona-Anonima",
      "name": "Esteban Muñoz",
      "created_at": "2024-11-25T21:14:59.561Z",
      "updated_at": "2024-11-25T21:14:59.561Z",
      "cooked": "<p>Hi all. I’m trying to create a simple multiple choice test. For the sake of readability, I want to have a question and all its choices in the same page, meaning that if a choice doesn’t fit in the current page the whole question is moved to the next.</p>\n<p>To achieve it I’m using nested enums like this</p>\n<details>\n<summary>\nCode</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/numbly:0.1.0\": numbly\n\n\n#set page(height: 7cm)\n#set enum(numbering: numbly(\"{1}.\", \"{2:A})\"), full: true)\n#show enum.item: set block(breakable: false)\n\n+ Some question\n  \n  + First answer\n  \n  + Second answer\n  \n  + Third answer\n  \n  + Fourth answer\n\n\n+ Another question\n  \n  + First answer\n  \n  + Second answer\n  \n  + Third answer\n  \n  + Fourth answer\n</code></pre>\n</details>\n<details>\n<summary>\nResult</summary>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/4/49ee9e28bc350558cc7e91373b6305c6fedea344.png\" alt=\"nested-enums-1\" data-base62-sha1=\"ay25GgAXQ2UgHMYRgnPQzsWxTLK\" width=\"595\" height=\"198\"><br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/9/98aff44effe067928e1432eb11c52669b9ada33f.png\" alt=\"nested-enums-2\" data-base62-sha1=\"lMJysXV9YjT9ct4rgxqmQClfLqv\" width=\"595\" height=\"198\"></p>\n</details>\n<p>As you can see, the question stays in the same page, but the choices go to the next. I tried to wrap every <code>enum.item</code> in a block, but it breaks the enum counter and instead of fixing that I just prefer to call a <code>pagebreak</code> manually.</p>\n<p>Any help would be appreciated!</p>",
      "raw": "Hi all. I'm trying to create a simple multiple choice test. For the sake of readability, I want to have a question and all its choices in the same page, meaning that if a choice doesn't fit in the current page the whole question is moved to the next.\n\nTo achieve it I'm using nested enums like this\n\n\n[details=\"Code\"]\n```typ\n#import \"@preview/numbly:0.1.0\": numbly\n\n\n#set page(height: 7cm)\n#set enum(numbering: numbly(\"{1}.\", \"{2:A})\"), full: true)\n#show enum.item: set block(breakable: false)\n\n+ Some question\n  \n  + First answer\n  \n  + Second answer\n  \n  + Third answer\n  \n  + Fourth answer\n\n\n+ Another question\n  \n  + First answer\n  \n  + Second answer\n  \n  + Third answer\n  \n  + Fourth answer\n```\n[/details]\n\n[details=\"Result\"]\n![nested-enums-1|595x198](upload://ay25GgAXQ2UgHMYRgnPQzsWxTLK.png)\n![nested-enums-2|595x198](upload://lMJysXV9YjT9ct4rgxqmQClfLqv.png)\n[/details]\n\nAs you can see, the question stays in the same page, but the choices go to the next. I tried to wrap every `enum.item` in a block, but it breaks the enum counter and instead of fixing that I just prefer to call a `pagebreak` manually.\n\nAny help would be appreciated!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 332.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 41
    },
    {
      "id": 6106,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-11-26T08:27:26.192Z",
      "updated_at": "2024-11-26T08:47:53.834Z",
      "cooked": "<p>You were already on the right track to try to <code>#show enum.item: set block(breakable: false)</code> – this would, if enum items were implicitly wrapped in a block, make that block non-breakable. This works e.g. for <code>table</code>s. Enum items are not implicitly blocks, however (at least it seems so).</p>\n<p>Adding a block within the show rule doesn’t work because it resets numbering, as you have already noticed:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show enum.item: block.with(breakable: false)\n</code></pre>\n<p>The trick is to not wrap the enum item in a block, but the enum item’s <em>body</em>. You can inspect your current content by wrapping it in <code>repr()</code> and you’ll see that an enum item looks e.g. like this:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">item(\n  body: sequence(\n    [Some question],\n    parbreak(),\n    item(body: [First answer]),\n    // etc.\n  ),\n)\n</code></pre>\n<p>So if the body was an unbreakable block, this would work. However, the naive way of doing that also leads to a problem:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show enum.item: it =&gt; {\n  let (number, body, ..fields) = it.fields()\n  body = block(breakable: false, body)\n  enum.item(number, body, ..fields)\n}\n</code></pre>\n<blockquote>\n<p>maximum show rule depth exceeded</p>\n</blockquote>\n<p>Each show rule application creates a new enum item, on which the show rule is applied again… With one extra line to return the original item if it’s already the result of this show rule, it works:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show enum.item: it =&gt; {\n  let (number, body, ..fields) = it.fields()\n  if body.func() == block { return it }\n\n  body = block(breakable: false, body)\n  enum.item(number, body, ..fields)\n}\n</code></pre>",
      "raw": "You were already on the right track to try to `#show enum.item: set block(breakable: false)` -- this would, if enum items were implicitly wrapped in a block, make that block non-breakable. This works e.g. for `table`s. Enum items are not implicitly blocks, however (at least it seems so).\n\nAdding a block within the show rule doesn't work because it resets numbering, as you have already noticed:\n```typ\n#show enum.item: block.with(breakable: false)\n```\n\nThe trick is to not wrap the enum item in a block, but the enum item's _body_. You can inspect your current content by wrapping it in `repr()` and you'll see that an enum item looks e.g. like this:\n```typc\nitem(\n  body: sequence(\n    [Some question],\n    parbreak(),\n    item(body: [First answer]),\n    // etc.\n  ),\n)\n```\nSo if the body was an unbreakable block, this would work. However, the naive way of doing that also leads to a problem:\n```typ\n#show enum.item: it => {\n  let (number, body, ..fields) = it.fields()\n  body = block(breakable: false, body)\n  enum.item(number, body, ..fields)\n}\n```\n>maximum show rule depth exceeded\n\nEach show rule application creates a new enum item, on which the show rule is applied again... With one extra line to return the original item if it's already the result of this show rule, it works:\n```typ\n#show enum.item: it => {\n  let (number, body, ..fields) = it.fields()\n  if body.func() == block { return it }\n\n  body = block(breakable: false, body)\n  enum.item(number, body, ..fields)\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 2,
      "reads": 32,
      "score": 51.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 6126,
      "post_number": 3,
      "username": "Anemona-Anonima",
      "name": "Esteban Muñoz",
      "created_at": "2024-11-26T15:38:03.521Z",
      "updated_at": "2024-11-26T15:38:03.521Z",
      "cooked": "<p>Thank you! I thought about recreating the enum but believed it was going to be harder. This works as expected.</p>",
      "raw": "Thank you! I thought about recreating the enum but believed it was going to be harder. This works as expected.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 4.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 41
    },
    {
      "id": 13709,
      "post_number": 4,
      "username": "kalmarek",
      "name": "Marek",
      "created_at": "2025-06-04T21:59:06.272Z",
      "updated_at": "2025-06-04T21:59:06.272Z",
      "cooked": "<p>That’s a fine solution, but only when items are shorter than pages. In my examples I have something like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(height: 7cm, width: 10cm)\n\n+ First item\n\n  #lorem(20)\n  \n  #lorem(20)\n\n+ Second item\n  \n  #lorem(20)\n  \n  #lorem(50)\n</code></pre>\n<p>and <code>Second item</code> is either hanging at the end of the first page, or (with your solution) the second item doesn’t break where it should and overruns the page. In latex there’s the concept of “glue” which causes the page-break before rather than after <code>Second item</code>. Can we instruct typst about this preference of ours?</p>",
      "raw": "That's a fine solution, but only when items are shorter than pages. In my examples I have something like this:\n```\n#set page(height: 7cm, width: 10cm)\n\n+ First item\n\n  #lorem(20)\n  \n  #lorem(20)\n\n+ Second item\n  \n  #lorem(20)\n  \n  #lorem(50)\n```\n\nand `Second item` is either hanging at the end of the first page, or (with your solution) the second item doesn't break where it should and overruns the page. In latex there's the concept of \"glue\" which causes the page-break before rather than after `Second item`. Can we instruct typst about this preference of ours?",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 11,
      "score": 7.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1706
    }
  ],
  "scraped_at": "2025-06-10T09:54:23.241092"
}
{
  "topic_metadata": {
    "id": 1898,
    "title": "How can I remove spaces between bold and non-bold content with show rule?",
    "slug": "how-can-i-remove-spaces-between-bold-and-non-bold-content-with-show-rule",
    "posts_count": 4,
    "created_at": "2024-11-26T14:32:47.187Z",
    "last_posted_at": "2024-11-26T16:01:06.717Z",
    "views": 108,
    "like_count": 4,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "ParaN3xus",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 257
  },
  "posts": [
    {
      "id": 6117,
      "post_number": 1,
      "username": "miles-1",
      "name": "miles",
      "created_at": "2024-11-26T14:32:47.324Z",
      "updated_at": "2024-11-26T14:32:47.324Z",
      "cooked": "<p>With the function <code>ns</code> defined below, I can replace spaces with the text <code>SPACE</code></p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let ns(txt) = {\n  show regex(\"\\ \"): it =&gt; [SPACE]\n  txt\n}\n\n#ns[one two three four] // shows oneSPACEtwoSPACEthreeSPACEfour\n</code></pre>\n<p>However, if some of that content is bolded, the show rule is ineffective for adjacent spaces:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#ns[one *two* three four] \n</code></pre>\n<p>This shows “one <strong>two</strong> threeSPACEfour”. Using <code>repr</code>, I see the two inputs are structured differently:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#repr[one two three four] \n// gives [one two three four]\n#repr[one *two* three four] \n// gives sequence([one], [ ], strong(body:[two]), [ ], [three four]) \n</code></pre>\n<p>… but I’m still not sure why the <code>show</code> rule isn’t catching the space between bolded and unbolded words. How can I use <code>show</code> rules that apply to those spaces as well?</p>",
      "raw": "With the function `ns` defined below, I can replace spaces with the text `SPACE`\n```typst\n#let ns(txt) = {\n  show regex(\"\\ \"): it => [SPACE]\n  txt\n}\n\n#ns[one two three four] // shows oneSPACEtwoSPACEthreeSPACEfour\n```\nHowever, if some of that content is bolded, the show rule is ineffective for adjacent spaces:\n```typst\n#ns[one *two* three four] \n```\nThis shows \"one **two** threeSPACEfour\". Using `repr`, I see the two inputs are structured differently:\n```typst\n#repr[one two three four] \n// gives [one two three four]\n#repr[one *two* three four] \n// gives sequence([one], [ ], strong(body:[two]), [ ], [three four]) \n```\n... but I'm still not sure why the `show` rule isn't catching the space between bolded and unbolded words. How can I use `show` rules that apply to those spaces as well?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 305.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 177
    },
    {
      "id": 6118,
      "post_number": 2,
      "username": "ParaN3xus",
      "name": "ParaN3xus",
      "created_at": "2024-11-26T14:38:00.705Z",
      "updated_at": "2024-11-26T14:38:00.705Z",
      "cooked": "<p>Solution:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let func-seq = [].func()\n\n#show func-seq: it =&gt; {\n  let blank = [ ]\n  let c = it.children\n  if (blank in c) {\n    func-seq(c.filter(x =&gt; x != blank))\n  } else {\n    it\n  }\n}\n\none *two* three\n</code></pre>",
      "raw": "Solution:\n```typ\n#let func-seq = [].func()\n\n#show func-seq: it => {\n  let blank = [ ]\n  let c = it.children\n  if (blank in c) {\n    func-seq(c.filter(x => x != blank))\n  } else {\n    it\n  }\n}\n\none *two* three\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 10.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 14
    },
    {
      "id": 6121,
      "post_number": 3,
      "username": "miles-1",
      "name": "miles",
      "created_at": "2024-11-26T14:56:34.474Z",
      "updated_at": "2024-11-26T14:56:34.474Z",
      "cooked": "<p>Thanks. I applied your solution like this:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let func-seq = [].func()\n\n#let ns(txt) = {\n  show regex(\"\\ \"): it =&gt; []\n  show func-seq: it =&gt; {\n    let blank = [ ]\n    let c = it.children\n    if (blank in c) {func-seq(c.filter(x =&gt; x != blank))} else {it}\n  }\n  txt\n}\n\n/aʊ/ as in #ns[*ou* t]\n</code></pre>",
      "raw": "Thanks. I applied your solution like this:\n```typst\n#let func-seq = [].func()\n\n#let ns(txt) = {\n  show regex(\"\\ \"): it => []\n  show func-seq: it => {\n    let blank = [ ]\n    let c = it.children\n    if (blank in c) {func-seq(c.filter(x => x != blank))} else {it}\n  }\n  txt\n}\n\n/aʊ/ as in #ns[*ou* t]\n```",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 26,
      "score": 25.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 177
    },
    {
      "id": 6128,
      "post_number": 4,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2024-11-26T16:01:06.717Z",
      "updated_at": "2024-11-26T16:02:09.046Z",
      "cooked": "<p>You can simplify this in two ways:</p>\n<ul>\n<li>There is no need for a regex, as you can just match a string containing a space.</li>\n<li>You don’t need to edit sequences by hand, as you can create a show rule for <code>space</code> elements.</li>\n</ul>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let ns(txt) = {\n  show \" \": none\n  show [ ].func(): none\n  txt\n}\n</code></pre>",
      "raw": "You can simplify this in two ways:\n- There is no need for a regex, as you can just match a string containing a space.\n- You don't need to edit sequences by hand, as you can create a show rule for `space` elements.\n\n```typ\n#let ns(txt) = {\n  show \" \": none\n  show [ ].func(): none\n  txt\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 25,
      "score": 60.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 88
    }
  ],
  "scraped_at": "2025-06-10T09:54:22.522514"
}
{
  "topic_metadata": {
    "id": 1900,
    "title": "How do I sort an array of dictionaries by more than one key?",
    "slug": "how-do-i-sort-an-array-of-dictionaries-by-more-than-one-key",
    "posts_count": 5,
    "created_at": "2024-11-26T14:57:26.602Z",
    "last_posted_at": "2024-12-03T17:10:43.755Z",
    "views": 223,
    "like_count": 3,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 233
  },
  "posts": [
    {
      "id": 6122,
      "post_number": 1,
      "username": "NNS",
      "name": "Nikolai Neff-Sarnow",
      "created_at": "2024-11-26T14:57:26.775Z",
      "updated_at": "2024-12-07T18:13:29.119Z",
      "cooked": "<p>Let’s say I have the following array:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let arr = (\n  (a: \"foo\", b: \"not bar\", c: \"baz\"),\n  (a: \"qux\", b: \"quux\", c: \"corge\"),\n  (a: \"fizz\", b: \"buzz\", c: \"fizzbuzz\"),\n  (a: \"foo\", b: \"bar\", c: \"baz\"),\n)\n</code></pre>\n<p>I now want to sort this array fist by the key <code>a</code> of the contained dictionary <em>and then</em> by the key <code>b</code>. using <code>#arr.sorted(key: it =&gt; it.a)</code> only sorts by the first key. If they are the same, like in line 1 and 4, I then want to sort by key <code>b</code> within this subgroub, such that the result would be:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">(\n  (a: \"fizz\", b: \"buzz\", c: \"fizzbuzz\"),\n  (a: \"foo\", b: \"bar\", c: \"baz\"),\n  (a: \"foo\", b: \"not bar\", c: \"baz\"),\n  (a: \"qux\", b: \"quux\", c: \"corge\"),\n)\n</code></pre>\n<p>How can I achieve this sorting?</p>",
      "raw": "Let's say I have the following array:\n```typst\n#let arr = (\n  (a: \"foo\", b: \"not bar\", c: \"baz\"),\n  (a: \"qux\", b: \"quux\", c: \"corge\"),\n  (a: \"fizz\", b: \"buzz\", c: \"fizzbuzz\"),\n  (a: \"foo\", b: \"bar\", c: \"baz\"),\n)\n```\nI now want to sort this array fist by the key `a` of the contained dictionary _and then_ by the key `b`. using `#arr.sorted(key: it => it.a)` only sorts by the first key. If they are the same, like in line 1 and 4, I then want to sort by key `b` within this subgroub, such that the result would be:\n```typst\n(\n  (a: \"fizz\", b: \"buzz\", c: \"fizzbuzz\"),\n  (a: \"foo\", b: \"bar\", c: \"baz\"),\n  (a: \"foo\", b: \"not bar\", c: \"baz\"),\n  (a: \"qux\", b: \"quux\", c: \"corge\"),\n)\n```\nHow can I achieve this sorting?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 40,
      "score": 998.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 754
    },
    {
      "id": 6123,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-26T15:03:24.398Z",
      "updated_at": "2024-11-26T15:03:24.398Z",
      "cooked": "<p>You can give a tuple for the key.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#arr.sorted(key: it =&gt; (it.a, it.b))\n</code></pre>",
      "raw": "You can give a tuple for the key.\n\n```typ\n#arr.sorted(key: it => (it.a, it.b))\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 35,
      "score": 47.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6124,
      "post_number": 3,
      "username": "ParaN3xus",
      "name": "ParaN3xus",
      "created_at": "2024-11-26T15:05:59.102Z",
      "updated_at": "2024-11-26T15:07:01.617Z",
      "cooked": "<p>You can also give a sum of <code>a</code> and <code>b</code> for the key.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#arr.sorted(key: x =&gt; x.a + x.b)\n</code></pre>\n<p>But I think a <code>sorted</code> function with custom compare function will be better. Unfortunately it’s not supported yet, but there’s already an <a href=\"https://github.com/typst/typst/issues/5365\">issue</a>.</p>",
      "raw": "You can also give a sum of `a` and `b` for the key.\n```typ\n#arr.sorted(key: x => x.a + x.b)\n```\n\nBut I think a `sorted` function with custom compare function will be better. Unfortunately it's not supported yet, but there's already an [issue](https://github.com/typst/typst/issues/5365).",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 37,
      "score": 22.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 14
    },
    {
      "id": 6125,
      "post_number": 4,
      "username": "NNS",
      "name": "Nikolai Neff-Sarnow",
      "created_at": "2024-11-26T15:17:53.628Z",
      "updated_at": "2024-11-26T15:29:12.023Z",
      "cooked": "<p>nice! I think the docs should be updated to mention this possibility. If I find the time I’ll create a PR</p>",
      "raw": "nice! I think the docs should be updated to mention this possibility. If I find the time I'll create a PR",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 34,
      "score": 26.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 754
    },
    {
      "id": 6287,
      "post_number": 5,
      "username": "NNS",
      "name": "Nikolai Neff-Sarnow",
      "created_at": "2024-12-03T17:10:43.755Z",
      "updated_at": "2024-12-03T17:10:43.755Z",
      "cooked": "<p><a href=\"https://github.com/typst/typst/pull/5475\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Add documentation example to `array.sorted()` by nineff · Pull Request #5475 · typst/typst · GitHub</a> is merged!</p>",
      "raw": "https://github.com/typst/typst/pull/5475 is merged!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 25,
      "score": 30.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 754
    }
  ],
  "scraped_at": "2025-06-10T09:54:21.811688"
}
{
  "topic_metadata": {
    "id": 1901,
    "title": "How to alternate page margins for printing and binding as a book?",
    "slug": "how-to-alternate-page-margins-for-printing-and-binding-as-a-book",
    "posts_count": 4,
    "created_at": "2024-11-26T17:24:32.066Z",
    "last_posted_at": "2024-11-28T02:24:39.898Z",
    "views": 197,
    "like_count": 3,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "thefeiter",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 185
  },
  "posts": [
    {
      "id": 6130,
      "post_number": 1,
      "username": "Patrick_K",
      "name": "",
      "created_at": "2024-11-26T17:24:32.224Z",
      "updated_at": "2024-11-28T02:24:13.623Z",
      "cooked": "<p>I am currently working on my master’s thesis, and I need a layout suitable for printing and binding as a book.</p>\n<p>This requires that each chapter alternates the page margins: the first page should have a larger left margin, the second page a larger right margin, and so on).</p>\n<p>Is there an easy way to achieve this without manually adjusting each page with a <span class=\"hashtag-raw\">#pad</span>()?</p>\n<p>Since the chapters don’t follow a consistent page pattern, it’s not possible to programmatically assign every odd page to the left and every even page to the right.</p>",
      "raw": "I am currently working on my master's thesis, and I need a layout suitable for printing and binding as a book.\n\nThis requires that each chapter alternates the page margins: the first page should have a larger left margin, the second page a larger right margin, and so on).\n\nIs there an easy way to achieve this without manually adjusting each page with a #pad()?\n\nSince the chapters don’t follow a consistent page pattern, it’s not possible to programmatically assign every odd page to the left and every even page to the right.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 41,
      "score": 443.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 792
    },
    {
      "id": 6131,
      "post_number": 2,
      "username": "thefeiter",
      "name": "thefeiter",
      "created_at": "2024-11-26T18:32:40.467Z",
      "updated_at": "2024-11-26T18:32:40.467Z",
      "cooked": "<p>You can use the following rule:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(margin: (inside: 2.5cm, outside: 2cm, y: 1.75cm))\n</code></pre>\n<p>See <a href=\"https://typst.app/docs/guides/page-setup-guide/#alternating-margins\" class=\"inline-onebox\">Page setup guide – Typst Documentation</a> for more details.</p>",
      "raw": "You can use the following rule:\n\n```typ\n#set page(margin: (inside: 2.5cm, outside: 2cm, y: 1.75cm))\n```\n\nSee https://typst.app/docs/guides/page-setup-guide/#alternating-margins for more details.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 40,
      "score": 87.8,
      "accepted_answer": true,
      "trust_level": 0,
      "user_id": 855
    },
    {
      "id": 6153,
      "post_number": 3,
      "username": "Patrick_K",
      "name": "",
      "created_at": "2024-11-27T07:43:43.615Z",
      "updated_at": "2024-11-27T07:43:43.615Z",
      "cooked": "<p>Oh wow, I didn’t see that. Much thanks.</p>",
      "raw": "Oh wow, I didn't see that. Much thanks.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 35,
      "score": 6.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 792
    },
    {
      "id": 6171,
      "post_number": 4,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-28T02:24:39.898Z",
      "updated_at": "2024-11-28T02:24:39.898Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/patrick_k\">@Patrick_K</a>! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, please make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Patrick_K! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, please make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 20.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:54:21.100414"
}
{
  "topic_metadata": {
    "id": 1907,
    "title": "When using auto-sizing in grid, can i have finer control over the height of cells? So that the height of specific cells is used?",
    "slug": "when-using-auto-sizing-in-grid-can-i-have-finer-control-over-the-height-of-cells-so-that-the-height-of-specific-cells-is-used",
    "posts_count": 4,
    "created_at": "2024-11-27T08:43:23.751Z",
    "last_posted_at": "2024-11-28T14:00:06.524Z",
    "views": 358,
    "like_count": 2,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Marco",
    "tags": [
      "layout",
      "grids"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 1170
  },
  "posts": [
    {
      "id": 6155,
      "post_number": 1,
      "username": "Marco",
      "name": "Marco",
      "created_at": "2024-11-27T08:43:23.890Z",
      "updated_at": "2024-11-27T08:43:23.890Z",
      "cooked": "<p>Hi,</p>\n<p>I’m trying to create a grid where i want to use <code>rows:(auto,auto,1fr),</code> to determine the height of the top 2 rows.</p>\n<p>More specificly i want the left column to determine the height.<br>\nIn the right column i want an image to cover the entire rowspanned cells, similar to  the <a href=\"https://typst.app/docs/reference/visualize/image/#parameters-fit\">fit parameter on image.</a>.</p>\n<p>I made an example below:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let imagecontents = \"&lt;svg class=\\\"svg-icon\\\" style=\\\"width: 1.01171875em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;\\\" viewBox=\\\"0 0 1036 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"&gt;\n&lt;rect width=\\\"100%\\\" height=\\\"100%\\\" fill=\\\"gray\\\" /&gt;\n&lt;path d=\\\"M231.633593 295.165243c0-153.595317 124.940454-278.535771 278.537807-278.535771 153.595317 0 278.535771 124.940454 278.535771 278.535771 0 153.60448-124.940454 278.53068-278.535771 278.53068C356.574047 573.695923 231.633593 448.769723 231.633593 295.165243L231.633593 295.165243zM0 1014.090329c5.996914-67.351756 38.330358-306.001432 286.846943-433.813074 61.63687 48.382571 139.069346 77.514946 223.325474 77.514946 84.715315 0 162.56727-29.428658 224.36908-78.30605 249.591753 127.274058 279.721917 364.250911 285.801301 434.597051C1018.86037 1015.51676 1.473266 1014.201308 0 1014.090329L0 1014.090329zM0 1014.090329\\\"  /&gt;&lt;/svg&gt;\"\n\n#grid(\n    columns:( 3fr, 1.5fr),\n\trows:(auto,auto,1fr),\n    stroke:red,\n    [\n      #set text(size:3em)\n      = big title],\n    grid.cell(inset:0pt,\n      \n\t\t\tfill:aqua,\n\t\t\tstroke:none,\n\t\t\trowspan:2,\n\t\t\talign:right,image.decode(imagecontents)),\n   grid.cell(inset:(top:2em))[\n     = subtitle\n    #lorem(60)\n    #lorem(20)\n    ],\n   [more content here],\n   [sidebar that should be aligned with the image]\n  )\n</code></pre>\n<p>This results in the following:<br>\n<img src=\"/uploads/default/original/2X/1/11b1691225685e85fa8ede09a8918053db349a04.png\" alt=\"gridquestion\" data-base62-sha1=\"2wwdswrvCZ3q1cM80ll4rdvcyMI\" width=\"353\" height=\"499\"></p>\n<p>At the moment you can still see the background of the topright cell, and i want the image to cover the entire cell, so that you no longer see the aqua-blue in the example.</p>\n<p>Setting a height on the image of 100% or 1fr, results in the image determining the height of the 2 top rows. I want the left cells to determine the height of the top rows and the right to just adjust to the height of the left cells.</p>\n<p>(How) can i do this in typst?</p>\n<p>PS. Im looking for a solution in Typst not SVG because i want to use bitmap images. The svg is just an example.</p>",
      "raw": "Hi,\n\nI'm trying to create a grid where i want to use ```rows:(auto,auto,1fr),``` to determine the height of the top 2 rows.\n\nMore specificly i want the left column to determine the height.\nIn the right column i want an image to cover the entire rowspanned cells, similar to  the [fit parameter on image.](https://typst.app/docs/reference/visualize/image/#parameters-fit).\n\nI made an example below:\n\n```typst\n#let imagecontents = \"<svg class=\\\"svg-icon\\\" style=\\\"width: 1.01171875em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;\\\" viewBox=\\\"0 0 1036 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\n<rect width=\\\"100%\\\" height=\\\"100%\\\" fill=\\\"gray\\\" />\n<path d=\\\"M231.633593 295.165243c0-153.595317 124.940454-278.535771 278.537807-278.535771 153.595317 0 278.535771 124.940454 278.535771 278.535771 0 153.60448-124.940454 278.53068-278.535771 278.53068C356.574047 573.695923 231.633593 448.769723 231.633593 295.165243L231.633593 295.165243zM0 1014.090329c5.996914-67.351756 38.330358-306.001432 286.846943-433.813074 61.63687 48.382571 139.069346 77.514946 223.325474 77.514946 84.715315 0 162.56727-29.428658 224.36908-78.30605 249.591753 127.274058 279.721917 364.250911 285.801301 434.597051C1018.86037 1015.51676 1.473266 1014.201308 0 1014.090329L0 1014.090329zM0 1014.090329\\\"  /></svg>\"\n\n#grid(\n    columns:( 3fr, 1.5fr),\n\trows:(auto,auto,1fr),\n    stroke:red,\n    [\n      #set text(size:3em)\n      = big title],\n    grid.cell(inset:0pt,\n      \n\t\t\tfill:aqua,\n\t\t\tstroke:none,\n\t\t\trowspan:2,\n\t\t\talign:right,image.decode(imagecontents)),\n   grid.cell(inset:(top:2em))[\n     = subtitle\n    #lorem(60)\n    #lorem(20)\n    ],\n   [more content here],\n   [sidebar that should be aligned with the image]\n  )\n```\nThis results in the following:\n![gridquestion|353x499](upload://2wwdswrvCZ3q1cM80ll4rdvcyMI.png)\n\nAt the moment you can still see the background of the topright cell, and i want the image to cover the entire cell, so that you no longer see the aqua-blue in the example. \n\nSetting a height on the image of 100% or 1fr, results in the image determining the height of the 2 top rows. I want the left cells to determine the height of the top rows and the right to just adjust to the height of the left cells.\n\n(How) can i do this in typst? \n\nPS. Im looking for a solution in Typst not SVG because i want to use bitmap images. The svg is just an example.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 1307.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 720
    },
    {
      "id": 6179,
      "post_number": 2,
      "username": "Marco",
      "name": "Marco",
      "created_at": "2024-11-28T09:55:07.708Z",
      "updated_at": "2024-11-28T09:55:07.708Z",
      "cooked": "<p>I managed to find a solution by measuring/calculating the height of the left column and then setting the height of the image in the right column explicitly.</p>\n<p>The code containing the solution:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let imagecontents = \"&lt;svg class=\\\"svg-icon\\\" style=\\\"width: 1.01171875em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;\\\" viewBox=\\\"0 0 1036 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"&gt;\n&lt;rect width=\\\"100%\\\" height=\\\"100%\\\" fill=\\\"gray\\\" /&gt;\n&lt;path d=\\\"M231.633593 295.165243c0-153.595317 124.940454-278.535771 278.537807-278.535771 153.595317 0 278.535771 124.940454 278.535771 278.535771 0 153.60448-124.940454 278.53068-278.535771 278.53068C356.574047 573.695923 231.633593 448.769723 231.633593 295.165243L231.633593 295.165243zM0 1014.090329c5.996914-67.351756 38.330358-306.001432 286.846943-433.813074 61.63687 48.382571 139.069346 77.514946 223.325474 77.514946 84.715315 0 162.56727-29.428658 224.36908-78.30605 249.591753 127.274058 279.721917 364.250911 285.801301 434.597051C1018.86037 1015.51676 1.473266 1014.201308 0 1014.090329L0 1014.090329zM0 1014.090329\\\"  /&gt;&lt;/svg&gt;\"\n\n// define the content here so it's easy to measure later on\n#let title = [\n      #set text(size:3em)\n      #box()[= big title]]\n      \n#let subblock = [\n     #box(inset:(top:2em),[= subtitle\n    #lorem(60)\n    #lorem(20)\n    #lorem(10)])]\n\n\n\n#grid(\n    columns:( 3fr, 1.5fr),\n\trows:(auto,auto,1fr),\n    stroke:red,\n    title ,\n      \n    grid.cell(inset:0pt,\n       align: center+horizon,\n\t\t\t fill:aqua,\n\t\t\tstroke:none,\n\t\t\trowspan:2,\n      {\n      layout(size =&gt; {\n        // we know the left column is twice as big as the right column\n        let curwidth-leftcolumn = size.width*2\n        // we know the content of the left column, so we can measure it's height\n        let title-height = measure(width:curwidth-leftcolumn,title).height\n        let subblock-height = measure(width:curwidth-leftcolumn,subblock).height\n        let heightofleft = title-height+subblock-height\n        // knowing the height we can create an image of the specific height and 100% width with the default fit of cover\n        image.decode(width:100%,height:heightofleft,imagecontents) \n      })\n   }),\n   grid.cell(subblock),\n   [more content here],\n   [sidebar that should be aligned with the image]\n  )\n</code></pre>\n<p>results in:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/f/f6e1462e75278e7a0ae5f9ca5315243f7dd5b05a.png\" data-download-href=\"https://forum.typst.app/uploads/default/f6e1462e75278e7a0ae5f9ca5315243f7dd5b05a\" title=\"gridsolution\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/f/f6e1462e75278e7a0ae5f9ca5315243f7dd5b05a_2_353x499.png\" alt=\"gridsolution\" data-base62-sha1=\"ze06x0ZnitB3ieSFJVVP9n0OX4C\" width=\"353\" height=\"499\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/f/f6e1462e75278e7a0ae5f9ca5315243f7dd5b05a_2_353x499.png, https://forum.typst.app/uploads/default/optimized/2X/f/f6e1462e75278e7a0ae5f9ca5315243f7dd5b05a_2_529x748.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/f/f6e1462e75278e7a0ae5f9ca5315243f7dd5b05a_2_706x998.png 2x\" data-dominant-color=\"EEECEC\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">gridsolution</span><span class=\"informations\">1488×2105 227 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "I managed to find a solution by measuring/calculating the height of the left column and then setting the height of the image in the right column explicitly.\n\nThe code containing the solution:\n```typst\n#let imagecontents = \"<svg class=\\\"svg-icon\\\" style=\\\"width: 1.01171875em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;\\\" viewBox=\\\"0 0 1036 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\n<rect width=\\\"100%\\\" height=\\\"100%\\\" fill=\\\"gray\\\" />\n<path d=\\\"M231.633593 295.165243c0-153.595317 124.940454-278.535771 278.537807-278.535771 153.595317 0 278.535771 124.940454 278.535771 278.535771 0 153.60448-124.940454 278.53068-278.535771 278.53068C356.574047 573.695923 231.633593 448.769723 231.633593 295.165243L231.633593 295.165243zM0 1014.090329c5.996914-67.351756 38.330358-306.001432 286.846943-433.813074 61.63687 48.382571 139.069346 77.514946 223.325474 77.514946 84.715315 0 162.56727-29.428658 224.36908-78.30605 249.591753 127.274058 279.721917 364.250911 285.801301 434.597051C1018.86037 1015.51676 1.473266 1014.201308 0 1014.090329L0 1014.090329zM0 1014.090329\\\"  /></svg>\"\n\n// define the content here so it's easy to measure later on\n#let title = [\n      #set text(size:3em)\n      #box()[= big title]]\n      \n#let subblock = [\n     #box(inset:(top:2em),[= subtitle\n    #lorem(60)\n    #lorem(20)\n    #lorem(10)])]\n\n\n\n#grid(\n    columns:( 3fr, 1.5fr),\n\trows:(auto,auto,1fr),\n    stroke:red,\n    title ,\n      \n    grid.cell(inset:0pt,\n       align: center+horizon,\n\t\t\t fill:aqua,\n\t\t\tstroke:none,\n\t\t\trowspan:2,\n      {\n      layout(size => {\n        // we know the left column is twice as big as the right column\n        let curwidth-leftcolumn = size.width*2\n        // we know the content of the left column, so we can measure it's height\n        let title-height = measure(width:curwidth-leftcolumn,title).height\n        let subblock-height = measure(width:curwidth-leftcolumn,subblock).height\n        let heightofleft = title-height+subblock-height\n        // knowing the height we can create an image of the specific height and 100% width with the default fit of cover\n        image.decode(width:100%,height:heightofleft,imagecontents) \n      })\n   }),\n   grid.cell(subblock),\n   [more content here],\n   [sidebar that should be aligned with the image]\n  )\n```\n\nresults in:\n![gridsolution|353x499](upload://ze06x0ZnitB3ieSFJVVP9n0OX4C.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 32,
      "score": 196.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 720
    },
    {
      "id": 6180,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-28T13:22:53.737Z",
      "updated_at": "2024-11-28T13:22:53.737Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Marco\" data-post=\"1\" data-topic=\"1907\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/marco/48/1093_2.png\" class=\"avatar\"> Marco:</div>\n<blockquote>\n<p>Setting a height on the image of 100% or 1fr, results in the image determining the height of the 2 top rows. I want the left cells to determine the height of the top rows and the right to just adjust to the height of the left cells.</p>\n</blockquote>\n</aside>\n<p>You’re looking for this feature: <a href=\"https://github.com/typst/typst/issues/4000\" class=\"inline-onebox\">Add `table.cell(fit: Axes&lt;bool&gt;)` parameter · Issue #4000 · typst/typst · GitHub</a></p>\n<p>For the moment, this is only present in tablex package (which inspired Typst 0.11’s new table API) through the <code>fit-spans: (y: true)</code> setting. It is, however, generally discouraged to use tablex as most of its features have been ported to built-in tables and grids (but specifically not this feature at the moment), and tablex compiles much slower than those. Still, here’s how it would look like:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/tablex:0.0.9\": gridx, cellx\n\n#let imagecontents = \"&lt;svg class=\\\"svg-icon\\\" style=\\\"width: 1.01171875em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;\\\" viewBox=\\\"0 0 1036 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"&gt;\n&lt;rect width=\\\"100%\\\" height=\\\"100%\\\" fill=\\\"gray\\\" /&gt;\n&lt;path d=\\\"M231.633593 295.165243c0-153.595317 124.940454-278.535771 278.537807-278.535771 153.595317 0 278.535771 124.940454 278.535771 278.535771 0 153.60448-124.940454 278.53068-278.535771 278.53068C356.574047 573.695923 231.633593 448.769723 231.633593 295.165243L231.633593 295.165243zM0 1014.090329c5.996914-67.351756 38.330358-306.001432 286.846943-433.813074 61.63687 48.382571 139.069346 77.514946 223.325474 77.514946 84.715315 0 162.56727-29.428658 224.36908-78.30605 249.591753 127.274058 279.721917 364.250911 285.801301 434.597051C1018.86037 1015.51676 1.473266 1014.201308 0 1014.090329L0 1014.090329zM0 1014.090329\\\"  /&gt;&lt;/svg&gt;\"\n\n#gridx(\n    columns:( 3fr, 1.5fr),\n\trows:(auto,auto,auto),\n    stroke: red,\n    [\n      #set text(size:3em)\n      = big title],\n    cellx(inset:0pt,\n     fit-spans: (y: true),\n\t\t\tfill:aqua,\n\t\t\trowspan:2,\n\t\t\talign:right,image.decode(imagecontents, height: 100%)),\n   cellx(inset:(top:2em))[\n     = subtitle\n    #lorem(60)\n    #lorem(20) ddd dd d d d dd dddddddddddddd ddddddddddd ddddd dddddddddddddddd\n    ],\n   [more content here],\n   [sidebar that should be aligned with the image]\n  )\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/c/c10f8cea720213d09a48978503dfa678f51bd0b3.png\" alt=\"output: image adjusts to height\" data-base62-sha1=\"rxTt2RBVO6nNYjkDOgqAr2qlHiP\" width=\"575\" height=\"359\"></p>\n<p>Note that tablex internally uses <code>measure</code> for this, so your approach is generally correct (albeit a bit manual).</p>",
      "raw": "[quote=\"Marco, post:1, topic:1907\"]\nSetting a height on the image of 100% or 1fr, results in the image determining the height of the 2 top rows. I want the left cells to determine the height of the top rows and the right to just adjust to the height of the left cells.\n[/quote]\n\nYou're looking for this feature: https://github.com/typst/typst/issues/4000\n\nFor the moment, this is only present in tablex package (which inspired Typst 0.11's new table API) through the `fit-spans: (y: true)` setting. It is, however, generally discouraged to use tablex as most of its features have been ported to built-in tables and grids (but specifically not this feature at the moment), and tablex compiles much slower than those. Still, here's how it would look like:\n\n```typ\n#import \"@preview/tablex:0.0.9\": gridx, cellx\n\n#let imagecontents = \"<svg class=\\\"svg-icon\\\" style=\\\"width: 1.01171875em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;\\\" viewBox=\\\"0 0 1036 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\n<rect width=\\\"100%\\\" height=\\\"100%\\\" fill=\\\"gray\\\" />\n<path d=\\\"M231.633593 295.165243c0-153.595317 124.940454-278.535771 278.537807-278.535771 153.595317 0 278.535771 124.940454 278.535771 278.535771 0 153.60448-124.940454 278.53068-278.535771 278.53068C356.574047 573.695923 231.633593 448.769723 231.633593 295.165243L231.633593 295.165243zM0 1014.090329c5.996914-67.351756 38.330358-306.001432 286.846943-433.813074 61.63687 48.382571 139.069346 77.514946 223.325474 77.514946 84.715315 0 162.56727-29.428658 224.36908-78.30605 249.591753 127.274058 279.721917 364.250911 285.801301 434.597051C1018.86037 1015.51676 1.473266 1014.201308 0 1014.090329L0 1014.090329zM0 1014.090329\\\"  /></svg>\"\n\n#gridx(\n    columns:( 3fr, 1.5fr),\n\trows:(auto,auto,auto),\n    stroke: red,\n    [\n      #set text(size:3em)\n      = big title],\n    cellx(inset:0pt,\n     fit-spans: (y: true),\n\t\t\tfill:aqua,\n\t\t\trowspan:2,\n\t\t\talign:right,image.decode(imagecontents, height: 100%)),\n   cellx(inset:(top:2em))[\n     = subtitle\n    #lorem(60)\n    #lorem(20) ddd dd d d d dd dddddddddddddd ddddddddddd ddddd dddddddddddddddd\n    ],\n   [more content here],\n   [sidebar that should be aligned with the image]\n  )\n```\n\n![output: image adjusts to height|575x359](upload://rxTt2RBVO6nNYjkDOgqAr2qlHiP.png)\n\nNote that tablex internally uses `measure` for this, so your approach is generally correct (albeit a bit manual).",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 1,
      "reads": 23,
      "score": 34.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6181,
      "post_number": 4,
      "username": "Marco",
      "name": "Marco",
      "created_at": "2024-11-28T14:00:06.524Z",
      "updated_at": "2024-11-28T14:00:06.524Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/pgbiel\">@PgBiel</a>,</p>\n<p>tablex looks interesting. I’ll look into it. <img src=\"https://forum.typst.app/uploads/default/original/1X/dd9145ed4e34626aea994d5f03e6983baf0525e8.png?v=12\" title=\":typstguy_peeking:\" class=\"emoji emoji-custom\" alt=\":typstguy_peeking:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hi @PgBiel,\n\ntablex looks interesting. I'll look into it. :typstguy_peeking:",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 214.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 720
    }
  ],
  "scraped_at": "2025-06-10T09:54:20.402406"
}
{
  "topic_metadata": {
    "id": 1909,
    "title": "How can I change the maximum call depth?",
    "slug": "how-can-i-change-the-maximum-call-depth",
    "posts_count": 2,
    "created_at": "2024-11-27T13:38:51.282Z",
    "last_posted_at": "2024-11-27T13:56:22.344Z",
    "views": 78,
    "like_count": 1,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 89
  },
  "posts": [
    {
      "id": 6157,
      "post_number": 1,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2024-11-27T13:38:51.372Z",
      "updated_at": "2024-11-27T13:38:51.372Z",
      "cooked": "<p>The following code throws an error message:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let fib(n) = if n &lt;= 1 { n } else { fib(n - 1) + fib(n - 2) }\n\n#fib(90)\n</code></pre>\n<p>The error is: <code>error: maximum function call depth exceeded</code></p>\n<p>How can I change the maximum call depth to e.g. 1000?</p>",
      "raw": "The following code throws an error message:\n\n```typst\n#let fib(n) = if n <= 1 { n } else { fib(n - 1) + fib(n - 2) }\n\n#fib(90)\n```\n\nThe error is: `error: maximum function call depth exceeded`\n\nHow can I change the maximum call depth to e.g. 1000?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 211.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 6158,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-27T13:56:22.344Z",
      "updated_at": "2024-11-27T13:56:22.344Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Xodarap\" data-post=\"1\" data-topic=\"1909\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/x/D58100/48.png\" class=\"avatar\"> Xodarap:</div>\n<blockquote>\n<p>maximum function call depth exceeded</p>\n</blockquote>\n</aside>\n<p>Hello,</p>\n<p>You can re-compile typst by modifying this const <a href=\"https://github.com/typst/typst/blob/main/crates/typst-library/src/engine.rs#L305\" class=\"inline-onebox\">typst/crates/typst-library/src/engine.rs at main · typst/typst · GitHub</a>.<br>\nOtherwise, you can always try the iterative fibonacci.</p>",
      "raw": "[quote=\"Xodarap, post:1, topic:1909\"]\nmaximum function call depth exceeded\n[/quote]\n\nHello,\n\nYou can re-compile typst by modifying this const https://github.com/typst/typst/blob/main/crates/typst-library/src/engine.rs#L305.\nOtherwise, you can always try the iterative fibonacci.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 33,
      "score": 21.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    }
  ],
  "scraped_at": "2025-06-10T09:54:19.690827"
}
{
  "topic_metadata": {
    "id": 1912,
    "title": "How to change the size of list markers without a vertical offset?",
    "slug": "how-to-change-the-size-of-list-markers-without-a-vertical-offset",
    "posts_count": 5,
    "created_at": "2024-11-27T19:35:33.905Z",
    "last_posted_at": "2024-11-28T09:32:47.415Z",
    "views": 150,
    "like_count": 3,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "lists",
      "text"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 383
  },
  "posts": [
    {
      "id": 6161,
      "post_number": 1,
      "username": "lampert",
      "name": "Joshua Lampert",
      "created_at": "2024-11-27T19:35:34.023Z",
      "updated_at": "2024-11-27T19:49:57.197Z",
      "cooked": "<p>I would like to enlarge the marker of a bullet list. I can do this with</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set list(marker: (text([‣], size: 2em)))\n</code></pre>\n<p>However, in this case there is an undesired vertical offset, i.e. the markers are too low.<br>\nI also tried to use <code>box</code> from <a href=\"https://forum.typst.app/t/how-to-scale-a-symbol/1063/2\">this post</a>, which reduces the spacing between lines, but not the offset of the markers.<br>\nI have an MWE <a href=\"https://typst.app/project/rCwMhHPB8OyXk3wDieiylz\">here</a>.<br>\nIs there a way to enlarge the markers such that they are still vertically centered?</p>",
      "raw": "I would like to enlarge the marker of a bullet list. I can do this with\n```typ\n#set list(marker: (text([‣], size: 2em)))\n```\nHowever, in this case there is an undesired vertical offset, i.e. the markers are too low.\nI also tried to use `box` from [this post](https://forum.typst.app/t/how-to-scale-a-symbol/1063/2?u=lampert), which reduces the spacing between lines, but not the offset of the markers.\nI have an MWE [here](https://typst.app/project/rCwMhHPB8OyXk3wDieiylz).\nIs there a way to enlarge the markers such that they are still vertically centered?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 490.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 667
    },
    {
      "id": 6162,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-11-27T19:49:43.685Z",
      "updated_at": "2024-11-27T19:49:43.685Z",
      "cooked": "<p>I’m not sure if there’s an automatic way to <em>center</em> the marker, but any solution would probably work by adjusting the box’s <a href=\"https://typst.app/docs/reference/layout/box/#parameters-baseline\">baseline</a>.</p>\n<p>btw, I’ll move your post to the <a class=\"hashtag-cooked\" href=\"/c/questions/5\" data-type=\"category\" data-slug=\"questions\" data-id=\"5\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>Questions</span></a> category and add some tags <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "I'm not sure if there's an automatic way to _center_ the marker, but any solution would probably work by adjusting the box's [baseline](https://typst.app/docs/reference/layout/box/#parameters-baseline).\n\nbtw, I'll move your post to the #questions category and add some tags :slight_smile:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 25.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 6163,
      "post_number": 3,
      "username": "lampert",
      "name": "Joshua Lampert",
      "created_at": "2024-11-27T20:26:03.387Z",
      "updated_at": "2024-11-27T20:26:03.387Z",
      "cooked": "<p>Thanks! I tried using baseline, but I didn’t manage to move only the markers a little bit up. I can only move the whole line, but I don’t want to change the spacing between the lines.</p>",
      "raw": "Thanks! I tried using baseline, but I didn't manage to move only the markers a little bit up. I can only move the whole line, but I don't want to change the spacing between the lines.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 25.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 667
    },
    {
      "id": 6165,
      "post_number": 4,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-11-27T21:29:58.734Z",
      "updated_at": "2024-11-27T21:29:58.734Z",
      "cooked": "<p>ah, interesting. I misdiagnosed the issue… (as an aside, this is one reason why it’s useful to include failed attempts: it speeds up narrowing down the issue)</p>\n<p>The main problem seems to be related to how list markers are laid out in Typst. There may be some overlap going on with the issue <a href=\"https://github.com/typst/typst/issues/1204\" class=\"inline-onebox\">List and enum markers are not aligned with the baseline of the item's contents · Issue #1204 · typst/typst · GitHub</a>. Ultimately, changing a marker’s baseline does not work as intended.</p>\n<p>We still have two options left:</p>\n<ol>\n<li>that the mark is so misaligned is because it is bigger than the box. We can change its alignment within the box:<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set list(marker: box(height: 0.65em, align(horizon, text(size: 2em)[‣])))\n</code></pre>\n</li>\n<li>if that doesn’t fit, we can always manually move the mark:<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set list(marker: box(height: 0.65em, move(dy: -80%, text(size: 2em)[‣])))\n</code></pre>\n</li>\n</ol>\n<p>That last one looks about right!</p>",
      "raw": "ah, interesting. I misdiagnosed the issue... (as an aside, this is one reason why it's useful to include failed attempts: it speeds up narrowing down the issue)\n\nThe main problem seems to be related to how list markers are laid out in Typst. There may be some overlap going on with the issue https://github.com/typst/typst/issues/1204. Ultimately, changing a marker's baseline does not work as intended.\n\nWe still have two options left:\n1. that the mark is so misaligned is because it is bigger than the box. We can change its alignment within the box:\n   ```typ\n   #set list(marker: box(height: 0.65em, align(horizon, text(size: 2em)[‣])))\n   ```\n2. if that doesn't fit, we can always manually move the mark:\n   ```typ\n   #set list(marker: box(height: 0.65em, move(dy: -80%, text(size: 2em)[‣])))\n   ```\nThat last one looks about right!",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 25,
      "score": 30.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 6178,
      "post_number": 5,
      "username": "lampert",
      "name": "Joshua Lampert",
      "created_at": "2024-11-28T09:32:47.415Z",
      "updated_at": "2024-11-28T09:32:47.415Z",
      "cooked": "<p>Thanks a lot! I think I prefer the first option, such that we don’t need to fiddle around with percentages and it already looks quite good.<br>\n(Regarding your aside: I meant I tried using baseline <em>after</em> you suggested it. I didn’t try it before <img src=\"https://forum.typst.app/images/emoji/apple/slightly_smiling_face.png?v=12\" title=\":slightly_smiling_face:\" class=\"emoji\" alt=\":slightly_smiling_face:\" loading=\"lazy\" width=\"20\" height=\"20\">)</p>",
      "raw": "Thanks a lot! I think I prefer the first option, such that we don't need to fiddle around with percentages and it already looks quite good.\n(Regarding your aside: I meant I tried using baseline _after_ you suggested it. I didn't try it before :slightly_smiling_face:)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 20,
      "score": 49.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 667
    }
  ],
  "scraped_at": "2025-06-10T09:54:18.991637"
}
{
  "topic_metadata": {
    "id": 1915,
    "title": "How to balance columns?",
    "slug": "how-to-balance-columns",
    "posts_count": 8,
    "created_at": "2024-11-28T01:48:57.141Z",
    "last_posted_at": "2025-06-09T20:52:51.525Z",
    "views": 307,
    "like_count": 3,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "PgBiel",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 697
  },
  "posts": [
    {
      "id": 6168,
      "post_number": 1,
      "username": "Andrew_Matthews",
      "name": "Andrew Matthews",
      "created_at": "2024-11-28T01:48:57.280Z",
      "updated_at": "2024-11-28T02:15:46.745Z",
      "cooked": "<p>noob question:</p>\n<p>I’m trying to create a document (my CV) having some sections in 2-column mode, and others in 1-column.  My issue is that I don’t know how to control the behaviour of the columns function to balance the content, so it is not “vertically justified” (if that’s a thing).</p>\n<p>Please ignore the ghastly styling, which I’m still learning how to control right now. I’m getting the following difference between my old LaTeX-based resume, and my new Typst one:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/8df33fb13b2a7af5e14bde066303082d6307ff58.png\" data-download-href=\"https://forum.typst.app/uploads/default/8df33fb13b2a7af5e14bde066303082d6307ff58\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/8df33fb13b2a7af5e14bde066303082d6307ff58_2_391x500.png\" alt=\"image\" data-base62-sha1=\"kfKtQO57bspDhsdC8PORNT9t9ry\" width=\"391\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/8/8df33fb13b2a7af5e14bde066303082d6307ff58_2_391x500.png, https://forum.typst.app/uploads/default/original/2X/8/8df33fb13b2a7af5e14bde066303082d6307ff58.png 1.5x, https://forum.typst.app/uploads/default/original/2X/8/8df33fb13b2a7af5e14bde066303082d6307ff58.png 2x\" data-dominant-color=\"F3F3F4\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">553×707 50.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>This is what I got by default from LaTeX:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/e/ef82d153f0a996e0c7a53fe947be49b310f64abf.png\" data-download-href=\"https://forum.typst.app/uploads/default/ef82d153f0a996e0c7a53fe947be49b310f64abf\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/e/ef82d153f0a996e0c7a53fe947be49b310f64abf_2_581x500.png\" alt=\"image\" data-base62-sha1=\"yaOof9Bx8p9yIHOTh1x4Pk0qD2T\" width=\"581\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/e/ef82d153f0a996e0c7a53fe947be49b310f64abf_2_581x500.png, https://forum.typst.app/uploads/default/optimized/2X/e/ef82d153f0a996e0c7a53fe947be49b310f64abf_2_871x750.png 1.5x, https://forum.typst.app/uploads/default/original/2X/e/ef82d153f0a996e0c7a53fe947be49b310f64abf.png 2x\" data-dominant-color=\"EEEEEE\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1006×865 227 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>The Typst source uses a couple of functions to create a 2-col section:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let interlude_section(title, content) = {[\n= #smallcaps[#title]\n#columns(2)[#content]\n]}\n\n#let interlude(title, orgname, location, dates, summary) = {\n\t[\n\t== #text(blue)[#title]\n\t#emph([#orgname #location #dates])\\\n\t#par(justify: true)[#summary]\n\t]\n}\n</code></pre>",
      "raw": "noob question:\n\nI'm trying to create a document (my CV) having some sections in 2-column mode, and others in 1-column.  My issue is that I don't know how to control the behaviour of the columns function to balance the content, so it is not \"vertically justified\" (if that's a thing).\n\nPlease ignore the ghastly styling, which I'm still learning how to control right now. I'm getting the following difference between my old LaTeX-based resume, and my new Typst one:\n\n![image|391x500](upload://kfKtQO57bspDhsdC8PORNT9t9ry.png)\n\nThis is what I got by default from LaTeX:\n\n![image|581x500](upload://yaOof9Bx8p9yIHOTh1x4Pk0qD2T.png)\n\nThe Typst source uses a couple of functions to create a 2-col section:\n\n```typ\n#let interlude_section(title, content) = {[\n= #smallcaps[#title]\n#columns(2)[#content]\n]}\n\n#let interlude(title, orgname, location, dates, summary) = {\n\t[\n\t== #text(blue)[#title]\n\t#emph([#orgname #location #dates])\\\n\t#par(justify: true)[#summary]\n\t]\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 59,
      "score": 1146.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 867
    },
    {
      "id": 6169,
      "post_number": 2,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-28T02:16:11.919Z",
      "updated_at": "2024-11-28T02:16:11.919Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/andrew_matthews\">@Andrew_Matthews</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Andrew_Matthews, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 54,
      "score": 105.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6170,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-28T02:21:11.045Z",
      "updated_at": "2024-11-28T02:21:11.045Z",
      "cooked": "<p>There is an open issue requesting this feature: <a href=\"https://github.com/typst/typst/issues/466\" class=\"inline-onebox\">Balancing the contents of multiple columns to the same vertical space · Issue #466 · typst/typst · GitHub</a></p>\n<p>As well as a draft pull request with a WIP implementation of it: <a href=\"https://github.com/typst/typst/pull/5115\" class=\"inline-onebox\">Column balancing by Caellian · Pull Request #5115 · typst/typst · GitHub</a></p>\n<p>So, for the moment, you can’t do this automatically.</p>\n<p>Your best bet for now, at least unless someone has a more sophisticated workaround, will be manual adjustment of the columns height:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">Example:\n#block(height: 4cm, columns(2, lorem(60)))\n\nMore sample text\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/4/4414cf51358cf2bda754b441c92d043a9d11fcd4.png\" data-download-href=\"https://forum.typst.app/uploads/default/4414cf51358cf2bda754b441c92d043a9d11fcd4\" title=\"output: manually adjusted columns\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/4/4414cf51358cf2bda754b441c92d043a9d11fcd4_2_690x400.png\" alt=\"output: manually adjusted columns\" data-base62-sha1=\"9Ih3ha5yQP8rmLfgfmzZB9tbL00\" width=\"690\" height=\"400\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/4/4414cf51358cf2bda754b441c92d043a9d11fcd4_2_690x400.png, https://forum.typst.app/uploads/default/optimized/2X/4/4414cf51358cf2bda754b441c92d043a9d11fcd4_2_1035x600.png 1.5x, https://forum.typst.app/uploads/default/original/2X/4/4414cf51358cf2bda754b441c92d043a9d11fcd4.png 2x\" data-dominant-color=\"ECECEC\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">output: manually adjusted columns</span><span class=\"informations\">1312×762 188 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "There is an open issue requesting this feature: https://github.com/typst/typst/issues/466\n\nAs well as a draft pull request with a WIP implementation of it: https://github.com/typst/typst/pull/5115\n\nSo, for the moment, you can't do this automatically.\n\nYour best bet for now, at least unless someone has a more sophisticated workaround, will be manual adjustment of the columns height:\n\n```typ\nExample:\n#block(height: 4cm, columns(2, lorem(60)))\n\nMore sample text\n```\n![output: manually adjusted columns|690x400](upload://9Ih3ha5yQP8rmLfgfmzZB9tbL00.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 54,
      "score": 30.8,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6173,
      "post_number": 4,
      "username": "Andrew_Matthews",
      "name": "Andrew Matthews",
      "created_at": "2024-11-28T02:42:23.998Z",
      "updated_at": "2024-11-28T02:42:23.998Z",
      "cooked": "<p>Thanks.  That makes sense.  When is that WIP expected to be released?</p>\n<p>(Since I’m asking anyway) Is there currently support for keeping all elements of a block together (i.e. like the title and summary of a job, so that the whole thing overflows from one col to another if it doesn’t fit).</p>\n<p>Are there alternate ways to tackle the issue?  For example, with Typst, is it possible to implement the equivalent of CSS floating blocks that can be stacked in 2 column mode by setting their width appropriately?</p>",
      "raw": "Thanks.  That makes sense.  When is that WIP expected to be released?  \n\n(Since I'm asking anyway) Is there currently support for keeping all elements of a block together (i.e. like the title and summary of a job, so that the whole thing overflows from one col to another if it doesn't fit).  \n\nAre there alternate ways to tackle the issue?  For example, with Typst, is it possible to implement the equivalent of CSS floating blocks that can be stacked in 2 column mode by setting their width appropriately?",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 47,
      "score": 19.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 867
    },
    {
      "id": 6174,
      "post_number": 5,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-28T02:47:06.823Z",
      "updated_at": "2024-11-28T02:47:06.823Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew_Matthews\" data-post=\"4\" data-topic=\"1915\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew_matthews/48/1387_2.png\" class=\"avatar\"> Andrew_Matthews:</div>\n<blockquote>\n<p>Thanks. That makes sense. When is that WIP expected to be released?</p>\n</blockquote>\n</aside>\n<p>There is no ETA; this is an unofficial effort being led by a community member.</p>\n<aside class=\"quote no-group\" data-username=\"Andrew_Matthews\" data-post=\"4\" data-topic=\"1915\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew_matthews/48/1387_2.png\" class=\"avatar\"> Andrew_Matthews:</div>\n<blockquote>\n<p>(Since I’m asking anyway) Is there currently support for keeping all elements of a block together (i.e. like the title and summary of a job, so that the whole thing overflows from one col to another if it doesn’t fit).</p>\n</blockquote>\n</aside>\n<p>You seem to be looking for <code>#block(sticky: true)[the title]</code> (noting that <code>= headings</code> already have this property by default): <a href=\"https://typst.app/docs/reference/layout/block/#parameters-sticky\" class=\"inline-onebox\">Block Function – Typst Documentation</a></p>\n<aside class=\"quote no-group\" data-username=\"Andrew_Matthews\" data-post=\"4\" data-topic=\"1915\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew_matthews/48/1387_2.png\" class=\"avatar\"> Andrew_Matthews:</div>\n<blockquote>\n<p>Are there alternate ways to tackle the issue? For example, with Typst, is it possible to implement the equivalent of CSS floating blocks that can be stacked in 2 column mode by setting their width appropriately?</p>\n</blockquote>\n</aside>\n<p>You can use a two-column grid instead: <a href=\"https://typst.app/docs/reference/layout/grid/\" class=\"inline-onebox\">Grid Function – Typst Documentation</a></p>",
      "raw": "[quote=\"Andrew_Matthews, post:4, topic:1915\"]\nThanks. That makes sense. When is that WIP expected to be released?\n[/quote]\n\nThere is no ETA; this is an unofficial effort being led by a community member.\n\n[quote=\"Andrew_Matthews, post:4, topic:1915\"]\n(Since I’m asking anyway) Is there currently support for keeping all elements of a block together (i.e. like the title and summary of a job, so that the whole thing overflows from one col to another if it doesn’t fit).\n[/quote]\n\nYou seem to be looking for `#block(sticky: true)[the title]` (noting that `= headings` already have this property by default): https://typst.app/docs/reference/layout/block/#parameters-sticky\n\n[quote=\"Andrew_Matthews, post:4, topic:1915\"]\nAre there alternate ways to tackle the issue? For example, with Typst, is it possible to implement the equivalent of CSS floating blocks that can be stacked in 2 column mode by setting their width appropriately?\n[/quote]\n\nYou can use a two-column grid instead: https://typst.app/docs/reference/layout/grid/",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 1,
      "reads": 47,
      "score": 39.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6175,
      "post_number": 6,
      "username": "Andrew_Matthews",
      "name": "Andrew Matthews",
      "created_at": "2024-11-28T03:16:56.778Z",
      "updated_at": "2024-11-28T03:17:20.761Z",
      "cooked": "<p>The approach whereby I hard-code the vertical height of the columns is somewhat brittle because I cannot predict how much space I will need.  I’m generating the Typst out of data from elsewhere (in this case a simple C# templating app):</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/d/dd2bc4957219f41fe70f09865ff30c317c53fcb4.png\" alt=\"image\" data-base62-sha1=\"vyziblpcnUd4hJRM0K3BsqbhpEU\" width=\"561\" height=\"150\"></p>\n<p>Is there a way to compute the space I need based on the content I’m trying to work with?</p>",
      "raw": "The approach whereby I hard-code the vertical height of the columns is somewhat brittle because I cannot predict how much space I will need.  I'm generating the Typst out of data from elsewhere (in this case a simple C# templating app):\n\n![image|561x150](upload://vyziblpcnUd4hJRM0K3BsqbhpEU.png)\n\nIs there a way to compute the space I need based on the content I'm trying to work with?",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 47,
      "score": 34.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 867
    },
    {
      "id": 6177,
      "post_number": 7,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-28T07:24:44.642Z",
      "updated_at": "2024-11-28T07:24:44.642Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew_Matthews\" data-post=\"6\" data-topic=\"1915\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew_matthews/48/1387_2.png\" class=\"avatar\"> Andrew_Matthews:</div>\n<blockquote>\n<p>Is there a way to compute the space I need based on the content I’m trying to work with?</p>\n</blockquote>\n</aside>\n<p>You can take a look at <a href=\"https://typst.app/docs/reference/layout/measure/\" class=\"inline-onebox\">Measure Function – Typst Documentation</a>, that should be what you’re looking for.</p>",
      "raw": "[quote=\"Andrew_Matthews, post:6, topic:1915\"]\nIs there a way to compute the space I need based on the content I’m trying to work with?\n[/quote]\n\nYou can take a look at https://typst.app/docs/reference/layout/measure/, that should be what you're looking for.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 42,
      "score": 38.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 13927,
      "post_number": 8,
      "username": "nleanba",
      "name": "",
      "created_at": "2025-06-09T20:52:51.525Z",
      "updated_at": "2025-06-09T20:52:51.525Z",
      "cooked": "<p>There is a way to do this by measuring, see my answer at <a href=\"https://forum.typst.app/t/howto-display-the-table-of-contents-in-two-columns-with-an-even-distribution/4514/3\" class=\"inline-onebox\">Howto display the table of contents in two columns with an even distribution? - #3 by nleanba</a></p>",
      "raw": "There is a way to do this by measuring, see my answer at https://forum.typst.app/t/howto-display-the-table-of-contents-in-two-columns-with-an-even-distribution/4514/3",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 15,
      "score": 2.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1719
    }
  ],
  "scraped_at": "2025-06-10T09:54:18.281452"
}
{
  "topic_metadata": {
    "id": 1924,
    "title": "How to reset the page counter after every section?",
    "slug": "how-to-reset-the-page-counter-after-every-section",
    "posts_count": 13,
    "created_at": "2024-11-29T07:39:17.868Z",
    "last_posted_at": "2024-12-07T03:16:13.286Z",
    "views": 782,
    "like_count": 4,
    "reply_count": 8,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 10,
    "accepted_answer_username": "laurmaedje",
    "tags": [
      "scripting",
      "counter"
    ],
    "category_id": 5,
    "participant_count": 5,
    "word_count": 1246
  },
  "posts": [
    {
      "id": 6193,
      "post_number": 1,
      "username": "Div",
      "name": "Div",
      "created_at": "2024-11-29T07:39:18.136Z",
      "updated_at": "2024-11-30T15:02:57.550Z",
      "cooked": "<p>I am currently writing a template where a document has multiple sections; each section has the same table with different data, but the header and footer remain the same. I need to be able to start the page number from 1 for every new section.</p>\n<p>I tried updating the page counter to 1 using pageCounter.update(1), but I was seeing unexpected behavior using this. Specifically, when a table runs over onto the second page, the numbering for the first page becomes 1/1, and for the second one, its 2/1, as compared to what I want being 1/2 and 2/2, respectively.</p>\n<p>Any solutions for achieving this?</p>",
      "raw": "I am currently writing a template where a document has multiple sections; each section has the same table with different data, but the header and footer remain the same. I need to be able to start the page number from 1 for every new section.\n\nI tried updating the page counter to 1 using pageCounter.update(1), but I was seeing unexpected behavior using this. Specifically, when a table runs over onto the second page, the numbering for the first page becomes 1/1, and for the second one, its 2/1, as compared to what I want being 1/2 and 2/2, respectively.\n\nAny solutions for achieving this?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 80,
      "score": 2950.4,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 870
    },
    {
      "id": 6195,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-29T07:51:32.742Z",
      "updated_at": "2024-11-29T07:51:32.742Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/div\">@Div</a> and welcome!<br>\nIt would help if you provide a working example in addition to your detailed explanation. I have reproduced something that may be what you want.</p>\n<p>Bear in mind that the total page number cannot be contextual per section. The final result will look like:</p>\n<ul>\n<li>1/N</li>\n<li>1/N, 2/N</li>\n<li>1/N, 2/N, 3/N</li>\n<li>etc.</li>\n</ul>\n<p>This is tracked at <a href=\"https://github.com/typst/typst/issues/4367\" class=\"inline-onebox\">Support per chapter page numbering with total · Issue #4367 · typst/typst · GitHub</a>.</p>\n<p>There are other posts you might want to read on counters:</p>\n<ul>\n<li><a href=\"https://forum.typst.app/t/how-does-the-counter-update-function-works/799\" class=\"inline-onebox\">How does the counter update function works?</a></li>\n<li><a href=\"https://forum.typst.app/t/wrong-numbering-for-the-equation/1403\" class=\"inline-onebox\">Wrong numbering for the equation</a></li>\n</ul>\n<p>Finally, I cannot recommend more to read the awesome post on <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a> <img src=\"https://forum.typst.app/images/emoji/apple/stuck_out_tongue.png?v=12\" title=\":stuck_out_tongue:\" class=\"emoji\" alt=\":stuck_out_tongue:\" loading=\"lazy\" width=\"20\" height=\"20\">!</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading.where(level: 1): it =&gt; {\n  pagebreak(weak: true)\n  counter(page).update(1)\n  it\n}\n#set page(numbering: \"1 / 1\")\n\n= Section 1\n\n#lorem(500)\n\n= Section 2\n\n#lorem(1000)\n\n= Section 3\n\n#lorem(2000)\n</code></pre>",
      "raw": "Hello @Div and welcome!\nIt would help if you provide a working example in addition to your detailed explanation. I have reproduced something that may be what you want.\n\nBear in mind that the total page number cannot be contextual per section. The final result will look like:\n- 1/N\n- 1/N, 2/N\n- 1/N, 2/N, 3/N\n- etc.\n\nThis is tracked at https://github.com/typst/typst/issues/4367.\n\nThere are other posts you might want to read on counters:\n- https://forum.typst.app/t/how-does-the-counter-update-function-works/799\n- https://forum.typst.app/t/wrong-numbering-for-the-equation/1403\n\nFinally, I cannot recommend more to read the awesome post on https://forum.typst.app/t/how-to-post-in-the-questions-category/11 :stuck_out_tongue:!\n\n```typ\n#show heading.where(level: 1): it => {\n  pagebreak(weak: true)\n  counter(page).update(1)\n  it\n}\n#set page(numbering: \"1 / 1\")\n\n= Section 1\n\n#lorem(500)\n\n= Section 2\n\n#lorem(1000)\n\n= Section 3\n\n#lorem(2000)\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 80,
      "score": 115.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6207,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-30T15:03:39.359Z",
      "updated_at": "2024-11-30T15:03:39.359Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/div\">@Div</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. Also, don’t forget to add some tags next time! <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Div, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. Also, don't forget to add some tags next time! :wink:",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 62,
      "score": 47.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6225,
      "post_number": 4,
      "username": "Div",
      "name": "Div",
      "created_at": "2024-12-02T06:33:33.964Z",
      "updated_at": "2024-12-02T06:33:33.964Z",
      "cooked": "<p>I just realized I terribly worded my question. Let me describe my problem again: I have tables that I am rendering inside a for loop. for each table, I need the page counter to start from 1, for which i am using<br>\npageCounter.update(1)<br>\nat the end of the table. But what I am noticing is that for multipage tables, the current counter of the page is incrementing correctly, and the total page count remains 1 regardless.</p>\n<p>code:<br>\n<span class=\"hashtag-raw\">#for</span> loop<br>\nlet pageCounter = counter(page)<br>\nfunctionForTable<br>\npageCounter.update(1)</p>\n<p>i hope this gives more context haha</p>",
      "raw": "I just realized I terribly worded my question. Let me describe my problem again: I have tables that I am rendering inside a for loop. for each table, I need the page counter to start from 1, for which i am using \npageCounter.update(1)\nat the end of the table. But what I am noticing is that for multipage tables, the current counter of the page is incrementing correctly, and the total page count remains 1 regardless. \n\ncode:\n#for loop\n   let pageCounter = counter(page)\n   functionForTable\n   pageCounter.update(1)\n\n\ni hope this gives more context haha",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 55,
      "score": 15.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 870
    },
    {
      "id": 6226,
      "post_number": 5,
      "username": "Div",
      "name": "Div",
      "created_at": "2024-12-02T06:34:17.301Z",
      "updated_at": "2024-12-02T06:34:17.301Z",
      "cooked": "<p>ah yes, apologies. thankyou will keep this in mind</p>",
      "raw": "ah yes, apologies. thankyou will keep this in mind",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 49,
      "score": 54.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 870
    },
    {
      "id": 6231,
      "post_number": 6,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-02T09:12:08.293Z",
      "updated_at": "2024-12-02T09:12:08.293Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Div\" data-post=\"4\" data-topic=\"1924\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/d/3DA8FF/48.png\" class=\"avatar\"> Div:</div>\n<blockquote>\n<p>let pageCounter = counter(page)</p>\n</blockquote>\n</aside>\n<p>If you put the update after the table, then the compiler updates the page number after the pagebreak. You can put the update right before the table.</p>",
      "raw": "[quote=\"Div, post:4, topic:1924\"]\nlet pageCounter = counter(page)\n[/quote]\n\nIf you put the update after the table, then the compiler updates the page number after the pagebreak. You can put the update right before the table.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 50,
      "score": 19.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6266,
      "post_number": 7,
      "username": "RamkumarKB",
      "name": "Ramkumar KB",
      "created_at": "2024-12-03T00:19:01.006Z",
      "updated_at": "2024-12-03T00:19:01.006Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/quachpas\">@quachpas</a> - I tried the suggestion but does not do the trick.</p>\n<p>The second time it starts with 5/5 and then subsequently it resets and then on 2nd page I get 1/5.</p>\n<p>Please see this sample project that I have created -<br>\n<a href=\"https://typst.app/project/rPcPdAvoThkuHGGd7amNPR\" class=\"onebox\" target=\"_blank\" rel=\"noopener\">https://typst.app/project/rPcPdAvoThkuHGGd7amNPR</a></p>\n<pre><code class=\"lang-auto\">#set page(\n  columns: 1,\n  paper: \"a4\",\n  flipped: false,\n  margin: (x: 16mm, y: 27.5mm),\n  header: context {\n    set text(14pt)\n    counter(page).display(\n    \"1/1\",\n    both: true,\n    )\n  }\n)\n\n= How to reset the page counter?\n\n#set text(14pt)\n\n#let moore = csv(\"moore.csv\")\n\n#let long_table = table(\n  columns: 2,\n  ..for (.., year, count) in moore {\n    (year, count)\n  }\n)\n\n#let n = 2\n#while n &gt; 0 {\n  context { counter(page).update(0) }\n  [This is Moore's Law]\n  long_table\n  pagebreak()\n  n = n - 1\n}\n</code></pre>",
      "raw": "@quachpas - I tried the suggestion but does not do the trick. \n\nThe second time it starts with 5/5 and then subsequently it resets and then on 2nd page I get 1/5.\n\nPlease see this sample project that I have created - \nhttps://typst.app/project/rPcPdAvoThkuHGGd7amNPR \n\n```\n#set page(\n  columns: 1,\n  paper: \"a4\",\n  flipped: false,\n  margin: (x: 16mm, y: 27.5mm),\n  header: context {\n    set text(14pt)\n    counter(page).display(\n    \"1/1\",\n    both: true,\n    )\n  }\n)\n\n= How to reset the page counter?\n\n#set text(14pt)\n\n#let moore = csv(\"moore.csv\")\n\n#let long_table = table(\n  columns: 2,\n  ..for (.., year, count) in moore {\n    (year, count)\n  }\n)\n\n#let n = 2\n#while n > 0 {\n  context { counter(page).update(0) }\n  [This is Moore's Law]\n  long_table\n  pagebreak()\n  n = n - 1\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 0,
      "reads": 48,
      "score": 44.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 294
    },
    {
      "id": 6267,
      "post_number": 8,
      "username": "RamkumarKB",
      "name": "Ramkumar KB",
      "created_at": "2024-12-03T00:24:35.206Z",
      "updated_at": "2024-12-03T00:24:35.206Z",
      "cooked": "<p>We need the <code>pagebreak()</code> but that seems to interfere with the desired outcome… ?</p>",
      "raw": "We need the `pagebreak()` but that seems to interfere with the desired outcome... ?",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 42,
      "score": 8.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 294
    },
    {
      "id": 6271,
      "post_number": 9,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-03T07:18:38.589Z",
      "updated_at": "2024-12-03T07:18:38.589Z",
      "cooked": "<p>The behaviour is tricky here. If you use <code>footer</code> instead of <code>header</code>, you will get a different result. Indeed, you are manually writing a <em>contextual expression</em> in the header/footer. So depending on its location in the document, it will return a different result. In addition to updating the page counter manually, that sets off too many edge cases.</p>\n<p>I suggest to use the named arguments <code>numbering</code> and <code>number-align</code> instead, which are created for that specifically.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(\n  columns: 1,\n  paper: \"a4\",\n  flipped: false,\n  margin: (x: 16mm, y: 27.5mm),\n  numbering: \"1/1\",\n  number-align: center + bottom, // or center + top\n)\n</code></pre>\n<p>Also, you should use <code>update(1)</code> and not 0, as well as a weak pagebreak, which avoids blank pages.</p>",
      "raw": "The behaviour is tricky here. If you use `footer` instead of `header`, you will get a different result. Indeed, you are manually writing a _contextual expression_ in the header/footer. So depending on its location in the document, it will return a different result. In addition to updating the page counter manually, that sets off too many edge cases.\n\nI suggest to use the named arguments `numbering` and `number-align` instead, which are created for that specifically.\n\n```typ\n#set page(\n  columns: 1,\n  paper: \"a4\",\n  flipped: false,\n  margin: (x: 16mm, y: 27.5mm),\n  numbering: \"1/1\",\n  number-align: center + bottom, // or center + top\n)\n```\n\nAlso, you should use `update(1)` and not 0, as well as a weak pagebreak, which avoids blank pages.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 48,
      "score": 19.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6279,
      "post_number": 10,
      "username": "laurmaedje",
      "name": "Laurenz Mädje",
      "created_at": "2024-12-03T12:52:53.290Z",
      "updated_at": "2024-12-06T23:03:18.319Z",
      "cooked": "<p>The counter is resolved based on the logical order of things: The header is logically before the page content, which is followed by the footer. Thus, if you have a counter update within a page, it will be reflected in the footer, but not in the header.</p>\n<p>However, there is an escape hatch: Typically, what you truly want is to reset the page counter <em>between</em> to pages. To do that, you can sandwich an update between two pagebreaks (with at least of them being <code>weak</code>), and Typst will correctly understand that it’s supposed to happen in the empty void between. (Unfortunately, this behaviour is not properly documented.)</p>\n<p>The following example demonstrates the feature:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(\n  paper: \"a8\",\n  margin: 40pt,\n  header: context counter(page).display(),\n  footer: context counter(page).display(),\n)\n\nA\n\n// Try uncommenting each of the pagebreaks in turn:\n// #pagebreak()\n#counter(page).update(5)\n// #pagebreak(weak: true)\n\nB\n</code></pre>\n<p>With this, you can fix the first problem of your page numbering (that numbers are off by one). The second part (which is not exhibited by your example) is more problematic: The final value will <em>always</em> corresponds to the page number at the very end of the document, not to the end of the “section”. There is no built-in feature for this at the moment, but it can be realized with a slightly more manual setup, which I’ve implemented below:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// Returns the page total of the current section.\n#let reset = &lt;__reset&gt;\n#let subtotal() = {\n  let loc = here()\n  let list = query(selector(reset).after(loc))\n  if list.len() &gt; 0 { \n    counter(page).at(list.first().location()).first() - 1\n  } else {\n    counter(page).final().first()\n  }\n}\n\n// A section of content with reset page numbering.\n//\n// Leaves a marker we can query to find the subtotal page number.\n// Resets the page counter in between the pages.\n#let section(it) = {\n  pagebreak(weak: true)\n  [#metadata(none)#reset]\n  counter(page).update(1)\n  pagebreak(weak: true)\n  it\n}\n\n#let page-numbers = context numbering(\n  \"1 / 1\",\n  ..counter(page).get(),\n  subtotal(),\n)\n\n#set page(\n  paper: \"a8\",\n  margin: 40pt,\n  // Show both in the header &amp; footer to see the effect.\n  header: align(center, page-numbers),\n  footer: align(center, page-numbers),\n)\n\n#section([= A] + lorem(30))\n#section([= B] + lorem(60))\n#section([= C] + lorem(30))\n</code></pre>",
      "raw": "The counter is resolved based on the logical order of things: The header is logically before the page content, which is followed by the footer. Thus, if you have a counter update within a page, it will be reflected in the footer, but not in the header.\n\nHowever, there is an escape hatch: Typically, what you truly want is to reset the page counter _between_ to pages. To do that, you can sandwich an update between two pagebreaks (with at least of them being `weak`), and Typst will correctly understand that it's supposed to happen in the empty void between. (Unfortunately, this behaviour is not properly documented.)\n\nThe following example demonstrates the feature:\n\n```typ\n#set page(\n  paper: \"a8\",\n  margin: 40pt,\n  header: context counter(page).display(),\n  footer: context counter(page).display(),\n)\n\nA\n\n// Try uncommenting each of the pagebreaks in turn:\n// #pagebreak()\n#counter(page).update(5)\n// #pagebreak(weak: true)\n\nB\n```\n\nWith this, you can fix the first problem of your page numbering (that numbers are off by one). The second part (which is not exhibited by your example) is more problematic: The final value will _always_ corresponds to the page number at the very end of the document, not to the end of the \"section\". There is no built-in feature for this at the moment, but it can be realized with a slightly more manual setup, which I've implemented below:\n\n```typ\n// Returns the page total of the current section.\n#let reset = <__reset>\n#let subtotal() = {\n  let loc = here()\n  let list = query(selector(reset).after(loc))\n  if list.len() > 0 { \n    counter(page).at(list.first().location()).first() - 1\n  } else {\n    counter(page).final().first()\n  }\n}\n\n// A section of content with reset page numbering.\n//\n// Leaves a marker we can query to find the subtotal page number.\n// Resets the page counter in between the pages.\n#let section(it) = {\n  pagebreak(weak: true)\n  [#metadata(none)#reset]\n  counter(page).update(1)\n  pagebreak(weak: true)\n  it\n}\n\n#let page-numbers = context numbering(\n  \"1 / 1\",\n  ..counter(page).get(),\n  subtotal(),\n)\n\n#set page(\n  paper: \"a8\",\n  margin: 40pt,\n  // Show both in the header & footer to see the effect.\n  header: align(center, page-numbers),\n  footer: align(center, page-numbers),\n)\n\n#section([= A] + lorem(30))\n#section([= B] + lorem(60))\n#section([= C] + lorem(30))\n```",
      "reply_to_post_number": 7,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 47,
      "score": 339.0,
      "accepted_answer": true,
      "trust_level": 4,
      "user_id": 2
    },
    {
      "id": 6389,
      "post_number": 11,
      "username": "RamkumarKB",
      "name": "Ramkumar KB",
      "created_at": "2024-12-06T16:13:59.864Z",
      "updated_at": "2024-12-06T16:48:18.892Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/laurmaedje\">@laurmaedje</a>  - First of all,  a big thank you for the details and the solution provided.</p>\n<p>I did a quick test and it looks like <code>header</code> is good but <code>footer</code> still has a small issue. In the last page of every section it shows the counter of the last of page of the following section. So example - it shows 3 / 5 in the last page of the 1st section, 5 / 3 in the last page of the 2nd section. The last section shows 3 / 3 correctly.</p>\n<p>May be we need to adjust the subtotal() function a bit?</p>\n<details>\n<summary>\nSummary</summary>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/2/2f6afa4fa5e28366b7030e61f588107c4c7bfbe3.png\" data-download-href=\"https://forum.typst.app/uploads/default/2f6afa4fa5e28366b7030e61f588107c4c7bfbe3\" title=\"Screenshot 2024-12-07 at 12.47.29 AM\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/2/2f6afa4fa5e28366b7030e61f588107c4c7bfbe3_2_365x499.png\" alt=\"Screenshot 2024-12-07 at 12.47.29 AM\" data-base62-sha1=\"6LtDFWlCHAOgM4YX3GDSPVDMfNV\" width=\"365\" height=\"499\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/2/2f6afa4fa5e28366b7030e61f588107c4c7bfbe3_2_365x499.png, https://forum.typst.app/uploads/default/original/2X/2/2f6afa4fa5e28366b7030e61f588107c4c7bfbe3.png 1.5x, https://forum.typst.app/uploads/default/original/2X/2/2f6afa4fa5e28366b7030e61f588107c4c7bfbe3.png 2x\" data-dominant-color=\"F9F9FA\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2024-12-07 at 12.47.29 AM</span><span class=\"informations\">502×686 30.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>",
      "raw": "@laurmaedje  - First of all,  a big thank you for the details and the solution provided. \n\nI did a quick test and it looks like `header` is good but `footer` still has a small issue. In the last page of every section it shows the counter of the last of page of the following section. So example - it shows 3 / 5 in the last page of the 1st section, 5 / 3 in the last page of the 2nd section. The last section shows 3 / 3 correctly.\n\nMay be we need to adjust the subtotal() function a bit?\n\n[details=\"Summary\"]\n![Screenshot 2024-12-07 at 12.47.29 AM|365x499](upload://6LtDFWlCHAOgM4YX3GDSPVDMfNV.png)\n\n[/details]",
      "reply_to_post_number": 10,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 31.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 294
    },
    {
      "id": 6392,
      "post_number": 12,
      "username": "laurmaedje",
      "name": "Laurenz Mädje",
      "created_at": "2024-12-06T23:06:13.292Z",
      "updated_at": "2024-12-06T23:06:13.292Z",
      "cooked": "<p>You’re right, I missed this. I edited my post above with a bug fix. (Thanks to Sekoia on Discord for coming up with the fix!)</p>",
      "raw": "You're right, I missed this. I edited my post above with a bug fix. (Thanks to Sekoia on Discord for coming up with the fix!)",
      "reply_to_post_number": 11,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 16.4,
      "accepted_answer": false,
      "trust_level": 4,
      "user_id": 2
    },
    {
      "id": 6394,
      "post_number": 13,
      "username": "RamkumarKB",
      "name": "Ramkumar KB",
      "created_at": "2024-12-07T03:16:13.286Z",
      "updated_at": "2024-12-07T03:16:13.286Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/laurmaedje\">@laurmaedje</a> - Thank you for the update. This works now <img src=\"https://forum.typst.app/images/emoji/apple/100.png?v=12\" title=\":100:\" class=\"emoji\" alt=\":100:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "@laurmaedje - Thank you for the update. This works now :100:",
      "reply_to_post_number": 12,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 6.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 294
    }
  ],
  "scraped_at": "2025-06-10T09:54:17.561234"
}
{
  "topic_metadata": {
    "id": 1927,
    "title": "How to detect local heading level in separate context blocks?",
    "slug": "how-to-detect-local-heading-level-in-separate-context-blocks",
    "posts_count": 4,
    "created_at": "2024-11-29T08:36:10.078Z",
    "last_posted_at": "2024-12-10T15:57:30.811Z",
    "views": 164,
    "like_count": 3,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "flokl",
    "tags": [
      "scripting",
      "context",
      "introspection"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 632
  },
  "posts": [
    {
      "id": 6199,
      "post_number": 1,
      "username": "Simon_Schneider",
      "name": "Simon  Schneider",
      "created_at": "2024-11-29T08:36:10.186Z",
      "updated_at": "2024-12-15T10:29:20.602Z",
      "cooked": "<p>I would like to create templates that add headings along with some other content to the document. It would be nice if I would not have to specify the heading level repeatedly and just have the template detect it itself.<br>\nFor this I have created a function that uses context to determine the heading level of the most recent heading level.</p>\n<pre><code class=\"lang-auto\">#let get_local_heading_level(increment: 0) = {\n  let headings = query(selector(heading).before(here()))\n  if headings.len() &gt; 0 {\n    let most_recent_heading = headings.last()\n    return headings.last().level + increment\n  }\n  return 1 + increment\n}\n</code></pre>\n<p>This works well, if all the calls are within one context block. Unfortunately, if the calls to the function are in separate context block it works for three headings and then suddenly starts applying wrong heading levels. E.g heading 2.5 and 2.6 are shown as heading 4.</p>\n<pre><code class=\"lang-auto\">#set heading(numbering: \"1.\")\n\n// this works\n#heading([Heading 1], level: 1)\n#heading([Heading 1.1], level: 2)\n#context [\n  #heading([Heading 1.2], level: get_local_heading_level())\n  #heading([Heading 1.3], level: get_local_heading_level())\n  #heading([Heading 1.4], level: get_local_heading_level())\n  #heading([Heading 1.5], level: get_local_heading_level())\n  #heading([Heading 1.6], level: get_local_heading_level())\n]\n\n// this doesn't work\n#heading([Heading 2], level: 1)\n#heading([Heading 2.1], level: 2)\n#context [ #heading([Heading 2.2], level: get_local_heading_level())]\n#context [ #heading([Heading 2.3], level: get_local_heading_level())]\n#context [ #heading([Heading 2.4], level: get_local_heading_level())]\n#context [ #heading([Heading 2.5], level: get_local_heading_level())] // generates: 4. Heading 2.5\n#context [ #heading([Heading 2.6], level: get_local_heading_level())] // generates: 4. Heading 2.6\n</code></pre>\n<p>Does anyone have an idea what the issue with the second example is?</p>\n<p>Using the single context example is a fallback option, but since I am trying to create templates for my coworkers, I’d like to keep them as simple to use as possible.</p>",
      "raw": "I would like to create templates that add headings along with some other content to the document. It would be nice if I would not have to specify the heading level repeatedly and just have the template detect it itself.\nFor this I have created a function that uses context to determine the heading level of the most recent heading level.\n```\n#let get_local_heading_level(increment: 0) = {\n  let headings = query(selector(heading).before(here()))\n  if headings.len() > 0 {\n    let most_recent_heading = headings.last()\n    return headings.last().level + increment\n  }\n  return 1 + increment\n}\n```\nThis works well, if all the calls are within one context block. Unfortunately, if the calls to the function are in separate context block it works for three headings and then suddenly starts applying wrong heading levels. E.g heading 2.5 and 2.6 are shown as heading 4.\n```\n#set heading(numbering: \"1.\")\n\n// this works\n#heading([Heading 1], level: 1)\n#heading([Heading 1.1], level: 2)\n#context [\n  #heading([Heading 1.2], level: get_local_heading_level())\n  #heading([Heading 1.3], level: get_local_heading_level())\n  #heading([Heading 1.4], level: get_local_heading_level())\n  #heading([Heading 1.5], level: get_local_heading_level())\n  #heading([Heading 1.6], level: get_local_heading_level())\n]\n\n// this doesn't work\n#heading([Heading 2], level: 1)\n#heading([Heading 2.1], level: 2)\n#context [ #heading([Heading 2.2], level: get_local_heading_level())]\n#context [ #heading([Heading 2.3], level: get_local_heading_level())]\n#context [ #heading([Heading 2.4], level: get_local_heading_level())]\n#context [ #heading([Heading 2.5], level: get_local_heading_level())] // generates: 4. Heading 2.5\n#context [ #heading([Heading 2.6], level: get_local_heading_level())] // generates: 4. Heading 2.6\n```\nDoes anyone have an idea what the issue with the second example is?\n\nUsing the single context example is a fallback option, but since I am trying to create templates for my coworkers, I'd like to keep them as simple to use as possible.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 40,
      "score": 438.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 871
    },
    {
      "id": 6205,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2024-11-29T18:23:06.026Z",
      "updated_at": "2024-11-29T18:26:42.509Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/simon_schneider\">@Simon_Schneider</a>,</p>\n<p>your attempt is a bit problematic. The heading levels are wrong because the compiler is not able to compile your document and show the warning “Layout did not converge”.<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/6/698407bcf80f63c155a353ec0ec5648f96eb2d5d.png\" alt=\"image\" data-base62-sha1=\"f3r0ubTO78vTQrhL29DG8uCypyJ\" width=\"288\" height=\"121\"></p>\n<p>This happens because your contextual <code>get_local_heading_level</code> calls depend on the previous ones. Essentially, your document compiles once, then a second time to resolve the big <code>context</code> block, then the second <code>context</code> call for <code>Heading 2.2</code> depends on the first, and so on.<br>\nYour example works up to <code>Heading 2.4</code> because Typst allows up to 5 iterations. I hope my explanation makes sense, for more information see the documentation about <a href=\"https://typst.app/docs/reference/context/\">context</a>, <a href=\"https://typst.app/docs/reference/context/#compiler-iterations\">context iterations</a> and feel free to ask follow up questions.</p>\n<p>Here is my attempt to implement a working version using <a href=\"https://typst.app/docs/reference/introspection/metadata/\">metadata</a>.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set heading(numbering: \"1.a\")\n\n#let auto-heading(text) = [#metadata(text) &lt;auto-heading&gt;]\n#show &lt;auto-heading&gt;: meta =&gt; {\n  let prev-heading = query(selector(heading).before(meta.location())).last()\n  heading(level: prev-heading.level, meta.value) \n}\n\n= Heading 1\n\n#lorem(10)\n\n#auto-heading[Heading 2]\n\n#lorem(10)\n\n== Heading 2.1\n\n#lorem(10)\n\n#auto-heading[Heading 2.2]\n\n#lorem(10)\n\n= Heading 3\n#auto-heading[Heading 4]\n</code></pre>\n<details>\n<summary>\nOutput</summary>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/b/b6396d4f9363cb830452a5e8981667058ba388c7.png\" alt=\"test\" data-base62-sha1=\"q01W3usl3bIgezcGzMeRpZT3Nav\" width=\"305\" height=\"232\"></p>\n</details>",
      "raw": "Hi @Simon_Schneider,\n\nyour attempt is a bit problematic. The heading levels are wrong because the compiler is not able to compile your document and show the warning \"Layout did not converge\". \n![image|288x121](upload://f3r0ubTO78vTQrhL29DG8uCypyJ.png)\n\nThis happens because your contextual `get_local_heading_level` calls depend on the previous ones. Essentially, your document compiles once, then a second time to resolve the big `context` block, then the second `context` call for `Heading 2.2` depends on the first, and so on.\nYour example works up to `Heading 2.4` because Typst allows up to 5 iterations. I hope my explanation makes sense, for more information see the documentation about [context](https://typst.app/docs/reference/context/), [context iterations](https://typst.app/docs/reference/context/#compiler-iterations) and feel free to ask follow up questions.\n\nHere is my attempt to implement a working version using [metadata](https://typst.app/docs/reference/introspection/metadata/).\n```typst\n#set heading(numbering: \"1.a\")\n\n#let auto-heading(text) = [#metadata(text) <auto-heading>]\n#show <auto-heading>: meta => {\n  let prev-heading = query(selector(heading).before(meta.location())).last()\n  heading(level: prev-heading.level, meta.value) \n}\n\n= Heading 1\n\n#lorem(10)\n\n#auto-heading[Heading 2]\n\n#lorem(10)\n\n== Heading 2.1\n\n#lorem(10)\n\n#auto-heading[Heading 2.2]\n\n#lorem(10)\n\n= Heading 3\n#auto-heading[Heading 4]\n```\n\n[details=\"Output\"]\n![test|305x232](upload://q01W3usl3bIgezcGzMeRpZT3Nav.png)\n[/details]",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 36,
      "score": 37.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 6472,
      "post_number": 3,
      "username": "Simon_Schneider",
      "name": "Simon  Schneider",
      "created_at": "2024-12-10T14:53:43.642Z",
      "updated_at": "2024-12-10T14:53:43.642Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/flokl\">@flokl</a><br>\nThank you for your explanation, it makes perfect sense.<br>\nYour example works perfectly, although I don’t really understand, how the show rule avoids the context iteration issue.<br>\nWould you mind expanding on that?</p>",
      "raw": "Hi @flokl \nThank you for your explanation, it makes perfect sense.\nYour example works perfectly, although I don't really understand, how the show rule avoids the context iteration issue.\nWould you mind expanding on that?",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 25,
      "score": 19.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 871
    },
    {
      "id": 6473,
      "post_number": 4,
      "username": "flokl",
      "name": "",
      "created_at": "2024-12-10T15:57:30.811Z",
      "updated_at": "2024-12-10T17:34:09.606Z",
      "cooked": "<p>One of the last steps of an iteration is the evaluation of the show rule. This means in this example first <strong>all</strong> <code>auto-headings</code> are replaced top to bottom with <code>metadata</code> and then the show rule gets evaluated top to bottom. At the point the show rule runs, Typst already knows the location/number of all the headings and can easily query the one before the current location.</p>\n<p>That’s how I understand it, but I can’t guarantee that it’s 100% correct.</p>",
      "raw": "One of the last steps of an iteration is the evaluation of the show rule. This means in this example first **all** `auto-headings` are replaced top to bottom with `metadata` and then the show rule gets evaluated top to bottom. At the point the show rule runs, Typst already knows the location/number of all the headings and can easily query the one before the current location. \n\nThat's how I understand it, but I can't guarantee that it's 100% correct.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 22,
      "score": 34.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 8
    }
  ],
  "scraped_at": "2025-06-10T09:54:16.810842"
}
{
  "topic_metadata": {
    "id": 1930,
    "title": "Can I make citations appear as footnotes?",
    "slug": "can-i-make-citations-appear-as-footnotes",
    "posts_count": 3,
    "created_at": "2024-11-29T12:39:46.951Z",
    "last_posted_at": "2024-11-30T15:29:00.315Z",
    "views": 492,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "layout",
      "citation"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 386
  },
  "posts": [
    {
      "id": 6202,
      "post_number": 1,
      "username": "Christopher_Marcotte",
      "name": "Christopher Marcotte",
      "created_at": "2024-11-29T12:39:47.152Z",
      "updated_at": "2024-11-29T12:39:47.152Z",
      "cooked": "<p>Hello,</p>\n<p>On slides, it is helpful to have the citations appear on the same slide in full format, instead of collected at the end. Ideally, these are shown with a non-numeric symbol (like fa-book or something).</p>\n<p>I can’t quite figure out how to make the citations (with <code>@citation</code> syntax) appear as footnotes. With the hayagriva demo citations in refs.yaml, I can put</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(paper: \"a8\")\n#show cite: it =&gt; {\n  footnote()[#it.fields() /*#cite(it.key(), form: \"full\", style: \"nature\")*/]\n}\nHere, I have text with a @harry citation.\n#pagebreak()\nAnd more text with @electronic citation.\n#bibliography(\"refs.yaml\")\n</code></pre>\n<p>Produce the usual endnote citations, with footnotes on each page repeating the reference index value. In the commented out attempt, you can see I am trying to access the key <code>it.key</code> (which does not exist, though the <code>#it.fields()</code> call in the content makes it seem so). Is this because the <code>cite</code> command returns content so I would need to intercept this earlier in the process to get the key and manually construct the <code>#footnote[#cite(key, ..)]</code>?</p>\n<p>Trying a <code>#it.at.(\"key\")</code> crashes the web app compiler, which is perhaps concerning, too.</p>",
      "raw": "Hello,\n\nOn slides, it is helpful to have the citations appear on the same slide in full format, instead of collected at the end. Ideally, these are shown with a non-numeric symbol (like fa-book or something).\n\nI can't quite figure out how to make the citations (with `@citation` syntax) appear as footnotes. With the hayagriva demo citations in refs.yaml, I can put\n```typ\n#set page(paper: \"a8\")\n#show cite: it => {\n  footnote()[#it.fields() /*#cite(it.key(), form: \"full\", style: \"nature\")*/]\n}\nHere, I have text with a @harry citation.\n#pagebreak()\nAnd more text with @electronic citation.\n#bibliography(\"refs.yaml\")\n```\nProduce the usual endnote citations, with footnotes on each page repeating the reference index value. In the commented out attempt, you can see I am trying to access the key `it.key` (which does not exist, though the `#it.fields()` call in the content makes it seem so). Is this because the `cite` command returns content so I would need to intercept this earlier in the process to get the key and manually construct the `#footnote[#cite(key, ..)]`?\n\nTrying a `#it.at.(\"key\")` crashes the web app compiler, which is perhaps concerning, too.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 52,
      "score": 2185.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 270
    },
    {
      "id": 6203,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-29T12:46:41.821Z",
      "updated_at": "2024-11-29T12:46:41.821Z",
      "cooked": "<p>The <code>@citation</code> syntax is actually a <code>ref</code>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show ref: footnote\n</code></pre>\n<p>will make all references as footnotes, including references to labels.</p>\n<p>The documentation gives a more detailed example<br>\nhere: <a href=\"https://typst.app/docs/reference/model/ref/#:~:text=Chapter%5D.-,Customization,-If%20you%20write\" class=\"inline-onebox\">Reference Function – Typst Documentation</a><br>\nwhich you can adapt to result in</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show ref: it =&gt; {\n  let cite = ref\n  let el = it.element\n  if el == none {\n    footnote(it)\n  } else {\n    it\n  }\n}\n#set heading(numbering: \"1\")\n= Heading &lt;label&gt;\n\nCitation: @citation\n\nLabel: @label\n\n#bibliography(\"bibliography.bib\")\n</code></pre>\n<p>In most IDEs, you can inspect the value of <code>it</code>, which is the input to the show rule on ref. Otherwise, just print it using <a href=\"https://typst.app/docs/reference/foundations/repr/\"><code>repr</code></a>.<br>\nFor example, I have<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/4/40ee5aaf11651d698bda4a3994a3389d6810d7e8.png\" alt=\"image\" data-base62-sha1=\"9gpeeXPf9qUXBw4lwX3D1V6SCVO\" width=\"583\" height=\"422\"></p>",
      "raw": "The `@citation` syntax is actually a `ref`.\n```typ\n#show ref: footnote\n```\nwill make all references as footnotes, including references to labels.\n\nThe documentation gives a more detailed example\nhere: https://typst.app/docs/reference/model/ref/#:~:text=Chapter%5D.-,Customization,-If%20you%20write\nwhich you can adapt to result in\n```typ\n#show ref: it => {\n  let cite = ref\n  let el = it.element\n  if el == none {\n    footnote(it)\n  } else {\n    it\n  }\n}\n#set heading(numbering: \"1\")\n= Heading <label>\n\nCitation: @citation\n\nLabel: @label\n\n#bibliography(\"bibliography.bib\")\n```\n\nIn most IDEs, you can inspect the value of `it`, which is the input to the show rule on ref. Otherwise, just print it using [`repr`](https://typst.app/docs/reference/foundations/repr/).\nFor example, I have \n![image|583x422](upload://9gpeeXPf9qUXBw4lwX3D1V6SCVO.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 51,
      "score": 75.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6208,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-30T15:29:00.315Z",
      "updated_at": "2024-11-30T15:29:00.315Z",
      "cooked": "<p>The recommended way to do this is to use a citation style designed for footnotes, as this is natively supported by Typst:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(height: auto)\n#set cite(style: \"chicago-notes\")\n\nThis is a citation@typst\n\n#bibliography(\"bib.yaml\")\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/7/78c630bb3af7ba9700cc5570c50703746b74b5c3.png\" alt=\"output: citation as footnote\" data-base62-sha1=\"hepUSeFBT4IvkxnF8brh3ndkv75\" width=\"466\" height=\"165\"></p>\n<details>\n<summary>\nbib.yaml file for reference</summary>\n<pre data-code-wrap=\"yaml\"><code class=\"lang-yaml\">typst:\n    type: Web\n    title: Typst\n    author:\n      - Laurenz\n      - Martin\n    url: https://typst.app\n</code></pre>\n</details>",
      "raw": "The recommended way to do this is to use a citation style designed for footnotes, as this is natively supported by Typst:\n\n```typ\n#set page(height: auto)\n#set cite(style: \"chicago-notes\")\n\nThis is a citation@typst\n\n#bibliography(\"bib.yaml\")\n```\n![output: citation as footnote|466x165](upload://hepUSeFBT4IvkxnF8brh3ndkv75.png)\n\n\n[details=\"bib.yaml file for reference\"]\n```yaml\ntypst:\n    type: Web\n    title: Typst\n    author:\n      - Laurenz\n      - Martin\n    url: https://typst.app\n```\n[/details]",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 38,
      "score": 67.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:54:16.088864"
}
{
  "topic_metadata": {
    "id": 1936,
    "title": "How can I number equations within sections?",
    "slug": "how-can-i-number-equations-within-sections",
    "posts_count": 6,
    "created_at": "2024-12-01T21:18:38.818Z",
    "last_posted_at": "2024-12-02T14:17:36.638Z",
    "views": 478,
    "like_count": 4,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 7,
    "accepted_answer_username": "Sinthoras",
    "tags": [
      "latex-migration",
      "introspection"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 596
  },
  "posts": [
    {
      "id": 6214,
      "post_number": 1,
      "username": "Sinthoras",
      "name": "",
      "created_at": "2024-12-01T21:18:38.977Z",
      "updated_at": "2024-12-30T13:41:03.731Z",
      "cooked": "<p>I want a command similar to LaTeXs <code>\\numberwithin{equation}{section}</code>.</p>\n<p>So e.g. the 5th equation in chapter 2 should have the number (2.5). How can I achieve this? Is there a package that does this?</p>\n<p>On Discord, I found some old code that works, but the compiler gives the warning that this uses the deprecated <code>locate</code> function so I would assume that this is not the canonical way to do this. What is?</p>\n<p>(I feel like the most user friendly would be a package that does this under the hood and gets updated every time a new version of typst deprecates some of the used code. Has anyone written or seen this?)</p>\n<p>The code on Discord as a reference:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set heading(numbering: \"1.\")\n#let chaptercounter=counter(\"chapter\")\n#let equationcounter=counter(math.equation)\n\n#show heading.where(level:1): it =&gt; {\n  chaptercounter.step()\n  equationcounter.update(0)\n  it\n}\n\n#set math.equation(numbering: it =&gt; {\nlocate(loc =&gt; {\nlet count = chaptercounter.at(loc).first()\nnumbering(\"(1.1)\", count, it)\n})})\n\n= Section\n\n$ 5 + 3 = 8 $\n$ 5 + 3 = 8 $\n\n= New Section\n== Test\n\n$ 5 + 3 = 8 $ &lt;thiseq&gt;\n== Test 2\n$ 5 + 3 = 8 $\n</code></pre>",
      "raw": "I want a command similar to LaTeXs `\\numberwithin{equation}{section}`.\n\nSo e.g. the 5th equation in chapter 2 should have the number (2.5). How can I achieve this? Is there a package that does this?\n\n\n\nOn Discord, I found some old code that works, but the compiler gives the warning that this uses the deprecated `locate` function so I would assume that this is not the canonical way to do this. What is?\n\n (I feel like the most user friendly would be a package that does this under the hood and gets updated every time a new version of typst deprecates some of the used code. Has anyone written or seen this?)\n\nThe code on Discord as a reference:\n```typst\n#set heading(numbering: \"1.\")\n#let chaptercounter=counter(\"chapter\")\n#let equationcounter=counter(math.equation)\n\n#show heading.where(level:1): it => {\n  chaptercounter.step()\n  equationcounter.update(0)\n  it\n}\n\n#set math.equation(numbering: it => {\nlocate(loc => {\nlet count = chaptercounter.at(loc).first()\nnumbering(\"(1.1)\", count, it)\n})})\n\n= Section\n\n$ 5 + 3 = 8 $\n$ 5 + 3 = 8 $\n\n= New Section\n== Test\n\n$ 5 + 3 = 8 $ <thiseq>\n== Test 2\n$ 5 + 3 = 8 $\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 53,
      "score": 1950.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 511
    },
    {
      "id": 6221,
      "post_number": 2,
      "username": "miles-1",
      "name": "miles",
      "created_at": "2024-12-02T01:00:53.643Z",
      "updated_at": "2024-12-04T17:25:52.644Z",
      "cooked": "<p>Try replacing the <code>set</code> rule for <code>math.equation</code> with this:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set math.equation(numbering: it =&gt; {\n  let count = chaptercounter.get().first()\n  numbering(\"(1.1)\", count, it)\n})\n</code></pre>\n<p>From the docs for <a href=\"https://typst.app/docs/reference/introspection/locate/\"><code>locate</code></a>:</p>\n<blockquote>\n<p>In Typst 0.10 and lower, the <code>locate</code> function took a closure that made the current location in the document available (like <a href=\"https://typst.app/docs/reference/introspection/here/\"><code>here</code></a> does now).</p>\n</blockquote>\n<p>… and <code>.get()</code> is the same as <code>.at(here())</code> (see <a href=\"https://typst.app/docs/reference/introspection/counter/#definitions-get\">documentation for <code>.get()</code></a>)</p>\n<p>I get what you’re saying about this being dropped into a package to be user-friendly, and there very well may be a package that might manage this. However, I find one of the great features of Typst is using <code>set</code> and <code>show</code> rules to precisely style your document. This has the added benefit of having only minimal package dependencies (in contrast to LaTeX).</p>",
      "raw": "Try replacing the `set` rule for `math.equation` with this:\n\n```typst\n#set math.equation(numbering: it => {\n  let count = chaptercounter.get().first()\n  numbering(\"(1.1)\", count, it)\n})\n```\n\nFrom the docs for [`locate`](https://typst.app/docs/reference/introspection/locate/):\n\n> In Typst 0.10 and lower, the `locate` function took a closure that made the current location in the document available (like [`here`](https://typst.app/docs/reference/introspection/here/) does now).\n\n... and `.get()` is the same as `.at(here())` (see [documentation for `.get()`](https://typst.app/docs/reference/introspection/counter/#definitions-get))\n\nI get what you're saying about this being dropped into a package to be user-friendly, and there very well may be a package that might manage this. However, I find one of the great features of Typst is using `set` and `show` rules to precisely style your document. This has the added benefit of having only minimal package dependencies (in contrast to LaTeX).",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 48,
      "score": 154.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 177
    },
    {
      "id": 6224,
      "post_number": 3,
      "username": "jbirnick",
      "name": "Johann Birnick",
      "created_at": "2024-12-02T05:31:02.415Z",
      "updated_at": "2024-12-02T05:32:29.368Z",
      "cooked": "<p>There are counting packages. Both <a href=\"https://typst.app/universe/package/headcount\">headcount</a> and <a href=\"https://typst.app/universe/package/rich-counters\">rich-counters</a> might be useful for your usecase.</p>",
      "raw": "There are counting packages. Both [headcount](https://typst.app/universe/package/headcount) and [rich-counters](https://typst.app/universe/package/rich-counters) might be useful for your usecase.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 46,
      "score": 29.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 218
    },
    {
      "id": 6236,
      "post_number": 5,
      "username": "Ido",
      "name": "",
      "created_at": "2024-12-02T11:33:35.786Z",
      "updated_at": "2024-12-02T11:33:35.786Z",
      "cooked": "<p>I used what you suggested and changed it a bit to be:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set heading(numbering: \"1.\")\n#show heading.where(level:1): it =&gt; {\n  counter(math.equation).update(0)\n  it\n}\n\n#set math.equation(\n  numbering: it =&gt; {\n    let count = counter(heading.where(level: 1)).at(here()).first()\n    if count &gt;0 {\n      numbering(\"(1.1)\", count, it)\n    } else {\n      numbering(\"(1)\",it)\n    }\n  }\n)\n</code></pre>\n<p>What can be a good way to implement it also for a minimal theorem that is defined in the template like this:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#show figure.where(kind: \"thm\"): it =&gt; [\n  / #it.supplement #context(it.counter.display(it.numbering)).: #it.body\n]\n#let thm(it) = figure(\n  kind: \"thm\",\n  supplement: \"Theorem\",\n  caption: none,\n  placement: none, \n  it\n) \n</code></pre>\n<p>More suggestions are welcomed <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "I used what you suggested and changed it a bit to be:\n```typst\n#set heading(numbering: \"1.\")\n#show heading.where(level:1): it => {\n  counter(math.equation).update(0)\n  it\n}\n\n#set math.equation(\n  numbering: it => {\n    let count = counter(heading.where(level: 1)).at(here()).first()\n    if count >0 {\n      numbering(\"(1.1)\", count, it)\n    } else {\n      numbering(\"(1)\",it)\n    }\n  }\n)\n```\nWhat can be a good way to implement it also for a minimal theorem that is defined in the template like this:\n```typst\n#show figure.where(kind: \"thm\"): it => [\n  / #it.supplement #context(it.counter.display(it.numbering)).: #it.body\n]\n#let thm(it) = figure(\n  kind: \"thm\",\n  supplement: \"Theorem\",\n  caption: none,\n  placement: none, \n  it\n) \n```\nMore suggestions are welcomed :slight_smile:",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 39,
      "score": 87.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 875
    },
    {
      "id": 6243,
      "post_number": 6,
      "username": "Sinthoras",
      "name": "",
      "created_at": "2024-12-02T14:14:03.660Z",
      "updated_at": "2024-12-02T14:14:03.660Z",
      "cooked": "<p>I tried to use both packages but failed to get a correct numbering given the fact, that I start my section numbering at 0, because they assume, that it starts at 1 and therefore give me one too high section counter.</p>",
      "raw": "I tried to use both packages but failed to get a correct numbering given the fact, that I start my section numbering at 0, because they assume, that it starts at 1 and therefore give me one too high section counter.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 35,
      "score": 22.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 511
    },
    {
      "id": 6244,
      "post_number": 7,
      "username": "Sinthoras",
      "name": "",
      "created_at": "2024-12-02T14:17:36.638Z",
      "updated_at": "2024-12-02T16:07:24.364Z",
      "cooked": "<p>Thank you! I changed it a bit to work for my usecase where I start my section numbering at 0 and it works!</p>\n<p>The full code I use is:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#show heading.where(level:1): it =&gt; {\n  counter(math.equation).update(0)\n  it\n}\n\n\n #set math.equation(numbering: it =&gt; {\n    let count = counter(heading.where(level: 1)).at(here()).first()\n    if count &gt; 0 and start_section_numbering_at_0 {\n      numbering(\"(1.1)\", count - 1, it)\n    }\n    else {\n      numbering(\"(1.1)\", count, it)\n    }\n})\n</code></pre>",
      "raw": "Thank you! I changed it a bit to work for my usecase where I start my section numbering at 0 and it works! \n\nThe full code I use is:\n\n```typst\n#show heading.where(level:1): it => {\n  counter(math.equation).update(0)\n  it\n}\n\n\n #set math.equation(numbering: it => {\n    let count = counter(heading.where(level: 1)).at(here()).first()\n    if count > 0 and start_section_numbering_at_0 {\n      numbering(\"(1.1)\", count - 1, it)\n    }\n    else {\n      numbering(\"(1.1)\", count, it)\n    }\n})\n```",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 36,
      "score": 72.2,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 511
    }
  ],
  "scraped_at": "2025-06-10T09:54:15.273182"
}
{
  "topic_metadata": {
    "id": 1937,
    "title": "How can I create a vertical line in a math block with alignment points?",
    "slug": "how-can-i-create-a-vertical-line-in-a-math-block-with-alignment-points",
    "posts_count": 4,
    "created_at": "2024-12-01T21:24:33.673Z",
    "last_posted_at": "2024-12-02T12:25:47.539Z",
    "views": 266,
    "like_count": 1,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "ssotoen",
    "tags": [
      "layout",
      "math"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 140
  },
  "posts": [
    {
      "id": 6215,
      "post_number": 1,
      "username": "TheJanzap",
      "name": "",
      "created_at": "2024-12-01T21:24:33.823Z",
      "updated_at": "2024-12-01T21:27:30.317Z",
      "cooked": "<p>I have the following formula and want to insert a vertical line over the whole length of the formula. How can I do that?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$&amp; Rho(T sect G) &amp;= Rho(T|G) dot Rho(G) \\\n    + &amp;Rho(T sect B) &amp;= Rho(T|B) dot Rho(B) \\\n    + &amp;Rho(T sect R) &amp;= Rho(T|R) dot Rho(R) \\\n    &amp;\"Line here\"\\\n    &amp; Rho(T)$\n</code></pre>\n<p>I want it to look like this<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/8/80f7c7900f42d41fe51cf73c92a3a8aeced695f7.png\" alt=\"image\" data-base62-sha1=\"ioTYQE5EyMvjMAzjxz9YUu78HR5\" width=\"652\" height=\"203\"></p>",
      "raw": "I have the following formula and want to insert a vertical line over the whole length of the formula. How can I do that?\n\n```typ\n$& Rho(T sect G) &= Rho(T|G) dot Rho(G) \\\n    + &Rho(T sect B) &= Rho(T|B) dot Rho(B) \\\n    + &Rho(T sect R) &= Rho(T|R) dot Rho(R) \\\n    &\"Line here\"\\\n    & Rho(T)$\n```\nI want it to look like this\n![image|652x203](upload://ioTYQE5EyMvjMAzjxz9YUu78HR5.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 1221.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 132
    },
    {
      "id": 6219,
      "post_number": 2,
      "username": "ssotoen",
      "name": "",
      "created_at": "2024-12-01T22:06:51.247Z",
      "updated_at": "2024-12-01T22:06:51.247Z",
      "cooked": "<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$&amp; Rho(T sect G) &amp;= Rho(T|G) dot Rho(G) \\\n    + &amp;Rho(T sect B) &amp;= Rho(T|B) dot Rho(B) \\\n    + &amp;Rho(T sect R) &amp;= Rho(T|R) dot Rho(R) \\\n    #place(line(length: 5cm, stroke: 0.05em), dy: -3.4mm)\n    &amp; Rho(T)$\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/4/47009caed7187266b37862f37df90172fd8a213c.png\" alt=\"asdf\" data-base62-sha1=\"a87d7LttzSxa68zmKKvNmYdTAxm\" width=\"332\" height=\"241\"></p>",
      "raw": "```typ\n$& Rho(T sect G) &= Rho(T|G) dot Rho(G) \\\n    + &Rho(T sect B) &= Rho(T|B) dot Rho(B) \\\n    + &Rho(T sect R) &= Rho(T|R) dot Rho(R) \\\n    #place(line(length: 5cm, stroke: 0.05em), dy: -3.4mm)\n    & Rho(T)$\n```\n\n![asdf|665x483, 50%](upload://a87d7LttzSxa68zmKKvNmYdTAxm.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 31,
      "score": 26.2,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 331
    },
    {
      "id": 6237,
      "post_number": 3,
      "username": "TheJanzap",
      "name": "",
      "created_at": "2024-12-02T11:35:56.920Z",
      "updated_at": "2024-12-02T11:35:56.920Z",
      "cooked": "<p>Very nice, thanks! But I guess there’s no way to dynamically adjust the size?</p>",
      "raw": "Very nice, thanks! But I guess there's no way to dynamically adjust the size?",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 5.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 132
    },
    {
      "id": 6240,
      "post_number": 4,
      "username": "ssotoen",
      "name": "",
      "created_at": "2024-12-02T12:25:47.539Z",
      "updated_at": "2024-12-02T12:25:47.539Z",
      "cooked": "<p>None that I know of.</p>",
      "raw": "None that I know of.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 5.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 331
    }
  ],
  "scraped_at": "2025-06-10T09:54:14.480990"
}
{
  "topic_metadata": {
    "id": 1941,
    "title": "How to use arguments with hyphens in math mode",
    "slug": "how-to-use-arguments-with-hyphens-in-math-mode",
    "posts_count": 5,
    "created_at": "2024-12-01T23:53:26.000Z",
    "last_posted_at": "2024-12-07T20:38:59.211Z",
    "views": 162,
    "like_count": 5,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "sCarton",
    "tags": [
      "math"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 234
  },
  "posts": [
    {
      "id": 6220,
      "post_number": 1,
      "username": "miles-1",
      "name": "miles",
      "created_at": "2024-12-01T23:53:26.117Z",
      "updated_at": "2024-12-01T23:53:26.117Z",
      "cooked": "<p>How can you use arguments with hyphens in math mode? E.g.,</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">$mat(1, 2, 3; 4, 5, 6; delim:\"[\")$ // works\n$mat(1, 2, 3; 4, 5, 6; column-gap: #2pt)$ // does not work\n</code></pre>\n<p>The issue here is of course the hyphen being interpreted as a minus sign. I realize that you can set arguments like <code>column-gap</code> beforehand, but this is somewhat tedious if you want to change the value of this parameter for just a single use of <code>mat</code> amongst many.</p>\n<p>For variables with hyphens or underscores, you can use <code>#</code> in math mode:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let this-variable = 5\n$ (#this-variable - a) / b $\n</code></pre>\n<p>…but this approach does not work for arguments:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">$mat(1, 2, 3; 4, 5, 6; #column-gap: #2pt)$ // does not work\n</code></pre>",
      "raw": "How can you use arguments with hyphens in math mode? E.g.,\n\n```typst\n$mat(1, 2, 3; 4, 5, 6; delim:\"[\")$ // works\n$mat(1, 2, 3; 4, 5, 6; column-gap: #2pt)$ // does not work\n```\n\nThe issue here is of course the hyphen being interpreted as a minus sign. I realize that you can set arguments like `column-gap` beforehand, but this is somewhat tedious if you want to change the value of this parameter for just a single use of `mat` amongst many.\n\nFor variables with hyphens or underscores, you can use `#` in math mode:\n\n```typst\n#let this-variable = 5\n$ (#this-variable - a) / b $\n```\n\n...but this approach does not work for arguments:\n\n```typst\n$mat(1, 2, 3; 4, 5, 6; #column-gap: #2pt)$ // does not work\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 42,
      "score": 383.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 177
    },
    {
      "id": 6323,
      "post_number": 2,
      "username": "sCarton",
      "name": "",
      "created_at": "2024-12-04T12:54:42.117Z",
      "updated_at": "2024-12-04T12:57:55.948Z",
      "cooked": "<p>I used the hashtag to invoke the function explicitly:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">$#math.mat(column-gap: 2pt, (1, 2, 3), (4, 5, 6))$\n</code></pre>\n<p>This workaround does lose some flexibility afforded to the maths mode.</p>",
      "raw": "I used the hashtag to invoke the function explicitly:\n\n```typst\n$#math.mat(column-gap: 2pt, (1, 2, 3), (4, 5, 6))$\n```\n\nThis workaround does lose some flexibility afforded to the maths mode.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 38,
      "score": 42.6,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 162
    },
    {
      "id": 6407,
      "post_number": 3,
      "username": "miles-1",
      "name": "miles",
      "created_at": "2024-12-07T17:17:33.875Z",
      "updated_at": "2024-12-07T17:17:33.875Z",
      "cooked": "<p>Your answer seems to be the closest thing to a solution, so I will mark it as such, though I’m bummed there’s no way to use it directly without needing to use <code>#</code>.</p>",
      "raw": "Your answer seems to be the closest thing to a solution, so I will mark it as such, though I'm bummed there's no way to use it directly without needing to use `#`.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 10.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 177
    },
    {
      "id": 6408,
      "post_number": 4,
      "username": "sCarton",
      "name": "",
      "created_at": "2024-12-07T17:42:29.295Z",
      "updated_at": "2024-12-07T17:42:29.295Z",
      "cooked": "<p>Indeed. Given the following is an example from the official documentation, what you’ve seen seems like a bug.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">$ vec(1, 2, delim: \"[\") $\n</code></pre>",
      "raw": "Indeed. Given the following is an example from the official documentation, what you've seen seems like a bug.\n```typst\n$ vec(1, 2, delim: \"[\") $\n```",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 30.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 162
    },
    {
      "id": 6413,
      "post_number": 5,
      "username": "ian",
      "name": "Ian",
      "created_at": "2024-12-07T20:38:59.211Z",
      "updated_at": "2024-12-07T20:38:59.211Z",
      "cooked": "<p>This is actually in a PR right now by mkorje!</p><aside class=\"onebox githubpullrequest\" data-onebox-src=\"https://github.com/typst/typst/pull/5008\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/typst/typst/pull/5008\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com/typst/typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"github-row\" data-github-private-repo=\"false\">\n\n\n\n    <div class=\"github-icon-container\" title=\"Pull Request\">\n      <svg width=\"60\" height=\"60\" class=\"github-icon\" viewBox=\"0 0 12 16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z\"></path></svg>\n    </div>\n\n  <div class=\"github-info-container\">\n\n\n\n      <h4>\n        <a href=\"https://github.com/typst/typst/pull/5008\" target=\"_blank\" rel=\"noopener nofollow ugc\">Better math argument parsing</a>\n      </h4>\n\n    <div class=\"branches\">\n      <code>typst:main</code> ← <code>mkorje:better-math-argument-parsing</code>\n    </div>\n\n      <div class=\"github-info\">\n        <div class=\"date\">\n          opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2024-09-23\" data-time=\"17:07:04\" data-timezone=\"UTC\">05:07PM - 23 Sep 24 UTC</span>\n        </div>\n\n        <div class=\"user\">\n          <a href=\"https://github.com/mkorje\" target=\"_blank\" rel=\"noopener nofollow ugc\">\n            <img alt=\"mkorje\" src=\"https://forum.typst.app/uploads/default/original/2X/5/531d9562e797b3b36df2251fd1f7ab939746dee4.jpeg\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\" data-dominant-color=\"857B6F\">\n            mkorje\n          </a>\n        </div>\n\n        <div class=\"lines\" title=\"1 commits changed 12 files with 380 additions and 121 deletions\">\n          <a href=\"https://github.com/typst/typst/pull/5008/files\" target=\"_blank\" rel=\"noopener nofollow ugc\">\n            <span class=\"added\">+380</span>\n            <span class=\"removed\">-121</span>\n          </a>\n        </div>\n      </div>\n  </div>\n</div>\n\n  <div class=\"github-row\">\n    <p class=\"github-body-container\">This PR brings how math function call arguments are parsed more in line with how<span class=\"show-more-container\"><a href=\"https://github.com/typst/typst/pull/5008\" target=\"_blank\" rel=\"noopener nofollow ugc\" class=\"show-more\">…</a></span><span class=\"excerpt hidden\"> they are parsed in code mode.\n\nNew things:\n- Closes #2052: Named arguments in math function calls can now be any identifier. This means it can contain hyphens and start with an underscore (as long as it isn't just an underscore), just like in code mode. For example, the below now works.\n  ```typ\n  #let func(my-body: none) = my-body\n\n  $ func(my-body: a) $\n  ```\n- Closes #938: Argument spreading now works in math function calls. Prefixing two dots `..` to a variable does the same as in code mode. You can escape the dots or add a space after them to get `..` verbatim. See the example below.\n  &lt;table&gt;\n  &lt;tr&gt;\n  &lt;td&gt; Code &lt;/td&gt; &lt;td&gt; Image &lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;tr&gt;\n  &lt;td&gt;\n\n  ```typ\n  #set page(width: 5cm, height: auto)\n\n  $\n    // Spreading the argument, so works.\n    mat(..#range(1, 5).chunks(2))\n    // Passed verbatim, so reprs the list.\n    mat(#(..range(2).map(_ =&gt; range(2))))\n  $\n\n  #let nums = ((1,) * 5).intersperse(0).chunks(3)\n  $ mat(..nums, delim: \"[\") $\n  ```\n\n  &lt;/td&gt;\n  &lt;td&gt;\n\n  \n  ![math](https://github.com/user-attachments/assets/07362233-da6a-4aa8-a971-b21e892161b6)\n\n  &lt;/td&gt;\n  &lt;/tr&gt;\n  &lt;/table&gt;\n- Duplicate named arguments error: The below now gives an error, instead of silently overriding the previous instance of the named argument given.\n  ```typ\n  #let func(my: none) = my\n  // Error: 15-17 duplicate argument: my\n  $ func(my: a, my: b) $\n  ```\n\nThese changes don't conflict with #4364 majorly. Some things, like the new lex modes, might end up a bit cleaner with the changes from #4364 I think. Also, these changes are somewhat isolated; only a little (ish) has spread outside of math argument parsing to the rest of the math parsing code. Nothing else has changed with regards to math parsing (at least I hope so, all of the tests have passed which is promising). Only one test was updated to test `column-gap` and `row-gap` being used directly in matrices.</span></p>\n  </div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "This is actually in a PR right now by mkorje! \nhttps://github.com/typst/typst/pull/5008",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 26,
      "score": 25.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 25
    }
  ],
  "scraped_at": "2025-06-10T09:54:13.770904"
}
{
  "topic_metadata": {
    "id": 1945,
    "title": "Why does this code result in a 1600x1600 image?",
    "slug": "why-does-this-code-result-in-a-1600x1600-image",
    "posts_count": 2,
    "created_at": "2024-12-02T08:58:25.744Z",
    "last_posted_at": "2024-12-02T11:17:03.847Z",
    "views": 80,
    "like_count": 3,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "ssotoen",
    "tags": [],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 169
  },
  "posts": [
    {
      "id": 6230,
      "post_number": 1,
      "username": "SebastianJL",
      "name": "Johannes Lade",
      "created_at": "2024-12-02T08:58:25.895Z",
      "updated_at": "2024-12-02T09:21:19.798Z",
      "cooked": "<p>Does someone have an idea why the following code results in a 1600x1600 image?</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\"> #set page(width: auto, height:auto, margin: 0pt)\n \n #grid(\n   columns: (400pt, 400pt),\n   image(\"BE-1.1-Antwort-Wetter.jpg\"),\n   image(\"BE-1.2-Antwort-Finanzmärkte.jpg\"),\n   image(\"BE-1.3-Antwort-Asteroid.jpg\"),\n   image(\"BE-1.4-Antwort-Pendel.jpg\"),\n )\n</code></pre>\n<p>I would have thought, that it would result in an 800x800 image, since all the images are square and have a larger resolution than 400x400.</p>\n<p>EDIT<br>\nI just realized that <code>pt</code> are not pixels but points. I don’t really understand how they relate but in my specific example they seem to relate in a 2:1 px:pt ratio.</p>",
      "raw": "Does someone have an idea why the following code results in a 1600x1600 image?\n\n```typst\n #set page(width: auto, height:auto, margin: 0pt)\n \n #grid(\n   columns: (400pt, 400pt),\n   image(\"BE-1.1-Antwort-Wetter.jpg\"),\n   image(\"BE-1.2-Antwort-Finanzmärkte.jpg\"),\n   image(\"BE-1.3-Antwort-Asteroid.jpg\"),\n   image(\"BE-1.4-Antwort-Pendel.jpg\"),\n )\n```\nI would have thought, that it would result in an 800x800 image, since all the images are square and have a larger resolution than 400x400.\n\nEDIT\nI just realized that `pt` are not pixels but points. I don't really understand how they relate but in my specific example they seem to relate in a 2:1 px:pt ratio.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 156.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 591
    },
    {
      "id": 6235,
      "post_number": 2,
      "username": "ssotoen",
      "name": "",
      "created_at": "2024-12-02T11:17:03.847Z",
      "updated_at": "2024-12-02T11:17:03.847Z",
      "cooked": "<p>A point is a unit of length measuring 1⁄72 of an inch. When exporting to PNG, Typst uses a default pixel density of 144 pixels per inch. Since there are 72 pt in an inch and 144 is twice that, the resulting image’s dimensions will be twice as many pixels as points.</p>",
      "raw": "A point is a unit of length measuring 1⁄72 of an inch. When exporting to PNG, Typst uses a default pixel density of 144 pixels per inch. Since there are 72 pt in an inch and 144 is twice that, the resulting image’s dimensions will be twice as many pixels as points.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 28,
      "score": 60.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 331
    }
  ],
  "scraped_at": "2025-06-10T09:54:13.042723"
}
{
  "topic_metadata": {
    "id": 1947,
    "title": "How can I edit the appearance of a citation?",
    "slug": "how-can-i-edit-the-appearance-of-a-citation",
    "posts_count": 2,
    "created_at": "2024-12-02T09:57:41.775Z",
    "last_posted_at": "2024-12-02T14:06:27.660Z",
    "views": 171,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "miles-1",
    "tags": [
      "styling"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 132
  },
  "posts": [
    {
      "id": 6233,
      "post_number": 1,
      "username": "Mr_study",
      "name": "Mr study",
      "created_at": "2024-12-02T09:57:41.999Z",
      "updated_at": "2024-12-02T21:16:17.109Z",
      "cooked": "<p>Hi there,</p>\n<p>How can I colour my citation to have separate colours for the year separately from the author?<br>\n.<br>\n.<br>\nExample image of desired effect:<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/d/d3f116f0d3d6950045c093bd5ae6e3f37ac8b94b.png\" alt=\"image\" data-base62-sha1=\"ueVhg4YjP24LIAdnMMtIhVmVRbl\" width=\"674\" height=\"97\"></p>\n<p>.</p>\n<p>.</p>\n<p><strong>Currently</strong> I colour the citation by adding the following code at the beginning of my document: <span class=\"hashtag-raw\">#show</span> cite: set text(blue)<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/0/08e25d864e33b97acf00343706b58d6a87e2f5bd.png\" alt=\"image\" data-base62-sha1=\"1gANVn3QdyVZgORdeOJxxKkRELz\" width=\"320\" height=\"95\"></p>\n<p>Thanks for your help.</p>",
      "raw": "Hi there,\n\nHow can I colour my citation to have separate colours for the year separately from the author?\n.\n.\nExample image of desired effect:\n![image|674x97](upload://ueVhg4YjP24LIAdnMMtIhVmVRbl.png)\n\n\n\n.\n\n.\n\n**Currently** I colour the citation by adding the following code at the beginning of my document: #show cite: set text(blue) \n![image|320x95](upload://1gANVn3QdyVZgORdeOJxxKkRELz.png)\n\n\nThanks for your help.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 691.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 789
    },
    {
      "id": 6242,
      "post_number": 2,
      "username": "miles-1",
      "name": "miles",
      "created_at": "2024-12-02T14:06:27.660Z",
      "updated_at": "2024-12-02T14:06:27.660Z",
      "cooked": "<p>You’re on the right track. Using a <code>show</code> rule is the way to go here.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#show cite: it =&gt; {\n    show regex(\"\\d{4}\"): set text(blue)\n    it\n}\n</code></pre>\n<p>In case you’re unfamiliar, you can read about <code>regex</code>, or “regular expressions”, <a href=\"https://typst.app/docs/reference/foundations/regex/\">here</a>. <code>regex(\"\\d{4}\")</code> means “match four-digit numbers”.</p>\n<p>Note that there will still be a hyperlink for the whole citation, not just the year.</p>",
      "raw": "You're on the right track. Using a `show` rule is the way to go here.\n\n```typst\n#show cite: it => {\n    show regex(\"\\d{4}\"): set text(blue)\n    it\n}\n```\nIn case you're unfamiliar, you can read about `regex`, or \"regular expressions\", [here](https://typst.app/docs/reference/foundations/regex/). `regex(\"\\d{4}\")` means \"match four-digit numbers\".\n\nNote that there will still be a hyperlink for the whole citation, not just the year.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 30,
      "score": 76.0,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 177
    }
  ],
  "scraped_at": "2025-06-10T09:54:12.350767"
}
{
  "topic_metadata": {
    "id": 1950,
    "title": "Is there a function similar to `overbrace` without the brace?",
    "slug": "is-there-a-function-similar-to-overbrace-without-the-brace",
    "posts_count": 3,
    "created_at": "2024-12-02T12:25:06.510Z",
    "last_posted_at": "2024-12-02T16:29:18.661Z",
    "views": 154,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "Mathemensch",
    "tags": [
      "layout",
      "math"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 149
  },
  "posts": [
    {
      "id": 6239,
      "post_number": 1,
      "username": "Libadoxon",
      "name": "",
      "created_at": "2024-12-02T12:25:06.674Z",
      "updated_at": "2024-12-02T13:19:10.997Z",
      "cooked": "<p>I want to achieve the same as</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">$\n  overbrace(harpoons.rtlb, -H^+)\n$\n</code></pre>\n<p>but without the brace, so just the text over a section of a equation</p>",
      "raw": "I want to achieve the same as\n```typst\n$\n  overbrace(harpoons.rtlb, -H^+)\n$\n```\nbut without the brace, so just the text over a section of a equation",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 35,
      "score": 337.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 878
    },
    {
      "id": 6241,
      "post_number": 2,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-02T13:19:27.634Z",
      "updated_at": "2024-12-02T13:19:27.634Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/libadoxon\">@Libadoxon</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Libadoxon, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 32,
      "score": 41.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6249,
      "post_number": 3,
      "username": "Mathemensch",
      "name": "Alexander Schulz",
      "created_at": "2024-12-02T16:29:18.661Z",
      "updated_at": "2024-12-02T17:34:14.901Z",
      "cooked": "<p>You could combine the attach function with limits, to display text over or under an equation</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">$\ny=attach(limits(2x^2+7x-3), t:\"term\")\n$\n</code></pre>\n<p>which results in the following<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/5/595f7e3de84a8018ac4c0e0acddb68d824485ad5.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/595f7e3de84a8018ac4c0e0acddb68d824485ad5\" title=\"IMG_4247\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/5/595f7e3de84a8018ac4c0e0acddb68d824485ad5_2_345x115.jpeg\" alt=\"IMG_4247\" data-base62-sha1=\"cKD5s7NQdQDF4Mk0hEtWjjTRLVz\" width=\"345\" height=\"115\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/5/595f7e3de84a8018ac4c0e0acddb68d824485ad5_2_345x115.jpeg, https://forum.typst.app/uploads/default/optimized/2X/5/595f7e3de84a8018ac4c0e0acddb68d824485ad5_2_517x172.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/5/595f7e3de84a8018ac4c0e0acddb68d824485ad5_2_690x230.jpeg 2x\" data-dominant-color=\"F7F7F7\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">IMG_4247</span><span class=\"informations\">927×310 21 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>If you want, you can create a custom function</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let overset(a, b) = {\n math.attach(math.limits(a), t: b)\n}\n\n$\noverset(a(x-b)^2+c, \"quadratic function\")\n$\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/f/f6db5c0d278f4d5a608154a74b52700b1cb72a2b.jpeg\" alt=\"IMG_4248\" data-base62-sha1=\"zdNqScda3gWVFmRHQvvPV96X1Jp\" width=\"333\" height=\"158\"></p>",
      "raw": "You could combine the attach function with limits, to display text over or under an equation\n\n``` typst\n$\ny=attach(limits(2x^2+7x-3), t:\"term\")\n$\n```\n\nwhich results in the following \n![IMG_4247|690x230, 50%](upload://cKD5s7NQdQDF4Mk0hEtWjjTRLVz.jpeg)\n\nIf you want, you can create a custom function\n\n``` typst\n#let overset(a, b) = {\n math.attach(math.limits(a), t: b)\n}\n\n$\noverset(a(x-b)^2+c, \"quadratic function\")\n$\n```\n\n![IMG_4248|666x317, 50%](upload://zdNqScda3gWVFmRHQvvPV96X1Jp.jpeg)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 27,
      "score": 145.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 307
    }
  ],
  "scraped_at": "2025-06-10T09:54:11.631278"
}
{
  "topic_metadata": {
    "id": 1953,
    "title": "How to customize page header with current or previous level 1 headline displayed in corner?",
    "slug": "how-to-customize-page-header-with-current-or-previous-level-1-headline-displayed-in-corner",
    "posts_count": 3,
    "created_at": "2024-12-02T16:24:59.095Z",
    "last_posted_at": "2024-12-02T18:47:21.043Z",
    "views": 510,
    "like_count": 0,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "PgBiel",
    "tags": [
      "scripting",
      "layout"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 761
  },
  "posts": [
    {
      "id": 6248,
      "post_number": 1,
      "username": "MrConfuse",
      "name": "MrConfuse",
      "created_at": "2024-12-02T16:24:59.231Z",
      "updated_at": "2024-12-02T18:45:38.768Z",
      "cooked": "<p>Hi, I’m fairly new to Typst and I am currently porting my LaTeX doc over to Typst. The styling of that document has a dynamic headline of the current headline the text belongs to, or the first headline on that page. While trying to achieve just that I have hit a few road blocks which I managed to clear, but this one has some weird behavior with the state-Type I have not been able to figure out.</p>\n<p>The code as it is now:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let ht-first = state(\"page-first-section\", [])\n#ht-first.\n#set page(header: {\n  let first-heading = context query(\n    heading.where(level: 1)).find(h =&gt; h.location().page() == here().page())\n// find last heading of level 1 on current page\n\n  context ht-first.get()\n\n  // Title top left\n  set text(8pt)\n  place(top + left,smallcaps[#{\n    context if query(\n    heading.where(level: 1)).find(h =&gt; h.location().page() == here().page()) == none {\n\n    context ht-first.at(here())\n    \n    }\n    else {\n      ht-first.update([#heading(first-heading).body])\n      ht-first.at(here())\n      \n    }\n  }], dy: 1.2cm)\n  // Numbering top right\n  context place(top + right, text(10pt, numbering(here().page-numbering(), counter(page).at(here()).first())), dy: 1.25cm)\n  // horizontal line underneath\n  line(length: 100%)\n  }\n)\n</code></pre>\n<p>The goal here is to dynamically display the first level 1headline of the page, or the last level 1 headline of the previous page-/s. The current headline (as in, defined on that page) does work and will display correctly. I want to store that headline in this state:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let ht-first = state(\"page-first-section\", [])\n</code></pre>\n<p>For some reason however, the state will be empty by the time the next page without headline comes along. Manually overriding the state on the page using <code>#ht-first.update(\"Some arbitrary text\")</code> does work for that single page, before going back to the non working state.<br>\nIdeally this would also carry over the latest level 1 headline of the previous page, if there is no headline on the current page.</p>\n<p>I also found <a href=\"https://stackoverflow.com/questions/76363935/typst-header-that-changes-from-page-to-page-based-on-state\" rel=\"noopener nofollow ugc\">this</a> StackOverflow post that has done this exact thing in the past, however, this does not seem to work anymore.</p>\n<p>Any ideas and hints would be greatly appreciated!</p>\n<p>Update:<br>\nAfter posting this I, as is usual, thought of the solution, so here is a cleaned up working example of my code:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(header: context\n{\n  // Title top left\n  set text(10pt)\n  place(top + left, {\n    if query(heading.where(level: 1))\n    .find(h =&gt; h.location().page() == here().page()) == none {\n      // Filter headers that come after the current page\n      let smh = query(heading.where(level: 1)).filter(h =&gt; h.location().page() &lt;= here().page())\n      smh.last().body // last element in array is newest level 1 headline\n    } else {\n      let onPageHeading = query(heading.where(level: 1)).filter(h =&gt; h.location().page() == here().page())\n      onPageHeading.first().body\n    }\n  }, dy: 1.25cm)\n\n  // Numbering top right\n  place(top + right, numbering(here().page-numbering(), counter(page).at(here()).first()), dy: 1.25cm)\n  // horizontal line underneath\n  line(length: 100%)\n})\n</code></pre>\n<p>One question remains, however: Is there a simpler/faster/better solution?</p>",
      "raw": "Hi, I'm fairly new to Typst and I am currently porting my LaTeX doc over to Typst. The styling of that document has a dynamic headline of the current headline the text belongs to, or the first headline on that page. While trying to achieve just that I have hit a few road blocks which I managed to clear, but this one has some weird behavior with the state-Type I have not been able to figure out.\n\nThe code as it is now:\n```typ\n#let ht-first = state(\"page-first-section\", [])\n#ht-first.\n#set page(header: {\n  let first-heading = context query(\n    heading.where(level: 1)).find(h => h.location().page() == here().page())\n// find last heading of level 1 on current page\n\n  context ht-first.get()\n\n  // Title top left\n  set text(8pt)\n  place(top + left,smallcaps[#{\n    context if query(\n    heading.where(level: 1)).find(h => h.location().page() == here().page()) == none {\n\n    context ht-first.at(here())\n    \n    }\n    else {\n      ht-first.update([#heading(first-heading).body])\n      ht-first.at(here())\n      \n    }\n  }], dy: 1.2cm)\n  // Numbering top right\n  context place(top + right, text(10pt, numbering(here().page-numbering(), counter(page).at(here()).first())), dy: 1.25cm)\n  // horizontal line underneath\n  line(length: 100%)\n  }\n)\n```\nThe goal here is to dynamically display the first level 1headline of the page, or the last level 1 headline of the previous page-/s. The current headline (as in, defined on that page) does work and will display correctly. I want to store that headline in this state:\n```typ\n#let ht-first = state(\"page-first-section\", [])\n```\nFor some reason however, the state will be empty by the time the next page without headline comes along. Manually overriding the state on the page using ```#ht-first.update(\"Some arbitrary text\")``` does work for that single page, before going back to the non working state.\nIdeally this would also carry over the latest level 1 headline of the previous page, if there is no headline on the current page.\n\nI also found [this](https://stackoverflow.com/questions/76363935/typst-header-that-changes-from-page-to-page-based-on-state) StackOverflow post that has done this exact thing in the past, however, this does not seem to work anymore.\n\nAny ideas and hints would be greatly appreciated!\n\nUpdate:\nAfter posting this I, as is usual, thought of the solution, so here is a cleaned up working example of my code:\n```typ\n#set page(header: context\n{\n  // Title top left\n  set text(10pt)\n  place(top + left, {\n    if query(heading.where(level: 1))\n    .find(h => h.location().page() == here().page()) == none {\n      // Filter headers that come after the current page\n      let smh = query(heading.where(level: 1)).filter(h => h.location().page() <= here().page())\n      smh.last().body // last element in array is newest level 1 headline\n    } else {\n      let onPageHeading = query(heading.where(level: 1)).filter(h => h.location().page() == here().page())\n      onPageHeading.first().body\n    }\n  }, dy: 1.25cm)\n\n  // Numbering top right\n  place(top + right, numbering(here().page-numbering(), counter(page).at(here()).first()), dy: 1.25cm)\n  // horizontal line underneath\n  line(length: 100%)\n})\n```\n\nOne question remains, however: Is there a simpler/faster/better solution?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 44,
      "score": 2368.4,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 879
    },
    {
      "id": 6258,
      "post_number": 2,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-02T18:45:41.499Z",
      "updated_at": "2024-12-02T18:45:41.499Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/mrconfuse\">@MrConfuse</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>In addition, instead of editing your post and prefixing your title with “[Solved]”, please either post your solution as a reply to your post and mark it as a Solution, or wait for someone to answer and do so for their answer if it solves your problem. This allows for easy filtering of solved posts in the forum, and also displays the solution in a dedicated box under your original post. Thank you!</p>",
      "raw": "Hey @MrConfuse, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: [How to post in the Questions category](https://forum.typst.app/t/how-to-post-in-the-questions-category/11)\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:\n\nIn addition, instead of editing your post and prefixing your title with \"[Solved]\", please either post your solution as a reply to your post and mark it as a Solution, or wait for someone to answer and do so for their answer if it solves your problem. This allows for easy filtering of solved posts in the forum, and also displays the solution in a dedicated box under your original post. Thank you!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 40,
      "score": 67.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6259,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-02T18:47:21.043Z",
      "updated_at": "2024-12-02T18:49:42.600Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"MrConfuse\" data-post=\"1\" data-topic=\"1953\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/m/DF681B/48.png\" class=\"avatar\"> MrConfuse:</div>\n<blockquote>\n<p>One question remains, however: Is there a simpler/faster/better solution?</p>\n</blockquote>\n</aside>\n<p>Someone already did this for you! Check out the <code>hydra</code> package:</p><aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/universe/package/hydra/\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/universe/package/hydra/\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/universe/package/hydra/\" target=\"_blank\" rel=\"noopener\">hydra – Typst Universe</a></h3>\n\n  <p>Query and display headings in your documents and templates.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>Regarding placing the heading on the left and the page number on the right, instead of placing left and right at the same time, I recommend placing both at the same line with a filling space between them:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// Displays \"Left\" to the left and \"Right\" to the right\nLeft #h(1fr) Right\n</code></pre>\n<p>For more complex setups (with, say, three sections in the header instead of just two), use a multi-column grid (<a href=\"https://typst.app/docs/reference/layout/grid/\" class=\"inline-onebox\">Grid Function – Typst Documentation</a>).</p>",
      "raw": "[quote=\"MrConfuse, post:1, topic:1953\"]\nOne question remains, however: Is there a simpler/faster/better solution?\n[/quote]\n\nSomeone already did this for you! Check out the `hydra` package:\nhttps://typst.app/universe/package/hydra/\n\nRegarding placing the heading on the left and the page number on the right, instead of placing left and right at the same time, I recommend placing both at the same line with a filling space between them:\n\n```typ\n// Displays \"Left\" to the left and \"Right\" to the right\nLeft #h(1fr) Right\n```\n\nFor more complex setups (with, say, three sections in the header instead of just two), use a multi-column grid (https://typst.app/docs/reference/layout/grid/).",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 40,
      "score": 87.6,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:54:10.830795"
}
{
  "topic_metadata": {
    "id": 1957,
    "title": "How to Automatically change Quote type based on Quote length?",
    "slug": "how-to-automatically-change-quote-type-based-on-quote-length",
    "posts_count": 7,
    "created_at": "2024-12-02T17:58:48.898Z",
    "last_posted_at": "2024-12-02T21:12:29.725Z",
    "views": 88,
    "like_count": 1,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "PgBiel",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 452
  },
  "posts": [
    {
      "id": 6254,
      "post_number": 1,
      "username": "Waldo",
      "name": "Waldo",
      "created_at": "2024-12-02T17:58:49.033Z",
      "updated_at": "2024-12-02T18:40:16.416Z",
      "cooked": "<p>In LaTeX, you can change the quote type (inline/block) based on the quote length (e.g. as defined by APA):</p>\n<p>\\usepackage[thresholdtype=words]{csquotes}<br>\n\\SetBlockThreshold{40}</p>\n<p>Is there a way to do that in Typst?</p>",
      "raw": "In LaTeX, you can change the quote type (inline/block) based on the quote length (e.g. as defined by APA):\n\n\\usepackage[thresholdtype=words]{csquotes}\n\\SetBlockThreshold{40}\n\nIs there a way to do that in Typst?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 101.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 880
    },
    {
      "id": 6256,
      "post_number": 2,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-02T18:39:49.555Z",
      "updated_at": "2024-12-02T18:39:49.555Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/waldo\">@Waldo</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">How to post in the Questions category</a></p>\n<p>Make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>(By the way, the title was also a bit unclear to me so you may want to change it further.)</p>",
      "raw": "Hey @Waldo, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: [How to post in the Questions category](https://forum.typst.app/t/how-to-post-in-the-questions-category/11)\n\nMake sure your title is a question you’d ask to a friend about Typst. :wink:\n\n(By the way, the title was also a bit unclear to me so you may want to change it further.)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 11.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6257,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-02T18:42:44.202Z",
      "updated_at": "2024-12-02T18:42:44.202Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Waldo\" data-post=\"1\" data-topic=\"1957\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/w/C2387F/48.png\" class=\"avatar\"> Waldo:</div>\n<blockquote>\n<p>In LaTeX, you can change the quote type (inline/block) based on the quote length (e.g. as defined by APA):</p>\n<p>\\usepackage[thresholdtype=words]{csquotes}<br>\n\\SetBlockThreshold{40}</p>\n</blockquote>\n</aside>\n<p>Can you elaborate on this / give an example? You can always use <code>#quote(block: true / false)[... stuff ...]</code> as needed, if you’re referring to block quotes.</p>",
      "raw": "[quote=\"Waldo, post:1, topic:1957\"]\nIn LaTeX, you can change the quote type (inline/block) based on the quote length (e.g. as defined by APA):\n\n\\usepackage[thresholdtype=words]{csquotes}\n\\SetBlockThreshold{40}\n[/quote]\n\nCan you elaborate on this / give an example? You can always use `#quote(block: true / false)[... stuff ...]` as needed, if you're referring to block quotes.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 34,
      "score": 11.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6260,
      "post_number": 4,
      "username": "Waldo",
      "name": "Waldo",
      "created_at": "2024-12-02T18:56:55.465Z",
      "updated_at": "2024-12-02T18:56:55.465Z",
      "cooked": "<p>APA demands that if a Quote is longer than 40 Words, it’s displayed as a block. If it’s shorter than 40 Words, it should be inline.</p>\n<p>e.g.<br>\nHe said “my cat is cute” [source].<br>\nvs.<br>\nHe said<br>\n— Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. [source]</p>\n<p>I don’t want to manually count the words but automatically do inline/block based on wordcount.</p>",
      "raw": "APA demands that if a Quote is longer than 40 Words, it's displayed as a block. If it's shorter than 40 Words, it should be inline.\n\ne.g.\nHe said \"my cat is cute\" [source].\nvs.\nHe said\n--- Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. [source]\n\nI don't want to manually count the words but automatically do inline/block based on wordcount.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 11.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 880
    },
    {
      "id": 6261,
      "post_number": 5,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-02T19:09:44.303Z",
      "updated_at": "2024-12-02T21:11:54.480Z",
      "cooked": "<p>You can try this solution through the <code>wordometer</code> package. It probably won’t be perfect, but should work for most common cases:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/wordometer:0.1.4\": word-count, total-words\n\n#let dyn-quote(body, block-threshold: 40, attribution: none, ..args) = word-count(total =&gt; {\n  quote(body, block: total.words &gt; block-threshold, attribution: attribution, ..args)\n\n  // optional: remove this to remove inline attribution\n  if attribution != none and total.words &lt;= block-threshold {\n    if type(attribution) == label {\n      [#[ #ref(attribution)] &lt;inline-attrib&gt;]\n    } else {\n      [#[ (#attribution)] &lt;inline-attrib&gt;]\n    }\n  }\n}, exclude: &lt;inline-attrib&gt;)\n\n// Usage\n// Could also be 'apa-quote' with a threshold of 40\n#let small-quote = dyn-quote.with(block-threshold: 3)\n\nThey said #small-quote(attribution: [John Johnson])[Hello world!]\n\nThey also said #small-quote(attribution: [John Johnson], lorem(10))\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/5/5ced93a096673b4ab6c96632102c887470e815d2.png\" data-download-href=\"https://forum.typst.app/uploads/default/5ced93a096673b4ab6c96632102c887470e815d2\" title=\"output: long quotes in blocks\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/5/5ced93a096673b4ab6c96632102c887470e815d2_2_690x259.png\" alt=\"output: long quotes in blocks\" data-base62-sha1=\"dg4VQfubFaRte95jSs6xdbP1pke\" width=\"690\" height=\"259\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/5/5ced93a096673b4ab6c96632102c887470e815d2_2_690x259.png, https://forum.typst.app/uploads/default/optimized/2X/5/5ced93a096673b4ab6c96632102c887470e815d2_2_1035x388.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/5/5ced93a096673b4ab6c96632102c887470e815d2_2_1380x518.png 2x\" data-dominant-color=\"F7F7F7\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">output: long quotes in blocks</span><span class=\"informations\">1500×564 76.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "You can try this solution through the `wordometer` package. It probably won't be perfect, but should work for most common cases:\n\n```typ\n#import \"@preview/wordometer:0.1.4\": word-count, total-words\n\n#let dyn-quote(body, block-threshold: 40, attribution: none, ..args) = word-count(total => {\n  quote(body, block: total.words > block-threshold, attribution: attribution, ..args)\n\n  // optional: remove this to remove inline attribution\n  if attribution != none and total.words <= block-threshold {\n    if type(attribution) == label {\n      [#[ #ref(attribution)] <inline-attrib>]\n    } else {\n      [#[ (#attribution)] <inline-attrib>]\n    }\n  }\n}, exclude: <inline-attrib>)\n\n// Usage\n// Could also be 'apa-quote' with a threshold of 40\n#let small-quote = dyn-quote.with(block-threshold: 3)\n\nThey said #small-quote(attribution: [John Johnson])[Hello world!]\n\nThey also said #small-quote(attribution: [John Johnson], lorem(10))\n```\n![output: long quotes in blocks|690x259](upload://dg4VQfubFaRte95jSs6xdbP1pke.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 56.0,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6263,
      "post_number": 6,
      "username": "Jollywatt",
      "name": "Joseph Wilson",
      "created_at": "2024-12-02T21:06:57.559Z",
      "updated_at": "2024-12-02T21:06:57.559Z",
      "cooked": "<p>Nice solution. In fact, the document show rule</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show: word-count\n</code></pre>\n<p>is unnecessary. It’s only needed to enable global word counts with the <code>total-words</code> state variable.</p>",
      "raw": "Nice solution. In fact, the document show rule \n```typ\n#show: word-count\n```\nis unnecessary. It's only needed to enable global word counts with the `total-words` state variable.",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 11.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 713
    },
    {
      "id": 6265,
      "post_number": 7,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-02T21:12:29.725Z",
      "updated_at": "2024-12-02T21:12:29.725Z",
      "cooked": "<p>Ah, thank you! I’ve removed it from my answer.</p>",
      "raw": "Ah, thank you! I've removed it from my answer.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 6.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:54:10.121115"
}
{
  "topic_metadata": {
    "id": 196,
    "title": "Why can't I use a function in a chapter even though I imported it at the start of my main file?",
    "slug": "why-cant-i-use-a-function-in-a-chapter-even-though-i-imported-it-at-the-start-of-my-main-file",
    "posts_count": 7,
    "created_at": "2024-09-15T14:57:02.706Z",
    "last_posted_at": "2024-09-19T03:56:17.476Z",
    "views": 799,
    "like_count": 8,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 1052
  },
  "posts": [
    {
      "id": 907,
      "post_number": 1,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-09-15T14:57:02.840Z",
      "updated_at": "2024-09-15T14:57:25.217Z",
      "cooked": "<p>My main Typst file looks like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"funcs.typ\": my-func\n\n#include \"chapter.typ\"\n</code></pre>\n<p>However, when I call <code>my-func()</code> inside the chapter file, I get the error “unknown variable: my-func”. Calling it in the main file, however, works. How can I fix that?</p>",
      "raw": "My main Typst file looks like this:\n\n```typ\n#import \"funcs.typ\": my-func\n\n#include \"chapter.typ\"\n```\n\nHowever, when I call `my-func()` inside the chapter file, I get the error \"unknown variable: my-func\". Calling it in the main file, however, works. How can I fix that?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 88,
      "score": 2487.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 908,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-09-15T14:57:39.343Z",
      "updated_at": "2024-09-15T15:02:29.239Z",
      "cooked": "<p>You need to define (in this case, import) <code>my-func()</code> in the file you want to use it, i.e. <code>chapter.typ</code>. Imports don’t “carry over” from the files including them.</p>\n<p>If you have many imports that you don’t want to repeat in many files, you can bundle them in a single file, like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// prelude.typ\n#import \"@preview/package:0.1.0\"\n#import \"funcs.typ\": my-func\n</code></pre>\n<p>&nbsp;</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// main.typ\n#import \"prelude.typ\": *\n\n#package.some-function()\n\n#include \"chapter.typ\"\n</code></pre>\n<p>&nbsp;</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// chapter.typ\n#import \"prelude.typ\": *\n\n#my-func()\n</code></pre>\n<p>The name <em>prelude</em> is just a suggestion; it comes from programming languages that use that name for their set of “default” imports that are automatically available.</p>\n<hr>\n<p><strong>Explanation:</strong> If you’re used to <code>#include</code> from C, it may come as a surprise that Typst’s import and include features work fairly differently. With C-style includes, the code from <code>chapter.typ</code> would be effectively “copy/pasted” into your main file and, because <code>my-func()</code> is available in the main file, it would also work in the included chapter.</p>\n<p>Typst’s name resolution instead uses so-called <em>lexical scoping</em>: variables (including functions) are only available if they’re defined in the <em>surrounding code</em>. Take this example:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let greeting = \"Hello\"\n\n#let greet() = {\n  greeting + \" World\"\n}\n\n#greet()\n</code></pre>\n<p>Here, the variable <code>greeting</code> can be used in <code>greet()</code> because the functions’s body is surrounded by the rest of the file, where the variable is defined. Calling <code>greet()</code> works because the code at the same “level” and before the code also counts.</p>\n<p>The file itself is not “surrounded” by anything*, so a function such as <code>my-func()</code> would not be available; you can’t do anything from outside to change that.</p>\n<p>*The exception is that built-in modules and names such as <code>math</code> or <code>heading</code> are always available; they can be thought of as being “defined in surrounding code” and form the <em>proper</em> prelude that Typst code has access to.</p>",
      "raw": "You need to define (in this case, import) `my-func()` in the file you want to use it, i.e. `chapter.typ`. Imports don't \"carry over\" from the files including them.\n\nIf you have many imports that you don't want to repeat in many files, you can bundle them in a single file, like this:\n\n```typ\n// prelude.typ\n#import \"@preview/package:0.1.0\"\n#import \"funcs.typ\": my-func\n```\n&nbsp;\n```typ\n// main.typ\n#import \"prelude.typ\": *\n\n#package.some-function()\n\n#include \"chapter.typ\"\n```\n&nbsp;\n```typ\n// chapter.typ\n#import \"prelude.typ\": *\n\n#my-func()\n```\n\nThe name _prelude_ is just a suggestion; it comes from programming languages that use that name for their set of \"default\" imports that are automatically available.\n\n---\n\n**Explanation:** If you're used to `#include` from C, it may come as a surprise that Typst's import and include features work fairly differently. With C-style includes, the code from `chapter.typ` would be effectively \"copy/pasted\" into your main file and, because `my-func()` is available in the main file, it would also work in the included chapter.\n\nTypst's name resolution instead uses so-called _lexical scoping_: variables (including functions) are only available if they're defined in the _surrounding code_. Take this example:\n\n```typ\n#let greeting = \"Hello\"\n\n#let greet() = {\n  greeting + \" World\"\n}\n\n#greet()\n```\n\nHere, the variable `greeting` can be used in `greet()` because the functions's body is surrounded by the rest of the file, where the variable is defined. Calling `greet()` works because the code at the same \"level\" and before the code also counts.\n\nThe file itself is not \"surrounded\" by anything*, so a function such as `my-func()` would not be available; you can't do anything from outside to change that.\n\n\\*The exception is that built-in modules and names such as `math` or `heading` are always available; they can be thought of as being \"defined in surrounding code\" and form the _proper_ prelude that Typst code has access to.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 89,
      "score": 197.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 1171,
      "post_number": 3,
      "username": "Rogier",
      "name": "Rogier",
      "created_at": "2024-09-16T08:49:47.354Z",
      "updated_at": "2024-09-16T08:49:47.354Z",
      "cooked": "<p>I have actually desperately been trying to find an “inline import” method in Typst. It would solve so many of my little issues and make the templates I make easier to use for others.</p>\n<p>For example I use acrostiche for acronym management. it would be great if people could just use acrostiche in their files without having to specifically import it.</p>\n<p>I’m not saying the behaviour of the current <span class=\"hashtag-raw\">#import</span> should be changed. I’m saying another function. “<span class=\"hashtag-raw\">#input</span>” or “<span class=\"hashtag-raw\">#inline-include</span>” or something.</p>",
      "raw": "I have actually desperately been trying to find an \"inline import\" method in Typst. It would solve so many of my little issues and make the templates I make easier to use for others.\n\nFor example I use acrostiche for acronym management. it would be great if people could just use acrostiche in their files without having to specifically import it.\n\nI'm not saying the behaviour of the current #import should be changed. I'm saying another function. \"#input\" or \"#inline-include\" or something.",
      "reply_to_post_number": 2,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 2,
      "reads": 61,
      "score": 57.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 263
    },
    {
      "id": 1259,
      "post_number": 4,
      "username": "EaterOfSnacks",
      "name": "EaterOfSnacks",
      "created_at": "2024-09-16T12:48:33.190Z",
      "updated_at": "2024-09-16T12:48:33.190Z",
      "cooked": "<p>Nice if that could be configured with a settings/manifest file in the same directory, a little like a cargo.toml file.</p>",
      "raw": "Nice if that could be configured with a settings/manifest file in the same directory, a little like a cargo.toml file.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 58,
      "score": 11.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 36
    },
    {
      "id": 1396,
      "post_number": 5,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-09-16T17:24:00.334Z",
      "updated_at": "2024-09-16T17:24:00.334Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Rogier\" data-post=\"3\" data-topic=\"196\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/r/220F66/48.png\" class=\"avatar\"> Rogier:</div>\n<blockquote>\n<p>I have actually desperately been trying to find an “inline import” method in Typst</p>\n</blockquote>\n</aside>\n<p>This is actually possible to do:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let my-import(pkg) = {\n  import pkg as p\n  p\n}\n\n#my-import(\"@preview/example:0.1.0\").add(1, 2)\n</code></pre>\n<p>One problem is that this only works for package imports; for files you’d run into path problems, such as here: <a href=\"https://forum.typst.app/t/why-are-paths-always-relative-to-the-current-file/306\" class=\"inline-onebox\">Why are paths always relative to the current file?</a> The other problem is of course that, unless this was built-in, you’d <em>still</em> need to import or write that function yourself…</p>\n<hr>\n<p>Personally I think the way to allow this is to allow specifying an actual prelude somehow. That “somehow” would probably be the <code>typst.toml</code> file that already contains <a href=\"https://github.com/typst/packages/?tab=readme-ov-file#package-format\" rel=\"noopener nofollow ugc\">metadata for packages</a>, and make it more appropriate for documents in addition to packages (and templates).</p>\n<p>Using a prelude file for this would mean that the regular Typst <code>import</code> and <code>let</code> statements could still be used, they’d very naturally specify the package versions to use at a single location, and not require completely new concepts.</p>\n<hr>\n<p>The downside in general of any such approach is that Typst code becomes less “copy-pasteable”: right now, you can look at the file and find everything that the code you’re copying needs; either directly there or in it imports. (Well there’s already one tiny caveat to that: your file may require a <em>specific</em> version of Typst to compile, which is not written down in every file.)</p>",
      "raw": "[quote=\"Rogier, post:3, topic:196\"]\nI have actually desperately been trying to find an “inline import” method in Typst\n[/quote]\n\nThis is actually possible to do:\n\n```typ\n#let my-import(pkg) = {\n  import pkg as p\n  p\n}\n\n#my-import(\"@preview/example:0.1.0\").add(1, 2)\n```\n\nOne problem is that this only works for package imports; for files you'd run into path problems, such as here: https://forum.typst.app/t/why-are-paths-always-relative-to-the-current-file/306 The other problem is of course that, unless this was built-in, you'd _still_ need to import or write that function yourself...\n\n---\n\nPersonally I think the way to allow this is to allow specifying an actual prelude somehow. That \"somehow\" would probably be the `typst.toml` file that already contains [metadata for packages](https://github.com/typst/packages/?tab=readme-ov-file#package-format), and make it more appropriate for documents in addition to packages (and templates).\n\nUsing a prelude file for this would mean that the regular Typst `import` and `let` statements could still be used, they'd very naturally specify the package versions to use at a single location, and not require completely new concepts.\n\n---\n\nThe downside in general of any such approach is that Typst code becomes less \"copy-pasteable\": right now, you can look at the file and find everything that the code you're copying needs; either directly there or in it imports. (Well there's already one tiny caveat to that: your file may require a _specific_ version of Typst to compile, which is not written down in every file.)",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 1,
      "reads": 57,
      "score": 46.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 1529,
      "post_number": 6,
      "username": "EaterOfSnacks",
      "name": "EaterOfSnacks",
      "created_at": "2024-09-17T09:50:15.361Z",
      "updated_at": "2024-09-17T09:50:15.361Z",
      "cooked": "<p>I think portability is a great default. But IMO it should be just that: a default that can be overridden, subject to a few compiler warnings or what-have-you. If we really insist on plopping a package or template file in some arbitrary directory as a repository for useful functions, on our own heads be it. It would still be possible to write a “scoop it all up and package it” script, a little like the way Indesign can collect and package all assets, properly linked, ready for despatch to printers or publishers…</p>",
      "raw": "I think portability is a great default. But IMO it should be just that: a default that can be overridden, subject to a few compiler warnings or what-have-you. If we really insist on plopping a package or template file in some arbitrary directory as a repository for useful functions, on our own heads be it. It would still be possible to write a \"scoop it all up and package it\" script, a little like the way Indesign can collect and package all assets, properly linked, ready for despatch to printers or publishers...",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 51,
      "score": 25.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 36
    },
    {
      "id": 1843,
      "post_number": 7,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-09-19T03:56:17.476Z",
      "updated_at": "2024-09-19T03:56:17.476Z",
      "cooked": "<blockquote>\n<p>If we really insist on plopping a package or template file in some arbitrary directory as a repository for useful functions, on our own heads be it.</p>\n</blockquote>\n<p>As a brief comment, I wanted to mention that this is already possible.  Consider the project structure below:</p>\n<pre data-code-wrap=\"txt\"><code class=\"lang-txt\">project\n├── some\n│   └── sub\n│       └── folder\n│           └── file.typ\n└── template.typ\n</code></pre>\n<p>You can import your template from anywhere in your project easily through <code>/absolute/paths/from/project/root</code>, by just adding the line at the top of the <code>file.typ</code> example below:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// template.typ\n\n#let func(x) = [Hello #x]\n\n// file.typ\n\n// Note the '/' before template.typ\n// Works at any level of nesting\n#import \"/template.typ\": *\n\n// Can use\n#func[ABC ABC ABC]\n</code></pre>\n<p>I’d consider this equivalent to a per-project preamble (even more flexible than that, actually, since you can pick what to import, import multiple files or a different file, and so on).<br>\nYou can even use symlinks here if you want <code>template.typ</code> to point at some arbitrary file in your system which could change depending on a script you write (for example).</p>\n<p>So the desired functionality is retained, just in a way that is more integrated with the Typst language, and also more readable and portable as was already mentioned.</p>",
      "raw": "> If we really insist on plopping a package or template file in some arbitrary directory as a repository for useful functions, on our own heads be it.\n\nAs a brief comment, I wanted to mention that this is already possible.  Consider the project structure below:\n\n```txt\nproject\n├── some\n│   └── sub\n│       └── folder\n│           └── file.typ\n└── template.typ\n```\n\nYou can import your template from anywhere in your project easily through `/absolute/paths/from/project/root`, by just adding the line at the top of the `file.typ` example below:\n\n```typ\n// template.typ\n\n#let func(x) = [Hello #x]\n\n// file.typ\n\n// Note the '/' before template.typ\n// Works at any level of nesting\n#import \"/template.typ\": *\n\n// Can use\n#func[ABC ABC ABC]\n```\n\nI'd consider this equivalent to a per-project preamble (even more flexible than that, actually, since you can pick what to import, import multiple files or a different file, and so on).\nYou can even use symlinks here if you want `template.typ` to point at some arbitrary file in your system which could change depending on a script you write (for example).\n\nSo the desired functionality is retained, just in a way that is more integrated with the Typst language, and also more readable and portable as was already mentioned.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 46,
      "score": 104.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:58:57.295694"
}
