{
  "topic_metadata": {
    "id": 2193,
    "title": "How can I count journal publications in a .bib file?",
    "slug": "how-can-i-count-journal-publications-in-a-bib-file",
    "posts_count": 2,
    "created_at": "2024-12-24T01:05:19.115Z",
    "last_posted_at": "2024-12-25T15:15:24.408Z",
    "views": 117,
    "like_count": 1,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Y.D.X",
    "tags": [
      "scripting",
      "literature",
      "bibtex"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 182
  },
  "posts": [
    {
      "id": 6890,
      "post_number": 1,
      "username": "Mark_Dean",
      "name": "Mark Dean",
      "created_at": "2024-12-24T01:05:19.262Z",
      "updated_at": "2025-02-05T14:58:30.553Z",
      "cooked": "<p>I have a CV that renders the full contents of a bibtex .bib file containing my publications. I would like my CV to update a description counting the number of publications in each journal every time add an entry to the .bib file. How can I count the number of publications in different journals automatically?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">\n#let journal_name = \"Physical Review Letters\"\n// How do a make the hypothetical function that counts papers?\n#let number_PRL = count_pubs(\"papers.bib\", #journal_name)\n\nI have written #let number_PRL papers in #journal_name\n\n#bibliography(\"papers.bib\", full: true)\n\n</code></pre>",
      "raw": "I have a CV that renders the full contents of a bibtex .bib file containing my publications. I would like my CV to update a description counting the number of publications in each journal every time add an entry to the .bib file. How can I count the number of publications in different journals automatically?\n\n```typ \n\n#let journal_name = \"Physical Review Letters\"\n// How do a make the hypothetical function that counts papers?\n#let number_PRL = count_pubs(\"papers.bib\", #journal_name)\n\nI have written #let number_PRL papers in #journal_name\n\n#bibliography(\"papers.bib\", full: true)\n\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 336.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 954
    },
    {
      "id": 6913,
      "post_number": 2,
      "username": "Y.D.X",
      "name": "Y.D.X.",
      "created_at": "2024-12-25T15:15:24.408Z",
      "updated_at": "2024-12-25T15:15:24.408Z",
      "cooked": "<p>Hmm, here is a fragile hack that uses regex to parse raw <code>ref.bib</code>. It should work if your <code>ref.bib</code> is properly formatted. (at least I think so)</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let journals = {\n  read(\"papers.bib\").matches(\n    // Assuming you always use `journaltitle` but never `journal`,\n    // and no journal title contains any bracket\n    regex(`\\s*journaltitle\\s*=\\s*\\{(.+?)\\},`.text)\n  ).map(it =&gt; it.captures.at(0))\n}\n\n#let count-journal(journal) = {\n  // Assuming you always use ‚ÄúPhysical Review Letters‚Äù but never ‚ÄúPhys. Rev. Lett.‚Äù or ‚ÄúPRL‚Äù.\n  journals.filter(j =&gt; j == journal).len()\n}\n\n#count-journal(\"Physical Review Letters\")\n</code></pre>",
      "raw": "Hmm, here is a fragile hack that uses regex to parse raw `ref.bib`. It should work if your `ref.bib` is properly formatted. (at least I think so)\n\n```typ\n#let journals = {\n  read(\"papers.bib\").matches(\n    // Assuming you always use `journaltitle` but never `journal`,\n    // and no journal title contains any bracket\n    regex(`\\s*journaltitle\\s*=\\s*\\{(.+?)\\},`.text)\n  ).map(it => it.captures.at(0))\n}\n\n#let count-journal(journal) = {\n  // Assuming you always use ‚ÄúPhysical Review Letters‚Äù but never ‚ÄúPhys. Rev. Lett.‚Äù or ‚ÄúPRL‚Äù.\n  journals.filter(j => j == journal).len()\n}\n\n#count-journal(\"Physical Review Letters\")\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 23,
      "score": 19.6,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 292
    }
  ],
  "scraped_at": "2025-06-10T09:53:26.520383"
}
{
  "topic_metadata": {
    "id": 2195,
    "title": "How to redefine the default frac behavior while avoiding circular references",
    "slug": "how-to-redefine-the-default-frac-behavior-while-avoiding-circular-references",
    "posts_count": 3,
    "created_at": "2024-12-24T05:21:47.831Z",
    "last_posted_at": "2024-12-25T07:34:40.091Z",
    "views": 142,
    "like_count": 1,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "omarkovic",
    "tags": [
      "math"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 167
  },
  "posts": [
    {
      "id": 6892,
      "post_number": 1,
      "username": "Matunaga_Touma",
      "name": "",
      "created_at": "2024-12-24T05:21:48.190Z",
      "updated_at": "2024-12-24T09:39:16.954Z",
      "cooked": "<p>I want to add spaces before and after the numerator and denominator to make the fraction bar longer. Below is the script I tried writing, but apparently there‚Äôs an error because of a circular reference. How to overwrite the defition of frac?</p>\n<p>Script</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let AddSpacefrac(num, den) = math.frac(\n[#h(1em /6) #num #h(1em /6)],\n[#h(1em /6) #den #h(1em /6)],\n)\n\n#show math.frac: frac =&gt; {\nAddSpacefrac(frac.num, frac.denom)\n}\n</code></pre>\n<p>Error message</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">maximum show rule depth exceeded\n\nHint: check whether the show rule matches its own output```</code></pre>",
      "raw": "I want to add spaces before and after the numerator and denominator to make the fraction bar longer. Below is the script I tried writing, but apparently there‚Äôs an error because of a circular reference. How to overwrite the defition of frac?\n\nScript\n```typ\n#let AddSpacefrac(num, den) = math.frac(\n[#h(1em /6) #num #h(1em /6)],\n[#h(1em /6) #den #h(1em /6)],\n)\n\n#show math.frac: frac => {\nAddSpacefrac(frac.num, frac.denom)\n}\n```\n\nError message\n```typ\nmaximum show rule depth exceeded\n\nHint: check whether the show rule matches its own output```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 35,
      "score": 707.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 971
    },
    {
      "id": 6902,
      "post_number": 2,
      "username": "omarkovic",
      "name": "Ognjen Markovic",
      "created_at": "2024-12-24T23:42:39.332Z",
      "updated_at": "2024-12-24T23:42:39.332Z",
      "cooked": "<p>One solution is a workaround for math.equation suggested by <a class=\"mention\" href=\"/u/frozolotl\">@frozolotl</a> in this issue: <a href=\"https://github.com/typst/typst/discussions/2242\" rel=\"noopener nofollow ugc\">https://github.com/typst/typst/discussions/2242</a></p>\n<p>The modified show rule is</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#show math.frac: it =&gt; {\n  if it.has(\"label\") and it.label == &lt;stop-frac-recursion&gt; {\n    it\n  } else {\n    [#AddSpacefrac(it.num, it.denom) &lt;stop-frac-recursion&gt; ]\n  }\n}\n</code></pre>\n<p>Not sure if there is a better solution than this workaround.</p>",
      "raw": "One solution is a workaround for math.equation suggested by @frozolotl in this issue: [https://github.com/typst/typst/discussions/2242](https://github.com/typst/typst/discussions/2242)\n\nThe modified show rule is\n\n```typst\n#show math.frac: it => {\n  if it.has(\"label\") and it.label == <stop-frac-recursion> {\n    it\n  } else {\n    [#AddSpacefrac(it.num, it.denom) <stop-frac-recursion> ]\n  }\n}\n```\nNot sure if there is a better solution than this workaround.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 40.6,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 975
    },
    {
      "id": 6904,
      "post_number": 3,
      "username": "Matunaga_Touma",
      "name": "",
      "created_at": "2024-12-25T07:34:40.091Z",
      "updated_at": "2024-12-25T07:34:40.091Z",
      "cooked": "<p>It worked! Thank you so much!!!</p>",
      "raw": "It worked! Thank you so much!!!!!!!!",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 15.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 971
    }
  ],
  "scraped_at": "2025-06-10T09:53:25.709975"
}
{
  "topic_metadata": {
    "id": 2211,
    "title": "How to show roman page numbers in the header within the outline and arabic elsewhere?",
    "slug": "how-to-show-roman-page-numbers-in-the-header-within-the-outline-and-arabic-elsewhere",
    "posts_count": 4,
    "created_at": "2024-12-26T19:27:20.979Z",
    "last_posted_at": "2024-12-28T14:21:39.092Z",
    "views": 290,
    "like_count": 1,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "Roland_Schatzle",
    "tags": [],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 372
  },
  "posts": [
    {
      "id": 6939,
      "post_number": 1,
      "username": "Roland_Schatzle",
      "name": "Roland Sch√§tzle",
      "created_at": "2024-12-26T19:27:21.089Z",
      "updated_at": "2024-12-26T19:32:33.757Z",
      "cooked": "<p>I‚Äôm showing the current page number in the header as follows:</p>\n<pre><code class=\"lang-auto\">set page(\n    ...\n    header:  ...\n       text(font: heading-font, size: 9pt, number-type: \"lining\",\n          context counter(page).display()),\n</code></pre>\n<p>That works basically fine. But I would like</p>\n<ul>\n<li>to show roman numbers (‚Äúi‚Äù, ‚Äúii‚Äù, ‚Ä¶) on the pages of the outline</li>\n<li>then reset the page counter to 1</li>\n<li>and to show arabic numbers within the header of the rest of the document</li>\n</ul>\n<p>How can this be achieved?</p>\n<p>Resetting the page number by <code>counter(page).update(1)</code>  when starting ‚Äúthe rest of the document‚Äù doesn‚Äôt affect the number displayed in the header of the first page. There it shows the next page number after the outline (e.g. if the outline has numbers 1 and 2, then it shows 3).</p>\n<p>And I have the problem when changing the number style (roman/arabic), that it doesn‚Äôt affect the display of the number in the header.</p>",
      "raw": "I'm showing the current page number in the header as follows:\n\n``` \nset page(\n    ...\n    header:  ...\n       text(font: heading-font, size: 9pt, number-type: \"lining\",\n          context counter(page).display()),\n```\n\nThat works basically fine. But I would like\n\n* to show roman numbers (\"i\", \"ii\", ...) on the pages of the outline\n* then reset the page counter to 1\n* and to show arabic numbers within the header of the rest of the document\n\nHow can this be achieved?\n\nResetting the page number by `counter(page).update(1)`  when starting \"the rest of the document\" doesn't affect the number displayed in the header of the first page. There it shows the next page number after the outline (e.g. if the outline has numbers 1 and 2, then it shows 3).\n\nAnd I have the problem when changing the number style (roman/arabic), that it doesn't affect the display of the number in the header.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 49,
      "score": 1169.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 966
    },
    {
      "id": 6940,
      "post_number": 2,
      "username": "Roland_Schatzle",
      "name": "Roland Sch√§tzle",
      "created_at": "2024-12-26T19:41:11.368Z",
      "updated_at": "2024-12-26T19:41:30.903Z",
      "cooked": "<p>I could solve the problem with the (in-)correct numbering as follows:</p>\n<p>I don‚Äôt do <code>counter(page).update(1)</code> on the first page, but <code>counter(page).update(0)</code> on the page before (before the page break of the preceding page).</p>\n<p>Is this the ‚Äúcorrect‚Äù way to do it?</p>",
      "raw": "I could solve the problem with the (in-)correct numbering as follows:\n\nI don't do `counter(page).update(1)` on the first page, but `counter(page).update(0)` on the page before (before the page break of the preceding page).\n\nIs this the \"correct\" way to do it?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 45,
      "score": 9.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 966
    },
    {
      "id": 6976,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-28T13:58:16.682Z",
      "updated_at": "2024-12-28T13:58:16.682Z",
      "cooked": "<p>There is a neat trick that should work since <a class=\"hashtag-cooked\" href=\"/tag/v0-12\" data-type=\"tag\" data-slug=\"v0-12\" data-id=\"142\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>v0-12</span></a>, which is to put page counter updates <em>between</em> pages:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#pagebreak()\n#counter(page).update(0)\n#pagebreak(weak: true)\n</code></pre>\n<p>whether the first or the second pagebreak is weak shouldn‚Äôt matter, but one must be weak. This will make sure that the counter is updated after any footer on the old page, but before any header on the new page.</p>\n<p>Even then, I have updated the counter to 0, since it is incremented <em>at the beginning of each page</em>: setting it to 1 would lead to the first shown page number being 2, which <em>is</em> intended behavior.</p>\n<p>Unless you have both header and footer with line numbers, updating to zero is sufficient and the correct solution. If you have both, doing the between-page-trick is additionally necessary.</p>",
      "raw": "There is a neat trick that should work since #v0-12, which is to put page counter updates _between_ pages:\n```typ\n#pagebreak()\n#counter(page).update(0)\n#pagebreak(weak: true)\n```\nwhether the first or the second pagebreak is weak shouldn't matter, but one must be weak. This will make sure that the counter is updated after any footer on the old page, but before any header on the new page.\n\nEven then, I have updated the counter to 0, since it is incremented _at the beginning of each page_: setting it to 1 would lead to the first shown page number being 2, which _is_ intended behavior.\n\nUnless you have both header and footer with line numbers, updating to zero is sufficient and the correct solution. If you have both, doing the between-page-trick is additionally necessary.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 37,
      "score": 62.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 6997,
      "post_number": 4,
      "username": "Roland_Schatzle",
      "name": "Roland Sch√§tzle",
      "created_at": "2024-12-28T14:21:39.092Z",
      "updated_at": "2024-12-28T14:21:39.092Z",
      "cooked": "<p>Thanks <a class=\"mention\" href=\"/u/sillyfreak\">@SillyFreak</a> for that really neat trick!</p>\n<p>So, together with <a href=\"https://forum.typst.app/t/how-to-put-different-page-numbering-in-outline/968/6\" class=\"inline-onebox\">How to put different page numbering in outline? - #6 by Roland_Schatzle</a>, my questions are (almost) completely answered <img src=\"https://forum.typst.app/images/emoji/apple/blush.png?v=12\" title=\":blush:\" class=\"emoji\" alt=\":blush:\" loading=\"lazy\" width=\"20\" height=\"20\">.</p>",
      "raw": "Thanks @SillyFreak for that really neat trick!\n\nSo, together with https://forum.typst.app/t/how-to-put-different-page-numbering-in-outline/968/6?u=roland_schatzle, my questions are (almost) completely answered üòä.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 6.8,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 966
    }
  ],
  "scraped_at": "2025-06-10T09:53:25.010396"
}
{
  "topic_metadata": {
    "id": 2215,
    "title": "How to avoid a reset to the third-level heading counter after changing the first two levels?",
    "slug": "how-to-avoid-a-reset-to-the-third-level-heading-counter-after-changing-the-first-two-levels",
    "posts_count": 3,
    "created_at": "2024-12-27T09:14:30.243Z",
    "last_posted_at": "2024-12-28T06:07:24.189Z",
    "views": 175,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "PgBiel",
    "tags": [
      "scripting",
      "counter"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 407
  },
  "posts": [
    {
      "id": 6944,
      "post_number": 1,
      "username": "Jose_Calvillo_Berlan",
      "name": "Jos√© Calvillo Berlanga",
      "created_at": "2024-12-27T09:14:30.355Z",
      "updated_at": "2024-12-28T06:08:11.979Z",
      "cooked": "<p>I am trying to create a customized heading structure, where after the first two levels I want to create a third level header, whose numbering counter does not reset with each change to the fist two levels.</p>\n<p>Is this possible?</p>",
      "raw": "I am trying to create a customized heading structure, where after the first two levels I want to create a third level header, whose numbering counter does not reset with each change to the fist two levels.\n\nIs this possible?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 37,
      "score": 522.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 980
    },
    {
      "id": 6969,
      "post_number": 2,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-28T05:48:58.772Z",
      "updated_at": "2024-12-28T05:48:58.772Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/jose_calvillo_berlan\">@Jose_Calvillo_Berlan</a>, welcome to the forum! I‚Äôve added some tags and also changed your question post‚Äôs title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you‚Äôd ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Jose_Calvillo_Berlan, welcome to the forum! I‚Äôve added some tags and also changed your question post‚Äôs title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you‚Äôd ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 11.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6970,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-28T06:07:24.189Z",
      "updated_at": "2024-12-28T06:07:24.189Z",
      "cooked": "<p>Due to automatic counter step behavior when placing any heading, I‚Äôd recommend using a separate counter which you manually control, like below.<br>\nNote that I‚Äôve taken the additional step of updating the heading counter to ensure it is consistent with the separate counter, ensuring we don‚Äôt have to rebuild headings entirely to start using the new counter, but rather keep headings as they are, using <code>counter(heading)</code> like they always do. This also ensures they show up correctly in the outline without having to take any additional steps.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let third-heading-counter = counter(\"third-heading-level\")\n#show selector.or(heading.where(level: 1), heading.where(level: 2)): it =&gt; {\n  it\n\n  // Revert level 3+ resets\n  context {\n    let new-numbers = third-heading-counter.get()\n    counter(heading).update(if it.level == 1 {\n       (one, ..n) =&gt; (one, 0, ..new-numbers)\n    } else {\n       (one, two, ..n) =&gt; (one, two, ..new-numbers)\n    })\n  }\n}\n\n#show heading: it =&gt; {\n  if it.level &gt;= 3 {\n    third-heading-counter.step(level: it.level - 2)\n  }\n  it\n}\n\n// Sample:\n\n#set page(width: 200pt, height: auto, margin: 0.5cm)\n#set heading(numbering: \"1.\")\n\n= A\n\n== B\n\n=== C\n\n==== CC\n\n== D\n\n==== DD\n\n=== E\n\n==== EE\n\n=== F\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/7/71afb66a77a56f7f762d0923c72504cab83a2aa4.png\" data-download-href=\"https://forum.typst.app/uploads/default/71afb66a77a56f7f762d0923c72504cab83a2aa4\" title=\"output: level 3+ headings have numbers kept\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/7/71afb66a77a56f7f762d0923c72504cab83a2aa4_2_445x500.png\" alt=\"output: level 3+ headings have numbers kept\" data-base62-sha1=\"gdIpPmL9vdb9BFSf79d7DlErg4A\" width=\"445\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/7/71afb66a77a56f7f762d0923c72504cab83a2aa4_2_445x500.png, https://forum.typst.app/uploads/default/optimized/2X/7/71afb66a77a56f7f762d0923c72504cab83a2aa4_2_667x750.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/7/71afb66a77a56f7f762d0923c72504cab83a2aa4_2_890x1000.png 2x\" data-dominant-color=\"FBFBFB\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">output: level 3+ headings have numbers kept</span><span class=\"informations\">944√ó1060 46 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>If you‚Äôd like to not display the first two numbers for level 3+ headings, you can selectively change their numbering by adding the following statements at the start, before all the headings:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading.where(level: 1): set heading(numbering: \"1.\")\n#show heading.where(level: 2): set heading(numbering: \"1.\")\n// For level 3+: ignore first two numbers\n#set heading(numbering: (first, second, ..n) =&gt; numbering(\"1.\", ..n))\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/7/79b3d0e9a64fc176c67b91b97371b2c33915a65e.png\" data-download-href=\"https://forum.typst.app/uploads/default/79b3d0e9a64fc176c67b91b97371b2c33915a65e\" title=\"new output: level 3+ headings don't display first two numbers\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/7/79b3d0e9a64fc176c67b91b97371b2c33915a65e_2_445x500.png\" alt=\"new output: level 3+ headings don't display first two numbers\" data-base62-sha1=\"hmD1JTdvucQtC6B03mB2gUIoocm\" width=\"445\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/7/79b3d0e9a64fc176c67b91b97371b2c33915a65e_2_445x500.png, https://forum.typst.app/uploads/default/optimized/2X/7/79b3d0e9a64fc176c67b91b97371b2c33915a65e_2_667x750.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/7/79b3d0e9a64fc176c67b91b97371b2c33915a65e_2_890x1000.png 2x\" data-dominant-color=\"FCFCFC\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">new output: level 3+ headings don't display first two numbers</span><span class=\"informations\">944√ó1060 38.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>If you do this, I recommend using <code>indent: auto</code> or <code>indent: 2em</code> in your <code>outline</code> to avoid ambiguity between 2.1. (level 2 heading) and 2.1. (level 4 heading), for example.</p>",
      "raw": "Due to automatic counter step behavior when placing any heading, I'd recommend using a separate counter which you manually control, like below. \nNote that I've taken the additional step of updating the heading counter to ensure it is consistent with the separate counter, ensuring we don't have to rebuild headings entirely to start using the new counter, but rather keep headings as they are, using `counter(heading)` like they always do. This also ensures they show up correctly in the outline without having to take any additional steps.\n\n```typ\n#let third-heading-counter = counter(\"third-heading-level\")\n#show selector.or(heading.where(level: 1), heading.where(level: 2)): it => {\n  it\n\n  // Revert level 3+ resets\n  context {\n    let new-numbers = third-heading-counter.get()\n    counter(heading).update(if it.level == 1 {\n       (one, ..n) => (one, 0, ..new-numbers)\n    } else {\n       (one, two, ..n) => (one, two, ..new-numbers)\n    })\n  }\n}\n\n#show heading: it => {\n  if it.level >= 3 {\n    third-heading-counter.step(level: it.level - 2)\n  }\n  it\n}\n\n// Sample:\n\n#set page(width: 200pt, height: auto, margin: 0.5cm)\n#set heading(numbering: \"1.\")\n\n= A\n\n== B\n\n=== C\n\n==== CC\n\n== D\n\n==== DD\n\n=== E\n\n==== EE\n\n=== F\n```\n\n![output: level 3+ headings have numbers kept|445x500](upload://gdIpPmL9vdb9BFSf79d7DlErg4A.png)\n\nIf you'd like to not display the first two numbers for level 3+ headings, you can selectively change their numbering by adding the following statements at the start, before all the headings:\n\n```typ\n#show heading.where(level: 1): set heading(numbering: \"1.\")\n#show heading.where(level: 2): set heading(numbering: \"1.\")\n// For level 3+: ignore first two numbers\n#set heading(numbering: (first, second, ..n) => numbering(\"1.\", ..n))\n```\n![new output: level 3+ headings don't display first two numbers|445x500](upload://hmD1JTdvucQtC6B03mB2gUIoocm.png)\n\nIf you do this, I recommend using `indent: auto` or `indent: 2em` in your `outline` to avoid ambiguity between 2.1. (level 2 heading) and 2.1. (level 4 heading), for example.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 33,
      "score": 111.6,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:53:24.303790"
}
{
  "topic_metadata": {
    "id": 2226,
    "title": "How do you write 8 choose 2 in typst?",
    "slug": "how-do-you-write-8-choose-2-in-typst",
    "posts_count": 3,
    "created_at": "2024-12-28T14:25:05.432Z",
    "last_posted_at": "2024-12-28T14:30:07.646Z",
    "views": 184,
    "like_count": 3,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "math"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 110
  },
  "posts": [
    {
      "id": 6999,
      "post_number": 1,
      "username": "Liana_Lee",
      "name": "Liana Lee",
      "created_at": "2024-12-28T14:25:05.641Z",
      "updated_at": "2024-12-28T14:25:05.641Z",
      "cooked": "<p>I am making typing up a solution to a problem in typst, and I am trying to write 8 choose 2 in my solution, but I‚Äôm not sure what the code to writing 8 choose 2 is. This picture is what I want the code to show:<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/d/d8674f71ad643ac98eddebb0673813cfadf82b16.png\" alt=\"Screenshot 2024-12-28 at 6.22.59 AM\" data-base62-sha1=\"uSotrNKCuwc0FeCws5HpSXE5Ar4\" width=\"230\" height=\"334\"><br>\nCan you please help me? Thank you!!!</p>",
      "raw": "I am making typing up a solution to a problem in typst, and I am trying to write 8 choose 2 in my solution, but I'm not sure what the code to writing 8 choose 2 is. This picture is what I want the code to show:\n![Screenshot 2024-12-28 at 6.22.59 AM|230x334](upload://uSotrNKCuwc0FeCws5HpSXE5Ar4.png)\nCan you please help me? Thank you!!!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 47,
      "score": 379.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 984
    },
    {
      "id": 7000,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-28T14:28:00.367Z",
      "updated_at": "2024-12-28T14:28:00.367Z",
      "cooked": "<p>Searching the docs for ‚Äúchoose‚Äù unfortunately only finds <code>calc.binom()</code> (which doesn‚Äôt display but calculate the binomial). But going off that and searching for ‚Äúbinom‚Äù finds also <code>math.binom()</code>:</p>\n<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/docs/reference/math/binom/\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/docs/reference/math/binom/\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/docs/reference/math/binom/\" target=\"_blank\" rel=\"noopener\">Binomial Function ‚Äì Typst Documentation</a></h3>\n\n  <p>Documentation for the `binom` function.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "Searching the docs for \"choose\" unfortunately only finds `calc.binom()` (which doesn't display but calculate the binomial). But going off that and searching for \"binom\" finds also `math.binom()`:\n\nhttps://typst.app/docs/reference/math/binom/",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 47,
      "score": 39.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7003,
      "post_number": 3,
      "username": "Liana_Lee",
      "name": "Liana Lee",
      "created_at": "2024-12-28T14:30:07.646Z",
      "updated_at": "2024-12-28T14:30:07.646Z",
      "cooked": "<p>Thank you so much!!! <img src=\"https://forum.typst.app/images/emoji/apple/smile.png?v=12\" title=\":smile:\" class=\"emoji\" alt=\":smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Thank you so much!!!! :smile:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 45,
      "score": 54.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 984
    }
  ],
  "scraped_at": "2025-06-10T09:53:23.460699"
}
{
  "topic_metadata": {
    "id": 2233,
    "title": "Is there a way to convert content to bytes for use in plugins?",
    "slug": "is-there-a-way-to-convert-content-to-bytes-for-use-in-plugins",
    "posts_count": 4,
    "created_at": "2024-12-28T23:55:53.944Z",
    "last_posted_at": "2024-12-31T00:31:24.720Z",
    "views": 128,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 927
  },
  "posts": [
    {
      "id": 7021,
      "post_number": 1,
      "username": "frisbro",
      "name": "",
      "created_at": "2024-12-28T23:55:54.074Z",
      "updated_at": "2024-12-29T10:13:08.317Z",
      "cooked": "<p>Hi all,</p>\n<p>It would be nice to have the option to convert content to bytes using bytes(‚Ä¶). This would be useful when developing plugins. For instance, if one develops a plugin using Rust, I imagine that one could use the Typst libarary and then deserialize the bytes. It would open up a lot of possibilities for future plugins.</p>\n<p>For now, is there a better way to convert content to a string than using repr(‚Ä¶)?</p>\n<p>Best regards, F</p>",
      "raw": "Hi all,\n\nIt would be nice to have the option to convert content to bytes using bytes(...). This would be useful when developing plugins. For instance, if one develops a plugin using Rust, I imagine that one could use the Typst libarary and then deserialize the bytes. It would open up a lot of possibilities for future plugins. \n\nFor now, is there a better way to convert content to a string than using repr(...)?\n\nBest regards, F",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 217.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 986
    },
    {
      "id": 7024,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-29T10:08:14.658Z",
      "updated_at": "2024-12-31T09:20:41.663Z",
      "cooked": "<p>There is no built-in way, but it‚Äôs not too hard to build one yourself (with limitations). There‚Äôs been this post on handling content, which I think is at least somewhat relevant:</p>\n<aside class=\"quote quote-modified\" data-post=\"1\" data-topic=\"1099\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/5C0B42/48.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/how-can-i-manipulate-content-values/1099\">How can I manipulate content values?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    Currently, manipulating content is very involved. This is mainly caused by the content functions \n\ntaking different amount of positional arguments\nfields() not distinguishing between positional and keyword arguments\nnot all content functions being accessible (e.g. sequence can as far as I know only obtained by hacks like [].func())\n\nFor example, I‚Äôd like to recursively update all strings in a content, which currently requires a lot of special casing and hard to know if you caught all edge cases.‚Ä¶\n  </blockquote>\n</aside>\n\n<p>A main takeaway here is that, whenever you can, you should strive to <em>not</em> have content as the basis of your computation. Use structured data as long as possible and then format it.</p>\n<p>In your case, you want to specifically create bytes to communicate arbitrary content to a plugin. The approach will be similar to what is presented in that post, and is based on <a href=\"https://sitandr.github.io/typst-examples-book/book/typstonomicon/extract_plain_text.html\" class=\"inline-onebox\">Extracting plain text - Typst Examples Book</a> (which is in the section ‚ÄúTypstonomicon, or The Code You Should Not Write‚Äù ‚Äì be warned!)</p>\n<p>You don‚Äôt actually need to go all the way to bytes, since once you have converted content into plain data, you can just use <a href=\"https://typst.app/docs/reference/data-loading/cbor/\">CBOR</a>. To convert content into a data structure (I‚Äôm calling it AST because it at least resembles an abstract syntax tree and naming is hard) you can recursively go through content:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let content-to-ast(it) = {\n  // function (as string representation) and fields is what makes some content\n  let func = repr(it.func())\n  let fields = it.fields()\n\n  // children (for content containing many things)\n  // and body (for stuff containing a single thing)\n  // are the ones we need to recursively transform\n  if \"children\" in fields {\n    fields.children = fields.children.map(content-to-ast)\n  } else if \"body\" in fields {\n    fields.body = content-to-ast(fields.body)\n  }\n\n  // return a dictionary, which should no longer contain content\n  (function: func, ..fields)\n}\n\n#let ast-to-content(it) = {\n  // separate function and fields\n  let (function: func, ..fields) = it\n\n  // recursively un-transform\n  if \"children\" in fields {\n    fields.children = fields.children.map(ast-to-content)\n  } else if \"body\" in fields {\n    fields.body = ast-to-content(fields.body)\n  }\n\n  // convert to content according to the function\n  // TODO other types\n  if func == \"sequence\" {\n    fields.children.join()\n  } else if func == \"linebreak\" {\n    linebreak()\n  } else if func == \"space\" {\n    [ ]\n  } else if func == \"text\" {\n    [#fields.text]\n  } else if func == \"box\" {\n    let (body, ..fields) = fields\n    box(body, ..fields)\n  } else if func == \"smartquote\" {\n    smartquote(..fields)\n  }\n}\n</code></pre>\n<p>and you can now translate content to bytes and back ‚Äî at least the few things I chose to support here:</p>\n<details>\n<summary>\nExample</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let example = [Hello\\ #box[\"World\"]]\n// serialize\n#let example-ast = content-to-ast(example)\n#let example-bytes = cbor.encode(example-ast)\n// deserialize\n#let example-ast = cbor.decode(example-bytes)\n#let example-roundtrip = ast-to-content(example-ast)\n\n#table(\n  columns: 2,\n  [\n    #example\n    \n    #repr(example)\n  ],\n  [\n    #example-roundtrip\n    \n    #repr(example-roundtrip)\n  ],\n)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/979798b664d247d68300457c26fce4c07679a2d0.png\" data-download-href=\"https://forum.typst.app/uploads/default/979798b664d247d68300457c26fce4c07679a2d0\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/979798b664d247d68300457c26fce4c07679a2d0_2_489x375.png\" alt=\"image\" data-base62-sha1=\"lD2TjhhwYmqJ9hAai96umtXPl6g\" width=\"489\" height=\"375\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/979798b664d247d68300457c26fce4c07679a2d0_2_489x375.png, https://forum.typst.app/uploads/default/original/2X/9/979798b664d247d68300457c26fce4c07679a2d0.png 1.5x, https://forum.typst.app/uploads/default/original/2X/9/979798b664d247d68300457c26fce4c07679a2d0.png 2x\" data-dominant-color=\"F3F3F3\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">668√ó512 55.8 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>\n<hr>\n<p><strong>However‚Ä¶</strong></p>\n<p>Of course it would be nice if things were that easy, but in general they are not:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let example2 = {\n  set text(1em)\n  [Hello]\n}\n\n#repr(example2)\n// styled(child: [Hello], ..)\n#example2.styles\n// ..\n</code></pre>\n<p>The <code>styled</code> element (for example) which is generated by using rules contains a <code>styles</code> field, which is opaque, so we can‚Äôt convert it. I‚Äôm not an expert on Typst intrinsics, but I‚Äôm pretty sure there is simply no way these elements could be represented that doesn‚Äôt rely on also referencing some part of Typst‚Äôs Rust runtime ‚Äì we‚Äôre simply out of luck. Even if we could represent set rules, a show rule can can contain user-written Typst code, so we‚Äôd need to convert <em>any kind of Typst code</em> into a plain Typst value.</p>\n<hr>\n<p>So to recap:</p>\n<ul>\n<li>Regular content (the kind of content you could also write in e.g. Markdown or HTML (excluding CSS)) can be recursively converted into Typst dictionaries.</li>\n<li>This is necessarily limited and lossy, which is why the basic technique is part of the Typstonomicon.</li>\n<li>You should generally prefer to work on structured data, and only convert that to content after everything is done.</li>\n<li>Nonetheless, I think this (ideally coupled with a Rust library that handles the other side of the conversion) could be fairly useful in general. In <a href=\"https://forum.typst.app/t/parsing-dsls-with-a-wasm-plugin-using-rust-lalrpop/1376\">one of my showcases</a> I used Serde to convert Rust structs and enums to Typst values, so that they can be formatted on the Typst side. This would be very similar, except that the values passed <em>to</em> Rust wouldn‚Äôt be strings to parse, but already prepared data that can simly be deserialized.</li>\n</ul>",
      "raw": "There is no built-in way, but it's not too hard to build one yourself (with limitations). There's been this post on handling content, which I think is at least somewhat relevant:\n\nhttps://forum.typst.app/t/how-can-i-manipulate-content-values/1099?u=sillyfreak\n\nA main takeaway here is that, whenever you can, you should strive to _not_ have content as the basis of your computation. Use structured data as long as possible and then format it.\n\nIn your case, you want to specifically create bytes to communicate arbitrary content to a plugin. The approach will be similar to what is presented in that post, and is based on https://sitandr.github.io/typst-examples-book/book/typstonomicon/extract_plain_text.html (which is in the section \"Typstonomicon, or The Code You Should Not Write\" -- be warned!)\n\nYou don't actually need to go all the way to bytes, since once you have converted content into plain data, you can just use [CBOR](https://typst.app/docs/reference/data-loading/cbor/). To convert content into a data structure (I'm calling it AST because it at least resembles an abstract syntax tree and naming is hard) you can recursively go through content:\n\n```typ\n#let content-to-ast(it) = {\n  // function (as string representation) and fields is what makes some content\n  let func = repr(it.func())\n  let fields = it.fields()\n\n  // children (for content containing many things)\n  // and body (for stuff containing a single thing)\n  // are the ones we need to recursively transform\n  if \"children\" in fields {\n    fields.children = fields.children.map(content-to-ast)\n  } else if \"body\" in fields {\n    fields.body = content-to-ast(fields.body)\n  }\n\n  // return a dictionary, which should no longer contain content\n  (function: func, ..fields)\n}\n\n#let ast-to-content(it) = {\n  // separate function and fields\n  let (function: func, ..fields) = it\n\n  // recursively un-transform\n  if \"children\" in fields {\n    fields.children = fields.children.map(ast-to-content)\n  } else if \"body\" in fields {\n    fields.body = ast-to-content(fields.body)\n  }\n\n  // convert to content according to the function\n  // TODO other types\n  if func == \"sequence\" {\n    fields.children.join()\n  } else if func == \"linebreak\" {\n    linebreak()\n  } else if func == \"space\" {\n    [ ]\n  } else if func == \"text\" {\n    [#fields.text]\n  } else if func == \"box\" {\n    let (body, ..fields) = fields\n    box(body, ..fields)\n  } else if func == \"smartquote\" {\n    smartquote(..fields)\n  }\n}\n```\n\nand you can now translate content to bytes and back --- at least the few things I chose to support here:\n\n[details=\"Example\"]\n```typ\n#let example = [Hello\\ #box[\"World\"]]\n// serialize\n#let example-ast = content-to-ast(example)\n#let example-bytes = cbor.encode(example-ast)\n// deserialize\n#let example-ast = cbor.decode(example-bytes)\n#let example-roundtrip = ast-to-content(example-ast)\n\n#table(\n  columns: 2,\n  [\n    #example\n    \n    #repr(example)\n  ],\n  [\n    #example-roundtrip\n    \n    #repr(example-roundtrip)\n  ],\n)\n```\n![image|652x500, 75%](upload://lD2TjhhwYmqJ9hAai96umtXPl6g.png)\n[/details]\n\n----\n\n**However...**\n\nOf course it would be nice if things were that easy, but in general they are not:\n\n```typ\n#let example2 = {\n  set text(1em)\n  [Hello]\n}\n\n#repr(example2)\n// styled(child: [Hello], ..)\n#example2.styles\n// ..\n```\n\nThe `styled` element (for example) which is generated by using rules contains a `styles` field, which is opaque, so we can't convert it. I'm not an expert on Typst intrinsics, but I'm pretty sure there is simply no way these elements could be represented that doesn't rely on also referencing some part of Typst's Rust runtime -- we're simply out of luck. Even if we could represent set rules, a show rule can can contain user-written Typst code, so we'd need to convert _any kind of Typst code_ into a plain Typst value.\n\n---\n\nSo to recap:\n- Regular content (the kind of content you could also write in e.g. Markdown or HTML (excluding CSS)) can be recursively converted into Typst dictionaries.\n- This is necessarily limited and lossy, which is why the basic technique is part of the Typstonomicon.\n- You should generally prefer to work on structured data, and only convert that to content after everything is done.\n- Nonetheless, I think this (ideally coupled with a Rust library that handles the other side of the conversion) could be fairly useful in general. In [one of my showcases](https://forum.typst.app/t/parsing-dsls-with-a-wasm-plugin-using-rust-lalrpop/1376?u=sillyfreak) I used Serde to convert Rust structs and enums to Typst values, so that they can be formatted on the Typst side. This would be very similar, except that the values passed _to_ Rust wouldn't be strings to parse, but already prepared data that can simly be deserialized.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 35,
      "score": 82.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7025,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-29T10:12:07.992Z",
      "updated_at": "2024-12-29T10:12:07.992Z",
      "cooked": "<p>btw <a class=\"mention\" href=\"/u/frisbro\">@frisbro</a>, I will move this post to <a class=\"hashtag-cooked\" href=\"/c/questions/5\" data-type=\"category\" data-slug=\"questions\" data-id=\"5\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>Questions</span></a> (and give it tags and <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">a title that is a question you‚Äôd ask a friend</a>). I know you wrote about Typst providing this and only asking for a workaround as a last resort, but for the limitations I described and because stabilizing a more complex Plugin protocol is very unlikely in the near future, I think it‚Äôs more likely that we handle this in userspace for the time being.</p>",
      "raw": "btw @frisbro, I will move this post to #questions (and give it tags and [a title that is a question you‚Äôd ask a friend](https://forum.typst.app/t/how-to-post-in-the-questions-category/11)). I know you wrote about Typst providing this and only asking for a workaround as a last resort, but for the limitations I described and because stabilizing a more complex Plugin protocol is very unlikely in the near future, I think it's more likely that we handle this in userspace for the time being.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 31.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7081,
      "post_number": 4,
      "username": "frisbro",
      "name": "",
      "created_at": "2024-12-31T00:31:24.720Z",
      "updated_at": "2024-12-31T00:31:24.720Z",
      "cooked": "<p>Thank-you very much for the detailed reply. This helped me enormously.</p>",
      "raw": "Thank-you very much for the detailed reply. This helped me enormously.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 9.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 986
    }
  ],
  "scraped_at": "2025-06-10T09:53:22.738946"
}
{
  "topic_metadata": {
    "id": 2236,
    "title": "Template : How to prevent linebreak?",
    "slug": "template-how-to-prevent-linebreak",
    "posts_count": 2,
    "created_at": "2024-12-29T13:35:57.365Z",
    "last_posted_at": "2024-12-29T14:07:24.467Z",
    "views": 194,
    "like_count": 0,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "scripting",
      "layout"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 250
  },
  "posts": [
    {
      "id": 7029,
      "post_number": 1,
      "username": "Alex",
      "name": "Alex",
      "created_at": "2024-12-29T13:35:57.749Z",
      "updated_at": "2024-12-29T13:53:21.063Z",
      "cooked": "<p>Hello,<br>\nI‚Äôve this template ‚Äúcode‚Äù that just print defined text. If the user want to add an author, the author is shown surrounded with parenthesis.<br>\nHowever, since the text added has a line break at the end, the text and the author does not show on the same line. How to prevent this ?<br>\nThanks in advance for answers</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let header_tune(body, author: \"\") = [\n  #set text(size: 7pt, font : \"Molengo\")\n  \"Air : \"\n  #body  \n  #if (author != \"\") { \"(\"+ author +\")\"} else {\"\"}\n]\n\n#show: style.header_tune.with(author : \"Author\")\nMusique tr√®s connue\n</code></pre>\n<p>here‚Äôs the result :</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/6/6c32a60444fe120259827ac9518016d0b886bbba.png\" alt=\"Capture d'√©cran 2024-12-29 143449\" data-base62-sha1=\"fra50j17jijwLRCl9uClANgq0K6\" width=\"255\" height=\"131\"></p>\n<p>I want it rendered as :<br>\n‚ÄúAir : Musique tr√®s connue (Author)‚Äù</p>\n<p>I know that i can use something like :</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#style.header_tune(\"Musique tr√®s connue\", author : \"Alex\")\n</code></pre>\n<p>But i think that it force the end user to either declare a valiable of type text() or set the parameter directly making it ‚Äúless intuitive‚Äù and ‚Äúless customisable‚Äù.</p>",
      "raw": "Hello, \nI've this template \"code\" that just print defined text. If the user want to add an author, the author is shown surrounded with parenthesis. \nHowever, since the text added has a line break at the end, the text and the author does not show on the same line. How to prevent this ? \nThanks in advance for answers\n\n```typst\n#let header_tune(body, author: \"\") = [\n  #set text(size: 7pt, font : \"Molengo\")\n  \"Air : \"\n  #body  \n  #if (author != \"\") { \"(\"+ author +\")\"} else {\"\"}\n]\n\n#show: style.header_tune.with(author : \"Author\")\nMusique tr√®s connue\n```\n\nhere's the result : \n\n![Capture d'√©cran 2024-12-29 143449|255x131](upload://fra50j17jijwLRCl9uClANgq0K6.png)\n\nI want it rendered as : \n\"Air : Musique tr√®s connue (Author)\"\n\nI know that i can use something like :\n\n```typst\n#style.header_tune(\"Musique tr√®s connue\", author : \"Alex\")\n```\n\nBut i think that it force the end user to either declare a valiable of type text() or set the parameter directly making it \"less intuitive\" and \"less customisable\".",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 845.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 987
    },
    {
      "id": 7030,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-29T14:07:24.467Z",
      "updated_at": "2024-12-29T14:07:24.467Z",
      "cooked": "<p>I suspect that you simply have an additional newline after ‚ÄúMusique tr√®s connue‚Äù. If I just copy your code and the file ends after that line, everything is on the same line.</p>\n<p>Regarding your readability concerns: I think it depends on what the document would contain overall, depending on that a normal function call could look very reasonable. Keep in mind that the function call could look like this, which is fairly customizable (you can style the body, it doesn‚Äôt need to be a plain string):</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#style.header_tune(author: \"Author\")[\n  Musique tr√®s connue\n]\n</code></pre>",
      "raw": "I suspect that you simply have an additional newline after \"Musique tr√®s connue\". If I just copy your code and the file ends after that line, everything is on the same line.\n\nRegarding your readability concerns: I think it depends on what the document would contain overall, depending on that a normal function call could look very reasonable. Keep in mind that the function call could look like this, which is fairly customizable (you can style the body, it doesn't need to be a plain string):\n```typ\n#style.header_tune(author: \"Author\")[\n  Musique tr√®s connue\n]\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 19.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:53:21.987707"
}
{
  "topic_metadata": {
    "id": 2239,
    "title": "How can I add images to a nametag, top left and top right from the main content?",
    "slug": "how-can-i-add-images-to-a-nametag-top-left-and-top-right-from-the-main-content",
    "posts_count": 5,
    "created_at": "2024-12-29T19:46:46.411Z",
    "last_posted_at": "2024-12-30T13:25:26.711Z",
    "views": 129,
    "like_count": 2,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 890
  },
  "posts": [
    {
      "id": 7036,
      "post_number": 1,
      "username": "mindlessgreen",
      "name": "mindlessgreen",
      "created_at": "2024-12-29T19:46:46.542Z",
      "updated_at": "2024-12-30T12:37:12.856Z",
      "cooked": "<p>I would like to create nametags like this:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/c/c2517af561ad6612d1bfa3369f298effdf34dc88.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/c2517af561ad6612d1bfa3369f298effdf34dc88\" title=\"Screenshot 2024-12-29 at 20.41.33\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/c/c2517af561ad6612d1bfa3369f298effdf34dc88_2_543x500.jpeg\" alt=\"Screenshot 2024-12-29 at 20.41.33\" data-base62-sha1=\"rJ1coSamPMc5GHDp49mHx12PBs4\" width=\"543\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/c/c2517af561ad6612d1bfa3369f298effdf34dc88_2_543x500.jpeg, https://forum.typst.app/uploads/default/optimized/2X/c/c2517af561ad6612d1bfa3369f298effdf34dc88_2_814x750.jpeg 1.5x, https://forum.typst.app/uploads/default/original/2X/c/c2517af561ad6612d1bfa3369f298effdf34dc88.jpeg 2x\" data-dominant-color=\"F9F9F9\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2024-12-29 at 20.41.33</span><span class=\"informations\">1042√ó958 81.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>This is the code I have so far.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// template\n#set page(\n  height: 16.5cm, \n  width: 18cm,\n  margin: (left: 0cm, right: 0cm, top: 0cm, bottom: 0cm)\n)\n#set align(center)\n#set text(16pt, fill: rgb(\"#444444\"))\n#let name-style(content) = {\n  text(20pt, content)\n}\n#let author-box(content) = {\n  set align(center + horizon)\n  box(\n    width: 100%,\n    height: 100%,\n    stroke: (paint: silver, thickness: 0.5pt, dash: \"dashed\"),\n    content\n  )\n}\n\n#let conf(\n  authors: (),\n  doc,\n) = {\n  let count = authors.len()\n  let ncols = 2\n  let nrows = 4\n  \n  grid(\n    columns: (1fr,) * ncols,\n    rows: (1fr,) * nrows,\n    row-gutter: 0cm,\n    ..authors.map(author =&gt; author-box([\n         #author.name \\\n         #author.affiliation \\\n         #author.email\n    ]))\n  )\n}\n\n// values\n#show: doc =&gt; conf(\n  authors: (\n    (\n      name: \"Theresa Tungsten\",\n      affiliation: \"Artos Institute\",\n      email: \"tung@artos.edu\",\n      logo_left: \"images/logo1.png\",\n      logo_right: \"images/logo2.png\"\n    ),\n    (\n      name: \"Eugene Deklan\",\n      affiliation: \"Honduras State\",\n      email: \"e.deklan@hstate.hn\",\n    ),\n    (\n      name: \"Eugene Deklan\",\n      affiliation: \"Honduras State\",\n      email: \"e.deklan@hstate.hn\",\n    ),\n    (\n      name: \"Eugene Deklan\",\n      affiliation: \"Honduras State\",\n      email: \"e.deklan@hstate.hn\",\n    ),\n    (\n      name: \"Eugene Deklan\",\n      affiliation: \"Honduras State\",\n      email: \"e.deklan@hstate.hn\",\n    ),\n    (\n      name: \"Eugene Deklan\",\n      affiliation: \"Honduras State\",\n      email: \"e.deklan@hstate.hn\",\n    )\n  ),\n  doc,\n)\n</code></pre>\n<p>It has been a struggle to get to this point. I would like to add two logos to the top left and top-right of each nametag.</p>\n<pre><code class=\"lang-auto\">  grid(\n      columns: (1fr, 1fr),\n      row-gutter: 0pt,\n      align(left, image(author.logo_left, height: 6mm)),\n      align(right, image(author.logo_right, height: 6mm))\n    )\n</code></pre>\n<p>I can‚Äôt quite get this to work. Any help is appreciated.<br>\nThanks!</p>",
      "raw": "I would like to create nametags like this:\n\n![Screenshot 2024-12-29 at 20.41.33|543x500](upload://rJ1coSamPMc5GHDp49mHx12PBs4.jpeg)\n\nThis is the code I have so far.\n\n```typ\n// template\n#set page(\n  height: 16.5cm, \n  width: 18cm,\n  margin: (left: 0cm, right: 0cm, top: 0cm, bottom: 0cm)\n)\n#set align(center)\n#set text(16pt, fill: rgb(\"#444444\"))\n#let name-style(content) = {\n  text(20pt, content)\n}\n#let author-box(content) = {\n  set align(center + horizon)\n  box(\n    width: 100%,\n    height: 100%,\n    stroke: (paint: silver, thickness: 0.5pt, dash: \"dashed\"),\n    content\n  )\n}\n\n#let conf(\n  authors: (),\n  doc,\n) = {\n  let count = authors.len()\n  let ncols = 2\n  let nrows = 4\n  \n  grid(\n    columns: (1fr,) * ncols,\n    rows: (1fr,) * nrows,\n    row-gutter: 0cm,\n    ..authors.map(author => author-box([\n         #author.name \\\n         #author.affiliation \\\n         #author.email\n    ]))\n  )\n}\n\n// values\n#show: doc => conf(\n  authors: (\n    (\n      name: \"Theresa Tungsten\",\n      affiliation: \"Artos Institute\",\n      email: \"tung@artos.edu\",\n      logo_left: \"images/logo1.png\",\n      logo_right: \"images/logo2.png\"\n    ),\n    (\n      name: \"Eugene Deklan\",\n      affiliation: \"Honduras State\",\n      email: \"e.deklan@hstate.hn\",\n    ),\n    (\n      name: \"Eugene Deklan\",\n      affiliation: \"Honduras State\",\n      email: \"e.deklan@hstate.hn\",\n    ),\n    (\n      name: \"Eugene Deklan\",\n      affiliation: \"Honduras State\",\n      email: \"e.deklan@hstate.hn\",\n    ),\n    (\n      name: \"Eugene Deklan\",\n      affiliation: \"Honduras State\",\n      email: \"e.deklan@hstate.hn\",\n    ),\n    (\n      name: \"Eugene Deklan\",\n      affiliation: \"Honduras State\",\n      email: \"e.deklan@hstate.hn\",\n    )\n  ),\n  doc,\n)\n```\n\nIt has been a struggle to get to this point. I would like to add two logos to the top left and top-right of each nametag. \n\n```\n  grid(\n      columns: (1fr, 1fr),\n      row-gutter: 0pt,\n      align(left, image(author.logo_left, height: 6mm)),\n      align(right, image(author.logo_right, height: 6mm))\n    )\n```\n\nI can't quite get this to work. Any help is appreciated.\nThanks!",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 599.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 989
    },
    {
      "id": 7044,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-29T23:58:49.001Z",
      "updated_at": "2024-12-29T23:58:49.001Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/mindlessgreen\">@mindlessgreen</a>, welcome and thank you for your question! I have changed your post‚Äôs title to bring it in line with the <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">question guidelines</a> and thus make it easier to find in the future:</p>\n<blockquote>\n<p><strong>Good titles are questions you would ask your friend about Typst.</strong></p>\n</blockquote>",
      "raw": "Hi @mindlessgreen, welcome and thank you for your question! I have changed your post‚Äôs title to bring it in line with the [question guidelines](https://forum.typst.app/t/how-to-post-in-the-questions-category/11) and thus make it easier to find in the future:\n\n> **Good titles are questions you would ask your friend about Typst.**",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 8.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7057,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-30T11:17:41.436Z",
      "updated_at": "2024-12-30T11:17:41.436Z",
      "cooked": "<p>So this is the function that you want to ‚Äúfix‚Äù:</p>\n<aside class=\"quote no-group\" data-username=\"mindlessgreen\" data-post=\"1\" data-topic=\"2239\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/m/8C2563/48.png\" class=\"avatar\"> mindlessgreen:</div>\n<blockquote>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let author-box(content) = {\n  set align(center + horizon)\n  box(\n    width: 100%,\n    height: 100%,\n    stroke: (paint: silver, thickness: 0.5pt, dash: \"dashed\"),\n    content\n  )\n}\n</code></pre>\n</blockquote>\n</aside>\n<p>Not a real issue, but using <code>box()</code> here is conceptually not the right tool. A grid cell is a block, and you don‚Äôt have a need (that I can see) to render a nametag embedded into a regular paragraph.</p>\n<p>What you need to do to add the images is to put the label‚Äôs contents into a grid. You‚Äôll also want the lines <em>outside</em> the grid so that it covers the whole nametag:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let author-box(content) = block(\n  // stroke around the grid\n  stroke: (paint: silver, thickness: 0.5pt, dash: \"dashed\"),\n  {\n    // all cells are centered\n    set align(center + horizon)\n\n    grid(\n      // same amount of space left and right for the images,\n      // the center cell takes the rest\n      columns: (1cm, 1fr, 1cm),  \n      // the grid row fills the whole nametag's space\n      rows: (1fr,),\n      image(\"image.jpg\"),\n      content,\n      image(\"image.jpg\"),\n    )\n  },\n)\n</code></pre>\n<p>As an aside, you can also render the lines (that are probably only for cutting and not really part of the name tags) as part of the outer grid (the one containing multiple nametags). That will simplify the function again:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let author-box(content) = {\n  set align(center + horizon)\n\n  grid(\n    columns: (1cm, 1fr, 1cm),  \n    rows: (1fr,),\n    image(\"image.jpg\"),\n    content,\n    image(\"image.jpg\"),\n  )\n}\n\n#let conf(\n  authors: (),\n  doc,\n) = {\n  ...\n  \n  grid(\n    ...\n    stroke: (paint: silver, thickness: 0.5pt, dash: \"dashed\"),\n    ...\n  )\n}\n</code></pre>",
      "raw": "So this is the function that you want to \"fix\":\n\n[quote=\"mindlessgreen, post:1, topic:2239\"]\n```typ\n#let author-box(content) = {\n  set align(center + horizon)\n  box(\n    width: 100%,\n    height: 100%,\n    stroke: (paint: silver, thickness: 0.5pt, dash: \"dashed\"),\n    content\n  )\n}\n```\n[/quote]\n\nNot a real issue, but using `box()` here is conceptually not the right tool. A grid cell is a block, and you don't have a need (that I can see) to render a nametag embedded into a regular paragraph.\n\nWhat you need to do to add the images is to put the label's contents into a grid. You'll also want the lines _outside_ the grid so that it covers the whole nametag:\n\n```typ\n#let author-box(content) = block(\n  // stroke around the grid\n  stroke: (paint: silver, thickness: 0.5pt, dash: \"dashed\"),\n  {\n    // all cells are centered\n    set align(center + horizon)\n\n    grid(\n      // same amount of space left and right for the images,\n      // the center cell takes the rest\n      columns: (1cm, 1fr, 1cm),  \n      // the grid row fills the whole nametag's space\n      rows: (1fr,),\n      image(\"image.jpg\"),\n      content,\n      image(\"image.jpg\"),\n    )\n  },\n)\n```\n\nAs an aside, you can also render the lines (that are probably only for cutting and not really part of the name tags) as part of the outer grid (the one containing multiple nametags). That will simplify the function again:\n\n```typ\n#let author-box(content) = {\n  set align(center + horizon)\n\n  grid(\n    columns: (1cm, 1fr, 1cm),  \n    rows: (1fr,),\n    image(\"image.jpg\"),\n    content,\n    image(\"image.jpg\"),\n  )\n}\n\n#let conf(\n  authors: (),\n  doc,\n) = {\n  ...\n  \n  grid(\n    ...\n    stroke: (paint: silver, thickness: 0.5pt, dash: \"dashed\"),\n    ...\n  )\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 19,
      "score": 38.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7061,
      "post_number": 4,
      "username": "mindlessgreen",
      "name": "mindlessgreen",
      "created_at": "2024-12-30T12:36:23.887Z",
      "updated_at": "2024-12-30T12:36:23.887Z",
      "cooked": "<p>Thank you! This has been very helpful. I have adjusted the grid so that the logos are organized better.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/a/a4778fc3cce3bcd52587d2b216925cbcb131cd52.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/a4778fc3cce3bcd52587d2b216925cbcb131cd52\" title=\"Screenshot 2024-12-30 at 13.33.24\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/a/a4778fc3cce3bcd52587d2b216925cbcb131cd52_2_408x500.jpeg\" alt=\"Screenshot 2024-12-30 at 13.33.24\" data-base62-sha1=\"nsWsO9B0WnxdS3hNtPIFzthisfw\" width=\"408\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/a/a4778fc3cce3bcd52587d2b216925cbcb131cd52_2_408x500.jpeg, https://forum.typst.app/uploads/default/optimized/2X/a/a4778fc3cce3bcd52587d2b216925cbcb131cd52_2_612x750.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/a/a4778fc3cce3bcd52587d2b216925cbcb131cd52_2_816x1000.jpeg 2x\" data-dominant-color=\"F7F7F6\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2024-12-30 at 13.33.24</span><span class=\"informations\">1042√ó1276 155 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// template\n#set page(\n  height: 22cm, \n  width: 18cm,\n  margin: (left: 0cm, right: 0cm, top: 0cm, bottom: 0cm)\n)\n#set text(16pt, font: \"Barlow\", fill: rgb(\"#444444\"))\n#let author-box(content) = block(\n  pad(0.3cm,\n    grid(\n      columns: 1fr, \n      rows: (1fr, 8fr),\n      grid(\n        columns: (1fr, 1fr),\n        rows: 1fr,\n        align(left,\n          image(\"images/logo1.png\", height: 0.7cm)\n        ),\n        align(right,\n          image(\"images/logo2.png\", height: 0.6cm)\n        ),\n      ),\n      align(center + horizon, content)\n    )\n  )\n)\n\n#let conf(\n  authors: (),\n  doc,\n) = {\n  let count = authors.len()\n  let ncols = 2\n  let nrows = 4\n\n  grid(\n    stroke: (paint: silver, thickness: 0.5pt, dash: \"dashed\"),\n    columns: (1fr,) * ncols,\n    rows: (1fr,) * nrows,\n    row-gutter: 0cm,\n    ..authors.map(author =&gt; author-box([\n         #author.name \\\n         #author.affiliation \\\n         #author.email\n    ]))\n  )\n}\n\n// values\n#show: doc =&gt; conf(\n  authors: (\n    (\n      name: \"Olivia Sterling\",\n      affiliation: \"Quantum Research Institute\",\n      email: \"o.sterling@quantumri.edu\",\n    ),\n    (\n      name: \"Marcus Finnegan\",\n      affiliation: \"Tech Innovators Corp\",\n      email: \"m.finnegan@techinnovators.com\",\n    ),\n    (\n      name: \"Ariella Knox\",\n      affiliation: \"Global Solutions Inc.\",\n      email: \"a.knox@globalsolutions.com\",\n    ),\n    (\n      name: \"Theo Jansen\",\n      affiliation: \"Netherlands Technology Hub\",\n      email: \"t.jansen@nth.nl\",\n    ),\n    (\n      name: \"Leila Summers\",\n      affiliation: \"EcoLogic Research Foundation\",\n      email: \"l.summers@ecologic.org\",\n    ),\n    (\n      name: \"Jaxon Lee\",\n      affiliation: \"Australian Science Network\",\n      email: \"j.lee@australiascience.net.au\",\n    )\n  ),\n  doc,\n)\n</code></pre>",
      "raw": "Thank you! This has been very helpful. I have adjusted the grid so that the logos are organized better.\n\n![Screenshot 2024-12-30 at 13.33.24|408x500](upload://nsWsO9B0WnxdS3hNtPIFzthisfw.jpeg)\n\n```typ\n// template\n#set page(\n  height: 22cm, \n  width: 18cm,\n  margin: (left: 0cm, right: 0cm, top: 0cm, bottom: 0cm)\n)\n#set text(16pt, font: \"Barlow\", fill: rgb(\"#444444\"))\n#let author-box(content) = block(\n  pad(0.3cm,\n    grid(\n      columns: 1fr, \n      rows: (1fr, 8fr),\n      grid(\n        columns: (1fr, 1fr),\n        rows: 1fr,\n        align(left,\n          image(\"images/logo1.png\", height: 0.7cm)\n        ),\n        align(right,\n          image(\"images/logo2.png\", height: 0.6cm)\n        ),\n      ),\n      align(center + horizon, content)\n    )\n  )\n)\n\n#let conf(\n  authors: (),\n  doc,\n) = {\n  let count = authors.len()\n  let ncols = 2\n  let nrows = 4\n\n  grid(\n    stroke: (paint: silver, thickness: 0.5pt, dash: \"dashed\"),\n    columns: (1fr,) * ncols,\n    rows: (1fr,) * nrows,\n    row-gutter: 0cm,\n    ..authors.map(author => author-box([\n         #author.name \\\n         #author.affiliation \\\n         #author.email\n    ]))\n  )\n}\n\n// values\n#show: doc => conf(\n  authors: (\n    (\n      name: \"Olivia Sterling\",\n      affiliation: \"Quantum Research Institute\",\n      email: \"o.sterling@quantumri.edu\",\n    ),\n    (\n      name: \"Marcus Finnegan\",\n      affiliation: \"Tech Innovators Corp\",\n      email: \"m.finnegan@techinnovators.com\",\n    ),\n    (\n      name: \"Ariella Knox\",\n      affiliation: \"Global Solutions Inc.\",\n      email: \"a.knox@globalsolutions.com\",\n    ),\n    (\n      name: \"Theo Jansen\",\n      affiliation: \"Netherlands Technology Hub\",\n      email: \"t.jansen@nth.nl\",\n    ),\n    (\n      name: \"Leila Summers\",\n      affiliation: \"EcoLogic Research Foundation\",\n      email: \"l.summers@ecologic.org\",\n    ),\n    (\n      name: \"Jaxon Lee\",\n      affiliation: \"Australian Science Network\",\n      email: \"j.lee@australiascience.net.au\",\n    )\n  ),\n  doc,\n)\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 14,
      "score": 12.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 989
    },
    {
      "id": 7062,
      "post_number": 5,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-30T13:25:26.711Z",
      "updated_at": "2024-12-30T13:25:26.711Z",
      "cooked": "<p>Great! A few notes regarding your solution:</p>\n<ul>\n<li>instead of putting a pad element within your block, you could probably also use <code>block.inset</code>.</li>\n<li>if you wanted, you could use the <a href=\"https://typst.app/docs/reference/layout/grid/#definitions-cell-colspan\">colspan</a> property to do the same with a single grid</li>\n<li>if you want to have the upper grid take exactly the space needed by the images, you can make the first row‚Äôs height <code>auto</code>. As long as at least one row (and column) has a <code>fr</code> size, the grid will occupy the whole height/width.</li>\n</ul>",
      "raw": "Great! A few notes regarding your solution:\n\n- instead of putting a pad element within your block, you could probably also use `block.inset`.\n- if you wanted, you could use the [colspan](https://typst.app/docs/reference/layout/grid/#definitions-cell-colspan) property to do the same with a single grid\n- if you want to have the upper grid take exactly the space needed by the images, you can make the first row's height `auto`. As long as at least one row (and column) has a `fr` size, the grid will occupy the whole height/width.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 14,
      "score": 17.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:53:21.230223"
}
{
  "topic_metadata": {
    "id": 2241,
    "title": "How can I create a header with a line under the content?",
    "slug": "how-can-i-create-a-header-with-a-line-under-the-content",
    "posts_count": 6,
    "created_at": "2024-12-29T20:37:11.037Z",
    "last_posted_at": "2024-12-31T15:38:03.683Z",
    "views": 563,
    "like_count": 0,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "layout",
      "header-footer"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 589
  },
  "posts": [
    {
      "id": 7038,
      "post_number": 1,
      "username": "Alberto1",
      "name": "",
      "created_at": "2024-12-29T20:37:11.198Z",
      "updated_at": "2024-12-29T23:55:52.223Z",
      "cooked": "<p>Good morning to everyone, I would like to create a header with a text on the left, page number on the right and a line below, I tried for some days but couldn‚Äôt‚Ä¶ I managed to write text and page number but not the line or only the line, but not both. Please help</p>",
      "raw": "Good morning to everyone, I would like to create a header with a text on the left, page number on the right and a line below, I tried for some days but couldn't... I managed to write text and page number but not the line or only the line, but not both. Please help",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 46,
      "score": 2294.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 990
    },
    {
      "id": 7043,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-29T23:57:43.290Z",
      "updated_at": "2024-12-29T23:57:43.290Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/alberto1\">@Alberto1</a>, welcome and thank you for your question! I have changed your post‚Äôs title to bring it in line with the <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">question guidelines</a> and thus make it easier to find in the future:</p>\n<blockquote>\n<p><strong>Good titles are questions you would ask your friend about Typst.</strong></p>\n</blockquote>\n<p>I also added the <a class=\"hashtag-cooked\" href=\"/tag/header-footer\" data-type=\"tag\" data-slug=\"header-footer\" data-id=\"135\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>header-footer</span></a> tag.</p>",
      "raw": "Hi @Alberto1, welcome and thank you for your question! I have changed your post‚Äôs title to bring it in line with the [question guidelines](https://forum.typst.app/t/how-to-post-in-the-questions-category/11) and thus make it easier to find in the future:\n\n> **Good titles are questions you would ask your friend about Typst.**\n\nI also added the #header-footer tag.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 45,
      "score": 64.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7056,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-30T11:02:16.691Z",
      "updated_at": "2024-12-30T11:02:16.691Z",
      "cooked": "<p>The most common way would be to use a grid for that:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(\n  header: {\n    grid(\n      // this grid fills the whole width of the header\n      columns: (1fr, 1fr),\n      // the left and right content are aligned correctly\n      align: (left, right),\n      [left],\n      [right],\n      // under the first and only row, there's a line\n      grid.hline(),\n    )    \n  },\n)\n</code></pre>\n<p>This is of course only a very basic example; you‚Äôll need to set the <a href=\"https://typst.app/docs/reference/layout/grid/#parameters-inset\">inset</a> so that the line does not overlap the text, and the <a href=\"https://typst.app/docs/reference/introspection/counter/#page-counter\">page counter</a> for the page number.</p>",
      "raw": "The most common way would be to use a grid for that:\n\n```typ\n#set page(\n  header: {\n    grid(\n      // this grid fills the whole width of the header\n      columns: (1fr, 1fr),\n      // the left and right content are aligned correctly\n      align: (left, right),\n      [left],\n      [right],\n      // under the first and only row, there's a line\n      grid.hline(),\n    )    \n  },\n)\n```\n\nThis is of course only a very basic example; you'll need to set the [inset](https://typst.app/docs/reference/layout/grid/#parameters-inset) so that the line does not overlap the text, and the [page counter](https://typst.app/docs/reference/introspection/counter/#page-counter) for the page number.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 46,
      "score": 39.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7065,
      "post_number": 4,
      "username": "Alberto1",
      "name": "",
      "created_at": "2024-12-30T16:20:11.996Z",
      "updated_at": "2024-12-30T16:22:26.424Z",
      "cooked": "<p>Thank you but this way the text size is the same of the first letter of the main text, I would like to set it at 10pt and write the main text with a different size. Some time ago it worked this way but now it doesn‚Äôt, I don‚Äôt know way but I have the same problem:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(header: context [Chapter 1 #h(1fr) #counter(page).display(\"1\")] + line(length: 100%))\n</code></pre>",
      "raw": "Thank you but this way the text size is the same of the first letter of the main text, I would like to set it at 10pt and write the main text with a different size. Some time ago it worked this way but now it doesn't, I don't know way but I have the same problem:\n```typ\n#set page(header: context [Chapter 1 #h(1fr) #counter(page).display(\"1\")] + line(length: 100%))\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 42,
      "score": 28.4,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 990
    },
    {
      "id": 7066,
      "post_number": 5,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-30T16:38:42.084Z",
      "updated_at": "2024-12-30T16:38:42.084Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Alberto1\" data-post=\"4\" data-topic=\"2241\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/a/8F38B1/48.png\" class=\"avatar\"> Alberto1:</div>\n<blockquote>\n<p>Thank you but this way the text size is the same of the first letter of the main text, I would like to set it at 10pt and write the main text with a different size.</p>\n</blockquote>\n</aside>\n<p>I think that just means that you need to set the header‚Äôs font size. If you write e.g.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(header: [...])\n\n#set text(20pt)\n\n...\n</code></pre>\n<p>The header will just be 20pt tall, because the whole document (or the whole run of pages) has that font size. There used to be <a href=\"https://github.com/typst/typst/issues/241\">a bug</a> that would resolve header and footer styles incorrectly, but that <a href=\"https://github.com/typst/typst/pull/4840\">was fixed</a>. For example:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(header: [...])\n\n#lorem(40)\n\n#set text(20pt)\n\n// long enough to go to the next page\n#lorem(1000)\n</code></pre>\n<p>In earlier versions, that would have used different font sizes for the headers on different pages ‚Äì maybe you relied on that?</p>\n<aside class=\"quote no-group\" data-username=\"Alberto1\" data-post=\"4\" data-topic=\"2241\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/a/8F38B1/48.png\" class=\"avatar\"> Alberto1:</div>\n<blockquote>\n<p>Some time ago it worked this way but now it doesn‚Äôt, I don‚Äôt know way but I have the same problem:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(header: context [Chapter 1 #h(1fr) #counter(page).display(\"1\")] + line(length: 100%))\n</code></pre>\n</blockquote>\n</aside>\n<p>That works too, and what I wrote applies to it too. You just need to set the font size directly if it‚Äôs not what you want:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(header: context {\n  set text(10pt)\n  [Chapter 1 #h(1fr) #counter(page).display(\"1\")]\n  line(length: 100%)\n})\n</code></pre>\n<p>As an aside, it‚Äôs always good to include information like that in the original post, and what about it doesn‚Äôt work.</p>",
      "raw": "[quote=\"Alberto1, post:4, topic:2241\"]\nThank you but this way the text size is the same of the first letter of the main text, I would like to set it at 10pt and write the main text with a different size.\n[/quote]\n\nI think that just means that you need to set the header's font size. If you write e.g.\n\n```typ\n#set page(header: [...])\n\n#set text(20pt)\n\n...\n```\n\nThe header will just be 20pt tall, because the whole document (or the whole run of pages) has that font size. There used to be [a bug](https://github.com/typst/typst/issues/241) that would resolve header and footer styles incorrectly, but that [was fixed](https://github.com/typst/typst/pull/4840). For example:\n\n```typ\n#set page(header: [...])\n\n#lorem(40)\n\n#set text(20pt)\n\n// long enough to go to the next page\n#lorem(1000)\n```\n\nIn earlier versions, that would have used different font sizes for the headers on different pages -- maybe you relied on that?\n\n[quote=\"Alberto1, post:4, topic:2241\"]\nSome time ago it worked this way but now it doesn‚Äôt, I don‚Äôt know way but I have the same problem:\n\n```typ\n#set page(header: context [Chapter 1 #h(1fr) #counter(page).display(\"1\")] + line(length: 100%))\n```\n[/quote]\n\nThat works too, and what I wrote applies to it too. You just need to set the font size directly if it's not what you want:\n\n```typ\n#set page(header: context {\n  set text(10pt)\n  [Chapter 1 #h(1fr) #counter(page).display(\"1\")]\n  line(length: 100%)\n})\n```\n\nAs an aside, it's always good to include information like that in the original post, and what about it doesn't work.",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 42,
      "score": 58.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7099,
      "post_number": 6,
      "username": "Alberto1",
      "name": "",
      "created_at": "2024-12-31T15:38:03.683Z",
      "updated_at": "2024-12-31T15:38:03.683Z",
      "cooked": "<p>This is the solution! Thank you very much!</p>",
      "raw": "This is the solution! Thank you very much!",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 26.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 990
    }
  ],
  "scraped_at": "2025-06-10T09:53:20.414987"
}
{
  "topic_metadata": {
    "id": 2244,
    "title": "Possible to import file body without style?",
    "slug": "possible-to-import-file-body-without-style",
    "posts_count": 5,
    "created_at": "2024-12-29T22:48:16.137Z",
    "last_posted_at": "2024-12-30T20:40:02.173Z",
    "views": 84,
    "like_count": 3,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 520
  },
  "posts": [
    {
      "id": 7041,
      "post_number": 1,
      "username": "gabe",
      "name": "",
      "created_at": "2024-12-29T22:48:16.289Z",
      "updated_at": "2024-12-30T14:19:01.274Z",
      "cooked": "<p>I‚Äôm stuck in a situation where I want to be able to access the body of a file in other files without certain styling /show rules, but I can only see two options.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let note = (\n  meta: (\n    name: \"note1\",\n    uuid: \"rupiv\",\n  ),\n  body: [\n    Note contents\n  ],\n)\n#apply-style-and-display(note)\n</code></pre>\n<p>then, in the file where I want to use the body for other things,</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"note.typ\": note\n// do stuff\n</code></pre>\n<p>.<br>\nThe other option would be:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let meta = (\n    name: \"note1\",\n    uuid: \"rupiv\",\n)\n\nNote contents\n</code></pre>\n<p>then to render the single-note file,</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"note.typ\": meta\n#let body = include(\"note.typ\")\n#apply-style-and-display((meta: meta, body: body))\n</code></pre>\n<p>and to use the note for other things,</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"note.typ\": meta\n#let body = include(\"note.typ\")\n// do stuff\n</code></pre>\n<p>.<br>\nThe ergonomics of both suck. The pattern I‚Äôm looking to create would be something like:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let meta = (\n    name: \"note1\",\n    uuid: \"rupiv\",\n)\n#show: apply-style.with(meta)\n\nNote contents\n</code></pre>\n<p>then to use the note for other things,</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"note.typ\": meta, body-without-style\n</code></pre>\n<p>Unfortunately, I can‚Äôt find a way to only apply the style when the single note is being rendered rather than being imported/included without adding a bunch of boilerplate to the note itself.</p>",
      "raw": "I'm stuck in a situation where I want to be able to access the body of a file in other files without certain styling /show rules, but I can only see two options.\n\n```typ\n#let note = (\n  meta: (\n    name: \"note1\",\n    uuid: \"rupiv\",\n  ),\n  body: [\n    Note contents\n  ],\n)\n#apply-style-and-display(note)\n```\nthen, in the file where I want to use the body for other things,\n```typ\n#import \"note.typ\": note\n// do stuff\n```\n.\nThe other option would be:\n\n```typ\n#let meta = (\n    name: \"note1\",\n    uuid: \"rupiv\",\n)\n\nNote contents\n```\nthen to render the single-note file,\n```typ\n#import \"note.typ\": meta\n#let body = include(\"note.typ\")\n#apply-style-and-display((meta: meta, body: body))\n```\nand to use the note for other things,\n```typ\n#import \"note.typ\": meta\n#let body = include(\"note.typ\")\n// do stuff\n```\n.\nThe ergonomics of both suck. The pattern I'm looking to create would be something like:\n\n```typ\n#let meta = (\n    name: \"note1\",\n    uuid: \"rupiv\",\n)\n#show: apply-style.with(meta)\n\nNote contents\n```\nthen to use the note for other things,\n```typ\n#import \"note.typ\": meta, body-without-style\n```\n\nUnfortunately, I can't find a way to only apply the style when the single note is being rendered rather than being imported/included without adding a bunch of boilerplate to the note itself.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 141.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 433
    },
    {
      "id": 7042,
      "post_number": 2,
      "username": "gabe",
      "name": "",
      "created_at": "2024-12-29T22:52:11.575Z",
      "updated_at": "2024-12-29T22:52:29.384Z",
      "cooked": "<p>If there were some way for show rules to return ‚Äúit‚Äù, then this pattern would be easy. Just,</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let meta = (\n    name: \"note1\",\n    uuid: \"rupiv\",\n)\n#let body = show: it =&gt; apply-style(meta, it) // returning \"it\" somehow\n\nNote contents\n</code></pre>",
      "raw": "If there were some way for show rules to return \"it\", then this pattern would be easy. Just,\n\n```typ\n#let meta = (\n    name: \"note1\",\n    uuid: \"rupiv\",\n)\n#let body = show: it => apply-style(meta, it) // returning \"it\" somehow\n\nNote contents\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 4.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 433
    },
    {
      "id": 7064,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-30T14:45:56.839Z",
      "updated_at": "2024-12-30T20:40:30.768Z",
      "cooked": "<p>If I understand your requirements correctly, the following solves the problem:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let meta = (\n    name: \"note1\",\n    uuid: \"rupiv\",\n)\n// this has to be a function. If it wasn't,\n// there'd be a cyclic import preventing this from working\n#let body() = {\n  let body = include \"note.typ\"\n\n  // the whole file is a sequence, and the last item is what\n  // the `show: ...` rule makes out of the actual content\n  let body = body.children.last()\n  // we can assure that the first item in that sequence\n  // will be a metadata element containing the raw body\n  let body = body.children.first().value\n\n  body\n}\n\n#show: body =&gt; {\n  // this has to be the first thing\n  // be sure to use `{...}` instead of `[...]` to avoid spaces\n  metadata(body)\n  [= Note]\n  set text(red)\n  body\n}\n\nNote contents\n</code></pre>\n<p>&nbsp;</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"note.typ\": meta, body\n\n#include \"note.typ\"\n\n#body()\n</code></pre>\n<p>I tried to use an example show rule that is sufficiently complex (it styles and also adds content to the raw body). That means that the actual raw body could be nested deep inside what the show rule produces, but by placing some metadata in the beginning we can circumvent any complications and (hopefully) reliably find the raw content.</p>",
      "raw": "If I understand your requirements correctly, the following solves the problem:\n\n```typ\n#let meta = (\n    name: \"note1\",\n    uuid: \"rupiv\",\n)\n// this has to be a function. If it wasn't,\n// there'd be a cyclic import preventing this from working\n#let body() = {\n  let body = include \"note.typ\"\n\n  // the whole file is a sequence, and the last item is what\n  // the `show: ...` rule makes out of the actual content\n  let body = body.children.last()\n  // we can assure that the first item in that sequence\n  // will be a metadata element containing the raw body\n  let body = body.children.first().value\n\n  body\n}\n\n#show: body => {\n  // this has to be the first thing\n  // be sure to use `{...}` instead of `[...]` to avoid spaces\n  metadata(body)\n  [= Note]\n  set text(red)\n  body\n}\n\nNote contents\n```\n\n&nbsp;\n\n```typ\n#import \"note.typ\": meta, body\n\n#include \"note.typ\"\n\n#body()\n```\n\nI tried to use an example show rule that is sufficiently complex (it styles and also adds content to the raw body). That means that the actual raw body could be nested deep inside what the show rule produces, but by placing some metadata in the beginning we can circumvent any complications and (hopefully) reliably find the raw content.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 20,
      "score": 39.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7074,
      "post_number": 4,
      "username": "gabe",
      "name": "",
      "created_at": "2024-12-30T20:37:10.389Z",
      "updated_at": "2024-12-30T20:37:10.389Z",
      "cooked": "<p>Ooh, that‚Äôs exactly it. I hadn‚Äôt explored methods on content and assumed that it was just a black box. But being able to explore everything within a content opens up so many things. Thanks for the pointer.</p>",
      "raw": "Ooh, that's exactly it. I hadn't explored methods on content and assumed that it was just a black box. But being able to explore everything within a content opens up so many things. Thanks for the pointer.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 8.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 433
    },
    {
      "id": 7075,
      "post_number": 5,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-30T20:40:02.173Z",
      "updated_at": "2024-12-30T20:40:02.173Z",
      "cooked": "<p>You‚Äôre welcome! definitely look at the <code>repr()</code> function, or simply call <code>func()</code> and <code>fields()</code> methods to find what‚Äôs inside a piece of <a href=\"https://typst.app/docs/reference/foundations/content/\">content</a>, it can help with exploring your options.</p>",
      "raw": "You're welcome! definitely look at the `repr()` function, or simply call `func()` and `fields()` methods to find what's inside a piece of [content](https://typst.app/docs/reference/foundations/content/), it can help with exploring your options.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 16,
      "score": 18.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:53:19.672283"
}
{
  "topic_metadata": {
    "id": 2251,
    "title": "Touying: How to set full page image background in slides?",
    "slug": "touying-how-to-set-full-page-image-background-in-slides",
    "posts_count": 7,
    "created_at": "2024-12-30T21:12:57.314Z",
    "last_posted_at": "2025-02-06T23:21:11.704Z",
    "views": 424,
    "like_count": 2,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "baptiste",
    "tags": [
      "touying"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 378
  },
  "posts": [
    {
      "id": 7076,
      "post_number": 1,
      "username": "baptiste",
      "name": "baptiste",
      "created_at": "2024-12-30T21:12:57.446Z",
      "updated_at": "2025-01-01T19:25:23.704Z",
      "cooked": "<p>I‚Äôm thinking of moving from Beamer to Touying for my lecture slides, but I first want to check that I can do everything I need. The first thing I‚Äôve not figured out is how to include a custom image as a slide background ‚Äì any idea? Would I need to make a custom theme with a custom slide type?</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/4/469d601a3a9bb7e24ea9b1953bf043ce58aa4424.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/469d601a3a9bb7e24ea9b1953bf043ce58aa4424\" title=\"Untitled.001\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/4/469d601a3a9bb7e24ea9b1953bf043ce58aa4424_2_690x388.jpeg\" alt=\"Untitled.001\" data-base62-sha1=\"a4GB5mZcp3vSMTdwi1hO4rij1go\" width=\"690\" height=\"388\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/4/469d601a3a9bb7e24ea9b1953bf043ce58aa4424_2_690x388.jpeg, https://forum.typst.app/uploads/default/optimized/2X/4/469d601a3a9bb7e24ea9b1953bf043ce58aa4424_2_1035x582.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/4/469d601a3a9bb7e24ea9b1953bf043ce58aa4424_2_1380x776.jpeg 2x\" data-dominant-color=\"C3B096\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Untitled.001</span><span class=\"informations\">1920√ó1080 251 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/7/72c0e7a31aca850a3dbd153c833b99782f4d5365.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/72c0e7a31aca850a3dbd153c833b99782f4d5365\" title=\"froggy\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/7/72c0e7a31aca850a3dbd153c833b99782f4d5365_2_690x388.jpeg\" alt=\"froggy\" data-base62-sha1=\"gn9J9H8ObfCFGBbeXDEL3MR3dbf\" width=\"690\" height=\"388\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/7/72c0e7a31aca850a3dbd153c833b99782f4d5365_2_690x388.jpeg, https://forum.typst.app/uploads/default/optimized/2X/7/72c0e7a31aca850a3dbd153c833b99782f4d5365_2_1035x582.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/7/72c0e7a31aca850a3dbd153c833b99782f4d5365_2_1380x776.jpeg 2x\" data-dominant-color=\"CAB395\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">froggy</span><span class=\"informations\">1920√ó1080 86.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "I'm thinking of moving from Beamer to Touying for my lecture slides, but I first want to check that I can do everything I need. The first thing I've not figured out is how to include a custom image as a slide background ‚Äì any idea? Would I need to make a custom theme with a custom slide type?\n\n![Untitled.001|690x388](upload://a4GB5mZcp3vSMTdwi1hO4rij1go.jpeg)\n\n![froggy|690x388](upload://gn9J9H8ObfCFGBbeXDEL3MR3dbf.jpeg)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 51,
      "score": 1445.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 85
    },
    {
      "id": 7129,
      "post_number": 2,
      "username": "DrLoiseau",
      "name": "LVG",
      "created_at": "2025-01-01T18:44:05.646Z",
      "updated_at": "2025-01-01T18:44:05.646Z",
      "cooked": "<p>Hey,<br>\nyou can just use the background argument in a set page() rule, like this :</p>\n<pre><code class=\"lang-auto\">#set page(background: image(\"images/biere.jpg\"))\n</code></pre>\n<p>Placing this at the beginning of your document will place the image in the background for all your slides (in my case, two glasses of beer).</p>\n<p>Cheers !</p>",
      "raw": "Hey,\nyou can just use the background argument in a set page() rule, like this : \n```\n#set page(background: image(\"images/biere.jpg\"))\n```\nPlacing this at the beginning of your document will place the image in the background for all your slides (in my case, two glasses of beer).\n\nCheers !",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 44,
      "score": 13.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 537
    },
    {
      "id": 7130,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-01-01T19:26:05.253Z",
      "updated_at": "2025-01-01T19:26:05.253Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/baptiste\">@baptiste</a>! I‚Äôve moved your post to the <a class=\"hashtag-cooked\" href=\"/c/questions/5\" data-type=\"category\" data-slug=\"questions\" data-id=\"5\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>Questions</span></a> category, as it is a question. I‚Äôve also changed your question post‚Äôs title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you‚Äôd ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @baptiste! I‚Äôve moved your post to the #questions category, as it is a question. I've also changed your question post‚Äôs title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you‚Äôd ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 44,
      "score": 18.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 7133,
      "post_number": 4,
      "username": "baptiste",
      "name": "baptiste",
      "created_at": "2025-01-01T19:31:14.482Z",
      "updated_at": "2025-01-01T19:32:31.727Z",
      "cooked": "<p>Thanks, but my question is more to use an image on one slide in particular, where I don‚Äôt think this works?</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/3/3688dfca963c3c78df1db082084ebad561639c56.png\" data-download-href=\"https://forum.typst.app/uploads/default/3688dfca963c3c78df1db082084ebad561639c56\" title=\"Screenshot 2025-01-02 at 08.29.57\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/3/3688dfca963c3c78df1db082084ebad561639c56_2_690x352.png\" alt=\"Screenshot 2025-01-02 at 08.29.57\" data-base62-sha1=\"7Mr2avPU9vPjTuYooKmnK4AM5sW\" width=\"690\" height=\"352\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/3/3688dfca963c3c78df1db082084ebad561639c56_2_690x352.png, https://forum.typst.app/uploads/default/optimized/2X/3/3688dfca963c3c78df1db082084ebad561639c56_2_1035x528.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/3/3688dfca963c3c78df1db082084ebad561639c56_2_1380x704.png 2x\" data-dominant-color=\"F0F1F4\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2025-01-02 at 08.29.57</span><span class=\"informations\">2922√ó1494 394 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "Thanks, but my question is more to use an image on one slide in particular, where I don't think this works?\n\n![Screenshot 2025-01-02 at 08.29.57|690x352](upload://7Mr2avPU9vPjTuYooKmnK4AM5sW.png)",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 46,
      "score": 34.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 85
    },
    {
      "id": 7139,
      "post_number": 5,
      "username": "baptiste",
      "name": "baptiste",
      "created_at": "2025-01-01T21:17:27.348Z",
      "updated_at": "2025-01-31T10:28:26.408Z",
      "cooked": "<p>I‚Äôm guessing I would have to create a custom slide type like so:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let image-slide(body, background: none) = touying-slide-wrapper(self =&gt; {\n  self = utils.merge-dicts(\n    self,\n    config-page(\n      background: background,\n      margin: 2em,\n    ),\n  )\n  set text(fill: self.colors.neutral-lightest, size: 2em)\n  set image(width: 100%,height: auto)\n  touying-slide(self: self, align(horizon + center, body))\n})\n\n</code></pre>\n<p>and then call it with</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#image-slide(background:image(\"bkg.jpg\"))[\n  #place[Focus on it!]\n]\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/8f6797de63a6c680c71aa8d7f98fb9e1949cae69.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/8f6797de63a6c680c71aa8d7f98fb9e1949cae69\" title=\"Screenshot 2025-01-02 at 10.16.46\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/8f6797de63a6c680c71aa8d7f98fb9e1949cae69_2_690x344.jpeg\" alt=\"Screenshot 2025-01-02 at 10.16.46\" data-base62-sha1=\"ksCdZPd1nU4WQQJHFHJa90FZtJD\" width=\"690\" height=\"344\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/8/8f6797de63a6c680c71aa8d7f98fb9e1949cae69_2_690x344.jpeg, https://forum.typst.app/uploads/default/optimized/2X/8/8f6797de63a6c680c71aa8d7f98fb9e1949cae69_2_1035x516.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/8/8f6797de63a6c680c71aa8d7f98fb9e1949cae69_2_1380x688.jpeg 2x\" data-dominant-color=\"D3D6CB\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2025-01-02 at 10.16.46</span><span class=\"informations\">1920√ó958 75.4 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "I'm guessing I would have to create a custom slide type like so:\n\n```typ\n#let image-slide(body, background: none) = touying-slide-wrapper(self => {\n  self = utils.merge-dicts(\n    self,\n    config-page(\n      background: background,\n      margin: 2em,\n    ),\n  )\n  set text(fill: self.colors.neutral-lightest, size: 2em)\n  set image(width: 100%,height: auto)\n  touying-slide(self: self, align(horizon + center, body))\n})\n\n```\n\nand then call it with\n\n```typ\n#image-slide(background:image(\"bkg.jpg\"))[\n  #place[Focus on it!]\n]\n```\n\n![Screenshot 2025-01-02 at 10.16.46|690x344](upload://ksCdZPd1nU4WQQJHFHJa90FZtJD.jpeg)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 41,
      "score": 48.2,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 85
    },
    {
      "id": 8060,
      "post_number": 6,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-31T10:50:32.829Z",
      "updated_at": "2025-01-31T10:50:32.829Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/baptiste\">@baptiste</a> were you able to solve your complete problem or is there anything left? If the issue is solved, please mark your own reply as the answer using the <img src=\"https://forum.typst.app/images/emoji/apple/white_check_mark.png?v=12\" title=\":white_check_mark:\" class=\"emoji\" alt=\":white_check_mark:\" loading=\"lazy\" width=\"20\" height=\"20\"> button, so that it‚Äôs easier to find. Thanks!</p>",
      "raw": "Hi @baptiste were you able to solve your complete problem or is there anything left? If the issue is solved, please mark your own reply as the answer using the :white_check_mark: button, so that it's easier to find. Thanks!",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 14.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 8282,
      "post_number": 7,
      "username": "baptiste",
      "name": "baptiste",
      "created_at": "2025-02-06T23:21:11.704Z",
      "updated_at": "2025-02-06T23:21:11.704Z",
      "cooked": "<p>It works I guess, but I was kind of hoping for a canonical answer, as this seems a very basic question about slides, and I‚Äôve used Touying for just a few minutes in total.</p>",
      "raw": "It works I guess, but I was kind of hoping for a canonical answer, as this seems a very basic question about slides, and I've used Touying for just a few minutes in total.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 18,
      "score": 28.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 85
    }
  ],
  "scraped_at": "2025-06-10T09:53:18.872440"
}
{
  "topic_metadata": {
    "id": 2253,
    "title": "How can I create a decorative bar by repeating an image?",
    "slug": "how-can-i-create-a-decorative-bar-by-repeating-an-image",
    "posts_count": 5,
    "created_at": "2024-12-30T21:36:58.833Z",
    "last_posted_at": "2025-01-01T15:43:14.290Z",
    "views": 126,
    "like_count": 1,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "Olaf",
    "tags": [
      "scripting",
      "graphics"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 240
  },
  "posts": [
    {
      "id": 7079,
      "post_number": 1,
      "username": "Olaf",
      "name": "Olaf",
      "created_at": "2024-12-30T21:36:58.952Z",
      "updated_at": "2024-12-30T21:36:58.952Z",
      "cooked": "<p>I would like to display a decorative bar in the header of my document. I have a small image that I want to render multiple times next to each other to create a horizontal image bar. I know that Typst has a For loop, but I don‚Äôt realise how to apply this to my problem. When do I know when I can stop because the right edge has been reached?</p>",
      "raw": "I would like to display a decorative bar in the header of my document. I have a small image that I want to render multiple times next to each other to create a horizontal image bar. I know that Typst has a For loop, but I don't realise how to apply this to my problem. When do I know when I can stop because the right edge has been reached?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 146.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 418
    },
    {
      "id": 7080,
      "post_number": 2,
      "username": "Mathemensch",
      "name": "Alexander Schulz",
      "created_at": "2024-12-30T23:41:58.923Z",
      "updated_at": "2024-12-30T23:41:58.923Z",
      "cooked": "<p>I guess the pattern function could help you.<br>\nI had a very similar question:</p>\n<aside class=\"quote quote-modified\" data-post=\"1\" data-topic=\"370\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/mathemensch/48/286_2.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/how-to-use-a-pattern-image-as-the-page-background/370\">How to use a pattern image as the page background?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    I am currently creating some worksheets for exciting, context-orientated lessons. \nI have an image that I would like to use as the background for these documents. The image is a seamless pattern, so I would like to repeat it in the background instead of stretching it across the entire width. Is there a good way to repeat a background like a cache? \nSo far I am stretching the background to the full height and width of the document. However, as the document gets longer, the quality gets worse and ‚Ä¶\n  </blockquote>\n</aside>\n",
      "raw": "I guess the pattern function could help you. \nI had a very similar question:\n\nhttps://forum.typst.app/t/how-to-use-a-pattern-image-as-the-page-background/370",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 11.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 307
    },
    {
      "id": 7087,
      "post_number": 3,
      "username": "sijo",
      "name": "",
      "created_at": "2024-12-31T13:06:05.966Z",
      "updated_at": "2024-12-31T13:06:05.966Z",
      "cooked": "<p>This sounds like a job for the <a href=\"https://typst.app/docs/reference/layout/repeat/\"><code>repeat</code></a> function <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "This sounds like a job for the [`repeat`](https://typst.app/docs/reference/layout/repeat/) function :slight_smile:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 5.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 7095,
      "post_number": 4,
      "username": "Olaf",
      "name": "Olaf",
      "created_at": "2024-12-31T14:35:40.763Z",
      "updated_at": "2024-12-31T14:35:40.763Z",
      "cooked": "<p>The hint to the pattern function helped me:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let tile = image(\n  \"./images/ornament.png\",\n  height: 8mm\n)\n\n#let tile_pattern = pattern(tile)\n\n#rect(\n  width: 100%, \n  height: 8mm,\n  fill: tile_pattern\n)\n</code></pre>",
      "raw": "The hint to the pattern function helped me:\n\n```typ\n#let tile = image(\n  \"./images/ornament.png\",\n  height: 8mm\n)\n\n#let tile_pattern = pattern(tile)\n\n#rect(\n  width: 100%, \n  height: 8mm,\n  fill: tile_pattern\n)\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 27,
      "score": 25.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 418
    },
    {
      "id": 7122,
      "post_number": 5,
      "username": "Olaf",
      "name": "Olaf",
      "created_at": "2025-01-01T15:43:14.290Z",
      "updated_at": "2025-01-01T15:43:14.290Z",
      "cooked": "<p>The pattern function caused difficulties. The tile was repeated correctly in the header. Unfortunately, this only worked on every second page in the footer. The title was shifted on the faulty pages. After a lot of trial and error, I was able to find a solution based on the repeat function:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let ornament = repeat(\n  justify: false,\n  image(\"./images/ornament.png\", height: 15mm),\n)\n\n#set page(\n  flipped: true,\n  margin: (top: 21mm, bottom: 21mm, left: 5mm, right: 5mm),\n  header: align(top, pad(x: -10mm, top: 2mm, ornament)),\n  footer: align(bottom, pad(x: -10mm, bottom: 2mm, ornament)),\n)\n</code></pre>",
      "raw": "The pattern function caused difficulties. The tile was repeated correctly in the header. Unfortunately, this only worked on every second page in the footer. The title was shifted on the faulty pages. After a lot of trial and error, I was able to find a solution based on the repeat function:\n\n```typ\n#let ornament = repeat(\n  justify: false,\n  image(\"./images/ornament.png\", height: 15mm),\n)\n\n#set page(\n  flipped: true,\n  margin: (top: 21mm, bottom: 21mm, left: 5mm, right: 5mm),\n  header: align(top, pad(x: -10mm, top: 2mm, ornament)),\n  footer: align(bottom, pad(x: -10mm, bottom: 2mm, ornament)),\n)\n```",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 14.2,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 418
    }
  ],
  "scraped_at": "2025-06-10T09:53:18.142679"
}
{
  "topic_metadata": {
    "id": 2258,
    "title": "How to change the margin depending on the page number being even or odd?",
    "slug": "how-to-change-the-margin-depending-on-the-page-number-being-even-or-odd",
    "posts_count": 2,
    "created_at": "2024-12-31T13:30:21.821Z",
    "last_posted_at": "2024-12-31T13:59:20.680Z",
    "views": 153,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "layout",
      "page"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 253
  },
  "posts": [
    {
      "id": 7088,
      "post_number": 1,
      "username": "Alex",
      "name": "Alex",
      "created_at": "2024-12-31T13:30:21.973Z",
      "updated_at": "2024-12-31T20:57:05.140Z",
      "cooked": "<p>Hello<br>\nFor a project where i create a student song book, i need to apply different type of margin based on the fact that the page number is odd or even.<br>\nAt the moment i manually set the margin by passing parameters (here a dictionary) by value.<br>\nDue to the constraint on the page number i‚Äôm limited to use context function like this :</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">// in utils.typ\n#let set_margin_type() = context {\n  let page_num = here().position().at(\"page\")//counter(page).get().first()\n  let margin = value_odd_even(page_num, constant.odd_margin , constant.even_margin)\n}\n</code></pre>\n<p>is there a way to correctly do it such that i can do something like this :</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">// in format.typ\n#let formatable_song(\n  margin_type,\n  title,\n  body_list,\n  body_list_format,\n  header_tune : none,\n  header_tune_author : none,\n  header_lyrics : none,\n  header_lyrics_pseudo : none,\n  header_comments : none,\n) = { \n  set page(margin : MARGIN_DICT, footer: utils.get_footer_alignemnt())\n}\n  \n</code></pre>\n<p>For better context here‚Äôs my project, the file utils.typ, format.typ and main.typ are probably the most usefull:<br>\n<a href=\"https://typst.app/project/rxJdkxQZb6FrIuv59NVJxS\" class=\"onebox\" target=\"_blank\" rel=\"noopener\">https://typst.app/project/rxJdkxQZb6FrIuv59NVJxS</a></p>\n<p>Thank you in advance for your help</p>",
      "raw": "Hello\nFor a project where i create a student song book, i need to apply different type of margin based on the fact that the page number is odd or even. \nAt the moment i manually set the margin by passing parameters (here a dictionary) by value.\nDue to the constraint on the page number i'm limited to use context function like this : \n\n```typst\n// in utils.typ\n#let set_margin_type() = context {\n  let page_num = here().position().at(\"page\")//counter(page).get().first()\n  let margin = value_odd_even(page_num, constant.odd_margin , constant.even_margin)\n}\n```\nis there a way to correctly do it such that i can do something like this : \n```typst\n// in format.typ\n#let formatable_song(\n  margin_type,\n  title,\n  body_list,\n  body_list_format,\n  header_tune : none,\n  header_tune_author : none,\n  header_lyrics : none,\n  header_lyrics_pseudo : none,\n  header_comments : none,\n) = { \n  set page(margin : MARGIN_DICT, footer: utils.get_footer_alignemnt())\n}\n  \n```\n\nFor better context here's my project, the file utils.typ, format.typ and main.typ are probably the most usefull: \nhttps://typst.app/project/rxJdkxQZb6FrIuv59NVJxS\n\nThank you in advance for your help",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 37,
      "score": 547.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 987
    },
    {
      "id": 7092,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-12-31T13:59:20.680Z",
      "updated_at": "2024-12-31T13:59:20.680Z",
      "cooked": "<p>You can‚Äôt have arbitrary margins per page since Typst‚Äôs layout currently requires that all continuous containers have the same size (continuous: not divided by a page break) but if you just need to switch back-and-forth to account for binding, there‚Äôs a tool specifically for that: <a href=\"https://typst.app/docs/reference/layout/page/#parameters-margin\">margin</a> dicts can contain <code>inside</code> and <code>outside</code> keys that automatically flip each page.</p>\n<p>I think that would be sufficient for you; if not let me know what‚Äôs missing :)</p>",
      "raw": "You can't have arbitrary margins per page since Typst's layout currently requires that all continuous containers have the same size (continuous: not divided by a page break) but if you just need to switch back-and-forth to account for binding, there's a tool specifically for that: [margin](https://typst.app/docs/reference/layout/page/#parameters-margin) dicts can contain `inside` and `outside` keys that automatically flip each page.\n\nI think that would be sufficient for you; if not let me know what's missing :)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 33,
      "score": 41.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:53:17.371089"
}
{
  "topic_metadata": {
    "id": 2269,
    "title": "Is it possible to add a symbol when a line is broken in a raw block (code block)?",
    "slug": "is-it-possible-to-add-a-symbol-when-a-line-is-broken-in-a-raw-block-code-block",
    "posts_count": 3,
    "created_at": "2025-01-01T15:55:25.699Z",
    "last_posted_at": "2025-01-02T07:20:10.320Z",
    "views": 86,
    "like_count": 1,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "TheJanzap",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 89
  },
  "posts": [
    {
      "id": 7124,
      "post_number": 1,
      "username": "Electron_Wizard",
      "name": "Electron Wizard",
      "created_at": "2025-01-01T15:55:25.868Z",
      "updated_at": "2025-01-02T16:14:58.610Z",
      "cooked": "<p>Hello,</p>\n<p>Is it possible to define a symbol, which will be appended to a breakline (when the code line is too long and has to wrap to a new line)?</p>\n<p>As in the following image with the green arrows?<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/7/7d95957acc3bb1943ca9e4a58f272f79d2a436a4.png\" alt=\"image\" data-base62-sha1=\"hUYahvoBwPUwrg4ILIeiF3aabhG\" width=\"502\" height=\"105\"></p>\n<p>Any help is appreciated!</p>",
      "raw": "Hello,\n\nIs it possible to define a symbol, which will be appended to a breakline (when the code line is too long and has to wrap to a new line)?\n\nAs in the following image with the green arrows?\n![image|502x105](upload://hUYahvoBwPUwrg4ILIeiF3aabhG.png)\n\nAny help is appreciated!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 141.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 997
    },
    {
      "id": 7138,
      "post_number": 2,
      "username": "TheJanzap",
      "name": "",
      "created_at": "2025-01-01T21:02:09.267Z",
      "updated_at": "2025-01-01T21:02:09.267Z",
      "cooked": "<p>While this isn‚Äôt <em>exactly</em> what you want, the <a href=\"https://typst.app/universe/package/codly\">Codly</a> package can do something similar with its ‚ÄúSmart indentation‚Äù  feature.</p>",
      "raw": "While this isn't *exactly* what you want, the [Codly](https://typst.app/universe/package/codly) package can do something similar with its \"Smart indentation\"  feature.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 10.2,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 132
    },
    {
      "id": 7142,
      "post_number": 3,
      "username": "Electron_Wizard",
      "name": "Electron Wizard",
      "created_at": "2025-01-02T07:20:10.320Z",
      "updated_at": "2025-01-02T07:33:13.707Z",
      "cooked": "<p>This is lovely! Thank you very much. I might try to request such feature there!</p>",
      "raw": "This is lovely! Thank you very much. I might try to request such feature there!",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 4.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 997
    }
  ],
  "scraped_at": "2025-06-10T09:53:16.650758"
}
{
  "topic_metadata": {
    "id": 227,
    "title": "Touying: How can I access self in an ad-hoc way?",
    "slug": "touying-how-can-i-access-self-in-an-ad-hoc-way",
    "posts_count": 2,
    "created_at": "2024-09-15T16:24:48.522Z",
    "last_posted_at": "2024-09-15T17:47:04.707Z",
    "views": 186,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "scripting",
      "touying"
    ],
    "category_id": 5,
    "participant_count": 1,
    "word_count": 204
  },
  "posts": [
    {
      "id": 982,
      "post_number": 1,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-09-15T16:24:48.680Z",
      "updated_at": "2024-09-15T20:58:55.281Z",
      "cooked": "<p>I have a Touying (0.5.x) template that sets the table stroke in <code>init</code>:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">  config-methods(\n    init: (self: none, body) =&gt; {\n      set table(stroke: self.colors.neutral-dark)\n\n      body\n    },\n  ),\n</code></pre>\n<p>However in a table I don‚Äôt want strokes everywhere and have to use a <code>stroke</code> parameter like this:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">  table(\n    stroke: (x, y) =&gt; if x &lt; 2 and y &lt; 2 { 1pt },\n    [...],\n  )\n</code></pre>\n<p>This does not preserve the color, I need <code>1pt + self.colors.neutral-dark</code>. However, I don‚Äôt know how I can access <code>self</code> in a ‚Äúplain old slide‚Äù.</p>\n<p>I assume Touying must have a mechanism to get access to <code>self</code> in such cases. How does that work?</p>",
      "raw": "I have a Touying (0.5.x) template that sets the table stroke in `init`:\n\n```typc\n  config-methods(\n    init: (self: none, body) => {\n      set table(stroke: self.colors.neutral-dark)\n\n      body\n    },\n  ),\n```\n\nHowever in a table I don't want strokes everywhere and have to use a `stroke` parameter like this:\n\n```typc\n  table(\n    stroke: (x, y) => if x < 2 and y < 2 { 1pt },\n    [...],\n  )\n```\n\nThis does not preserve the color, I need `1pt + self.colors.neutral-dark`. However, I don't know how I can access `self` in a \"plain old slide\".\n\nI assume Touying must have a mechanism to get access to `self` in such cases. How does that work?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 48,
      "score": 279.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 996,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-09-15T17:47:04.707Z",
      "updated_at": "2024-09-15T17:47:04.707Z",
      "cooked": "<p>I found two ways to do it, documented in <a href=\"https://touying-typ.github.io/docs/dynamic/complex\" rel=\"noopener nofollow ugc\"> Complex Animations</a>. The first is <code>touying-fn-wrapper</code>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#touying-fn-wrapper((self: none) =&gt; {\n  table(\n    stroke: (x, y) =&gt; if x &lt; 2 and y &lt; 2 {\n      1pt + self.colors.neutral-dark\n    },\n    [...],\n  )\n})\n</code></pre>\n<p>The page points out:</p>\n<blockquote>\n<p>However, this does not work in all cases, for example if you put <code>uncover</code> into the context expression, you will get an error.</p>\n</blockquote>\n<p>The other option is <code>slide</code>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#slide(self =&gt; {\n  table(\n    stroke: (x, y) =&gt; if x &lt; 2 and y &lt; 2 {\n      1pt + self.colors.neutral-dark\n    },\n    [...],\n  )\n})\n</code></pre>",
      "raw": "I found two ways to do it, documented in [ Complex Animations](https://touying-typ.github.io/docs/dynamic/complex). The first is `touying-fn-wrapper`:\n\n```typ\n#touying-fn-wrapper((self: none) => {\n  table(\n    stroke: (x, y) => if x < 2 and y < 2 {\n      1pt + self.colors.neutral-dark\n    },\n    [...],\n  )\n})\n```\n\nThe page points out:\n\n> However, this does not work in all cases, for example if you put `uncover` into the context expression, you will get an error.\n\nThe other option is `slide`:\n\n```typ\n#slide(self => {\n  table(\n    stroke: (x, y) => if x < 2 and y < 2 {\n      1pt + self.colors.neutral-dark\n    },\n    [...],\n  )\n})\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 43,
      "score": 43.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:58:56.565206"
}
{
  "topic_metadata": {
    "id": 2271,
    "title": "How can I set the marker per item in a bullet point list?",
    "slug": "how-can-i-set-the-marker-per-item-in-a-bullet-point-list",
    "posts_count": 4,
    "created_at": "2025-01-01T20:35:12.157Z",
    "last_posted_at": "2025-01-03T11:55:08.311Z",
    "views": 317,
    "like_count": 5,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "lists"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 224
  },
  "posts": [
    {
      "id": 7135,
      "post_number": 1,
      "username": "Olaf",
      "name": "Olaf",
      "created_at": "2025-01-01T20:35:12.281Z",
      "updated_at": "2025-01-01T20:53:03.652Z",
      "cooked": "<p>I would like to offer the option of selecting items in a bullet point list by ticking them with a pen. To do this, I have configured the bullet point list so that a square is rendered on the first level. This works.</p>\n<p>Now I want the first item to be preselected. To do this, I only want to have a black filled square as a marker for the first item. A <img src=\"https://forum.typst.app/images/emoji/apple/heavy_check_mark.png?v=12\" title=\":heavy_check_mark:\" class=\"emoji\" alt=\":heavy_check_mark:\" loading=\"lazy\" width=\"20\" height=\"20\"> in the square would be even better.</p>\n<p>Is that possible?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set list(marker: (square(size: 0.8em), [‚Ä¢]))\n\n- abc\n- def\n  - ghi\n  - jkl\n- mno\n</code></pre>",
      "raw": "I would like to offer the option of selecting items in a bullet point list by ticking them with a pen. To do this, I have configured the bullet point list so that a square is rendered on the first level. This works.\n\nNow I want the first item to be preselected. To do this, I only want to have a black filled square as a marker for the first item. A ‚úî in the square would be even better. \n\nIs that possible?\n\n```typ\n#set list(marker: (square(size: 0.8em), [‚Ä¢]))\n\n- abc\n- def\n  - ghi\n  - jkl\n- mno\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 51,
      "score": 1000.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 418
    },
    {
      "id": 7137,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-01T20:52:53.767Z",
      "updated_at": "2025-01-01T20:52:53.767Z",
      "cooked": "<p>I think you could use or get inspired by cheq for this use case:</p>\n<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/universe/package/cheq\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/universe/package/cheq\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/universe/package/cheq\" target=\"_blank\" rel=\"noopener\">cheq ‚Äì Typst Universe</a></h3>\n\n  <p>Write markdown-like checklist easily.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "I think you could use or get inspired by cheq for this use case:\n\nhttps://typst.app/universe/package/cheq",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 51,
      "score": 65.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7162,
      "post_number": 3,
      "username": "zero00072",
      "name": "",
      "created_at": "2025-01-03T05:47:08.844Z",
      "updated_at": "2025-01-03T05:47:08.844Z",
      "cooked": "<p>Wow, it‚Äôs cool. I just think if it can be extended to include Font Awesome as an icon library like them in LaTeX.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/3/34806780dfdebe2559c619ed284aacfab74be477.png\" data-download-href=\"https://forum.typst.app/uploads/default/34806780dfdebe2559c619ed284aacfab74be477\" title=\"beamer\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/3/34806780dfdebe2559c619ed284aacfab74be477_2_690x388.png\" alt=\"beamer\" data-base62-sha1=\"7urVS6jQi0XhtBwAjLyYPTDw903\" width=\"690\" height=\"388\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/3/34806780dfdebe2559c619ed284aacfab74be477_2_690x388.png, https://forum.typst.app/uploads/default/optimized/2X/3/34806780dfdebe2559c619ed284aacfab74be477_2_1035x582.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/3/34806780dfdebe2559c619ed284aacfab74be477_2_1380x776.png 2x\" data-dominant-color=\"D0DAE3\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">beamer</span><span class=\"informations\">1890√ó1063 131 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "Wow, it's cool. I just think if it can be extended to include Font Awesome as an icon library like them in LaTeX.\n\n![beamer|690x388](upload://7urVS6jQi0XhtBwAjLyYPTDw903.png)",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 44,
      "score": 88.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1003
    },
    {
      "id": 7172,
      "post_number": 4,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-03T11:55:08.311Z",
      "updated_at": "2025-01-03T11:55:08.311Z",
      "cooked": "<p>You can easily do that too:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cheq:0.2.2\": checklist\n#import \"@preview/fontawesome:0.5.0\": *\n\n#show: checklist.with(marker-map: (\n  \"x\": fa-x(),\n))\n\n- [ ] a\n- [x] b\n</code></pre>\n<p>Note that the fontawesome package requires you to first manually install the font, since <a href=\"https://forum.typst.app/t/where-should-template-fonts-be-placed/2094/2\">packages can‚Äôt ship fonts at the moment</a>. See the package page for instructions:</p><aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/universe/package/fontawesome\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/universe/package/fontawesome\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/universe/package/fontawesome\" target=\"_blank\" rel=\"noopener\">fontawesome ‚Äì Typst Universe</a></h3>\n\n  <p>A Typst library for Font Awesome icons through the desktop fonts.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "You can easily do that too:\n```typ\n#import \"@preview/cheq:0.2.2\": checklist\n#import \"@preview/fontawesome:0.5.0\": *\n\n#show: checklist.with(marker-map: (\n  \"x\": fa-x(),\n))\n\n- [ ] a\n- [x] b\n```\n\nNote that the fontawesome package requires you to first manually install the font, since [packages can't ship fonts at the moment](https://forum.typst.app/t/where-should-template-fonts-be-placed/2094/2?u=sillyfreak). See the package page for instructions:\nhttps://typst.app/universe/package/fontawesome",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 38,
      "score": 82.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:53:15.900616"
}
{
  "topic_metadata": {
    "id": 2272,
    "title": "Why should I use the Typst symbols/emojis instead of just pasting them in?",
    "slug": "why-should-i-use-the-typst-symbols-emojis-instead-of-just-pasting-them-in",
    "posts_count": 4,
    "created_at": "2025-01-01T20:52:34.405Z",
    "last_posted_at": "2025-01-05T11:49:37.178Z",
    "views": 321,
    "like_count": 10,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "flokl",
    "tags": [
      "symbols"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 154
  },
  "posts": [
    {
      "id": 7136,
      "post_number": 1,
      "username": "TheJanzap",
      "name": "",
      "created_at": "2025-01-01T20:52:34.562Z",
      "updated_at": "2025-01-01T20:52:34.562Z",
      "cooked": "<p>What are the advantages of using <code>#symbol</code>, <code>#emoji</code> and <code>\\u{0000}</code> over just pasting the corresponding symbol in the Typst file?</p>",
      "raw": "What are the advantages of using `#symbol`, `#emoji` and `\\u{0000}` over just pasting the corresponding symbol in the Typst file?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 74,
      "score": 659.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 132
    },
    {
      "id": 7154,
      "post_number": 2,
      "username": "Yahuxo",
      "name": "Tobias",
      "created_at": "2025-01-02T23:57:16.314Z",
      "updated_at": "2025-01-02T23:57:16.314Z",
      "cooked": "<p>The font used for editing the Typst source file usually is different from the font used for output. It might not contain the symbol, which is possibly more relevant when you share Typst sources between people / computers.</p>",
      "raw": "The font used for editing the Typst source file usually is different from the font used for output. It might not contain the symbol, which is possibly more relevant when you share Typst sources between people / computers.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 4,
      "reads": 73,
      "score": 79.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 472
    },
    {
      "id": 7165,
      "post_number": 3,
      "username": "flokl",
      "name": "",
      "created_at": "2025-01-03T06:13:47.132Z",
      "updated_at": "2025-01-03T06:13:47.132Z",
      "cooked": "<p>I think the main idea of <code>#symbol</code> and <code>#emoji</code> are to be able to write common symbols with the normal keyboard, allowing you to stay in the flow of writing without needing to switch back and forth between applications to insert symbols.</p>",
      "raw": "I think the main idea of `#symbol` and `#emoji` are to be able to write common symbols with the normal keyboard, allowing you to stay in the flow of writing without needing to switch back and forth between applications to insert symbols.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 4,
      "reads": 72,
      "score": 84.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 7209,
      "post_number": 4,
      "username": "jskherman",
      "name": "Je Sian Keith Herman",
      "created_at": "2025-01-05T11:49:37.178Z",
      "updated_at": "2025-01-05T11:49:37.178Z",
      "cooked": "<p>Using the ASCII symbol/emoji functions also avoids the headache of encodings. Usually it‚Äôs UTF-8 when you‚Äôre pasting, but you never know if someone you‚Äôre working with (or even you by accident) pastes a symbol from a different weird encoding. It‚Äôs better to be consistent and avoid any ambiguity.</p>",
      "raw": "Using the ASCII symbol/emoji functions also avoids the headache of encodings. Usually it's UTF-8 when you're pasting, but you never know if someone you're working with (or even you by accident) pastes a symbol from a different weird encoding. It's better to be consistent and avoid any ambiguity.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 61,
      "score": 17.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 103
    }
  ],
  "scraped_at": "2025-06-10T09:53:15.080500"
}
{
  "topic_metadata": {
    "id": 2275,
    "title": "How can I make label references work across multiple files with Neovim + tinymist?",
    "slug": "how-can-i-make-label-references-work-across-multiple-files-with-neovim-tinymist",
    "posts_count": 5,
    "created_at": "2025-01-02T10:56:29.508Z",
    "last_posted_at": "2025-01-08T08:37:23.819Z",
    "views": 394,
    "like_count": 1,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "maxigaz",
    "tags": [
      "referencing",
      "neovim",
      "tinymist"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 475
  },
  "posts": [
    {
      "id": 7144,
      "post_number": 1,
      "username": "maxigaz",
      "name": "maxigaz",
      "created_at": "2025-01-02T10:56:29.667Z",
      "updated_at": "2025-02-05T14:57:20.266Z",
      "cooked": "<p>I have a Typst document split into multiple files. For example:</p>\n<pre><code class=\"lang-auto\">chapter.typ\nmain.typ\n</code></pre>\n<p>In <code>chapter.typ</code>, I have a link that points to a label defined in <code>main.typ</code>. Here‚Äôs the contents of both:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// chapter.typ\n#link(&lt;label1&gt;)[Click me]\n#pagebreak()\n</code></pre>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// main.typ\n#include(\"chapter.typ\")\n#lorem(30)\n&lt;label1&gt;Now you're here.\n</code></pre>\n<p>The problem is that tinymist marks the link with the diagnostic error ‚Äòlabel <code>&lt;label1&gt;</code> does not exist in the document‚Äô in Neovim.</p>\n<p>Is it possible to tell tinymist to be aware of both files when handling links with labels and supress the error?</p>",
      "raw": "I have a Typst document split into multiple files. For example:\n\n```\nchapter.typ\nmain.typ\n```\n\nIn `chapter.typ`, I have a link that points to a label defined in `main.typ`. Here's the contents of both:\n\n```typ\n// chapter.typ\n#link(<label1>)[Click me]\n#pagebreak()\n```\n\n```typ\n// main.typ\n#include(\"chapter.typ\")\n#lorem(30)\n<label1>Now you're here.\n```\n\nThe problem is that tinymist marks the link with the diagnostic error 'label `<label1>` does not exist in the document' in Neovim.\n\nIs it possible to tell tinymist to be aware of both files when handling links with labels and supress the error?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 48,
      "score": 1554.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 738
    },
    {
      "id": 7145,
      "post_number": 2,
      "username": "maxigaz",
      "name": "maxigaz",
      "created_at": "2025-01-02T11:12:50.962Z",
      "updated_at": "2025-01-02T16:47:18.601Z",
      "cooked": "<p>I‚Äôve found a solution <a href=\"https://github.com/Myriad-Dreamin/tinymist/blob/main/editors/neovim/README.md#working-with-multiple-file-projects\" rel=\"noopener nofollow ugc\">here</a>:</p>\n<pre><code class=\"lang-auto\">:lua vim.lsp.buf.execute_command({ command = 'tinymist.pinMain', arguments = { vim.api.nvim_buf_get_name(0) } })\n</code></pre>\n<p>This does make the error go away, although ‚Äòunpinning‚Äô the main file with <code>:lua vim.lsp.buf.execute_command({ command = 'tinymist.pinMain', arguments = { nil } })</code> just prints out this error:</p>\n<pre><code class=\"lang-auto\">-32602: expect Option&lt;PathBuf&gt; at args[0]\n</code></pre>\n<p>It may not be ideal, but it‚Äôs better than nothing.</p>\n<hr>\n<p>Update: I‚Äôve just tried again, and I can‚Äôt reliably make it work using the command I pasted earlier, not even on the same minimal examples.</p>\n<p>After some trial and error, I managed to make the error go away by restarting the language server from Neovim. (Even auto completion of the label worked.) However, when I quit Neovim and opened the files again, the error is back.</p>",
      "raw": "I've found a solution [here](https://github.com/Myriad-Dreamin/tinymist/blob/main/editors/neovim/README.md#working-with-multiple-file-projects):\n\n```\n:lua vim.lsp.buf.execute_command({ command = 'tinymist.pinMain', arguments = { vim.api.nvim_buf_get_name(0) } })\n```\n\nThis does make the error go away, although 'unpinning' the main file with `:lua vim.lsp.buf.execute_command({ command = 'tinymist.pinMain', arguments = { nil } })` just prints out this error:\n\n```\n-32602: expect Option<PathBuf> at args[0]\n```\n\nIt may not be ideal, but it's better than nothing.\n\n------\n\nUpdate: I've just tried again, and I can't reliably make it work using the command I pasted earlier, not even on the same minimal examples.\n\nAfter some trial and error, I managed to make the error go away by restarting the language server from Neovim. (Even auto completion of the label worked.) However, when I quit Neovim and opened the files again, the error is back.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 46,
      "score": 23.8,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 738
    },
    {
      "id": 7241,
      "post_number": 3,
      "username": "maxigaz",
      "name": "maxigaz",
      "created_at": "2025-01-06T11:15:09.296Z",
      "updated_at": "2025-01-06T11:15:09.296Z",
      "cooked": "<p>I have no idea what happened, but pinning the buffer works again (using Tinymist 0.12.16 and Neovim v0.10.3 on Arch Linux).</p>\n<p>I can‚Äôt edit my reply anymore, so I‚Äôm just going to mark it as the solution the way it is.</p>",
      "raw": "I have no idea what happened, but pinning the buffer works again (using Tinymist 0.12.16 and Neovim v0.10.3 on Arch Linux).\n\nI can't edit my reply anymore, so I'm just going to mark it as the solution the way it is.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 35,
      "score": 31.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 738
    },
    {
      "id": 7281,
      "post_number": 4,
      "username": "tilhi",
      "name": "",
      "created_at": "2025-01-07T21:18:56.857Z",
      "updated_at": "2025-01-07T21:18:56.857Z",
      "cooked": "<p>Hi, I‚Äôm experiencing the same issue as Maxigaz, but I‚Äôm using VSCode, so the solution provided doesn‚Äôt work for me. Does anyone have any suggestions for resolving this in VSCode?</p>\n<p>Alternatively, a more generalized solution that works across different editors would be even better.</p>\n<p>I‚Äôm also struggling to understand how the ‚Äúeach file is its own module‚Äù philosophy applies to cross-referencing between modules and using bibliography references when writing a multi-file document. Could someone clarify this?</p>",
      "raw": "Hi, I'm experiencing the same issue as Maxigaz, but I‚Äôm using VSCode, so the solution provided doesn‚Äôt work for me. Does anyone have any suggestions for resolving this in VSCode?\n\nAlternatively, a more generalized solution that works across different editors would be even better.\n\nI‚Äôm also struggling to understand how the \"each file is its own module\" philosophy applies to cross-referencing between modules and using bibliography references when writing a multi-file document. Could someone clarify this?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 56.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1022
    },
    {
      "id": 7289,
      "post_number": 5,
      "username": "maxigaz",
      "name": "maxigaz",
      "created_at": "2025-01-08T08:37:23.819Z",
      "updated_at": "2025-01-08T08:37:23.819Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"tilhi\" data-post=\"4\" data-topic=\"2275\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/tilhi/48/2826_2.png\" class=\"avatar\"> tilhi:</div>\n<blockquote>\n<p>Hi, I‚Äôm experiencing the same issue as Maxigaz, but I‚Äôm using VSCode, so the solution provided doesn‚Äôt work for me. Does anyone have any suggestions for resolving this in VSCode?</p>\n</blockquote>\n</aside>\n<p>I don‚Äôt use VSCode, but I did come across <a href=\"https://github.com/Myriad-Dreamin/tinymist/issues/321#issuecomment-2485941136\" rel=\"noopener nofollow ugc\">this suggestion</a> while doing research.</p>\n<p>And just like Neovim, VSCode also has its own notes for tinymist <a href=\"https://github.com/Myriad-Dreamin/tinymist/blob/main/editors/vscode/README.md#working-with-multiple-file-projects\" rel=\"noopener nofollow ugc\">here</a>.</p>",
      "raw": "[quote=\"tilhi, post:4, topic:2275\"]\nHi, I‚Äôm experiencing the same issue as Maxigaz, but I‚Äôm using VSCode, so the solution provided doesn‚Äôt work for me. Does anyone have any suggestions for resolving this in VSCode?\n[/quote]\n\nI don't use VSCode, but I did come across [this suggestion](https://github.com/Myriad-Dreamin/tinymist/issues/321#issuecomment-2485941136) while doing research.\n\nAnd just like Neovim, VSCode also has its own notes for tinymist [here](https://github.com/Myriad-Dreamin/tinymist/blob/main/editors/vscode/README.md#working-with-multiple-file-projects).",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 33,
      "score": 51.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 738
    }
  ],
  "scraped_at": "2025-06-10T09:53:14.354213"
}
{
  "topic_metadata": {
    "id": 2277,
    "title": "How to use custom counters in heading titles?",
    "slug": "how-to-use-custom-counters-in-heading-titles",
    "posts_count": 4,
    "created_at": "2025-01-02T15:31:37.035Z",
    "last_posted_at": "2025-01-03T11:41:21.826Z",
    "views": 209,
    "like_count": 1,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "janekfleper",
    "tags": [
      "outline",
      "counter",
      "context"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 477
  },
  "posts": [
    {
      "id": 7149,
      "post_number": 1,
      "username": "rincewind",
      "name": "rincewind",
      "created_at": "2025-01-02T15:31:37.175Z",
      "updated_at": "2025-01-03T11:45:25.448Z",
      "cooked": "<p>Hello dear people,<br>\nI have the following problem and didn‚Äôt yet find an answer here:</p>\n<p>I have a document with special sections for excercises (called ‚Äúlabs‚Äù here) and<br>\nI would like to have them numbered.</p>\n<p>So, ich have chapter 1 with three labs (1, 2 and 3) , chapter 2 with 2 labs  (4 and 5) and so on.<br>\nThere is the <code>counter</code> type, easy.</p>\n<p>The problem starts with the <code>outline</code>, it should be</p>\n<pre><code class=\"lang-auto\">1. chapter 1: foo\n    1.1 Lab 1: fizz\n    1.2 Lab 2: buzz\n    1.3 Lab 3: fizzbuzz\n2.chapter 2: bar\n    2.1 Lab 4: blafoo\n    2.2 Lab 5: foobla\n</code></pre>\n<p>but acutally it compiles to</p>\n<pre><code class=\"lang-auto\">1. chapter 1: foo\n    1.1 Lab 0: fizz\n    1.2 Lab 0: buzz\n    1.3 Lab 0: fizzbuzz\n2.chapter 2: bar\n    2.1 Lab 0: blafoo\n    2.2 Lab 0: foobla\n</code></pre>\n<p>The code looks kind like this (try to condense it):</p>\n<p><em>theme/utils file</em></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let labCounter = counter(\"lab\")\n#let lab-slide(title: []) = {\n  labCounter.step()\n  heading([Lab #context labCounter.display(): #title)\n  ...\n}\n</code></pre>\n<p>and the  <em>main file</em></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">...\n#outline()\n\n#include(\"./chapter1.typ\")\n#include(\"./chapter2.typ\")\n</code></pre>\n<p>and then <em>chapter1.typ</em></p>\n<pre><code class=\"lang-auto\">...\n#lab-slide(title: \"Try this for real\")\n...\n</code></pre>\n<p>I hope, this is understandable and that someone is able to tell me where<br>\nI am holding it the wrong way around.</p>\n<p>Thanks <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hello dear people,\nI have the following problem and didn't yet find an answer here:\n\nI have a document with special sections for excercises (called \"labs\" here) and\nI would like to have them numbered.\n\nSo, ich have chapter 1 with three labs (1, 2 and 3) , chapter 2 with 2 labs  (4 and 5) and so on.\nThere is the `counter` type, easy.\n\nThe problem starts with the `outline`, it should be\n\n```\n1. chapter 1: foo\n    1.1 Lab 1: fizz\n    1.2 Lab 2: buzz\n    1.3 Lab 3: fizzbuzz\n2.chapter 2: bar\n    2.1 Lab 4: blafoo\n    2.2 Lab 5: foobla\n```\n\nbut acutally it compiles to\n\n```\n1. chapter 1: foo\n    1.1 Lab 0: fizz\n    1.2 Lab 0: buzz\n    1.3 Lab 0: fizzbuzz\n2.chapter 2: bar\n    2.1 Lab 0: blafoo\n    2.2 Lab 0: foobla\n```\n\nThe code looks kind like this (try to condense it):\n\n_theme/utils file_\n```typ\n#let labCounter = counter(\"lab\")\n#let lab-slide(title: []) = {\n  labCounter.step()\n  heading([Lab #context labCounter.display(): #title)\n  ...\n}\n```\n\nand the  _main file_\n```typ\n...\n#outline()\n\n#include(\"./chapter1.typ\")\n#include(\"./chapter2.typ\")\n```\n\nand then _chapter1.typ_\n\n```\n...\n#lab-slide(title: \"Try this for real\")\n...\n```\n\nI hope, this is understandable and that someone is able to tell me where\nI am holding it the wrong way around.\n\nThanks :slight_smile:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 552.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 999
    },
    {
      "id": 7155,
      "post_number": 2,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-01-03T01:14:48.284Z",
      "updated_at": "2025-01-03T01:14:48.284Z",
      "cooked": "<p>The outline always uses the value of the <code>labCounter</code> in the current context. Since the outline is located before any of the lab slides, the counter will just be 0.</p>\n<p>If you place the entire <code>heading()</code> into the <code>context</code>, the heading titles are displayed correctly in the outline.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set heading(numbering: \"1.1\")\n#let lab-counter = counter(\"lab\")\n\n#let lab-slide(title) = {\n  lab-counter.step()\n  context { heading(level: 2, [Lab #lab-counter.display(): #title]) }\n}\n\n#outline(indent: auto)\n\n= foo\n#lab-slide(\"fizz\")\n#lab-slide(\"buzz\")\n#lab-slide(\"fizzbuzz\")\n\n= bar\n#lab-slide(\"blafoo\")\n#lab-slide(\"foobla\")\n</code></pre>\n<p>I am not sure about the technical reasons for this behavior. The outline just seems to grab all the headings and it does not care if the function <code>heading()</code> was called in a specific context? I created a minimal example project to show this behavior <a href=\"https://typst.app/project/rU4Lkrb3loExfczupW0RG8\">here</a>. If you hover over the <code>it</code> inside the show rule for the outline entries, the <code>context()</code> is not mentioned anywhere. In your case the <code>entry.heading.body</code> would be <code>sequence([Lab], [ ], context(), [:], [ ], [fizz])</code>.</p>",
      "raw": "The outline always uses the value of the `labCounter` in the current context. Since the outline is located before any of the lab slides, the counter will just be 0.\n\nIf you place the entire `heading()` into the `context`, the heading titles are displayed correctly in the outline.\n\n```typ\n#set heading(numbering: \"1.1\")\n#let lab-counter = counter(\"lab\")\n\n#let lab-slide(title) = {\n  lab-counter.step()\n  context { heading(level: 2, [Lab #lab-counter.display(): #title]) }\n}\n\n#outline(indent: auto)\n\n= foo\n#lab-slide(\"fizz\")\n#lab-slide(\"buzz\")\n#lab-slide(\"fizzbuzz\")\n\n= bar\n#lab-slide(\"blafoo\")\n#lab-slide(\"foobla\")\n```\n\nI am not sure about the technical reasons for this behavior. The outline just seems to grab all the headings and it does not care if the function `heading()` was called in a specific context? I created a minimal example project to show this behavior [here](https://typst.app/project/rU4Lkrb3loExfczupW0RG8). If you hover over the `it` inside the show rule for the outline entries, the `context()` is not mentioned anywhere. In your case the `entry.heading.body` would be `sequence([Lab], [ ], context(), [:], [ ], [fizz])`.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 27,
      "score": 130.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 7168,
      "post_number": 3,
      "username": "rincewind",
      "name": "rincewind",
      "created_at": "2025-01-03T08:40:47.344Z",
      "updated_at": "2025-01-03T08:40:47.344Z",
      "cooked": "<p>Ha, works like a charm :-) Thanks <a class=\"mention\" href=\"/u/janekfleper\">@janekfleper</a> for the quick answer.</p>",
      "raw": "Ha, works like a charm :-) Thanks @janekfleper for the quick answer.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 4.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 999
    },
    {
      "id": 7170,
      "post_number": 4,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-03T11:41:21.826Z",
      "updated_at": "2025-01-03T11:42:48.746Z",
      "cooked": "<p>This problem also looks similar to the following:</p><aside class=\"quote quote-modified\" data-post=\"3\" data-topic=\"2215\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/p/F64C96/48.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/how-to-avoid-a-reset-to-the-third-level-heading-counter-after-changing-the-first-two-levels/2215/3\">How to avoid a reset to the third-level heading counter after changing the first two levels?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    Due to automatic counter step behavior when placing any heading, I‚Äôd recommend using a separate counter which you manually control, like below. \nNote that I‚Äôve taken the additional step of updating the heading counter to ensure it is consistent with the separate counter, ensuring we don‚Äôt have to rebuild headings entirely to start using the new counter, but rather keep headings as they are, using counter(heading) like they always do. This also ensures they show up correctly in the outline withou‚Ä¶\n  </blockquote>\n</aside>\n\n<p>The difference is, that post is about the proper heading numbering, while here you want the number as part of the title. Maybe it still helps or gives you more ideas.</p>",
      "raw": "This problem also looks similar to the following:\nhttps://forum.typst.app/t/how-to-avoid-a-reset-to-the-third-level-heading-counter-after-changing-the-first-two-levels/2215/3?u=sillyfreak\n\nThe difference is, that post is about the proper heading numbering, while here you want the number as part of the title. Maybe it still helps or gives you more ideas.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 244.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:53:13.632073"
}
{
  "topic_metadata": {
    "id": 228,
    "title": "What is the best way to retrieve template argument outside the template?",
    "slug": "what-is-the-best-way-to-retrieve-template-argument-outside-the-template",
    "posts_count": 7,
    "created_at": "2024-09-15T16:31:38.813Z",
    "last_posted_at": "2024-09-16T12:52:55.968Z",
    "views": 748,
    "like_count": 9,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "PgBiel",
    "tags": [
      "scripting",
      "templates",
      "package-authoring"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 2253
  },
  "posts": [
    {
      "id": 983,
      "post_number": 1,
      "username": "maucejo",
      "name": "Mathieu Aucejo",
      "created_at": "2024-09-15T16:31:39.308Z",
      "updated_at": "2025-05-14T10:13:22.174Z",
      "cooked": "<p>Generally, in the template I create, I define a list of colors as:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let colors = (\n    primary: red,\n    secondary: blue\n)\n</code></pre>\n<p>My question is ‚ÄúWhat is the best way to give the user access to the template colors?‚Äù</p>\n<p>Should I use a <code>state</code> variable ?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// in template.typ\n#let user-colors = state(\"user-colors\", colors)\n\n// in main.typ\n#let colors = context user-colors.get() // it gives a content\n</code></pre>\n<p>Do you have any recommendation ?</p>\n<p>Thank you</p>",
      "raw": "Generally, in the template I create, I define a list of colors as:\n```typ\n#let colors = (\n    primary: red,\n    secondary: blue\n)\n```\nMy question is \"What is the best way to give the user access to the template colors?\"\n\nShould I use a `state` variable ? \n```typ\n// in template.typ\n#let user-colors = state(\"user-colors\", colors)\n\n// in main.typ\n#let colors = context user-colors.get() // it gives a content\n```\n\nDo you have any recommendation ?\n\nThank you",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 86,
      "score": 1472.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 125
    },
    {
      "id": 987,
      "post_number": 2,
      "username": "xkevio",
      "name": "Kevio",
      "created_at": "2024-09-15T17:19:56.929Z",
      "updated_at": "2024-09-15T17:19:56.929Z",
      "cooked": "<p>If you want the user to be able to change (read/write access) the colors, then yes you will need a <code>state</code>-variable. They can use <code>user-colors.update(...)</code> without <code>context</code> and it will change for all content that relies on the color provided you used the <code>state</code> there.</p>\n<p>However, for simple access, you will need <code>context</code> indeed and it will return content, see here: <a href=\"https://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164/2\" class=\"inline-onebox\">Why is the value I receive from context always content? - #2 by laurmaedje</a></p>",
      "raw": "If you want the user to be able to change (read/write access) the colors, then yes you will need a `state`-variable. They can use `user-colors.update(...)` without `context` and it will change for all content that relies on the color provided you used the `state` there.\n\nHowever, for simple access, you will need `context` indeed and it will return content, see here: https://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164/2",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 91,
      "score": 58.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 21
    },
    {
      "id": 1057,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-09-15T20:59:30.985Z",
      "updated_at": "2024-09-15T21:13:08.007Z",
      "cooked": "<p>Hey maucejo, if your <code>colors</code> value is read-only and always the same regardless of the template parameters, you can expose it as a global variable in your template file, for example:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// template.typ\n#let colors = (primary: red, secondary: blue)\n\n// main.typ\n#import \"template.typ\": colors, template\n\n#show: template.with(...) // does not affect 'colors'\n\nThe colors are #colors.primary and #colors.secondary\n</code></pre>\n<p>However, if the value of <code>colors</code> depends on the parameters specified by the template, then you can‚Äôt define a variable inside the <code>template</code> function and expose it to the template user, as the variable would be local to the template function‚Äôs body (thus not accessible outside of it at all). Rather, you have two options (as of Typst 0.11.0):</p>\n<ol>\n<li>\n<p>For <strong>read-only values</strong> (such as colors and text, but maybe even functions) <strong>which depend on template parameters</strong>, you can create a second function (let‚Äôs say, <code>setup</code>) which takes the template parameters, generates the read-only values and functions - including the <code>template</code> function itself - based on those parameters, and returns them so the user can access them. Here‚Äôs an example of how this could work (let‚Äôs say your values and functions depend on a <code>title</code> text parameter the user would specify to the template). Consider the template file below:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// template.typ\n\n// Function depending on the 'title' parameter\n#let title-with-color(title, color) = text(color)[#title]\n\n// This will generate a read-only value depending on\n// the 'title' parameter\n#let generate-bold-title(title) = [*#title*]\n\n// This is your template which applies styles\n// to the document according to certain parameters.\n// We will expose this function exclusively through\n// 'setup' below, which will provide the 'title'\n// parameter.\n#let template(title, doc) = {\n  set document(title: title)\n  set heading(numbering: \"1.\")\n  set text(font: \"New Computer Modern\")\n\n  align(center, text(54pt)[#title])\n  doc\n}\n\n// This is the main function you expose to your user.\n// It takes the parameters and, with them, prepares\n// constants and functions (such as the 'template' function)\n// which are returned to the user.\n#let setup(title: \"Default title\") = {\n  // 1. Generate read-only constants\n  // based on the setup parameters\n  let bold-title = generate-bold-title(title)\n  let emph-title = [_#title;_]\n\n  // 2. Generate functions we want to expose\n  // We will expose a function which allows the user\n  // of the template to easily place the title they specified\n  // with a certain color\n  // Here, we pre-apply the 'title' parameter to the 'title-with-color'\n  // function so that the template user only has to specify the 'color'\n  // parameter later.\n  let title-with-color = title-with-color.with(title)\n  // Prepare the template function itself, pre-apply the parameters\n  // (It has to remain a function to receive the 'doc' parameter,\n  // apply styles and add content to it, and return the new,\n  // modified document)\n  let template = template.with(title)\n\n  // 3. Return the values and functions generated based on\n  // the given parameters\n  (\n    bold-title: bold-title,\n    emph-title: emph-title,\n    title-with-color: title-with-color,\n    template: template\n  )\n}\n</code></pre>\n<p>You could then use that template as follows:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// main.typ\n#import \"template.typ\": setup\n\n// 1. Customize the template's parameters,\n// obtain customized values and functions\n#let (bold-title, emph-title, title-with-color, template) = setup(title: \"My Thesis\")\n\n// 2. Apply the customized template function to the document\n// It will change the font, display the title at the top, and so on\n#show: template\n\n// 3. You can now use the template's generated values and functions!\nThe bold title is #bold-title \\\nThe emphasized title is #emph-title \\\nHere's my title but red: #title-with-color(red)\n</code></pre>\n<p>This will produce the output below:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/1X/6808dade71e53129e5884fb9b4b0cda17abef5e1.png\" data-download-href=\"https://forum.typst.app/uploads/default/6808dade71e53129e5884fb9b4b0cda17abef5e1\" title=\"output of main.typ above\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/6808dade71e53129e5884fb9b4b0cda17abef5e1_2_690x350.png\" alt=\"output of main.typ above\" data-base62-sha1=\"eQkCYhaGFveR0xNiFCG5J244ccF\" width=\"690\" height=\"350\" srcset=\"https://forum.typst.app/uploads/default/optimized/1X/6808dade71e53129e5884fb9b4b0cda17abef5e1_2_690x350.png, https://forum.typst.app/uploads/default/original/1X/6808dade71e53129e5884fb9b4b0cda17abef5e1.png 1.5x, https://forum.typst.app/uploads/default/original/1X/6808dade71e53129e5884fb9b4b0cda17abef5e1.png 2x\" data-dominant-color=\"FBFBFB\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">output of main.typ above</span><span class=\"informations\">822√ó417 24.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</li>\n<li>\n<p>For <strong>read-write values</strong> depending on template parameters, your only option will be to use Typst‚Äôs <code>state</code> system (see docs: <a href=\"https://typst.app/docs/reference/introspection/state/\" class=\"inline-onebox\">State Type ‚Äì Typst Documentation</a>), as highlighted by <a class=\"mention\" href=\"/u/xkevio\">@xkevio</a> above (<a href=\"https://forum.typst.app/t/what-is-the-best-way-to-retrieve-template-argument-outside-the-template/228/2\" class=\"inline-onebox\">What is the best way to retrieve template argument outside the template? - #2 by xkevio</a>). The way the <code>state</code> system works is that the value in a <code>state</code> variable with a certain key depends on your location in the document, so you can specify a initial value for your <code>state</code> anywhere in the document (for example, in your template function‚Äôs body) and later place special elements called ‚Äústate updates‚Äù (created through, for example, <code>my_state.update(5)</code> to update a certain state to <code>5</code>) in the document, which tell the Typst compiler ‚Äúany queries for this state‚Äôs value AFTER this point in the document should return this new value.‚Äù This is why querying a state value requires a <code>context { }</code> block (see explanation: <a href=\"https://typst.app/docs/reference/context/\" class=\"inline-onebox\">Context ‚Äì Typst Documentation</a>), which returns document content: the code inside it depends on where in the document it is evaluated, so the only way to know what the context block evaluates to is to place it <em>somewhere</em> in the document so it can use the correct values at that location. Consider the example below for how you would apply this to a template:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// template.typ\n\n// Expose the state variable to template users so they can\n// query or change its value later if needed.\n#let title-state = state(\"template-title\", \"\")\n\n// Similar to the previous example, but this time the 'title'\n// value is specified through the state and thus can be changed\n// through updates to it. Therefore, to access the state's value,\n// we wrap our code in `context` as the call to 'title-state.get()'\n// can return different values depending on where this function's\n// output is placed in the document (before or after state updates).\n#let title-with-color(color) = context {\n   text(color)[#title-state.get()]\n}\n\n#let template(doc, title: none) = {\n  // Apply styles as usual\n  set heading(numbering: \"1.\")\n  set text(font: \"New Computer Modern\")\n\n  // Place a state update element at the top of the document\n  // setting the initial value of the title state to the given\n  // parameter. The user can change this later.\n  title-state.update(title)\n\n  // Place the title and the document.\n  align(center, text(54pt)[#title])\n  doc\n}\n</code></pre>\n<p>You can then use the template above as follows:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// main.typ\n#import \"template.typ\": template, title-state, title-with-color\n\n// Apply template styles and initialize 'title-state'\n#show: template.with(title: \"My Article\")\n\n// We can now use the template's functions normally\n// They will access the current value of 'title-state'\nHere's a red title: #title-with-color(red)\n\n// You can also access the title state's value itself, but note\n// that you need 'context' (which returns content that\n// needs to be placed to run your code) since the value of\n// the state depends on your document location, therefore\n// the same code can produce different outputs depending on\n// the current document context!\n#let title-indicator = context { \"The title is \" + title-state.get() }\n\n#title-indicator\n#title-state.update(\"New Title\")\n\n// Notice how 'title-indicator' appears to have changed below,\n// since we updated the title state! Actually, it never changed:\n// 'title-indicator' is an element (contextual element) which\n// runs your code differently depending on the current context\n// each time it is placed! Hence why it is classified as 'content'\n// despite evaluating to a string (due to the \"double quotes\").\n#title-indicator\n\n// Even the 'title-with-color' function is producing different output now!\n// After the title state was updated, all calls to 'title-state.get()' will return\n// the new value - but for it to know which value to return, it has to be\n// aware of the current document location, which is only possible inside\n// a 'context' block! Hence why the function was defined using one.\nHere's a blue title: #title-with-color(blue)\n</code></pre>\n<p>The document above produces:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/1X/ea2bad8eb475dcf5a4d846d72b563b7f3a0eb349.png\" data-download-href=\"https://forum.typst.app/uploads/default/ea2bad8eb475dcf5a4d846d72b563b7f3a0eb349\" title=\"output of main.typ using state\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/ea2bad8eb475dcf5a4d846d72b563b7f3a0eb349_2_690x347.png\" alt=\"output of main.typ using state\" data-base62-sha1=\"xpzj4IMUjmb7S7jkFOVnriXUmRH\" width=\"690\" height=\"347\" srcset=\"https://forum.typst.app/uploads/default/optimized/1X/ea2bad8eb475dcf5a4d846d72b563b7f3a0eb349_2_690x347.png, https://forum.typst.app/uploads/default/original/1X/ea2bad8eb475dcf5a4d846d72b563b7f3a0eb349.png 1.5x, https://forum.typst.app/uploads/default/original/1X/ea2bad8eb475dcf5a4d846d72b563b7f3a0eb349.png 2x\" data-dominant-color=\"FAFAFA\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">output of main.typ using state</span><span class=\"informations\">786√ó396 23.9 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</li>\n</ol>\n<p>Note that an initial <code>setup</code> function isn‚Äôt required when you use <code>state</code> for read-write values like in the second example above. It is, however, required if you want to expose read-only values, which is why the <code>setup</code> method is usually recommended if possible, given that, with it, you don‚Äôt need to use <code>state</code> and the introspection machinery (which requires placing content in the document) to access the exposed values. You can also mix both approaches to have a few easy-to-access but read-only values and functions (generated through <code>setup</code>) and a few read-write but harder to access (as it requires placing content in the document) values simultaneously. It‚Äôs all up to you!</p>\n<p>Note that there are some ongoing proposals to make the <code>setup</code> example simpler, such as <a href=\"https://github.com/typst/typst/issues/2403\" class=\"inline-onebox\">Syntax for calling a package entrypoint on import ¬∑ Issue #2403 ¬∑ typst/typst ¬∑ GitHub</a> and <a href=\"https://github.com/typst/typst/issues/4853\" class=\"inline-onebox\">Explicit module syntax ¬∑ Issue #4853 ¬∑ typst/typst ¬∑ GitHub</a>, but they are still being discussed and no concrete changes are planned at the moment. Still, stay tuned for potential future improvements to the process of making templates, including, for example, custom types and elements (a planned feature).</p>\n<p>Let us know if there are any further questions on the topic! Don‚Äôt forget to check out the Typst reference (<a href=\"https://typst.app/docs/reference/\" class=\"inline-onebox\">Reference ‚Äì Typst Documentation</a>) as well as the template guide (<a href=\"https://typst.app/docs/tutorial/making-a-template/\" class=\"inline-onebox\">Making a Template ‚Äì Typst Documentation</a>) for even more useful information.</p>",
      "raw": "Hey maucejo, if your `colors` value is read-only and always the same regardless of the template parameters, you can expose it as a global variable in your template file, for example:\n\n```typ\n// template.typ\n#let colors = (primary: red, secondary: blue)\n\n// main.typ\n#import \"template.typ\": colors, template\n\n#show: template.with(...) // does not affect 'colors'\n\nThe colors are #colors.primary and #colors.secondary\n```\n\nHowever, if the value of `colors` depends on the parameters specified by the template, then you can't define a variable inside the `template` function and expose it to the template user, as the variable would be local to the template function's body (thus not accessible outside of it at all). Rather, you have two options (as of Typst 0.11.0):\n\n1. For **read-only values** (such as colors and text, but maybe even functions) **which depend on template parameters**, you can create a second function (let's say, `setup`) which takes the template parameters, generates the read-only values and functions - including the `template` function itself - based on those parameters, and returns them so the user can access them. Here's an example of how this could work (let's say your values and functions depend on a `title` text parameter the user would specify to the template). Consider the template file below:\n\n    ```typ\n    // template.typ\n    \n    // Function depending on the 'title' parameter\n    #let title-with-color(title, color) = text(color)[#title]\n    \n    // This will generate a read-only value depending on\n    // the 'title' parameter\n    #let generate-bold-title(title) = [*#title*]\n    \n    // This is your template which applies styles\n    // to the document according to certain parameters.\n    // We will expose this function exclusively through\n    // 'setup' below, which will provide the 'title'\n    // parameter.\n    #let template(title, doc) = {\n      set document(title: title)\n      set heading(numbering: \"1.\")\n      set text(font: \"New Computer Modern\")\n    \n      align(center, text(54pt)[#title])\n      doc\n    }\n    \n    // This is the main function you expose to your user.\n    // It takes the parameters and, with them, prepares\n    // constants and functions (such as the 'template' function)\n    // which are returned to the user.\n    #let setup(title: \"Default title\") = {\n      // 1. Generate read-only constants\n      // based on the setup parameters\n      let bold-title = generate-bold-title(title)\n      let emph-title = [_#title;_]\n    \n      // 2. Generate functions we want to expose\n      // We will expose a function which allows the user\n      // of the template to easily place the title they specified\n      // with a certain color\n      // Here, we pre-apply the 'title' parameter to the 'title-with-color'\n      // function so that the template user only has to specify the 'color'\n      // parameter later.\n      let title-with-color = title-with-color.with(title)\n      // Prepare the template function itself, pre-apply the parameters\n      // (It has to remain a function to receive the 'doc' parameter,\n      // apply styles and add content to it, and return the new,\n      // modified document)\n      let template = template.with(title)\n    \n      // 3. Return the values and functions generated based on\n      // the given parameters\n      (\n        bold-title: bold-title,\n        emph-title: emph-title,\n        title-with-color: title-with-color,\n        template: template\n      )\n    }\n    ```\n    You could then use that template as follows:\n    ```typ\n    // main.typ\n    #import \"template.typ\": setup\n\n    // 1. Customize the template's parameters,\n    // obtain customized values and functions\n    #let (bold-title, emph-title, title-with-color, template) = setup(title: \"My Thesis\")\n\n    // 2. Apply the customized template function to the document\n    // It will change the font, display the title at the top, and so on\n    #show: template\n\n    // 3. You can now use the template's generated values and functions!\n    The bold title is #bold-title \\\n    The emphasized title is #emph-title \\\n    Here's my title but red: #title-with-color(red)\n    ```\n\n    This will produce the output below:\n    \n    ![output of main.typ above|690x350](upload://eQkCYhaGFveR0xNiFCG5J244ccF.png)\n\n2. For **read-write values** depending on template parameters, your only option will be to use Typst's `state` system (see docs: https://typst.app/docs/reference/introspection/state/), as highlighted by @xkevio above (https://forum.typst.app/t/what-is-the-best-way-to-retrieve-template-argument-outside-the-template/228/2). The way the `state` system works is that the value in a `state` variable with a certain key depends on your location in the document, so you can specify a initial value for your `state` anywhere in the document (for example, in your template function's body) and later place special elements called \"state updates\" (created through, for example, `my_state.update(5)` to update a certain state to `5`) in the document, which tell the Typst compiler \"any queries for this state's value AFTER this point in the document should return this new value.\" This is why querying a state value requires a `context { }` block (see explanation: https://typst.app/docs/reference/context/), which returns document content: the code inside it depends on where in the document it is evaluated, so the only way to know what the context block evaluates to is to place it _somewhere_ in the document so it can use the correct values at that location. Consider the example below for how you would apply this to a template:\n\n    ```typ\n    // template.typ\n\n    // Expose the state variable to template users so they can\n    // query or change its value later if needed.\n    #let title-state = state(\"template-title\", \"\")\n\n    // Similar to the previous example, but this time the 'title'\n    // value is specified through the state and thus can be changed\n    // through updates to it. Therefore, to access the state's value,\n    // we wrap our code in `context` as the call to 'title-state.get()'\n    // can return different values depending on where this function's\n    // output is placed in the document (before or after state updates).\n    #let title-with-color(color) = context {\n       text(color)[#title-state.get()]\n    }\n\n    #let template(doc, title: none) = {\n      // Apply styles as usual\n      set heading(numbering: \"1.\")\n      set text(font: \"New Computer Modern\")\n\n      // Place a state update element at the top of the document\n      // setting the initial value of the title state to the given\n      // parameter. The user can change this later.\n      title-state.update(title)\n\n      // Place the title and the document.\n      align(center, text(54pt)[#title])\n      doc\n    }\n    ```\n    You can then use the template above as follows:\n    ```typ\n    // main.typ\n    #import \"template.typ\": template, title-state, title-with-color\n\n    // Apply template styles and initialize 'title-state'\n    #show: template.with(title: \"My Article\")\n\n    // We can now use the template's functions normally\n    // They will access the current value of 'title-state'\n    Here's a red title: #title-with-color(red)\n\n    // You can also access the title state's value itself, but note\n    // that you need 'context' (which returns content that\n    // needs to be placed to run your code) since the value of\n    // the state depends on your document location, therefore\n    // the same code can produce different outputs depending on\n    // the current document context!\n    #let title-indicator = context { \"The title is \" + title-state.get() }\n\n    #title-indicator\n    #title-state.update(\"New Title\")\n\n    // Notice how 'title-indicator' appears to have changed below,\n    // since we updated the title state! Actually, it never changed:\n    // 'title-indicator' is an element (contextual element) which\n    // runs your code differently depending on the current context\n    // each time it is placed! Hence why it is classified as 'content'\n    // despite evaluating to a string (due to the \"double quotes\").\n    #title-indicator\n\n    // Even the 'title-with-color' function is producing different output now!\n    // After the title state was updated, all calls to 'title-state.get()' will return\n    // the new value - but for it to know which value to return, it has to be\n    // aware of the current document location, which is only possible inside\n    // a 'context' block! Hence why the function was defined using one.\n    Here's a blue title: #title-with-color(blue)\n    ```\n    The document above produces:\n    ![output of main.typ using state|690x347](upload://xpzj4IMUjmb7S7jkFOVnriXUmRH.png)\n\n    \n\nNote that an initial `setup` function isn't required when you use `state` for read-write values like in the second example above. It is, however, required if you want to expose read-only values, which is why the `setup` method is usually recommended if possible, given that, with it, you don't need to use `state` and the introspection machinery (which requires placing content in the document) to access the exposed values. You can also mix both approaches to have a few easy-to-access but read-only values and functions (generated through `setup`) and a few read-write but harder to access (as it requires placing content in the document) values simultaneously. It's all up to you!\n\nNote that there are some ongoing proposals to make the `setup` example simpler, such as https://github.com/typst/typst/issues/2403 and https://github.com/typst/typst/issues/4853, but they are still being discussed and no concrete changes are planned at the moment. Still, stay tuned for potential future improvements to the process of making templates, including, for example, custom types and elements (a planned feature).\n\nLet us know if there are any further questions on the topic! Don't forget to check out the Typst reference (https://typst.app/docs/reference/) as well as the template guide (https://typst.app/docs/tutorial/making-a-template/) for even more useful information.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 6,
      "reads": 85,
      "score": 472.0,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 1129,
      "post_number": 4,
      "username": "maucejo",
      "name": "Mathieu Aucejo",
      "created_at": "2024-09-16T07:58:52.891Z",
      "updated_at": "2024-09-16T07:58:52.891Z",
      "cooked": "<p>Thank you <a class=\"mention\" href=\"/u/xkevio\">@xkevio</a> , as you suggest, my current try are to use <code>state</code> without success for the moment. I will read the doc again ;)</p>",
      "raw": "Thank you @xkevio , as you suggest, my current try are to use `state` without success for the moment. I will read the doc again ;)",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 55,
      "score": 21.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 125
    },
    {
      "id": 1130,
      "post_number": 5,
      "username": "maucejo",
      "name": "Mathieu Aucejo",
      "created_at": "2024-09-16T08:02:17.994Z",
      "updated_at": "2024-09-16T08:02:17.994Z",
      "cooked": "<p>Wow <a class=\"mention\" href=\"/u/pgbiel\">@PgBiel</a> ! Thank you for this detail and pedagogical answer. Currently, I use a global variable which works great for my personal use, but not from an user perspective.</p>\n<p>I will try to work on the basis of your answer to find a solution that fits my need.</p>\n<p>Thank you !</p>",
      "raw": "Wow @PgBiel ! Thank you for this detail and pedagogical answer. Currently, I use a global variable which works great for my personal use, but not from an user perspective.\n\nI will try to work on the basis of your answer to find a solution that fits my need.\n\nThank you !",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 56,
      "score": 16.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 125
    },
    {
      "id": 1176,
      "post_number": 6,
      "username": "maucejo",
      "name": "Mathieu Aucejo",
      "created_at": "2024-09-16T09:14:57.736Z",
      "updated_at": "2024-09-16T09:14:57.736Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/pgbiel\">@PgBiel</a> and <a class=\"mention\" href=\"/u/xkevio\">@xkevio</a> I have thought to my problem. In the original question, the problem is that a <code>context</code> gives a content. Despite the content of the <code>content</code> is correct (it is a <code>dictionary</code>), I can‚Äôt access to the content of the content itself.</p>\n<p>It is like a picture, but you can see the object, but you don‚Äôt have it. In the case of a title, it works well, because <code>text</code> accepts a <code>content</code>.</p>\n<p>To sum up, ‚ÄúHow to access to the content of a <code>content</code>‚Äù ? If you think, it is another question, I open another thread.</p>",
      "raw": "@PgBiel and @xkevio I have thought to my problem. In the original question, the problem is that a `context` gives a content. Despite the content of the `content` is correct (it is a `dictionary`), I can't access to the content of the content itself.\n\nIt is like a picture, but you can see the object, but you don't have it. In the case of a title, it works well, because `text` accepts a `content`.\n\nTo sum up, \"How to access to the content of a `content`\" ? If you think, it is another question, I open another thread.",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 49,
      "score": 14.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 125
    },
    {
      "id": 1261,
      "post_number": 7,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-09-16T12:52:55.968Z",
      "updated_at": "2024-09-16T12:54:19.887Z",
      "cooked": "<p>Hey maucejo, recall this bit from my response:</p>\n<blockquote>\n<p>This is why querying a state value requires a <code>context { }</code> block (see explanation: <a href=\"https://typst.app/docs/reference/context/\">Context ‚Äì Typst Documentation</a>), which returns document content: the code inside it depends on where in the document it is evaluated, so the only way to know what the context block evaluates to is to place it <em>somewhere</em> in the document so it can use the correct values at that location.</p>\n</blockquote>\n<p>It returns content regardless of what your code evaluates to, because code inside it is sensitive to where it is located in the document, so if you could access what is returned inside the <code>context { }</code> block outside of it (without placing some content somewhere), it would always be the same value as it would not have a fixed location in the document (which only <code>content</code> can have), but that‚Äôs not what you want (code outside of <code>context { }</code> is evaluated early, before document layout, so it would have no way to be aware of state updates, current location and other context-aware information). So, instead of:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let value = context { value-state.get() + 5 }\n\n// Error: trying to access context-aware code\n// from non-context-aware code\n#let sum = value + 10\nThe sum is #sum\n</code></pre>\n<p>Instead indicate that <em>all of your relevant code</em> is context-aware and needs to be placed in the document to work, as such:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#context {\n   // Ok: All code depending on the context is\n   // encapsulated in a context block\n   let value = value-state.get() + 5\n   let sum = value + 10\n   [The sum is #sum]\n}\n</code></pre>\n<p>Note that if you have a function which depends on the context to return a value that isn‚Äôt content, you can simply have it not return <code>context</code> to allow users to access what it returns, as long as they themselves use <code>context</code>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// Don't:\n#let get-height() = context here().pos().y\n// Error: can't get contextual value from non-contextual code\n#let sum = get-height() + 5pt \n#sum\n\n// Do instead:\n#let get-height() = here().pos().y\n// Error: here() requires context, so this call fails\n#let sum = get-height() + 5pt \n\n// Ok: wrapping in context, we can access what get-height()\n// would return at this location\n#context {\n  let sum = get-height() + 5pt\n  sum\n}\n</code></pre>\n<p>For more information (and for further help on this matter), please check out this thread: <a href=\"https://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164/2\" class=\"inline-onebox\">Why is the value I receive from context always content? - #2 by laurmaedje</a></p>",
      "raw": "Hey maucejo, recall this bit from my response:\n\n> This is why querying a state value requires a `context { }` block (see explanation: [Context ‚Äì Typst Documentation](https://typst.app/docs/reference/context/)), which returns document content: the code inside it depends on where in the document it is evaluated, so the only way to know what the context block evaluates to is to place it *somewhere* in the document so it can use the correct values at that location.\n\nIt returns content regardless of what your code evaluates to, because code inside it is sensitive to where it is located in the document, so if you could access what is returned inside the `context { }` block outside of it (without placing some content somewhere), it would always be the same value as it would not have a fixed location in the document (which only `content` can have), but that's not what you want (code outside of `context { }` is evaluated early, before document layout, so it would have no way to be aware of state updates, current location and other context-aware information). So, instead of:\n\n```typ\n#let value = context { value-state.get() + 5 }\n\n// Error: trying to access context-aware code\n// from non-context-aware code\n#let sum = value + 10\nThe sum is #sum\n```\nInstead indicate that _all of your relevant code_ is context-aware and needs to be placed in the document to work, as such:\n\n```typ\n#context {\n   // Ok: All code depending on the context is\n   // encapsulated in a context block\n   let value = value-state.get() + 5\n   let sum = value + 10\n   [The sum is #sum]\n}\n```\n\nNote that if you have a function which depends on the context to return a value that isn't content, you can simply have it not return `context` to allow users to access what it returns, as long as they themselves use `context`:\n\n```typ\n// Don't:\n#let get-height() = context here().pos().y\n// Error: can't get contextual value from non-contextual code\n#let sum = get-height() + 5pt \n#sum\n\n// Do instead:\n#let get-height() = here().pos().y\n// Error: here() requires context, so this call fails\n#let sum = get-height() + 5pt \n\n// Ok: wrapping in context, we can access what get-height()\n// would return at this location\n#context {\n  let sum = get-height() + 5pt\n  sum\n}\n```\n\nFor more information (and for further help on this matter), please check out this thread: https://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164/2",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 48,
      "score": 79.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:58:55.695896"
}
{
  "topic_metadata": {
    "id": 2281,
    "title": "How can I initialize a genealotree family tree using data from a toml file?",
    "slug": "how-can-i-initialize-a-genealotree-family-tree-using-data-from-a-toml-file",
    "posts_count": 4,
    "created_at": "2025-01-02T22:53:50.723Z",
    "last_posted_at": "2025-01-03T18:33:30.789Z",
    "views": 102,
    "like_count": 4,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "LordBaryhobal",
    "tags": [
      "scripting",
      "data-loading"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 899
  },
  "posts": [
    {
      "id": 7153,
      "post_number": 1,
      "username": "grimnight",
      "name": "grimnight",
      "created_at": "2025-01-02T22:53:50.841Z",
      "updated_at": "2025-01-31T08:34:16.982Z",
      "cooked": "<p>I‚Äôm unable to get my modified script to work.</p>\n<p>The original script works fine:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#import \"@preview/genealotree:0.2.0\": *\n// https://codeberg.org/drloiseau/genealogy\n\n#import \"@preview/cetz:0.3.1\": canvas, draw\n#import draw: *\n\n#set page(width: auto, height: auto, margin: 1cm)\n#set text(size: 11pt)\n\n#let family-tree = genealogy-init()\n\n#(family-tree.config.union-dist = 5.5)\n#(family-tree.config.siblings-dist = 8)\n#(family-tree.config.union-vline = 3)\n#(family-tree.config.person-radius = 2)\n\n#let family-tree = add-persons(\n  family-tree,\n  (\n    \"1\": (sex: \"m\", label: \"1 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"2\": (sex: \"f\", label: \"2 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"3\": (sex: \"m\", label: \"3 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"4\": (sex: \"f\", label: \"4 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"5\": (sex: \"f\", label: \"5 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"6\": (sex: \"m\", label: \"6 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"7\": (sex: \"m\", label: \"7 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"8\": (sex: \"f\", label: \"8 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"9\": (sex: \"f\", label: \"9 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"10\": (sex: \"m\", label: \"10 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"11\": (sex: \"m\", label: \"11 name lastname\\n\\nm: 0000\\nd: 0000\"),\n  )\n)\n\n#let family-tree = add-unions(\n  family-tree,\n  ((\"1\", \"2\"), (\"3\", \"5\")),\n  ((\"3\", \"4\"), ()),\n  ((\"5\", \"6\"), (\"7\",)),\n  ((\"7\", \"8\"), (\"9\", \"10\", \"11\")),\n)\n\n#canvas({\n    // Draw the tree\n    draw-tree(family-tree)\n})\n</code></pre>\n<p>But when I updated my script to get it‚Äôs data from an external toml file,<br>\nI can‚Äôt get it to work.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#import \"@preview/genealotree:0.2.0\": *\n// https://codeberg.org/drloiseau/genealogy\n\n#import \"@preview/cetz:0.3.1\": canvas, draw\n#import draw: *\n\n#set page(width: auto, height: auto, margin: 1cm)\n#set text(size: 11pt)\n\n#let family-tree = genealogy-init()\n\n#(family-tree.config.union-dist = 5.5)\n#(family-tree.config.siblings-dist = 8)\n#(family-tree.config.union-vline = 3)\n#(family-tree.config.person-radius = 2)\n\n#let gen = toml(\"gen.toml\")\n\n#for c in gen.family_tree [\n  #let family-tree = add-persons(\n    family-tree,\n    (str(c.id): (sex: c.sex, label: c.label))\n  )\n]\n\n#for c in gen.unions.unions [\n  #let family-tree = add-unions(family-tree, (c.at(0), c.at(1)))\n]\n\n#canvas({\n    // Draw the tree\n    draw-tree(family-tree)\n})\n</code></pre>\n<p>And the toml:</p>\n<pre data-code-wrap=\"toml\"><code class=\"lang-toml\"># gen.toml\n\n[unions]\nunions = [\n  [[\"1\", \"2\"], [\"3\", \"5\"]],\n  [[\"3\", \"4\"], []],\n  [[\"5\", \"6\"], [\"7\",]],\n  [[\"7\", \"8\"], [\"9\", \"10\", \"11\"]]\n]\n\n[[family_tree]]\nid = 1\nsex = \"m\"\nlabel = \"1 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 2\nsex = \"f\"\nlabel = \"2 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 3\nsex = \"m\"\nlabel = \"3 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 4\nsex = \"f\"\nlabel = \"4 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 5\nsex = \"f\"\nlabel = \"5 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 6\nsex = \"m\"\nlabel = \"6 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 7\nsex = \"m\"\nlabel = \"7 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 8\nsex = \"f\"\nlabel = \"8 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 9\nsex = \"f\"\nlabel = \"9 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 10\nsex = \"m\"\nlabel = \"10 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 11\nsex = \"m\"\nlabel = \"11 name lastname\\n\\nm: 0000\\nd: 0000\"\n</code></pre>\n<p>How can I get my script to work?</p>",
      "raw": "I'm unable to get my modified script to work.\n\nThe original script works fine:\n```typst\n#import \"@preview/genealotree:0.2.0\": *\n// https://codeberg.org/drloiseau/genealogy\n\n#import \"@preview/cetz:0.3.1\": canvas, draw\n#import draw: *\n\n#set page(width: auto, height: auto, margin: 1cm)\n#set text(size: 11pt)\n\n#let family-tree = genealogy-init()\n\n#(family-tree.config.union-dist = 5.5)\n#(family-tree.config.siblings-dist = 8)\n#(family-tree.config.union-vline = 3)\n#(family-tree.config.person-radius = 2)\n\n#let family-tree = add-persons(\n  family-tree,\n  (\n    \"1\": (sex: \"m\", label: \"1 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"2\": (sex: \"f\", label: \"2 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"3\": (sex: \"m\", label: \"3 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"4\": (sex: \"f\", label: \"4 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"5\": (sex: \"f\", label: \"5 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"6\": (sex: \"m\", label: \"6 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"7\": (sex: \"m\", label: \"7 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"8\": (sex: \"f\", label: \"8 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"9\": (sex: \"f\", label: \"9 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"10\": (sex: \"m\", label: \"10 name lastname\\n\\nm: 0000\\nd: 0000\"),\n    \"11\": (sex: \"m\", label: \"11 name lastname\\n\\nm: 0000\\nd: 0000\"),\n  )\n)\n\n#let family-tree = add-unions(\n  family-tree,\n  ((\"1\", \"2\"), (\"3\", \"5\")),\n  ((\"3\", \"4\"), ()),\n  ((\"5\", \"6\"), (\"7\",)),\n  ((\"7\", \"8\"), (\"9\", \"10\", \"11\")),\n)\n\n#canvas({\n    // Draw the tree\n    draw-tree(family-tree)\n})\n```\n\nBut when I updated my script to get it's data from an external toml file,\nI can't get it to work.\n```typst\n#import \"@preview/genealotree:0.2.0\": *\n// https://codeberg.org/drloiseau/genealogy\n\n#import \"@preview/cetz:0.3.1\": canvas, draw\n#import draw: *\n\n#set page(width: auto, height: auto, margin: 1cm)\n#set text(size: 11pt)\n\n#let family-tree = genealogy-init()\n\n#(family-tree.config.union-dist = 5.5)\n#(family-tree.config.siblings-dist = 8)\n#(family-tree.config.union-vline = 3)\n#(family-tree.config.person-radius = 2)\n\n#let gen = toml(\"gen.toml\")\n\n#for c in gen.family_tree [\n  #let family-tree = add-persons(\n    family-tree,\n    (str(c.id): (sex: c.sex, label: c.label))\n  )\n]\n\n#for c in gen.unions.unions [\n  #let family-tree = add-unions(family-tree, (c.at(0), c.at(1)))\n]\n\n#canvas({\n    // Draw the tree\n    draw-tree(family-tree)\n})\n```\n\nAnd the toml:\n```toml\n# gen.toml\n\n[unions]\nunions = [\n  [[\"1\", \"2\"], [\"3\", \"5\"]],\n  [[\"3\", \"4\"], []],\n  [[\"5\", \"6\"], [\"7\",]],\n  [[\"7\", \"8\"], [\"9\", \"10\", \"11\"]]\n]\n\n[[family_tree]]\nid = 1\nsex = \"m\"\nlabel = \"1 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 2\nsex = \"f\"\nlabel = \"2 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 3\nsex = \"m\"\nlabel = \"3 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 4\nsex = \"f\"\nlabel = \"4 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 5\nsex = \"f\"\nlabel = \"5 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 6\nsex = \"m\"\nlabel = \"6 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 7\nsex = \"m\"\nlabel = \"7 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 8\nsex = \"f\"\nlabel = \"8 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 9\nsex = \"f\"\nlabel = \"9 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 10\nsex = \"m\"\nlabel = \"10 name lastname\\n\\nm: 0000\\nd: 0000\"\n\n[[family_tree]]\nid = 11\nsex = \"m\"\nlabel = \"11 name lastname\\n\\nm: 0000\\nd: 0000\"\n```\n\nHow can I get my script to work?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 291.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1001
    },
    {
      "id": 7164,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2025-01-03T06:06:05.657Z",
      "updated_at": "2025-01-03T06:06:05.657Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/grimnight\">@grimnight</a>,</p>\n<p>please be more specific with your question, what is not working? Version 1/2 of what?<br>\nTry to reduce your code to a minimal example with the same error.<br>\nI suspect you mean that version 0.2.0 of the genealotree package which was updated yesterday is not working for you. That is correct, as every package always needs to be manually approved by the Typst team. Therefore, as indicated in the error message, the package is not yet available. Since a few package updates have accumulated over the holidays, I believe it will take a few days next week for version 0.2.0 of the package to become available.</p>",
      "raw": "Hi @grimnight,\n\nplease be more specific with your question, what is not working? Version 1/2 of what?\nTry to reduce your code to a minimal example with the same error.\nI suspect you mean that version 0.2.0 of the genealotree package which was updated yesterday is not working for you. That is correct, as every package always needs to be manually approved by the Typst team. Therefore, as indicated in the error message, the package is not yet available. Since a few package updates have accumulated over the holidays, I believe it will take a few days next week for version 0.2.0 of the package to become available.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 50.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 7182,
      "post_number": 4,
      "username": "LordBaryhobal",
      "name": "Baryhobal",
      "created_at": "2025-01-03T17:54:25.813Z",
      "updated_at": "2025-01-03T17:54:25.813Z",
      "cooked": "<p>It seems like you are re-declaring your <code>family-tree</code> variable instead of re-assigning its value<br>\nThis is the end of your script:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let gen = toml(\"gen.toml\")\n \n#for c in gen.family_tree [\n  #let family-tree = add-persons(\n    family-tree,\n    (str(c.id): (sex: c.sex, label: c.label))\n  )\n]\n \n#for c in gen.unions.unions [\n  #let family-tree = add-unions(family-tree, (c.at(0), c.at(1)))\n]\n</code></pre>\n<p>Because of the <code>let</code> statements (and content blocks), the variable is never changed but re-declared for that specific block<br>\nYou cou rewrite it like so and it should work as expected (I haven‚Äôt tested it though):</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let gen = toml(\"gen.toml\")\n#let people = gen.family_tree.map(person =&gt; {\n  let id = str(person.id)\n  let value = (sex: person.sex, label: person.label)\n  return (id, value)\n}).to-dict()\n\n#let family-tree = add-persons(family-tree, people)\n#let family-tree = add-unions(family-tree, ..gen.unions.unions)\n</code></pre>\n<p>You can also write the last two lines as <code>#{family-tree = ...}</code></p>",
      "raw": "It seems like you are re-declaring your `family-tree` variable instead of re-assigning its value\nThis is the end of your script:\n```typ\n#let gen = toml(\"gen.toml\")\n \n#for c in gen.family_tree [\n  #let family-tree = add-persons(\n    family-tree,\n    (str(c.id): (sex: c.sex, label: c.label))\n  )\n]\n \n#for c in gen.unions.unions [\n  #let family-tree = add-unions(family-tree, (c.at(0), c.at(1)))\n]\n```\n\nBecause of the `let` statements (and content blocks), the variable is never changed but re-declared for that specific block\nYou cou rewrite it like so and it should work as expected (I haven't tested it though):\n```typ\n#let gen = toml(\"gen.toml\")\n#let people = gen.family_tree.map(person => {\n  let id = str(person.id)\n  let value = (sex: person.sex, label: person.label)\n  return (id, value)\n}).to-dict()\n\n#let family-tree = add-persons(family-tree, people)\n#let family-tree = add-unions(family-tree, ..gen.unions.unions)\n```\n\nYou can also write the last two lines as `#{family-tree = ...}`",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 23,
      "score": 29.6,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 585
    },
    {
      "id": 7183,
      "post_number": 5,
      "username": "grimnight",
      "name": "grimnight",
      "created_at": "2025-01-03T18:33:30.789Z",
      "updated_at": "2025-01-03T18:33:30.789Z",
      "cooked": "<p>Thank you <a class=\"mention\" href=\"/u/lordbaryhobal\">@LordBaryhobal</a> , I got it to work.</p>\n<p><a class=\"mention\" href=\"/u/flokl\">@flokl</a> and SillyFreak sorry, in hindsight I do realise that my request for help was poorly written.<br>\nI had been trying to get the script to work for a while and had been frustrated when I wrote my help request.</p>",
      "raw": "Thank you @LordBaryhobal , I got it to work.\n\n@flokl and SillyFreak sorry, in hindsight I do realise that my request for help was poorly written.\nI had been trying to get the script to work for a while and had been frustrated when I wrote my help request.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 23,
      "score": 19.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1001
    }
  ],
  "scraped_at": "2025-06-10T09:53:12.840970"
}
{
  "topic_metadata": {
    "id": 2283,
    "title": "How to make custom selectors?",
    "slug": "how-to-make-custom-selectors",
    "posts_count": 2,
    "created_at": "2025-01-03T03:44:16.140Z",
    "last_posted_at": "2025-01-03T11:38:39.823Z",
    "views": 114,
    "like_count": 0,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 207
  },
  "posts": [
    {
      "id": 7158,
      "post_number": 1,
      "username": "gabe",
      "name": "",
      "created_at": "2025-01-03T03:44:16.304Z",
      "updated_at": "2025-01-04T00:13:53.569Z",
      "cooked": "<p>Is it possible to make a reusable show query that would achieve the same thing as this?</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">show metadata: metadata =&gt; {\n  if {\n    // some function that return a boolean\n    not is-metadata-with-id(metadata)\n  } or {\n    // another arbitrary boolean function\n    metadata.value.id != tag(\"xlink\")\n  } {\n    // skip\n    return metadata\n  }\n  // start actual show rule\n}\n</code></pre>",
      "raw": "Is it possible to make a reusable show query that would achieve the same thing as this?\n\n```typc\nshow metadata: metadata => {\n  if {\n    // some function that return a boolean\n    not is-metadata-with-id(metadata)\n  } or {\n    // another arbitrary boolean function\n    metadata.value.id != tag(\"xlink\")\n  } {\n    // skip\n    return metadata\n  }\n  // start actual show rule\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 311.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 433
    },
    {
      "id": 7169,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-03T11:38:39.823Z",
      "updated_at": "2025-01-03T11:39:10.968Z",
      "cooked": "<p>Truly custom <a href=\"https://typst.app/docs/reference/foundations/selector/\">selectors</a> (I think that‚Äôs the word you‚Äôre looking for, maybe edit it in the title) are not supported, but you can probably use the technique shown here: <a href=\"https://forum.typst.app/t/how-can-i-create-show-rules-in-a-loop/952/2#p-3469-actually-generating-show-rules-in-a-loop-3\" class=\"inline-onebox\">How can I create show rules in a loop? - #2 by SillyFreak</a></p>\n<p>In that post‚Äôs example, you first go from</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show \"foo\": strong\n#show \"baz\": strong\n</code></pre>\n<p>to</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show: body =&gt; {\n  show \"foo\": strong\n  show \"baz\": strong\n\n  body\n}\n</code></pre>\n<p>The benefit is that now you don‚Äôt need to handle show rules as values, but a function, and Typst is functional and can thus do that.</p>\n<p>You would want to go from</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show metadata: metadata =&gt; ...\n</code></pre>\n<p>to</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show: metadata-with-id(\"xlink\", metadata =&gt; ...)\n</code></pre>\n<p>I‚Äôll leave writing <code>metadata-with-id</code> for you, but I can also help if you need it.</p>",
      "raw": "Truly custom [selectors](https://typst.app/docs/reference/foundations/selector/) (I think that's the word you're looking for, maybe edit it in the title) are not supported, but you can probably use the technique shown here: https://forum.typst.app/t/how-can-i-create-show-rules-in-a-loop/952/2?u=sillyfreak#p-3469-actually-generating-show-rules-in-a-loop-3\n\nIn that post's example, you first go from\n```typ\n#show \"foo\": strong\n#show \"baz\": strong\n```\nto\n```typ\n#show: body => {\n  show \"foo\": strong\n  show \"baz\": strong\n\n  body\n}\n```\nThe benefit is that now you don't need to handle show rules as values, but a function, and Typst is functional and can thus do that.\n\nYou would want to go from\n```typ\n#show metadata: metadata => ...\n```\nto\n```typ\n#show: metadata-with-id(\"xlink\", metadata => ...)\n```\nI'll leave writing `metadata-with-id` for you, but I can also help if you need it.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 10.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:53:12.034129"
}
