{
  "topic_metadata": {
    "id": 3666,
    "title": "How to add spacing after an horizontal line in the footer?",
    "slug": "how-to-add-spacing-after-an-horizontal-line-in-the-footer",
    "posts_count": 3,
    "created_at": "2025-04-15T17:26:05.769Z",
    "last_posted_at": "2025-04-15T18:03:47.328Z",
    "views": 67,
    "like_count": 2,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "janekfleper",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 385
  },
  "posts": [
    {
      "id": 11121,
      "post_number": 1,
      "username": "Mark_Pinsley",
      "name": "Mark Pinsley",
      "created_at": "2025-04-15T17:26:05.869Z",
      "updated_at": "2025-04-17T04:48:50.752Z",
      "cooked": "<p>Hi, I’m having trouble figuring out what I’m doing wrong—perhaps it’s something simple. I’m trying to create a footer that includes:</p>\n<ul>\n<li>A horizontal line at the top</li>\n<li>Left-aligned text</li>\n<li>Right-aligned page numbering</li>\n<li>Some vertical space between the horizontal line and the text below it</li>\n</ul>\n<p>The issue is that when I try to add spacing after the horizontal line, it throws off the left and right alignment of the footer content. I’ve tried adding the space before defining the columns, and I’ve also tried inserting it within the grid rows, but I haven’t been able to get it to work as intended.</p>\n<p>Any guidance would be appreciated.</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">footer: context [\n  #grid(\n    // Line above footer\n    grid.hline(stroke: 1pt + rgb(\"#C3A463\")),\n    columns: (1fr, 1fr),\n    align: (left, right),\n    //[#v(6pt),#v(6pt)],\n    // Two separate cells: left and right\n    [ Lehigh County, Office of the Controller ],  // left cell\n    [ #counter(page).display(\"1/1\", both: true) ], // right cell\n  \n  )\n</code></pre>",
      "raw": "Hi, I'm having trouble figuring out what I’m doing wrong—perhaps it’s something simple. I'm trying to create a footer that includes:\n\n* A horizontal line at the top\n* Left-aligned text\n* Right-aligned page numbering\n* Some vertical space between the horizontal line and the text below it\n\nThe issue is that when I try to add spacing after the horizontal line, it throws off the left and right alignment of the footer content. I’ve tried adding the space before defining the columns, and I’ve also tried inserting it within the grid rows, but I haven’t been able to get it to work as intended.\n\nAny guidance would be appreciated. \n\n```typc\nfooter: context [\n  #grid(\n    // Line above footer\n    grid.hline(stroke: 1pt + rgb(\"#C3A463\")),\n    columns: (1fr, 1fr),\n    align: (left, right),\n    //[#v(6pt),#v(6pt)],\n    // Two separate cells: left and right\n    [ Lehigh County, Office of the Controller ],  // left cell\n    [ #counter(page).display(\"1/1\", both: true) ], // right cell\n  \n  )\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 153.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1458
    },
    {
      "id": 11122,
      "post_number": 2,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-04-15T17:36:41.806Z",
      "updated_at": "2025-04-15T18:02:35.056Z",
      "cooked": "<p>Is there a reason why you need/want to use a grid? If not, it would be much simpler to use a regular horizontal line, and then a horizontal spacing <code>h(1fr)</code> to make the text left-aligned and the page counter right-aligned.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(footer: context {\n  line(length: 100%)\n  \"Lehigh County, Office of the Controller\"\n  h(1fr)\n  counter(page).display(\"1/1\", both: true)\n})\n</code></pre>\n<p>This will automatically give you some vertical spacing between the line and the text below it. You could further adjust this by including a (negative) <code>v()</code> after the line.</p>\n<p>And two general things:</p>\n<ul>\n<li>Please use the <a class=\"hashtag-cooked\" href=\"/c/questions/5\" data-type=\"category\" data-slug=\"questions\" data-id=\"5\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>Questions</span></a> category for posts that are clearly questions. And the title should be something you would ask a friend, e.g. “How do I change the layout of text and page numbering in the footer?”</li>\n<li>If you include (Typst) code in your post, please wrap it in <code>```typ ... ```</code> to get syntax highlighting. This makes it much easier to read your code.</li>\n</ul>\n<p>For the official “how-to” on posting questions, please see the post below.</p><aside class=\"quote quote-modified\" data-post=\"1\" data-topic=\"11\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/reknih/48/3_2.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">How to post in the Questions category</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    Your questions about using Typst and the web app go in this category. \nThis category should be a useful resource for both those who post questions and those who later search it for answers. To get there, we ask you to keep in mind the following if you ask a question: \n<a name=\"p-29-the-basics-1\" class=\"anchor\" href=\"#p-29-the-basics-1\"></a>The Basics\nEach post should contain one distinct question on Typst. If you have multiple questions, do not hesitate to create multiple posts! Posts that are discussions or otherwise not questions looking for help should go into the…\n  </blockquote>\n</aside>\n",
      "raw": "Is there a reason why you need/want to use a grid? If not, it would be much simpler to use a regular horizontal line, and then a horizontal spacing `h(1fr)` to make the text left-aligned and the page counter right-aligned.\n\n```typ\n#set page(footer: context {\n  line(length: 100%)\n  \"Lehigh County, Office of the Controller\"\n  h(1fr)\n  counter(page).display(\"1/1\", both: true)\n})\n```\n\nThis will automatically give you some vertical spacing between the line and the text below it. You could further adjust this by including a (negative) `v()` after the line.\n\nAnd two general things:\n- Please use the #questions category for posts that are clearly questions. And the title should be something you would ask a friend, e.g. \"How do I change the layout of text and page numbering in the footer?\"\n- If you include (Typst) code in your post, please wrap it in ` ```typ ... ``` ` to get syntax highlighting. This makes it much easier to read your code.\n\nFor the official \"how-to\" on posting questions, please see the post below.\nhttps://forum.typst.app/t/how-to-post-in-the-questions-category/11",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 18,
      "score": 38.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 11125,
      "post_number": 3,
      "username": "Mark_Pinsley",
      "name": "Mark Pinsley",
      "created_at": "2025-04-15T18:03:47.328Z",
      "updated_at": "2025-04-15T18:03:47.328Z",
      "cooked": "<p>Thank you. That worked. I am still learning the Typst vocabulary :)  This works much better than what I did. I assumed I needed to cells. Thank you also for the How to post!</p>",
      "raw": "Thank you. That worked. I am still learning the Typst vocabulary :)  This works much better than what I did. I assumed I needed to cells. Thank you also for the How to post!",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 3.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1458
    }
  ],
  "scraped_at": "2025-06-10T09:49:09.287883"
}
{
  "topic_metadata": {
    "id": 3667,
    "title": "How to hide an outline if there are no entries?",
    "slug": "how-to-hide-an-outline-if-there-are-no-entries",
    "posts_count": 4,
    "created_at": "2025-04-15T17:40:05.880Z",
    "last_posted_at": "2025-04-15T19:01:15.616Z",
    "views": 55,
    "like_count": 4,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "janekfleper",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 401
  },
  "posts": [
    {
      "id": 11123,
      "post_number": 1,
      "username": "Aaron",
      "name": "Aaron",
      "created_at": "2025-04-15T17:40:06.024Z",
      "updated_at": "2025-04-15T18:02:49.483Z",
      "cooked": "<p>How can I hide and outline if it has no entries to display? I believe I should be able to use <code>#if</code> and <code>#counter</code> to make this work (and maybe <code>#context</code>), but I have not wrapped my head around how counters work.</p>\n<p>I have a template I am using to make documents. The template includes the creation of outlines.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">  #outline(\n    title: [Table of Contents],\n  )\n\n  #outline(\n    title: [List of Figures],\n    target: figure.where(kind: image),\n  )\n\n  #outline(\n    title: [List of Tables],\n    target: figure.where(kind: table),\n  )\n</code></pre>\n<p>However, if the document does not use any figures or tables, the outline just prints a title with no entries. In this case, I would like the title to not show at all.</p>\n<pre><code class=\"lang-auto\">    TABLE OF CONTENTS\n1. XXXX\n2. XXXX\n\n    LIST OF FIGURES\n\n    LIST OF TABLES\n</code></pre>\n<p>I believe I should be able to do something like</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#if (context{counter(figure.where(kind: table)).final()} &gt; 0) [\n  #outline(\n    title: [List of Tables],\n    target: figure.where(kind: table),\n  )\n]\n</code></pre>\n<p>But I get this error:</p>\n<pre data-code-wrap=\"sh\"><code class=\"lang-sh\">$ typst compile main.typ \nerror: expected boolean, found content\n   ┌─ main.typ:12:4\n   │\n12 │ #if (context{counter(figure.where(kind: table)).final()} &gt; 0) [\n   │     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n<p>Thanks!</p>",
      "raw": "How can I hide and outline if it has no entries to display? I believe I should be able to use `#if` and `#counter` to make this work (and maybe `#context`), but I have not wrapped my head around how counters work.\n\nI have a template I am using to make documents. The template includes the creation of outlines.\n\n```typ\n  #outline(\n    title: [Table of Contents],\n  )\n\n  #outline(\n    title: [List of Figures],\n    target: figure.where(kind: image),\n  )\n\n  #outline(\n    title: [List of Tables],\n    target: figure.where(kind: table),\n  )\n```\n\nHowever, if the document does not use any figures or tables, the outline just prints a title with no entries. In this case, I would like the title to not show at all.\n\n```\n    TABLE OF CONTENTS\n1. XXXX\n2. XXXX\n\n    LIST OF FIGURES\n\n    LIST OF TABLES\n```\n\nI believe I should be able to do something like \n\n```typ\n#if (context{counter(figure.where(kind: table)).final()} > 0) [\n  #outline(\n    title: [List of Tables],\n    target: figure.where(kind: table),\n  )\n]\n```\n\nBut I get this error:\n```sh\n$ typst compile main.typ \nerror: expected boolean, found content\n   ┌─ main.typ:12:4\n   │\n12 │ #if (context{counter(figure.where(kind: table)).final()} > 0) [\n   │     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n```\n\nThanks!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 139.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1398
    },
    {
      "id": 11124,
      "post_number": 2,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-04-15T17:56:38.489Z",
      "updated_at": "2025-04-15T18:01:49.849Z",
      "cooked": "<p>Your approach will work if you wrap everything in <code>context()</code>. Right now the context will return content (which it always does, see this <a href=\"https://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164\">post</a> if you want to learn more about the details), causing the error on compilation.</p>\n<p>Note that <a href=\"https://typst.app/docs/reference/introspection/counter/#definitions-final\"><code>counter.final()</code></a> always returns an array of integers. I therefore had to append <code>.at(0)</code> to get the first element from the array.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#context {\n  if counter(figure.where(kind: table)).final().at(0) &gt; 0 {\n    outline(\n      title: [List of Tables],\n      target: figure.where(kind: table),\n    )\n  }\n}\n</code></pre>\n<p>I would also ask you to move your post to the <a class=\"hashtag-cooked\" href=\"/c/questions/5\" data-type=\"category\" data-slug=\"questions\" data-id=\"5\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>Questions</span></a> category. The title is already great. <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Your approach will work if you wrap everything in `context()`. Right now the context will return content (which it always does, see this [post](https://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164) if you want to learn more about the details), causing the error on compilation.\n\nNote that [`counter.final()`](https://typst.app/docs/reference/introspection/counter/#definitions-final) always returns an array of integers. I therefore had to append `.at(0)` to get the first element from the array.\n\n```typ\n#context {\n  if counter(figure.where(kind: table)).final().at(0) > 0 {\n    outline(\n      title: [List of Tables],\n      target: figure.where(kind: table),\n    )\n  }\n}\n```\n\nI would also ask you to move your post to the #questions category. The title is already great. :slight_smile:",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 14.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 11126,
      "post_number": 3,
      "username": "Aaron",
      "name": "Aaron",
      "created_at": "2025-04-15T18:08:31.918Z",
      "updated_at": "2025-04-15T18:08:31.918Z",
      "cooked": "<p>That worked great, thank you!</p>\n<p>I guess <code>#context</code> is what I really need to wrap my head around.</p>",
      "raw": "That worked great, thank you!\n\nI guess `#context` is what I really need to wrap my head around.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 3.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1398
    },
    {
      "id": 11128,
      "post_number": 4,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2025-04-15T19:01:15.616Z",
      "updated_at": "2025-04-15T19:01:15.616Z",
      "cooked": "<p>Another simple and more general solution would be to apply a show rule, which only allows the outline to show up when there are elements it could list:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show outline: it =&gt; if query(it.target) != () { it }\n</code></pre>\n<p>You then only have to write this once, and it works for all subsequent outlines, no matter if it targets headings, figures, tables, or something else.</p>",
      "raw": "Another simple and more general solution would be to apply a show rule, which only allows the outline to show up when there are elements it could list:\n\n```typ\n#show outline: it => if query(it.target) != () { it }\n```\n\nYou then only have to write this once, and it works for all subsequent outlines, no matter if it targets headings, figures, tables, or something else.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 4,
      "reads": 18,
      "score": 93.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 88
    }
  ],
  "scraped_at": "2025-06-10T09:49:08.555888"
}
{
  "topic_metadata": {
    "id": 3684,
    "title": "How do I disable change of != to ≠ in raw text / code?",
    "slug": "how-do-i-disable-change-of-to-in-raw-text-code",
    "posts_count": 4,
    "created_at": "2025-04-16T14:26:51.965Z",
    "last_posted_at": "2025-04-17T15:17:25.583Z",
    "views": 70,
    "like_count": 5,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "bluss",
    "tags": [
      "layout",
      "fonts",
      "symbols"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 218
  },
  "posts": [
    {
      "id": 11163,
      "post_number": 1,
      "username": "the_d_d",
      "name": "D D",
      "created_at": "2025-04-16T14:26:52.070Z",
      "updated_at": "2025-04-18T20:34:41.988Z",
      "cooked": "<p>Hi, I have a problem that the code in my raw blocks (```) is being rendered in the pdf-preview (and export) in it’s unicode representation. E.g. != is ≠ and same with smaller than / greater than.</p>\n<p>How can I prevent/disable this?</p>",
      "raw": "Hi, I have a problem that the code in my raw blocks (```) is being rendered in the pdf-preview (and export) in it's unicode representation. E.g. != is ≠ and same with smaller than / greater than. \n\nHow can I prevent/disable this?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 80.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1468
    },
    {
      "id": 11165,
      "post_number": 2,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-16T14:37:02.842Z",
      "updated_at": "2025-04-16T14:38:37.824Z",
      "cooked": "<p>Hi, this depends on the font. You’re probably using some font with a ligature feature that creates the not equal symbol for you, I don’t think that happens with Typst’s default font. See the example below for <a href=\"https://github.com/typst/typst/issues/2871#issuecomment-1892596462\" rel=\"noopener nofollow ugc\">how to turn it off for Fira Code</a>, the very last raw block, which is my best guess at which font you are using.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">```\nThis is != what I want\n```\n#show raw: set text(font: \"Fira Code\")\n```\nThis is != what I want\n```\n#show raw: set text(font: \"Fira Code\", features: (\"calt\":0))\n```\nThis is != what I want\n```\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/6/606f8c91ebf11537dca4649fadaa8d543e05c073.png\" alt=\"bild\" data-base62-sha1=\"dL6PsyRYhHK8m4N6zvcMg4LCUq7\" width=\"412\" height=\"166\"></p>\n<p>If you are using a different font, just report back with which font you are using, Typst can maybe even tell you</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show raw: it =&gt; context text.font\n#raw(\"\")\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/f/f2e329a349456035e64df67f1ecff827bb9d683f.png\" alt=\"bild\" data-base62-sha1=\"yEGeYCyxZfPMlGR4sH2grqlgEub\" width=\"155\" height=\"35\"></p>",
      "raw": "Hi, this depends on the font. You're probably using some font with a ligature feature that creates the not equal symbol for you, I don't think that happens with Typst's default font. See the example below for [how to turn it off for Fira Code](https://github.com/typst/typst/issues/2871#issuecomment-1892596462), the very last raw block, which is my best guess at which font you are using.\n\n\n````typ\n```\nThis is != what I want\n```\n#show raw: set text(font: \"Fira Code\")\n```\nThis is != what I want\n```\n#show raw: set text(font: \"Fira Code\", features: (\"calt\":0))\n```\nThis is != what I want\n```\n````\n\n\n![bild|412x166](upload://dL6PsyRYhHK8m4N6zvcMg4LCUq7.png)\n\nIf you are using a different font, just report back with which font you are using, Typst can maybe even tell you\n\n```typ\n#show raw: it => context text.font\n#raw(\"\")\n```\n![bild|155x35](upload://yEGeYCyxZfPMlGR4sH2grqlgEub.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 28,
      "score": 55.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 11166,
      "post_number": 3,
      "username": "the_d_d",
      "name": "D D",
      "created_at": "2025-04-16T14:39:49.633Z",
      "updated_at": "2025-04-16T14:39:49.633Z",
      "cooked": "<p>Thanks, it was in fact “Fira Code” so your solution worked perfectly.</p>\n<p>Have a great day! <img src=\"https://forum.typst.app/images/emoji/apple/blush.png?v=12\" title=\":blush:\" class=\"emoji\" alt=\":blush:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Thanks, it was in fact \"Fira Code\" so your solution worked perfectly.\n\nHave a great day! :blush:",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 5.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1468
    },
    {
      "id": 11242,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-17T15:17:25.583Z",
      "updated_at": "2025-04-17T15:17:25.583Z",
      "cooked": "<p>Some other fonts should work with</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show raw: set text(ligatures: false)\n</code></pre>",
      "raw": "Some other fonts should work with\n\n```typ\n#show raw: set text(ligatures: false)\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 19,
      "score": 48.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:49:07.859128"
}
{
  "topic_metadata": {
    "id": 3696,
    "title": "How safe is that keeping your academic works in GitHub?",
    "slug": "how-safe-is-that-keeping-your-academic-works-in-github",
    "posts_count": 7,
    "created_at": "2025-04-17T07:54:04.003Z",
    "last_posted_at": "2025-04-17T16:13:52.665Z",
    "views": 100,
    "like_count": 3,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "quachpas",
    "tags": [],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 730
  },
  "posts": [
    {
      "id": 11207,
      "post_number": 1,
      "username": "ertugruluyar",
      "name": "Ertuğrul Uyar",
      "created_at": "2025-04-17T07:54:04.087Z",
      "updated_at": "2025-04-17T07:54:04.087Z",
      "cooked": "<p>I am wondering that if I keep my academic works in GitHub, would be a problem related plagiarism?</p>\n<p>Or, should I use <a href=\"https://codeberg.org/\" rel=\"noopener nofollow ugc\">Codeberg</a> or GitLab etc?</p>\n<p>Has <a href=\"http://Typst.app\" rel=\"noopener nofollow ugc\">Typst.app</a> a specific implementation to keep data safe?</p>",
      "raw": "I am wondering that if I keep my academic works in GitHub, would be a problem related plagiarism?\n\nOr, should I use [Codeberg](https://codeberg.org/) or GitLab etc?\n\nHas Typst.app a specific implementation to keep data safe?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 40,
      "score": 73.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1389
    },
    {
      "id": 11208,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-04-17T08:07:08.867Z",
      "updated_at": "2025-04-17T08:07:08.867Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/ertugruluyar\">@ertugruluyar</a>,</p>\n<p>Like any security question, you must first define your threat model. What are you trying to defend against? If you are worried about plagiarism of your work during its conception, before you publish, then yes having a public repository on GitHub is probably a bad idea. A rival actor could “take over” and publish faster based on your work.</p>\n<p>For the webapp, as long as you don’t share your project publicly, I don’t see any reason that your work would be disclosed without your agreement. Relying on a third-party means you trust them to keep your data safe, if you read the terms &amp; conditions, you will see</p>\n<blockquote>\n<p><a href=\"https://typst.app/terms#:~:text=Typst%20will%20take%20state%2Dof%2Dthe%2Dart%20steps%20to%20secure%20the%20data.%20Nonetheless%2C%20Typst%20has%20no%20duty%20of%20safekeeping%20or%20care%20with%20regard%20to%20the%20data.%20The%20customer%20is%20responsible%20for%20adequately%20backing%20up%20the%20data\">Typst will take state-of-the-art steps to secure the data. Nonetheless, Typst has no duty of safekeeping or care with regard to the data. The customer is responsible for adequately backing up the data.</a></p>\n</blockquote>\n<p>If you do not trust Typst GmbH to keep your data secure, then you can ask for an on-premises instance, see <a href=\"https://typst.app/pricing/\" class=\"inline-onebox\">Typst: Pricing</a>. However, that means <strong>you</strong> are in charge of security.</p>\n<p>The same reasoning applies to other forges like Codeberg, GitLab, or other services like Overleaf.</p>",
      "raw": "Hello @ertugruluyar,\n\nLike any security question, you must first define your threat model. What are you trying to defend against? If you are worried about plagiarism of your work during its conception, before you publish, then yes having a public repository on GitHub is probably a bad idea. A rival actor could \"take over\" and publish faster based on your work. \n\nFor the webapp, as long as you don't share your project publicly, I don't see any reason that your work would be disclosed without your agreement. Relying on a third-party means you trust them to keep your data safe, if you read the terms & conditions, you will see\n\n> [Typst will take state-of-the-art steps to secure the data. Nonetheless, Typst has no duty of safekeeping or care with regard to the data. The customer is responsible for adequately backing up the data.](https://typst.app/terms#:~:text=Typst%20will%20take%20state%2Dof%2Dthe%2Dart%20steps%20to%20secure%20the%20data.%20Nonetheless%2C%20Typst%20has%20no%20duty%20of%20safekeeping%20or%20care%20with%20regard%20to%20the%20data.%20The%20customer%20is%20responsible%20for%20adequately%20backing%20up%20the%20data)\n\nIf you do not trust Typst GmbH to keep your data secure, then you can ask for an on-premises instance, see https://typst.app/pricing/. However, that means __you__ are in charge of security.\n\nThe same reasoning applies to other forges like Codeberg, GitLab, or other services like Overleaf.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 40,
      "score": 33.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 11210,
      "post_number": 3,
      "username": "ertugruluyar",
      "name": "Ertuğrul Uyar",
      "created_at": "2025-04-17T08:41:12.737Z",
      "updated_at": "2025-04-17T08:41:12.737Z",
      "cooked": "<p>Thank you <a class=\"mention\" href=\"/u/quachpas\">@quachpas</a>. The threats are the plagiarism softwares. Sorry, I forget to add the how I worried. I mean, Microsoft using the data from GitHub to training their AI, so if <a href=\"https://www.turnitin.com\" rel=\"noopener nofollow ugc\">Turnitin</a> etc. index those data then when I check the plagiarism via this softwares, could be an plagiarism issue. Right?</p>\n<p>So, even if keep my repository private, would be a problem?</p>",
      "raw": "Thank you @quachpas. The threats are the plagiarism softwares. Sorry, I forget to add the how I worried. I mean, Microsoft using the data from GitHub to training their AI, so if [Turnitin](https://www.turnitin.com) etc. index those data then when I check the plagiarism via this softwares, could be an plagiarism issue. Right?\n\nSo, even if keep my repository private, would be a problem?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 12.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1389
    },
    {
      "id": 11211,
      "post_number": 4,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-04-17T08:49:02.884Z",
      "updated_at": "2025-04-17T08:49:02.884Z",
      "cooked": "<p>See <a href=\"https://docs.github.com/en/copilot/managing-copilot/managing-copilot-as-an-individual-subscriber/managing-your-copilot-plan/managing-copilot-policies-as-an-individual-subscriber#model-training-and-improvements\" class=\"inline-onebox\">Managing Copilot policies as an individual subscriber - GitHub Docs</a>. By default GitHub should not use your data to train their AI.</p>\n<p>That does not prevent third-parties from adding your code to their dataset if it is publicly accessible.</p>\n<p>If your work is detected as a plausible plagiarism of your own work, i.e., self-plagiarism, (that happens quite often with master’s thesis and subsequent publications), then it is quite trivial to resolve the plagiarism case. Be aware that some publishing venues explicitly refuse to publish work that is too similar to already published works, e.g., publishing a paper based on your master’s thesis.  See <a href=\"https://link.springer.com/article/10.1007/s10805-009-9092-1\" class=\"inline-onebox\">Self-Plagiarism or Appropriate Textual Re-use? | Journal of Academic Ethics</a> for a discussion on this topic.</p>",
      "raw": "See https://docs.github.com/en/copilot/managing-copilot/managing-copilot-as-an-individual-subscriber/managing-your-copilot-plan/managing-copilot-policies-as-an-individual-subscriber#model-training-and-improvements. By default GitHub should not use your data to train their AI.\n\nThat does not prevent third-parties from adding your code to their dataset if it is publicly accessible. \n\nIf your work is detected as a plausible plagiarism of your own work, i.e., self-plagiarism, (that happens quite often with master's thesis and subsequent publications), then it is quite trivial to resolve the plagiarism case. Be aware that some publishing venues explicitly refuse to publish work that is too similar to already published works, e.g., publishing a paper based on your master's thesis.  See https://link.springer.com/article/10.1007/s10805-009-9092-1 for a discussion on this topic.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 37,
      "score": 22.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 11212,
      "post_number": 5,
      "username": "ertugruluyar",
      "name": "Ertuğrul Uyar",
      "created_at": "2025-04-17T08:51:50.918Z",
      "updated_at": "2025-04-17T08:57:35.635Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/quachpas\">@quachpas</a> So, technically, if I keep my repository private, couldn’t be a problem then, right?<br>\nI disabled the settings in my GitHub account:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/5/5249c827306980bffde6a39bb4d3f9e1f257d479.png\" data-download-href=\"https://forum.typst.app/uploads/default/5249c827306980bffde6a39bb4d3f9e1f257d479\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/5/5249c827306980bffde6a39bb4d3f9e1f257d479_2_690x273.png\" alt=\"image\" data-base62-sha1=\"bJXee22Ojzg7X1PfCROyOOMp9IR\" width=\"690\" height=\"273\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/5/5249c827306980bffde6a39bb4d3f9e1f257d479_2_690x273.png, https://forum.typst.app/uploads/default/optimized/2X/5/5249c827306980bffde6a39bb4d3f9e1f257d479_2_1035x409.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/5/5249c827306980bffde6a39bb4d3f9e1f257d479_2_1380x546.png 2x\" data-dominant-color=\"13181E\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1908×756 107 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "@quachpas So, technically, if I keep my repository private, couldn't be a problem then, right?\nI disabled the settings in my GitHub account:\n![image|690x273](upload://bJXee22Ojzg7X1PfCROyOOMp9IR.png)",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 37,
      "score": 32.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1389
    },
    {
      "id": 11245,
      "post_number": 6,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-17T15:57:08.747Z",
      "updated_at": "2025-04-17T15:59:20.751Z",
      "cooked": "<p>Realistically, it shouldn’t be a problem with a public repository, but especially with the private one.</p>\n<p>As to data collection, it was stated many times throughout the Internet that <a href=\"http://github.com\" rel=\"noopener nofollow ugc\">github.com</a> and <a href=\"http://gitlab.com\" rel=\"noopener nofollow ugc\">gitlab.com</a> are for-profit companies (their websites), so it’s for you to decide if you trust them or not. I’ve seen a few claims that GitHub does train on public data, otherwise how can they train the model. Not sure about private repos. It’s run under Microsoft. I don’t trust that company, which is one of the reasons that I don’t use any of their stuff, except, well, the GitHub, because this is the only place where I can create an issue or a pull request to Typst or some other FOSS projects that I use.</p>\n<p>So if secret data usage is an issue, my advice is to use a privacy focused cloud storage provider like MEGA or Git hosting service like Codeberg. Although, you still have to trust these companies.</p>\n<p>You can just have backups on other storage devices or make your own Git service with Gitea, Forgejo, GitLab, etc.</p>",
      "raw": "Realistically, it shouldn't be a problem with a public repository, but especially with the private one.\n\nAs to data collection, it was stated many times throughout the Internet that github.com and gitlab.com are for-profit companies (their websites), so it's for you to decide if you trust them or not. I've seen a few claims that GitHub does train on public data, otherwise how can they train the model. Not sure about private repos. It's run under Microsoft. I don't trust that company, which is one of the reasons that I don't use any of their stuff, except, well, the GitHub, because this is the only place where I can create an issue or a pull request to Typst or some other FOSS projects that I use.\n\nSo if secret data usage is an issue, my advice is to use a privacy focused cloud storage provider like MEGA or Git hosting service like Codeberg. Although, you still have to trust these companies.\n\nYou can just have backups on other storage devices or make your own Git service with Gitea, Forgejo, GitLab, etc.",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 26.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11247,
      "post_number": 7,
      "username": "ertugruluyar",
      "name": "Ertuğrul Uyar",
      "created_at": "2025-04-17T16:13:52.665Z",
      "updated_at": "2025-04-17T16:13:52.665Z",
      "cooked": "<p>Thank you so much for the suggestions, I couldn’t trust Microsoft %100 either. I will consider using Codeberg.</p>",
      "raw": "Thank you so much for the suggestions, I couldn't trust Microsoft %100 either. I will consider using Codeberg.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 20.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1389
    }
  ],
  "scraped_at": "2025-06-10T09:49:04.696469"
}
{
  "topic_metadata": {
    "id": 3697,
    "title": "Space inserted to the end of a line in the source code",
    "slug": "space-inserted-to-the-end-of-a-line-in-the-source-code",
    "posts_count": 11,
    "created_at": "2025-04-17T08:10:04.941Z",
    "last_posted_at": "2025-04-17T16:08:47.079Z",
    "views": 72,
    "like_count": 11,
    "reply_count": 7,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "bluss",
    "tags": [
      "spacing"
    ],
    "category_id": 5,
    "participant_count": 5,
    "word_count": 1318
  },
  "posts": [
    {
      "id": 11209,
      "post_number": 1,
      "username": "Roberto",
      "name": "Roberto Giacomelli",
      "created_at": "2025-04-17T08:10:05.098Z",
      "updated_at": "2025-04-17T10:49:42.045Z",
      "cooked": "<p>Hi there,<br>\nI’m new of Typst and I started to explore the user experience as an old LaTeX user.<br>\nI’m writing a code to typeset multiple boxes one after the other.<br>\nEvery box is width 32pt and has a centered text inside as follow:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#[\n    #set box(\n      outset: 0pt,\n      inset: 0pt,\n      stroke:0.2pt,\n      width:32pt,\n    )\n    #set align(center)\n    #box[1]\n    #box[4]\n    #box[6]\n    #box[4]\n    #box[1]\n]\n</code></pre>\n<p>Typst leaves a space among the boxes. To avoid those spaces the only way I found is make a one line istruction like:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#[\n    // options as before\n    #box[1]#box[4]#box[6]#box[4]#box[1]\n]\n</code></pre>\n<p>It’s not a problem but if the content inside the boxes becomes more complex than a single letter the user may will write every box in a single dedicated line for clearness.<br>\nIn LaTeX is simply a matter to add an ending comment sign % but in Typst this is not the case.<br>\nHow to eliminate the spurious spaces? Something of a par option?<br>\nThank you.<br>\nRoberto</p>",
      "raw": "Hi there,\nI'm new of Typst and I started to explore the user experience as an old LaTeX user.\nI'm writing a code to typeset multiple boxes one after the other.\nEvery box is width 32pt and has a centered text inside as follow:\n\n```typ\n#[\n    #set box(\n      outset: 0pt,\n      inset: 0pt,\n      stroke:0.2pt,\n      width:32pt,\n    )\n    #set align(center)\n    #box[1]\n    #box[4]\n    #box[6]\n    #box[4]\n    #box[1]\n]\n```\n\nTypst leaves a space among the boxes. To avoid those spaces the only way I found is make a one line istruction like:\n\n```typ\n#[\n    // options as before\n    #box[1]#box[4]#box[6]#box[4]#box[1]\n]\n```\n\nIt's not a problem but if the content inside the boxes becomes more complex than a single letter the user may will write every box in a single dedicated line for clearness.\nIn LaTeX is simply a matter to add an ending comment sign % but in Typst this is not the case.\nHow to eliminate the spurious spaces? Something of a par option?\nThank you.\nRoberto",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 80.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1471
    },
    {
      "id": 11213,
      "post_number": 2,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-17T08:55:41.676Z",
      "updated_at": "2025-04-17T08:55:41.676Z",
      "cooked": "<p>You can try this syntax and see if you like it as an alternative. <code>#</code> is for entering code mode and <code>(...)</code> is an array. Each box is <em>content</em> so it can be joined without separator in the end.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">    #(\n      box[1],\n      box[4],\n      box[6],\n      box[4],\n      box[1],\n    ).join()\n</code></pre>",
      "raw": "You can try this syntax and see if you like it as an alternative. `#` is for entering code mode and `(...)` is an array. Each box is _content_ so it can be joined without separator in the end.\n\n```typ\n    #(\n      box[1],\n      box[4],\n      box[6],\n      box[4],\n      box[1],\n    ).join()\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 10.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 11216,
      "post_number": 3,
      "username": "Roberto",
      "name": "Roberto Giacomelli",
      "created_at": "2025-04-17T09:16:09.944Z",
      "updated_at": "2025-04-17T09:16:09.944Z",
      "cooked": "<p>Thanks. Interesting solution almost unexpected.</p>\n<p>So, the engine always insert a space in order to typeset consecutive non-empty lines. I’m wondering if this can affect the system in impossible situations.</p>\n<p>After some attempts, the answer is no, you can relax <img src=\"https://forum.typst.app/images/emoji/apple/grinning.png?v=12\" title=\":grinning:\" class=\"emoji\" alt=\":grinning:\" loading=\"lazy\" width=\"20\" height=\"20\">. In fact the long comment form works:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#[  #set box(\n    outset: 0pt,\n    inset: 0pt,\n    stroke:0.2pt,\n    width:32pt,\n  )\n\n  #box[#align(center)[ 1 ]]/*\n  */#box[#align(center)[ 4 ]]/*\n  */#box[#align(center)[ 6 ]]/*\n  */#box[#align(center)[ 4 ]]/*\n  */#box[#align(center)[ 1 ]]\n]\n</code></pre>\n<p>Respect the previuos code now the alignment is managed inside each box and the entire sequence is typeset aligned to the left as expected.</p>\n<p>Therefore, the single line comment doesn’t works in this case.</p>\n<p>R.</p>",
      "raw": "Thanks. Interesting solution almost unexpected.\n\nSo, the engine always insert a space in order to typeset consecutive non-empty lines. I'm wondering if this can affect the system in impossible situations.\n\nAfter some attempts, the answer is no, you can relax :grinning:. In fact the long comment form works:\n\n```typ\n#[  #set box(\n    outset: 0pt,\n    inset: 0pt,\n    stroke:0.2pt,\n    width:32pt,\n  )\n\n  #box[#align(center)[ 1 ]]/*\n  */#box[#align(center)[ 4 ]]/*\n  */#box[#align(center)[ 6 ]]/*\n  */#box[#align(center)[ 4 ]]/*\n  */#box[#align(center)[ 1 ]]\n]\n```\nRespect the previuos code now the alignment is managed inside each box and the entire sequence is typeset aligned to the left as expected.\n\nTherefore, the single line comment doesn't works in this case.\n\nR.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 10.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1471
    },
    {
      "id": 11217,
      "post_number": 4,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-17T09:22:56.184Z",
      "updated_at": "2025-04-17T09:32:52.759Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Roberto\" data-post=\"3\" data-topic=\"3697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/roberto/48/2562_2.png\" class=\"avatar\"> Roberto:</div>\n<blockquote>\n<p>So, the engine always insert a space in order to typeset consecutive non-empty lines. I’m wondering if this can affect the system in impossible situations.</p>\n</blockquote>\n</aside>\n<p>Maybe there’s a way to influence that - if someone knows maybe they can answer, I don’t.</p>\n<p>I think using a show rule to apply centering is a good way to handle it, something like this</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">    #show text: set align(center)\n    #(\n      box[1],\n      box[4],\n      box[6],\n      box[4],\n      box[1]\n    ).join()\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/5/55a9f8f7240174f4e122c2bbe39ca34e44adfbe9.png\" alt=\"bild\" data-base62-sha1=\"cdOKsPm48NUoGEk2XA9RkxSCkgF\" width=\"469\" height=\"37\"></p>\n<p>Or - I’m agnostic about how you solve the spacing issue, you can help yourself and define a “new kind of box” to make the repetition easier this way too, as an alternative</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">    // #let cbox = x =&gt; box(align(center, x))  /* easy version */\n    #let cbox(body, ..args) = box(..args, align(center, body))  /* general version */\n    #cbox[1]/*\n  */#cbox[4]/*\n  */#cbox[6]/*\n  */#cbox[4]/*\n  */#cbox[1]\n</code></pre>",
      "raw": "[quote=\"Roberto, post:3, topic:3697\"]\nSo, the engine always insert a space in order to typeset consecutive non-empty lines. I’m wondering if this can affect the system in impossible situations.\n[/quote]\n\nMaybe there's a way to influence that - if someone knows maybe they can answer, I don't.\n\nI think using a show rule to apply centering is a good way to handle it, something like this\n\n```typ\n    #show text: set align(center)\n    #(\n      box[1],\n      box[4],\n      box[6],\n      box[4],\n      box[1]\n    ).join()\n```\n\n![bild|469x37](upload://cdOKsPm48NUoGEk2XA9RkxSCkgF.png)\n\nOr - I'm agnostic about how you solve the spacing issue, you can help yourself and define a \"new kind of box\" to make the repetition easier this way too, as an alternative\n\n```typ\n    // #let cbox = x => box(align(center, x))  /* easy version */\n    #let cbox(body, ..args) = box(..args, align(center, body))  /* general version */\n    #cbox[1]/*\n  */#cbox[4]/*\n  */#cbox[6]/*\n  */#cbox[4]/*\n  */#cbox[1]\n```",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 1,
      "reads": 26,
      "score": 25.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 11218,
      "post_number": 5,
      "username": "Roberto",
      "name": "Roberto Giacomelli",
      "created_at": "2025-04-17T09:41:50.177Z",
      "updated_at": "2025-04-17T09:41:50.177Z",
      "cooked": "<p>Very enjoyable code!<br>\nThanks a lot.</p>\n<p>I third way is typeset the boxes inside a code block:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#{\n  set box(\n    outset: 0pt,\n    inset: 0pt,\n    stroke:0.2pt,\n    width:32pt,\n  )\n\nbox[#align(center)[ 1 ]]\nbox[#align(center)[ 4 ]]\nbox[#align(center)[ 6 ]]\nbox[#align(center)[ 4 ]]\nbox[#align(center)[ 1 ]]\n}\n</code></pre>\n<p>Or better using a for loop:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let mycenteredbox = x =&gt; box(\n  align(center, x),\n  stroke:0.2pt,\n  width:32pt,\n)\n\n#for value in (1, 4, 6, 4, 1)  {\n  [#mycenteredbox[#value]]\n}\n</code></pre>\n<p>Great user experience!<br>\nAgain, thank you.</p>",
      "raw": "Very enjoyable code!\nThanks a lot.\n\nI third way is typeset the boxes inside a code block:\n```typ\n#{\n  set box(\n    outset: 0pt,\n    inset: 0pt,\n    stroke:0.2pt,\n    width:32pt,\n  )\n\nbox[#align(center)[ 1 ]]\nbox[#align(center)[ 4 ]]\nbox[#align(center)[ 6 ]]\nbox[#align(center)[ 4 ]]\nbox[#align(center)[ 1 ]]\n}\n```\n\nOr better using a for loop:\n```typ\n#let mycenteredbox = x => box(\n  align(center, x),\n  stroke:0.2pt,\n  width:32pt,\n)\n\n#for value in (1, 4, 6, 4, 1)  {\n  [#mycenteredbox[#value]]\n}\n```\n\nGreat user experience!\nAgain, thank you.",
      "reply_to_post_number": 4,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 2,
      "reads": 25,
      "score": 50.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1471
    },
    {
      "id": 11220,
      "post_number": 6,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-04-17T10:11:27.348Z",
      "updated_at": "2025-04-17T10:11:33.766Z",
      "cooked": "<p>Unless you have some ulterior motive to use boxes, I would recommend you to use a <a href=\"https://typst.app/docs/reference/layout/grid/\"><code>grid</code></a> here. It makes the code a lot cleaner and you can still easily also adjust the width, stroke, inset etc…</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#grid(\n  columns: 5 * (32pt,),\n  align: center,\n  stroke: 0.2pt,\n  ..(1, 4, 6, 4, 1).map(str),\n)\n</code></pre>",
      "raw": "Unless you have some ulterior motive to use boxes, I would recommend you to use a [`grid`](https://typst.app/docs/reference/layout/grid/) here. It makes the code a lot cleaner and you can still easily also adjust the width, stroke, inset etc...\n\n```typ\n#grid(\n  columns: 5 * (32pt,),\n  align: center,\n  stroke: 0.2pt,\n  ..(1, 4, 6, 4, 1).map(str),\n)\n```",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 25,
      "score": 40.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 11221,
      "post_number": 7,
      "username": "Roberto",
      "name": "Roberto Giacomelli",
      "created_at": "2025-04-17T10:17:20.128Z",
      "updated_at": "2025-04-17T10:17:20.128Z",
      "cooked": "<p>Thank you <a class=\"mention\" href=\"/u/janekfleper\">@janekfleper</a> .</p>\n<p>At the moment I don’t understand the double dot syntax.<br>\nSome further experiment is needed.<br>\nActually I’m trying to typeset a Pascal Triangle as a toy problem.<br>\nI’ll upload the code here when finished.<br>\nNice community.</p>",
      "raw": "Thank you @janekfleper .\n\nAt the moment I don't understand the double dot syntax.\nSome further experiment is needed.\nActually I'm trying to typeset a Pascal Triangle as a toy problem.\nI'll upload the code here when finished.\nNice community.",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 9.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1471
    },
    {
      "id": 11222,
      "post_number": 8,
      "username": "gezepi",
      "name": "",
      "created_at": "2025-04-17T10:48:37.470Z",
      "updated_at": "2025-04-17T10:48:37.470Z",
      "cooked": "<p>Yet another option is to collapse the space between the boxes with a weak horizontal space:</p>\n<details>\n<summary>\nExplicit weak spacing</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">Explicit weak spacing\n#[\n    #set box(\n      outset: 0pt,\n      inset: 0pt,\n      stroke:0.2pt,\n      width:32pt,\n    )\n    #set align(center)\n    #box[1]\n    #h(0pt, weak: true)\n    #box[4]\n    #h(0pt, weak: true)\n    #box[6]\n    #h(0pt, weak: true)\n    #box[4]\n    #h(0pt, weak: true)\n    #box[1]\n    Next content\n]\n</code></pre>\n</details>\n<p>Which is pretty verbose and can be shortened with a custom function:</p>\n<details>\n<summary>\nCustom function that adds weak spacing after each box</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">Custom function that adds weak spacing after each box\n#[\n    #let cbox(body) = {\n      box(\n        outset: 0pt,\n        inset: 0pt,\n        stroke:0.2pt,\n        width:32pt,\n        body\n      )\n      h(0pt, weak: true)\n  }\n    #set align(center)\n    #cbox[1]\n    #cbox[4]\n    #cbox[6]\n    #cbox[4]\n    #cbox[1]\n    Next content\n]\n</code></pre>\n</details>\n<p>But that alters the spacing to the next piece of content that comes after, so defining your boxes as an <code>array</code> then <code>join</code>ing them as <a class=\"mention\" href=\"/u/bluss\">@bluss</a> suggested is probably better.  Unless you want the next content directly next to your boxes of course.</p>\n<p>Results of each option:<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/d/dc95d96cf652a3b88ecf8b86d0d06fa738fcac69.png\" alt=\"image\" data-base62-sha1=\"vto5Q2DQ5dop66TpsOKO8DOfttD\" width=\"663\" height=\"251\"></p>",
      "raw": "Yet another option is to collapse the space between the boxes with a weak horizontal space:\n\n[details=\"Explicit weak spacing\"]\n```typ\nExplicit weak spacing\n#[\n    #set box(\n      outset: 0pt,\n      inset: 0pt,\n      stroke:0.2pt,\n      width:32pt,\n    )\n    #set align(center)\n    #box[1]\n    #h(0pt, weak: true)\n    #box[4]\n    #h(0pt, weak: true)\n    #box[6]\n    #h(0pt, weak: true)\n    #box[4]\n    #h(0pt, weak: true)\n    #box[1]\n    Next content\n]\n```\n[/details]\n\nWhich is pretty verbose and can be shortened with a custom function:\n\n[details=\"Custom function that adds weak spacing after each box\"]\n```typ\nCustom function that adds weak spacing after each box\n#[\n    #let cbox(body) = {\n      box(\n        outset: 0pt,\n        inset: 0pt,\n        stroke:0.2pt,\n        width:32pt,\n        body\n      )\n      h(0pt, weak: true)\n  }\n    #set align(center)\n    #cbox[1]\n    #cbox[4]\n    #cbox[6]\n    #cbox[4]\n    #cbox[1]\n    Next content\n]\n```\n[/details]\n\nBut that alters the spacing to the next piece of content that comes after, so defining your boxes as an `array` then `join`ing them as @bluss suggested is probably better.  Unless you want the next content directly next to your boxes of course.\n\nResults of each option:\n![image|663x251](upload://vto5Q2DQ5dop66TpsOKO8DOfttD.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 23,
      "score": 24.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 326
    },
    {
      "id": 11224,
      "post_number": 9,
      "username": "Roberto",
      "name": "Roberto Giacomelli",
      "created_at": "2025-04-17T11:14:08.692Z",
      "updated_at": "2025-04-17T11:17:28.751Z",
      "cooked": "<p>I’m concerned this is out of topic but is so funny!<br>\nMy best to build a triangle Pascal:</p>\n<details>\n<summary>\nA solution for typeset the Pascal's Triangle</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">= Pascal's Triangle\n\n#{\n  let mycenteredbox = x =&gt; box(\n    align(center, [#x]),\n    //stroke:0.2pt,\n    width:32pt,\n  )\n\n  // function that step forward a triangle row\n  let step_row(r) = {\n      for i in range(r.len() - 1, 0, step: -1) {\n      r.at(i) = r.at(i) + r.at(i - 1)\n    }\n    r.push(1)\n    return r\n  }\n\n  // print a single row\n  let typeset_row( row ) = {\n    for value in row {\n      mycenteredbox(value)\n    }\n    // ending newline\n    [\n\n    ]\n  }\n  // print the entire Triangle\n  set align(center)\n  let row = ()\n  for _ in range(0, 13) {\n    row = step_row(row)\n    typeset_row(row)\n  }\n}\n</code></pre>\n</details>\n<p>The code works and compile fast even if at every row a new array is created. The original idea for the <code>step_row()</code> function was adding numbers and push a new 1 element to the same array, the only one growing array.<br>\nUnfortunately the edited array did not survive out of the function. It seam that global modification is not possible in contrary to what the docs of pure function says (array.push() should be works locally over a global variable).</p>\n<p>I think this is absolutely normal. Typst has a very new syntax to learn for me.</p>\n<p>So the next step is to use <a class=\"mention\" href=\"/u/janekfleper\">@janekfleper</a> suggestion and cleaned the code and substitute <code>box</code>es with a single <code>grid</code>.<br>\nThank you.</p>",
      "raw": "I'm concerned this is out of topic but is so funny!\nMy best to build a triangle Pascal:\n\n[details=\"A solution for typeset the Pascal's Triangle\"]\n```typ\n= Pascal's Triangle\n\n#{\n  let mycenteredbox = x => box(\n    align(center, [#x]),\n    //stroke:0.2pt,\n    width:32pt,\n  )\n\n  // function that step forward a triangle row\n  let step_row(r) = {\n      for i in range(r.len() - 1, 0, step: -1) {\n      r.at(i) = r.at(i) + r.at(i - 1)\n    }\n    r.push(1)\n    return r\n  }\n\n  // print a single row\n  let typeset_row( row ) = {\n    for value in row {\n      mycenteredbox(value)\n    }\n    // ending newline\n    [\n\n    ]\n  }\n  // print the entire Triangle\n  set align(center)\n  let row = ()\n  for _ in range(0, 13) {\n    row = step_row(row)\n    typeset_row(row)\n  }\n}\n```\n[/details]\n\nThe code works and compile fast even if at every row a new array is created. The original idea for the `step_row()` function was adding numbers and push a new 1 element to the same array, the only one growing array.\nUnfortunately the edited array did not survive out of the function. It seam that global modification is not possible in contrary to what the docs of pure function says (array.push() should be works locally over a global variable).\n\nI think this is absolutely normal. Typst has a very new syntax to learn for me.\n\nSo the next step is to use @janekfleper suggestion and cleaned the code and substitute `box`es with a single `grid`.\nThank you.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 4.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1471
    },
    {
      "id": 11228,
      "post_number": 10,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-04-17T12:09:50.154Z",
      "updated_at": "2025-04-17T12:10:55.205Z",
      "cooked": "<p>The double dot syntax is the spread operator which basically turns an array into a bunch of elements. You need this here since a grid expects the content for the individual cells as separate arguments. The code in my example turns the array of integers into an array of strings and then “spreads” the array into the grid. The verbose version would be:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#grid(\n  columns: 5 * (32pt,),\n  align: center,\n  stroke: 0.2pt,\n  \"1\", \"4\", \"6\", \"4\", \"1\",\n)\n</code></pre>\n<p>If you just want to show your code beyond the scope of the question, feel free to post it in the <a class=\"hashtag-cooked\" href=\"/c/showcase/6\" data-type=\"category\" data-slug=\"showcase\" data-id=\"6\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>Showcase</span></a> category. You can then just add a reference to <em>this</em> post.</p>",
      "raw": "The double dot syntax is the spread operator which basically turns an array into a bunch of elements. You need this here since a grid expects the content for the individual cells as separate arguments. The code in my example turns the array of integers into an array of strings and then \"spreads\" the array into the grid. The verbose version would be:\n\n```typ\n#grid(\n  columns: 5 * (32pt,),\n  align: center,\n  stroke: 0.2pt,\n  \"1\", \"4\", \"6\", \"4\", \"1\",\n)\n```\n\nIf you just want to show your code beyond the scope of the question, feel free to post it in the #showcase category. You can then just add a reference to _this_ post.",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 22,
      "score": 29.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 11246,
      "post_number": 11,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-17T16:08:47.079Z",
      "updated_at": "2025-04-17T16:10:29.454Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Roberto\" data-post=\"5\" data-topic=\"3697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/roberto/48/2562_2.png\" class=\"avatar\"> Roberto:</div>\n<blockquote>\n<p>I third way is typeset the boxes inside a code block:</p>\n</blockquote>\n</aside>\n<p>For your example, this is the canonical way (although the centering has side effects here). In code mode Typst only inserts what you tell it to insert, but in markup mode there are things like new lines, line breaks, par breaks, etc.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#{\n  set box(outset: 0pt, inset: 0pt, stroke: 0.2pt, width: 32pt)\n  set align(center)\n  box[1]\n  box[4]\n  box[6]\n  box[4]\n  box[1]\n}\n</code></pre>\n<p>But this approach is great if we ignore all other things like the intended use, etc.</p>",
      "raw": "[quote=\"Roberto, post:5, topic:3697\"]\nI third way is typeset the boxes inside a code block:\n[/quote]\n\nFor your example, this is the canonical way (although the centering has side effects here). In code mode Typst only inserts what you tell it to insert, but in markup mode there are things like new lines, line breaks, par breaks, etc.\n\n```typ\n#{\n  set box(outset: 0pt, inset: 0pt, stroke: 0.2pt, width: 32pt)\n  set align(center)\n  box[1]\n  box[4]\n  box[6]\n  box[4]\n  box[1]\n}\n```\n\nBut this approach is great if we ignore all other things like the intended use, etc.",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 4,
      "reads": 21,
      "score": 94.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:49:03.936673"
}
{
  "topic_metadata": {
    "id": 3699,
    "title": "Inserting text on an image",
    "slug": "inserting-text-on-an-image",
    "posts_count": 5,
    "created_at": "2025-04-17T09:03:56.483Z",
    "last_posted_at": "2025-04-17T16:17:05.254Z",
    "views": 105,
    "like_count": 2,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "JosephBarbier",
    "tags": [
      "layout",
      "graphics"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 246
  },
  "posts": [
    {
      "id": 11215,
      "post_number": 1,
      "username": "JosephBarbier",
      "name": "Joseph",
      "created_at": "2025-04-17T09:03:56.637Z",
      "updated_at": "2025-04-18T20:48:18.195Z",
      "cooked": "<p>Hi there!</p>\n<p>I’m fairly new to typst, and I’m trying to add text to an image. For example, let’s say I have a <code>firefox.png</code> file with the Firefox logo, I’d like to be able to do something like (example on the right):</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/2/2d31b89f2d80e62ffe1486ab05269075ff9cf3c1.png\" data-download-href=\"https://forum.typst.app/uploads/default/2d31b89f2d80e62ffe1486ab05269075ff9cf3c1\" title=\"Screenshot 2025-04-17 at 10.59.55\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/2/2d31b89f2d80e62ffe1486ab05269075ff9cf3c1_2_690x253.png\" alt=\"Screenshot 2025-04-17 at 10.59.55\" data-base62-sha1=\"6rO0P8RtSsT73hRBoOH8l6CTRIt\" width=\"690\" height=\"253\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/2/2d31b89f2d80e62ffe1486ab05269075ff9cf3c1_2_690x253.png, https://forum.typst.app/uploads/default/original/2X/2/2d31b89f2d80e62ffe1486ab05269075ff9cf3c1.png 1.5x, https://forum.typst.app/uploads/default/original/2X/2/2d31b89f2d80e62ffe1486ab05269075ff9cf3c1.png 2x\" data-dominant-color=\"F6E7E5\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2025-04-17 at 10.59.55</span><span class=\"informations\">837×307 77.4 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>I haven’t found any examples that do this sort of thing, so I’m wondering if it’s possible.</p>\n<p>To give more context, I want to define an image as the cover page of a template and use inputs such as <code>title</code> or <code>date</code> and place them on top of that cover page.</p>\n<p>Let me know if anything is unclear here!</p>",
      "raw": "Hi there!\n\nI'm fairly new to typst, and I'm trying to add text to an image. For example, let's say I have a `firefox.png` file with the Firefox logo, I'd like to be able to do something like (example on the right):\n\n![Screenshot 2025-04-17 at 10.59.55|690x253](upload://6rO0P8RtSsT73hRBoOH8l6CTRIt.png)\n\nI haven't found any examples that do this sort of thing, so I'm wondering if it's possible.\n\nTo give more context, I want to define an image as the cover page of a template and use inputs such as `title` or `date` and place them on top of that cover page.\n\nLet me know if anything is unclear here!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 35,
      "score": 212.0,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1473
    },
    {
      "id": 11223,
      "post_number": 2,
      "username": "JosephBarbier",
      "name": "Joseph",
      "created_at": "2025-04-17T10:51:10.964Z",
      "updated_at": "2025-04-17T10:52:38.054Z",
      "cooked": "<p>Actually, I think I’ve found a solution with this param in the <code>page()</code> function:</p>\n<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/docs/reference/layout/page/#parameters-background\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/docs/reference/layout/page/#parameters-background\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/docs/reference/layout/page/#parameters-background\" target=\"_blank\" rel=\"noopener\">Page Function – Typst Documentation</a></h3>\n\n  <p>Documentation for the `page` function.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "Actually, I think I've found a solution with this param in the `page()` function:\n\nhttps://typst.app/docs/reference/layout/page/#parameters-background",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 6.6,
      "accepted_answer": true,
      "trust_level": 0,
      "user_id": 1473
    },
    {
      "id": 11226,
      "post_number": 3,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-04-17T11:52:39.065Z",
      "updated_at": "2025-04-17T11:52:39.065Z",
      "cooked": "<p>If you want to position text on an image, you can use <a href=\"https://typst.app/docs/reference/layout/block/\"><code>block</code></a> and <a href=\"https://typst.app/docs/reference/layout/place/\"><code>place</code></a>. The block will inherit the size from the image, and you can then place the text in the center of the block. If you want to further adjust the position of the text, you can use the parameters <code>dx</code> and <code>dy</code>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#block({\n  image(\"Mozilla_Firefox_Logo.png\")\n  place(center + horizon, text(white, size: 20pt, \"My text goes here\"))\n})\n</code></pre>",
      "raw": "If you want to position text on an image, you can use [`block`](https://typst.app/docs/reference/layout/block/) and [`place`](https://typst.app/docs/reference/layout/place/). The block will inherit the size from the image, and you can then place the text in the center of the block. If you want to further adjust the position of the text, you can use the parameters `dx` and `dy`.\n\n```typ\n#block({\n  image(\"Mozilla_Firefox_Logo.png\")\n  place(center + horizon, text(white, size: 20pt, \"My text goes here\"))\n})\n```",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 2,
      "reads": 30,
      "score": 56.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 11229,
      "post_number": 4,
      "username": "JosephBarbier",
      "name": "Joseph",
      "created_at": "2025-04-17T12:24:49.984Z",
      "updated_at": "2025-04-17T12:24:49.984Z",
      "cooked": "<p>Yep that would do it too! Thanks.</p>",
      "raw": "Yep that would do it too! Thanks.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 5.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1473
    },
    {
      "id": 11248,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-17T16:17:05.254Z",
      "updated_at": "2025-04-17T16:17:05.254Z",
      "cooked": "<p>Or <code>box</code>, if inlining with text is needed.</p>",
      "raw": "Or `box`, if inlining with text is needed.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 9.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:49:03.186280"
}
{
  "topic_metadata": {
    "id": 370,
    "title": "How to use a pattern image as the page background?",
    "slug": "how-to-use-a-pattern-image-as-the-page-background",
    "posts_count": 10,
    "created_at": "2024-09-16T17:57:07.770Z",
    "last_posted_at": "2024-09-16T23:34:20.229Z",
    "views": 1510,
    "like_count": 13,
    "reply_count": 7,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 6,
    "accepted_answer_username": "Andrew",
    "tags": [
      "graphics",
      "page"
    ],
    "category_id": 5,
    "participant_count": 5,
    "word_count": 736
  },
  "posts": [
    {
      "id": 1410,
      "post_number": 1,
      "username": "Mathemensch",
      "name": "Alexander Schulz",
      "created_at": "2024-09-16T17:57:07.898Z",
      "updated_at": "2024-09-16T21:19:57.552Z",
      "cooked": "<p>I am currently creating some worksheets for exciting, context-orientated lessons.</p>\n<p>I have an image that I would like to use as the background for these documents. The image is a seamless pattern, so I would like to repeat it in the background instead of stretching it across the entire width. Is there a good way to repeat a background like a cache?</p>\n<p>So far I am stretching the background to the full height and width of the document. However, as the document gets longer, the quality gets worse and worse.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(background: image(\"assets/paper.jpg\", width: 100%, height: 100%))\n</code></pre>\n<p>The result so far looks like this<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/1X/0505ed94dbfa1a19f7def6d16d692d918dcd0d43.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/0505ed94dbfa1a19f7def6d16d692d918dcd0d43\" title=\"SCR-20240916-rits\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/0505ed94dbfa1a19f7def6d16d692d918dcd0d43_2_325x500.jpeg\" alt=\"SCR-20240916-rits\" data-base62-sha1=\"Ir5sPMhPYBvvoFsb49Q9dzFWIH\" width=\"325\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/1X/0505ed94dbfa1a19f7def6d16d692d918dcd0d43_2_325x500.jpeg, https://forum.typst.app/uploads/default/optimized/1X/0505ed94dbfa1a19f7def6d16d692d918dcd0d43_2_487x750.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/1X/0505ed94dbfa1a19f7def6d16d692d918dcd0d43_2_650x1000.jpeg 2x\" data-dominant-color=\"E5DDD4\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">SCR-20240916-rits</span><span class=\"informations\">1408×2160 298 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Thanks for your help.</p>",
      "raw": "I am currently creating some worksheets for exciting, context-orientated lessons.\n\nI have an image that I would like to use as the background for these documents. The image is a seamless pattern, so I would like to repeat it in the background instead of stretching it across the entire width. Is there a good way to repeat a background like a cache?\n\nSo far I am stretching the background to the full height and width of the document. However, as the document gets longer, the quality gets worse and worse.\n\n```typ\n#set page(background: image(\"assets/paper.jpg\", width: 100%, height: 100%))\n```\n\nThe result so far looks like this\n![SCR-20240916-rits|325x500](upload://Ir5sPMhPYBvvoFsb49Q9dzFWIH.jpeg)\n\nThanks for your help.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 103,
      "score": 7580.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 307
    },
    {
      "id": 1413,
      "post_number": 2,
      "username": "Enivex",
      "name": "Enivex",
      "created_at": "2024-09-16T18:11:55.724Z",
      "updated_at": "2024-09-16T18:11:55.724Z",
      "cooked": "<p>You may be interested in this function</p>\n<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/docs/reference/visualize/pattern/\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/docs/reference/visualize/pattern/\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/docs/reference/visualize/pattern/\" target=\"_blank\" rel=\"noopener\">Pattern Type – Typst Documentation</a></h3>\n\n  <p>Documentation for the Pattern type.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "You may be interested in this function\n\nhttps://typst.app/docs/reference/visualize/pattern/",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 95,
      "score": 103.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 5
    },
    {
      "id": 1422,
      "post_number": 3,
      "username": "afiaith",
      "name": "Maja Abramski-Kronenberg",
      "created_at": "2024-09-16T18:36:45.467Z",
      "updated_at": "2024-09-16T18:36:45.467Z",
      "cooked": "<p>Here you go <img src=\"https://forum.typst.app/images/emoji/apple/slightly_smiling_face.png?v=12\" title=\":slightly_smiling_face:\" class=\"emoji\" alt=\":slightly_smiling_face:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(\n  background: {\n    let pat = pattern(\n      size: (30pt, 30pt),\n      place(circle(radius: 15pt, fill: luma(240))) // replace the `#circle` command with your `#image`\n    )\n    rect(fill: pat, width: 100%, height: 100%)\n  }\n)\n\n#lorem(300)\n\n#lorem(100)\n\n#lorem(200)\n</code></pre>",
      "raw": "Here you go 🙂\n\n```typ\n#set page(\n  background: {\n    let pat = pattern(\n      size: (30pt, 30pt),\n      place(circle(radius: 15pt, fill: luma(240))) // replace the `#circle` command with your `#image`\n    )\n    rect(fill: pat, width: 100%, height: 100%)\n  }\n)\n\n#lorem(300)\n\n#lorem(100)\n\n#lorem(200)\n```",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 92,
      "score": 98.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 91
    },
    {
      "id": 1423,
      "post_number": 4,
      "username": "Mathemensch",
      "name": "Alexander Schulz",
      "created_at": "2024-09-16T18:44:21.802Z",
      "updated_at": "2024-09-16T18:44:21.802Z",
      "cooked": "<p>Thank you very much!<br>\nThat’s a clever solution.</p>",
      "raw": "Thank you very much!\nThat's a clever solution.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 86,
      "score": 62.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 307
    },
    {
      "id": 1425,
      "post_number": 5,
      "username": "afiaith",
      "name": "Maja Abramski-Kronenberg",
      "created_at": "2024-09-16T18:52:20.874Z",
      "updated_at": "2024-09-16T18:52:20.874Z",
      "cooked": "<p>I’m glad it helps you <img src=\"https://forum.typst.app/images/emoji/apple/slightly_smiling_face.png?v=12\" title=\":slightly_smiling_face:\" class=\"emoji\" alt=\":slightly_smiling_face:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>This is a clear case of the <a href=\"https://github.com/typst/typst#design-principles\" rel=\"noopener nofollow ugc\">power through composability</a> design principle.</p>",
      "raw": "I’m glad it helps you 🙂\n\nThis is a clear case of the [power through composability](https://github.com/typst/typst#design-principles) design principle.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 82,
      "score": 41.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 91
    },
    {
      "id": 1447,
      "post_number": 6,
      "username": "Andrew",
      "name": "",
      "created_at": "2024-09-16T21:53:57.178Z",
      "updated_at": "2024-09-17T14:04:48.317Z",
      "cooked": "<p>I would like to simplify <a href=\"https://forum.typst.app/t/how-to-use-a-pattern-image-as-the-page-background/370/3\">the answer</a> by providing some “alternatives”:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let img = circle(radius: 15pt, fill: green.transparentize(70%))\n\n// Option 1\n#set page(fill: pattern(img))\n\n// Option2\n// #set page(background: box(\n//   width: 100%,\n//   height: 100%,\n//   fill: pattern(img)\n// ))\n\n#lorem(300)\n\n#lorem(100)\n\n#lorem(200)\n</code></pre>\n<details>\n<summary>\nOutput</summary>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/1X/a2f79aef6a97ac90a2a01ca2e581ab796ec1c016.png\" data-download-href=\"https://forum.typst.app/uploads/default/a2f79aef6a97ac90a2a01ca2e581ab796ec1c016\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/a2f79aef6a97ac90a2a01ca2e581ab796ec1c016_2_352x500.png\" alt=\"image\" data-base62-sha1=\"nfFQcq411KS1DHvuInt2ttHEjMq\" width=\"352\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/1X/a2f79aef6a97ac90a2a01ca2e581ab796ec1c016_2_352x500.png, https://forum.typst.app/uploads/default/optimized/1X/a2f79aef6a97ac90a2a01ca2e581ab796ec1c016_2_528x750.png 1.5x, https://forum.typst.app/uploads/default/optimized/1X/a2f79aef6a97ac90a2a01ca2e581ab796ec1c016_2_704x1000.png 2x\" data-dominant-color=\"1C3E20\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">717×1016 344 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>\n<p>Note that semantically, you would choose <code>box()</code> over <code>rect()</code> in this case. And by default, <code>rect()</code> is visually visible (draw a rectangle), while <code>box()</code> is not.</p>\n<p>If you want to add, for example, a monotone background color, then for the image pattern you would have to use <code>background: box(fill: pattern(img))</code> approach. But if the default white background color is fine (<code>background</code> is drawn on top of the <code>fill</code>, BTW), then you can use a more compact <code>fill: pattern(img)</code> approach.</p>\n<p>You can see that the additional <code>box</code> wrapping is just a “workaround” to use <code>fill: pattern()</code> when the <code>page.fill</code> is busy/not available.</p>\n<p>Additionally, you might find useful the <a href=\"https://typst.app/docs/reference/visualize/image/#parameters-fit\"><code>image.fit</code></a> parameter.</p>",
      "raw": "I would like to simplify [the answer](https://forum.typst.app/t/how-to-use-a-pattern-image-as-the-page-background/370/3) by providing some \"alternatives\":\n\n```typ\n#let img = circle(radius: 15pt, fill: green.transparentize(70%))\n\n// Option 1\n#set page(fill: pattern(img))\n\n// Option2\n// #set page(background: box(\n//   width: 100%,\n//   height: 100%,\n//   fill: pattern(img)\n// ))\n\n#lorem(300)\n\n#lorem(100)\n\n#lorem(200)\n```\n\n[details=\"Output\"]\n![image|352x500](upload://nfFQcq411KS1DHvuInt2ttHEjMq.png)\n[/details]\n\nNote that semantically, you would choose `box()` over `rect()` in this case. And by default, `rect()` is visually visible (draw a rectangle), while `box()` is not.\n\nIf you want to add, for example, a monotone background color, then for the image pattern you would have to use `background: box(fill: pattern(img))` approach. But if the default white background color is fine (`background` is drawn on top of the `fill`, BTW), then you can use a more compact `fill: pattern(img)` approach.\n\nYou can see that the additional `box` wrapping is just a \"workaround\" to use `fill: pattern()` when the `page.fill` is busy/not available.\n\nAdditionally, you might find useful the [`image.fit`](https://typst.app/docs/reference/visualize/image/#parameters-fit) parameter.",
      "reply_to_post_number": 3,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 2,
      "reads": 75,
      "score": 499.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 1449,
      "post_number": 7,
      "username": "afiaith",
      "name": "Maja Abramski-Kronenberg",
      "created_at": "2024-09-16T22:30:05.536Z",
      "updated_at": "2024-09-16T22:30:05.536Z",
      "cooked": "<p>Cool! I didn’t notice the <code>fill</code> parameter of <code>page</code>, so I made a workaround using <code>background</code>. Your solution is more elegant.</p>\n<p>BTW, we don’t need the <code>size: (30pt, 30pt)</code> part at all. This works:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(\n  fill: pattern(\n    circle(radius: 15pt, fill: luma(240))\n  )\n)\n\n#lorem(300)\n\n#lorem(100)\n\n#lorem(200)\n</code></pre>",
      "raw": "Cool! I didn’t notice the `fill` parameter of `page`, so I made a workaround using `background`. Your solution is more elegant.\n\nBTW, we don’t need the `size: (30pt, 30pt)` part at all. This works:\n\n```typ\n#set page(\n  fill: pattern(\n    circle(radius: 15pt, fill: luma(240))\n  )\n)\n\n#lorem(300)\n\n#lorem(100)\n\n#lorem(200)\n```",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 66,
      "score": 33.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 91
    },
    {
      "id": 1450,
      "post_number": 8,
      "username": "Andrew",
      "name": "",
      "created_at": "2024-09-16T22:46:46.249Z",
      "updated_at": "2024-09-16T22:46:46.249Z",
      "cooked": "<p>That’s great! I didn’t touch this because I’ve used the <code>pattern()</code> only a few times and trusted your solution (so I blindly copied that part). The less code, the better.</p>",
      "raw": "That's great! I didn't touch this because I've used the `pattern()` only a few times and trusted your solution (so I blindly copied that part). The less code, the better.",
      "reply_to_post_number": 7,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 63,
      "score": 57.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 1454,
      "post_number": 9,
      "username": "afiaith",
      "name": "Maja Abramski-Kronenberg",
      "created_at": "2024-09-16T23:09:31.759Z",
      "updated_at": "2024-09-16T23:09:31.759Z",
      "cooked": "<p>Yeah, I don’t think it’s possible to make it more minimal than that…</p>\n<p>The <code>size</code> part was needed, but only because of <code>place</code>¹, which was indeed superfluous.</p>\n<hr>\n<p>¹ If you have <code>place</code> without <code>size</code> there, you get this error message:</p>\n<pre><code class=\"lang-plaintext\">error: pattern tile size must be non-zero\n[…]\n  = hint: try setting the size manually\n</code></pre>",
      "raw": "Yeah, I don’t think it’s possible to make it more minimal than that…\n\nThe `size` part was needed, but only because of `place`¹, which was indeed superfluous.\n\n---\n\n¹ If you have `place` without `size` there, you get this error message:\n\n```text\nerror: pattern tile size must be non-zero\n[…]\n  = hint: try setting the size manually\n```",
      "reply_to_post_number": 8,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 61,
      "score": 22.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 91
    },
    {
      "id": 1458,
      "post_number": 10,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-09-16T23:34:20.229Z",
      "updated_at": "2024-09-16T23:34:20.229Z",
      "cooked": "<blockquote>\n<p>Note that semantically, you would choose <code>box()</code> over <code>rect()</code> in this case. And by default, <code>rect()</code> is visually visible (draw a rectangle), while <code>box()</code> is not.</p>\n</blockquote>\n<p>Just wanted to make a small addition: technically, a <code>block()</code> would be closer to a “brother” of <code>rect()</code> than <code>box()</code>. While both are similar, a <code>box()</code> is always inline and often used to insert otherwise block-level elements (such as <code>image()</code>, <code>circle()</code> and so on) within a text line without breaking the paragraph. That is useful to insert things like icons into text, for instance, since images are normally block-level and thus interrupt the paragraph. Meanwhile, a <code>block()</code> is always block-level (just like <code>rect</code>) and has several useful parameters to customize its appearance and layout behavior, so it’s generally preferable when inserting in a paragraph isn’t important. Otherwise, your remark is correct.</p>\n<p>Though one could also argue that it might make more sense to use <code>rect()</code> rather than <code>block()</code> in this particular example for the reason you mention (it’d be visible, and is only there to display a fill). It doesn’t really matter in the end though <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "> Note that semantically, you would choose `box()` over `rect()` in this case. And by default, `rect()` is visually visible (draw a rectangle), while `box()` is not.\n\nJust wanted to make a small addition: technically, a `block()` would be closer to a \"brother\" of `rect()` than `box()`. While both are similar, a `box()` is always inline and often used to insert otherwise block-level elements (such as `image()`, `circle()` and so on) within a text line without breaking the paragraph. That is useful to insert things like icons into text, for instance, since images are normally block-level and thus interrupt the paragraph. Meanwhile, a `block()` is always block-level (just like `rect`) and has several useful parameters to customize its appearance and layout behavior, so it's generally preferable when inserting in a paragraph isn't important. Otherwise, your remark is correct.\n\nThough one could also argue that it might make more sense to use `rect()` rather than `block()` in this particular example for the reason you mention (it'd be visible, and is only there to display a fill). It doesn't really matter in the end though :slight_smile:",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 63,
      "score": 102.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:58:51.236386"
}
{
  "topic_metadata": {
    "id": 3701,
    "title": "How do I access `target()` function without HTML feature flag?",
    "slug": "how-do-i-access-target-function-without-html-feature-flag",
    "posts_count": 3,
    "created_at": "2025-04-17T12:54:40.949Z",
    "last_posted_at": "2025-04-17T13:01:57.521Z",
    "views": 48,
    "like_count": 1,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 151
  },
  "posts": [
    {
      "id": 11230,
      "post_number": 1,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-17T12:54:41.116Z",
      "updated_at": "2025-04-17T12:54:41.116Z",
      "cooked": "<p>Currently, the <a href=\"https://typst.app/docs/reference/foundations/target/\"><code>target()</code></a> function doesn’t exist if you don’t enable HTML feature flag, but some default show rules (like for heading) <em>do</em> check for the HTML target. Is there a way to check for it without enabling the flag?</p>",
      "raw": "Currently, the [`target()`](https://typst.app/docs/reference/foundations/target/) function doesn't exist if you don't enable HTML feature flag, but some default show rules (like for heading) *do* check for the HTML target. Is there a way to check for it without enabling the flag?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 23,
      "score": 109.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11231,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-17T12:55:16.872Z",
      "updated_at": "2025-04-17T13:13:08.789Z",
      "cooked": "<p>Yes, thanks to <a class=\"mention\" href=\"/u/sillyfreak\">@SillyFreak</a> for the answer:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let target = dictionary(std).at(\"target\", default: () =&gt; \"paged\")\n</code></pre>\n<p>You would then use it like normal:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#context target()\n</code></pre>\n<p>A side effect is that it’s available outside context when HTML feature flag is not enabled.</p>",
      "raw": "Yes, thanks to @SillyFreak for the answer:\n\n```typ\n#let target = dictionary(std).at(\"target\", default: () => \"paged\")\n```\n\nYou would then use it like normal:\n\n```typ\n#context target()\n```\n\nA side effect is that it's available outside context when HTML feature flag is not enabled.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 14.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11232,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-04-17T13:01:57.521Z",
      "updated_at": "2025-04-17T13:01:57.521Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"2\" data-topic=\"3701\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>it’s available outside context when not exported to HTML</p>\n</blockquote>\n</aside>\n<p>I think more accurately, when HTML export is not <em>available</em>. If the feature is enabled (or you’re coming from the future where it’s enabled by default), context is required even when exporting to PDF, so I wouldn’t depend on that.</p>",
      "raw": "[quote=\"Andrew, post:2, topic:3701\"]\nit’s available outside context when not exported to HTML\n[/quote]\n\nI think more accurately, when HTML export is not _available_. If the feature is enabled (or you're coming from the future where it's enabled by default), context is required even when exporting to PDF, so I wouldn't depend on that.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 23,
      "score": 9.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:49:02.285821"
}
{
  "topic_metadata": {
    "id": 3712,
    "title": "How to change enum coloring with both alphabets and numbers?",
    "slug": "how-to-change-enum-coloring-with-both-alphabets-and-numbers",
    "posts_count": 5,
    "created_at": "2025-04-18T04:30:13.602Z",
    "last_posted_at": "2025-04-18T12:09:08.834Z",
    "views": 58,
    "like_count": 5,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "janekfleper",
    "tags": [
      "styling",
      "lists"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 395
  },
  "posts": [
    {
      "id": 11262,
      "post_number": 1,
      "username": "Jarko",
      "name": "Jarko",
      "created_at": "2025-04-18T04:30:13.704Z",
      "updated_at": "2025-04-18T21:20:43.398Z",
      "cooked": "<details><summary>I need to use numbered and alphabetical enums in my document. I am able to change coloring of numbered enums, but not alphabetical. How can I change coloring of both? </summary>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/8cb4145172c19769e98917c7c66db35c4fbe1a15.png\" data-download-href=\"https://forum.typst.app/uploads/default/8cb4145172c19769e98917c7c66db35c4fbe1a15\" title=\"Enumcolors\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/8cb4145172c19769e98917c7c66db35c4fbe1a15_2_690x436.png\" alt=\"Enumcolors\" data-base62-sha1=\"k4IFaUxn9pgY2VcTbwyCACqa51P\" width=\"690\" height=\"436\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/8/8cb4145172c19769e98917c7c66db35c4fbe1a15_2_690x436.png, https://forum.typst.app/uploads/default/original/2X/8/8cb4145172c19769e98917c7c66db35c4fbe1a15.png 1.5x, https://forum.typst.app/uploads/default/original/2X/8/8cb4145172c19769e98917c7c66db35c4fbe1a15.png 2x\" data-dominant-color=\"F0F0F0\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Enumcolors</span><span class=\"informations\">812×514 109 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">\n// How to change a,b,c color here on the styling section:\n\n#let marker-num-color = rgb(\"#0969DA\") //rgb(\"#0074D9\")\n#set list(marker: ([▸], [▹]).map(text.with(marker-num-color)))\n#set enum(numbering: (..n) =&gt; text(marker-num-color, numbering(\"1.\", ..n)))\n\n// I don't want to touch code below this as it's generated from markdown to typst\n\n+ #lorem(10)\n  - #lorem(10)\n  - #lorem(10)\n+ #lorem(10)\n  - #lorem(10)\n+ #lorem(10)\n  - #lorem(10)\n\n#block[\n#set enum(numbering: \"a)\", start: 1)\n+ #lorem(10)\n\n+ #lorem(10)\n\n+ #lorem(10)\n\n+ #lorem(10)\n]\n\n\n</code></pre>\n</details>",
      "raw": "<details><summary>I need to use numbered and alphabetical enums in my document. I am able to change coloring of numbered enums, but not alphabetical. How can I change coloring of both? </summary>\n\n![Enumcolors|690x436](upload://k4IFaUxn9pgY2VcTbwyCACqa51P.png)\n\n\n```typ\n\n// How to change a,b,c color here on the styling section:\n\n#let marker-num-color = rgb(\"#0969DA\") //rgb(\"#0074D9\")\n#set list(marker: ([▸], [▹]).map(text.with(marker-num-color)))\n#set enum(numbering: (..n) => text(marker-num-color, numbering(\"1.\", ..n)))\n\n// I don't want to touch code below this as it's generated from markdown to typst\n\n+ #lorem(10)\n  - #lorem(10)\n  - #lorem(10)\n+ #lorem(10)\n  - #lorem(10)\n+ #lorem(10)\n  - #lorem(10)\n\n#block[\n#set enum(numbering: \"a)\", start: 1)\n+ #lorem(10)\n\n+ #lorem(10)\n\n+ #lorem(10)\n\n+ #lorem(10)\n]\n\n\n```\n\n</details>",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 124.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1287
    },
    {
      "id": 11265,
      "post_number": 2,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-04-18T08:06:02.818Z",
      "updated_at": "2025-04-18T08:34:21.908Z",
      "cooked": "<p>Hi there <a class=\"mention\" href=\"/u/jarko\">@Jarko</a>,</p>\n<p>You seem to be missing a show rule to globally set the item’s number to the desired colour.</p>\n<p>Perhaps adding something like this would work?</p>\n<aside class=\"quote\" data-post=\"3\" data-topic=\"1861\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/EA3E47/48.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/can-i-change-the-font-of-the-numbers-in-a-numbered-list/1861/3\">Can I change the font of the numbers in a numbered list?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    Or more idiomatic: \n#show enum: set text(weight: \"bold\")\n\nIf you want only the numbers to be bold: \n#set enum(numbering: n =&gt; text(weight: \"bold\")[#n])\n  </blockquote>\n</aside>\n",
      "raw": "Hi there @Jarko, \n\nYou seem to be missing a show rule to globally set the item’s number to the desired colour. \n\nPerhaps adding something like this would work?\n\nhttps://forum.typst.app/t/can-i-change-the-font-of-the-numbers-in-a-numbered-list/1861/3?u=vmartel08",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 8.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 11266,
      "post_number": 3,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-04-18T10:10:36.824Z",
      "updated_at": "2025-04-18T12:10:44.953Z",
      "cooked": "<p>In your current code the color of the numbering is overridden by the set rule inside the block. Since this code is generated from markdown my understanding is that you are not able to include the coloring of the markers there?</p>\n<p>My proposed solution uses two show-set rules to achieve the coloring of the markers. The first rule will set the text color of the entire enum to blue, and the second rule will set the text color of the enum item body to black again. This only leaves the enum markers in the blue color.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show enum: set text(blue)\n#show enum.item: set text(black)\n</code></pre>\n<p>Note that this fails if you only have an enum with a single item. The rule for <code>enum.item</code> is not applied in this case. I think this is related to <a href=\"https://github.com/typst/typst/issues/1274\" class=\"inline-onebox\">`#show enum.item` doesn't apply to `#enum` · Issue #1274 · typst/typst · GitHub</a>.</p>",
      "raw": "In your current code the color of the numbering is overridden by the set rule inside the block. Since this code is generated from markdown my understanding is that you are not able to include the coloring of the markers there?\n\nMy proposed solution uses two show-set rules to achieve the coloring of the markers. The first rule will set the text color of the entire enum to blue, and the second rule will set the text color of the enum item body to black again. This only leaves the enum markers in the blue color.\n\n```typ\n#show enum: set text(blue)\n#show enum.item: set text(black)\n```\n\nNote that this fails if you only have an enum with a single item. The rule for `enum.item` is not applied in this case. I think this is related to https://github.com/typst/typst/issues/1274.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 4,
      "reads": 18,
      "score": 78.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 11270,
      "post_number": 4,
      "username": "Jarko",
      "name": "Jarko",
      "created_at": "2025-04-18T11:13:44.539Z",
      "updated_at": "2025-04-18T11:14:41.914Z",
      "cooked": "<p>Thank you very much <a href=\"https://forum.typst.app/u/janekfleper\">janekfleper</a>. I really dig your clever out of the box thinking here. With my use case, I can live with the limitation you mentioned. However I will leave this unanswered, in case someone has a solution without the limitation.</p>",
      "raw": "Thank you very much [janekfleper](https://forum.typst.app/u/janekfleper). I really dig your clever out of the box thinking here. With my use case, I can live with the limitation you mentioned. However I will leave this unanswered, in case someone has a solution without the limitation.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 8.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1287
    },
    {
      "id": 11274,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-18T12:09:08.834Z",
      "updated_at": "2025-04-18T12:09:08.834Z",
      "cooked": "<p>In case someone has a solution without the limitation, the solution marker can always be changed to another post, if it ever appears.</p>",
      "raw": "In case someone has a solution without the limitation, the solution marker can always be changed to another post, if it ever appears.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 16,
      "score": 18.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:49:01.530788"
}
{
  "topic_metadata": {
    "id": 3715,
    "title": "How to adjust numerator fraction line vertical spacing?",
    "slug": "how-to-adjust-numerator-fraction-line-vertical-spacing",
    "posts_count": 3,
    "created_at": "2025-04-18T13:07:59.836Z",
    "last_posted_at": "2025-04-18T15:31:54.212Z",
    "views": 83,
    "like_count": 0,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "Andrew",
    "tags": [
      "layout",
      "math"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 551
  },
  "posts": [
    {
      "id": 11278,
      "post_number": 1,
      "username": "HuangMI",
      "name": "HuangMI",
      "created_at": "2025-04-18T13:08:00.188Z",
      "updated_at": "2025-04-22T06:40:25.801Z",
      "cooked": "<p>I want to adjust the black equation in the image to make the spacing between the numerator and the fraction line equal to the purple equation’s spacing. How should I write the code? I think the purple equation has more aesthetically pleasing formatting.<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/4/4363dd2985944161f1275f65fd8425244d58769e.png\" data-download-href=\"https://forum.typst.app/uploads/default/4363dd2985944161f1275f65fd8425244d58769e\" title=\"1744980686886\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/4/4363dd2985944161f1275f65fd8425244d58769e_2_690x337.png\" alt=\"1744980686886\" data-base62-sha1=\"9C9WLZZx5aFcm254tTjJOJfrSlU\" width=\"690\" height=\"337\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/4/4363dd2985944161f1275f65fd8425244d58769e_2_690x337.png, https://forum.typst.app/uploads/default/optimized/2X/4/4363dd2985944161f1275f65fd8425244d58769e_2_1035x505.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/4/4363dd2985944161f1275f65fd8425244d58769e_2_1380x674.png 2x\" data-dominant-color=\"F0EFF2\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">1744980686886</span><span class=\"informations\">1699×831 64.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/865db5b403818d3ba40e2c3a386cbd15a74d2cac.png\" data-download-href=\"https://forum.typst.app/uploads/default/865db5b403818d3ba40e2c3a386cbd15a74d2cac\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/865db5b403818d3ba40e2c3a386cbd15a74d2cac_2_594x500.png\" alt=\"image\" data-base62-sha1=\"jaEKHJJXGJ1OpovaoVtNPvQWWZK\" width=\"594\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/8/865db5b403818d3ba40e2c3a386cbd15a74d2cac_2_594x500.png, https://forum.typst.app/uploads/default/optimized/2X/8/865db5b403818d3ba40e2c3a386cbd15a74d2cac_2_891x750.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/8/865db5b403818d3ba40e2c3a386cbd15a74d2cac_2_1188x1000.png 2x\" data-dominant-color=\"F7F6F8\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1861×1564 108 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "I want to adjust the black equation in the image to make the spacing between the numerator and the fraction line equal to the purple equation's spacing. How should I write the code? I think the purple equation has more aesthetically pleasing formatting. \n![1744980686886|690x337](upload://9C9WLZZx5aFcm254tTjJOJfrSlU.png)\n![image|594x500](upload://jaEKHJJXGJ1OpovaoVtNPvQWWZK.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 65.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1479
    },
    {
      "id": 11282,
      "post_number": 2,
      "username": "Mathemensch",
      "name": "Alexander Schulz",
      "created_at": "2025-04-18T14:22:34.644Z",
      "updated_at": "2025-04-18T14:22:34.644Z",
      "cooked": "<p>This solution is admittedly a bit hacky. However, since there is no (documented) way to adjust the spacing between the numerator and denominator, recreating the <code>frac</code> function was the only viable approach I found.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show math.frac: it =&gt; {\n  context {\n    let width = calc.max(measure($it.num$).width, measure($it.denom$).width)\n    stack(spacing: 0.25em, \n      $it.num$,\n      line(stroke:0.5pt, length: width),\n      $it.denom$)\n  }\n}\n\n$ a^2/b + x/y = 1 $\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/1/17b6f9fd5c5da149d531314d77ee4ed2b2a2064c.png\" alt=\"image\" data-base62-sha1=\"3nN0rID9acd9zsZKYLQwcGx7GkQ\" width=\"366\" height=\"356\"></p>\n<p><a href=\"https://typst.app/project/reQMeWLVRNivMbaUZgRYSd\" class=\"onebox\" target=\"_blank\" rel=\"noopener\">https://typst.app/project/reQMeWLVRNivMbaUZgRYSd</a></p>",
      "raw": "This solution is admittedly a bit hacky. However, since there is no (documented) way to adjust the spacing between the numerator and denominator, recreating the `frac` function was the only viable approach I found.\n\n\n```typ\n#show math.frac: it => {\n  context {\n    let width = calc.max(measure($it.num$).width, measure($it.denom$).width)\n    stack(spacing: 0.25em, \n      $it.num$,\n      line(stroke:0.5pt, length: width),\n      $it.denom$)\n  }\n}\n\n$ a^2/b + x/y = 1 $\n```\n\n![image|366x356](upload://3nN0rID9acd9zsZKYLQwcGx7GkQ.png)\n\n\nhttps://typst.app/project/reQMeWLVRNivMbaUZgRYSd",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 15.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 307
    },
    {
      "id": 11285,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-18T15:31:54.212Z",
      "updated_at": "2025-04-27T13:34:18.855Z",
      "cooked": "<p>Hello. There is no way to adjust that with rules, so you can open an issue about it.</p>\n<p>By looking at <a href=\"https://github.com/typst/typst/blob/7e072e24930d8a7524f700b62cabd97ceb4f45e6/crates/typst-layout/src/math/frac.rs#L44\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">typst/crates/typst-layout/src/math/frac.rs at 7e072e24930d8a7524f700b62cabd97ceb4f45e6 · typst/typst · GitHub</a>, the default show rule is pretty big and it uses a lot of things that do not exist in Typst, but here is roughly how it works for <code>frac</code>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show math.equation.where(block: true): it =&gt; {\n  show math.frac: it =&gt; context {\n    let num-vert-spacing = 2pt\n    let thickness = 0.045em.to-absolute()\n    let around = 0.1em\n\n    // Grabbed from font, it looks like.\n    let axis = -0.55em.to-absolute() // denom/line\n    let shift-up = 0pt // denom + line\n    let shift-down = 0.45em.to-absolute() // denom + other stuff\n    let num-descent = 0pt // denom + line\n    let denom-ascent = -0.35em.to-absolute() // denom + other stuff\n    let num-min = 0.1em.to-absolute() // denom + line\n    let denom-min = 0.1em.to-absolute() // denom + line\n\n    let num-size = measure(it.num)\n    let denom-size = measure(it.denom)\n\n    import calc: max\n    let num-gap = max(shift-up - (axis + thickness / 2) - num-descent, num-min)\n    let denom-gap = max(shift-down + (axis - thickness / 2) - denom-ascent, denom-min)\n    let line-width = max(num-size.width, denom-size.width)\n    let width = line-width + 2 * around\n    let height = num-size.height + num-gap + thickness + denom-gap + denom-size.height\n\n    let size = (width, height)\n    let num-pos = ((width - num-size.width) / 2, 1pt + num-vert-spacing)\n    let line-pos = ((width - line-width) / 2, num-size.height + num-gap + thickness / 2)\n    let denom-pos = ((width - denom-size.width) / 2, height - denom-size.height)\n    let baseline = line-pos.last() + axis\n\n    let frame = box.with(width: size.first(), height: size.last())\n    frame = frame.with(baseline: baseline)\n    frame({\n      place(dx: num-pos.first(), dy: num-pos.last(), $it.num$)\n      place(dx: denom-pos.first(), dy: denom-pos.last(), $it.denom$)\n      place(\n        dx: line-pos.first(),\n        dy: line-pos.last(),\n        line(length: line-width, stroke: thickness)\n      )\n    })\n  }\n  it\n}\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/6/67ed4562b698cf43c2445fe95efa22f15613333a.png\" alt=\"image\" data-base62-sha1=\"ePnwSvCMoeVEDV4Yy6f7ILeO4C6\" width=\"328\" height=\"156\"></p>\n<p>It has different values for display/non-display variants, so I only played with block equation, for inline one the values should be different.</p>\n<p>The only problem with it is that the values are manually assigned, and the end result is slightly different: the line width is slightly different, the x position is slightly changed. The only noticeable change I had to make is add <code>1pt</code> to the numerator y value, because the zero looks way off from the default look.</p>",
      "raw": "Hello. There is no way to adjust that with rules, so you can open an issue about it.\n\nBy looking at https://github.com/typst/typst/blob/7e072e24930d8a7524f700b62cabd97ceb4f45e6/crates/typst-layout/src/math/frac.rs#L44, the default show rule is pretty big and it uses a lot of things that do not exist in Typst, but here is roughly how it works for `frac`:\n\n```typ\n#show math.equation.where(block: true): it => {\n  show math.frac: it => context {\n    let num-vert-spacing = 2pt\n    let thickness = 0.045em.to-absolute()\n    let around = 0.1em\n\n    // Grabbed from font, it looks like.\n    let axis = -0.55em.to-absolute() // denom/line\n    let shift-up = 0pt // denom + line\n    let shift-down = 0.45em.to-absolute() // denom + other stuff\n    let num-descent = 0pt // denom + line\n    let denom-ascent = -0.35em.to-absolute() // denom + other stuff\n    let num-min = 0.1em.to-absolute() // denom + line\n    let denom-min = 0.1em.to-absolute() // denom + line\n\n    let num-size = measure(it.num)\n    let denom-size = measure(it.denom)\n\n    import calc: max\n    let num-gap = max(shift-up - (axis + thickness / 2) - num-descent, num-min)\n    let denom-gap = max(shift-down + (axis - thickness / 2) - denom-ascent, denom-min)\n    let line-width = max(num-size.width, denom-size.width)\n    let width = line-width + 2 * around\n    let height = num-size.height + num-gap + thickness + denom-gap + denom-size.height\n\n    let size = (width, height)\n    let num-pos = ((width - num-size.width) / 2, 1pt + num-vert-spacing)\n    let line-pos = ((width - line-width) / 2, num-size.height + num-gap + thickness / 2)\n    let denom-pos = ((width - denom-size.width) / 2, height - denom-size.height)\n    let baseline = line-pos.last() + axis\n\n    let frame = box.with(width: size.first(), height: size.last())\n    frame = frame.with(baseline: baseline)\n    frame({\n      place(dx: num-pos.first(), dy: num-pos.last(), $it.num$)\n      place(dx: denom-pos.first(), dy: denom-pos.last(), $it.denom$)\n      place(\n        dx: line-pos.first(),\n        dy: line-pos.last(),\n        line(length: line-width, stroke: thickness)\n      )\n    })\n  }\n  it\n}\n```\n\n![image|328x156](upload://ePnwSvCMoeVEDV4Yy6f7ILeO4C6.png)\n\nIt has different values for display/non-display variants, so I only played with block equation, for inline one the values should be different.\n\nThe only problem with it is that the values are manually assigned, and the end result is slightly different: the line width is slightly different, the x position is slightly changed. The only noticeable change I had to make is add `1pt` to the numerator y value, because the zero looks way off from the default look.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 105.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:49:00.689680"
}
{
  "topic_metadata": {
    "id": 3717,
    "title": "How to magnify images in figures?",
    "slug": "how-to-magnify-images-in-figures",
    "posts_count": 4,
    "created_at": "2025-04-18T15:58:50.461Z",
    "last_posted_at": "2025-04-18T20:56:20.434Z",
    "views": 166,
    "like_count": 11,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "cetz",
      "figures",
      "images"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 1821
  },
  "posts": [
    {
      "id": 11290,
      "post_number": 1,
      "username": "Btjk16",
      "name": "Btjk16",
      "created_at": "2025-04-18T15:58:50.566Z",
      "updated_at": "2025-04-18T20:55:37.667Z",
      "cooked": "<p>Hi!  Newbie here, coming from LaTeX.</p>\n<p>There is a relatively common practice in GenAI literature with figures, where a magnification is applied to the images, allowing to show details or just to compare resolution. In LaTeX one can use TikZ with tikzimage  and spy/zoombox. At the end, there is a link to a post which illustrates it.</p>\n<p>But how magnification can be achieved with Typst and whether CeTZ or any other library is capable of doing it?</p>\n<p>Thanks!</p>\n<aside class=\"onebox stackexchange\" data-onebox-src=\"https://tex.stackexchange.com/questions/59705/magnifying-part-of-a-picture-similar-to-tikz-spy-library\">\n  <header class=\"source\">\n\n      <a href=\"https://tex.stackexchange.com/questions/59705/magnifying-part-of-a-picture-similar-to-tikz-spy-library\" target=\"_blank\" rel=\"noopener nofollow ugc\">tex.stackexchange.com</a>\n  </header>\n\n  <article class=\"onebox-body\">\n      <a href=\"https://tex.stackexchange.com/users/1183/ingo\" target=\"_blank\" rel=\"noopener nofollow ugc\">\n    <img alt=\"Ingo\" src=\"https://forum.typst.app/uploads/default/original/2X/0/0d63e9a7384ae35bf269b2bda62efc0fbda26fb7.png\" class=\"thumbnail onebox-avatar\" data-dominant-color=\"424242\" width=\"256\" height=\"256\">\n  </a>\n\n<h4>\n  <a href=\"https://tex.stackexchange.com/questions/59705/magnifying-part-of-a-picture-similar-to-tikz-spy-library\" target=\"_blank\" rel=\"noopener nofollow ugc\">Magnifying part of a picture similar to TikZ spy library</a>\n</h4>\n\n<div class=\"tags\">\n  <strong>tikz-pgf, spy</strong>\n</div>\n\n<div class=\"date\">\n  asked by\n  \n  <a href=\"https://tex.stackexchange.com/users/1183/ingo\" target=\"_blank\" rel=\"noopener nofollow ugc\">\n    Ingo\n  </a>\n  on <a href=\"https://tex.stackexchange.com/questions/59705/magnifying-part-of-a-picture-similar-to-tikz-spy-library\" target=\"_blank\" rel=\"noopener nofollow ugc\">01:44PM - 13 Jun 12 UTC</a>\n</div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "Hi!  Newbie here, coming from LaTeX. \n\nThere is a relatively common practice in GenAI literature with figures, where a magnification is applied to the images, allowing to show details or just to compare resolution. In LaTeX one can use TikZ with tikzimage  and spy/zoombox. At the end, there is a link to a post which illustrates it.\n\nBut how magnification can be achieved with Typst and whether CeTZ or any other library is capable of doing it?\n\nThanks!\n\nhttps://tex.stackexchange.com/questions/59705/magnifying-part-of-a-picture-similar-to-tikz-spy-library",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 55,
      "score": 96.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1480
    },
    {
      "id": 11294,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-18T17:13:46.970Z",
      "updated_at": "2025-04-19T13:34:10.230Z",
      "cooked": "<p>Hi. <a href=\"https://lilaq.org/docs/examples/plot-within-a-plot\" rel=\"noopener nofollow ugc\">Lilaq has something like this</a>, but it’s more of an emulation:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/lilaq:0.2.0\" as lq\n\n#let weierstrass(x, k: 8) = {\n  range(k).map(k =&gt; calc.pow(0.5, k) * calc.cos(calc.pow(5, k) * x)).sum()\n}\n\n#let xs = lq.linspace(-0.5, .5, num: 1000)\n#let xs-fine = lq.linspace(-0.05, 0, num: 1000)\n\n#show: lq.set-grid(stroke: none)\n\n#lq.diagram(\n  width: 14cm,\n  height: 7cm,\n  ylim: (0, 2),\n  margin: (x: 2%),\n  lq.plot(xs, mark: none, xs.map(weierstrass)),\n  lq.rect(-0.05, 1.5, width: .05, height: .3),\n  lq.place(\n    60%,\n    100% - 1.2em,\n    align: bottom,\n    lq.diagram(\n      width: 5.4cm,\n      height: 2cm,\n      margin: 0%,\n      ylim: (1.5, 1.8),\n      fill: white,\n      lq.plot(xs-fine, mark: none, xs-fine.map(weierstrass)),\n    ),\n  ),\n)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/f/f88f293655ef84f439a0cae2904d1d42ab970599.png\" data-download-href=\"https://forum.typst.app/uploads/default/f88f293655ef84f439a0cae2904d1d42ab970599\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/f/f88f293655ef84f439a0cae2904d1d42ab970599_2_690x359.png\" alt=\"image\" data-base62-sha1=\"zsR8hONDfwEOiM3TrRQ3EkL8z5D\" width=\"690\" height=\"359\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/f/f88f293655ef84f439a0cae2904d1d42ab970599_2_690x359.png, https://forum.typst.app/uploads/default/original/2X/f/f88f293655ef84f439a0cae2904d1d42ab970599.png 1.5x, https://forum.typst.app/uploads/default/original/2X/f/f88f293655ef84f439a0cae2904d1d42ab970599.png 2x\" data-dominant-color=\"16191B\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">719×375 63.2 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>So we can apply the same concept with CeTZ:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n\n#let unit = 1cm\n\n// Magnify content.\n//\n// - scale (ratio): magnification scale\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - size (array): size of the area to magnify\n// - body (content): what to magnify\n#let magnify(scale, place-pos, pos, size, body) = {\n  import cetz.draw: content, rect, line\n  rect(pos, (rel: (size.first(), -1 * size.last())), name: \"a\")\n  content(\n    anchor: \"north-west\",\n    name: \"b\",\n    place-pos,\n    block(\n      stroke: 1pt,\n      width: size.first() * unit * scale,\n      height: size.last() * unit * scale,\n      clip: true,\n      std.scale(\n        scale,\n        reflow: true,\n        move(dx: -pos.first() * unit, dy: pos.last() * unit, body),\n      ),\n    ),\n  )\n  line(\"a\", \"b\")\n}\n</code></pre>\n<p>And then get:</p>\n<details><summary>Full example</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n#import \"@preview/lilaq:0.2.0\" as lq\n\n#let unit = 1cm\n#let canvas = cetz.canvas.with(length: unit)\n\n#let weierstrass(x, k: 8) = {\n  range(k).map(k =&gt; calc.pow(0.5, k) * calc.cos(calc.pow(5, k) * x)).sum()\n}\n\n#let xs = lq.linspace(-0.5, .5, num: 1000)\n#let xs-fine = lq.linspace(-0.05, 0, num: 1000)\n\n#show: lq.set-grid(stroke: none)\n\n#let image = box(\n  lq.diagram(\n    width: 14cm,\n    height: 7cm,\n    ylim: (0, 2),\n    margin: (x: 2%),\n    yaxis: (ticks: none),\n    xaxis: (ticks: none),\n    lq.plot(xs, mark: none, xs.map(weierstrass)),\n  ),\n)\n\n// Magnify content.\n//\n// - scale (ratio): magnification scale\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - size (array): size of the area to magnify\n// - body (content): what to magnify\n#let magnify(scale, place-pos, pos, size, body) = {\n  import cetz.draw: content, rect, line\n  rect(pos, (rel: (size.first(), -1 * size.last())), name: \"a\")\n  content(\n    anchor: \"north-west\",\n    name: \"b\",\n    place-pos,\n    block(\n      stroke: 1pt,\n      width: size.first() * unit * scale,\n      height: size.last() * unit * scale,\n      clip: true,\n      std.scale(\n        scale,\n        reflow: true,\n        move(dx: -pos.first() * unit, dy: pos.last() * unit, body),\n      ),\n    ),\n  )\n  line(\"a\", \"b\")\n}\n\n#canvas({\n  import cetz.draw: *\n  content((0, 0), anchor: \"north-west\", image)\n  magnify(300%, (7, -3.9), (5, -2), (1, 1), image)\n})\n</code></pre>\n</details>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/1/18ed3359d86d73aa868c454147b8130537d9b144.png\" alt=\"image\" data-base62-sha1=\"3yvES0i3anwQ3zttNByClr6rM4A\" width=\"683\" height=\"352\"></p>\n<p>There are plenty of other variations of this, but most of them are more complicated, for example, if you want to connect all 4 corners with 4 lines, or use another shape, etc.</p>\n<p>Here is the yellow circle:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// Magnify content.\n//\n// - scale (ratio): magnification scale\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - diameter (int, float): size of the area to magnify\n// - body (content): what to magnify\n#let magnify(scale, place-pos, pos, diameter, body) = {\n  import cetz.draw: content, rect, line, circle, set-style\n  let color = yellow\n  set-style(stroke: color)\n  circle(pos, radius: diameter / 2 * unit, name: \"a\")\n  circle(place-pos, radius: diameter / 2 * scale * unit, name: \"b\")\n  line(\"a\", \"b\")\n  content(\n    (),\n    block(\n      stroke: 1pt + color,\n      radius: diameter / 2 * scale * unit,\n      width: diameter * scale * unit,\n      height: diameter * scale * unit,\n      clip: true,\n      std.scale(\n        scale,\n        reflow: true,\n        move(\n          dx: (-pos.first() + diameter / 2) * unit,\n          dy: (pos.last() + diameter / 2) * unit,\n          body,\n        ),\n      ),\n    ),\n  )\n}\n</code></pre>\n<details><summary>Full example</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n#import \"@preview/lilaq:0.2.0\" as lq\n\n#let unit = 1cm\n#let canvas = cetz.canvas.with(length: unit)\n\n#let weierstrass(x, k: 8) = {\n  range(k).map(k =&gt; calc.pow(0.5, k) * calc.cos(calc.pow(5, k) * x)).sum()\n}\n\n#let xs = lq.linspace(-0.5, .5, num: 1000)\n#let xs-fine = lq.linspace(-0.05, 0, num: 1000)\n\n#show: lq.set-grid(stroke: none)\n\n#let image = box(\n  lq.diagram(\n    width: 14cm,\n    height: 7cm,\n    ylim: (0, 2),\n    margin: (x: 2%),\n    yaxis: (ticks: none),\n    xaxis: (ticks: none),\n    lq.plot(xs, mark: none, xs.map(weierstrass)),\n  ),\n)\n\n// Magnify content.\n//\n// - scale (ratio): magnification scale\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - diameter (int, float): size of the area to magnify\n// - body (content): what to magnify\n#let magnify(scale, place-pos, pos, diameter, body) = {\n  import cetz.draw: content, rect, line, circle, set-style\n  let color = yellow\n  set-style(stroke: color)\n  circle(pos, radius: diameter / 2 * unit, name: \"a\")\n  circle(place-pos, radius: diameter / 2 * scale * unit, name: \"b\")\n  line(\"a\", \"b\")\n  content(\n    (),\n    block(\n      stroke: 1pt + color,\n      radius: diameter / 2 * scale * unit,\n      width: diameter * scale * unit,\n      height: diameter * scale * unit,\n      clip: true,\n      std.scale(\n        scale,\n        reflow: true,\n        move(\n          dx: (-pos.first() + diameter / 2) * unit,\n          dy: (pos.last() + diameter / 2) * unit,\n          body,\n        ),\n      ),\n    ),\n  )\n}\n\n#canvas({\n  import cetz.draw: *\n  content((0, 0), anchor: \"north-west\", image)\n  magnify(300%, (8, -5.3), (5.9, -2.5), 1, image)\n})\n</code></pre>\n</details>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/f/f61d13b66c601e183879a6eb8e77d4e95773a9d7.png\" data-download-href=\"https://forum.typst.app/uploads/default/f61d13b66c601e183879a6eb8e77d4e95773a9d7\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/f/f61d13b66c601e183879a6eb8e77d4e95773a9d7_2_690x359.png\" alt=\"image\" data-base62-sha1=\"z7dKNUIu3iK2KRlRxmMEOUqdBiL\" width=\"690\" height=\"359\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/f/f61d13b66c601e183879a6eb8e77d4e95773a9d7_2_690x359.png, https://forum.typst.app/uploads/default/original/2X/f/f61d13b66c601e183879a6eb8e77d4e95773a9d7.png 1.5x, https://forum.typst.app/uploads/default/original/2X/f/f61d13b66c601e183879a6eb8e77d4e95773a9d7.png 2x\" data-dominant-color=\"05080B\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">802×418 31.8 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p><s>Should work with raster images, but I haven’t tested that.</s></p>\n<p>Looks like it works perfectly well with images, but you do have to lock both axis, otherwise it will scale incorrectly. For this, you can do</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let image = {\n  let image = image.with(\"file.png\")\n  context image(..measure(image(width: 20cm)))\n}\n</code></pre>\n<details><summary>Raster image</summary>\n<p><a href=\"https://raw.githubusercontent.com/typst/typst-dev-assets/refs/heads/main/files/images/glacier.jpg\" rel=\"noopener nofollow ugc\">Image link</a></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n\n#let unit = 1cm\n#let canvas = cetz.canvas.with(length: unit)\n\n// Magnify content using circle.\n//\n// - scale (ratio): magnification scale\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - diameter (int, float): size of the circle area to magnify\n// - body (content): what to magnify\n#let magnify-circle(scale, place-pos, pos, diameter, body) = {\n  import cetz.draw: content, rect, line, circle, set-style\n  let color = yellow\n  set-style(stroke: color)\n  circle(pos, radius: diameter / 2 * unit, name: \"a\")\n  circle(place-pos, radius: diameter / 2 * scale * unit, name: \"b\")\n  line(\"a\", \"b\")\n  content(\n    (),\n    block(\n      stroke: 1pt + color,\n      radius: diameter / 2 * scale * unit,\n      width: diameter * scale * unit,\n      height: diameter * scale * unit,\n      clip: true,\n      std.scale(\n        scale,\n        reflow: true,\n        move(\n          dx: (-pos.first() + diameter / 2) * unit,\n          dy: (pos.last() + diameter / 2) * unit,\n          body,\n        ),\n      ),\n    ),\n  )\n}\n\n// Magnify content using rectangle.\n//\n// - scale (ratio): magnification scale\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - size (array): size of the rectangle area to magnify\n// - body (content): what to magnify\n#let magnify-rect(scale, place-pos, pos, size, body) = {\n  import cetz.draw: content, rect, line\n  rect(pos, (rel: (size.first(), -1 * size.last())), name: \"a\")\n  content(\n    anchor: \"north-west\",\n    name: \"b\",\n    place-pos,\n    block(\n      stroke: 1pt,\n      width: size.first() * unit * scale,\n      height: size.last() * unit * scale,\n      clip: true,\n      std.scale(\n        scale,\n        reflow: true,\n        move(dx: -pos.first() * unit, dy: pos.last() * unit, body),\n      ),\n    ),\n  )\n  line(\"a\", \"b\")\n}\n\n#let image = {\n  let image = image.with(\"glacier.jpg\")\n  context image(..measure(image(width: 20cm)))\n}\n\n#set page(width: auto, height: auto, margin: 0pt)\n\n#canvas({\n  import cetz.draw: *\n  content((0, 0), anchor: \"north-west\", image)\n  magnify-rect(500%, (4, -4), (12, -2.6), (1.5, 1.3), image)\n  magnify-circle(500%, (16, -8), (13, -3.2), 1.5, image)\n})\n</code></pre>\n</details>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/2/2b4f73ee8919303ab23f62f9d7b8663b31b4c565.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/2b4f73ee8919303ab23f62f9d7b8663b31b4c565\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/original/2X/2/2b4f73ee8919303ab23f62f9d7b8663b31b4c565.jpeg\" alt=\"image\" data-base62-sha1=\"6b8L0uLkpdDYzi8pno6rnEETPiR\" width=\"690\" height=\"459\" data-dominant-color=\"8B95A0\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">960×639 78.2 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Or, if you want to just edit image, without needing for canvas:</p>\n<details><summary>code</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n\n// Magnify content using circle.\n//\n// - scale (ratio): magnification scale\n// - body (content): what to magnify\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - diameter (int, float): size of the area to magnify\n// - unit (length): unit to use to convert int/float numbers\n// - color (length): stroke color\n#let magnify-circle(\n  scale,\n  body,\n  place-pos: (0, 0),\n  pos: (0, 0),\n  diameter: 1,\n  unit: 1cm,\n  color: yellow,\n) = {\n  let canvas = cetz.canvas.with(length: unit)\n  canvas({\n    import cetz.draw: content, line, circle, set-style\n    content((0, 0), anchor: \"north-west\", body)\n    set-style(stroke: color)\n    circle(pos, radius: diameter / 2 * unit, name: \"a\")\n    circle(place-pos, radius: diameter / 2 * scale * unit, name: \"b\")\n    line(\"a\", \"b\")\n    content(\n      (),\n      block(\n        stroke: 1pt + color,\n        radius: diameter / 2 * scale * unit,\n        width: diameter * scale * unit,\n        height: diameter * scale * unit,\n        clip: true,\n        std.scale(\n          scale,\n          reflow: true,\n          move(\n            dx: (-pos.first() + diameter / 2) * unit,\n            dy: (pos.last() + diameter / 2) * unit,\n            body,\n          ),\n        ),\n      ),\n    )\n  })\n}\n\n// Magnify content using rectangle.\n//\n// - scale (ratio): magnification scale\n// - body (content): what to magnify\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - size (array): size of the area to magnify\n// - unit (length): unit to use to convert int/float numbers\n#let magnify-rect(\n  scale,\n  body,\n  place-pos: (0, 0),\n  pos: (0, 0),\n  size: (1, 1),\n  unit: 1cm,\n) = {\n  let canvas = cetz.canvas.with(length: unit)\n  canvas({\n    import cetz.draw: content, rect, line\n    content((0, 0), anchor: \"north-west\", body)\n    rect(pos, (rel: (size.first(), -1 * size.last())), name: \"a\")\n    content(\n      anchor: \"north-west\",\n      name: \"b\",\n      place-pos,\n      block(\n        stroke: 1pt,\n        width: size.first() * unit * scale,\n        height: size.last() * unit * scale,\n        clip: true,\n        std.scale(\n          scale,\n          reflow: true,\n          move(dx: -pos.first() * unit, dy: pos.last() * unit, body),\n        ),\n      ),\n    )\n    line(\"a\", \"b\")\n  })\n}\n\n#set page(width: auto, height: auto, margin: 0pt)\n\n#let image = {\n  let image = image.with(\"glacier.jpg\")\n  context image(..measure(image(width: 20cm)))\n}\n\n#magnify-circle(\n  500%,\n  image,\n  place-pos: (16, -8),\n  pos: (13, -3.2),\n  diameter: 1.5,\n)\n\n#magnify-rect(\n  500%,\n  image,\n  place-pos: (4, -4),\n  pos: (12, -2.6),\n  size: (1.5, 1.3),\n)\n</code></pre>\n</details>",
      "raw": "Hi. [Lilaq has something like this](https://lilaq.org/docs/examples/plot-within-a-plot), but it's more of an emulation:\n\n```typ\n#import \"@preview/lilaq:0.2.0\" as lq\n\n#let weierstrass(x, k: 8) = {\n  range(k).map(k => calc.pow(0.5, k) * calc.cos(calc.pow(5, k) * x)).sum()\n}\n\n#let xs = lq.linspace(-0.5, .5, num: 1000)\n#let xs-fine = lq.linspace(-0.05, 0, num: 1000)\n\n#show: lq.set-grid(stroke: none)\n\n#lq.diagram(\n  width: 14cm,\n  height: 7cm,\n  ylim: (0, 2),\n  margin: (x: 2%),\n  lq.plot(xs, mark: none, xs.map(weierstrass)),\n  lq.rect(-0.05, 1.5, width: .05, height: .3),\n  lq.place(\n    60%,\n    100% - 1.2em,\n    align: bottom,\n    lq.diagram(\n      width: 5.4cm,\n      height: 2cm,\n      margin: 0%,\n      ylim: (1.5, 1.8),\n      fill: white,\n      lq.plot(xs-fine, mark: none, xs-fine.map(weierstrass)),\n    ),\n  ),\n)\n```\n\n![image|690x359](upload://zsR8hONDfwEOiM3TrRQ3EkL8z5D.png)\n\nSo we can apply the same concept with CeTZ:\n\n```typ\n#import \"@preview/cetz:0.3.4\"\n\n#let unit = 1cm\n\n// Magnify content.\n//\n// - scale (ratio): magnification scale\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - size (array): size of the area to magnify\n// - body (content): what to magnify\n#let magnify(scale, place-pos, pos, size, body) = {\n  import cetz.draw: content, rect, line\n  rect(pos, (rel: (size.first(), -1 * size.last())), name: \"a\")\n  content(\n    anchor: \"north-west\",\n    name: \"b\",\n    place-pos,\n    block(\n      stroke: 1pt,\n      width: size.first() * unit * scale,\n      height: size.last() * unit * scale,\n      clip: true,\n      std.scale(\n        scale,\n        reflow: true,\n        move(dx: -pos.first() * unit, dy: pos.last() * unit, body),\n      ),\n    ),\n  )\n  line(\"a\", \"b\")\n}\n```\n\nAnd then get:\n\n<details><summary>Full example</summary>\n\n```typ\n#import \"@preview/cetz:0.3.4\"\n#import \"@preview/lilaq:0.2.0\" as lq\n\n#let unit = 1cm\n#let canvas = cetz.canvas.with(length: unit)\n\n#let weierstrass(x, k: 8) = {\n  range(k).map(k => calc.pow(0.5, k) * calc.cos(calc.pow(5, k) * x)).sum()\n}\n\n#let xs = lq.linspace(-0.5, .5, num: 1000)\n#let xs-fine = lq.linspace(-0.05, 0, num: 1000)\n\n#show: lq.set-grid(stroke: none)\n\n#let image = box(\n  lq.diagram(\n    width: 14cm,\n    height: 7cm,\n    ylim: (0, 2),\n    margin: (x: 2%),\n    yaxis: (ticks: none),\n    xaxis: (ticks: none),\n    lq.plot(xs, mark: none, xs.map(weierstrass)),\n  ),\n)\n\n// Magnify content.\n//\n// - scale (ratio): magnification scale\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - size (array): size of the area to magnify\n// - body (content): what to magnify\n#let magnify(scale, place-pos, pos, size, body) = {\n  import cetz.draw: content, rect, line\n  rect(pos, (rel: (size.first(), -1 * size.last())), name: \"a\")\n  content(\n    anchor: \"north-west\",\n    name: \"b\",\n    place-pos,\n    block(\n      stroke: 1pt,\n      width: size.first() * unit * scale,\n      height: size.last() * unit * scale,\n      clip: true,\n      std.scale(\n        scale,\n        reflow: true,\n        move(dx: -pos.first() * unit, dy: pos.last() * unit, body),\n      ),\n    ),\n  )\n  line(\"a\", \"b\")\n}\n\n#canvas({\n  import cetz.draw: *\n  content((0, 0), anchor: \"north-west\", image)\n  magnify(300%, (7, -3.9), (5, -2), (1, 1), image)\n})\n```\n\n</details>\n\n![image|683x352](upload://3yvES0i3anwQ3zttNByClr6rM4A.png)\n\nThere are plenty of other variations of this, but most of them are more complicated, for example, if you want to connect all 4 corners with 4 lines, or use another shape, etc.\n\nHere is the yellow circle:\n\n```typ\n// Magnify content.\n//\n// - scale (ratio): magnification scale\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - diameter (int, float): size of the area to magnify\n// - body (content): what to magnify\n#let magnify(scale, place-pos, pos, diameter, body) = {\n  import cetz.draw: content, rect, line, circle, set-style\n  let color = yellow\n  set-style(stroke: color)\n  circle(pos, radius: diameter / 2 * unit, name: \"a\")\n  circle(place-pos, radius: diameter / 2 * scale * unit, name: \"b\")\n  line(\"a\", \"b\")\n  content(\n    (),\n    block(\n      stroke: 1pt + color,\n      radius: diameter / 2 * scale * unit,\n      width: diameter * scale * unit,\n      height: diameter * scale * unit,\n      clip: true,\n      std.scale(\n        scale,\n        reflow: true,\n        move(\n          dx: (-pos.first() + diameter / 2) * unit,\n          dy: (pos.last() + diameter / 2) * unit,\n          body,\n        ),\n      ),\n    ),\n  )\n}\n```\n\n<details><summary>Full example</summary>\n\n```typ\n#import \"@preview/cetz:0.3.4\"\n#import \"@preview/lilaq:0.2.0\" as lq\n\n#let unit = 1cm\n#let canvas = cetz.canvas.with(length: unit)\n\n#let weierstrass(x, k: 8) = {\n  range(k).map(k => calc.pow(0.5, k) * calc.cos(calc.pow(5, k) * x)).sum()\n}\n\n#let xs = lq.linspace(-0.5, .5, num: 1000)\n#let xs-fine = lq.linspace(-0.05, 0, num: 1000)\n\n#show: lq.set-grid(stroke: none)\n\n#let image = box(\n  lq.diagram(\n    width: 14cm,\n    height: 7cm,\n    ylim: (0, 2),\n    margin: (x: 2%),\n    yaxis: (ticks: none),\n    xaxis: (ticks: none),\n    lq.plot(xs, mark: none, xs.map(weierstrass)),\n  ),\n)\n\n// Magnify content.\n//\n// - scale (ratio): magnification scale\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - diameter (int, float): size of the area to magnify\n// - body (content): what to magnify\n#let magnify(scale, place-pos, pos, diameter, body) = {\n  import cetz.draw: content, rect, line, circle, set-style\n  let color = yellow\n  set-style(stroke: color)\n  circle(pos, radius: diameter / 2 * unit, name: \"a\")\n  circle(place-pos, radius: diameter / 2 * scale * unit, name: \"b\")\n  line(\"a\", \"b\")\n  content(\n    (),\n    block(\n      stroke: 1pt + color,\n      radius: diameter / 2 * scale * unit,\n      width: diameter * scale * unit,\n      height: diameter * scale * unit,\n      clip: true,\n      std.scale(\n        scale,\n        reflow: true,\n        move(\n          dx: (-pos.first() + diameter / 2) * unit,\n          dy: (pos.last() + diameter / 2) * unit,\n          body,\n        ),\n      ),\n    ),\n  )\n}\n\n#canvas({\n  import cetz.draw: *\n  content((0, 0), anchor: \"north-west\", image)\n  magnify(300%, (8, -5.3), (5.9, -2.5), 1, image)\n})\n```\n\n</details>\n\n![image|690x359](upload://z7dKNUIu3iK2KRlRxmMEOUqdBiL.png)\n\n~~Should work with raster images, but I haven't tested that.~~\n\nLooks like it works perfectly well with images, but you do have to lock both axis, otherwise it will scale incorrectly. For this, you can do\n\n```typ\n#let image = {\n  let image = image.with(\"file.png\")\n  context image(..measure(image(width: 20cm)))\n}\n```\n\n<details><summary>Raster image</summary>\n\n[Image link](https://raw.githubusercontent.com/typst/typst-dev-assets/refs/heads/main/files/images/glacier.jpg)\n\n```typ\n#import \"@preview/cetz:0.3.4\"\n\n#let unit = 1cm\n#let canvas = cetz.canvas.with(length: unit)\n\n// Magnify content using circle.\n//\n// - scale (ratio): magnification scale\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - diameter (int, float): size of the circle area to magnify\n// - body (content): what to magnify\n#let magnify-circle(scale, place-pos, pos, diameter, body) = {\n  import cetz.draw: content, rect, line, circle, set-style\n  let color = yellow\n  set-style(stroke: color)\n  circle(pos, radius: diameter / 2 * unit, name: \"a\")\n  circle(place-pos, radius: diameter / 2 * scale * unit, name: \"b\")\n  line(\"a\", \"b\")\n  content(\n    (),\n    block(\n      stroke: 1pt + color,\n      radius: diameter / 2 * scale * unit,\n      width: diameter * scale * unit,\n      height: diameter * scale * unit,\n      clip: true,\n      std.scale(\n        scale,\n        reflow: true,\n        move(\n          dx: (-pos.first() + diameter / 2) * unit,\n          dy: (pos.last() + diameter / 2) * unit,\n          body,\n        ),\n      ),\n    ),\n  )\n}\n\n// Magnify content using rectangle.\n//\n// - scale (ratio): magnification scale\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - size (array): size of the rectangle area to magnify\n// - body (content): what to magnify\n#let magnify-rect(scale, place-pos, pos, size, body) = {\n  import cetz.draw: content, rect, line\n  rect(pos, (rel: (size.first(), -1 * size.last())), name: \"a\")\n  content(\n    anchor: \"north-west\",\n    name: \"b\",\n    place-pos,\n    block(\n      stroke: 1pt,\n      width: size.first() * unit * scale,\n      height: size.last() * unit * scale,\n      clip: true,\n      std.scale(\n        scale,\n        reflow: true,\n        move(dx: -pos.first() * unit, dy: pos.last() * unit, body),\n      ),\n    ),\n  )\n  line(\"a\", \"b\")\n}\n\n#let image = {\n  let image = image.with(\"glacier.jpg\")\n  context image(..measure(image(width: 20cm)))\n}\n\n#set page(width: auto, height: auto, margin: 0pt)\n\n#canvas({\n  import cetz.draw: *\n  content((0, 0), anchor: \"north-west\", image)\n  magnify-rect(500%, (4, -4), (12, -2.6), (1.5, 1.3), image)\n  magnify-circle(500%, (16, -8), (13, -3.2), 1.5, image)\n})\n```\n\n</details>\n\n![image|690x459](upload://6b8L0uLkpdDYzi8pno6rnEETPiR.jpeg)\n\nOr, if you want to just edit image, without needing for canvas:\n\n<details><summary>code</summary>\n\n```typ\n#import \"@preview/cetz:0.3.4\"\n\n// Magnify content using circle.\n//\n// - scale (ratio): magnification scale\n// - body (content): what to magnify\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - diameter (int, float): size of the area to magnify\n// - unit (length): unit to use to convert int/float numbers\n// - color (length): stroke color\n#let magnify-circle(\n  scale,\n  body,\n  place-pos: (0, 0),\n  pos: (0, 0),\n  diameter: 1,\n  unit: 1cm,\n  color: yellow,\n) = {\n  let canvas = cetz.canvas.with(length: unit)\n  canvas({\n    import cetz.draw: content, line, circle, set-style\n    content((0, 0), anchor: \"north-west\", body)\n    set-style(stroke: color)\n    circle(pos, radius: diameter / 2 * unit, name: \"a\")\n    circle(place-pos, radius: diameter / 2 * scale * unit, name: \"b\")\n    line(\"a\", \"b\")\n    content(\n      (),\n      block(\n        stroke: 1pt + color,\n        radius: diameter / 2 * scale * unit,\n        width: diameter * scale * unit,\n        height: diameter * scale * unit,\n        clip: true,\n        std.scale(\n          scale,\n          reflow: true,\n          move(\n            dx: (-pos.first() + diameter / 2) * unit,\n            dy: (pos.last() + diameter / 2) * unit,\n            body,\n          ),\n        ),\n      ),\n    )\n  })\n}\n\n// Magnify content using rectangle.\n//\n// - scale (ratio): magnification scale\n// - body (content): what to magnify\n// - place-pos (array): position of the magnification\n// - pos (array): where in the content to magnify\n// - size (array): size of the area to magnify\n// - unit (length): unit to use to convert int/float numbers\n#let magnify-rect(\n  scale,\n  body,\n  place-pos: (0, 0),\n  pos: (0, 0),\n  size: (1, 1),\n  unit: 1cm,\n) = {\n  let canvas = cetz.canvas.with(length: unit)\n  canvas({\n    import cetz.draw: content, rect, line\n    content((0, 0), anchor: \"north-west\", body)\n    rect(pos, (rel: (size.first(), -1 * size.last())), name: \"a\")\n    content(\n      anchor: \"north-west\",\n      name: \"b\",\n      place-pos,\n      block(\n        stroke: 1pt,\n        width: size.first() * unit * scale,\n        height: size.last() * unit * scale,\n        clip: true,\n        std.scale(\n          scale,\n          reflow: true,\n          move(dx: -pos.first() * unit, dy: pos.last() * unit, body),\n        ),\n      ),\n    )\n    line(\"a\", \"b\")\n  })\n}\n\n#set page(width: auto, height: auto, margin: 0pt)\n\n#let image = {\n  let image = image.with(\"glacier.jpg\")\n  context image(..measure(image(width: 20cm)))\n}\n\n#magnify-circle(\n  500%,\n  image,\n  place-pos: (16, -8),\n  pos: (13, -3.2),\n  diameter: 1.5,\n)\n\n#magnify-rect(\n  500%,\n  image,\n  place-pos: (4, -4),\n  pos: (12, -2.6),\n  size: (1.5, 1.3),\n)\n```\n\n</details>",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 9,
      "reads": 54,
      "score": 300.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11306,
      "post_number": 3,
      "username": "Btjk16",
      "name": "Btjk16",
      "created_at": "2025-04-18T20:38:51.357Z",
      "updated_at": "2025-04-18T20:38:51.357Z",
      "cooked": "<p>Thank you very much, I’d never have come to that, it looks pretty cool!</p>",
      "raw": "Thank you very much, I'd never have come to that, it looks pretty cool!",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 48,
      "score": 24.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1480
    },
    {
      "id": 11310,
      "post_number": 4,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-04-18T20:56:20.434Z",
      "updated_at": "2025-04-18T20:56:20.434Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/btjk16\">@Btjk16</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Btjk16, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 47,
      "score": 24.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:48:59.889208"
}
{
  "topic_metadata": {
    "id": 3727,
    "title": "How to set a hanging indent for footnotes?",
    "slug": "how-to-set-a-hanging-indent-for-footnotes",
    "posts_count": 5,
    "created_at": "2025-04-19T13:20:43.963Z",
    "last_posted_at": "2025-04-19T16:17:03.566Z",
    "views": 57,
    "like_count": 2,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "Eric",
    "tags": [
      "scripting",
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 515
  },
  "posts": [
    {
      "id": 11327,
      "post_number": 1,
      "username": "Mark_Hilton",
      "name": "Mark Hilton",
      "created_at": "2025-04-19T13:20:44.335Z",
      "updated_at": "2025-04-19T13:20:44.335Z",
      "cooked": "<p>I have found how to insert a footnote into a text, but can someone help me with the code needed to set footnotes with the number on the left margin and a hanging indent.</p>\n<p>I insert footnotes like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">[500 g], [Polish _kielbasa_ sausage#footnote[There are many types of _kielbasa_ sausage…], cut into 2 cm chunks],\n</code></pre>\n<p>which, on rendering looks like this:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/a/a15e7342383eb9470fef8cb1fc50e8a4f061388e.png\" data-download-href=\"https://forum.typst.app/uploads/default/a15e7342383eb9470fef8cb1fc50e8a4f061388e\" title=\"SCR-20250419-mqrt\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/a/a15e7342383eb9470fef8cb1fc50e8a4f061388e_2_689x42.png\" alt=\"SCR-20250419-mqrt\" data-base62-sha1=\"n1xelB4l5vykso01j9a41CJ0jca\" width=\"689\" height=\"42\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/a/a15e7342383eb9470fef8cb1fc50e8a4f061388e_2_689x42.png, https://forum.typst.app/uploads/default/optimized/2X/a/a15e7342383eb9470fef8cb1fc50e8a4f061388e_2_1033x63.png 1.5x, https://forum.typst.app/uploads/default/original/2X/a/a15e7342383eb9470fef8cb1fc50e8a4f061388e.png 2x\" data-dominant-color=\"F0F0F0\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">SCR-20250419-mqrt</span><span class=\"informations\">1268×78 31 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>When what I’d really like is (though retaining the superscripted number would be OK):</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/2/2be0b687af034ed252ae6f45487f9f82e4997188.png\" data-download-href=\"https://forum.typst.app/uploads/default/2be0b687af034ed252ae6f45487f9f82e4997188\" title=\"SCR-20250419-mrws\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/2/2be0b687af034ed252ae6f45487f9f82e4997188_2_690x41.png\" alt=\"SCR-20250419-mrws\" data-base62-sha1=\"6g9Yy9RnCv5hcir153uubv5xMrm\" width=\"690\" height=\"41\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/2/2be0b687af034ed252ae6f45487f9f82e4997188_2_690x41.png, https://forum.typst.app/uploads/default/optimized/2X/2/2be0b687af034ed252ae6f45487f9f82e4997188_2_1035x61.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/2/2be0b687af034ed252ae6f45487f9f82e4997188_2_1380x82.png 2x\" data-dominant-color=\"E1E1E1\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">SCR-20250419-mrws</span><span class=\"informations\">1400×84 70.2 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>How do I achieve this, please?</p>",
      "raw": "I have found how to insert a footnote into a text, but can someone help me with the code needed to set footnotes with the number on the left margin and a hanging indent.\n\nI insert footnotes like this:\n\n```typ\n[500 g], [Polish _kielbasa_ sausage#footnote[There are many types of _kielbasa_ sausage…], cut into 2 cm chunks],\n```\n\nwhich, on rendering looks like this:\n\n![SCR-20250419-mqrt|689x42](upload://n1xelB4l5vykso01j9a41CJ0jca.png)\n\nWhen what I'd really like is (though retaining the superscripted number would be OK):\n\n![SCR-20250419-mrws|690x41](upload://6g9Yy9RnCv5hcir153uubv5xMrm.png)\n\nHow do I achieve this, please?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 98.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 1276
    },
    {
      "id": 11329,
      "post_number": 2,
      "username": "aarnent",
      "name": "",
      "created_at": "2025-04-19T13:49:15.198Z",
      "updated_at": "2025-04-19T13:49:15.198Z",
      "cooked": "<p>I’m actually a bit surprised typst doesn’t offer this functionality directly. I think the best way to do what you are trying to achieve is to convert the footnote entry into a numbered list:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#show footnote.entry: it =&gt; {\n  let loc = it.note.location()\n  let val = counter(footnote).at(loc).first()\n  enum(\n    numbering: \"1\",\n    body-indent: 1em,\n    enum.item(val)[#it.note.body]\n  )\n}\n</code></pre>\n<p>The downside is that it’s affected by show/set rules on <code>enum</code></p>",
      "raw": "I'm actually a bit surprised typst doesn't offer this functionality directly. I think the best way to do what you are trying to achieve is to convert the footnote entry into a numbered list:\n```typst\n#show footnote.entry: it => {\n  let loc = it.note.location()\n  let val = counter(footnote).at(loc).first()\n  enum(\n    numbering: \"1\",\n    body-indent: 1em,\n    enum.item(val)[#it.note.body]\n  )\n}\n```\n\nThe downside is that it's affected by show/set rules on `enum`",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 8.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 501
    },
    {
      "id": 11331,
      "post_number": 3,
      "username": "Mark_Hilton",
      "name": "Mark Hilton",
      "created_at": "2025-04-19T14:01:17.775Z",
      "updated_at": "2025-04-19T14:01:17.775Z",
      "cooked": "<p>Thanks a lot. That solves it for this text, which is non-academic; but I think I understand the problem with show/set rules on enum for future texts. I’ll wait to see if anyone else comes up with a solution that doesn’t involve enum; if I hear no more I’ll mark that as the solution.</p>\n<p><img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji only-emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"><br>\nMark</p>",
      "raw": "Thanks a lot. That solves it for this text, which is non-academic; but I think I understand the problem with show/set rules on enum for future texts. I'll wait to see if anyone else comes up with a solution that doesn't involve enum; if I hear no more I'll mark that as the solution.\n\n:slight_smile: \n Mark",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 8.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 1276
    },
    {
      "id": 11340,
      "post_number": 4,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2025-04-19T15:11:27.040Z",
      "updated_at": "2025-04-19T15:11:27.040Z",
      "cooked": "<p>There are several options to do something like that: You can use a grid as in</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show footnote.entry: it =&gt; {\n  let nums = counter(footnote).at(it.note.location())\n  let number = numbering(it.note.numbering, ..nums)\n  let link = link.with(it.note.location())\n  grid(columns: (auto, 1fr), gap: 1em, link(number), it.note.body)\n}\n</code></pre>\n<p>or measure the width of the number and use it as the hanging ident (which is how it’s done for headings and outline entries)</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show footnote.entry: it =&gt; context {\n  let gap = 1em\n  let nums = counter(footnote).at(it.note.location())\n  let number = numbering(it.note.numbering, ..nums)\n  let width = measure(number).width + gap\n  let link = link.with(it.note.location())\n  par(hanging-indent: width, link(number) + h(gap) + it.note.body)\n}\n</code></pre>\n<p>Depending on how you want it to look when there are multiple footnotes with different number widths, you can also use a grid with a fixed size for the first column, so that the footnotes are aligned with each other.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show footnote.entry: it =&gt; {\n  let gap = 1em\n  let nums = counter(footnote).at(it.note.location())\n  let number = numbering(it.note.numbering, ..nums)\n  let link = link.with(it.note.location())\n  grid(columns: (2em, 1fr), link(number), it.note.body)\n}\n</code></pre>\n<p>Note that due to <a href=\"https://github.com/typst/typst/issues/2430\" rel=\"noopener nofollow ugc\">an issue</a>, links to footnotes currently (as of v0.13.1) don’t work properly when using a show rule on <code>footnote.entry</code>.</p>",
      "raw": "There are several options to do something like that: You can use a grid as in\n```typ\n#show footnote.entry: it => {\n  let nums = counter(footnote).at(it.note.location())\n  let number = numbering(it.note.numbering, ..nums)\n  let link = link.with(it.note.location())\n  grid(columns: (auto, 1fr), gap: 1em, link(number), it.note.body)\n}\n```\nor measure the width of the number and use it as the hanging ident (which is how it's done for headings and outline entries)\n```typ\n#show footnote.entry: it => context {\n  let gap = 1em\n  let nums = counter(footnote).at(it.note.location())\n  let number = numbering(it.note.numbering, ..nums)\n  let width = measure(number).width + gap\n  let link = link.with(it.note.location())\n  par(hanging-indent: width, link(number) + h(gap) + it.note.body)\n}\n```\nDepending on how you want it to look when there are multiple footnotes with different number widths, you can also use a grid with a fixed size for the first column, so that the footnotes are aligned with each other.\n```typ\n#show footnote.entry: it => {\n  let gap = 1em\n  let nums = counter(footnote).at(it.note.location())\n  let number = numbering(it.note.numbering, ..nums)\n  let link = link.with(it.note.location())\n  grid(columns: (2em, 1fr), link(number), it.note.body)\n}\n```\nNote that due to [an issue](https://github.com/typst/typst/issues/2430), links to footnotes currently (as of v0.13.1) don't work properly when using a show rule on `footnote.entry`.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 17,
      "score": 38.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 11343,
      "post_number": 5,
      "username": "Mark_Hilton",
      "name": "Mark Hilton",
      "created_at": "2025-04-19T16:17:03.566Z",
      "updated_at": "2025-04-19T16:17:03.566Z",
      "cooked": "<p>In spite of the issue you mention, the third of your suggested solutions will suit me fine for the foreseeable future, so thank you very much. I will mark my question as solved by you.</p>\n<p><img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji only-emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"><br>\nMark</p>",
      "raw": "In spite of the issue you mention, the third of your suggested solutions will suit me fine for the foreseeable future, so thank you very much. I will mark my question as solved by you.\n\n:slight_smile: \n Mark",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 3.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 1276
    }
  ],
  "scraped_at": "2025-06-10T09:48:59.199088"
}
{
  "topic_metadata": {
    "id": 3728,
    "title": "How to Automate Typesetting of Matrices within Function?",
    "slug": "how-to-automate-typesetting-of-matrices-within-function",
    "posts_count": 9,
    "created_at": "2025-04-19T13:37:21.905Z",
    "last_posted_at": "2025-04-20T17:56:00.595Z",
    "views": 80,
    "like_count": 5,
    "reply_count": 6,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "janekfleper",
    "tags": [
      "scripting",
      "math"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 6146
  },
  "posts": [
    {
      "id": 11328,
      "post_number": 1,
      "username": "Paul744",
      "name": "Paul",
      "created_at": "2025-04-19T13:37:22.068Z",
      "updated_at": "2025-04-19T17:11:33.779Z",
      "cooked": "<p>I am toying around with Typst’s scripting functionality, and I was trying to see if it was robust enough to automate the calculation of structure constants for SU(3) in its 3-dimensional representation. However, I am facing a couple issues with rendering and with algebraic numbers. The code I currently have is below.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let Tr = math.upright(\"Tr\")\n#let complex(a, b) = (a, b)\n#let complex-add(z1, z2) = (z1.at(0) + z2.at(0), z1.at(1) + z2.at(1))\n#let complex-sub(z1, z2) = (z1.at(0) - z2.at(0), z1.at(1) - z2.at(1))\n#let complex-mul(z1, z2) = (\n  z1.at(0) * z2.at(0) - z1.at(1) * z2.at(1),\n  z1.at(0) * z2.at(1) + z1.at(1) * z2.at(0)\n)\n#let complex-neg(z) = (-z.at(0), -z.at(1))\n#let complex-scale(z, s) = (z.at(0) * s, z.at(1) * s)\n\n#let format-complex(z) = {\n  let real = z.at(0)\n  let imag = z.at(1)\n  \n  if imag == 0 {\n    return str(real)\n  } else if real == 0 {\n    if imag == 1 { return \"i\" }\n    else if imag == -1 { return \"-i\" }\n    else { return str(imag) + \"i\" }\n  } else {\n    let sign = if imag &gt; 0 { \"+\" } else { \"-\" }\n    let abs-imag = calc.abs(imag)\n    if abs-imag == 1 {\n      return str(real) + sign + \"i\"\n    } else {\n      return str(real) + sign + str(abs-imag) + \"i\"\n    }\n  }\n}\n\n#let mat-add(A, B) = {\n  let rows = A.len()\n  let cols = A.at(0).len()\n  \n  let result = ()\n  for i in range(rows) {\n    let row = ()\n    for j in range(cols) {\n      row.push(complex-add(A.at(i).at(j), B.at(i).at(j)))\n    }\n    result.push(row)\n  }\n  \n  return result\n}\n\n#let mat-sub(A, B) = {\n  let rows = A.len()\n  let cols = A.at(0).len()\n  \n  let result = ()\n  for i in range(rows) {\n    let row = ()\n    for j in range(cols) {\n      row.push(complex-sub(A.at(i).at(j), B.at(i).at(j)))\n    }\n    result.push(row)\n  }\n  \n  return result\n}\n\n#let mat-mul(A, B) = {\n  let rows_A = A.len()\n  let cols_A = A.at(0).len()\n  let cols_B = B.at(0).len()\n  \n  let result = ()\n  for i in range(rows_A) {\n    let row = ()\n    for j in range(cols_B) {\n      let sum = complex(0, 0)\n      for k in range(cols_A) {\n        sum = complex-add(sum, complex-mul(A.at(i).at(k), B.at(k).at(j)))\n      }\n      row.push(sum)\n    }\n    result.push(row)\n  }\n  \n  return result\n}\n\n#let mat-commutator(A, B) = {\n  let AB = mat-mul(A, B)\n  let BA = mat-mul(B, A)\n  return mat-sub(AB, BA)\n}\n\n#let mat-trace(A) = {\n  let sum = complex(0, 0)\n  let n = A.len()\n  \n  for i in range(n) {\n    sum = complex-add(sum, A.at(i).at(i))\n  }\n  \n  return sum\n}\n\n// Define Gell-Mann matrices\n#let t1 = (\n  (complex(0, 0), complex(0.5, 0), complex(0, 0)),\n  (complex(0.5, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t2 = (\n  (complex(0, 0), complex(0, -0.5), complex(0, 0)),\n  (complex(0, 0.5), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t3 = (\n  (complex(0.5, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(-0.5, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t4 = (\n  (complex(0, 0), complex(0, 0), complex(0.5, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0.5, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t5 = (\n  (complex(0, 0), complex(0, 0), complex(0, -0.5)),\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0.5), complex(0, 0), complex(0, 0))\n)\n\n#let t6 = (\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0.5, 0)),\n  (complex(0, 0), complex(0.5, 0), complex(0, 0))\n)\n\n#let t7 = (\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, -0.5)),\n  (complex(0, 0), complex(0, 0.5), complex(0, 0))\n)\n\n#let factor = 1/(2*calc.sqrt(3))\n#let t8 = (\n  (complex(factor, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(factor, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(-2*factor, 0))\n)\n\n#let t = (t1, t2, t3, t4, t5, t6, t7, t8)\n\n#let calculate-f(a, b, c, Cr) = {\n  let a_idx = a - 1\n  let b_idx = b - 1\n  let c_idx = c - 1\n  \n  let comm = mat-commutator(t.at(a_idx), t.at(b_idx))\n  let prod = mat-mul(comm, t.at(c_idx))\n  let tr = mat-trace(prod)\n  \n  // f^(abc) = -i/Cr * Tr([t_a, t_b] t_c)\n  let result = complex-mul(complex(0, -1/Cr), tr)\n  \n  return (\n    commutator: comm,\n    product: prod,\n    trace: tr,\n    result: result\n  )\n}\n\n#let Cr = 1 // Normalization constant\n\n#let display-calculation(a, b, c) = {\n  let res = calculate-f(a, b, c, Cr)\n  \n  [\n    == Structure Constant $f^(#a #b #c)$\n    \n    *Step 1:* Calculate the commutator $[t_(#a), t_(#b)]$\n    \n    $ [t_(#a), t_(#b)] = t_(#a) t_(#b) - t_(#b) t_(#a) = mat(\n        #format-complex(res.commutator.at(0).at(0)), #format-complex(res.commutator.at(0).at(1)), #format-complex(res.commutator.at(0).at(2));\n        #format-complex(res.commutator.at(1).at(0)), #format-complex(res.commutator.at(1).at(1)), #format-complex(res.commutator.at(1).at(2));\n        #format-complex(res.commutator.at(2).at(0)), #format-complex(res.commutator.at(2).at(1)), #format-complex(res.commutator.at(2).at(2))\n      ) $\n    \n    *Step 2:* Multiply by $t_(#c)$ to get $[t_(#a), t_(#b)]t_(#c)$\n    \n    $ [t_(#a), t_(#b)]t_(#c) = mat(\n        #format-complex(res.product.at(0).at(0)), #format-complex(res.product.at(0).at(1)), #format-complex(res.product.at(0).at(2));\n        #format-complex(res.product.at(1).at(0)), #format-complex(res.product.at(1).at(1)), #format-complex(res.product.at(1).at(2));\n        #format-complex(res.product.at(2).at(0)), #format-complex(res.product.at(2).at(1)), #format-complex(res.product.at(2).at(2))\n      ) $\n    \n    *Step 3:* Calculate the trace\n    \n    $ Tr([t_(#a), t_(#b)]t_(#c)) = #format-complex(res.trace) $\n    \n    *Step 4:* Multiply by $-i/C_r$ to get the structure constant\n    \n    $ f^(#a #b #c) = frac(-i, C_r) Tr([t_(#a), t_(#b)]t_(#c)) = #format-complex(res.result) $\n  ]\n}\n\n// Sample calculations for a few structure constants\n#display-calculation(1, 2, 3)\n</code></pre>\n<p>The two primary issues I am having is that, when trying to render:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">mat(\n        #format-complex(res.product.at(0).at(0)), #format-complex(res.product.at(0).at(1)), #format-complex(res.product.at(0).at(2));\n        #format-complex(res.product.at(1).at(0)), #format-complex(res.product.at(1).at(1)), #format-complex(res.product.at(1).at(2));\n        #format-complex(res.product.at(2).at(0)), #format-complex(res.product.at(2).at(1)), #format-complex(res.product.at(2).at(2))\n      ) \n</code></pre>\n<p>and similarly for the other matrix, it refuses to render as a matrix. What I get is, e.g. <code>(0.5i 0 00 −0.5i 00 0 0)</code>, rather than the block form it should have. I cannot figure out what’s going on. I assume the input matrix elements are somehow messing with the rendering.</p>\n<p>The second issue I am facing is that I need to use <code>1/(2*calc.sqrt(3))</code> for one of the Gell-Mann matrices, but that converts it to a float, making it impossible to render it as <code>1/sqrt(3)</code> if the output still has the <code>sqrt(3)</code>.</p>\n<p>Does anyone understand why the matrices aren’t rendering, and if there’s a way to get the <code>sqrt()</code> to still render, even if actual automated calculations require <code>calc.sqrt(3)</code>?</p>",
      "raw": "I am toying around with Typst's scripting functionality, and I was trying to see if it was robust enough to automate the calculation of structure constants for SU(3) in its 3-dimensional representation. However, I am facing a couple issues with rendering and with algebraic numbers. The code I currently have is below.\n\n```typ\n#let Tr = math.upright(\"Tr\")\n#let complex(a, b) = (a, b)\n#let complex-add(z1, z2) = (z1.at(0) + z2.at(0), z1.at(1) + z2.at(1))\n#let complex-sub(z1, z2) = (z1.at(0) - z2.at(0), z1.at(1) - z2.at(1))\n#let complex-mul(z1, z2) = (\n  z1.at(0) * z2.at(0) - z1.at(1) * z2.at(1),\n  z1.at(0) * z2.at(1) + z1.at(1) * z2.at(0)\n)\n#let complex-neg(z) = (-z.at(0), -z.at(1))\n#let complex-scale(z, s) = (z.at(0) * s, z.at(1) * s)\n\n#let format-complex(z) = {\n  let real = z.at(0)\n  let imag = z.at(1)\n  \n  if imag == 0 {\n    return str(real)\n  } else if real == 0 {\n    if imag == 1 { return \"i\" }\n    else if imag == -1 { return \"-i\" }\n    else { return str(imag) + \"i\" }\n  } else {\n    let sign = if imag > 0 { \"+\" } else { \"-\" }\n    let abs-imag = calc.abs(imag)\n    if abs-imag == 1 {\n      return str(real) + sign + \"i\"\n    } else {\n      return str(real) + sign + str(abs-imag) + \"i\"\n    }\n  }\n}\n\n#let mat-add(A, B) = {\n  let rows = A.len()\n  let cols = A.at(0).len()\n  \n  let result = ()\n  for i in range(rows) {\n    let row = ()\n    for j in range(cols) {\n      row.push(complex-add(A.at(i).at(j), B.at(i).at(j)))\n    }\n    result.push(row)\n  }\n  \n  return result\n}\n\n#let mat-sub(A, B) = {\n  let rows = A.len()\n  let cols = A.at(0).len()\n  \n  let result = ()\n  for i in range(rows) {\n    let row = ()\n    for j in range(cols) {\n      row.push(complex-sub(A.at(i).at(j), B.at(i).at(j)))\n    }\n    result.push(row)\n  }\n  \n  return result\n}\n\n#let mat-mul(A, B) = {\n  let rows_A = A.len()\n  let cols_A = A.at(0).len()\n  let cols_B = B.at(0).len()\n  \n  let result = ()\n  for i in range(rows_A) {\n    let row = ()\n    for j in range(cols_B) {\n      let sum = complex(0, 0)\n      for k in range(cols_A) {\n        sum = complex-add(sum, complex-mul(A.at(i).at(k), B.at(k).at(j)))\n      }\n      row.push(sum)\n    }\n    result.push(row)\n  }\n  \n  return result\n}\n\n#let mat-commutator(A, B) = {\n  let AB = mat-mul(A, B)\n  let BA = mat-mul(B, A)\n  return mat-sub(AB, BA)\n}\n\n#let mat-trace(A) = {\n  let sum = complex(0, 0)\n  let n = A.len()\n  \n  for i in range(n) {\n    sum = complex-add(sum, A.at(i).at(i))\n  }\n  \n  return sum\n}\n\n// Define Gell-Mann matrices\n#let t1 = (\n  (complex(0, 0), complex(0.5, 0), complex(0, 0)),\n  (complex(0.5, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t2 = (\n  (complex(0, 0), complex(0, -0.5), complex(0, 0)),\n  (complex(0, 0.5), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t3 = (\n  (complex(0.5, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(-0.5, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t4 = (\n  (complex(0, 0), complex(0, 0), complex(0.5, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0.5, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t5 = (\n  (complex(0, 0), complex(0, 0), complex(0, -0.5)),\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0.5), complex(0, 0), complex(0, 0))\n)\n\n#let t6 = (\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0.5, 0)),\n  (complex(0, 0), complex(0.5, 0), complex(0, 0))\n)\n\n#let t7 = (\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, -0.5)),\n  (complex(0, 0), complex(0, 0.5), complex(0, 0))\n)\n\n#let factor = 1/(2*calc.sqrt(3))\n#let t8 = (\n  (complex(factor, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(factor, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(-2*factor, 0))\n)\n\n#let t = (t1, t2, t3, t4, t5, t6, t7, t8)\n\n#let calculate-f(a, b, c, Cr) = {\n  let a_idx = a - 1\n  let b_idx = b - 1\n  let c_idx = c - 1\n  \n  let comm = mat-commutator(t.at(a_idx), t.at(b_idx))\n  let prod = mat-mul(comm, t.at(c_idx))\n  let tr = mat-trace(prod)\n  \n  // f^(abc) = -i/Cr * Tr([t_a, t_b] t_c)\n  let result = complex-mul(complex(0, -1/Cr), tr)\n  \n  return (\n    commutator: comm,\n    product: prod,\n    trace: tr,\n    result: result\n  )\n}\n\n#let Cr = 1 // Normalization constant\n\n#let display-calculation(a, b, c) = {\n  let res = calculate-f(a, b, c, Cr)\n  \n  [\n    == Structure Constant $f^(#a #b #c)$\n    \n    *Step 1:* Calculate the commutator $[t_(#a), t_(#b)]$\n    \n    $ [t_(#a), t_(#b)] = t_(#a) t_(#b) - t_(#b) t_(#a) = mat(\n        #format-complex(res.commutator.at(0).at(0)), #format-complex(res.commutator.at(0).at(1)), #format-complex(res.commutator.at(0).at(2));\n        #format-complex(res.commutator.at(1).at(0)), #format-complex(res.commutator.at(1).at(1)), #format-complex(res.commutator.at(1).at(2));\n        #format-complex(res.commutator.at(2).at(0)), #format-complex(res.commutator.at(2).at(1)), #format-complex(res.commutator.at(2).at(2))\n      ) $\n    \n    *Step 2:* Multiply by $t_(#c)$ to get $[t_(#a), t_(#b)]t_(#c)$\n    \n    $ [t_(#a), t_(#b)]t_(#c) = mat(\n        #format-complex(res.product.at(0).at(0)), #format-complex(res.product.at(0).at(1)), #format-complex(res.product.at(0).at(2));\n        #format-complex(res.product.at(1).at(0)), #format-complex(res.product.at(1).at(1)), #format-complex(res.product.at(1).at(2));\n        #format-complex(res.product.at(2).at(0)), #format-complex(res.product.at(2).at(1)), #format-complex(res.product.at(2).at(2))\n      ) $\n    \n    *Step 3:* Calculate the trace\n    \n    $ Tr([t_(#a), t_(#b)]t_(#c)) = #format-complex(res.trace) $\n    \n    *Step 4:* Multiply by $-i/C_r$ to get the structure constant\n    \n    $ f^(#a #b #c) = frac(-i, C_r) Tr([t_(#a), t_(#b)]t_(#c)) = #format-complex(res.result) $\n  ]\n}\n\n// Sample calculations for a few structure constants\n#display-calculation(1, 2, 3)\n```\n\nThe two primary issues I am having is that, when trying to render:\n\n```typc\nmat(\n        #format-complex(res.product.at(0).at(0)), #format-complex(res.product.at(0).at(1)), #format-complex(res.product.at(0).at(2));\n        #format-complex(res.product.at(1).at(0)), #format-complex(res.product.at(1).at(1)), #format-complex(res.product.at(1).at(2));\n        #format-complex(res.product.at(2).at(0)), #format-complex(res.product.at(2).at(1)), #format-complex(res.product.at(2).at(2))\n      ) \n```\n\nand similarly for the other matrix, it refuses to render as a matrix. What I get is, e.g. `(0.5i 0 00 −0.5i 00 0 0)`, rather than the block form it should have. I cannot figure out what's going on. I assume the input matrix elements are somehow messing with the rendering.\n\nThe second issue I am facing is that I need to use `1/(2*calc.sqrt(3))` for one of the Gell-Mann matrices, but that converts it to a float, making it impossible to render it as `1/sqrt(3)` if the output still has the `sqrt(3)`.\n\nDoes anyone understand why the matrices aren't rendering, and if there's a way to get the `sqrt()` to still render, even if actual automated calculations require `calc.sqrt(3)`?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 61.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 788
    },
    {
      "id": 11335,
      "post_number": 2,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-04-19T14:14:59.934Z",
      "updated_at": "2025-04-19T14:17:06.890Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Paul744\" data-post=\"1\" data-topic=\"3728\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/p/5D25C6/48.png\" class=\"avatar\"> Paul744:</div>\n<blockquote>\n<pre data-code-wrap=\"typm\"><code class=\"lang-typm\">mat(\n  #format-complex(res.product.at(0).at(0)), #format-complex(res.product.at(0).at(1)), #format-complex(res.product.at(0).at(2));\n  #format-complex(res.product.at(1).at(0)), #format-complex(res.product.at(1).at(1)), #format-complex(res.product.at(1).at(2));\n  #format-complex(res.product.at(2).at(0)), #format-complex(res.product.at(2).at(1)), #format-complex(res.product.at(2).at(2))\n) \n</code></pre>\n</blockquote>\n</aside>\n<p>Inserting a space before the semicolon fixes the rendering of the matrix, although I am not sure why the matrix function is behaving like that in the first place. You do not need the space when you create a matrix with (string) elements manually.</p>\n<p>Note that the code you shared did not compile because the function <code>Tr()</code> was not defined. For future questions please only share as much code as necessary to reproduce your issue. In this case the function <code>format-complex()</code> and the matrix would have been sufficient.</p>\n<p>I don’t really understand your second issue with <code>calc.sqrt(3)</code> and <code>1/sqrt(3)</code>. Could you please create a small (code) example to show what you are trying to achieve?</p>",
      "raw": "[quote=\"Paul744, post:1, topic:3728\"]\n```typm\nmat(\n  #format-complex(res.product.at(0).at(0)), #format-complex(res.product.at(0).at(1)), #format-complex(res.product.at(0).at(2));\n  #format-complex(res.product.at(1).at(0)), #format-complex(res.product.at(1).at(1)), #format-complex(res.product.at(1).at(2));\n  #format-complex(res.product.at(2).at(0)), #format-complex(res.product.at(2).at(1)), #format-complex(res.product.at(2).at(2))\n) \n```\n[/quote]\n\nInserting a space before the semicolon fixes the rendering of the matrix, although I am not sure why the matrix function is behaving like that in the first place. You do not need the space when you create a matrix with (string) elements manually.\n\nNote that the code you shared did not compile because the function `Tr()` was not defined. For future questions please only share as much code as necessary to reproduce your issue. In this case the function `format-complex()` and the matrix would have been sufficient.\n\nI don't really understand your second issue with `calc.sqrt(3)` and `1/sqrt(3)`. Could you please create a small (code) example to show what you are trying to achieve?",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 1,
      "like_count": 1,
      "reads": 28,
      "score": 30.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 11336,
      "post_number": 3,
      "username": "Paul744",
      "name": "Paul",
      "created_at": "2025-04-19T14:33:42.777Z",
      "updated_at": "2025-04-19T17:12:05.121Z",
      "cooked": "<p>Thanks for pointing out the spacing. Yeah, that is exceptionally odd, but if it works, it works.</p>\n<p>And thanks for pointing out the Tr() function issue. I defined that manually via:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let Tr = math.upright(\"Tr\")\n</code></pre>\n<p>I’ll add that to the original post.</p>\n<p>As for what I am trying to get out from the sqrt(3) situation, as an example, if one tries to evaluate:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#display-calculation(1, 2, 8)\n</code></pre>\n<p>one will get on step 2, a diagonal matrix with 0.14433756729740646i as the diagonal element, rather than something like i/(4 sqrt(3)). In short, I am trying to keep the actual sqrt() symbols around, but I don’t know if there’s a way to do that when the actual calculations have to be done with floats. Technically, I would like to get this working with stuff like 0.5 as well, but the sqrt(3) is the really egregious issue.</p>",
      "raw": "Thanks for pointing out the spacing. Yeah, that is exceptionally odd, but if it works, it works.\n\nAnd thanks for pointing out the Tr() function issue. I defined that manually via:\n```typ\n#let Tr = math.upright(\"Tr\")\n```\nI'll add that to the original post.\n\nAs for what I am trying to get out from the sqrt(3) situation, as an example, if one tries to evaluate:\n```typ\n#display-calculation(1, 2, 8)\n```\none will get on step 2, a diagonal matrix with 0.14433756729740646i as the diagonal element, rather than something like i/(4 sqrt(3)). In short, I am trying to keep the actual sqrt() symbols around, but I don't know if there's a way to do that when the actual calculations have to be done with floats. Technically, I would like to get this working with stuff like 0.5 as well, but the sqrt(3) is the really egregious issue.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 10.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 788
    },
    {
      "id": 11337,
      "post_number": 4,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-04-19T14:42:29.992Z",
      "updated_at": "2025-04-19T14:43:04.868Z",
      "cooked": "<p>If you don’t actually need the prefactor <code>1/sqrt(3)</code> for the computation, could you not just store this separately from the matrix? You would then have an array <code>f</code> that holds the prefactors of the matrices <code>t1</code> to <code>t8</code>. The matrix computations would then just need integer math and you would include the prefactor(s) again after the computations.</p>",
      "raw": "If you don't actually need the prefactor `1/sqrt(3)` for the computation, could you not just store this separately from the matrix? You would then have an array `f` that holds the prefactors of the matrices `t1` to `t8`. The matrix computations would then just need integer math and you would include the prefactor(s) again after the computations.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 26,
      "score": 40.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 11338,
      "post_number": 5,
      "username": "Paul744",
      "name": "Paul",
      "created_at": "2025-04-19T14:53:26.105Z",
      "updated_at": "2025-04-19T14:53:26.105Z",
      "cooked": "<p>That’s actually a good point. This wouldn’t work for a more general calculation if I needed to be able to square sqrt(3) (assuming the calculation kept the problematic overflow like 3.0000000001), but since f^(a b c) is antisymmetric, that isn’t an issue. I’ll make use of that. Thanks.</p>",
      "raw": "That's actually a good point. This wouldn't work for a more general calculation if I needed to be able to square sqrt(3) (assuming the calculation kept the problematic overflow like 3.0000000001), but since f^(a b c) is antisymmetric, that isn't an issue. I'll make use of that. Thanks.",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 9.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 788
    },
    {
      "id": 11339,
      "post_number": 6,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-04-19T15:04:32.196Z",
      "updated_at": "2025-04-19T15:04:32.196Z",
      "cooked": "<p>You could generalize this further by storing the prefactor in a dictionary where the “value” and the “exponent” are kept separately, e.g.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let f8 = (value: 3, exponent: decimal(\"0.5\"))\n</code></pre>\n<p>If you need to square this, you would then add the exponents to get <code>decimal(\"1.0\")</code> in which case you would just omit the square root. I know that this is not the most convenient thing to work with, but you can get vary far with integer + decimal math. Even multiplying and reducing fractions is possible without ever touching floating point math.</p>",
      "raw": "You could generalize this further by storing the prefactor in a dictionary where the \"value\" and the \"exponent\" are kept separately, e.g.\n\n```typ\n#let f8 = (value: 3, exponent: decimal(\"0.5\"))\n```\nIf you need to square this, you would then add the exponents to get `decimal(\"1.0\")` in which case you would just omit the square root. I know that this is not the most convenient thing to work with, but you can get vary far with integer + decimal math. Even multiplying and reducing fractions is possible without ever touching floating point math.",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 22,
      "score": 24.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 11341,
      "post_number": 7,
      "username": "Paul744",
      "name": "Paul",
      "created_at": "2025-04-19T15:27:05.134Z",
      "updated_at": "2025-04-19T15:27:05.134Z",
      "cooked": "<p>I really like that dictionary idea, and I might have to play around to see if I can get that to work. And while I can see how one might do multiplication of fractions, it’s less obvious how one would do reduction, unless the idea is to do 0 actual multiplication when combining fractions, keeping all the factors separated, and then trying to track down terms with the same base.</p>",
      "raw": "I really like that dictionary idea, and I might have to play around to see if I can get that to work. And while I can see how one might do multiplication of fractions, it's less obvious how one would do reduction, unless the idea is to do 0 actual multiplication when combining fractions, keeping all the factors separated, and then trying to track down terms with the same base.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 9.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 788
    },
    {
      "id": 11344,
      "post_number": 8,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-04-19T17:13:49.830Z",
      "updated_at": "2025-04-19T17:13:49.830Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"janekfleper\" data-post=\"2\" data-topic=\"3728\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/j/8F38B1/48.png\" class=\"avatar\"> janekfleper:</div>\n<blockquote>\n<p>Inserting a space before the semicolon fixes the rendering of the matrix, although I am not sure why the matrix function is behaving like that in the first place.</p>\n</blockquote>\n</aside>\n<p>The reason is that <code>;</code> ends a code block, and the function call is done with one (<code>#</code> starts it): <code>#format-complex(...);</code></p>\n<p>with the space, the code block already ends at <code>)</code> and thus the <code>;</code> is part of the matrix syntax</p>",
      "raw": "[quote=\"janekfleper, post:2, topic:3728\"]\nInserting a space before the semicolon fixes the rendering of the matrix, although I am not sure why the matrix function is behaving like that in the first place.\n[/quote]\n\nThe reason is that `;` ends a code block, and the function call is done with one (`#` starts it): `#format-complex(...);`\n\nwith the space, the code block already ends at `)` and thus the `;` is part of the matrix syntax",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 23,
      "score": 24.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 11366,
      "post_number": 9,
      "username": "Paul744",
      "name": "Paul",
      "created_at": "2025-04-20T17:56:00.595Z",
      "updated_at": "2025-04-20T21:44:13.281Z",
      "cooked": "<p>In case anyone is curious, this is what I eventually got working:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let Tr = math.upright(\"Tr\")\n\n// ============ SYMBOLIC FRACTION IMPLEMENTATION ============\n\n// Basic symbolic fraction representation\n#let sym-frac(num, denom) = {\n  // Ensure we always have integer representations\n  if type(num) != int { num = calc.round(num) }\n  if type(denom) != int { denom = calc.round(denom) }\n  \n  // Handle special cases\n  if denom == 0 { panic(\"Division by zero\") }\n  if num == 0 { return (type: \"sym-frac\", num: 0, denom: 1, sign: 1) }\n  \n  // Normalize negative signs - always store them separately\n  let sign = 1\n  if (num &lt; 0 and denom &gt; 0) or (num &gt; 0 and denom &lt; 0) {\n    sign = -1 // Negative fraction\n  }\n  num = calc.abs(num)\n  denom = calc.abs(denom)\n  \n  // Create fraction with normalized sign\n  return (\n    type: \"sym-frac\",\n    num: num,     // Always positive\n    denom: denom, // Always positive\n    sign: sign    // -1 if fraction is negative, 1 if positive\n  )\n}\n\n// Fraction arithmetic operations\n#let frac-add(f1, f2) = {\n  if f1.type != \"sym-frac\" or f2.type != \"sym-frac\" {\n    panic(\"Expected symbolic fractions\")\n  }\n  \n  // a/b + c/d = (ad + bc)/bd\n  // With signs: (sign_a * a)/b + (sign_c * c)/d\n  let sign_a_val = if f1.sign &lt; 0 { -f1.num } else { f1.num }\n  let sign_c_val = if f2.sign &lt; 0 { -f2.num } else { f2.num }\n  \n  let num = sign_a_val * f2.denom + sign_c_val * f1.denom\n  let denom = f1.denom * f2.denom\n  \n  return sym-frac(num, denom)\n}\n\n#let frac-sub(f1, f2) = {\n  if f1.type != \"sym-frac\" or f2.type != \"sym-frac\" {\n    panic(\"Expected symbolic fractions\")\n  }\n  \n  // a/b - c/d = (ad - bc)/bd\n  // With signs: (sign_a * a)/b - (sign_c * c)/d\n  let sign_a_val = if f1.sign &lt; 0 { -f1.num } else { f1.num }\n  let sign_c_val = if f2.sign &lt; 0 { -f2.num } else { f2.num }\n  \n  let num = sign_a_val * f2.denom - sign_c_val * f1.denom\n  let denom = f1.denom * f2.denom\n  \n  return sym-frac(num, denom)\n}\n\n#let frac-mul(f1, f2) = {\n  if f1.type != \"sym-frac\" or f2.type != \"sym-frac\" {\n    panic(\"Expected symbolic fractions\")\n  }\n  \n  // (a/b) * (c/d) = (ac)/(bd)\n  // Sign: sign_a * sign_c\n  let num = f1.num * f2.num\n  let denom = f1.denom * f2.denom\n  let sign = f1.sign * f2.sign\n  \n  return (\n    type: \"sym-frac\",\n    num: num,\n    denom: denom,\n    sign: sign\n  )\n}\n\n#let frac-div(f1, f2) = {\n  if f1.type != \"sym-frac\" or f2.type != \"sym-frac\" {\n    panic(\"Expected symbolic fractions\")\n  }\n  \n  // (a/b) / (c/d) = (ad)/(bc)\n  // Sign: sign_a * sign_c\n  let num = f1.num * f2.denom\n  let denom = f1.denom * f2.num\n  let sign = f1.sign * f2.sign\n  \n  return (\n    type: \"sym-frac\",\n    num: num,\n    denom: denom,\n    sign: sign\n  )\n}\n\n#let frac-neg(f) = {\n  if f.type != \"sym-frac\" {\n    panic(\"Expected symbolic fraction\")\n  }\n  \n  // Negate the sign\n  return (\n    type: \"sym-frac\",\n    num: f.num,\n    denom: f.denom,\n    sign: -f.sign\n  )\n}\n\n#let frac-is-zero(f) = {\n  if f.type != \"sym-frac\" {\n    panic(\"Expected symbolic fraction\")\n  }\n  \n  return f.num == 0\n}\n\n#let frac-is-one(f) = {\n  if f.type != \"sym-frac\" {\n    panic(\"Expected symbolic fraction\")\n  }\n  \n  return f.num == f.denom and f.sign &gt; 0\n}\n\n// Format a symbolic fraction\n#let format-frac(f) = {\n  if f.type != \"sym-frac\" {\n    panic(\"Expected symbolic fraction\")\n  }\n  \n  if f.denom == 1 {\n    if f.sign &lt; 0 {\n      return [-#f.num]\n    } else {\n      return [#f.num]\n    }\n  } else {\n    let fraction = math.frac([#f.num], [#f.denom])\n    if f.sign &lt; 0 {\n      return [-#fraction]\n    } else {\n      return fraction\n    }\n  }\n}\n\n// ============ ALGEBRAIC NUMBER SYSTEM ============\n\n// Clone a dictionary (since Typst dictionaries don't have a clone method)\n#let clone-dict(dict) = {\n  let result = (:)\n  for (key, value) in dict {\n    result.insert(key, value)\n  }\n  return result\n}\n\n// Represent an algebraic number with symbolic fractions for coefficients\n#let alg-num(\n  real-coef-num: 1, real-coef-denom: 1, real-factors: (:),\n  imag-coef-num: 0, imag-coef-denom: 1, imag-factors: (:)\n) = {\n  return (\n    type: \"algebraic\",\n    real: (\n      coef: sym-frac(real-coef-num, real-coef-denom),\n      factors: clone-dict(real-factors)\n    ),\n    imag: (\n      coef: sym-frac(imag-coef-num, imag-coef-denom),\n      factors: clone-dict(imag-factors)\n    )\n  )\n}\n\n// Convenience constructors\n#let alg-int(n) = alg-num(real-coef-num: n, real-coef-denom: 1)\n#let alg-i = alg-num(real-coef-num: 0, imag-coef-num: 1, imag-coef-denom: 1)\n\n// Create a proper fraction\n#let alg-frac(num, denom) = {\n  return alg-num(real-coef-num: num, real-coef-denom: denom)\n}\n\n// Create a square root\n#let alg-sqrt(n) = {\n  let factors = (:)\n  // Convert n to string if it's an integer\n  let base = if type(n) == int { str(n) } else { n }\n  factors.insert(base, decimal(\"0.5\"))\n  return alg-num(real-factors: factors)\n}\n\n// Create a reciprocal square root (1/√n)\n#let alg-rsqrt(n) = {\n  let factors = (:)\n  // Convert n to string if it's an integer\n  let base = if type(n) == int { str(n) } else { n }\n  factors.insert(base, decimal(\"-0.5\"))\n  return alg-num(real-factors: factors)\n}\n\n// Check if a decimal is approximately an integer\n#let is-integer(dec) = {\n  let int_value = calc.round(dec)\n  if type(dec) == decimal {\n    return calc.abs(dec - decimal(str(int_value))) &lt; decimal(\"0.00001\")\n  } else {\n    return calc.abs(dec - int_value) &lt; 0.00001\n  }\n}\n\n// Simplify one part (real or imaginary) of an algebraic number\n#let simplify-part(part) = {\n  let coef = part.coef\n  let factors = clone-dict(part.factors)\n  \n  // Handle zero coefficient\n  if frac-is-zero(coef) {\n    return (coef: sym-frac(0, 1), factors: (:))\n  }\n  \n  // Simplify factors with zero or integer exponents\n  let keys = factors.keys()\n  for base in keys {\n    let exp = factors.at(base)\n    \n    // Convert to decimal if not already\n    if type(exp) != decimal {\n      exp = decimal(str(exp))\n      factors.at(base) = exp\n    }\n    \n    // Remove factors with zero exponent\n    if exp == decimal(\"0\") {\n      factors.remove(base)\n    }\n  }\n  \n  return (coef: coef, factors: factors)\n}\n\n// Simplify an algebraic number\n#let simplify-alg(num) = {\n  if num.type != \"algebraic\" {\n    return alg-int(num)\n  }\n  \n  // Simplify both parts\n  let real-part = simplify-part(num.real)\n  let imag-part = simplify-part(num.imag)\n  \n  // Create the simplified number\n  return (\n    type: \"algebraic\",\n    real: real-part,\n    imag: imag-part\n  )\n}\n\n// Multiply a part (real or imaginary) by another part\n#let multiply-parts(a, b) = {\n  // If either coefficient is zero, result is zero\n  if frac-is-zero(a.coef) or frac-is-zero(b.coef) {\n    return (coef: sym-frac(0, 1), factors: (:))\n  }\n  \n  // Multiply coefficients\n  let coef = frac-mul(a.coef, b.coef)\n  \n  // Combine factors by adding exponents\n  let result_factors = clone-dict(a.factors)\n  for (base, exp) in b.factors {\n    if base in result_factors {\n      result_factors.at(base) = result_factors.at(base) + exp\n    } else {\n      result_factors.insert(base, exp)\n    }\n  }\n  \n  return (coef: coef, factors: result_factors)\n}\n\n// Multiply two algebraic numbers\n#let alg-mul(a, b) = {\n  if a.type != \"algebraic\" {\n    a = alg-int(a)\n  }\n  if b.type != \"algebraic\" {\n    b = alg-int(b)\n  }\n  \n  // (a + bi)(c + di) = (ac - bd) + (ad + bc)i\n  \n  // Real part: ac - bd\n  let real_ac = multiply-parts(a.real, b.real)\n  let real_bd = multiply-parts(a.imag, b.imag)\n  \n  // Imaginary part: ad + bc\n  let imag_ad = multiply-parts(a.real, b.imag)\n  let imag_bc = multiply-parts(a.imag, b.real)\n  \n  // For the real part, need to subtract bd from ac\n  let real_result\n  if frac-is-zero(real_bd.coef) {\n    // If bd is zero, real part is just ac\n    real_result = real_ac\n  } else if frac-is-zero(real_ac.coef) {\n    // If ac is zero, real part is -bd\n    real_result = (\n      coef: frac-neg(real_bd.coef),\n      factors: real_bd.factors\n    )\n  } else {\n    // Both non-zero, but we can only combine if they have identical factors\n    let factors_match = true\n    if real_ac.factors.keys().sorted() == real_bd.factors.keys().sorted() {\n      for (base, exp_ac) in real_ac.factors {\n        let exp_bd = real_bd.factors.at(base, default: none)\n        if exp_bd == none or exp_ac != exp_bd {\n          factors_match = false\n          break\n        }\n      }\n    } else {\n      factors_match = false\n    }\n    \n    if factors_match {\n      real_result = (\n        coef: frac-sub(real_ac.coef, real_bd.coef),\n        factors: real_ac.factors\n      )\n    } else {\n      // If we can't combine, just use ac for now\n      real_result = real_ac\n    }\n  }\n  \n  // For the imaginary part, need to add ad and bc\n  let imag_result\n  if frac-is-zero(imag_ad.coef) {\n    // If ad is zero, imaginary part is just bc\n    imag_result = imag_bc\n  } else if frac-is-zero(imag_bc.coef) {\n    // If bc is zero, imaginary part is just ad\n    imag_result = imag_ad\n  } else {\n    // Both non-zero, but we can only combine if they have identical factors\n    let factors_match = true\n    if imag_ad.factors.keys().sorted() == imag_bc.factors.keys().sorted() {\n      for (base, exp_ad) in imag_ad.factors {\n        let exp_bc = imag_bc.factors.at(base, default: none)\n        if exp_bc == none or exp_ad != exp_bc {\n          factors_match = false\n          break\n        }\n      }\n    } else {\n      factors_match = false\n    }\n    \n    if factors_match {\n      imag_result = (\n        coef: frac-add(imag_ad.coef, imag_bc.coef),\n        factors: imag_ad.factors\n      )\n    } else {\n      // If we can't combine, just use ad for now\n      imag_result = imag_ad\n    }\n  }\n\n  return simplify-alg((\n    type: \"algebraic\",\n    real: real_result,\n    imag: imag_result\n  ))\n}\n\n// Calculate the complex conjugate of an algebraic number\n#let alg-conjugate(a) = {\n  if a.type != \"algebraic\" {\n    a = alg-int(a)\n  }\n  \n  // Negate the imaginary part\n  return (\n    type: \"algebraic\",\n    real: a.real,\n    imag: (\n      coef: frac-neg(a.imag.coef),\n      factors: clone-dict(a.imag.factors)\n    )\n  )\n}\n\n// Divide two algebraic numbers using a/(b+ci) = a(b-ci)/(b²+c²)\n#let alg-div(a, b) = {\n  if a.type != \"algebraic\" {\n    a = alg-int(a)\n  }\n  if b.type != \"algebraic\" {\n    b = alg-int(b)\n  }\n  \n  // Special case: denominator is pure real\n  if frac-is-zero(b.imag.coef) {\n    // Create copies of a's factors\n    let real_factors = clone-dict(a.real.factors)\n    let imag_factors = clone-dict(a.imag.factors)\n    \n    // For each factor in the denominator, add it with negated exponent\n    for (base, exp) in b.real.factors {\n      if base in real_factors {\n        real_factors.at(base) = real_factors.at(base) - exp\n      } else {\n        real_factors.insert(base, -exp) // Add with negative exponent\n      }\n      \n      if base in imag_factors {\n        imag_factors.at(base) = imag_factors.at(base) - exp\n      } else {\n        imag_factors.insert(base, -exp) // Add with negative exponent\n      }\n    }\n    \n    return (\n      type: \"algebraic\",\n      real: (\n        coef: frac-div(a.real.coef, b.real.coef),\n        factors: real_factors  // Now contains correct combined factors\n      ),\n      imag: (\n        coef: frac-div(a.imag.coef, b.real.coef),\n        factors: imag_factors  // Now contains correct combined factors\n      )\n    )\n  }\n  \n  // For complex denominators, multiply by conjugate\n  // a/(b+ci) = a(b-ci)/((b+ci)(b-ci)) = a(b-ci)/(b²+c²)\n  let b_conj = alg-conjugate(b)\n  \n  // Multiply numerator by conjugate of denominator\n  let num = alg-mul(a, b_conj)\n  \n  // Calculate denominator: (b+ci)(b-ci) = b² + c²\n  let denom = alg-mul(b, b_conj)\n  \n  // Now denom should be real-only\n  if not frac-is-zero(denom.imag.coef) {\n    // This should not happen mathematically\n    return simplify-alg(num)\n  }\n  \n  // Divide by the real denominator\n  return alg-div(num, denom)\n}\n\n// Format an algebraic number for display\n#let format-alg(num) = {\n  if num.type != \"algebraic\" {\n    return str(num)\n  }\n  \n  num = simplify-alg(num)\n  \n  // Special case for zero\n  if frac-is-zero(num.real.coef) and frac-is-zero(num.imag.coef) {\n    return \"0\"\n  }\n  \n  // Function to format a single part (real or imaginary)\n  let format-part(part) = {\n    let coef = part.coef\n    let factors = part.factors\n    \n    // If coefficient is zero, return empty content\n    if frac-is-zero(coef) {\n      return []\n    }\n    \n    // Separate factors into positive and negative exponents\n    let pos_factors = (:)\n    let neg_factors = (:)\n    for (base, exp) in factors {\n      if exp &gt; decimal(\"0\") {\n        pos_factors.insert(base, exp)\n      } else if exp &lt; decimal(\"0\") {\n        neg_factors.insert(base, -exp) // Store positive value in neg_factors\n      }\n    }\n    \n    // Get the sign for the entire expression\n    let sign_content = []\n    if coef.sign &lt; 0 {\n      sign_content = math.minus\n    }\n    \n    // Format the numerator (coefficient and positive exponent factors)\n    let num_content = []\n    \n    // Add coefficient absolute value if not 1 or if there are no positive factors\n    if coef.num != coef.denom or pos_factors.keys().len() == 0 {\n      if coef.num == coef.denom {\n        // Coefficient is 1, don't show it unless there are no factors\n        if pos_factors.keys().len() == 0 {\n          num_content = [1]\n        }\n      } else {\n        // Show the coefficient (always positive now)\n        num_content = [#coef.num]\n      }\n    }\n    \n    // Add positive exponent factors\n    let sorted_pos_factors = pos_factors.keys().sorted()\n    for base in sorted_pos_factors {\n      let exp = pos_factors.at(base)\n      if exp == decimal(\"0.5\") {\n        num_content = [#num_content #math.sqrt(base)]\n      } else if exp == decimal(\"1\") {\n        num_content = [#num_content #base]\n      } else {\n        num_content = [#num_content #base^(#exp)]\n      }\n    }\n    \n    // Check if we need a fraction\n    // If we have no negative factors and denominator is 1, no fraction needed\n    if neg_factors.keys().len() == 0 and coef.denom == 1 {\n      return [#sign_content #num_content]\n    }\n    \n    // Format the denominator (coefficient denominator and negative exponent factors)\n    let denom_content = []\n    \n    // Add coefficient denominator if not 1\n    if coef.denom != 1 {\n      denom_content = [#coef.denom]\n    }\n    \n    // Add negative exponent factors\n    let sorted_neg_factors = neg_factors.keys().sorted()\n    for base in sorted_neg_factors {\n      let exp = neg_factors.at(base)\n      if exp == decimal(\"0.5\") {\n        denom_content = [#denom_content #math.sqrt(base)]\n      } else if exp == decimal(\"1\") {\n        denom_content = [#denom_content #base]\n      } else {\n        denom_content = [#denom_content #base^(#exp)]\n      }\n    }\n    \n    // Return the fraction with sign outside\n    let fraction = math.frac([#num_content], [#denom_content])\n    return [#sign_content #fraction]\n  }\n  \n  // Format real and imaginary parts\n  let real_result = format-part(num.real)\n  let imag_result = format-part(num.imag)\n  \n  // If imaginary part has content, add 'i'\n  if not frac-is-zero(num.imag.coef) {\n    imag_result = [#imag_result i]\n  }\n  \n  // Combine real and imaginary parts\n  if frac-is-zero(num.real.coef) {\n    return imag_result\n  } else if frac-is-zero(num.imag.coef) {\n    return real_result\n  } else {\n    // Need + sign between real and imaginary parts (but only if imag is positive)\n    if num.imag.coef.sign &gt; 0 {\n      return [#real_result + #imag_result]\n    } else {\n      // The minus sign is already included in imag_result\n      return [#real_result #imag_result]\n    }\n  }\n}\n\n// ============ COMPLEX NUMBER IMPLEMENTATION (FOR MATRICES) ============\n\n// Basic complex number operations (used for matrices)\n#let complex(a, b) = (a, b)\n#let complex-add(z1, z2) = (z1.at(0) + z2.at(0), z1.at(1) + z2.at(1))\n#let complex-sub(z1, z2) = (z1.at(0) - z2.at(0), z1.at(1) - z2.at(1))\n#let complex-mul(z1, z2) = (\n  z1.at(0) * z2.at(0) - z1.at(1) * z2.at(1),\n  z1.at(0) * z2.at(1) + z1.at(1) * z2.at(0)\n)\n#let complex-scale(z, s) = (z.at(0) * s, z.at(1) * s)\n\n// Convert complex to algebraic\n#let complex-to-alg(z) = {\n  let real = z.at(0)\n  let imag = z.at(1)\n  \n  return alg-num(\n    real-coef-num: real, real-coef-denom: 1,\n    imag-coef-num: imag, imag-coef-denom: 1\n  )\n}\n\n// Format a complex number for matrix display\n#let format-complex(z) = {\n  let real = z.at(0)\n  let imag = z.at(1)\n  \n  if imag == 0 {\n    return str(real)\n  } else if real == 0 {\n    if imag == 1 { return \"i\" }\n    else if imag == -1 { return \"-i\" }\n    else { return str(imag) + \"i\" }\n  } else {\n    let sign = if imag &gt; 0 { \"+\" } else { \"-\" }\n    let abs-imag = calc.abs(imag)\n    if abs-imag == 1 {\n      return str(real) + sign + \"i\"\n    } else {\n      return str(real) + sign + str(abs-imag) + \"i\"\n    }\n  }\n}\n\n// ============ MATRIX OPERATIONS ============\n\n#let mat-add(A, B) = {\n  let rows = A.len()\n  let cols = A.at(0).len()\n  \n  let result = ()\n  for i in range(rows) {\n    let row = ()\n    for j in range(cols) {\n      row.push(complex-add(A.at(i).at(j), B.at(i).at(j)))\n    }\n    result.push(row)\n  }\n  \n  return result\n}\n\n#let mat-sub(A, B) = {\n  let rows = A.len()\n  let cols = A.at(0).len()\n  \n  let result = ()\n  for i in range(rows) {\n    let row = ()\n    for j in range(cols) {\n      row.push(complex-sub(A.at(i).at(j), B.at(i).at(j)))\n    }\n    result.push(row)\n  }\n  \n  return result\n}\n\n#let mat-mul(A, B) = {\n  let rows_A = A.len()\n  let cols_A = A.at(0).len()\n  let cols_B = B.at(0).len()\n  \n  let result = ()\n  for i in range(rows_A) {\n    let row = ()\n    for j in range(cols_B) {\n      let sum = complex(0, 0)\n      for k in range(cols_A) {\n        sum = complex-add(sum, complex-mul(A.at(i).at(k), B.at(k).at(j)))\n      }\n      row.push(sum)\n    }\n    result.push(row)\n  }\n  \n  return result\n}\n\n#let mat-commutator(A, B) = {\n  let AB = mat-mul(A, B)\n  let BA = mat-mul(B, A)\n  return mat-sub(AB, BA)\n}\n\n#let mat-trace(A) = {\n  let sum = complex(0, 0)\n  let n = A.len()\n  \n  for i in range(n) {\n    sum = complex-add(sum, A.at(i).at(i))\n  }\n  \n  return sum\n}\n\n// ============ GELL-MANN MATRICES ============\n\n// Define Gell-Mann matrices without prefactors\n#let t1_base = (\n  (complex(0, 0), complex(1, 0), complex(0, 0)),\n  (complex(1, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t2_base = (\n  (complex(0, 0), complex(0, -1), complex(0, 0)),\n  (complex(0, 1), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t3_base = (\n  (complex(1, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(-1, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t4_base = (\n  (complex(0, 0), complex(0, 0), complex(1, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(1, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t5_base = (\n  (complex(0, 0), complex(0, 0), complex(0, -1)),\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 1), complex(0, 0), complex(0, 0))\n)\n\n#let t6_base = (\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(1, 0)),\n  (complex(0, 0), complex(1, 0), complex(0, 0))\n)\n\n#let t7_base = (\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, -1)),\n  (complex(0, 0), complex(0, 1), complex(0, 0))\n)\n\n#let t8_base = (\n  (complex(1, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(1, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(-2, 0))\n)\n\n// Create the algebraic prefactors with symbolic fractions\n#let half = alg-frac(1, 2)\n#let sqrt3 = alg-sqrt(3)\n#let half_sqrt3 = alg-div(half, sqrt3)\n\n// Define prefactors for each matrix\n#let prefactors = (\n  half,           // t1: 1/2\n  half,           // t2: 1/2\n  half,           // t3: 1/2\n  half,           // t4: 1/2\n  half,           // t5: 1/2\n  half,           // t6: 1/2\n  half,           // t7: 1/2\n  half_sqrt3      // t8: 1/(2√3)\n)\n\n// Scaled versions of the matrices for display\n#let t_bases = (t1_base, t2_base, t3_base, t4_base, t5_base, t6_base, t7_base, t8_base)\n\n// ============ STRUCTURE CONSTANT CALCULATION ============\n\n// Debug function to examine the structure of an algebraic number\n#let debug-alg(num) = {\n  if num.type != \"algebraic\" {\n    return \"not an algebraic number: \" + str(num)\n  }\n  \n  let real_coef = \"{ num: \" + str(num.real.coef.num) + \", denom: \" + str(num.real.coef.denom) + \" }\"\n  let imag_coef = \"{ num: \" + str(num.imag.coef.num) + \", denom: \" + str(num.imag.coef.denom) + \" }\"\n  \n  let result = \"algebraic: {\\n\"\n  result += \"  real: { coef: \" + real_coef + \", factors: \" + str(num.real.factors) + \" }\\n\"\n  result += \"  imag: { coef: \" + imag_coef + \", factors: \" + str(num.imag.factors) + \" }\\n\"\n  result += \"}\"\n  \n  return result\n}\n\n// Create the structure constants calculation function\n#let calculate-f(a, b, c, Cr) = {\n  let a_idx = a - 1\n  let b_idx = b - 1\n  let c_idx = c - 1\n  \n  // Calculate using base matrices (without prefactors)\n  let comm = mat-commutator(t_bases.at(a_idx), t_bases.at(b_idx))\n  let prod = mat-mul(comm, t_bases.at(c_idx))\n  let tr = mat-trace(prod)\n  \n  // Get prefactors for each matrix\n  let pa = prefactors.at(a_idx)\n  let pb = prefactors.at(b_idx)\n  let pc = prefactors.at(c_idx)\n  \n  // Combined prefactor (pa * pb * pc)\n  let combined_prefactor = alg-mul(pa, alg-mul(pb, pc))\n  \n  // Convert trace to algebraic number\n  let trace_alg = complex-to-alg(tr)\n  \n  // Structure constant formula: f^abc = -i/Cr * Tr([t_a, t_b] t_c) * combined_prefactor\n  let i_factor = alg-div(alg-mul(alg-int(-1), alg-i), alg-int(Cr))\n  \n  // Calculate each intermediate result for debugging\n  let trace_with_prefactor = alg-mul(trace_alg, combined_prefactor)\n  \n  // Final result with everything multiplied\n  let final_result = alg-mul(i_factor, trace_with_prefactor)\n  \n  return (\n    commutator: comm,\n    product: prod,\n    trace: tr,\n    trace_alg: trace_alg,\n    prefactor_a: pa,\n    prefactor_b: pb,\n    prefactor_c: pc,\n    combined_prefactor: combined_prefactor,\n    i_factor: i_factor,\n    trace_with_prefactor: trace_with_prefactor,\n    final_result: final_result\n  )\n}\n\n#let Cr = 1 // Normalization constant\n\n// ============ DISPLAY CALCULATIONS ============\n\n#let display-calculation(a, b, c) = {\n  let res = calculate-f(a, b, c, Cr)\n  \n  [\n    == Structure Constant $f^(#a #b #c)$\n    \n    *Step 1:* Calculate the commutator $[t_(#a), t_(#b)]$\n    \n    $ [t_(#a), t_(#b)] = #format-alg(res.prefactor_a) dot.c #format-alg(res.prefactor_b) (mat(delim: \"[\",\n      #format-complex(t_bases.at(a - 1).at(0).at(0)), #format-complex(t_bases.at(a - 1).at(0).at(1)), #format-complex(t_bases.at(a - 1).at(0).at(2)) ;\n      #format-complex(t_bases.at(a - 1).at(1).at(0)), #format-complex(t_bases.at(a - 1).at(1).at(1)), #format-complex(t_bases.at(a - 1).at(1).at(2)) ;\n      #format-complex(t_bases.at(a - 1).at(2).at(0)), #format-complex(t_bases.at(a - 1).at(2).at(1)), #format-complex(t_bases.at(a - 1).at(2).at(2))\n    ) mat(delim: \"[\",\n      #format-complex(t_bases.at(b - 1).at(0).at(0)), #format-complex(t_bases.at(b - 1).at(0).at(1)), #format-complex(t_bases.at(b - 1).at(0).at(2)) ;\n      #format-complex(t_bases.at(b - 1).at(1).at(0)), #format-complex(t_bases.at(b - 1).at(1).at(1)), #format-complex(t_bases.at(b - 1).at(1).at(2)) ;\n      #format-complex(t_bases.at(b - 1).at(2).at(0)), #format-complex(t_bases.at(b - 1).at(2).at(1)), #format-complex(t_bases.at(b - 1).at(2).at(2))\n    ) - mat(delim: \"[\",\n      #format-complex(t_bases.at(b - 1).at(0).at(0)), #format-complex(t_bases.at(b - 1).at(0).at(1)), #format-complex(t_bases.at(b - 1).at(0).at(2)) ;\n      #format-complex(t_bases.at(b - 1).at(1).at(0)), #format-complex(t_bases.at(b - 1).at(1).at(1)), #format-complex(t_bases.at(b - 1).at(1).at(2)) ;\n      #format-complex(t_bases.at(b - 1).at(2).at(0)), #format-complex(t_bases.at(b - 1).at(2).at(1)), #format-complex(t_bases.at(b - 1).at(2).at(2))\n    ) mat(delim: \"[\",\n      #format-complex(t_bases.at(a - 1).at(0).at(0)), #format-complex(t_bases.at(a - 1).at(0).at(1)), #format-complex(t_bases.at(a - 1).at(0).at(2)) ;\n      #format-complex(t_bases.at(a - 1).at(1).at(0)), #format-complex(t_bases.at(a - 1).at(1).at(1)), #format-complex(t_bases.at(a - 1).at(1).at(2)) ;\n      #format-complex(t_bases.at(a - 1).at(2).at(0)), #format-complex(t_bases.at(a - 1).at(2).at(1)), #format-complex(t_bases.at(a - 1).at(2).at(2))\n    )) = #format-alg(alg-mul(res.prefactor_a, res.prefactor_b)) mat(delim: \"[\",\n      #format-complex(res.commutator.at(0).at(0)), #format-complex(res.commutator.at(0).at(1)), #format-complex(res.commutator.at(0).at(2)) ;\n      #format-complex(res.commutator.at(1).at(0)), #format-complex(res.commutator.at(1).at(1)), #format-complex(res.commutator.at(1).at(2)) ;\n      #format-complex(res.commutator.at(2).at(0)), #format-complex(res.commutator.at(2).at(1)), #format-complex(res.commutator.at(2).at(2))\n    ) $\n    \n    *Step 2:* Multiply by $t_(#c)$ to get $[t_(#a), t_(#b)]t_(#c)$\n    \n    $ [t_(#a), t_(#b)]t_(#c) = #format-alg(res.prefactor_c) dot.c #format-alg(alg-mul(res.prefactor_a, res.prefactor_b)) mat(delim: \"[\",\n      #format-complex(res.commutator.at(0).at(0)), #format-complex(res.commutator.at(0).at(1)), #format-complex(res.commutator.at(0).at(2)) ;\n      #format-complex(res.commutator.at(1).at(0)), #format-complex(res.commutator.at(1).at(1)), #format-complex(res.commutator.at(1).at(2)) ;\n      #format-complex(res.commutator.at(2).at(0)), #format-complex(res.commutator.at(2).at(1)), #format-complex(res.commutator.at(2).at(2))\n    ) mat(delim: \"[\",\n      #format-complex(t_bases.at(c - 1).at(0).at(0)), #format-complex(t_bases.at(c - 1).at(0).at(1)), #format-complex(t_bases.at(c - 1).at(0).at(2)) ;\n      #format-complex(t_bases.at(c - 1).at(1).at(0)), #format-complex(t_bases.at(c - 1).at(1).at(1)), #format-complex(t_bases.at(c - 1).at(1).at(2)) ;\n      #format-complex(t_bases.at(c - 1).at(2).at(0)), #format-complex(t_bases.at(c - 1).at(2).at(1)), #format-complex(t_bases.at(c - 1).at(2).at(2))\n    ) = #format-alg(res.combined_prefactor) mat(delim: \"[\",\n      #format-complex(res.product.at(0).at(0)), #format-complex(res.product.at(0).at(1)), #format-complex(res.product.at(0).at(2)) ;\n      #format-complex(res.product.at(1).at(0)), #format-complex(res.product.at(1).at(1)), #format-complex(res.product.at(1).at(2)) ;\n      #format-complex(res.product.at(2).at(0)), #format-complex(res.product.at(2).at(1)), #format-complex(res.product.at(2).at(2))\n    ) $\n    \n    *Step 3:* Calculate the trace\n    \n    $ Tr([t_(#a), t_(#b)]t_(#c)) = #format-alg(res.combined_prefactor) dot.c Tr(mat(delim: \"[\",\n      #format-complex(res.product.at(0).at(0)), #format-complex(res.product.at(0).at(1)), #format-complex(res.product.at(0).at(2)) ;\n      #format-complex(res.product.at(1).at(0)), #format-complex(res.product.at(1).at(1)), #format-complex(res.product.at(1).at(2)) ;\n      #format-complex(res.product.at(2).at(0)), #format-complex(res.product.at(2).at(1)), #format-complex(res.product.at(2).at(2))\n    )) = #format-alg(res.combined_prefactor) dot.c #format-complex(res.trace) = #format-alg(res.trace_with_prefactor) $\n    \n    *Step 4:* Multiply by $-i/C_r$ to get the structure constant\n    \n    $ f^(#a #b #c) = -frac(i, C_r) dot.c #format-alg(res.trace_with_prefactor) = #format-alg(res.final_result) $\n  ]\n}\n\n// Calculate and display all structure constants where a != b != c\n#let display-all-distinct-constants() = [\n  = All SU(3) Structure Constants with Distinct Indices\n\n  #for a in range(1, 9) {\n    for b in range(1, 9) {\n      for c in range(1, 9) {\n        // Skip if any two indices are equal\n        if a != b and b != c and a != c {\n          display-calculation(a, b, c)\n          v(1em) // Add vertical space between calculations\n        }\n      }\n    }\n  }\n]\n\n// Add this to the end of your document\n#display-all-distinct-constants()\n</code></pre>\n<p>This works for any case where a != b != c, but as soon as one equality holds, some weird symbolic failures appear, and I cannot be bothered at this point getting something more robust working.</p>\n<p>At this point, beyond the symbolic issues, the one problem I have is that reducing fractions using the Euclidean algorithm is off the table, since I wasn’t sure how to handle fractions with radicals involved.</p>",
      "raw": "In case anyone is curious, this is what I eventually got working:\n\n```typ\n#let Tr = math.upright(\"Tr\")\n\n// ============ SYMBOLIC FRACTION IMPLEMENTATION ============\n\n// Basic symbolic fraction representation\n#let sym-frac(num, denom) = {\n  // Ensure we always have integer representations\n  if type(num) != int { num = calc.round(num) }\n  if type(denom) != int { denom = calc.round(denom) }\n  \n  // Handle special cases\n  if denom == 0 { panic(\"Division by zero\") }\n  if num == 0 { return (type: \"sym-frac\", num: 0, denom: 1, sign: 1) }\n  \n  // Normalize negative signs - always store them separately\n  let sign = 1\n  if (num < 0 and denom > 0) or (num > 0 and denom < 0) {\n    sign = -1 // Negative fraction\n  }\n  num = calc.abs(num)\n  denom = calc.abs(denom)\n  \n  // Create fraction with normalized sign\n  return (\n    type: \"sym-frac\",\n    num: num,     // Always positive\n    denom: denom, // Always positive\n    sign: sign    // -1 if fraction is negative, 1 if positive\n  )\n}\n\n// Fraction arithmetic operations\n#let frac-add(f1, f2) = {\n  if f1.type != \"sym-frac\" or f2.type != \"sym-frac\" {\n    panic(\"Expected symbolic fractions\")\n  }\n  \n  // a/b + c/d = (ad + bc)/bd\n  // With signs: (sign_a * a)/b + (sign_c * c)/d\n  let sign_a_val = if f1.sign < 0 { -f1.num } else { f1.num }\n  let sign_c_val = if f2.sign < 0 { -f2.num } else { f2.num }\n  \n  let num = sign_a_val * f2.denom + sign_c_val * f1.denom\n  let denom = f1.denom * f2.denom\n  \n  return sym-frac(num, denom)\n}\n\n#let frac-sub(f1, f2) = {\n  if f1.type != \"sym-frac\" or f2.type != \"sym-frac\" {\n    panic(\"Expected symbolic fractions\")\n  }\n  \n  // a/b - c/d = (ad - bc)/bd\n  // With signs: (sign_a * a)/b - (sign_c * c)/d\n  let sign_a_val = if f1.sign < 0 { -f1.num } else { f1.num }\n  let sign_c_val = if f2.sign < 0 { -f2.num } else { f2.num }\n  \n  let num = sign_a_val * f2.denom - sign_c_val * f1.denom\n  let denom = f1.denom * f2.denom\n  \n  return sym-frac(num, denom)\n}\n\n#let frac-mul(f1, f2) = {\n  if f1.type != \"sym-frac\" or f2.type != \"sym-frac\" {\n    panic(\"Expected symbolic fractions\")\n  }\n  \n  // (a/b) * (c/d) = (ac)/(bd)\n  // Sign: sign_a * sign_c\n  let num = f1.num * f2.num\n  let denom = f1.denom * f2.denom\n  let sign = f1.sign * f2.sign\n  \n  return (\n    type: \"sym-frac\",\n    num: num,\n    denom: denom,\n    sign: sign\n  )\n}\n\n#let frac-div(f1, f2) = {\n  if f1.type != \"sym-frac\" or f2.type != \"sym-frac\" {\n    panic(\"Expected symbolic fractions\")\n  }\n  \n  // (a/b) / (c/d) = (ad)/(bc)\n  // Sign: sign_a * sign_c\n  let num = f1.num * f2.denom\n  let denom = f1.denom * f2.num\n  let sign = f1.sign * f2.sign\n  \n  return (\n    type: \"sym-frac\",\n    num: num,\n    denom: denom,\n    sign: sign\n  )\n}\n\n#let frac-neg(f) = {\n  if f.type != \"sym-frac\" {\n    panic(\"Expected symbolic fraction\")\n  }\n  \n  // Negate the sign\n  return (\n    type: \"sym-frac\",\n    num: f.num,\n    denom: f.denom,\n    sign: -f.sign\n  )\n}\n\n#let frac-is-zero(f) = {\n  if f.type != \"sym-frac\" {\n    panic(\"Expected symbolic fraction\")\n  }\n  \n  return f.num == 0\n}\n\n#let frac-is-one(f) = {\n  if f.type != \"sym-frac\" {\n    panic(\"Expected symbolic fraction\")\n  }\n  \n  return f.num == f.denom and f.sign > 0\n}\n\n// Format a symbolic fraction\n#let format-frac(f) = {\n  if f.type != \"sym-frac\" {\n    panic(\"Expected symbolic fraction\")\n  }\n  \n  if f.denom == 1 {\n    if f.sign < 0 {\n      return [-#f.num]\n    } else {\n      return [#f.num]\n    }\n  } else {\n    let fraction = math.frac([#f.num], [#f.denom])\n    if f.sign < 0 {\n      return [-#fraction]\n    } else {\n      return fraction\n    }\n  }\n}\n\n// ============ ALGEBRAIC NUMBER SYSTEM ============\n\n// Clone a dictionary (since Typst dictionaries don't have a clone method)\n#let clone-dict(dict) = {\n  let result = (:)\n  for (key, value) in dict {\n    result.insert(key, value)\n  }\n  return result\n}\n\n// Represent an algebraic number with symbolic fractions for coefficients\n#let alg-num(\n  real-coef-num: 1, real-coef-denom: 1, real-factors: (:),\n  imag-coef-num: 0, imag-coef-denom: 1, imag-factors: (:)\n) = {\n  return (\n    type: \"algebraic\",\n    real: (\n      coef: sym-frac(real-coef-num, real-coef-denom),\n      factors: clone-dict(real-factors)\n    ),\n    imag: (\n      coef: sym-frac(imag-coef-num, imag-coef-denom),\n      factors: clone-dict(imag-factors)\n    )\n  )\n}\n\n// Convenience constructors\n#let alg-int(n) = alg-num(real-coef-num: n, real-coef-denom: 1)\n#let alg-i = alg-num(real-coef-num: 0, imag-coef-num: 1, imag-coef-denom: 1)\n\n// Create a proper fraction\n#let alg-frac(num, denom) = {\n  return alg-num(real-coef-num: num, real-coef-denom: denom)\n}\n\n// Create a square root\n#let alg-sqrt(n) = {\n  let factors = (:)\n  // Convert n to string if it's an integer\n  let base = if type(n) == int { str(n) } else { n }\n  factors.insert(base, decimal(\"0.5\"))\n  return alg-num(real-factors: factors)\n}\n\n// Create a reciprocal square root (1/√n)\n#let alg-rsqrt(n) = {\n  let factors = (:)\n  // Convert n to string if it's an integer\n  let base = if type(n) == int { str(n) } else { n }\n  factors.insert(base, decimal(\"-0.5\"))\n  return alg-num(real-factors: factors)\n}\n\n// Check if a decimal is approximately an integer\n#let is-integer(dec) = {\n  let int_value = calc.round(dec)\n  if type(dec) == decimal {\n    return calc.abs(dec - decimal(str(int_value))) < decimal(\"0.00001\")\n  } else {\n    return calc.abs(dec - int_value) < 0.00001\n  }\n}\n\n// Simplify one part (real or imaginary) of an algebraic number\n#let simplify-part(part) = {\n  let coef = part.coef\n  let factors = clone-dict(part.factors)\n  \n  // Handle zero coefficient\n  if frac-is-zero(coef) {\n    return (coef: sym-frac(0, 1), factors: (:))\n  }\n  \n  // Simplify factors with zero or integer exponents\n  let keys = factors.keys()\n  for base in keys {\n    let exp = factors.at(base)\n    \n    // Convert to decimal if not already\n    if type(exp) != decimal {\n      exp = decimal(str(exp))\n      factors.at(base) = exp\n    }\n    \n    // Remove factors with zero exponent\n    if exp == decimal(\"0\") {\n      factors.remove(base)\n    }\n  }\n  \n  return (coef: coef, factors: factors)\n}\n\n// Simplify an algebraic number\n#let simplify-alg(num) = {\n  if num.type != \"algebraic\" {\n    return alg-int(num)\n  }\n  \n  // Simplify both parts\n  let real-part = simplify-part(num.real)\n  let imag-part = simplify-part(num.imag)\n  \n  // Create the simplified number\n  return (\n    type: \"algebraic\",\n    real: real-part,\n    imag: imag-part\n  )\n}\n\n// Multiply a part (real or imaginary) by another part\n#let multiply-parts(a, b) = {\n  // If either coefficient is zero, result is zero\n  if frac-is-zero(a.coef) or frac-is-zero(b.coef) {\n    return (coef: sym-frac(0, 1), factors: (:))\n  }\n  \n  // Multiply coefficients\n  let coef = frac-mul(a.coef, b.coef)\n  \n  // Combine factors by adding exponents\n  let result_factors = clone-dict(a.factors)\n  for (base, exp) in b.factors {\n    if base in result_factors {\n      result_factors.at(base) = result_factors.at(base) + exp\n    } else {\n      result_factors.insert(base, exp)\n    }\n  }\n  \n  return (coef: coef, factors: result_factors)\n}\n\n// Multiply two algebraic numbers\n#let alg-mul(a, b) = {\n  if a.type != \"algebraic\" {\n    a = alg-int(a)\n  }\n  if b.type != \"algebraic\" {\n    b = alg-int(b)\n  }\n  \n  // (a + bi)(c + di) = (ac - bd) + (ad + bc)i\n  \n  // Real part: ac - bd\n  let real_ac = multiply-parts(a.real, b.real)\n  let real_bd = multiply-parts(a.imag, b.imag)\n  \n  // Imaginary part: ad + bc\n  let imag_ad = multiply-parts(a.real, b.imag)\n  let imag_bc = multiply-parts(a.imag, b.real)\n  \n  // For the real part, need to subtract bd from ac\n  let real_result\n  if frac-is-zero(real_bd.coef) {\n    // If bd is zero, real part is just ac\n    real_result = real_ac\n  } else if frac-is-zero(real_ac.coef) {\n    // If ac is zero, real part is -bd\n    real_result = (\n      coef: frac-neg(real_bd.coef),\n      factors: real_bd.factors\n    )\n  } else {\n    // Both non-zero, but we can only combine if they have identical factors\n    let factors_match = true\n    if real_ac.factors.keys().sorted() == real_bd.factors.keys().sorted() {\n      for (base, exp_ac) in real_ac.factors {\n        let exp_bd = real_bd.factors.at(base, default: none)\n        if exp_bd == none or exp_ac != exp_bd {\n          factors_match = false\n          break\n        }\n      }\n    } else {\n      factors_match = false\n    }\n    \n    if factors_match {\n      real_result = (\n        coef: frac-sub(real_ac.coef, real_bd.coef),\n        factors: real_ac.factors\n      )\n    } else {\n      // If we can't combine, just use ac for now\n      real_result = real_ac\n    }\n  }\n  \n  // For the imaginary part, need to add ad and bc\n  let imag_result\n  if frac-is-zero(imag_ad.coef) {\n    // If ad is zero, imaginary part is just bc\n    imag_result = imag_bc\n  } else if frac-is-zero(imag_bc.coef) {\n    // If bc is zero, imaginary part is just ad\n    imag_result = imag_ad\n  } else {\n    // Both non-zero, but we can only combine if they have identical factors\n    let factors_match = true\n    if imag_ad.factors.keys().sorted() == imag_bc.factors.keys().sorted() {\n      for (base, exp_ad) in imag_ad.factors {\n        let exp_bc = imag_bc.factors.at(base, default: none)\n        if exp_bc == none or exp_ad != exp_bc {\n          factors_match = false\n          break\n        }\n      }\n    } else {\n      factors_match = false\n    }\n    \n    if factors_match {\n      imag_result = (\n        coef: frac-add(imag_ad.coef, imag_bc.coef),\n        factors: imag_ad.factors\n      )\n    } else {\n      // If we can't combine, just use ad for now\n      imag_result = imag_ad\n    }\n  }\n\n  return simplify-alg((\n    type: \"algebraic\",\n    real: real_result,\n    imag: imag_result\n  ))\n}\n\n// Calculate the complex conjugate of an algebraic number\n#let alg-conjugate(a) = {\n  if a.type != \"algebraic\" {\n    a = alg-int(a)\n  }\n  \n  // Negate the imaginary part\n  return (\n    type: \"algebraic\",\n    real: a.real,\n    imag: (\n      coef: frac-neg(a.imag.coef),\n      factors: clone-dict(a.imag.factors)\n    )\n  )\n}\n\n// Divide two algebraic numbers using a/(b+ci) = a(b-ci)/(b²+c²)\n#let alg-div(a, b) = {\n  if a.type != \"algebraic\" {\n    a = alg-int(a)\n  }\n  if b.type != \"algebraic\" {\n    b = alg-int(b)\n  }\n  \n  // Special case: denominator is pure real\n  if frac-is-zero(b.imag.coef) {\n    // Create copies of a's factors\n    let real_factors = clone-dict(a.real.factors)\n    let imag_factors = clone-dict(a.imag.factors)\n    \n    // For each factor in the denominator, add it with negated exponent\n    for (base, exp) in b.real.factors {\n      if base in real_factors {\n        real_factors.at(base) = real_factors.at(base) - exp\n      } else {\n        real_factors.insert(base, -exp) // Add with negative exponent\n      }\n      \n      if base in imag_factors {\n        imag_factors.at(base) = imag_factors.at(base) - exp\n      } else {\n        imag_factors.insert(base, -exp) // Add with negative exponent\n      }\n    }\n    \n    return (\n      type: \"algebraic\",\n      real: (\n        coef: frac-div(a.real.coef, b.real.coef),\n        factors: real_factors  // Now contains correct combined factors\n      ),\n      imag: (\n        coef: frac-div(a.imag.coef, b.real.coef),\n        factors: imag_factors  // Now contains correct combined factors\n      )\n    )\n  }\n  \n  // For complex denominators, multiply by conjugate\n  // a/(b+ci) = a(b-ci)/((b+ci)(b-ci)) = a(b-ci)/(b²+c²)\n  let b_conj = alg-conjugate(b)\n  \n  // Multiply numerator by conjugate of denominator\n  let num = alg-mul(a, b_conj)\n  \n  // Calculate denominator: (b+ci)(b-ci) = b² + c²\n  let denom = alg-mul(b, b_conj)\n  \n  // Now denom should be real-only\n  if not frac-is-zero(denom.imag.coef) {\n    // This should not happen mathematically\n    return simplify-alg(num)\n  }\n  \n  // Divide by the real denominator\n  return alg-div(num, denom)\n}\n\n// Format an algebraic number for display\n#let format-alg(num) = {\n  if num.type != \"algebraic\" {\n    return str(num)\n  }\n  \n  num = simplify-alg(num)\n  \n  // Special case for zero\n  if frac-is-zero(num.real.coef) and frac-is-zero(num.imag.coef) {\n    return \"0\"\n  }\n  \n  // Function to format a single part (real or imaginary)\n  let format-part(part) = {\n    let coef = part.coef\n    let factors = part.factors\n    \n    // If coefficient is zero, return empty content\n    if frac-is-zero(coef) {\n      return []\n    }\n    \n    // Separate factors into positive and negative exponents\n    let pos_factors = (:)\n    let neg_factors = (:)\n    for (base, exp) in factors {\n      if exp > decimal(\"0\") {\n        pos_factors.insert(base, exp)\n      } else if exp < decimal(\"0\") {\n        neg_factors.insert(base, -exp) // Store positive value in neg_factors\n      }\n    }\n    \n    // Get the sign for the entire expression\n    let sign_content = []\n    if coef.sign < 0 {\n      sign_content = math.minus\n    }\n    \n    // Format the numerator (coefficient and positive exponent factors)\n    let num_content = []\n    \n    // Add coefficient absolute value if not 1 or if there are no positive factors\n    if coef.num != coef.denom or pos_factors.keys().len() == 0 {\n      if coef.num == coef.denom {\n        // Coefficient is 1, don't show it unless there are no factors\n        if pos_factors.keys().len() == 0 {\n          num_content = [1]\n        }\n      } else {\n        // Show the coefficient (always positive now)\n        num_content = [#coef.num]\n      }\n    }\n    \n    // Add positive exponent factors\n    let sorted_pos_factors = pos_factors.keys().sorted()\n    for base in sorted_pos_factors {\n      let exp = pos_factors.at(base)\n      if exp == decimal(\"0.5\") {\n        num_content = [#num_content #math.sqrt(base)]\n      } else if exp == decimal(\"1\") {\n        num_content = [#num_content #base]\n      } else {\n        num_content = [#num_content #base^(#exp)]\n      }\n    }\n    \n    // Check if we need a fraction\n    // If we have no negative factors and denominator is 1, no fraction needed\n    if neg_factors.keys().len() == 0 and coef.denom == 1 {\n      return [#sign_content #num_content]\n    }\n    \n    // Format the denominator (coefficient denominator and negative exponent factors)\n    let denom_content = []\n    \n    // Add coefficient denominator if not 1\n    if coef.denom != 1 {\n      denom_content = [#coef.denom]\n    }\n    \n    // Add negative exponent factors\n    let sorted_neg_factors = neg_factors.keys().sorted()\n    for base in sorted_neg_factors {\n      let exp = neg_factors.at(base)\n      if exp == decimal(\"0.5\") {\n        denom_content = [#denom_content #math.sqrt(base)]\n      } else if exp == decimal(\"1\") {\n        denom_content = [#denom_content #base]\n      } else {\n        denom_content = [#denom_content #base^(#exp)]\n      }\n    }\n    \n    // Return the fraction with sign outside\n    let fraction = math.frac([#num_content], [#denom_content])\n    return [#sign_content #fraction]\n  }\n  \n  // Format real and imaginary parts\n  let real_result = format-part(num.real)\n  let imag_result = format-part(num.imag)\n  \n  // If imaginary part has content, add 'i'\n  if not frac-is-zero(num.imag.coef) {\n    imag_result = [#imag_result i]\n  }\n  \n  // Combine real and imaginary parts\n  if frac-is-zero(num.real.coef) {\n    return imag_result\n  } else if frac-is-zero(num.imag.coef) {\n    return real_result\n  } else {\n    // Need + sign between real and imaginary parts (but only if imag is positive)\n    if num.imag.coef.sign > 0 {\n      return [#real_result + #imag_result]\n    } else {\n      // The minus sign is already included in imag_result\n      return [#real_result #imag_result]\n    }\n  }\n}\n\n// ============ COMPLEX NUMBER IMPLEMENTATION (FOR MATRICES) ============\n\n// Basic complex number operations (used for matrices)\n#let complex(a, b) = (a, b)\n#let complex-add(z1, z2) = (z1.at(0) + z2.at(0), z1.at(1) + z2.at(1))\n#let complex-sub(z1, z2) = (z1.at(0) - z2.at(0), z1.at(1) - z2.at(1))\n#let complex-mul(z1, z2) = (\n  z1.at(0) * z2.at(0) - z1.at(1) * z2.at(1),\n  z1.at(0) * z2.at(1) + z1.at(1) * z2.at(0)\n)\n#let complex-scale(z, s) = (z.at(0) * s, z.at(1) * s)\n\n// Convert complex to algebraic\n#let complex-to-alg(z) = {\n  let real = z.at(0)\n  let imag = z.at(1)\n  \n  return alg-num(\n    real-coef-num: real, real-coef-denom: 1,\n    imag-coef-num: imag, imag-coef-denom: 1\n  )\n}\n\n// Format a complex number for matrix display\n#let format-complex(z) = {\n  let real = z.at(0)\n  let imag = z.at(1)\n  \n  if imag == 0 {\n    return str(real)\n  } else if real == 0 {\n    if imag == 1 { return \"i\" }\n    else if imag == -1 { return \"-i\" }\n    else { return str(imag) + \"i\" }\n  } else {\n    let sign = if imag > 0 { \"+\" } else { \"-\" }\n    let abs-imag = calc.abs(imag)\n    if abs-imag == 1 {\n      return str(real) + sign + \"i\"\n    } else {\n      return str(real) + sign + str(abs-imag) + \"i\"\n    }\n  }\n}\n\n// ============ MATRIX OPERATIONS ============\n\n#let mat-add(A, B) = {\n  let rows = A.len()\n  let cols = A.at(0).len()\n  \n  let result = ()\n  for i in range(rows) {\n    let row = ()\n    for j in range(cols) {\n      row.push(complex-add(A.at(i).at(j), B.at(i).at(j)))\n    }\n    result.push(row)\n  }\n  \n  return result\n}\n\n#let mat-sub(A, B) = {\n  let rows = A.len()\n  let cols = A.at(0).len()\n  \n  let result = ()\n  for i in range(rows) {\n    let row = ()\n    for j in range(cols) {\n      row.push(complex-sub(A.at(i).at(j), B.at(i).at(j)))\n    }\n    result.push(row)\n  }\n  \n  return result\n}\n\n#let mat-mul(A, B) = {\n  let rows_A = A.len()\n  let cols_A = A.at(0).len()\n  let cols_B = B.at(0).len()\n  \n  let result = ()\n  for i in range(rows_A) {\n    let row = ()\n    for j in range(cols_B) {\n      let sum = complex(0, 0)\n      for k in range(cols_A) {\n        sum = complex-add(sum, complex-mul(A.at(i).at(k), B.at(k).at(j)))\n      }\n      row.push(sum)\n    }\n    result.push(row)\n  }\n  \n  return result\n}\n\n#let mat-commutator(A, B) = {\n  let AB = mat-mul(A, B)\n  let BA = mat-mul(B, A)\n  return mat-sub(AB, BA)\n}\n\n#let mat-trace(A) = {\n  let sum = complex(0, 0)\n  let n = A.len()\n  \n  for i in range(n) {\n    sum = complex-add(sum, A.at(i).at(i))\n  }\n  \n  return sum\n}\n\n// ============ GELL-MANN MATRICES ============\n\n// Define Gell-Mann matrices without prefactors\n#let t1_base = (\n  (complex(0, 0), complex(1, 0), complex(0, 0)),\n  (complex(1, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t2_base = (\n  (complex(0, 0), complex(0, -1), complex(0, 0)),\n  (complex(0, 1), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t3_base = (\n  (complex(1, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(-1, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t4_base = (\n  (complex(0, 0), complex(0, 0), complex(1, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(1, 0), complex(0, 0), complex(0, 0))\n)\n\n#let t5_base = (\n  (complex(0, 0), complex(0, 0), complex(0, -1)),\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 1), complex(0, 0), complex(0, 0))\n)\n\n#let t6_base = (\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(1, 0)),\n  (complex(0, 0), complex(1, 0), complex(0, 0))\n)\n\n#let t7_base = (\n  (complex(0, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(0, -1)),\n  (complex(0, 0), complex(0, 1), complex(0, 0))\n)\n\n#let t8_base = (\n  (complex(1, 0), complex(0, 0), complex(0, 0)),\n  (complex(0, 0), complex(1, 0), complex(0, 0)),\n  (complex(0, 0), complex(0, 0), complex(-2, 0))\n)\n\n// Create the algebraic prefactors with symbolic fractions\n#let half = alg-frac(1, 2)\n#let sqrt3 = alg-sqrt(3)\n#let half_sqrt3 = alg-div(half, sqrt3)\n\n// Define prefactors for each matrix\n#let prefactors = (\n  half,           // t1: 1/2\n  half,           // t2: 1/2\n  half,           // t3: 1/2\n  half,           // t4: 1/2\n  half,           // t5: 1/2\n  half,           // t6: 1/2\n  half,           // t7: 1/2\n  half_sqrt3      // t8: 1/(2√3)\n)\n\n// Scaled versions of the matrices for display\n#let t_bases = (t1_base, t2_base, t3_base, t4_base, t5_base, t6_base, t7_base, t8_base)\n\n// ============ STRUCTURE CONSTANT CALCULATION ============\n\n// Debug function to examine the structure of an algebraic number\n#let debug-alg(num) = {\n  if num.type != \"algebraic\" {\n    return \"not an algebraic number: \" + str(num)\n  }\n  \n  let real_coef = \"{ num: \" + str(num.real.coef.num) + \", denom: \" + str(num.real.coef.denom) + \" }\"\n  let imag_coef = \"{ num: \" + str(num.imag.coef.num) + \", denom: \" + str(num.imag.coef.denom) + \" }\"\n  \n  let result = \"algebraic: {\\n\"\n  result += \"  real: { coef: \" + real_coef + \", factors: \" + str(num.real.factors) + \" }\\n\"\n  result += \"  imag: { coef: \" + imag_coef + \", factors: \" + str(num.imag.factors) + \" }\\n\"\n  result += \"}\"\n  \n  return result\n}\n\n// Create the structure constants calculation function\n#let calculate-f(a, b, c, Cr) = {\n  let a_idx = a - 1\n  let b_idx = b - 1\n  let c_idx = c - 1\n  \n  // Calculate using base matrices (without prefactors)\n  let comm = mat-commutator(t_bases.at(a_idx), t_bases.at(b_idx))\n  let prod = mat-mul(comm, t_bases.at(c_idx))\n  let tr = mat-trace(prod)\n  \n  // Get prefactors for each matrix\n  let pa = prefactors.at(a_idx)\n  let pb = prefactors.at(b_idx)\n  let pc = prefactors.at(c_idx)\n  \n  // Combined prefactor (pa * pb * pc)\n  let combined_prefactor = alg-mul(pa, alg-mul(pb, pc))\n  \n  // Convert trace to algebraic number\n  let trace_alg = complex-to-alg(tr)\n  \n  // Structure constant formula: f^abc = -i/Cr * Tr([t_a, t_b] t_c) * combined_prefactor\n  let i_factor = alg-div(alg-mul(alg-int(-1), alg-i), alg-int(Cr))\n  \n  // Calculate each intermediate result for debugging\n  let trace_with_prefactor = alg-mul(trace_alg, combined_prefactor)\n  \n  // Final result with everything multiplied\n  let final_result = alg-mul(i_factor, trace_with_prefactor)\n  \n  return (\n    commutator: comm,\n    product: prod,\n    trace: tr,\n    trace_alg: trace_alg,\n    prefactor_a: pa,\n    prefactor_b: pb,\n    prefactor_c: pc,\n    combined_prefactor: combined_prefactor,\n    i_factor: i_factor,\n    trace_with_prefactor: trace_with_prefactor,\n    final_result: final_result\n  )\n}\n\n#let Cr = 1 // Normalization constant\n\n// ============ DISPLAY CALCULATIONS ============\n\n#let display-calculation(a, b, c) = {\n  let res = calculate-f(a, b, c, Cr)\n  \n  [\n    == Structure Constant $f^(#a #b #c)$\n    \n    *Step 1:* Calculate the commutator $[t_(#a), t_(#b)]$\n    \n    $ [t_(#a), t_(#b)] = #format-alg(res.prefactor_a) dot.c #format-alg(res.prefactor_b) (mat(delim: \"[\",\n      #format-complex(t_bases.at(a - 1).at(0).at(0)), #format-complex(t_bases.at(a - 1).at(0).at(1)), #format-complex(t_bases.at(a - 1).at(0).at(2)) ;\n      #format-complex(t_bases.at(a - 1).at(1).at(0)), #format-complex(t_bases.at(a - 1).at(1).at(1)), #format-complex(t_bases.at(a - 1).at(1).at(2)) ;\n      #format-complex(t_bases.at(a - 1).at(2).at(0)), #format-complex(t_bases.at(a - 1).at(2).at(1)), #format-complex(t_bases.at(a - 1).at(2).at(2))\n    ) mat(delim: \"[\",\n      #format-complex(t_bases.at(b - 1).at(0).at(0)), #format-complex(t_bases.at(b - 1).at(0).at(1)), #format-complex(t_bases.at(b - 1).at(0).at(2)) ;\n      #format-complex(t_bases.at(b - 1).at(1).at(0)), #format-complex(t_bases.at(b - 1).at(1).at(1)), #format-complex(t_bases.at(b - 1).at(1).at(2)) ;\n      #format-complex(t_bases.at(b - 1).at(2).at(0)), #format-complex(t_bases.at(b - 1).at(2).at(1)), #format-complex(t_bases.at(b - 1).at(2).at(2))\n    ) - mat(delim: \"[\",\n      #format-complex(t_bases.at(b - 1).at(0).at(0)), #format-complex(t_bases.at(b - 1).at(0).at(1)), #format-complex(t_bases.at(b - 1).at(0).at(2)) ;\n      #format-complex(t_bases.at(b - 1).at(1).at(0)), #format-complex(t_bases.at(b - 1).at(1).at(1)), #format-complex(t_bases.at(b - 1).at(1).at(2)) ;\n      #format-complex(t_bases.at(b - 1).at(2).at(0)), #format-complex(t_bases.at(b - 1).at(2).at(1)), #format-complex(t_bases.at(b - 1).at(2).at(2))\n    ) mat(delim: \"[\",\n      #format-complex(t_bases.at(a - 1).at(0).at(0)), #format-complex(t_bases.at(a - 1).at(0).at(1)), #format-complex(t_bases.at(a - 1).at(0).at(2)) ;\n      #format-complex(t_bases.at(a - 1).at(1).at(0)), #format-complex(t_bases.at(a - 1).at(1).at(1)), #format-complex(t_bases.at(a - 1).at(1).at(2)) ;\n      #format-complex(t_bases.at(a - 1).at(2).at(0)), #format-complex(t_bases.at(a - 1).at(2).at(1)), #format-complex(t_bases.at(a - 1).at(2).at(2))\n    )) = #format-alg(alg-mul(res.prefactor_a, res.prefactor_b)) mat(delim: \"[\",\n      #format-complex(res.commutator.at(0).at(0)), #format-complex(res.commutator.at(0).at(1)), #format-complex(res.commutator.at(0).at(2)) ;\n      #format-complex(res.commutator.at(1).at(0)), #format-complex(res.commutator.at(1).at(1)), #format-complex(res.commutator.at(1).at(2)) ;\n      #format-complex(res.commutator.at(2).at(0)), #format-complex(res.commutator.at(2).at(1)), #format-complex(res.commutator.at(2).at(2))\n    ) $\n    \n    *Step 2:* Multiply by $t_(#c)$ to get $[t_(#a), t_(#b)]t_(#c)$\n    \n    $ [t_(#a), t_(#b)]t_(#c) = #format-alg(res.prefactor_c) dot.c #format-alg(alg-mul(res.prefactor_a, res.prefactor_b)) mat(delim: \"[\",\n      #format-complex(res.commutator.at(0).at(0)), #format-complex(res.commutator.at(0).at(1)), #format-complex(res.commutator.at(0).at(2)) ;\n      #format-complex(res.commutator.at(1).at(0)), #format-complex(res.commutator.at(1).at(1)), #format-complex(res.commutator.at(1).at(2)) ;\n      #format-complex(res.commutator.at(2).at(0)), #format-complex(res.commutator.at(2).at(1)), #format-complex(res.commutator.at(2).at(2))\n    ) mat(delim: \"[\",\n      #format-complex(t_bases.at(c - 1).at(0).at(0)), #format-complex(t_bases.at(c - 1).at(0).at(1)), #format-complex(t_bases.at(c - 1).at(0).at(2)) ;\n      #format-complex(t_bases.at(c - 1).at(1).at(0)), #format-complex(t_bases.at(c - 1).at(1).at(1)), #format-complex(t_bases.at(c - 1).at(1).at(2)) ;\n      #format-complex(t_bases.at(c - 1).at(2).at(0)), #format-complex(t_bases.at(c - 1).at(2).at(1)), #format-complex(t_bases.at(c - 1).at(2).at(2))\n    ) = #format-alg(res.combined_prefactor) mat(delim: \"[\",\n      #format-complex(res.product.at(0).at(0)), #format-complex(res.product.at(0).at(1)), #format-complex(res.product.at(0).at(2)) ;\n      #format-complex(res.product.at(1).at(0)), #format-complex(res.product.at(1).at(1)), #format-complex(res.product.at(1).at(2)) ;\n      #format-complex(res.product.at(2).at(0)), #format-complex(res.product.at(2).at(1)), #format-complex(res.product.at(2).at(2))\n    ) $\n    \n    *Step 3:* Calculate the trace\n    \n    $ Tr([t_(#a), t_(#b)]t_(#c)) = #format-alg(res.combined_prefactor) dot.c Tr(mat(delim: \"[\",\n      #format-complex(res.product.at(0).at(0)), #format-complex(res.product.at(0).at(1)), #format-complex(res.product.at(0).at(2)) ;\n      #format-complex(res.product.at(1).at(0)), #format-complex(res.product.at(1).at(1)), #format-complex(res.product.at(1).at(2)) ;\n      #format-complex(res.product.at(2).at(0)), #format-complex(res.product.at(2).at(1)), #format-complex(res.product.at(2).at(2))\n    )) = #format-alg(res.combined_prefactor) dot.c #format-complex(res.trace) = #format-alg(res.trace_with_prefactor) $\n    \n    *Step 4:* Multiply by $-i/C_r$ to get the structure constant\n    \n    $ f^(#a #b #c) = -frac(i, C_r) dot.c #format-alg(res.trace_with_prefactor) = #format-alg(res.final_result) $\n  ]\n}\n\n// Calculate and display all structure constants where a != b != c\n#let display-all-distinct-constants() = [\n  = All SU(3) Structure Constants with Distinct Indices\n\n  #for a in range(1, 9) {\n    for b in range(1, 9) {\n      for c in range(1, 9) {\n        // Skip if any two indices are equal\n        if a != b and b != c and a != c {\n          display-calculation(a, b, c)\n          v(1em) // Add vertical space between calculations\n        }\n      }\n    }\n  }\n]\n\n// Add this to the end of your document\n#display-all-distinct-constants()\n```\nThis works for any case where a != b != c, but as soon as one equality holds, some weird symbolic failures appear, and I cannot be bothered at this point getting something more robust working.\n\nAt this point, beyond the symbolic issues, the one problem I have is that reducing fractions using the Euclidean algorithm is off the table, since I wasn't sure how to handle fractions with radicals involved.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 4.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 788
    }
  ],
  "scraped_at": "2025-06-10T09:48:58.466863"
}
{
  "topic_metadata": {
    "id": 3729,
    "title": "How can I convert `str` type to a `content` type (string to content)?",
    "slug": "how-can-i-convert-str-type-to-a-content-type-string-to-content",
    "posts_count": 7,
    "created_at": "2025-04-19T13:49:33.258Z",
    "last_posted_at": "2025-04-21T17:59:39.936Z",
    "views": 144,
    "like_count": 3,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "vmartel08",
    "tags": [
      "scripting",
      "math"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 488
  },
  "posts": [
    {
      "id": 11330,
      "post_number": 1,
      "username": "Roberto",
      "name": "Roberto Giacomelli",
      "created_at": "2025-04-19T13:49:33.506Z",
      "updated_at": "2025-04-19T16:50:56.308Z",
      "cooked": "<p>Hi there. Newbie question here.<br>\nThe <code>str</code> type has many facilities such as regex manipulation not available for content material.<br>\nLet’s assume there’s a need to process a certain text as a string as we do with a template and to compose the resulting text from the union of the model with data. With this objective in mind, I haven’t been able to compose a string as markup text. For example, in the following code, I would expect the string to be typesetted as content, but it’s not the case.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let s = \"This is a *string* defining $pi$ as $3.14$!\"\n#s\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/a/af7ab1fda928e169a7eeb55ce7aa92c73a0ee2ec.png\" alt=\"immagine\" data-base62-sha1=\"p2mqHN1bQw41PHlyiikjPki4KHa\" width=\"616\" height=\"69\"></p>\n<p>Expected result:<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/b/b9b74e139dda81e5fbc4d5a8f7ce829e16856ed8.png\" alt=\"immagine\" data-base62-sha1=\"quV3N5d6HZbfJ9acL1TbdCZAY52\" width=\"540\" height=\"60\"></p>\n<p>How do that?<br>\nThanks</p>",
      "raw": "Hi there. Newbie question here.\nThe `str` type has many facilities such as regex manipulation not available for content material.\nLet's assume there's a need to process a certain text as a string as we do with a template and to compose the resulting text from the union of the model with data. With this objective in mind, I haven't been able to compose a string as markup text. For example, in the following code, I would expect the string to be typesetted as content, but it's not the case.\n\n```typ\n#let s = \"This is a *string* defining $pi$ as $3.14$!\"\n#s\n```\n![immagine|616x69](upload://p2mqHN1bQw41PHlyiikjPki4KHa.png)\n\nExpected result:\n![immagine|540x60](upload://quV3N5d6HZbfJ9acL1TbdCZAY52.png)\n\nHow do that?\nThanks",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 37,
      "score": 292.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1471
    },
    {
      "id": 11332,
      "post_number": 2,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-04-19T14:06:18.340Z",
      "updated_at": "2025-04-20T00:01:11.511Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/roberto\">@Roberto</a>,</p>\n<p>This could be achieved with the use of the <a href=\"https://typst.app/docs/reference/foundations/eval/\">Evaluate Function</a>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let s = \"This is a *string* defining $pi$ as $3.14$!\"\n#s\n#eval(s, mode: \"markup\")\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/6/6b3c1713d9db95fecd825f9a5bf94c0b77df0f5c.png\" alt=\"image\" data-base62-sha1=\"fiDPzL8413ql4nrL7FRh21U3JP6\" width=\"366\" height=\"86\"></p>",
      "raw": "Hello @Roberto, \n\nThis could be achieved with the use of the [Evaluate Function](https://typst.app/docs/reference/foundations/eval/):\n\n```typ\n#let s = \"This is a *string* defining $pi$ as $3.14$!\"\n#s\n#eval(s, mode: \"markup\")\n```\n\n![image|366x86](upload://fiDPzL8413ql4nrL7FRh21U3JP6.png)",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 36,
      "score": 127.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 11333,
      "post_number": 3,
      "username": "Roberto",
      "name": "Roberto Giacomelli",
      "created_at": "2025-04-19T14:08:45.110Z",
      "updated_at": "2025-04-19T14:11:28.076Z",
      "cooked": "<p>Thank you <a class=\"mention\" href=\"/u/vmartel08\">@vmartel08</a>. Any perfomance issue with the use of eval function in order to content conversion?<br>\nDocs defines eval as last resource.</p>",
      "raw": "Thank you @vmartel08. Any perfomance issue with the use of eval function in order to content conversion?\nDocs defines eval as last resource.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 35,
      "score": 12.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1471
    },
    {
      "id": 11334,
      "post_number": 4,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-04-19T14:14:35.789Z",
      "updated_at": "2025-04-19T14:20:34.554Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Roberto\" data-post=\"3\" data-topic=\"3729\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/roberto/48/2562_2.png\" class=\"avatar\"> Roberto:</div>\n<blockquote>\n<p>Any perfomance issue with the use of eval function in order to content conversion?</p>\n</blockquote>\n</aside>\n<p>Well, as you can read in the <a href=\"https://typst.app/docs/reference/foundations/eval/\">doc</a>:</p>\n<blockquote>\n<p>This function should only be used as a last resort.</p>\n</blockquote>\n<p>I’m not an expert of the Typst compiler internals but I would think that converting <code>text</code> to <code>content</code> should be nearly cost-less while converting <code>content</code> to <code>text</code> is more costly. Someone with more expertise should probably answer this part.</p>\n<p>May I suggest you move your question to the <a href=\"https://forum.typst.app/c/questions/5\">Questions</a> category?</p>",
      "raw": "[quote=\"Roberto, post:3, topic:3729\"]\nAny perfomance issue with the use of eval function in order to content conversion?\n[/quote]\n\nWell, as you can read in the [doc](https://typst.app/docs/reference/foundations/eval/):\n> \n> This function should only be used as a last resort.\n\nI'm not an expert of the Typst compiler internals but I would think that converting `text` to `content` should be nearly cost-less while converting `content` to `text` is more costly. Someone with more expertise should probably answer this part. \n\nMay I suggest you move your question to the [Questions](https://forum.typst.app/c/questions/5) category?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 1,
      "reads": 35,
      "score": 32.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 11346,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-19T20:20:21.665Z",
      "updated_at": "2025-04-19T20:20:21.665Z",
      "cooked": "<p>In your code block, you should use <code>typ</code> code identifier instead of <code>typc</code>.</p>",
      "raw": "In your code block, you should use `typ` code identifier instead of `typc`.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 6.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11347,
      "post_number": 6,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-19T20:23:17.131Z",
      "updated_at": "2025-04-19T20:23:17.131Z",
      "cooked": "<p>I’m not sure if there is a noticeable cost to this, but <a href=\"https://typst.app/docs/reference/foundations/eval/#parameters-scope\">the scope</a> is separate, so if something is referenced from outside, it must be specified.</p>\n<p><code>eval()</code> is the only way to render Typst examples, which has been done by many people, so I don’t think it’s that bad. There is <a href=\"https://github.com/typst/typst/issues/6067\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">`eval` drops all warnings · Issue #6067 · typst/typst · GitHub</a>, which was fixed recently.</p>",
      "raw": "I'm not sure if there is a noticeable cost to this, but [the scope](https://typst.app/docs/reference/foundations/eval/#parameters-scope) is separate, so if something is referenced from outside, it must be specified.\n\n`eval()` is the only way to render Typst examples, which has been done by many people, so I don't think it's that bad. There is https://github.com/typst/typst/issues/6067, which was fixed recently.",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 31,
      "score": 26.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11406,
      "post_number": 7,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-04-21T17:59:39.936Z",
      "updated_at": "2025-04-21T17:59:39.936Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"6\" data-topic=\"3729\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p><code>eval()</code> is the only way to render Typst examples, which has been done by many people, so I don’t think it’s that bad</p>\n</blockquote>\n</aside>\n<p>I read the “should only be used as a last resort” as “use the markup syntax<br>\n<code>[ .. ]</code> unless you have a good reason not to”. I too have seen it used throughout various code examples here, on GitHub and on the Typst Discord.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/4/47f460f78e17161288d90d6943718223de6f3bfe.png\" data-download-href=\"https://forum.typst.app/uploads/default/47f460f78e17161288d90d6943718223de6f3bfe\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/4/47f460f78e17161288d90d6943718223de6f3bfe_2_690x42.png\" alt=\"image\" data-base62-sha1=\"agxtJguWWXzzYaN5335D6JLWOrI\" width=\"690\" height=\"42\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/4/47f460f78e17161288d90d6943718223de6f3bfe_2_690x42.png, https://forum.typst.app/uploads/default/optimized/2X/4/47f460f78e17161288d90d6943718223de6f3bfe_2_1035x63.png 1.5x, https://forum.typst.app/uploads/default/original/2X/4/47f460f78e17161288d90d6943718223de6f3bfe.png 2x\" data-dominant-color=\"D3D5D7\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1077×66 30.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p><a class=\"mention\" href=\"/u/roberto\">@Roberto</a> please make sure you follow-up by either marking <img src=\"https://forum.typst.app/images/emoji/apple/white_check_mark.png?v=12\" title=\":white_check_mark:\" class=\"emoji\" alt=\":white_check_mark:\" loading=\"lazy\" width=\"20\" height=\"20\"> the post you found the most useful in answering your question to help others in the future.</p>",
      "raw": "[quote=\"Andrew, post:6, topic:3729\"]\n`eval()` is the only way to render Typst examples, which has been done by many people, so I don’t think it’s that bad\n[/quote]\n\nI read the \"should only be used as a last resort\" as \"use the markup syntax \n`[ .. ]` unless you have a good reason not to\". I too have seen it used throughout various code examples here, on GitHub and on the Typst Discord. \n\n![image|690x42](upload://agxtJguWWXzzYaN5335D6JLWOrI.png)\n \n@Roberto please make sure you follow-up by either marking :white_check_mark: the post you found the most useful in answering your question to help others in the future.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 23,
      "score": 4.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 936
    }
  ],
  "scraped_at": "2025-06-10T09:48:57.715971"
}
{
  "topic_metadata": {
    "id": 3731,
    "title": "What are the semantics of show rules wrapping headings in a block?",
    "slug": "what-are-the-semantics-of-show-rules-wrapping-headings-in-a-block",
    "posts_count": 11,
    "created_at": "2025-04-19T21:52:16.108Z",
    "last_posted_at": "2025-04-21T05:45:57.543Z",
    "views": 117,
    "like_count": 5,
    "reply_count": 7,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "scripting",
      "layout"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 1478
  },
  "posts": [
    {
      "id": 11350,
      "post_number": 1,
      "username": "T1ng",
      "name": "Jens",
      "created_at": "2025-04-19T21:52:16.215Z",
      "updated_at": "2025-04-21T01:19:15.211Z",
      "cooked": "<p>Earlier, I raised what I thought was a bug <a href=\"https://github.com/typst/typst/issues/6197\" rel=\"noopener nofollow ugc\">on GitHub</a>, which I then got told was intentional behavior.</p>\n<p>The question is regarding show rules targeting headings.</p>\n<p>Consider the following snippet</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(height: auto, width: auto, margin: 1cm)\n#show heading: block // this line does not affect anything ?!\n\n= hello\n// big space between these headings\n= hello\n// smaller space here\n#block(heading[hello])\n// big space again\n= hello\n// also big space\n= hello\n// small space again\n#block(heading[hello])\n// and big spacing for consecutive block-wrapped headings\n#block(heading[hello])\n</code></pre>\n<p>Which produces the following output:<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/c/cbd9189e3eb39366aafeb9707629a82e371aae46.png\" alt=\"image\" data-base62-sha1=\"t5k3hiRD4C1tLcBeW9vienjphci\" width=\"138\" height=\"323\"></p>\n<p>As to my understanding, the <code>show element: function</code> syntax (<code>show heading: block</code> in this case), is esentially a wrapper for <code>function(element(content))</code> (i.e. <code>block(heading(content))</code>).</p>\n<p>Another example is the code</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show \"Project\": smallcaps\n</code></pre>\n<p>taken directly from the <a href=\"https://typst.app/docs/reference/styling/#show-rules\">docs</a>. Naturally, this would be a wrap any <code>Project</code> to <code>#smallcaps[Project]</code>.</p>\n<p>I am not quite sure I understand the answer provided on GitHub, as I read it, it would assume the order <code>heading(block(content))</code>, or some hidden semantic rule?</p>\n<p>Can someone explain to me why there is a difference between wrapping a heading manually and via a show rule – where do the semantics change?</p>",
      "raw": "Earlier, I raised what I thought was a bug [on GitHub](https://github.com/typst/typst/issues/6197), which I then got told was intentional behavior.\n\nThe question is regarding show rules targeting headings.\n\nConsider the following snippet\n\n\n```typ\n#set page(height: auto, width: auto, margin: 1cm)\n#show heading: block // this line does not affect anything ?!\n\n= hello\n// big space between these headings\n= hello\n// smaller space here\n#block(heading[hello])\n// big space again\n= hello\n// also big space\n= hello\n// small space again\n#block(heading[hello])\n// and big spacing for consecutive block-wrapped headings\n#block(heading[hello])\n```\n\nWhich produces the following output:\n![image|185x431, 75%](upload://t5k3hiRD4C1tLcBeW9vienjphci.png)\n\nAs to my understanding, the `show element: function` syntax (`show heading: block` in this case), is esentially a wrapper for `function(element(content))` (i.e. `block(heading(content))`).\n\nAnother example is the code\n```typ\n#show \"Project\": smallcaps\n```\ntaken directly from the [docs](https://typst.app/docs/reference/styling/#show-rules). Naturally, this would be a wrap any `Project` to `#smallcaps[Project]`.\n\nI am not quite sure I understand the answer provided on GitHub, as I read it, it would assume the order `heading(block(content))`, or some hidden semantic rule?\n\nCan someone explain to me why there is a difference between wrapping a heading manually and via a show rule -- where do the semantics change?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 37,
      "score": 87.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1484
    },
    {
      "id": 11351,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-19T22:54:26.176Z",
      "updated_at": "2025-04-19T23:15:40.391Z",
      "cooked": "<p>There are default show-set rules for <code>heading</code> in <a href=\"https://github.com/typst/typst/blob/c21c1c391b48f843c8671993a28eaf1fe0d40b89/crates/typst-library/src/model/heading.rs#L308-L329\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">typst/crates/typst-library/src/model/heading.rs at c21c1c391b48f843c8671993a28eaf1fe0d40b89 · typst/typst · GitHub</a> that are almost like:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading: it =&gt; {\n  let level = it.level\n  let scale = (1.4, 1.2).at(level - 1, default: 1.0)\n\n  let size = 1em * scale\n  // level 1: 1.285714286em\n  let above = 1em * (if level == 1 { 1.8 } else { 1.44 }) / scale\n  // level 1: 0.535714286em\n  let below = 0.75em / scale\n\n  set text(size, weight: \"bold\")\n  set block(above: above, below: below, sticky: true)\n  it\n}\n</code></pre>\n<p>While the default <code>block</code> settings is just</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set block(spacing: 1.2em)\n</code></pre>\n<p><code>above</code> and <code>below</code> will inherit the <code>spacing</code> unless overridden.</p>\n<p>If you do <code>show heading: block</code>, then it will wrap heading <code>block</code> into <code>block</code> and you will get <code>block(block(heading content))</code>. Since <code>heading</code> show rule doesn’t set any <code>block</code> stuff other than <code>inset</code>, the show-set rules are doing all the work on <code>block</code> and <code>text</code>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(height: auto, width: auto, margin: 1cm)\n= hello 1 // below: ~0.54em\n= hello 2 // above: ~1.29em, below: ~0.54em\n#block(heading[hello 3]) // spacing: 1.2em\n#block(heading[hello 4]) // spacing: 1.2em\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/6/6b6de93e1ed952c425d169faeba0a313912626f8.png\" alt=\"image\" data-base62-sha1=\"fkmzvOwalCSsI2DDcfY5vd97hQA\" width=\"201\" height=\"290\"></p>\n<p>Here, between 1 and 2 you have 0.54 and 1.29, so the bigger margin wins.<br>\nBetween 2 and 3 you have 0.54 and <code>auto</code>, so since 0.54 <code>below</code> is more specific than 1.2 <code>spacing</code>, the 0.54 wins.<br>\nBetween 3 and 4 you have 1.2 <code>spacing</code>, so this is what used.</p>\n<p>I guess this is the logic, though I didn’t look into it before.</p>\n<p>There is also a separate problem that when you override <code>em</code> with <code>em</code> in some cases, it will stack up, see <a href=\"https://github.com/typst/typst/issues/1331\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Smaller font when using a raw block in a show rule · Issue #1331 · typst/typst · GitHub</a>.</p>\n<hr>\n<p>After thinking for a bit, I guess the outer block absorbs the inner settings, because the inner one is the only element inside outer block, so its settings don’t affect anything around. So, in the end, I think the behavior makes sense.</p>",
      "raw": "There are default show-set rules for `heading` in https://github.com/typst/typst/blob/c21c1c391b48f843c8671993a28eaf1fe0d40b89/crates/typst-library/src/model/heading.rs#L308-L329 that are almost like:\n\n```typ\n#show heading: it => {\n  let level = it.level\n  let scale = (1.4, 1.2).at(level - 1, default: 1.0)\n\n  let size = 1em * scale\n  // level 1: 1.285714286em\n  let above = 1em * (if level == 1 { 1.8 } else { 1.44 }) / scale\n  // level 1: 0.535714286em\n  let below = 0.75em / scale\n\n  set text(size, weight: \"bold\")\n  set block(above: above, below: below, sticky: true)\n  it\n}\n```\n\nWhile the default `block` settings is just\n\n```typ\n#set block(spacing: 1.2em)\n```\n\n`above` and `below` will inherit the `spacing` unless overridden.\n\nIf you do `show heading: block`, then it will wrap heading `block` into `block` and you will get `block(block(heading content))`. Since `heading` show rule doesn't set any `block` stuff other than `inset`, the show-set rules are doing all the work on `block` and `text`.\n\n```typ\n#set page(height: auto, width: auto, margin: 1cm)\n= hello 1 // below: ~0.54em\n= hello 2 // above: ~1.29em, below: ~0.54em\n#block(heading[hello 3]) // spacing: 1.2em\n#block(heading[hello 4]) // spacing: 1.2em\n```\n\n![image|201x290](upload://fkmzvOwalCSsI2DDcfY5vd97hQA.png)\n\nHere, between 1 and 2 you have 0.54 and 1.29, so the bigger margin wins.\nBetween 2 and 3 you have 0.54 and `auto`, so since 0.54 `below` is more specific than 1.2 `spacing`, the 0.54 wins.\nBetween 3 and 4 you have 1.2 `spacing`, so this is what used.\n\nI guess this is the logic, though I didn't look into it before.\n\nThere is also a separate problem that when you override `em` with `em` in some cases, it will stack up, see https://github.com/typst/typst/issues/1331.\n\n---\n\nAfter thinking for a bit, I guess the outer block absorbs the inner settings, because the inner one is the only element inside outer block, so its settings don't affect anything around. So, in the end, I think the behavior makes sense.",
      "reply_to_post_number": null,
      "reply_count": 3,
      "quote_count": 0,
      "like_count": 3,
      "reads": 37,
      "score": 112.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11352,
      "post_number": 3,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-19T23:24:09.888Z",
      "updated_at": "2025-04-20T00:02:10.576Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"2\" data-topic=\"3731\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>There is also a separate problem that when you override <code>em</code> with <code>em</code> in some cases</p>\n</blockquote>\n</aside>\n<p>Thanks, that’s the last puzzle piece, I was trying to dissect the problem without getting a solution. (I guess you linked a more complicated problem, but just the fact that em is contextual is important here.)</p>\n<hr>\n<p>Here’s my tip for debugging: insert this code in a sandbox document on the typst webapp. Hover over the <code>it</code> in the show rule and you can observe all the settings of each block in the document.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set page(height: auto, width: auto, margin: 1cm)\n#show block: it =&gt; it\n#set block(stroke: 0.20pt)\n\n\n= hello1\n// big space between these headings\n= hello2\n// smaller space here\n#block(above: 1.4 * 1.29em, heading[hello3])\n</code></pre>\n<p>One would think that setting above spacing to <code>1.29em</code> on your own block would make the spacing line up. But it has to be 1.4 * 1.29em for the spacing to line up - that’s the puzzle piece Andrew put down - the reason is that the text size inside the heading is larger, so <code>1.29em</code> inside a heading is larger than <code>1.29em</code> outside the heading - since <code>1em</code> is the current contextual font size. Interesting all around.</p>",
      "raw": "[quote=\"Andrew, post:2, topic:3731\"]\nThere is also a separate problem that when you override `em` with `em` in some cases\n[/quote]\n\nThanks, that's the last puzzle piece, I was trying to dissect the problem without getting a solution. (I guess you linked a more complicated problem, but just the fact that em is contextual is important here.)\n\n----\n\nHere's my tip for debugging: insert this code in a sandbox document on the typst webapp. Hover over the `it` in the show rule and you can observe all the settings of each block in the document.\n\n```typst\n#set page(height: auto, width: auto, margin: 1cm)\n#show block: it => it\n#set block(stroke: 0.20pt)\n\n\n= hello1\n// big space between these headings\n= hello2\n// smaller space here\n#block(above: 1.4 * 1.29em, heading[hello3])\n```\n\nOne would think that setting above spacing to `1.29em` on your own block would make the spacing line up. But it has to be 1.4 * 1.29em for the spacing to line up - that's the puzzle piece Andrew put down - the reason is that the text size inside the heading is larger, so `1.29em` inside a heading is larger than `1.29em` outside the heading - since `1em` is the current contextual font size. Interesting all around.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 33,
      "score": 11.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 11353,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-19T23:32:34.846Z",
      "updated_at": "2025-04-19T23:33:17.709Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"bluss\" data-post=\"3\" data-topic=\"3731\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/b/441A5E/48.png\" class=\"avatar\"> bluss:</div>\n<blockquote>\n<p>you can observe all the settings</p>\n</blockquote>\n</aside>\n<p>You can’t observe <code>spacing</code> in any way, since it’s <code>#[external]</code>.</p>",
      "raw": "[quote=\"bluss, post:3, topic:3731\"]\nyou can observe all the settings\n[/quote]\n\nYou can't observe `spacing` in any way, since it's `#[external]`.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 30,
      "score": 6.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11361,
      "post_number": 5,
      "username": "T1ng",
      "name": "Jens",
      "created_at": "2025-04-20T10:21:20.171Z",
      "updated_at": "2025-04-20T10:21:20.171Z",
      "cooked": "<p>Thank you so much for the detailed reply! It all makes sense to me now.</p>\n<p>I guess my solution will be to use</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading: set block(spacing: 1.2em)\n</code></pre>\n<p>instead.</p>\n<p>This has lead me to a follow-up question though.</p>\n<p>When playing around with it, I noticed that the spacing in this example is still smaller between heading 3 and 4. Why is that? Does the explicit spacing set by the <code>show</code> rule not overrule any other spacing (and are they not the same, as <code>auto</code> resolves to <code>1.2em</code>)?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(height: auto, width: auto, margin: 1cm)\n#show heading: set block(spacing: 1.2em)\n\n= hello 1\n= hello 2\n#block(heading[hello 3])\n#block(heading[hello 4])\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/f/f75a6df8eba84eaa60aa1ebade236244d9b4a031.png\" alt=\"drafting(2)\" data-base62-sha1=\"zibG8H6MURmZP5x3hTPehVpeTxn\" width=\"208\" height=\"293\"></p>",
      "raw": "Thank you so much for the detailed reply! It all makes sense to me now.\n\nI guess my solution will be to use \n```typ\n#show heading: set block(spacing: 1.2em)\n```\ninstead.\n\nThis has lead me to a follow-up question though.\n\nWhen playing around with it, I noticed that the spacing in this example is still smaller between heading 3 and 4. Why is that? Does the explicit spacing set by the `show` rule not overrule any other spacing (and are they not the same, as `auto` resolves to `1.2em`)?\n```typ\n#set page(height: auto, width: auto, margin: 1cm)\n#show heading: set block(spacing: 1.2em)\n\n= hello 1\n= hello 2\n#block(heading[hello 3])\n#block(heading[hello 4])\n```\n\n![drafting(2)|208x293](upload://zibG8H6MURmZP5x3hTPehVpeTxn.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 24,
      "score": 24.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1484
    },
    {
      "id": 11362,
      "post_number": 6,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-20T10:59:45.221Z",
      "updated_at": "2025-04-20T11:00:00.356Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"T1ng\" data-post=\"5\" data-topic=\"3731\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/t/66104C/48.png\" class=\"avatar\"> T1ng:</div>\n<blockquote>\n<p>Why is that?</p>\n</blockquote>\n</aside>\n<p>I think it’s about the other point I brought up. em as a unit is relative to current font size.</p>\n<p>The font size is larger inside <code>heading</code> than outside it. So for blocks inside <code>heading</code>, 1.2em is larger than 1.2em for blocks outside/wrapping the heading.</p>\n<p>So can we test that?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading: set text(size: 11pt)\n#set text(size: 11pt)\n</code></pre>\n<p>Set the same text sizes in document body and the headings, and the spacing seems to line up with your setting, so it checks out.</p>",
      "raw": "[quote=\"T1ng, post:5, topic:3731\"]\nWhy is that?\n[/quote]\n\nI think it's about the other point I brought up. em as a unit is relative to current font size.\n\nThe font size is larger inside `heading` than outside it. So for blocks inside `heading`, 1.2em is larger than 1.2em for blocks outside/wrapping the heading.\n\nSo can we test that?\n\n```typ\n#show heading: set text(size: 11pt)\n#set text(size: 11pt)\n```\n\nSet the same text sizes in document body and the headings, and the spacing seems to line up with your setting, so it checks out.",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 22,
      "score": 19.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 11371,
      "post_number": 7,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-04-21T01:20:00.652Z",
      "updated_at": "2025-04-21T01:20:00.652Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/t1ng\">@T1ng</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>Make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @T1ng, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nMake sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 4.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 11372,
      "post_number": 8,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-04-21T01:23:59.945Z",
      "updated_at": "2025-04-21T01:23:59.945Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"2\" data-topic=\"3731\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>After thinking for a bit, I guess the outer block absorbs the inner settings, because the inner one is the only element inside outer block, so its settings don’t affect anything around. So, in the end, I think the behavior makes sense.</p>\n</blockquote>\n</aside>\n<p>It doesn’t, it’s just that default show-set rules always apply to whatever you replace an element with in a show rule. There is currently no way to “disable” them.</p>\n<p>For example, <code>show heading: [abc]</code> will still show “abc” in a larger and bold font, even if you theoretically “discarded” the original heading, as its default show-set rules still apply.</p>\n<p>The reason default show-set rules are used in the first place is so you can override those settings (like bold headings) without having to rewrite the heading from scratch in a show rule, through your own show-set rules.</p>\n<p>Therefore, <code>show heading: set block(spacing: ...)</code> is indeed the correct answer if you want to change headings’ inter-block spacing back to the default.</p>",
      "raw": "[quote=\"Andrew, post:2, topic:3731\"]\nAfter thinking for a bit, I guess the outer block absorbs the inner settings, because the inner one is the only element inside outer block, so its settings don’t affect anything around. So, in the end, I think the behavior makes sense.\n[/quote]\n\nIt doesn't, it's just that default show-set rules always apply to whatever you replace an element with in a show rule. There is currently no way to \"disable\" them.\n\nFor example, `show heading: [abc]` will still show \"abc\" in a larger and bold font, even if you theoretically \"discarded\" the original heading, as its default show-set rules still apply. \n\nThe reason default show-set rules are used in the first place is so you can override those settings (like bold headings) without having to rewrite the heading from scratch in a show rule, through your own show-set rules.\n\nTherefore, `show heading: set block(spacing: ...)` is indeed the correct answer if you want to change headings' inter-block spacing back to the default.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 20,
      "score": 9.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 11373,
      "post_number": 9,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-21T02:35:15.657Z",
      "updated_at": "2025-04-21T02:35:15.657Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"PgBiel\" data-post=\"8\" data-topic=\"3731\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/p/F64C96/48.png\" class=\"avatar\"> PgBiel:</div>\n<blockquote>\n<p>It doesn’t, it’s just that default show-set rules always apply to whatever you replace an element with in a show rule. There is currently no way to “disable” them.</p>\n</blockquote>\n</aside>\n<p>What? I’m talking about <code>block(heading[])</code>, there is no show rule.</p>",
      "raw": "[quote=\"PgBiel, post:8, topic:3731\"]\nIt doesn’t, it’s just that default show-set rules always apply to whatever you replace an element with in a show rule. There is currently no way to “disable” them.\n[/quote]\n\nWhat? I'm talking about `block(heading[])`, there is no show rule.",
      "reply_to_post_number": 8,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 20,
      "score": 9.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11374,
      "post_number": 10,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-04-21T03:08:48.090Z",
      "updated_at": "2025-04-21T03:09:13.960Z",
      "cooked": "<p>I still don’t get what you mean since the outer block does not inherit the inner block’s settings at all here, unless by absorb you mean that it causes the inner block’s settings to not apply at all, in which case that would be correct.</p>\n<p>In addition, regarding</p>\n<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"2\" data-topic=\"3731\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>If you do <code>show heading: block</code>, then it will wrap heading <code>block</code> into <code>block</code> and you will get <code>block(block(heading content))</code>.</p>\n</blockquote>\n</aside>\n<p>I should note (as a brief clarification for others) that <code>show heading: block</code> <strong>does</strong> create  a <code>block(heading[])</code>, that is, it is not <code>block(block(heading contents))</code> <strong>at first</strong> (but it does become that after applying the default heading show rule). However, the heading default show-set rules still apply to the whole new <code>block(heading[])</code> created by that show rule, not only to the heading inside that block, for the reasons mentioned previously.</p>",
      "raw": "I still don't get what you mean since the outer block does not inherit the inner block's settings at all here, unless by absorb you mean that it causes the inner block's settings to not apply at all, in which case that would be correct.\n\nIn addition, regarding\n[quote=\"Andrew, post:2, topic:3731\"]\nIf you do `show heading: block`, then it will wrap heading `block` into `block` and you will get `block(block(heading content))`.\n[/quote]\n\n I should note (as a brief clarification for others) that `show heading: block` **does** create  a `block(heading[])`, that is, it is not `block(block(heading contents))` **at first** (but it does become that after applying the default heading show rule). However, the heading default show-set rules still apply to the whole new `block(heading[])` created by that show rule, not only to the heading inside that block, for the reasons mentioned previously.",
      "reply_to_post_number": 9,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 19,
      "score": 13.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 11377,
      "post_number": 11,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-21T05:45:57.543Z",
      "updated_at": "2025-04-21T05:45:57.543Z",
      "cooked": "<blockquote>\n<p>by absorb you mean that it causes the inner block’s settings to not apply at all</p>\n</blockquote>\n<p>Yes.</p>",
      "raw": "> by absorb you mean that it causes the inner block’s settings to not apply at all\n\nYes.",
      "reply_to_post_number": 10,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 3.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:48:56.997155"
}
{
  "topic_metadata": {
    "id": 3732,
    "title": "How can I overlay cetz diagrams on top of code?",
    "slug": "how-can-i-overlay-cetz-diagrams-on-top-of-code",
    "posts_count": 7,
    "created_at": "2025-04-20T01:29:25.201Z",
    "last_posted_at": "2025-04-21T20:01:43.321Z",
    "views": 122,
    "like_count": 4,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "bluss",
    "tags": [
      "cetz"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 716
  },
  "posts": [
    {
      "id": 11354,
      "post_number": 1,
      "username": "Chrysoberyl",
      "name": "",
      "created_at": "2025-04-20T01:29:25.306Z",
      "updated_at": "2025-04-20T09:26:38.348Z",
      "cooked": "<p>In LaTeX, using <code>\\tikzmarknode</code>, I can draw tikz pictures directly on top of code listings. e.g.<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/2/205becfa856ff5e2402ead257ea82550d742cbe0.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/205becfa856ff5e2402ead257ea82550d742cbe0\" title=\"overlay\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/2/205becfa856ff5e2402ead257ea82550d742cbe0_2_690x307.jpeg\" alt=\"overlay\" data-base62-sha1=\"4Cgec5YlrLJeeTIzl4WA6YHYF5S\" width=\"690\" height=\"307\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/2/205becfa856ff5e2402ead257ea82550d742cbe0_2_690x307.jpeg, https://forum.typst.app/uploads/default/optimized/2X/2/205becfa856ff5e2402ead257ea82550d742cbe0_2_1035x460.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/2/205becfa856ff5e2402ead257ea82550d742cbe0_2_1380x614.jpeg 2x\" data-dominant-color=\"F2F1F0\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">overlay</span><span class=\"informations\">1657×739 63.8 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Is there a way to do something similar with cetz and triple-backquote code segments? I could not find any way to place markers like tikzmark inside a triple backquote block.</p>",
      "raw": "In LaTeX, using `\\tikzmarknode`, I can draw tikz pictures directly on top of code listings. e.g.\n![overlay|690x307](upload://4Cgec5YlrLJeeTIzl4WA6YHYF5S.jpeg)\n\nIs there a way to do something similar with cetz and triple-backquote code segments? I could not find any way to place markers like tikzmark inside a triple backquote block.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 39,
      "score": 187.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1277
    },
    {
      "id": 11355,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-20T02:37:05.549Z",
      "updated_at": "2025-04-20T02:37:05.549Z",
      "cooked": "<p>Does this count?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n\n#let node(body) = block(\n  stroke: 1pt + rgb(\"#706898\"),\n  fill: rgb(\"#ebe8e8\"),\n  inset: 0.3em,\n  radius: 0.5em,\n  text(0.6em, body),\n)\n\n#let line = cetz.draw.line.with(\n  mark: (start: \"o\", end: (symbol: \"stealth\", fill: black), scale: 0.7),\n  stroke: (dash: \"dashed\", thickness: 0.5pt),\n)\n\n#let code = ```\nexample : ∀ (p q: Prop), p ∨ q → q ∨ p := by\n  intro p q h\n  cases h\n  ⋅ apply Or.inr\n    assumption\n  ⋅ apply Or.inl\n    assumption\n```\n\n#let node1 = node($\n  p, q &amp; : sans(\"Prop\") \\\n  h &amp; : p or q \\\n  &amp; tack q or p\n$)\n\n#let node2 = node($\n  p, q &amp; : sans(\"Prop\") \\\n  h &amp; : p \\\n  &amp; tack q or p \\\n  p, q &amp; : sans(\"Prop\") \\\n  h &amp; : q \\\n  &amp; tack q or p\n$)\n\n#cetz.canvas({\n  import cetz.draw: content\n  content((0, 0), anchor: \"north-west\", code)\n  content((6, -1.5), name: \"node1\", node1)\n  content((4.4, -2.8), name: \"node2\", node2)\n  line((2.6, -0.55), \"node1\")\n  line((1.9, -0.95), \"node2\")\n})\n</code></pre>\n<details><summary>output</summary>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/4/4586e9bc4d233b285fa3cb38c51c8e3310291c8a.png\" data-download-href=\"https://forum.typst.app/uploads/default/4586e9bc4d233b285fa3cb38c51c8e3310291c8a\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/4/4586e9bc4d233b285fa3cb38c51c8e3310291c8a_2_690x343.png\" alt=\"image\" data-base62-sha1=\"9V3ZHUkJ6SgadhQa8vILVOkQPQ6\" width=\"690\" height=\"343\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/4/4586e9bc4d233b285fa3cb38c51c8e3310291c8a_2_690x343.png, https://forum.typst.app/uploads/default/original/2X/4/4586e9bc4d233b285fa3cb38c51c8e3310291c8a.png 1.5x, https://forum.typst.app/uploads/default/original/2X/4/4586e9bc4d233b285fa3cb38c51c8e3310291c8a.png 2x\" data-dominant-color=\"F1F1F1\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">870×433 50.9 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>",
      "raw": "Does this count?\n\n````typ\n#import \"@preview/cetz:0.3.4\"\n\n#let node(body) = block(\n  stroke: 1pt + rgb(\"#706898\"),\n  fill: rgb(\"#ebe8e8\"),\n  inset: 0.3em,\n  radius: 0.5em,\n  text(0.6em, body),\n)\n\n#let line = cetz.draw.line.with(\n  mark: (start: \"o\", end: (symbol: \"stealth\", fill: black), scale: 0.7),\n  stroke: (dash: \"dashed\", thickness: 0.5pt),\n)\n\n#let code = ```\nexample : ∀ (p q: Prop), p ∨ q → q ∨ p := by\n  intro p q h\n  cases h\n  ⋅ apply Or.inr\n    assumption\n  ⋅ apply Or.inl\n    assumption\n```\n\n#let node1 = node($\n  p, q & : sans(\"Prop\") \\\n  h & : p or q \\\n  & tack q or p\n$)\n\n#let node2 = node($\n  p, q & : sans(\"Prop\") \\\n  h & : p \\\n  & tack q or p \\\n  p, q & : sans(\"Prop\") \\\n  h & : q \\\n  & tack q or p\n$)\n\n#cetz.canvas({\n  import cetz.draw: content\n  content((0, 0), anchor: \"north-west\", code)\n  content((6, -1.5), name: \"node1\", node1)\n  content((4.4, -2.8), name: \"node2\", node2)\n  line((2.6, -0.55), \"node1\")\n  line((1.9, -0.95), \"node2\")\n})\n````\n\n<details><summary>output</summary>\n\n![image|690x343](upload://9V3ZHUkJ6SgadhQa8vILVOkQPQ6.png)\n\n</details>",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 37,
      "score": 27.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11356,
      "post_number": 3,
      "username": "Chrysoberyl",
      "name": "",
      "created_at": "2025-04-20T02:38:25.211Z",
      "updated_at": "2025-04-20T02:38:25.211Z",
      "cooked": "<p>Is there a way to determine the coordinate of the two nodes automatically?</p>",
      "raw": "Is there a way to determine the coordinate of the two nodes automatically?",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 12.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1277
    },
    {
      "id": 11357,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-20T02:49:52.995Z",
      "updated_at": "2025-04-20T02:49:52.995Z",
      "cooked": "<p>“Automatically” how?</p>",
      "raw": "\"Automatically\" how?",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 12.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11360,
      "post_number": 5,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-20T09:57:17.335Z",
      "updated_at": "2025-04-20T10:43:03.838Z",
      "cooked": "<p>It’s certainly possible to some extent. You can use <code>codly</code> for a code display with many features, for example line highlights and line labels (detailed by code line and code column).</p>\n<p>The label gives you access to the absolute position of that word in the code through the query system. I wonder if there’s some way to use labels as coordinates in cetz.</p>\n<details>\n<summary>Proof of concept / \"bad example\" </summary>\n<p>This example shows that it is possible. I think it would be better to do this with cetz instead of typst drawing primitives. As seen in the example, the text after the figure starts without taking the extent of the annotation boxes into account.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/1/10bceb400736f78b1f3d3be2d5ff5130a807e931.png\" data-download-href=\"https://forum.typst.app/uploads/default/10bceb400736f78b1f3d3be2d5ff5130a807e931\" title=\"bild\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/1/10bceb400736f78b1f3d3be2d5ff5130a807e931_2_690x290.png\" alt=\"bild\" data-base62-sha1=\"2o4oA9sCNqU8UXQBKumk1rBcXPr\" width=\"690\" height=\"290\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/1/10bceb400736f78b1f3d3be2d5ff5130a807e931_2_690x290.png, https://forum.typst.app/uploads/default/original/2X/1/10bceb400736f78b1f3d3be2d5ff5130a807e931.png 1.5x, https://forum.typst.app/uploads/default/original/2X/1/10bceb400736f78b1f3d3be2d5ff5130a807e931.png 2x\" data-dominant-color=\"F2F1F2\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">bild</span><span class=\"informations\">780×328 55.1 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/codly:1.3.0\": *\n#show: codly-init.with()\n\n// Testing out codly's feature that allows labels on individual lines of code\n\n#let code = raw(block: true, \n\"example : ∀ (p q: Prop), p ∨ q → q ∨ p := by\n  intro p q h\n  cases h\n  ⋅ apply Or.inr\n    assumption\n  ⋅ apply Or.inl\n    assumption\n\")\n#codly(highlights:(\n  (line: 2, start: 3, end: none, label: &lt;mark1&gt;),\n  (line: 3, start: 3, end: none, label: &lt;mark2&gt;),\n), annotations: (\n))\n#figure(\n  code\n)&lt;myfigure&gt;\n\nTest my labels @mark1 and @mark2\n\n\n/// Draw a line from the label's code line down to a box\n/// xoffset: x-offset from label coordinate to the start of the line\n/// xline, yline: length of the line to the box.\n#let drawbox(at-label, content, yoffset: 1em, xoffset: 20em, xline: 5em, yline: 5em,\n  line-style: (:), block-style: (:)) = context {\n  let codeline = query(at-label).first()\n  let pos = codeline.location().position()\n  let xstart = pos.x - 30mm // page margin, needs to be updated\n  let ystart = pos.y - 30mm\n\n  let xbox = xstart + xoffset + xline \n  let ybox = ystart + yoffset + yline\n  place(top + left, dx: xoffset + xstart, dy: ystart + yoffset,\n    line(start: (0%, 0%), end: (xline, yline), ..line-style))\n  place(top + left, dx: xbox, dy: ybox, block(..block-style, content))\n}\n\n#let drawbox = drawbox.with(\n  block-style: (inset: 0.75em, stroke: 0.5pt + purple.darken(60%), fill: gray.lighten(90%).transparentize(25%), radius: 0.5em),\n  line-style: (stroke: (thickness: 0.5pt, dash: \"dashed\")))\n\n#let annot1 = $\n  p, q &amp; : sans(\"Prop\") \\\n  h &amp; : p or q \\\n  &amp; tack q or p\n$\n#drawbox(&lt;mark1&gt;, annot1, xline: 4em, yline: 1em)\n\n#let annot2 = $\n  p, q &amp; : sans(\"Prop\") \\\n  h &amp; : p \\\n  &amp; tack q or p \\\n  p, q &amp; : sans(\"Prop\") \\\n  h &amp; : q \\\n  &amp; tack q or p\n$\n\n#drawbox(&lt;mark2&gt;, annot2, yline: 2em, xoffset: 11.5em)\n\n\n#lorem(20)\n</code></pre>\n</details>",
      "raw": "It's certainly possible to some extent. You can use `codly` for a code display with many features, for example line highlights and line labels (detailed by code line and code column).\n\nThe label gives you access to the absolute position of that word in the code through the query system. I wonder if there's some way to use labels as coordinates in cetz.\n\n\n<details>\n<summary>Proof of concept / \"bad example\" </summary>\n\nThis example shows that it is possible. I think it would be better to do this with cetz instead of typst drawing primitives. As seen in the example, the text after the figure starts without taking the extent of the annotation boxes into account.\n\n\n![bild|690x290](upload://2o4oA9sCNqU8UXQBKumk1rBcXPr.png)\n\n\n```typ\n#import \"@preview/codly:1.3.0\": *\n#show: codly-init.with()\n\n// Testing out codly's feature that allows labels on individual lines of code\n\n#let code = raw(block: true, \n\"example : ∀ (p q: Prop), p ∨ q → q ∨ p := by\n  intro p q h\n  cases h\n  ⋅ apply Or.inr\n    assumption\n  ⋅ apply Or.inl\n    assumption\n\")\n#codly(highlights:(\n  (line: 2, start: 3, end: none, label: <mark1>),\n  (line: 3, start: 3, end: none, label: <mark2>),\n), annotations: (\n))\n#figure(\n  code\n)<myfigure>\n\nTest my labels @mark1 and @mark2\n\n\n/// Draw a line from the label's code line down to a box\n/// xoffset: x-offset from label coordinate to the start of the line\n/// xline, yline: length of the line to the box.\n#let drawbox(at-label, content, yoffset: 1em, xoffset: 20em, xline: 5em, yline: 5em,\n  line-style: (:), block-style: (:)) = context {\n  let codeline = query(at-label).first()\n  let pos = codeline.location().position()\n  let xstart = pos.x - 30mm // page margin, needs to be updated\n  let ystart = pos.y - 30mm\n\n  let xbox = xstart + xoffset + xline \n  let ybox = ystart + yoffset + yline\n  place(top + left, dx: xoffset + xstart, dy: ystart + yoffset,\n    line(start: (0%, 0%), end: (xline, yline), ..line-style))\n  place(top + left, dx: xbox, dy: ybox, block(..block-style, content))\n}\n\n#let drawbox = drawbox.with(\n  block-style: (inset: 0.75em, stroke: 0.5pt + purple.darken(60%), fill: gray.lighten(90%).transparentize(25%), radius: 0.5em),\n  line-style: (stroke: (thickness: 0.5pt, dash: \"dashed\")))\n\n#let annot1 = $\n  p, q & : sans(\"Prop\") \\\n  h & : p or q \\\n  & tack q or p\n$\n#drawbox(<mark1>, annot1, xline: 4em, yline: 1em)\n\n#let annot2 = $\n  p, q & : sans(\"Prop\") \\\n  h & : p \\\n  & tack q or p \\\n  p, q & : sans(\"Prop\") \\\n  h & : q \\\n  & tack q or p\n$\n\n#drawbox(<mark2>, annot2, yline: 2em, xoffset: 11.5em)\n\n\n#lorem(20)\n```\n\n\n</details>",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 34,
      "score": 41.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 11407,
      "post_number": 6,
      "username": "Chrysoberyl",
      "name": "",
      "created_at": "2025-04-21T18:25:41.512Z",
      "updated_at": "2025-04-21T18:25:41.512Z",
      "cooked": "<p>Automatically in the sense that I can put a mark object after <code>intro p q h</code> and use a name to refer to that object’s coordinate.</p>",
      "raw": "Automatically in the sense that I can put a mark object after `intro p q h` and use a name to refer to that object's coordinate.",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 10.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1277
    },
    {
      "id": 11411,
      "post_number": 7,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-21T20:01:43.321Z",
      "updated_at": "2025-04-21T20:01:43.321Z",
      "cooked": "<p>Well, there is no easy way to do it other than what Codly provides, or recreating it from scratch, which I assume is pretty trivial. Does <a href=\"https://forum.typst.app/t/how-can-i-overlay-cetz-diagrams-on-top-of-code/3732/5\" class=\"inline-onebox\">How can I overlay cetz diagrams on top of code? - #5 by bluss</a> work for you?</p>",
      "raw": "Well, there is no easy way to do it other than what Codly provides, or recreating it from scratch, which I assume is pretty trivial. Does https://forum.typst.app/t/how-can-i-overlay-cetz-diagrams-on-top-of-code/3732/5?u=andrew work for you?",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 5.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:48:56.219488"
}
{
  "topic_metadata": {
    "id": 3735,
    "title": "How to add color box to a non-citation reference?",
    "slug": "how-to-add-color-box-to-a-non-citation-reference",
    "posts_count": 5,
    "created_at": "2025-04-20T16:01:08.441Z",
    "last_posted_at": "2025-04-20T21:10:55.081Z",
    "views": 93,
    "like_count": 5,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "scripting",
      "layout"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 425
  },
  "posts": [
    {
      "id": 11364,
      "post_number": 1,
      "username": "Btjk16",
      "name": "Btjk16",
      "created_at": "2025-04-20T16:01:08.653Z",
      "updated_at": "2025-04-20T21:09:24.274Z",
      "cooked": "<p>Hello everyone. Newbie here, coming from LaTeX.</p>\n<p>I am currently working on a template, but I am looking to implement color boxes around hyperlinks (cross-references, citations, urls and so on). What I’ve seen is just a discussion on GitHub, but is limited to cross-references and links, however, there are some issues.</p>\n<p>When using the numbering for headings and equations shown below, those are rendered with the dot and the parentheses, respectively. Such aspect does not happen with figures and tables, but as mentioned before, with citations are not possible.</p>\n<details>\n<summary>\nHeadings</summary>\n<pre><code class=\"lang-auto\">set heading(numbering: \"1.\")\nset math.equation(numbering: \"(1)\")\n</code></pre>\n</details>\n<p>I am looking for a (LaTeX) hyperref-like behaviour that may be able to work with all hyperlinks and render correctly. The code that I am using is the same that was shared in the discussion, just that I remove the colored text. I’ve tried to convert <code>supp</code> and <code>num</code> to string, so I could strip dots and parentheses, but the second case is from a context type and couldn’t find how to do it. I would appreciate help with all that.</p>\n<details>\n<summary>\nCode for hyperlinks</summary>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let separate-supplement-style(supp, num) = {\n  box(supp + \" \" + num, stroke: 1pt + green, outset: (bottom:1.5pt, x:.5pt, y:.5pt))\n}\n\n#show ref: it =&gt; {\n  let (element, target, supplement: supp) = it.fields()\n  if element == none {\n    return it\n  }\n  let non_cite_ref = element.fields()\n  let supp = if supp == auto { non_cite_ref.supplement } else { supp }\n  let num = context {\n    let head-count = counter(heading).at(target)\n    numbering(non_cite_ref.numbering, ..head-count)\n  }\n  link(target, separate-supplement-style(supp, num))\n}\n</code></pre>\n</details>\n<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://github.com/typst/typst/discussions/2585\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/2X/b/bad3e5f9ad67c1ddf145107ce7032ac1d7b22563.svg\" class=\"site-icon\" data-dominant-color=\"\" width=\"32\" height=\"32\">\n\n      <a href=\"https://github.com/typst/typst/discussions/2585\" target=\"_blank\" rel=\"noopener nofollow ugc\">GitHub</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/344;\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/88dfcb1a67bd80a3679d57e697268d8f775b4ae1_2_690x345.png\" class=\"thumbnail\" data-dominant-color=\"F0EFEE\" width=\"690\" height=\"345\"></div>\n\n<h3><a href=\"https://github.com/typst/typst/discussions/2585\" target=\"_blank\" rel=\"noopener nofollow ugc\">Control the colors and line of the references as in hyperref · typst/typst ·...</a></h3>\n\n  <p>It would be great to be able to control the colors of the references/citations as you can control them in hyperref. This is very useful for creating documentation or educational content, for exampl...</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "Hello everyone. Newbie here, coming from LaTeX.\n\nI am currently working on a template, but I am looking to implement color boxes around hyperlinks (cross-references, citations, urls and so on). What I've seen is just a discussion on GitHub, but is limited to cross-references and links, however, there are some issues.\n\nWhen using the numbering for headings and equations shown below, those are rendered with the dot and the parentheses, respectively. Such aspect does not happen with figures and tables, but as mentioned before, with citations are not possible.\n\n[details=\"Headings\"]\n```\nset heading(numbering: \"1.\")\nset math.equation(numbering: \"(1)\")\n```\n[/details]\n\n\n\nI am looking for a (LaTeX) hyperref-like behaviour that may be able to work with all hyperlinks and render correctly. The code that I am using is the same that was shared in the discussion, just that I remove the colored text. I've tried to convert `supp` and `num` to string, so I could strip dots and parentheses, but the second case is from a context type and couldn't find how to do it. I would appreciate help with all that.\n\n[details=\"Code for hyperlinks\"]\n```typst\n#let separate-supplement-style(supp, num) = {\n  box(supp + \" \" + num, stroke: 1pt + green, outset: (bottom:1.5pt, x:.5pt, y:.5pt))\n}\n\n#show ref: it => {\n  let (element, target, supplement: supp) = it.fields()\n  if element == none {\n    return it\n  }\n  let non_cite_ref = element.fields()\n  let supp = if supp == auto { non_cite_ref.supplement } else { supp }\n  let num = context {\n    let head-count = counter(heading).at(target)\n    numbering(non_cite_ref.numbering, ..head-count)\n  }\n  link(target, separate-supplement-style(supp, num))\n}\n```\n[/details]\n\n\nhttps://github.com/typst/typst/discussions/2585",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 284.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1480
    },
    {
      "id": 11367,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-20T17:58:56.371Z",
      "updated_at": "2025-04-20T17:59:35.020Z",
      "cooked": "<p>Hello. If you want to reference correct numbering for all elements, then you can just do:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show ref: it =&gt; {\n  // Skip bibliography citations.\n  if it.element == none { return it }\n  box(stroke: 1pt + green, outset: (bottom: 1.5pt, rest: .5pt), it)\n}\n\n#let bib = ```yaml\ncite:\n  type: article\n  author: Author\n  title: Title\n```.text\n\n#set heading(numbering: \"1.\")\n#set math.equation(numbering: \"(1)\")\n\n= Heading &lt;heading&gt;\n#figure([], caption: []) &lt;figure&gt;\n#figure(table(), caption: []) &lt;table&gt;\n$ x $ &lt;equation&gt;\n\n@heading\n\n@figure\n\n@table\n\n@equation\n\n@cite\n\n#bibliography(bytes(bib))\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/d/dd56fcc9602471be42c118581b15e64d2e0a16a2.png\" data-download-href=\"https://forum.typst.app/uploads/default/dd56fcc9602471be42c118581b15e64d2e0a16a2\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/d/dd56fcc9602471be42c118581b15e64d2e0a16a2_2_690x351.png\" alt=\"image\" data-base62-sha1=\"vA3TdUGrBDdj7JnZ7r3NrKpCXjY\" width=\"690\" height=\"351\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/d/dd56fcc9602471be42c118581b15e64d2e0a16a2_2_690x351.png, https://forum.typst.app/uploads/default/original/2X/d/dd56fcc9602471be42c118581b15e64d2e0a16a2.png 1.5x, https://forum.typst.app/uploads/default/original/2X/d/dd56fcc9602471be42c118581b15e64d2e0a16a2.png 2x\" data-dominant-color=\"0F100F\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">809×412 20.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Your code uses heading counter for all elements which is semantically incorrect.</p>",
      "raw": "Hello. If you want to reference correct numbering for all elements, then you can just do:\n\n```typ\n#show ref: it => {\n  // Skip bibliography citations.\n  if it.element == none { return it }\n  box(stroke: 1pt + green, outset: (bottom: 1.5pt, rest: .5pt), it)\n}\n\n#let bib = ```yaml\ncite:\n  type: article\n  author: Author\n  title: Title\n```.text\n\n#set heading(numbering: \"1.\")\n#set math.equation(numbering: \"(1)\")\n\n= Heading <heading>\n#figure([], caption: []) <figure>\n#figure(table(), caption: []) <table>\n$ x $ <equation>\n\n@heading\n\n@figure\n\n@table\n\n@equation\n\n@cite\n\n#bibliography(bytes(bib))\n```\n\n![image|690x351](upload://vA3TdUGrBDdj7JnZ7r3NrKpCXjY.png)\n\nYour code uses heading counter for all elements which is semantically incorrect.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 20,
      "score": 69.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11368,
      "post_number": 3,
      "username": "Btjk16",
      "name": "Btjk16",
      "created_at": "2025-04-20T19:33:02.862Z",
      "updated_at": "2025-04-20T19:33:02.862Z",
      "cooked": "<p>Thank you very much, the code you provided is much better and cleaner.</p>",
      "raw": "Thank you very much, the code you provided is much better and cleaner.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 18,
      "score": 23.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1480
    },
    {
      "id": 11369,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-20T20:06:44.944Z",
      "updated_at": "2025-04-20T20:06:44.944Z",
      "cooked": "<p>I think title should be “How to add color box to a non-citation reference?”</p>\n<p>Solution doesn’t color hyperlink, it colors a box, and box is for non-citation references specifically, not for hyperlinks.</p>",
      "raw": "I think title should be \"How to add color box to a non-citation reference?\"\n\nSolution doesn't color hyperlink, it colors a box, and box is for non-citation references specifically, not for hyperlinks.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11370,
      "post_number": 5,
      "username": "Btjk16",
      "name": "Btjk16",
      "created_at": "2025-04-20T21:10:55.081Z",
      "updated_at": "2025-04-20T21:10:55.081Z",
      "cooked": "<p>Done. I changed the title to match the solution. Thanks.</p>",
      "raw": "Done. I changed the title to match the solution. Thanks.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 18.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1480
    }
  ],
  "scraped_at": "2025-06-10T09:48:55.436268"
}
{
  "topic_metadata": {
    "id": 3739,
    "title": "How to add \"translation of translation\" in packаge leipzig-glossing?",
    "slug": "how-to-add-translation-of-translation-in-pack-ge-leipzig-glossing",
    "posts_count": 3,
    "created_at": "2025-04-21T09:04:37.039Z",
    "last_posted_at": "2025-04-21T13:58:43.797Z",
    "views": 31,
    "like_count": 1,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "packages"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 446
  },
  "posts": [
    {
      "id": 11380,
      "post_number": 1,
      "username": "tkat",
      "name": "tkat",
      "created_at": "2025-04-21T09:04:37.215Z",
      "updated_at": "2025-04-22T06:12:09.171Z",
      "cooked": "<p>Using package <code>leipzig-glossing</code>, I faced with problem that I cannot put addional lines under the translation, not under the morphemes.<br>\nI.e. it is possible to make this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#example(\n (\n header: [Hunzib (van den Berg 1995:46)],\n source: ([ождиг],[хо#super[н]хе],[мукъер]),\n transliteration: ([oʒdig],[χõχe],[muqʼer]),\n morphemes: ([ož-di-g],[xõxe],[m-uq'e-r]),\n additional-lines: (\n ([boy-#smallcaps[obl]-#smallcaps[ad]], [tree(#smallcaps[g4])],\n[#smallcaps[g4]-bend-#smallcaps[pret]]),\n ([at boy], [tree], [bent]),\n ),\n translation: [\"Because of the boy, the tree bent.\"]\n )\n)\n</code></pre>\n<p>Hovewer, package does not allow me to put additional lines under the translation to put “translation of translation”, something like that:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#example(\n (\n header: [Hunzib (van den Berg 1995:46)],\n source: ([ождиг],[хо#super[н]хе],[мукъер]),\n transliteration: ([oʒdig],[χõχe],[muqʼer]),\n morphemes: ([ož-di-g],[xõxe],[m-uq'e-r]),\n additional-lines: (\n ([boy-#smallcaps[obl]-#smallcaps[ad]], [tree(#smallcaps[g4])],\n[#smallcaps[g4]-bend-#smallcaps[pret]]),\n ([at boy], [tree], [bent]),\n ),\n translation: [\"Because of the boy, the tree bent.\"],\n**additional-line: [\"Из-за мальчика дерево согнулось\"]**,\n )\n)\n</code></pre>\n<p>Do you know what to do to add additional line for translation?</p>",
      "raw": "Using package ```leipzig-glossing```, I faced with problem that I cannot put addional lines under the translation, not under the morphemes.\nI.e. it is possible to make this:\n```typ\n#example(\n (\n header: [Hunzib (van den Berg 1995:46)],\n source: ([ождиг],[хо#super[н]хе],[мукъер]),\n transliteration: ([oʒdig],[χõχe],[muqʼer]),\n morphemes: ([ož-di-g],[xõxe],[m-uq'e-r]),\n additional-lines: (\n ([boy-#smallcaps[obl]-#smallcaps[ad]], [tree(#smallcaps[g4])],\n[#smallcaps[g4]-bend-#smallcaps[pret]]),\n ([at boy], [tree], [bent]),\n ),\n translation: [\"Because of the boy, the tree bent.\"]\n )\n)\n```\nHovewer, package does not allow me to put additional lines under the translation to put \"translation of translation\", something like that:\n```typ\n#example(\n (\n header: [Hunzib (van den Berg 1995:46)],\n source: ([ождиг],[хо#super[н]хе],[мукъер]),\n transliteration: ([oʒdig],[χõχe],[muqʼer]),\n morphemes: ([ož-di-g],[xõxe],[m-uq'e-r]),\n additional-lines: (\n ([boy-#smallcaps[obl]-#smallcaps[ad]], [tree(#smallcaps[g4])],\n[#smallcaps[g4]-bend-#smallcaps[pret]]),\n ([at boy], [tree], [bent]),\n ),\n translation: [\"Because of the boy, the tree bent.\"],\n**additional-line: [\"Из-за мальчика дерево согнулось\"]**,\n )\n)\n```\nDo you know what to do to add additional line for translation?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 9.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1486
    },
    {
      "id": 11387,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-21T11:47:35.691Z",
      "updated_at": "2025-04-21T11:47:35.691Z",
      "cooked": "<p>Hello. If you want to add a new paragraph, then  do this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/leipzig-glossing:0.5.0\": example\n\n#example((\n  header: [Hunzib (van den Berg 1995:46)],\n  source: ([ождиг], [хо#super[н]хе], [мукъер]),\n  transliteration: ([oʒdig], [χõχe], [muqʼer]),\n  morphemes: ([ož-di-g], [xõxe], [m-uq'e-r]),\n  additional-lines: (\n    (\n      [boy-#smallcaps[obl]-#smallcaps[ad]],\n      [tree(#smallcaps[g4])],\n      [#smallcaps[g4]-bend-#smallcaps[pret]],\n    ),\n    ([at boy], [tree], [bent]),\n  ),\n  translation: [\n    \"Because of the boy, the tree bent.\"\n\n    \"Из-за мальчика дерево согнулось\"\n  ],\n))\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/e/e7c13083884c4105e052162b2ea1223eef189388.png\" alt=\"image\" data-base62-sha1=\"x4ccxzQGcHSOBAlF9p4im3aMEnm\" width=\"224\" height=\"142\"></p>\n<p>If the same paragraph with a line break:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/leipzig-glossing:0.5.0\": example\n\n#example((\n  header: [Hunzib (van den Berg 1995:46)],\n  source: ([ождиг], [хо#super[н]хе], [мукъер]),\n  transliteration: ([oʒdig], [χõχe], [muqʼer]),\n  morphemes: ([ož-di-g], [xõxe], [m-uq'e-r]),\n  additional-lines: (\n    (\n      [boy-#smallcaps[obl]-#smallcaps[ad]],\n      [tree(#smallcaps[g4])],\n      [#smallcaps[g4]-bend-#smallcaps[pret]],\n    ),\n    ([at boy], [tree], [bent]),\n  ),\n  translation: [\n    \"Because of the boy, the tree bent.\" \\\n    \"Из-за мальчика дерево согнулось\"\n  ],\n))\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/b/b4dcb6e31795342a05d88e455a2357cb6a0714e4.png\" alt=\"image\" data-base62-sha1=\"pNYP21AI5vTHvOVgl4YC0ej30va\" width=\"222\" height=\"140\"></p>\n<hr>\n<p>P.S. Don’t forget to put language identifier for code blocks.</p>\n<aside class=\"quote no-group quote-modified\" data-username=\"reknih\" data-post=\"1\" data-topic=\"11\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/reknih/48/3_2.png\" class=\"avatar\"><a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11/1\">How to post in the Questions category</a></div>\n<blockquote>\n<p>If your question pertains to a bit of Typst markup you have problems with, put it in the question body! You can syntax-highlight Typst code by wrapping it in ` ```typ … ````. It will then look like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set font(size: 12pt)\n\nHello from *Typst* at $ pi.var + 1 $ o'clock!\n</code></pre>\n<p>If you need to highlight a code or math mode snippet instead, the language tags <code>typc</code> and <code>typm</code> do that, respectively.</p>\n</blockquote>\n</aside>",
      "raw": "Hello. If you want to add a new paragraph, then  do this:\n\n```typ\n#import \"@preview/leipzig-glossing:0.5.0\": example\n\n#example((\n  header: [Hunzib (van den Berg 1995:46)],\n  source: ([ождиг], [хо#super[н]хе], [мукъер]),\n  transliteration: ([oʒdig], [χõχe], [muqʼer]),\n  morphemes: ([ož-di-g], [xõxe], [m-uq'e-r]),\n  additional-lines: (\n    (\n      [boy-#smallcaps[obl]-#smallcaps[ad]],\n      [tree(#smallcaps[g4])],\n      [#smallcaps[g4]-bend-#smallcaps[pret]],\n    ),\n    ([at boy], [tree], [bent]),\n  ),\n  translation: [\n    \"Because of the boy, the tree bent.\"\n\n    \"Из-за мальчика дерево согнулось\"\n  ],\n))\n```\n\n![image|224x142](upload://x4ccxzQGcHSOBAlF9p4im3aMEnm.png)\n\nIf the same paragraph with a line break:\n\n```typ\n#import \"@preview/leipzig-glossing:0.5.0\": example\n\n#example((\n  header: [Hunzib (van den Berg 1995:46)],\n  source: ([ождиг], [хо#super[н]хе], [мукъер]),\n  transliteration: ([oʒdig], [χõχe], [muqʼer]),\n  morphemes: ([ož-di-g], [xõxe], [m-uq'e-r]),\n  additional-lines: (\n    (\n      [boy-#smallcaps[obl]-#smallcaps[ad]],\n      [tree(#smallcaps[g4])],\n      [#smallcaps[g4]-bend-#smallcaps[pret]],\n    ),\n    ([at boy], [tree], [bent]),\n  ),\n  translation: [\n    \"Because of the boy, the tree bent.\" \\\n    \"Из-за мальчика дерево согнулось\"\n  ],\n))\n```\n\n![image|222x140](upload://pNYP21AI5vTHvOVgl4YC0ej30va.png)\n\n---\n\nP.S. Don't forget to put language identifier for code blocks.\n\n[quote=\"reknih, post:1, topic:11\"]\nIf your question pertains to a bit of Typst markup you have problems with, put it in the question body! You can syntax-highlight Typst code by wrapping it in ` ```typ ... ````. It will then look like this:\n\n```typ\n#set font(size: 12pt)\n\nHello from *Typst* at $ pi.var + 1 $ o'clock!\n```\n\nIf you need to highlight a code or math mode snippet instead, the language tags `typc` and `typm` do that, respectively.\n[/quote]",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 8.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11393,
      "post_number": 3,
      "username": "tkat",
      "name": "tkat",
      "created_at": "2025-04-21T13:58:43.797Z",
      "updated_at": "2025-04-21T13:59:21.942Z",
      "cooked": "<p>Thank you so much!! <img src=\"https://forum.typst.app/images/emoji/apple/sparkles.png?v=12\" title=\":sparkles:\" class=\"emoji\" alt=\":sparkles:\" loading=\"lazy\" width=\"20\" height=\"20\"> <img src=\"https://forum.typst.app/images/emoji/apple/sparkles.png?v=12\" title=\":sparkles:\" class=\"emoji\" alt=\":sparkles:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Thank you so much!! :sparkles: :sparkles:",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 18,
      "score": 18.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1486
    }
  ],
  "scraped_at": "2025-06-10T09:48:54.706232"
}
{
  "topic_metadata": {
    "id": 3742,
    "title": "How to use highlights in codly without changing line spacing?",
    "slug": "how-to-use-highlights-in-codly-without-changing-line-spacing",
    "posts_count": 9,
    "created_at": "2025-04-21T11:20:25.705Z",
    "last_posted_at": "2025-04-21T16:53:10.259Z",
    "views": 68,
    "like_count": 5,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 6,
    "accepted_answer_username": "bluss",
    "tags": [
      "codly"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 637
  },
  "posts": [
    {
      "id": 11384,
      "post_number": 1,
      "username": "ranjitjhala",
      "name": "Ranjit Jhala",
      "created_at": "2025-04-21T11:20:25.807Z",
      "updated_at": "2025-04-22T06:24:24.981Z",
      "cooked": "<p>Hi,</p>\n<p>Thanks for your excellent work on <code>typst</code> and <code>polylux</code> and <code>codly</code>- I’m enjoying using it thoroughly! I had a question: could you tell me how I can get the highlights to work on <code>codly</code><br>\nwithout modifying the line spacing? Meaning, the line with the highlights seems “wider”, i.e. has more padding around it than the other lines, which I’d prefer not to have.</p>\n<p>For example, the code</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#codly(\n  highlights: ((line: 2, start: 15, end: 19, fill: red), )\n)\n```rust\nfn test(x) {\n  let apple = x + 1;\n  let cat = [apple, buck];\n  let buck = a + 1;\n  return c\n}\n```\n</code></pre>\n<p>Generates the PDF</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/a/a08e52e9e8f665a8b801af7c3c69944bef90ff17.png\" data-download-href=\"https://forum.typst.app/uploads/default/a08e52e9e8f665a8b801af7c3c69944bef90ff17\" title=\"Screenshot 2025-04-21 at 4.50.06 PM\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/a/a08e52e9e8f665a8b801af7c3c69944bef90ff17_2_690x255.png\" alt=\"Screenshot 2025-04-21 at 4.50.06 PM\" data-base62-sha1=\"mUlk0LZWN3FjRhsXYlmQWHnAGkD\" width=\"690\" height=\"255\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/a/a08e52e9e8f665a8b801af7c3c69944bef90ff17_2_690x255.png, https://forum.typst.app/uploads/default/optimized/2X/a/a08e52e9e8f665a8b801af7c3c69944bef90ff17_2_1035x382.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/a/a08e52e9e8f665a8b801af7c3c69944bef90ff17_2_1380x510.png 2x\" data-dominant-color=\"FCFAFA\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2025-04-21 at 4.50.06 PM</span><span class=\"informations\">1486×550 38.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Or is there some way to highlight parts of code blocks directly (without using <code>codly</code>) that achieves this effect (much like the “escape-characters” in latex’s listings?)</p>\n<p>Thanks!</p>\n<ul>\n<li>Ranjit.</li>\n</ul>",
      "raw": "Hi,\n\nThanks for your excellent work on `typst` and `polylux` and `codly`- I'm enjoying using it thoroughly! I had a question: could you tell me how I can get the highlights to work on `codly` \nwithout modifying the line spacing? Meaning, the line with the highlights seems \"wider\", i.e. has more padding around it than the other lines, which I'd prefer not to have.\n\nFor example, the code\n\n````typ\n#codly(\n  highlights: ((line: 2, start: 15, end: 19, fill: red), )\n)\n```rust\nfn test(x) {\n  let apple = x + 1;\n  let cat = [apple, buck];\n  let buck = a + 1;\n  return c\n}\n```\n````\n\nGenerates the PDF\n\n![Screenshot 2025-04-21 at 4.50.06 PM|690x255](upload://mUlk0LZWN3FjRhsXYlmQWHnAGkD.png)\n\nOr is there some way to highlight parts of code blocks directly (without using `codly`) that achieves this effect (much like the \"escape-characters\" in latex's listings?)\n\nThanks!\n\n- Ranjit.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 179.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1487
    },
    {
      "id": 11385,
      "post_number": 2,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-21T11:31:18.289Z",
      "updated_at": "2025-04-21T11:31:18.289Z",
      "cooked": "<p>I think they have an example for this in <a href=\"https://raw.githubusercontent.com/Dherse/codly/main/docs.pdf\" rel=\"noopener nofollow ugc\">the manual</a> section 2.47.1 on pg 35</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/d/de694f4b55cf2be5753e4ac4b7c77439fa98f99e.png\" alt=\"bild\" data-base62-sha1=\"vJxCEPflcvuOv6m56wj5zduG6m2\" width=\"606\" height=\"40\"></p>",
      "raw": "I think they have an example for this in [the manual](https://raw.githubusercontent.com/Dherse/codly/main/docs.pdf) section 2.47.1 on pg 35\n\n![bild|606x40](upload://vJxCEPflcvuOv6m56wj5zduG6m2.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 8.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 11386,
      "post_number": 3,
      "username": "ranjitjhala",
      "name": "Ranjit Jhala",
      "created_at": "2025-04-21T11:44:10.486Z",
      "updated_at": "2025-04-21T11:44:10.486Z",
      "cooked": "<p>Hi – yes, I should have mentioned in my original post that I tried to use the <code>highlight-inset</code> as advised in the manual, but it seemed to make no difference at all in my document? As in changing the <code>x</code> and <code>y</code> to arbitrary different values seemed to make no change whatsoever?</p>",
      "raw": "Hi -- yes, I should have mentioned in my original post that I tried to use the `highlight-inset` as advised in the manual, but it seemed to make no difference at all in my document? As in changing the `x` and `y` to arbitrary different values seemed to make no change whatsoever?",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 8.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1487
    },
    {
      "id": 11388,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-21T11:55:45.655Z",
      "updated_at": "2025-04-21T12:05:04.012Z",
      "cooked": "<p>Hi. Looks like a bug, you should open an issue about it, if it wasn’t addressed anywhere.</p>\n<p>Also, please follow the formatting rules for posts:</p>\n<aside class=\"quote no-group quote-modified\" data-username=\"reknih\" data-post=\"1\" data-topic=\"11\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/reknih/48/3_2.png\" class=\"avatar\"><a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11/1\">How to post in the Questions category</a></div>\n<blockquote>\n<p>If your question pertains to a bit of Typst markup you have problems with, put it in the question body! You can syntax-highlight Typst code by wrapping it in ` ```typ … ````. It will then look like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set font(size: 12pt)\n\nHello from *Typst* at $ pi.var + 1 $ o'clock!\n</code></pre>\n<p>If you need to highlight a code or math mode snippet instead, the language tags <code>typc</code> and <code>typm</code> do that, respectively.</p>\n</blockquote>\n</aside>\n<p>You’ve also forgot to close the triple backticks.</p>\n<pre data-code-wrap=\"md\"><code class=\"lang-md\">````typ\n```rust\n```\n````\n</code></pre>",
      "raw": "Hi. Looks like a bug, you should open an issue about it, if it wasn't addressed anywhere.\n\nAlso, please follow the formatting rules for posts:\n\n[quote=\"reknih, post:1, topic:11\"]\nIf your question pertains to a bit of Typst markup you have problems with, put it in the question body! You can syntax-highlight Typst code by wrapping it in ` ```typ ... ````. It will then look like this:\n\n```typ\n#set font(size: 12pt)\n\nHello from *Typst* at $ pi.var + 1 $ o'clock!\n```\n\nIf you need to highlight a code or math mode snippet instead, the language tags `typc` and `typm` do that, respectively.\n[/quote]\n\nYou've also forgot to close the triple backticks.\n\n`````md\n````typ\n```rust\n```\n````\n`````",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 19,
      "score": 18.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11389,
      "post_number": 5,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-21T11:55:57.533Z",
      "updated_at": "2025-04-21T11:55:57.533Z",
      "cooked": "<p>I think it’s fixed, but not released <a href=\"https://github.com/Dherse/codly/pull/79\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Fix highlight inset not taking effect by KoviRobi · Pull Request #79 · Dherse/codly · GitHub</a></p>",
      "raw": "I think it's fixed, but not released https://github.com/Dherse/codly/pull/79",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 8.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 11390,
      "post_number": 6,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-21T12:01:13.469Z",
      "updated_at": "2025-04-21T12:22:56.831Z",
      "cooked": "<p>For now it’s possible to roll back to codly 1.2.0 and it kinda seems to work there.</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/8/8de5605506670af4b1ff68413d68d03e33dfdbcc.png\" alt=\"bild\" data-base62-sha1=\"kfgL6BNdSpzaUJPBzWIZfCyDSr2\" width=\"374\" height=\"162\"></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show: codly-init.with()\n#codly(\n highlight-inset: 0em, highlight-outset: 0.3em,\n highlights: ((line: 2, start: 0, fill: red), )\n )\n```kotlin\nprivate val n = 0\nprivate val n = 0\nprivate val n = 0\n```\n</code></pre>\n<hr>\n<p>Sidenote I keep forgetting that one can use quadruple backticks to have raw blocks inside code blocks on the forum, like this:</p>\n<pre data-code-wrap=\"markdown\"><code class=\"lang-markdown\">This is my post on discourse. Example code:\n\n````typ\nThis is a typst document.\n#codly()\n```java\nprivate val n = 0\n```\n````\n</code></pre>",
      "raw": "For now it's possible to roll back to codly 1.2.0 and it kinda seems to work there.\n\n![bild|374x162](upload://kfgL6BNdSpzaUJPBzWIZfCyDSr2.png)\n\n````typ\n#show: codly-init.with()\n#codly(\n highlight-inset: 0em, highlight-outset: 0.3em,\n highlights: ((line: 2, start: 0, fill: red), )\n )\n```kotlin\nprivate val n = 0\nprivate val n = 0\nprivate val n = 0\n```\n````\n\n----\n\nSidenote I keep forgetting that one can use quadruple backticks to have raw blocks inside code blocks on the forum, like this:\n\n`````markdown\nThis is my post on discourse. Example code:\n\n````typ\nThis is a typst document.\n#codly()\n```java\nprivate val n = 0\n```\n````\n`````",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 14,
      "score": 37.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 11391,
      "post_number": 7,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-21T12:06:28.390Z",
      "updated_at": "2025-04-21T12:06:28.390Z",
      "cooked": "<p>The future/local solution would be:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/codly:1.3.0\": *\n#show: codly-init\n\n#codly(\n  highlight-inset: (x: 0.32em, y: 0pt),\n  highlight-outset: (x: 0pt, y: 0.32em),\n  highlights: ((line: 2, start: 15, end: 19, fill: red),),\n)\n\n```rust\nfn test(x) {\n  let apple = x + 1;\n  let cat = [apple, buck];\n  let buck = a + 1;\n  return c\n}\n```\n</code></pre>",
      "raw": "The future/local solution would be:\n\n````typ\n#import \"@preview/codly:1.3.0\": *\n#show: codly-init\n\n#codly(\n  highlight-inset: (x: 0.32em, y: 0pt),\n  highlight-outset: (x: 0pt, y: 0.32em),\n  highlights: ((line: 2, start: 15, end: 19, fill: red),),\n)\n\n```rust\nfn test(x) {\n  let apple = x + 1;\n  let cat = [apple, buck];\n  let buck = a + 1;\n  return c\n}\n```\n````",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 13,
      "score": 17.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11392,
      "post_number": 8,
      "username": "ranjitjhala",
      "name": "Ranjit Jhala",
      "created_at": "2025-04-21T13:53:16.108Z",
      "updated_at": "2025-04-21T16:56:30.884Z",
      "cooked": "<p>Hi Andrew,</p>\n<p>[EDIT: my apologies, I missed the “future” part of the message, please ignore below!]</p>\n<p>With exactly that code I still get the below?</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/b/b548a1f8b28bd50f45a6d207c744c77a6d91a2b3.png\" data-download-href=\"https://forum.typst.app/uploads/default/b548a1f8b28bd50f45a6d207c744c77a6d91a2b3\" title=\"Screenshot 2025-04-21 at 7.21.02 PM\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/b/b548a1f8b28bd50f45a6d207c744c77a6d91a2b3_2_690x167.png\" alt=\"Screenshot 2025-04-21 at 7.21.02 PM\" data-base62-sha1=\"pRI2id5XMq4h5NV6lhsLcXNlwI3\" width=\"690\" height=\"167\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/b/b548a1f8b28bd50f45a6d207c744c77a6d91a2b3_2_690x167.png, https://forum.typst.app/uploads/default/optimized/2X/b/b548a1f8b28bd50f45a6d207c744c77a6d91a2b3_2_1035x250.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/b/b548a1f8b28bd50f45a6d207c744c77a6d91a2b3_2_1380x334.png 2x\" data-dominant-color=\"F6F5F5\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2025-04-21 at 7.21.02 PM</span><span class=\"informations\">1480×360 27.2 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>(And changing the parameters for the <code>highlight-inset</code> seems to make no difference of any kind?)</p>\n<p>Could it have to do with some version problem?</p>\n<ul>\n<li>Ranjit.</li>\n</ul>",
      "raw": "Hi Andrew, \n\n[EDIT: my apologies, I missed the \"future\" part of the message, please ignore below!] \n\nWith exactly that code I still get the below?\n\n![Screenshot 2025-04-21 at 7.21.02 PM|690x167](upload://pRI2id5XMq4h5NV6lhsLcXNlwI3.png)\n\n(And changing the parameters for the `highlight-inset` seems to make no difference of any kind?)\n\nCould it have to do with some version problem?\n\n- Ranjit.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 13,
      "score": 2.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1487
    },
    {
      "id": 11402,
      "post_number": 9,
      "username": "ranjitjhala",
      "name": "Ranjit Jhala",
      "created_at": "2025-04-21T16:53:10.259Z",
      "updated_at": "2025-04-21T16:53:10.259Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"bluss\" data-post=\"6\" data-topic=\"3742\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/b/441A5E/48.png\" class=\"avatar\"> bluss:</div>\n<blockquote>\n<pre><code class=\"lang-auto\">#show: codly-init.with()\n#codly(\n highlight-inset: 0em, highlight-outset: 0.3em,\n highlights: ((line: 2, start: 0, fill: red), )\n )\n```kotlin\nprivate val n = 0\nprivate val n = 0\nprivate val n = 0\n</code></pre>\n<pre><code class=\"lang-auto\"></code></pre>\n</blockquote>\n</aside>\n<p>Thanks very much, this solution using <code>1.2.0</code> that like a charm!!!</p>",
      "raw": "[quote=\"bluss, post:6, topic:3742\"]\n```\n#show: codly-init.with()\n#codly(\n highlight-inset: 0em, highlight-outset: 0.3em,\n highlights: ((line: 2, start: 0, fill: red), )\n )\n```kotlin\nprivate val n = 0\nprivate val n = 0\nprivate val n = 0\n```\n```\n[/quote]\n\nThanks very much, this solution using `1.2.0` that like a charm!!!",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 13,
      "score": 17.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1487
    }
  ],
  "scraped_at": "2025-06-10T09:48:53.986559"
}
{
  "topic_metadata": {
    "id": 3743,
    "title": "How to use a double-sided document layout?",
    "slug": "how-to-use-a-double-sided-document-layout",
    "posts_count": 3,
    "created_at": "2025-04-21T14:50:25.778Z",
    "last_posted_at": "2025-04-21T16:07:07.616Z",
    "views": 86,
    "like_count": 2,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "vmartel08",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 141
  },
  "posts": [
    {
      "id": 11395,
      "post_number": 1,
      "username": "Btjk16",
      "name": "Btjk16",
      "created_at": "2025-04-21T14:50:25.969Z",
      "updated_at": "2025-04-21T14:52:50.872Z",
      "cooked": "<p>Hello everyone!</p>\n<p>I am learning Typst and trying to move from LaTeX. Just a quick question about layout config. How can I define a double-sided document?</p>\n<p>For reference, in LaTeX it is done with <code>\\documentclass[twoside]{article}</code> or as default with the <code>book</code> class, but I couldn’t figured it out with Typst and the <code>page</code> function.</p>\n<p>Thanks.</p>",
      "raw": "Hello everyone!\n\nI am learning Typst and trying to move from LaTeX. Just a quick question about layout config. How can I define a double-sided document?\n\nFor reference, in LaTeX it is done with `\\documentclass[twoside]{article}` or as default with the `book` class, but I couldn't figured it out with Typst and the `page` function.\n\nThanks.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 310.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1480
    },
    {
      "id": 11396,
      "post_number": 2,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-04-21T15:13:59.940Z",
      "updated_at": "2025-04-21T15:22:08.218Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/btjk16\">@Btjk16</a>, you can start by having a look at the Typst documentation:</p>\n<ul>\n<li><a href=\"https://typst.app/docs/guides/page-setup-guide/#alternating-margins\">Page setup guide - Alternating margins</a></li>\n<li><a href=\"https://typst.app/docs/guides/page-setup-guide/#specific-pages\">Page setup guide - Different header and footer on specific pages</a></li>\n</ul>\n<p>Typst Universe is a good place to find some examples. I particularly like <a href=\"https://typst.app/universe/package/hydra\">Hydra</a>.</p>",
      "raw": "Hi @Btjk16, you can start by having a look at the Typst documentation:\n- [Page setup guide - Alternating margins](https://typst.app/docs/guides/page-setup-guide/#alternating-margins)  \n- [Page setup guide - Different header and footer on specific pages](https://typst.app/docs/guides/page-setup-guide/#specific-pages)  \n\nTypst Universe is a good place to find some examples. I particularly like [Hydra](https://typst.app/universe/package/hydra).",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 45.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 11398,
      "post_number": 3,
      "username": "Btjk16",
      "name": "Btjk16",
      "created_at": "2025-04-21T16:07:07.616Z",
      "updated_at": "2025-04-21T16:07:07.616Z",
      "cooked": "<p>Thank you very much, I will take a look at the documentation you shared.</p>",
      "raw": "Thank you very much, I will take a look at the documentation you shared.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 26,
      "score": 20.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1480
    }
  ],
  "scraped_at": "2025-06-10T09:48:53.226044"
}
{
  "topic_metadata": {
    "id": 3749,
    "title": "How to get a footer with alternating alignment and custom text per page?",
    "slug": "how-to-get-a-footer-with-alternating-alignment-and-custom-text-per-page",
    "posts_count": 11,
    "created_at": "2025-04-21T18:56:39.831Z",
    "last_posted_at": "2025-04-22T21:50:48.441Z",
    "views": 112,
    "like_count": 6,
    "reply_count": 6,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 8,
    "accepted_answer_username": "vmartel08",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 1001
  },
  "posts": [
    {
      "id": 11408,
      "post_number": 1,
      "username": "Olaf",
      "name": "Olaf",
      "created_at": "2025-04-21T18:56:40.101Z",
      "updated_at": "2025-04-22T06:22:50.034Z",
      "cooked": "<p>I would like to have a footer in my document. The footer should consist of a text and the page number, separated by a pipe symbol. On odd-numbered pages, the page number should be on the right side, and the entire footer should be right-aligned. For example:</p>\n<pre><code class=\"lang-plaintext\">         lorem ipsum | 45\n</code></pre>\n<p>On even-numbered pages, the footer should be left-aligned, and the page number should be on the left:</p>\n<pre><code class=\"lang-plaintext\">46 | lorem ipsum\n</code></pre>\n<p>I would like to set the displayed text differently on each page.</p>",
      "raw": "I would like to have a footer in my document. The footer should consist of a text and the page number, separated by a pipe symbol. On odd-numbered pages, the page number should be on the right side, and the entire footer should be right-aligned. For example:\n\n```plain\n         lorem ipsum | 45\n```                  \n\nOn even-numbered pages, the footer should be left-aligned, and the page number should be on the left:\n\n```plain\n46 | lorem ipsum\n```\n\nI would like to set the displayed text differently on each page.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 140.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 418
    },
    {
      "id": 11412,
      "post_number": 2,
      "username": "aarnent",
      "name": "",
      "created_at": "2025-04-21T20:32:13.887Z",
      "updated_at": "2025-04-21T20:33:55.079Z",
      "cooked": "<p>You can set the <code>footer</code> to be a contextual expression and check for page parity manually, for example:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set page(\n  footer: context {\n    let val = counter(page).get().first()\n    if calc.even(val) [\n      #counter(page).display(\"1\") | #lorem(2)\n    ]\n    else [\n      #h(1fr) #lorem(4).slice(12, -1) | #counter(page).display(\"1\")\n    ]\n  },\n)\n</code></pre>",
      "raw": "You can set the `footer` to be a contextual expression and check for page parity manually, for example:\n\n```typst\n#set page(\n  footer: context {\n    let val = counter(page).get().first()\n    if calc.even(val) [\n      #counter(page).display(\"1\") | #lorem(2)\n    ]\n    else [\n      #h(1fr) #lorem(4).slice(12, -1) | #counter(page).display(\"1\")\n    ]\n  },\n)\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 10.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 501
    },
    {
      "id": 11413,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-21T21:51:08.733Z",
      "updated_at": "2025-04-21T21:51:08.733Z",
      "cooked": "<p>Sounds like a duplicate of <a href=\"https://forum.typst.app/t/how-to-combine-the-title-of-the-document-with-the-page-counter-in-the-footer/3496/7\" class=\"inline-onebox\">How to combine the title of the document with the page counter in the footer - #7 by sijo</a>, even though the main topic and solution are different. The question uses the same problem.</p>",
      "raw": "Sounds like a duplicate of https://forum.typst.app/t/how-to-combine-the-title-of-the-document-with-the-page-counter-in-the-footer/3496/7?u=andrew, even though the main topic and solution are different. The question uses the same problem.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 19.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11414,
      "post_number": 4,
      "username": "Olaf",
      "name": "Olaf",
      "created_at": "2025-04-21T22:22:40.333Z",
      "updated_at": "2025-04-21T22:22:40.333Z",
      "cooked": "<p>Thank you very much for your answer. It solves one half of my problem. The other part is that I want to place an additional text next to the page number. I would like to be able to redefine this text per page.</p>",
      "raw": "Thank you very much for your answer. It solves one half of my problem. The other part is that I want to place an additional text next to the page number. I would like to be able to redefine this text per page.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 9.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 418
    },
    {
      "id": 11415,
      "post_number": 5,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-04-21T22:40:50.113Z",
      "updated_at": "2025-04-21T22:53:06.158Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/olaf\">@Olaf</a> , is the text to set next to the page number a heading? Where is it coming from? Do you have an example to work with?</p>\n<p>Perhaps have a look at the Typst documentation to give you some ideas? Some hints: <a href=\"https://forum.typst.app/t/how-to-use-a-double-sided-document-layout/3743/2\" class=\"inline-onebox\">How to use a double-sided document layout? - #2 by vmartel08</a></p>\n<p>Both <a href=\"https://typst.app/universe/package/hydra\">hydra</a> and <a href=\"https://typst.app/universe/package/chic-hdr\">chic-hdr</a> packages may be doing what you are looking for.</p>",
      "raw": "@Olaf , is the text to set next to the page number a heading? Where is it coming from? Do you have an example to work with?\n\nPerhaps have a look at the Typst documentation to give you some ideas? Some hints: https://forum.typst.app/t/how-to-use-a-double-sided-document-layout/3743/2?u=vmartel08\n\nBoth [hydra](https://typst.app/universe/package/hydra) and [chic-hdr](https://typst.app/universe/package/chic-hdr) packages may be doing what you are looking for.",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 9.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 11435,
      "post_number": 6,
      "username": "Olaf",
      "name": "Olaf",
      "created_at": "2025-04-22T14:23:26.711Z",
      "updated_at": "2025-04-22T14:23:26.711Z",
      "cooked": "<p>The footer text should be defined individually for each page. I don’t know the best way to do this. Do you set a variable for this? Do you call a function?</p>\n<p>I’ve come this far now. The pseudo code is only intended to give you an idea of what I have in mind:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(\n  width: 10cm,\n  height: 5cm,\n  footer: context {\n    let footer-text = [footer-text]\n    let val = counter(page).get().first()\n    if calc.even(val) [\n      #counter(page).display(\"1\") | #footer-text\n    ]\n    else [\n      #h(1fr) #footer-text | #counter(page).display(\"1\")\n    ]\n  },\n)\n\n= Page 1\n\n// pseudo code:\n// footer-text = [footer text for page 1] \n\n#pagebreak()\n\n= Page 2\n\n// pseudo code:\n// footer-text = [footer text for page 2] \n</code></pre>",
      "raw": "The footer text should be defined individually for each page. I don't know the best way to do this. Do you set a variable for this? Do you call a function?\n\nI've come this far now. The pseudo code is only intended to give you an idea of what I have in mind:\n\n```typ\n#set page(\n  width: 10cm,\n  height: 5cm,\n  footer: context {\n    let footer-text = [footer-text]\n    let val = counter(page).get().first()\n    if calc.even(val) [\n      #counter(page).display(\"1\") | #footer-text\n    ]\n    else [\n      #h(1fr) #footer-text | #counter(page).display(\"1\")\n    ]\n  },\n)\n\n= Page 1\n\n// pseudo code:\n// footer-text = [footer text for page 1] \n\n#pagebreak()\n\n= Page 2\n\n// pseudo code:\n// footer-text = [footer text for page 2] \n```",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 418
    },
    {
      "id": 11436,
      "post_number": 7,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-04-22T14:39:18.344Z",
      "updated_at": "2025-04-22T14:42:28.956Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/olaf\">@Olaf</a>, there seems to be a pattern here. Are you going to use headings for that purpose?</p>\n<p>Perhaps you could inspire yourself with <a href=\"https://forum.typst.app/t/how-to-add-an-invisible-heading-to-an-outline/685\" class=\"inline-onebox\">How to add an invisible Heading to an outline?</a>, which has 2 good solutions for that, using either:</p>\n<ul>\n<li>a heading…\n<ul>\n<li>do you want to use one?</li>\n<li>perhaps you could use a hidden one?<br>\nor</li>\n</ul>\n</li>\n<li>a state variable.</li>\n</ul>\n<p>In any case, although you have provided a bit more insight, it is still unclear what means you would like to use, which would help suggesting a more complete solution… and avoid duplication.</p>",
      "raw": "@Olaf, there seems to be a pattern here. Are you going to use headings for that purpose?\n\nPerhaps you could inspire yourself with https://forum.typst.app/t/how-to-add-an-invisible-heading-to-an-outline/685, which has 2 good solutions for that, using either:\n- a heading...\n  - do you want to use one?\n  - perhaps you could use a hidden one?\nor\n- a state variable.\n\nIn any case, although you have provided a bit more insight, it is still unclear what means you would like to use, which would help suggesting a more complete solution... and avoid duplication.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 19,
      "score": 18.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 11437,
      "post_number": 8,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-04-22T15:16:30.606Z",
      "updated_at": "2025-04-22T15:25:45.711Z",
      "cooked": "<p>A working solution, which involves <code>state</code> (avoids using a heading, which would have been showing in the outline by default).</p>\n<details>\n<summary>\nCode (solution with `state`)</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// Example using state\n#let footer-text = state(\"footer-text\", \"oops we forgot to set the text\")\n\n#set page(\n  width: 10cm,\n  height: 5cm,\n  footer: context {\n    let val = counter(page).get().first()\n    if calc.even(val) [\n      #counter(page).display(\"1\") | #footer-text.get()\n    ] else [\n      #h(1fr) #footer-text.get() | #counter(page).display(\"1\")\n    ]\n  },\n)\n\n= Page 1\nThis page shows the default footer as we didn't set it.\n//#footer-text.update([footer *text* for page 1])\n\n#pagebreak()\n\n= Page 2\n#footer-text.update([footer _text_ for page 2])\n\n#pagebreak()\n\n= Page 3\n#footer-text.update([footer _text_ for page 3])\n\n#pagebreak()\n\n= Page 4\nThis page still shows the footer from page 3 because we forgot to change it. \n//#footer-text.update([footer _text_ for page 4])\n</code></pre>\n</details>\n<details>\n<summary>\nOutput</summary>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/4/424cb59e50137a84f75562c6b7e0ac7dcaf2940a.png\" data-download-href=\"https://forum.typst.app/uploads/default/424cb59e50137a84f75562c6b7e0ac7dcaf2940a\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/4/424cb59e50137a84f75562c6b7e0ac7dcaf2940a_2_332x500.png\" alt=\"image\" data-base62-sha1=\"9svRsBRKV1WWOUbKoEXXSkBs34m\" width=\"332\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/4/424cb59e50137a84f75562c6b7e0ac7dcaf2940a_2_332x500.png, https://forum.typst.app/uploads/default/optimized/2X/4/424cb59e50137a84f75562c6b7e0ac7dcaf2940a_2_498x750.png 1.5x, https://forum.typst.app/uploads/default/original/2X/4/424cb59e50137a84f75562c6b7e0ac7dcaf2940a.png 2x\" data-dominant-color=\"191919\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">556×836 27.9 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>",
      "raw": "A working solution, which involves `state` (avoids using a heading, which would have been showing in the outline by default).\n\n[details=\"Code (solution with `state`)\"]\n\n```typ\n// Example using state\n#let footer-text = state(\"footer-text\", \"oops we forgot to set the text\")\n\n#set page(\n  width: 10cm,\n  height: 5cm,\n  footer: context {\n    let val = counter(page).get().first()\n    if calc.even(val) [\n      #counter(page).display(\"1\") | #footer-text.get()\n    ] else [\n      #h(1fr) #footer-text.get() | #counter(page).display(\"1\")\n    ]\n  },\n)\n\n= Page 1\nThis page shows the default footer as we didn't set it.\n//#footer-text.update([footer *text* for page 1])\n\n#pagebreak()\n\n= Page 2\n#footer-text.update([footer _text_ for page 2])\n\n#pagebreak()\n\n= Page 3\n#footer-text.update([footer _text_ for page 3])\n\n#pagebreak()\n\n= Page 4\nThis page still shows the footer from page 3 because we forgot to change it. \n//#footer-text.update([footer _text_ for page 4])\n```\n[/details]\n\n[details=\"Output\"]\n![image|332x500](upload://9svRsBRKV1WWOUbKoEXXSkBs34m.png)\n\n[/details]",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 18,
      "score": 38.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 11451,
      "post_number": 9,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-22T20:20:25.046Z",
      "updated_at": "2025-04-22T20:21:37.705Z",
      "cooked": "<p>For <code>page</code> specifically, if no custom numbering is needed, it can be skipped in the <a href=\"https://typst.app/docs/reference/introspection/counter/#definitions-display-numbering\"><code>.display()</code></a>. For heading, you probably want something other than <code>\"1.1\"</code>, but the same thing applies.</p>",
      "raw": "For `page` specifically, if no custom numbering is needed, it can be skipped in the [`.display()`](https://typst.app/docs/reference/introspection/counter/#definitions-display-numbering). For heading, you probably want something other than `\"1.1\"`, but the same thing applies.",
      "reply_to_post_number": 8,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 18,
      "score": 18.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11456,
      "post_number": 10,
      "username": "Olaf",
      "name": "Olaf",
      "created_at": "2025-04-22T21:08:09.980Z",
      "updated_at": "2025-04-22T21:08:09.980Z",
      "cooked": "<p>Many thanks for your support. I have tweaked the solution a little more:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">\n#let footer-text = state(\"footer-text\", none)\n\n#let set-footer-text(content) = footer-text.update(content)\n\n#set page(\n  width: 10cm,\n  height: 4cm,\n  footer: context {\n    let text = footer-text.get()\n    footer-text.update(none)\n    let (page-num,) = counter(page).get()\n    let val = counter(page).get().first()\n\n    if calc.even(page-num) {\n      if text == none [\n        #counter(page).display(\"1\")\n      ] else [\n        #counter(page).display(\"1\") | #text\n      ]\n    } else {\n      if text == none [\n        #h(1fr) #counter(page).display(\"1\")\n      ] else [\n        #h(1fr) #text | #counter(page).display(\"1\")\n      ]\n    }\n  },\n)\n\n= Page 1\n\n#set-footer-text([footer text for page 1])\n\n#pagebreak()\n\n= Page 2\n\n#set-footer-text([footer text for page 2])\n\n#pagebreak()\n\n= Page 3\n\n#pagebreak()\n\n= Page 4\n\n#pagebreak()\n\n= Page 5\n\n#set-footer-text([footer text for page 5])\n</code></pre>",
      "raw": "Many thanks for your support. I have tweaked the solution a little more:\n\n```typ\n\n#let footer-text = state(\"footer-text\", none)\n\n#let set-footer-text(content) = footer-text.update(content)\n\n#set page(\n  width: 10cm,\n  height: 4cm,\n  footer: context {\n    let text = footer-text.get()\n    footer-text.update(none)\n    let (page-num,) = counter(page).get()\n    let val = counter(page).get().first()\n\n    if calc.even(page-num) {\n      if text == none [\n        #counter(page).display(\"1\")\n      ] else [\n        #counter(page).display(\"1\") | #text\n      ]\n    } else {\n      if text == none [\n        #h(1fr) #counter(page).display(\"1\")\n      ] else [\n        #h(1fr) #text | #counter(page).display(\"1\")\n      ]\n    }\n  },\n)\n\n= Page 1\n\n#set-footer-text([footer text for page 1])\n\n#pagebreak()\n\n= Page 2\n\n#set-footer-text([footer text for page 2])\n\n#pagebreak()\n\n= Page 3\n\n#pagebreak()\n\n= Page 4\n\n#pagebreak()\n\n= Page 5\n\n#set-footer-text([footer text for page 5])\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 19,
      "score": 23.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 418
    },
    {
      "id": 11462,
      "post_number": 11,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-22T21:50:48.441Z",
      "updated_at": "2025-04-22T21:50:48.441Z",
      "cooked": "<p>You can make it much simpler. There are also some variations that depend on the document structure.</p>\n<details><summary>code</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let footer-text = state(\"footer-text\")\n\n#let set-footer-text(content) = footer-text.update(content)\n\n#set page(\n  width: 10cm,\n  height: 4cm,\n  footer: context {\n    let text = footer-text.get()\n    footer-text.update(none)\n    // let page-num = here().page() // Physical page\n    let page-num = counter(page).get().first() // Logical page\n    // let num = counter(page).display(\"I\") // If custom numbering is needed.\n    if calc.even(page-num) {\n      text = if text != none [ | #text]\n      [#page-num#text]\n    } else {\n      text = if text != none [#text | ]\n      [#h(1fr)#text#page-num]\n    }\n  },\n)\n\n= Page 1\n\n#set-footer-text[footer text for page 1]\n\n#pagebreak()\n\n= Page 2\n\n#set-footer-text[footer text for page 2]\n\n#pagebreak()\n\n= Page 3\n\n#pagebreak()\n\n= Page 4\n\n#pagebreak()\n\n= Page 5\n\n#set-footer-text[footer text for page 5]\n</code></pre>\n</details>",
      "raw": "You can make it much simpler. There are also some variations that depend on the document structure.\n\n<details><summary>code</summary>\n\n```typ\n#let footer-text = state(\"footer-text\")\n\n#let set-footer-text(content) = footer-text.update(content)\n\n#set page(\n  width: 10cm,\n  height: 4cm,\n  footer: context {\n    let text = footer-text.get()\n    footer-text.update(none)\n    // let page-num = here().page() // Physical page\n    let page-num = counter(page).get().first() // Logical page\n    // let num = counter(page).display(\"I\") // If custom numbering is needed.\n    if calc.even(page-num) {\n      text = if text != none [ | #text]\n      [#page-num#text]\n    } else {\n      text = if text != none [#text | ]\n      [#h(1fr)#text#page-num]\n    }\n  },\n)\n\n= Page 1\n\n#set-footer-text[footer text for page 1]\n\n#pagebreak()\n\n= Page 2\n\n#set-footer-text[footer text for page 2]\n\n#pagebreak()\n\n= Page 3\n\n#pagebreak()\n\n= Page 4\n\n#pagebreak()\n\n= Page 5\n\n#set-footer-text[footer text for page 5]\n```\n\n</details>",
      "reply_to_post_number": 10,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 19,
      "score": 18.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:48:52.496903"
}
{
  "topic_metadata": {
    "id": 3753,
    "title": "How can i make a table cell pass each other?",
    "slug": "how-can-i-make-a-table-cell-pass-each-other",
    "posts_count": 7,
    "created_at": "2025-04-22T03:42:30.043Z",
    "last_posted_at": "2025-04-22T09:13:57.720Z",
    "views": 58,
    "like_count": 11,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "bluss",
    "tags": [
      "tables"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 527
  },
  "posts": [
    {
      "id": 11419,
      "post_number": 1,
      "username": "sumi",
      "name": "",
      "created_at": "2025-04-22T03:42:30.143Z",
      "updated_at": "2025-04-26T19:55:39.478Z",
      "cooked": "<p>i want a table like this except the last column.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#table(\n  columns: 3,\n  table.cell(rowspan: 2, \"a\"),\n  \"b\",\n  none,\n  table.cell(rowspan: 2, \"c\"),\n  none,\n  \"d\",\n  none,\n)\n</code></pre>\n<p>but when i delete the column, it becomes flat.</p>\n<pre><code class=\"lang-auto\">#table(\n  columns: 2,\n  table.cell(rowspan: 2, \"a\"),\n  \"b\",\n  table.cell(rowspan: 2, \"c\"),\n  \"d\",\n)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/8a35380330fec65bf27430cb2e7b478b293dc23f.png\" data-download-href=\"https://forum.typst.app/uploads/default/8a35380330fec65bf27430cb2e7b478b293dc23f\" title=\"Screenshot 2025-04-22 at 12.49.02\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/8a35380330fec65bf27430cb2e7b478b293dc23f_2_122x249.png\" alt=\"Screenshot 2025-04-22 at 12.49.02\" data-base62-sha1=\"jIDUwt2vp4gPNeEDlWXKQe3KL27\" width=\"122\" height=\"249\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/8/8a35380330fec65bf27430cb2e7b478b293dc23f_2_122x249.png, https://forum.typst.app/uploads/default/optimized/2X/8/8a35380330fec65bf27430cb2e7b478b293dc23f_2_183x373.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/8/8a35380330fec65bf27430cb2e7b478b293dc23f_2_244x498.png 2x\" data-dominant-color=\"DEDEDE\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2025-04-22 at 12.49.02</span><span class=\"informations\">456×930 28.8 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>how can i keep the step without an empty column?</p>\n<hr>\n<p>edit: just after posting this, i came up with making the width of the column 0.<br>\nif there’s a more concice solution, i’d like to know.</p>",
      "raw": "i want a table like this except the last column.\n\n```typ\n#table(\n  columns: 3,\n  table.cell(rowspan: 2, \"a\"),\n  \"b\",\n  none,\n  table.cell(rowspan: 2, \"c\"),\n  none,\n  \"d\",\n  none,\n)\n```\n\nbut when i delete the column, it becomes flat.\n\n```\n#table(\n  columns: 2,\n  table.cell(rowspan: 2, \"a\"),\n  \"b\",\n  table.cell(rowspan: 2, \"c\"),\n  \"d\",\n)\n```\n\n![Screenshot 2025-04-22 at 12.49.02|245x499, 50%](upload://jIDUwt2vp4gPNeEDlWXKQe3KL27.png)\n\nhow can i keep the step without an empty column?\n\n---\n\nedit: just after posting this, i came up with making the width of the column 0.\nif there's a more concice solution, i'd like to know.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 74.4,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1490
    },
    {
      "id": 11420,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-04-22T06:22:23.762Z",
      "updated_at": "2025-04-22T06:22:23.762Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/sumi\">@sumi</a>!<br>\nI am unaware of more practical solutions than setting a 0-width column at the end, because tables spanning works in a such a way that you require n+1 rows. The last example collapses because <code>a</code> or <code>c</code> cannot span two rows, since there are not enough.<br>\nIf you post your solution in response to your own topic, you will be able to mark it as a solution. I have no doubts someone is going to come and contradict me on this thought! So there might be an obvious solution I have missed.</p>",
      "raw": "Hello @sumi! \nI am unaware of more practical solutions than setting a 0-width column at the end, because tables spanning works in a such a way that you require n+1 rows. The last example collapses because `a` or `c` cannot span two rows, since there are not enough. \nIf you post your solution in response to your own topic, you will be able to mark it as a solution. I have no doubts someone is going to come and contradict me on this thought! So there might be an obvious solution I have missed.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 21,
      "score": 24.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 11421,
      "post_number": 3,
      "username": "sumi",
      "name": "",
      "created_at": "2025-04-22T06:49:37.170Z",
      "updated_at": "2025-04-22T06:51:46.575Z",
      "cooked": "<p>thanks for information!<br>\nsince 0-width column seems to be the only solution (for now), i’ll post it myself and mark as a solution.</p>",
      "raw": "thanks for information!\nsince 0-width column seems to be the only solution (for now), i'll post it myself and mark as a solution.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 4.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1490
    },
    {
      "id": 11422,
      "post_number": 4,
      "username": "sumi",
      "name": "",
      "created_at": "2025-04-22T06:50:50.406Z",
      "updated_at": "2025-04-22T06:51:06.911Z",
      "cooked": "<p>set the width of the empty column as 0.</p>",
      "raw": "set the width of the empty column as 0.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 21,
      "score": 19.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1490
    },
    {
      "id": 11423,
      "post_number": 5,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-22T08:45:05.706Z",
      "updated_at": "2025-04-22T08:55:07.972Z",
      "cooked": "<p>At first this seems puzzling, but then it’s clear that typst’s result with two columns is logical: the height of the second row is a free variable that can be set to zero because there is nothing that forces that row to be any higher than that.</p>\n<p>An alternate solution is to use defined row heights, so we give the otherwise vanishing second row a real height:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#table(\n  columns: 2,\n  rows: (auto, 2em, auto),\n  fill: (x, y) =&gt; blue.lighten(30% * y),\n  table.cell(rowspan: 2, \"a\"),\n  \"b\",\n  table.cell(rowspan: 2, \"c\"),\n  \"d\",\n)\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/1/1d2be0d6be3054928bf2417c438d41ce0f76cacc.png\" alt=\"bild\" data-base62-sha1=\"4a3R2dTOnOgfk6Oyz4FF6Sco7XC\" width=\"138\" height=\"216\"></p>\n<p>And just out of interest I colored the cells in blue shades by their row index <code>y</code> to see what it would say… below it shows that we have rows 0, 1, 2 also when collapsed:</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/d/d61796c59e968db4470689c5f34683417adbe9d3.png\" alt=\"bild\" data-base62-sha1=\"uxWIv7NLqG3F2nXjzT34FmdVIQ3\" width=\"122\" height=\"134\"></p>",
      "raw": "At first this seems puzzling, but then it's clear that typst's result with two columns is logical: the height of the second row is a free variable that can be set to zero because there is nothing that forces that row to be any higher than that.\n\nAn alternate solution is to use defined row heights, so we give the otherwise vanishing second row a real height:\n\n```typ\n#table(\n  columns: 2,\n  rows: (auto, 2em, auto),\n  fill: (x, y) => blue.lighten(30% * y),\n  table.cell(rowspan: 2, \"a\"),\n  \"b\",\n  table.cell(rowspan: 2, \"c\"),\n  \"d\",\n)\n```\n\n![bild|138x216](upload://4a3R2dTOnOgfk6Oyz4FF6Sco7XC.png)\n\nAnd just out of interest I colored the cells in blue shades by their row index `y` to see what it would say.. below it shows that we have rows 0, 1, 2 also when collapsed:\n\n![bild|122x134](upload://uxWIv7NLqG3F2nXjzT34FmdVIQ3.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 6,
      "reads": 20,
      "score": 124.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 11424,
      "post_number": 6,
      "username": "gezepi",
      "name": "",
      "created_at": "2025-04-22T09:08:57.141Z",
      "updated_at": "2025-04-22T09:09:51.490Z",
      "cooked": "<p>Depending on what kind of data you are trying to show, it’ possible that a table is not the best choice.  I’m imagining a situation where you have multiple columns, all with different ratios between the top row and bottom row.  Managing them with <code>rowspan</code> would become very difficult.<br>\nIn this case using <a href=\"https://typst.app/docs/reference/layout/stack/\"><code>stack()</code></a> would be a better fit:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">//Box with a fixed height so 1fr doesn't fill the rest of the page\n#box(\n  height: 5em,\n  stack(\n    dir: ltr,\n    //Column 1\n    table(\n      columns: 1,\n      rows: (2fr, 1fr),\n      \"a\",\n      \"d\",\n    ),\n    //Column 2\n    table(\n      columns: 1,\n      rows: (1fr, 2fr),\n      \"b\",\n      \"c\",\n    )\n    //Further columns would go here\n  )\n)\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/f/f1469f0cadaec110209ff23c329d50ba7ae76fb6.png\" alt=\"image\" data-base62-sha1=\"yqqniwRsTKqQnjuqLs3HXDcJWJM\" width=\"138\" height=\"231\"></p>\n<p>Unlike the other answers, this does require that the height be defined.</p>",
      "raw": "Depending on what kind of data you are trying to show, it' possible that a table is not the best choice.  I'm imagining a situation where you have multiple columns, all with different ratios between the top row and bottom row.  Managing them with `rowspan` would become very difficult.\nIn this case using [`stack()`](https://typst.app/docs/reference/layout/stack/) would be a better fit:\n```typ\n//Box with a fixed height so 1fr doesn't fill the rest of the page\n#box(\n  height: 5em,\n  stack(\n    dir: ltr,\n    //Column 1\n    table(\n      columns: 1,\n      rows: (2fr, 1fr),\n      \"a\",\n      \"d\",\n    ),\n    //Column 2\n    table(\n      columns: 1,\n      rows: (1fr, 2fr),\n      \"b\",\n      \"c\",\n    )\n    //Further columns would go here\n  )\n)\n```\n![image|138x231](upload://yqqniwRsTKqQnjuqLs3HXDcJWJM.png)\n\nUnlike the other answers, this does require that the height be defined.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 19,
      "score": 38.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 326
    },
    {
      "id": 11425,
      "post_number": 7,
      "username": "sumi",
      "name": "",
      "created_at": "2025-04-22T09:13:57.720Z",
      "updated_at": "2025-04-22T09:13:57.720Z",
      "cooked": "<p>i should’ve just set the height. i feel stupid…<br>\nalso i couldn’t come up with using stacks.</p>\n<p>thanks!</p>",
      "raw": "i should've just set the height. i feel stupid...\nalso i couldn't come up with using stacks.\n\nthanks!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 16,
      "score": 18.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1490
    }
  ],
  "scraped_at": "2025-06-10T09:48:51.736426"
}
