{
  "topic_metadata": {
    "id": 3391,
    "title": "How to align terms vertically in math mode?",
    "slug": "how-to-align-terms-vertically-in-math-mode",
    "posts_count": 2,
    "created_at": "2025-03-25T04:19:56.279Z",
    "last_posted_at": "2025-03-25T06:30:06.651Z",
    "views": 51,
    "like_count": 1,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "math",
      "alignment"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 193
  },
  "posts": [
    {
      "id": 10204,
      "post_number": 1,
      "username": "Abastro",
      "name": "JH L",
      "created_at": "2025-03-25T04:19:56.413Z",
      "updated_at": "2025-03-25T09:02:45.438Z",
      "cooked": "<p>Hello!<br>\nI would like to ask for a better alternative of an idiom I‚Äôve been using.</p>\n<p>To create the definition of a map with terms and arrows aligned as follows,</p>\n<pre><code class=\"lang-auto\">K * A * N -&gt; G\n(k, a, n) |-&gt; k a n\n</code></pre>\n<p>I often use <code>mat(delim: #none, ...)</code></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$\n  mat(\n      delim: #none,\n      K times A times N, -&gt;, G;\n      (k, a, n), mapsto, k a n;\n   )\n$\n</code></pre>\n<p>As you can see, it has some issues.</p>\n<ol>\n<li>Specifying <code>delim: #none</code> is rather verbose.</li>\n<li>This abuses <code>mat</code> for different purpose.<br>\nI wonder if there is more canonical or better way to achieve the alignment in math mode.<br>\nThanks in advance!</li>\n</ol>",
      "raw": "Hello!\nI would like to ask for a better alternative of an idiom I've been using.\n\nTo create the definition of a map with terms and arrows aligned as follows,\n```\nK * A * N -> G\n(k, a, n) |-> k a n\n```\nI often use `mat(delim: #none, ...)`\n```typ\n$\n  mat(\n      delim: #none,\n      K times A times N, ->, G;\n      (k, a, n), mapsto, k a n;\n   )\n$\n```\nAs you can see, it has some issues.\n1. Specifying `delim: #none` is rather verbose.\n2. This abuses `mat` for different purpose.\nI wonder if there is more canonical or better way to achieve the alignment in math mode.\nThanks in advance!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 74.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1385
    },
    {
      "id": 10208,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-25T06:30:06.651Z",
      "updated_at": "2025-03-25T06:30:46.350Z",
      "cooked": "<p>Hello. Welcome to the forum. There is a section about alignment in math mode: <a href=\"https://typst.app/docs/reference/math/#alignment\" class=\"inline-onebox\">Math ‚Äì Typst Documentation</a>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$\n  K times A times N &amp; -&gt; &amp; G \\\n  (k, a, n) &amp; |-&gt; &amp; k a n\n$\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/6/65ca85f017df1343e16aa92296ccfbcb319a60bb.png\" alt=\"image\" data-base62-sha1=\"ewu7XNnOxnYmJHFe2EKLcJQpoJt\" width=\"196\" height=\"63\"></p>\n<p>But if you need the ‚Äúcell‚Äù center alignment, I think <code>mat()</code> is your best bet. But you can simplify your example with a substitution:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// matrix align\n#let malign = math.mat.with(delim: none)\n\n$\n  malign(\n    K times A times N, -&gt;, G;\n    (k, a, n), |-&gt;, k a n;\n  )\n$\n</code></pre>",
      "raw": "Hello. Welcome to the forum. There is a section about alignment in math mode: https://typst.app/docs/reference/math/#alignment.\n\n```typ\n$\n  K times A times N & -> & G \\\n  (k, a, n) & |-> & k a n\n$\n```\n\n![image|262x85, 75%](upload://ewu7XNnOxnYmJHFe2EKLcJQpoJt.png)\n\nBut if you need the \"cell\" center alignment, I think `mat()` is your best bet. But you can simplify your example with a substitution:\n\n```typ\n// matrix align\n#let malign = math.mat.with(delim: none)\n\n$\n  malign(\n    K times A times N, ->, G;\n    (k, a, n), |->, k a n;\n  )\n$\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 23,
      "score": 19.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:50:03.868160"
}
{
  "topic_metadata": {
    "id": 3392,
    "title": "How to have more named spaces in math mode?",
    "slug": "how-to-have-more-named-spaces-in-math-mode",
    "posts_count": 7,
    "created_at": "2025-03-25T08:44:34.587Z",
    "last_posted_at": "2025-03-26T11:17:08.577Z",
    "views": 127,
    "like_count": 7,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "quachpas",
    "tags": [
      "math"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 455
  },
  "posts": [
    {
      "id": 10217,
      "post_number": 1,
      "username": "my4ng",
      "name": "Michael Yang",
      "created_at": "2025-03-25T08:44:34.704Z",
      "updated_at": "2025-03-25T09:31:32.345Z",
      "cooked": "<p>Currently there are only a few named spaces in math mode, namely: ‚Äú<code>thin</code> (1/6 em), <code>med</code> (2/9 em), <code>thick</code> (5/18 em), <code>quad</code> (1 em), <code>wide</code> (2 em)‚Äù. There is no variant between ~0.27em and 1em, which can be quite frustrating to layout sometimes. While additional spacings can be composed of the smaller units, I believe they should be provided by Typst by default, e.g. around 0.5em and 0.75em.</p>",
      "raw": "Currently there are only a few named spaces in math mode, namely: \"`thin` (1/6 em), `med` (2/9 em), `thick` (5/18 em), `quad` (1 em), `wide` (2 em)\". There is no variant between ~0.27em and 1em, which can be quite frustrating to layout sometimes. While additional spacings can be composed of the smaller units, I believe they should be provided by Typst by default, e.g. around 0.5em and 0.75em.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 40,
      "score": 258.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 592
    },
    {
      "id": 10218,
      "post_number": 2,
      "username": "Electron_Wizard",
      "name": "Electron Wizard",
      "created_at": "2025-03-25T09:08:20.496Z",
      "updated_at": "2025-03-25T09:08:20.496Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/my4ng\">@my4ng</a> ,<br>\nIt seems the named spacing defined reflect the Latex spacing:<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/e/e307c5e67977d0f6bc8d037416d758beeff03642.png\" alt=\"image\" data-base62-sha1=\"wop2rIVhfRiKF2ZhWChCGxc3O5Y\" width=\"563\" height=\"415\"></p>\n<p>as in:</p>\n<ul>\n<li><code>\\quad</code> = <code>quad</code></li>\n<li><code>\\,</code> = <code>thin</code></li>\n<li><code>\\:</code> = <code>med</code></li>\n<li><code>\\;</code> = <code>thick</code></li>\n<li><code>\\ </code> = <code>space</code></li>\n<li><code>\\qquad</code> = <code>wide</code></li>\n</ul>\n<p>What exactly do you wish to solve using the additional spaces (0.5em, 0.75em)?<br>\nDo you have an example, where you wish to use these spacings?</p>\n<hr>\n<p>Also, don‚Äôt forget to write the title as a question, since its the category‚Äôs guidelines (<a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">How to post in the Questions category - Questions - Typst Forum</a>)!</p>",
      "raw": "Hello @my4ng ,\nIt seems the named spacing defined reflect the Latex spacing:\n![image|563x415](upload://wop2rIVhfRiKF2ZhWChCGxc3O5Y.png)\n\nas in:\n- `\\quad` = `quad`\n- `\\,` = `thin`\n- `\\:` = `med`\n- `\\;` = `thick`\n- `\\ ` = `space`\n- `\\qquad` = `wide`\n\nWhat exactly do you wish to solve using the additional spaces (0.5em, 0.75em)?\nDo you have an example, where you wish to use these spacings?\n\n---\n\nAlso, don't forget to write the title as a question, since its the category's guidelines ([How to post in the Questions category - Questions - Typst Forum](https://forum.typst.app/t/how-to-post-in-the-questions-category/11))!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 40,
      "score": 33.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 997
    },
    {
      "id": 10219,
      "post_number": 3,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-03-25T09:10:08.769Z",
      "updated_at": "2025-03-25T09:38:11.047Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"my4ng\" data-post=\"1\" data-topic=\"3392\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/my4ng/48/880_2.png\" class=\"avatar\"> my4ng:</div>\n<blockquote>\n<p>I believe they should be provided by Typst by default, e.g. around 0.5em and 0.75em.</p>\n</blockquote>\n</aside>\n<p>You can always define variants in your document! If you would like to discuss whether more named spaces should be added by default, then you should probably reach out on Discord (maths forge), or open an issue directly on <a href=\"https://github.com/typst/typst/issues/\">https://github.com/typst/typst/issues/</a>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let double = h(0.5em)\n#let triple = h(0.75em)\n#table(\n  columns: 3,\n  align: left,\n  \"thin\", \"3/18em~0.16em\", $a thin b$,\n  \"med\", \"4/18em~0.22em\", $a med b$,\n  \"thick\", \"5/18em~0.27em\", $a thick b$,\n  \"double\", \"0.5em\", $a double b$,\n  \"triple\", \"0.75em\", $a triple b$,\n  \"quad\", \"1em\", $a quad b$,\n  \"wide\", \"2em\", $a wide b$,\n)\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/d/df8eb81679505474032c04c56074a6ec475b925e.png\" alt=\"image\" data-base62-sha1=\"vTGfvBiGVpAkQapmIFTHUVLBuQC\" width=\"307\" height=\"239\"></p>",
      "raw": "[quote=\"my4ng, post:1, topic:3392\"]\nI believe they should be provided by Typst by default, e.g. around 0.5em and 0.75em.\n[/quote]\n\nYou can always define variants in your document! If you would like to discuss whether more named spaces should be added by default, then you should probably reach out on Discord (maths forge), or open an issue directly on https://github.com/typst/typst/issues/.\n\n```typ\n#let double = h(0.5em)\n#let triple = h(0.75em)\n#table(\n  columns: 3,\n  align: left,\n  \"thin\", \"3/18em~0.16em\", $a thin b$,\n  \"med\", \"4/18em~0.22em\", $a med b$,\n  \"thick\", \"5/18em~0.27em\", $a thick b$,\n  \"double\", \"0.5em\", $a double b$,\n  \"triple\", \"0.75em\", $a triple b$,\n  \"quad\", \"1em\", $a quad b$,\n  \"wide\", \"2em\", $a wide b$,\n)\n```\n![image|307x239](upload://vTGfvBiGVpAkQapmIFTHUVLBuQC.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 1,
      "reads": 39,
      "score": 27.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 10222,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-25T09:53:59.844Z",
      "updated_at": "2025-03-25T09:54:12.283Z",
      "cooked": "<p>Here is a source file for all space variants available, in case you were wondering:</p>\n<aside class=\"onebox githubblob\" data-onebox-src=\"https://github.com/typst/codex/blob/38a0caa7d0a30d2138dc67a5b0aa7eeeb731e2ef/src/modules/sym.txt?plain=1#L9-L22\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/typst/codex/blob/38a0caa7d0a30d2138dc67a5b0aa7eeeb731e2ef/src/modules/sym.txt?plain=1#L9-L22\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/typst/codex/blob/38a0caa7d0a30d2138dc67a5b0aa7eeeb731e2ef/src/modules/sym.txt?plain=1#L9-L22\" target=\"_blank\" rel=\"noopener nofollow ugc\">typst/codex/blob/38a0caa7d0a30d2138dc67a5b0aa7eeeb731e2ef/src/modules/sym.txt?plain=1#L9-L22</a></h4>\n\n\n\n    <pre class=\"onebox\"><code class=\"lang-txt?plain=1\">\n      <ol class=\"start lines\" start=\"9\" style=\"counter-reset: li-counter 8 ;\">\n          <li>// Spaces.</li>\n          <li>space U+20</li>\n          <li>  .nobreak U+A0</li>\n          <li>  .nobreak.narrow U+202F</li>\n          <li>  .en U+2002</li>\n          <li>  .quad U+2003</li>\n          <li>  .third U+2004</li>\n          <li>  .quarter U+2005</li>\n          <li>  .sixth U+2006</li>\n          <li>  .med U+205F</li>\n          <li>  .fig U+2007</li>\n          <li>  .punct U+2008</li>\n          <li>  .thin U+2009</li>\n          <li>  .hair U+200A</li>\n      </ol>\n    </code></pre>\n\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "Here is a source file for all space variants available, in case you were wondering:\n\nhttps://github.com/typst/codex/blob/38a0caa7d0a30d2138dc67a5b0aa7eeeb731e2ef/src/modules/sym.txt?plain=1#L9-L22",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 37,
      "score": 12.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10252,
      "post_number": 5,
      "username": "my4ng",
      "name": "Michael Yang",
      "created_at": "2025-03-25T19:25:23.637Z",
      "updated_at": "2025-03-25T19:25:23.637Z",
      "cooked": "<p>Thanks for the detailed table. It just seemed odd that thin/med/thick are visually very similar and yet larger spaces are not available in maths mode. As <a class=\"mention\" href=\"/u/andrew\">@Andrew</a> pointed out, it seems en would be half an em (quad), third being 1/3 and quarter being (1/4), etc, but they are <em>not</em> available in math mode which is strange. I think I will ask around on discord first then. Thanks again!</p>",
      "raw": "Thanks for the detailed table. It just seemed odd that thin/med/thick are visually very similar and yet larger spaces are not available in maths mode. As @Andrew pointed out, it seems en would be half an em (quad), third being 1/3 and quarter being (1/4), etc, but they are _not_ available in math mode which is strange. I think I will ask around on discord first then. Thanks again!",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 31,
      "score": 26.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 592
    },
    {
      "id": 10253,
      "post_number": 6,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-25T19:36:22.719Z",
      "updated_at": "2025-03-25T19:36:22.719Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"my4ng\" data-post=\"5\" data-topic=\"3392\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/my4ng/48/880_2.png\" class=\"avatar\"> my4ng:</div>\n<blockquote>\n<p>but they are <em>not</em> available in math mode</p>\n</blockquote>\n</aside>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$space.third space.quarter$\n</code></pre>\n<p>I guess they are not as common to put them in the global scope in math mode.</p>",
      "raw": "[quote=\"my4ng, post:5, topic:3392\"]\nbut they are *not* available in math mode\n[/quote]\n\n```typ\n$space.third space.quarter$\n```\n\nI guess they are not as common to put them in the global scope in math mode.",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 3,
      "reads": 32,
      "score": 61.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10263,
      "post_number": 7,
      "username": "my4ng",
      "name": "Michael Yang",
      "created_at": "2025-03-26T11:17:08.577Z",
      "updated_at": "2025-03-26T11:17:08.577Z",
      "cooked": "<p>Uh huh! I did not know that, thank you!</p>",
      "raw": "Uh huh! I did not know that, thank you!",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 26,
      "score": 20.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 592
    }
  ],
  "scraped_at": "2025-06-10T09:50:03.127515"
}
{
  "topic_metadata": {
    "id": 3395,
    "title": "How can I save a coordinate in Cetz?",
    "slug": "how-can-i-save-a-coordinate-in-cetz",
    "posts_count": 9,
    "created_at": "2025-03-25T16:20:14.724Z",
    "last_posted_at": "2025-03-25T19:17:12.728Z",
    "views": 86,
    "like_count": 4,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 9,
    "accepted_answer_username": "Andrew",
    "tags": [],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 535
  },
  "posts": [
    {
      "id": 10231,
      "post_number": 1,
      "username": "Flavio",
      "name": "Flavio",
      "created_at": "2025-03-25T16:20:14.873Z",
      "updated_at": "2025-03-25T16:20:14.873Z",
      "cooked": "<p>I would like to achieve the equivalent of ‚Äúcoordinate‚Äù in Tikz. My goal is to save a coordinate (Eg. (5,0)) to a string (Eg. ‚Äúmy-cooord‚Äù) and use it later in the same canvas (Eg: line(‚Äúmy-coord‚Äù, (rel: (0,2))). I‚Äôve seen anchors, but to use them I have to use a group or at least a line end then I have to use dot notation (.start o .end) to retrieve the point. Thanks a lot!</p>",
      "raw": "I would like to achieve the equivalent of \"coordinate\" in Tikz. My goal is to save a coordinate (Eg. (5,0)) to a string (Eg. \"my-cooord\") and use it later in the same canvas (Eg: line(\"my-coord\", (rel: (0,2))). I've seen anchors, but to use them I have to use a group or at least a line end then I have to use dot notation (.start o .end) to retrieve the point. Thanks a lot!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 31,
      "score": 201.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 622
    },
    {
      "id": 10236,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2025-03-25T17:30:39.761Z",
      "updated_at": "2025-03-25T17:30:39.761Z",
      "cooked": "<p>I have no idea about Tikz, but based on your description I think you‚Äôre looking for variables <code>let var-name = ...</code>.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#cetz.canvas({\n  import cetz.draw: *\n  let my-coord = (5,0)\n  line(my-coord, (rel: (0,2)))\n})\n</code></pre>",
      "raw": "I have no idea about Tikz, but based on your description I think you're looking for variables `let var-name = ...`.\n\n```typst\n#cetz.canvas({\n  import cetz.draw: *\n  let my-coord = (5,0)\n  line(my-coord, (rel: (0,2)))\n})\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 11.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 10237,
      "post_number": 3,
      "username": "Flavio",
      "name": "Flavio",
      "created_at": "2025-03-25T17:35:09.882Z",
      "updated_at": "2025-03-25T17:35:09.882Z",
      "cooked": "<p>I want to save it in the context of the Cetz canvas, to use it later beacase I‚Äôm building a complex library, and I would like to rely on Cetz context instead of using states. Thanks anyway.</p>",
      "raw": "I want to save it in the context of the Cetz canvas, to use it later beacase I'm building a complex library, and I would like to rely on Cetz context instead of using states. Thanks anyway.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 11.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 622
    },
    {
      "id": 10238,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-25T17:36:13.684Z",
      "updated_at": "2025-03-25T17:36:13.684Z",
      "cooked": "<p>I see 2 way to solve this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n#cetz.canvas({\n  import cetz.draw: *\n  let my-coord = (0, 0)\n  circle(my-coord)\n  line(my-coord, (rel: (1, 2)), mark: (end: \"&gt;\"))\n\n  circle((5, 5), name: \"c\")\n  line(\"c\", (rel: (1, 2)), mark: (end: \"&gt;\"))\n})\n</code></pre>\n<p>Not sure what you mean by ‚Äúsave a coordinate to a string‚Äù.</p>",
      "raw": "I see 2 way to solve this:\n\n```typ\n#import \"@preview/cetz:0.3.4\"\n#cetz.canvas({\n  import cetz.draw: *\n  let my-coord = (0, 0)\n  circle(my-coord)\n  line(my-coord, (rel: (1, 2)), mark: (end: \">\"))\n\n  circle((5, 5), name: \"c\")\n  line(\"c\", (rel: (1, 2)), mark: (end: \">\"))\n})\n```\n\nNot sure what you mean by \"save a coordinate to a string\".",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 10.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10239,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-25T17:44:32.456Z",
      "updated_at": "2025-03-25T17:44:32.456Z",
      "cooked": "<p>I guess you can do this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n#cetz.canvas({\n  import cetz.draw: *\n  set-ctx(ctx =&gt; ctx + (my-coords: (\"my-coord\": (0, 0))))\n  get-ctx(ctx =&gt; {\n    let my-coord = ctx.my-coords.my-coord\n    circle(my-coord)\n    line(my-coord, (rel: (1, 2)), mark: (end: \"&gt;\"))\n  })\n\n  circle((5, 5), name: \"c\")\n  line(\"c\", (rel: (1, 2)), mark: (end: \"&gt;\"))\n})\n</code></pre>",
      "raw": "I guess you can do this:\n\n```typ\n#import \"@preview/cetz:0.3.4\"\n#cetz.canvas({\n  import cetz.draw: *\n  set-ctx(ctx => ctx + (my-coords: (\"my-coord\": (0, 0))))\n  get-ctx(ctx => {\n    let my-coord = ctx.my-coords.my-coord\n    circle(my-coord)\n    line(my-coord, (rel: (1, 2)), mark: (end: \">\"))\n  })\n\n  circle((5, 5), name: \"c\")\n  line(\"c\", (rel: (1, 2)), mark: (end: \">\"))\n})\n```",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 5.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10240,
      "post_number": 6,
      "username": "Flavio",
      "name": "Flavio",
      "created_at": "2025-03-25T17:53:15.677Z",
      "updated_at": "2025-03-25T17:53:15.677Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"4\" data-topic=\"3395\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>Not sure what you mean by ‚Äúsave a coordinate to a string‚Äù.</p>\n</blockquote>\n</aside>\n<p>I mean, to assign a string label to a point, like you have done in the circle with the attribute ‚Äúname‚Äù. Something that I can use later, like you have done in line. Maybe I can use a circle with radius zero as a workaround or use your solution that seems valid. Thanks a lot!</p>",
      "raw": "[quote=\"Andrew, post:4, topic:3395\"]\nNot sure what you mean by ‚Äúsave a coordinate to a string‚Äù.\n[/quote]\n\nI mean, to assign a string label to a point, like you have done in the circle with the attribute \"name\". Something that I can use later, like you have done in line. Maybe I can use a circle with radius zero as a workaround or use your solution that seems valid. Thanks a lot!",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 28,
      "score": 10.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 622
    },
    {
      "id": 10243,
      "post_number": 7,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-25T18:10:15.728Z",
      "updated_at": "2025-03-25T18:10:15.728Z",
      "cooked": "<p>You can‚Äôt assign ‚Äúa string label‚Äù to a raw point, because there are no labels and cetz doesn‚Äôt provide a way to ‚Äúsave a raw point‚Äù, unless you use the <code>set-ctx()</code> function, which I assume is basically the same as saving your stuff in tikz. You can however save object (shapes, groups, intersections) position by using the <code>name</code> argument. Then you can reference it, which defaults to the <code>.center</code> anchor. Or use the variables, which is also sometimes very useful, but I don‚Äôt think I use them.</p>",
      "raw": "You can't assign \"a string label\" to a raw point, because there are no labels and cetz doesn't provide a way to \"save a raw point\", unless you use the `set-ctx()` function, which I assume is basically the same as saving your stuff in tikz. You can however save object (shapes, groups, intersections) position by using the `name` argument. Then you can reference it, which defaults to the `.center` anchor. Or use the variables, which is also sometimes very useful, but I don't think I use them.",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 15.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10249,
      "post_number": 8,
      "username": "Flavio",
      "name": "Flavio",
      "created_at": "2025-03-25T19:06:36.730Z",
      "updated_at": "2025-03-25T19:06:36.730Z",
      "cooked": "<p>Thanks, you gave me the idea to assign a name to a point.</p>\n<pre><code>cetz.draw.circle(point, radius: 0, name: coordinate-name)\n</code></pre>\n<p>This works and emulate the ‚Äúcoordinate‚Äù function of Tikz.</p>",
      "raw": "Thanks, you gave me the idea to assign a name to a point.\n\n    cetz.draw.circle(point, radius: 0, name: coordinate-name)\n\nThis works and emulate the \"coordinate\" function of Tikz.",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 5.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 622
    },
    {
      "id": 10251,
      "post_number": 9,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-25T19:17:12.728Z",
      "updated_at": "2025-03-25T19:17:12.728Z",
      "cooked": "<p>Actually, I was wrong, you can use the <code>anchor()</code> function for this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n#cetz.canvas({\n  import cetz.draw: *\n  anchor(\"a\", (0, 0))\n  anchor(\"b\", (1, 1))\n  rect(\"a\", \"b\")\n})\n</code></pre>\n<p>I remembered this, probably because using a non-drawing circle to create a point is definitely not how you‚Äôre supposed to use the library, though you can.</p>",
      "raw": "Actually, I was wrong, you can use the `anchor()` function for this:\n\n```typ\n#import \"@preview/cetz:0.3.4\"\n#cetz.canvas({\n  import cetz.draw: *\n  anchor(\"a\", (0, 0))\n  anchor(\"b\", (1, 1))\n  rect(\"a\", \"b\")\n})\n```\n\nI remembered this, probably because using a non-drawing circle to create a point is definitely not how you're supposed to use the library, though you can.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 25,
      "score": 50.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:50:02.392219"
}
{
  "topic_metadata": {
    "id": 3398,
    "title": "How to set the Chinese font for use in spans within English text",
    "slug": "how-to-set-the-chinese-font-for-use-in-spans-within-english-text",
    "posts_count": 8,
    "created_at": "2025-03-25T17:54:39.064Z",
    "last_posted_at": "2025-03-26T13:07:29.499Z",
    "views": 78,
    "like_count": 3,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 476
  },
  "posts": [
    {
      "id": 10241,
      "post_number": 1,
      "username": "Mark_Hilton",
      "name": "Mark Hilton",
      "created_at": "2025-03-25T17:54:39.157Z",
      "updated_at": "2025-03-25T17:58:24.422Z",
      "cooked": "<p>Using Libertinus Serif as the base font of a document, in a string of inline Chinese characters, the first is rendered in some equivalent serif-type font, but subsequent characters are rendered in a non-serif type font (probably ‚ÄòPingFang SC‚Äô on Mac).</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/6/6c15af57d887e00883743787585be1ceef1fd0b3.png\" alt=\"SCR-20250325-piho\" data-base62-sha1=\"fqa1E7lxEAPP9owfREfMQ8fodX5\" width=\"614\" height=\"48\"></p>\n<p>How can I create a rule to ensure that all Chinese characters are rendered in an appropriate given font like Songti SC?</p>\n<p>Thanks</p>",
      "raw": "Using Libertinus Serif as the base font of a document, in a string of inline Chinese characters, the first is rendered in some equivalent serif-type font, but subsequent characters are rendered in a non-serif type font (probably 'PingFang SC' on Mac).\n\n![SCR-20250325-piho|614x48](upload://fqa1E7lxEAPP9owfREfMQ8fodX5.png)\n\nHow can I create a rule to ensure that all Chinese characters are rendered in an appropriate given font like Songti SC?\n\nThanks",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 180.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 1276
    },
    {
      "id": 10244,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-25T18:17:39.878Z",
      "updated_at": "2025-03-25T18:17:39.878Z",
      "cooked": "<p>I think you want something like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set text(font: (\"Songti SC\", (name: \"Libertinus Serif\", covers: \"latin-in-cjk\")))\n</code></pre>\n<p>That is, if your main document language is Chinese.</p>\n<p>Otherwise, I think this should work:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set text(font: (\"Libertinus Serif\", \"Songti SC\"), fallback: false)\n</code></pre>\n<p>The <code>fallback: true</code> will ensure that no other font is used, but this could potentially mean that some characters will not be displayed.</p>\n<p><a href=\"https://typst.app/docs/reference/text/text/#parameters-font\"><code>text.font</code></a></p>",
      "raw": "I think you want something like this:\n\n```typ\n#set text(font: (\"Songti SC\", (name: \"Libertinus Serif\", covers: \"latin-in-cjk\")))\n```\n\nThat is, if your main document language is Chinese.\n\nOtherwise, I think this should work:\n\n```typ\n#set text(font: (\"Libertinus Serif\", \"Songti SC\"), fallback: false)\n```\n\nThe `fallback: true` will ensure that no other font is used, but this could potentially mean that some characters will not be displayed.\n\n[`text.font`](https://typst.app/docs/reference/text/text/#parameters-font)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 19.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10247,
      "post_number": 3,
      "username": "Mark_Hilton",
      "name": "Mark Hilton",
      "created_at": "2025-03-25T18:49:00.067Z",
      "updated_at": "2025-03-25T18:49:00.067Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"2\" data-topic=\"3398\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p><code>#set text(font: (\"Libertinus Serif\", \"Songti SC\"), fallback: false)</code></p>\n</blockquote>\n</aside>\n<p>Thanks. My main document language is English, but your alternative fails because the Web app, which I‚Äôm using at the moment, doesn‚Äôt recognise Songti SC,</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/c/c332957fe8cb19d72c972d1051176e36c8fc91cd.png\" data-download-href=\"https://forum.typst.app/uploads/default/c332957fe8cb19d72c972d1051176e36c8fc91cd\" title=\"SCR-20250325-qipn\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/c/c332957fe8cb19d72c972d1051176e36c8fc91cd_2_690x123.png\" alt=\"SCR-20250325-qipn\" data-base62-sha1=\"rQNtUqvfwE8TPDxwIOODtdbQD49\" width=\"690\" height=\"123\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/c/c332957fe8cb19d72c972d1051176e36c8fc91cd_2_690x123.png, https://forum.typst.app/uploads/default/original/2X/c/c332957fe8cb19d72c972d1051176e36c8fc91cd.png 1.5x, https://forum.typst.app/uploads/default/original/2X/c/c332957fe8cb19d72c972d1051176e36c8fc91cd.png 2x\" data-dominant-color=\"F3EFED\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">SCR-20250325-qipn</span><span class=\"informations\">784√ó140 26.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>but if I replace ‚ÄúSongti SC‚Äù with ‚ÄúNoto Serif CJK SC‚Äù it works. I found reference to that in the documentation, so thank you for your help.</p>",
      "raw": "[quote=\"Andrew, post:2, topic:3398\"]\n`#set text(font: (\"Libertinus Serif\", \"Songti SC\"), fallback: false)`\n[/quote]\nThanks. My main document language is English, but your alternative fails because the Web app, which I'm using at the moment, doesn't recognise Songti SC,\n\n![SCR-20250325-qipn|690x123](upload://rQNtUqvfwE8TPDxwIOODtdbQD49.png)\n\nbut if I replace \"Songti SC\" with \"Noto Serif CJK SC\" it works. I found reference to that in the documentation, so thank you for your help.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 1,
      "reads": 24,
      "score": 24.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 1276
    },
    {
      "id": 10248,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-25T19:00:45.634Z",
      "updated_at": "2025-03-25T19:00:45.634Z",
      "cooked": "<p>You can always bring your fonts (files) with you into the project. It will pick them up.</p>",
      "raw": "You can always bring your fonts (files) with you into the project. It will pick them up.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 9.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10255,
      "post_number": 5,
      "username": "Mark_Hilton",
      "name": "Mark Hilton",
      "created_at": "2025-03-25T22:32:19.836Z",
      "updated_at": "2025-03-25T22:32:19.836Z",
      "cooked": "<p>Thanks again. Actually Noto Serif CJK SC works very well, so I‚Äôll stick with that for the web app. I have installed it on my computer, so I can use it for other purposes too.</p>",
      "raw": "Thanks again. Actually Noto Serif CJK SC works very well, so I'll stick with that for the web app. I have installed it on my computer, so I can use it for other purposes too.",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 9.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 1276
    },
    {
      "id": 10259,
      "post_number": 6,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-26T10:30:14.352Z",
      "updated_at": "2025-03-26T10:30:14.352Z",
      "cooked": "<p>I use Noto CJK fonts because it‚Äôs the most popular FOSS fonts. But I know from a small experience that natives use some other fonts, maybe some standard fonts in some OS.</p>",
      "raw": "I use Noto CJK fonts because it's the most popular FOSS fonts. But I know from a small experience that natives use some other fonts, maybe some standard fonts in some OS.",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10271,
      "post_number": 7,
      "username": "Mark_Hilton",
      "name": "Mark Hilton",
      "created_at": "2025-03-26T12:44:34.467Z",
      "updated_at": "2025-03-26T12:44:34.467Z",
      "cooked": "<p>I am native English, though have worked with Chinese for many years. Songti SC is standard on recent Mac OS‚Äôs, though the default SC font is PingFang SC, a sort of Helvetica equivalent which I don‚Äôt like. I don‚Äôt know the copyright status of Songti SC. I have recently moved to using to FOSS fonts, particularly Libertinus Serif for most texts, so Noto Serif CJK suits me fine for where I need Chinese, and it looks good with Libertinus Serif.</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/d/dfe6faa6782caac2b75fa9ba73e6184e74414d00.png\" alt=\"SCR-20250326-lkzw\" data-base62-sha1=\"vWJlto8Dx5GpUfOM0cgTJZkuDks\" width=\"624\" height=\"52\"></p>\n<p>I work with a Windows-based Chinese collaborator so anything shared with her has whatever is standard on our machines with automatic substitution where necessary.</p>",
      "raw": "I am native English, though have worked with Chinese for many years. Songti SC is standard on recent Mac OS's, though the default SC font is PingFang SC, a sort of Helvetica equivalent which I don't like. I don't know the copyright status of Songti SC. I have recently moved to using to FOSS fonts, particularly Libertinus Serif for most texts, so Noto Serif CJK suits me fine for where I need Chinese, and it looks good with Libertinus Serif.\n\n![SCR-20250326-lkzw|624x52](upload://vWJlto8Dx5GpUfOM0cgTJZkuDks.png)\n\n\nI work with a Windows-based Chinese collaborator so anything shared with her has whatever is standard on our machines with automatic substitution where necessary.",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 15,
      "score": 8.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 1276
    },
    {
      "id": 10277,
      "post_number": 8,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-26T13:07:29.499Z",
      "updated_at": "2025-03-26T13:07:29.499Z",
      "cooked": "<p>I will mention that Typst fully embeds a font subset into the PDF document, unlike some other tools. So PDF viewer will never substitute the embedded fonts. This is such a big plus for portability and ability to print anything through any OS (without text issues).</p>",
      "raw": "I will mention that Typst fully embeds a font subset into the PDF document, unlike some other tools. So PDF viewer will never substitute the embedded fonts. This is such a big plus for portability and ability to print anything through any OS (without text issues).",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 14,
      "score": 32.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:50:01.617659"
}
{
  "topic_metadata": {
    "id": 3399,
    "title": "How to create a function that knows how many times it has been called, without returning content value?",
    "slug": "how-to-create-a-function-that-knows-how-many-times-it-has-been-called-without-returning-content-value",
    "posts_count": 3,
    "created_at": "2025-03-25T18:03:37.355Z",
    "last_posted_at": "2025-03-26T05:15:06.137Z",
    "views": 48,
    "like_count": 4,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 216
  },
  "posts": [
    {
      "id": 10242,
      "post_number": 1,
      "username": "Pakorn",
      "name": "Pakorn",
      "created_at": "2025-03-25T18:03:37.456Z",
      "updated_at": "2025-03-25T18:03:37.456Z",
      "cooked": "<p>It is like a <code>get</code> method in counter but does not return content. The use case of this is I want to implement a function use along with cetz package in the environment of <code>canvas</code> function. Since <code>canvas</code> only accepts array type, I cannot use <code>context</code> to get my counter values. I can think of two ways: manually update a local variable and make my function to read the value every times it has been called, or create a function that utilize the <code>ctx</code> of cetz context. Both ways are <em>very</em> complex, the first one is tedious to type every time I call that function, the latter requires update the definition of the function if the internal of <code>cetz</code> changes their syntax. How I can do this?</p>",
      "raw": "It is like a `get` method in counter but does not return content. The use case of this is I want to implement a function use along with cetz package in the environment of `canvas` function. Since `canvas` only accepts array type, I cannot use `context` to get my counter values. I can think of two ways: manually update a local variable and make my function to read the value every times it has been called, or create a function that utilize the `ctx` of cetz context. Both ways are *very* complex, the first one is tedious to type every time I call that function, the latter requires update the definition of the function if the internal of `cetz` changes their syntax. How I can do this?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 25.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 819
    },
    {
      "id": 10245,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-25T18:21:12.623Z",
      "updated_at": "2025-03-25T18:26:36.818Z",
      "cooked": "<p>Sounds very close to what was asked just a few hours ago: <a href=\"https://forum.typst.app/t/how-can-i-save-a-coordinate-in-cetz/3395\" class=\"inline-onebox\">How can I save a coordinate in Cetz?</a>.</p>\n<p>Something like this?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n#cetz.canvas({\n  import cetz.draw: *\n  let func(pos) = {\n    set-ctx(ctx =&gt; ctx + (my-func: ctx.at(\"my-func\", default: 0) + 1))\n    circle(pos)\n    get-ctx(ctx =&gt; content(())[#ctx.my-func])\n  }\n  func((0, 0))\n  func((3, 0))\n})\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/7/781a9a0d620a48183e0e7d92e6c58db13997c816.png\" alt=\"image\" data-base62-sha1=\"h8ui0ABZMOaP7u9kAYK6GZwtQCq\" width=\"215\" height=\"104\"></p>",
      "raw": "Sounds very close to what was asked just a few hours ago: https://forum.typst.app/t/how-can-i-save-a-coordinate-in-cetz/3395.\n\nSomething like this?\n\n```typ\n#import \"@preview/cetz:0.3.4\"\n#cetz.canvas({\n  import cetz.draw: *\n  let func(pos) = {\n    set-ctx(ctx => ctx + (my-func: ctx.at(\"my-func\", default: 0) + 1))\n    circle(pos)\n    get-ctx(ctx => content(())[#ctx.my-func])\n  }\n  func((0, 0))\n  func((3, 0))\n})\n```\n\n![image|215x104](upload://h8ui0ABZMOaP7u9kAYK6GZwtQCq.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 26,
      "score": 65.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10256,
      "post_number": 3,
      "username": "Pakorn",
      "name": "Pakorn",
      "created_at": "2025-03-26T05:15:06.137Z",
      "updated_at": "2025-03-26T05:15:06.137Z",
      "cooked": "<p>Ah I see, that‚Äôs how <code>set-ctx</code> interaction works. Thank You.</p>",
      "raw": "Ah I see, that's how `set-ctx` interaction works. Thank You.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 18.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 819
    }
  ],
  "scraped_at": "2025-06-10T09:50:00.878400"
}
{
  "topic_metadata": {
    "id": 3403,
    "title": "For making templates, should we use normal repository or template repository? And which would be best?",
    "slug": "for-making-templates-should-we-use-normal-repository-or-template-repository-and-which-would-be-best",
    "posts_count": 5,
    "created_at": "2025-03-26T10:59:31.686Z",
    "last_posted_at": "2025-03-26T15:14:48.037Z",
    "views": 59,
    "like_count": 1,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "vmartel08",
    "tags": [
      "templates"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 234
  },
  "posts": [
    {
      "id": 10262,
      "post_number": 1,
      "username": "ertugruluyar",
      "name": "Ertuƒürul Uyar",
      "created_at": "2025-03-26T10:59:31.833Z",
      "updated_at": "2025-03-26T10:59:31.833Z",
      "cooked": "<p><a href=\"https://docs.github.com/en/repositories/creating-and-managing-repositories/creating-a-repository-from-a-template#about-repository-templates\" rel=\"noopener nofollow ugc\">About repository templates heading in GitHub Docs</a> link, they give some differences between normal repository and template repository.</p>\n<p>I want to provide to user an option that user can use this template locally also.<br>\nI couldn‚Äôt decide what to do, which would be good?</p>",
      "raw": "[About repository templates heading in GitHub Docs](https://docs.github.com/en/repositories/creating-and-managing-repositories/creating-a-repository-from-a-template#about-repository-templates) link, they give some differences between normal repository and template repository. \n\nI want to provide to user an option that user can use this template locally also.\nI couldn't decide what to do, which would be good?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 46.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1389
    },
    {
      "id": 10266,
      "post_number": 2,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-03-26T11:56:58.779Z",
      "updated_at": "2025-03-26T11:56:58.779Z",
      "cooked": "<p>Hi there. Welcome to the forum.</p>\n<p>Unless you have very specific needs (which would require you to describe your issue in more details), there should be no need to create a GitHub Template Repository, assuming that you want to publish a Typst Template into a GitHub Repository.</p>\n<p>You should really specify which kind of Template you are referring to‚Ä¶ Typst or GitHub Repo.</p>\n<p>I would go with normal <img src=\"https://forum.typst.app/images/emoji/apple/sweat_smile.png?v=12\" title=\":sweat_smile:\" class=\"emoji\" alt=\":sweat_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hi there. Welcome to the forum. \n\nUnless you have very specific needs (which would require you to describe your issue in more details), there should be no need to create a GitHub Template Repository, assuming that you want to publish a Typst Template into a GitHub Repository. \n\nYou should really specify which kind of Template you are referring to‚Ä¶ Typst or GitHub Repo. \n\nI would go with normal üòÖ",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 27,
      "score": 30.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 10280,
      "post_number": 3,
      "username": "ertugruluyar",
      "name": "Ertuƒürul Uyar",
      "created_at": "2025-03-26T13:51:18.883Z",
      "updated_at": "2025-03-26T13:51:18.883Z",
      "cooked": "<p>Hi, thank you. I am developing a thesis Typst template. When I saw the option in GitHub repo settings, I wonder which one would be better fit for user also be able to use this template locally.<br>\nI am gonna share the template in Typst Universe also, of course.</p>",
      "raw": "Hi, thank you. I am developing a thesis Typst template. When I saw the option in GitHub repo settings, I wonder which one would be better fit for user also be able to use this template locally.\nI am gonna share the template in Typst Universe also, of course.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 9.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1389
    },
    {
      "id": 10283,
      "post_number": 4,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-03-26T14:16:31.483Z",
      "updated_at": "2025-03-26T14:16:31.483Z",
      "cooked": "<p>Definitely normal repository then. The other option would allow GitHub users to create a GitHub repository using your repository as a template, where they don‚Äôt need to as all they require is obtain your Typst template.</p>\n<p>Good luck and come back should you need more info <img src=\"https://forum.typst.app/images/emoji/apple/sunglasses.png?v=12\" title=\":sunglasses:\" class=\"emoji\" alt=\":sunglasses:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Definitely normal repository then. The other option would allow GitHub users to create a GitHub repository using your repository as a template, where they don‚Äôt need to as all they require is obtain your Typst template. \n\nGood luck and come back should you need more info üòé",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 9.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 10289,
      "post_number": 5,
      "username": "ertugruluyar",
      "name": "Ertuƒürul Uyar",
      "created_at": "2025-03-26T15:14:48.037Z",
      "updated_at": "2025-03-26T15:14:48.037Z",
      "cooked": "<p>Thank you. Have a nice day.</p>",
      "raw": "Thank you. Have a nice day.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 4.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1389
    }
  ],
  "scraped_at": "2025-06-10T09:50:00.179814"
}
{
  "topic_metadata": {
    "id": 3408,
    "title": "How to customize codly raw blocks?",
    "slug": "how-to-customize-codly-raw-blocks",
    "posts_count": 10,
    "created_at": "2025-03-26T12:26:17.251Z",
    "last_posted_at": "2025-03-28T15:01:19.529Z",
    "views": 111,
    "like_count": 3,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "Dherse",
    "tags": [
      "codly"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 789
  },
  "posts": [
    {
      "id": 10269,
      "post_number": 1,
      "username": "maxigaz",
      "name": "maxigaz",
      "created_at": "2025-03-26T12:26:17.396Z",
      "updated_at": "2025-03-26T12:58:06.279Z",
      "cooked": "<p>I recently asked the question <a href=\"https://forum.typst.app/t/how-can-i-include-user-privilege-indicators-in-shell-prompts-while-keeping-syntax-highlighting-enabled-in-codeblocks/3382\">How can I include user privilege indicators in shell prompts while keeping syntax highlighting enabled in codeblocks?</a> The solution I recieved works well for regular raw blocks. My question is, how can I apply it to <a href=\"https://typst.app/universe/package/codly\">codly</a>?</p>\n<p>To recap, I would like to place <code>$</code> or <code>#</code> at the beginning of Linux shell prompt snippets while keeping syntax highlighting, like so:</p>\n<pre data-code-wrap=\"console\"><code class=\"lang-console\">$ chmod test.sh\n# chown user test.sh\n</code></pre>\n<p>Currently, when I try the show rule included in the answer, it seems to disable codly‚Äôs formatting for subsequent raw blocks.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">\n#import \"@preview/codly:1.2.0\": *\n#import \"@preview/codly-languages:0.1.1\": *\n#show: codly-init.with()\n\nBefore applying custom show rule:\n\n```console\n$ chmod test.sh\n# chown user test.sh\n```\n\n#show raw: set text(font: \"DejaVu Sans Mono\", size: 1.11em)\n#show raw.where(lang: \"console\"): it =&gt; {\n  let user = emph(raw(\"$ \"))\n  let root = emph(raw(\"# \"))\n  it\n    .text\n    .split(\"\\n\")\n    .map(line =&gt; {\n      let starts(pattern) = line.starts-with(pattern)\n      let prefix = if starts(\"$ \") { user } else if starts(\"# \") { root }\n      let text = line.replace(regex(\"^[$#] \"), \"\")\n      prefix + raw(text, lang: \"sh\")\n    })\n    .join(\"\\n\")\n}\n\nAfter applying custom show rule:\n\n```console\n$ chmod test.sh\n# chown user test.sh\n```\n</code></pre>\n<details>\n<summary>\nScreenshot</summary>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/e/ec5ef882371d4615183762503c13409c4094fd0e.png\" data-download-href=\"https://forum.typst.app/uploads/default/ec5ef882371d4615183762503c13409c4094fd0e\" title=\"typst-raw-original-v-codly\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/e/ec5ef882371d4615183762503c13409c4094fd0e_2_690x260.png\" alt=\"typst-raw-original-v-codly\" data-base62-sha1=\"xJ29J5CwqVv6YlULoJPVJ4IPlym\" width=\"690\" height=\"260\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/e/ec5ef882371d4615183762503c13409c4094fd0e_2_690x260.png, https://forum.typst.app/uploads/default/original/2X/e/ec5ef882371d4615183762503c13409c4094fd0e.png 1.5x, https://forum.typst.app/uploads/default/original/2X/e/ec5ef882371d4615183762503c13409c4094fd0e.png 2x\" data-dominant-color=\"F6F6F6\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">typst-raw-original-v-codly</span><span class=\"informations\">719√ó271 28.9 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>",
      "raw": "I recently asked the question [How can I include user privilege indicators in shell prompts while keeping syntax highlighting enabled in codeblocks?](https://forum.typst.app/t/how-can-i-include-user-privilege-indicators-in-shell-prompts-while-keeping-syntax-highlighting-enabled-in-codeblocks/3382) The solution I recieved works well for regular raw blocks. My question is, how can I apply it to [codly](https://typst.app/universe/package/codly)?\n\nTo recap, I would like to place `$` or `#` at the beginning of Linux shell prompt snippets while keeping syntax highlighting, like so:\n\n```console\n$ chmod test.sh\n# chown user test.sh\n```\n\nCurrently, when I try the show rule included in the answer, it seems to disable codly's formatting for subsequent raw blocks.\n\n~~~typ\n\n#import \"@preview/codly:1.2.0\": *\n#import \"@preview/codly-languages:0.1.1\": *\n#show: codly-init.with()\n\nBefore applying custom show rule:\n\n```console\n$ chmod test.sh\n# chown user test.sh\n```\n\n#show raw: set text(font: \"DejaVu Sans Mono\", size: 1.11em)\n#show raw.where(lang: \"console\"): it => {\n  let user = emph(raw(\"$ \"))\n  let root = emph(raw(\"# \"))\n  it\n    .text\n    .split(\"\\n\")\n    .map(line => {\n      let starts(pattern) = line.starts-with(pattern)\n      let prefix = if starts(\"$ \") { user } else if starts(\"# \") { root }\n      let text = line.replace(regex(\"^[$#] \"), \"\")\n      prefix + raw(text, lang: \"sh\")\n    })\n    .join(\"\\n\")\n}\n\nAfter applying custom show rule:\n\n```console\n$ chmod test.sh\n# chown user test.sh\n```\n~~~\n\n[details=\"Screenshot\"]\n![typst-raw-original-v-codly|690x260](upload://xJ29J5CwqVv6YlULoJPVJ4IPlym.png)\n[/details]",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 41,
      "score": 138.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 738
    },
    {
      "id": 10292,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-26T16:05:15.655Z",
      "updated_at": "2025-03-26T16:07:21.466Z",
      "cooked": "<p>Yeah, I think Codly is not meant to be used with custom raw show rules. I also had an issue when I tried to do similar stuff. I even tried using <code>__codly-raw</code>, but it doesn‚Äôt work, because it‚Äôs meant to be use on raw element and not any content, like in the custom show rule you show. So I think you‚Äôre better off recreating parts of Codly yourself or finding other packages. showybox is good. Initially I hand-rolled my frame and layout, but it was absolutely horribly written, so at some point I switched to showybox, but it was still messy, so I finally just switched to Codly, and I like it.</p>\n<p>You can open an issue in its repository and ask if there can be a solution for this.</p>",
      "raw": "Yeah, I think Codly is not meant to be used with custom raw show rules. I also had an issue when I tried to do similar stuff. I even tried using `__codly-raw`, but it doesn't work, because it's meant to be use on raw element and not any content, like in the custom show rule you show. So I think you're better off recreating parts of Codly yourself or finding other packages. showybox is good. Initially I hand-rolled my frame and layout, but it was absolutely horribly written, so at some point I switched to showybox, but it was still messy, so I finally just switched to Codly, and I like it.\n\nYou can open an issue in its repository and ask if there can be a solution for this.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 40,
      "score": 13.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10360,
      "post_number": 3,
      "username": "maxigaz",
      "name": "maxigaz",
      "created_at": "2025-03-28T12:31:10.862Z",
      "updated_at": "2025-03-28T12:31:10.862Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/dherse\">@Dherse</a> (I hope you don‚Äôt mind getting pinged here): Do you have any suggestions about this issue?</p>",
      "raw": "@Dherse (I hope you don't mind getting pinged here): Do you have any suggestions about this issue?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 6.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 738
    },
    {
      "id": 10362,
      "post_number": 4,
      "username": "Dherse",
      "name": "S√©bastien d'Herbais de Thun",
      "created_at": "2025-03-28T13:36:59.175Z",
      "updated_at": "2025-03-28T13:36:59.175Z",
      "cooked": "<p>I like the idea actually, I am thinking of adding a ‚Äútransformer‚Äù API to allow people to ‚Äútransform‚Äù content, but I don‚Äôt know how and where to include it. The problem of your show rule is that it does not produce a new raw block. You should use raw line show rules: <a href=\"https://typst.app/project/rAjWZKSZFgdcjtjIZeSrDY\" class=\"inline-onebox\">Typst</a></p>",
      "raw": "I like the idea actually, I am thinking of adding a \"transformer\" API to allow people to \"transform\" content, but I don't know how and where to include it. The problem of your show rule is that it does not produce a new raw block. You should use raw line show rules: https://typst.app/project/rAjWZKSZFgdcjtjIZeSrDY",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 35.6,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 137
    },
    {
      "id": 10363,
      "post_number": 5,
      "username": "maxigaz",
      "name": "maxigaz",
      "created_at": "2025-03-28T13:55:31.758Z",
      "updated_at": "2025-03-28T14:05:47.454Z",
      "cooked": "<p>Thank you for your reply (and also for this wonderful package)!</p>\n<p>I would like to use syntax highlighting that is normally applied for the <code>lang</code> setting <code>sh</code> (except it should be isolated from  <code>$</code> and <code>#</code>).</p>\n<p>When I try editing the project you shared on my machine in order to achieve that, I get the error <code>maximum show rule depth exceeded</code>. I modified line 24 like so:</p>\n<pre data-code-wrap=\"diff\"><code class=\"lang-diff\">  #show raw: set text(font: \"DejaVu Sans Mono\", size: 1.11em)\n  #show raw.where(lang: \"console\"): it =&gt; {\n    show raw.line: it =&gt; {\n      let user = emph((\"$ \"))\n      let root = emph((\"# \"))\n      it\n        .text\n        .split(\"\\n\")\n        .map(line =&gt; {\n          let starts(pattern) = line.starts-with(pattern)\n          let prefix = if starts(\"$ \") { user } else if starts(\"# \") { root }\n          let text = line.replace(regex(\"^[$#] \"), \"\")\n-         prefix + text\n+         prefix + raw(text, lang: \"sh\")\n        })\n        .join(\"\\n\")\n    }\n    it\n  }\n</code></pre>",
      "raw": "Thank you for your reply (and also for this wonderful package)!\n\nI would like to use syntax highlighting that is normally applied for the `lang` setting `sh` (except it should be isolated from  `$` and `#`).\n\nWhen I try editing the project you shared on my machine in order to achieve that, I get the error `maximum show rule depth exceeded`. I modified line 24 like so:\n\n```diff\n  #show raw: set text(font: \"DejaVu Sans Mono\", size: 1.11em)\n  #show raw.where(lang: \"console\"): it => {\n    show raw.line: it => {\n      let user = emph((\"$ \"))\n      let root = emph((\"# \"))\n      it\n        .text\n        .split(\"\\n\")\n        .map(line => {\n          let starts(pattern) = line.starts-with(pattern)\n          let prefix = if starts(\"$ \") { user } else if starts(\"# \") { root }\n          let text = line.replace(regex(\"^[$#] \"), \"\")\n-         prefix + text\n+         prefix + raw(text, lang: \"sh\")\n        })\n        .join(\"\\n\")\n    }\n    it\n  }\n```",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 10.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 738
    },
    {
      "id": 10364,
      "post_number": 6,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-28T14:06:18.576Z",
      "updated_at": "2025-03-28T14:06:18.576Z",
      "cooked": "<p>That is exactly what I was talking about here:</p>\n<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"2\" data-topic=\"3382\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"><a href=\"https://forum.typst.app/t/how-can-i-include-user-privilege-indicators-in-shell-prompts-while-keeping-syntax-highlighting-enabled-in-codeblocks/3382/2\">How can I include user privilege indicators in shell prompts while keeping syntax highlighting enabled in codeblocks?</a></div>\n<blockquote>\n<p>I tried using <code>show raw.line</code> inside <code>show raw.where(lang: \"console\")</code>, but I hit infinite show rule recursion and I don‚Äôt know if it is fixable.</p>\n</blockquote>\n</aside>",
      "raw": "That is exactly what I was talking about here:\n\n[quote=\"Andrew, post:2, topic:3382\"]\nI tried using `show raw.line` inside `show raw.where(lang: \"console\")`, but I hit infinite show rule recursion and I don‚Äôt know if it is fixable.\n[/quote]",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 4.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10366,
      "post_number": 7,
      "username": "Dherse",
      "name": "S√©bastien d'Herbais de Thun",
      "created_at": "2025-03-28T14:23:43.664Z",
      "updated_at": "2025-03-28T14:23:43.664Z",
      "cooked": "<p>Oh I see what you guys mean, lemme try something</p>",
      "raw": "Oh I see what you guys mean, lemme try something",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 4.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 137
    },
    {
      "id": 10369,
      "post_number": 8,
      "username": "Dherse",
      "name": "S√©bastien d'Herbais de Thun",
      "created_at": "2025-03-28T14:41:03.777Z",
      "updated_at": "2025-03-28T14:41:03.777Z",
      "cooked": "<p>I updated the example, it should mostly work but only on single line syntaxes, syntax highlighting that spans multiple lines would not work.<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/5/5f0c7d0f859956426cdf380b56524d6a42aa2d12.png\" data-download-href=\"https://forum.typst.app/uploads/default/5f0c7d0f859956426cdf380b56524d6a42aa2d12\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/5/5f0c7d0f859956426cdf380b56524d6a42aa2d12_2_690x191.png\" alt=\"image\" data-base62-sha1=\"dyQ7cKj6UOuvPZwlRFfkN0IEch4\" width=\"690\" height=\"191\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/5/5f0c7d0f859956426cdf380b56524d6a42aa2d12_2_690x191.png, https://forum.typst.app/uploads/default/original/2X/5/5f0c7d0f859956426cdf380b56524d6a42aa2d12.png 1.5x, https://forum.typst.app/uploads/default/original/2X/5/5f0c7d0f859956426cdf380b56524d6a42aa2d12.png 2x\" data-dominant-color=\"F6F6F7\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">960√ó266 40 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "I updated the example, it should mostly work but only on single line syntaxes, syntax highlighting that spans multiple lines would not work.\n![image|690x191](upload://dyQ7cKj6UOuvPZwlRFfkN0IEch4.png)",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 21,
      "score": 29.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 137
    },
    {
      "id": 10370,
      "post_number": 9,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-28T14:54:16.579Z",
      "updated_at": "2025-03-28T14:54:41.905Z",
      "cooked": "<p>So was the solution to do this?</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">  show raw.line: it =&gt; {\n    show raw.line: it =&gt; it.body\n</code></pre>\n<p>This is actually next level hackery.</p>",
      "raw": "So was the solution to do this?\n\n```typc\n  show raw.line: it => {\n    show raw.line: it => it.body\n```\n\nThis is actually next level hackery.",
      "reply_to_post_number": 8,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 21,
      "score": 19.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10371,
      "post_number": 10,
      "username": "maxigaz",
      "name": "maxigaz",
      "created_at": "2025-03-28T15:01:19.529Z",
      "updated_at": "2025-03-28T15:04:17.045Z",
      "cooked": "<p>Nice! It‚Äôs <em>almost</em> perfect for my needs!</p>\n<p>The only remaining thing I‚Äôm wondering about is how to make the font size the same as for other codly raw blocks. I‚Äôm noticing that both in the screenshot (and also on my machine, after I compile the code), that the font size is slightly bigger, which is especially noticable when I compare the word <code>console</code> on the right between the two snippets.</p>\n<p>(Setting <code>size</code> exactly to <code>1.11em</code> was my idea, originating from the other thread about regular (non-Codly) raw blocks, as it looked very similar in size to vanilla raw blocks.)</p>",
      "raw": "Nice! It's _almost_ perfect for my needs!\n\nThe only remaining thing I'm wondering about is how to make the font size the same as for other codly raw blocks. I'm noticing that both in the screenshot (and also on my machine, after I compile the code), that the font size is slightly bigger, which is especially noticable when I compare the word `console` on the right between the two snippets.\n\n(Setting `size` exactly to `1.11em` was my idea, originating from the other thread about regular (non-Codly) raw blocks, as it looked very similar in size to vanilla raw blocks.)",
      "reply_to_post_number": 8,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 4.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 738
    }
  ],
  "scraped_at": "2025-06-10T09:49:59.458121"
}
{
  "topic_metadata": {
    "id": 3411,
    "title": "How can I make the numbering fit the size of the diagram in Fletcher?",
    "slug": "how-can-i-make-the-numbering-fit-the-size-of-the-diagram-in-fletcher",
    "posts_count": 6,
    "created_at": "2025-03-26T14:41:31.802Z",
    "last_posted_at": "2025-03-26T18:29:50.126Z",
    "views": 70,
    "like_count": 6,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "Andrew",
    "tags": [
      "packages",
      "fletcher"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 526
  },
  "posts": [
    {
      "id": 10285,
      "post_number": 1,
      "username": "Kass",
      "name": "",
      "created_at": "2025-03-26T14:41:31.966Z",
      "updated_at": "2025-03-26T14:41:31.966Z",
      "cooked": "<p>Hi,</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$ \"before\"\n  #diagram(\n   spacing:(3em,2em),\n   let (FXFY_FZ, FX_FYFZ, FXYFZ, FXY_Z, FXFYZ,FX_YZ) = (( 0, 0), ( 1,0), (0,1), (0,2),(1,1),(1,2)),\n  node(FXFY_FZ,$(F X times.circle F Y)  times.circle F Z$ ),\n  node(FX_FYFZ, $F X times.circle ( F Y  times.circle F Z)$),\n  node(FXYFZ, $F (X times.circle Y)  times.circle F Z$),\n  node(FXY_Z, $F ((X times.circle  Y)  times.circle  Z)$),\n  node(FXFYZ, $F X times.circle  F (Y  times.circle  Z)$),\n  node(FX_YZ, $F (X times.circle (  Y  times.circle  Z))$),\n  edge(FXFY_FZ,FX_FYFZ,\"-&gt;\",$alpha$),\n  edge(FXFY_FZ,FXYFZ,\"-&gt;\",$phi times.circle id$),\n  edge(FXYFZ,FXY_Z,\"-&gt;\",$phi$),\n  edge(FXY_Z,FX_YZ,\"-&gt;\",$F alpha$),\n  edge(FX_FYFZ,FXFYZ,\"-&gt;\",$id times.circle phi$,label-side: left),\n  edge(FXFYZ,FX_YZ,\"-&gt;\",$phi$,label-side: left),\n) \"after\"\n$\n</code></pre>\n<p>I would like to have ‚Äòbefore‚Äô and ‚Äòafter‚Äô centered, as well as the numbering in the middle of my diagram.</p>",
      "raw": "Hi,\n\n```typ\n$ \"before\"\n  #diagram(\n   spacing:(3em,2em),\n   let (FXFY_FZ, FX_FYFZ, FXYFZ, FXY_Z, FXFYZ,FX_YZ) = (( 0, 0), ( 1,0), (0,1), (0,2),(1,1),(1,2)),\n  node(FXFY_FZ,$(F X times.circle F Y)  times.circle F Z$ ),\n  node(FX_FYFZ, $F X times.circle ( F Y  times.circle F Z)$),\n  node(FXYFZ, $F (X times.circle Y)  times.circle F Z$),\n  node(FXY_Z, $F ((X times.circle  Y)  times.circle  Z)$),\n  node(FXFYZ, $F X times.circle  F (Y  times.circle  Z)$),\n  node(FX_YZ, $F (X times.circle (  Y  times.circle  Z))$),\n  edge(FXFY_FZ,FX_FYFZ,\"->\",$alpha$),\n  edge(FXFY_FZ,FXYFZ,\"->\",$phi times.circle id$),\n  edge(FXYFZ,FXY_Z,\"->\",$phi$),\n  edge(FXY_Z,FX_YZ,\"->\",$F alpha$),\n  edge(FX_FYFZ,FXFYZ,\"->\",$id times.circle phi$,label-side: left),\n  edge(FXFYZ,FX_YZ,\"->\",$phi$,label-side: left),\n) \"after\"\n$\n```\nI would like to have 'before' and 'after' centered, as well as the numbering in the middle of my diagram.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 85.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1391
    },
    {
      "id": 10293,
      "post_number": 2,
      "username": "Jollywatt",
      "name": "Joseph Wilson",
      "created_at": "2025-03-26T16:08:03.618Z",
      "updated_at": "2025-03-26T16:08:03.618Z",
      "cooked": "<p>Using <code>block()</code> almost works, but it still seemed necessary to manually shift the diagram a bit with <code>move()</code>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@local/fletcher:0.5.7\": diagram, node, edge\n#set math.equation(numbering: \"(1)\")\n\n#let fig = diagram(\n\tspacing:(3em,2em),\n\tlet (FXFY_FZ, FX_FYFZ, FXYFZ, FXY_Z, FXFYZ, FX_YZ) = ((0,0), ( 1,0), (0,1), (0,2), (1,1), (1,2)),\n\tnode(FXFY_FZ, $(F X times.circle F Y) times.circle F Z$),\n\tnode(FX_FYFZ, $F X times.circle (F Y times.circle F Z)$),\n\tnode(FXYFZ, $F(X times.circle Y) times.circle F Z$),\n\tnode(FXY_Z, $F((X times.circle Y) times.circle Z)$),\n\tnode(FXFYZ, $F X times.circle F(Y times.circle Z)$),\n\tnode(FX_YZ, $F(X times.circle (Y times.circle Z))$),\n\tedge(FXFY_FZ, FX_FYFZ, \"-&gt;\", $alpha$),\n\tedge(FXFY_FZ, FXYFZ, \"-&gt;\", $phi times.circle id$),\n\tedge(FXYFZ, FXY_Z, \"-&gt;\", $phi$),\n\tedge(FXY_Z, FX_YZ, \"-&gt;\", $F alpha$),\n\tedge(FX_FYFZ, FXFYZ, \"-&gt;\", $id times.circle phi$, left),\n\tedge(FXFYZ, FX_YZ, \"-&gt;\", $phi$, left),\n)\n\n$ \"before\" #block(move(dy: -0.66em, pad(x: 1em, fig))) \"after\" $\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/7/7032d0911b3f08e7c75217f1754e84b1b1fa747a.png\" data-download-href=\"https://forum.typst.app/uploads/default/7032d0911b3f08e7c75217f1754e84b1b1fa747a\" title=\"Screenshot 2025-03-26 at 15.37.44\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/7/7032d0911b3f08e7c75217f1754e84b1b1fa747a_2_690x191.png\" alt=\"Screenshot 2025-03-26 at 15.37.44\" data-base62-sha1=\"g0yluLtx2KDW1RE3vaFODRrdLKO\" width=\"690\" height=\"191\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/7/7032d0911b3f08e7c75217f1754e84b1b1fa747a_2_690x191.png, https://forum.typst.app/uploads/default/optimized/2X/7/7032d0911b3f08e7c75217f1754e84b1b1fa747a_2_1035x286.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/7/7032d0911b3f08e7c75217f1754e84b1b1fa747a_2_1380x382.png 2x\" data-dominant-color=\"FAFAFA\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2025-03-26 at 15.37.44</span><span class=\"informations\">2034√ó564 54.4 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "Using `block()` almost works, but it still seemed necessary to manually shift the diagram a bit with `move()`.\n```typ\n#import \"@local/fletcher:0.5.7\": diagram, node, edge\n#set math.equation(numbering: \"(1)\")\n\n#let fig = diagram(\n\tspacing:(3em,2em),\n\tlet (FXFY_FZ, FX_FYFZ, FXYFZ, FXY_Z, FXFYZ, FX_YZ) = ((0,0), ( 1,0), (0,1), (0,2), (1,1), (1,2)),\n\tnode(FXFY_FZ, $(F X times.circle F Y) times.circle F Z$),\n\tnode(FX_FYFZ, $F X times.circle (F Y times.circle F Z)$),\n\tnode(FXYFZ, $F(X times.circle Y) times.circle F Z$),\n\tnode(FXY_Z, $F((X times.circle Y) times.circle Z)$),\n\tnode(FXFYZ, $F X times.circle F(Y times.circle Z)$),\n\tnode(FX_YZ, $F(X times.circle (Y times.circle Z))$),\n\tedge(FXFY_FZ, FX_FYFZ, \"->\", $alpha$),\n\tedge(FXFY_FZ, FXYFZ, \"->\", $phi times.circle id$),\n\tedge(FXYFZ, FXY_Z, \"->\", $phi$),\n\tedge(FXY_Z, FX_YZ, \"->\", $F alpha$),\n\tedge(FX_FYFZ, FXFYZ, \"->\", $id times.circle phi$, left),\n\tedge(FXFYZ, FX_YZ, \"->\", $phi$, left),\n)\n\n$ \"before\" #block(move(dy: -0.66em, pad(x: 1em, fig))) \"after\" $\n```\n\n![Screenshot 2025-03-26 at 15.37.44|690x191](upload://g0yluLtx2KDW1RE3vaFODRrdLKO.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 27,
      "score": 35.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 713
    },
    {
      "id": 10294,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-26T16:20:40.961Z",
      "updated_at": "2025-03-26T17:37:48.567Z",
      "cooked": "<p>I remembered that there is a <code>baseline</code> field for <code>box</code>, which does work and might be good enough (as it‚Äôs a slightly simpler solution):</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$ \"before\" #box(baseline: 3.8em, fig) \"after\" $\n</code></pre>\n<p>But it does mean that you have to level it manually, so it can be imprecise. Although <code>dy: -0.66em</code> also feels random, and I would think that <code>-0.65em</code> is the correct value since this is the default leading. But both are within 1 pixel of perfection, so it doesn‚Äôt really matter.</p>\n<p>P.S. <a class=\"mention\" href=\"/u/jollywatt\">@Jollywatt</a>, you are using the local package.</p>",
      "raw": "I remembered that there is a `baseline` field for `box`, which does work and might be good enough (as it's a slightly simpler solution):\n\n```typ\n$ \"before\" #box(baseline: 3.8em, fig) \"after\" $\n```\n\nBut it does mean that you have to level it manually, so it can be imprecise. Although `dy: -0.66em` also feels random, and I would think that `-0.65em` is the correct value since this is the default leading. But both are within 1 pixel of perfection, so it doesn't really matter.\n\nP.S. @Jollywatt, you are using the local package.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 25,
      "score": 20.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10295,
      "post_number": 4,
      "username": "Kass",
      "name": "",
      "created_at": "2025-03-26T16:39:52.718Z",
      "updated_at": "2025-03-26T16:39:52.718Z",
      "cooked": "<p>Thank you very much, <a class=\"mention\" href=\"/u/jollywatt\">@Jollywatt</a> and <a class=\"mention\" href=\"/u/andrew\">@Andrew</a>, for your answers. As I see, I have to do it manually, but is there a way to get the dimensions of the diagram and then create a function to do it automatically?</p>",
      "raw": "Thank you very much, @Jollywatt and @Andrew, for your answers. As I see, I have to do it manually, but is there a way to get the dimensions of the diagram and then create a function to do it automatically?",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 14.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1391
    },
    {
      "id": 10296,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-26T17:42:06.499Z",
      "updated_at": "2025-03-26T17:42:06.499Z",
      "cooked": "<p>The <code>block</code>+<code>move</code> doesn‚Äôt do manual stuff, it‚Äôs just a correction. I think it would work for everything.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let mcenter(body) = block(move(dy: -0.66em, body))\n$ \"this\" mcenter(fig) \"that\" $\n</code></pre>",
      "raw": "The `block`+`move` doesn't do manual stuff, it's just a correction. I think it would work for everything.\n\n```typ\n#let mcenter(body) = block(move(dy: -0.66em, body))\n$ \"this\" mcenter(fig) \"that\" $\n```",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 24,
      "score": 34.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10299,
      "post_number": 6,
      "username": "Jollywatt",
      "name": "Joseph Wilson",
      "created_at": "2025-03-26T18:29:50.126Z",
      "updated_at": "2025-03-26T18:29:50.126Z",
      "cooked": "<blockquote>\n<p>As I see, I have to do it manually.</p>\n</blockquote>\n<p>Like Andrew pointed out, you shouldn‚Äôt need to adjust <code>dy</code> even when the diagram changes size <img src=\"https://forum.typst.app/images/emoji/apple/+1.png?v=12\" title=\":+1:\" class=\"emoji\" alt=\":+1:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "> As I see, I have to do it manually.\n\nLike Andrew pointed out, you shouldn't need to adjust `dy` even when the diagram changes size üëç",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 24,
      "score": 24.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 713
    }
  ],
  "scraped_at": "2025-06-10T09:49:58.738691"
}
{
  "topic_metadata": {
    "id": 3419,
    "title": "How to scale without adding line breaks?",
    "slug": "how-to-scale-without-adding-line-breaks",
    "posts_count": 4,
    "created_at": "2025-03-27T01:39:25.384Z",
    "last_posted_at": "2025-03-27T16:25:19.943Z",
    "views": 62,
    "like_count": 4,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "LordBaryhobal",
    "tags": [],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 214
  },
  "posts": [
    {
      "id": 10303,
      "post_number": 1,
      "username": "AJ_Rush",
      "name": "AJ Rush",
      "created_at": "2025-03-27T01:39:25.601Z",
      "updated_at": "2025-03-27T15:54:03.728Z",
      "cooked": "<p>I would expect these two lines ‚Ä¶</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">Hello #scale(300%, reflow: true)[World]!\nHello #text(size: 3em)[World]!\n</code></pre>\n<p>‚Ä¶ to have the same result. However, they don‚Äôt.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/6/65e5516f51729ab421c01cb9544989148b2c9226.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/65e5516f51729ab421c01cb9544989148b2c9226\" title=\"IMG_5570\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/6/65e5516f51729ab421c01cb9544989148b2c9226_2_543x500.jpeg\" alt=\"IMG_5570\" data-base62-sha1=\"expxfuH9UlJDBfDIjqPWrPYxpI2\" width=\"543\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/6/65e5516f51729ab421c01cb9544989148b2c9226_2_543x500.jpeg, https://forum.typst.app/uploads/default/optimized/2X/6/65e5516f51729ab421c01cb9544989148b2c9226_2_814x750.jpeg 1.5x, https://forum.typst.app/uploads/default/original/2X/6/65e5516f51729ab421c01cb9544989148b2c9226.jpeg 2x\" data-dominant-color=\"E9E9E9\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">IMG_5570</span><span class=\"informations\">956√ó879 81.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Instead, the scale function seems to be putting line breaks before and after itself. How do I prevent this?</p>",
      "raw": "I would expect these two lines ‚Ä¶\n\n``` typ\nHello #scale(300%, reflow: true)[World]!\nHello #text(size: 3em)[World]!\n```\n‚Ä¶ to have the same result. However, they don‚Äôt. \n\n![IMG_5570|543x500](upload://expxfuH9UlJDBfDIjqPWrPYxpI2.jpeg)\n\nInstead, the scale function seems to be putting line breaks before and after itself. How do I prevent this?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 51.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 873
    },
    {
      "id": 10308,
      "post_number": 2,
      "username": "LordBaryhobal",
      "name": "Baryhobal",
      "created_at": "2025-03-27T07:29:06.846Z",
      "updated_at": "2025-03-27T07:29:06.846Z",
      "cooked": "<p>First of all, you can format your code using a code block like this:</p>\n<pre><code class=\"lang-auto\">``‚Äã`typ\nyour code\n``‚Äã`\n</code></pre>\n<p>Regarding your problem, you can wrap the <code>scale</code> in a <code>box</code> to make it inline:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">Hello #box(scale(300%, reflow: true)[World])!\n\nHello #text(size: 3em)[World]!\n</code></pre>",
      "raw": "First of all, you can format your code using a code block like this:\n```\n``‚Äã`typ\nyour code\n``‚Äã`\n```\n\nRegarding your problem, you can wrap the `scale` in a `box` to make it inline:\n```typ\nHello #box(scale(300%, reflow: true)[World])!\n\nHello #text(size: 3em)[World]!\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 27,
      "score": 40.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 585
    },
    {
      "id": 10317,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-27T12:42:46.138Z",
      "updated_at": "2025-03-27T12:42:46.138Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/lordbaryhobal\">@LordBaryhobal</a>, as a nitpick, you should use Markdown language so that the code doesn‚Äôt look green:</p>\n<pre data-code-wrap=\"md\"><code class=\"lang-md\">````md\n```typ\nyour code\n```\n````\n</code></pre>\n<details><summary>example</summary>\n<pre data-code-wrap=\"md\"><code class=\"lang-md\">```typ\nyour code\n```\n</code></pre>\n</details>\n<p>Additionally, if the <code>scale()</code> is used multiple times, then it‚Äôs better to move repetitive named arguments into a set rule:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set scale(reflow: true)\n\nHello #box(scale(300%)[World])!\n</code></pre>\n<p>Or you can make a wrapper:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let scale(scale, body) = box(std.scale(scale, reflow: true, body))\n\nHello #scale(300%)[World]!\n</code></pre>\n<p>For the <code>reflow: true</code> see these:</p>\n<aside class=\"onebox githubissue\" data-onebox-src=\"https://github.com/typst/typst/issues/5327\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/typst/typst/issues/5327\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com/typst/typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"github-row\">\n  <div class=\"github-icon-container\" title=\"Issue\" data-github-private-repo=\"false\">\n\t  <svg width=\"60\" height=\"60\" class=\"github-icon\" viewBox=\"0 0 14 16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg>\n  </div>\n\n  <div class=\"github-info-container\">\n    <h4>\n      <a href=\"https://github.com/typst/typst/issues/5327\" target=\"_blank\" rel=\"noopener nofollow ugc\">Set `*.reflow` `true` by default</a>\n    </h4>\n\n    <div class=\"github-info\">\n      <div class=\"date\">\n        opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2024-10-30\" data-time=\"01:35:37\" data-timezone=\"UTC\">01:35AM - 30 Oct 24 UTC</span>\n      </div>\n\n\n      <div class=\"user\">\n        <a href=\"https://github.com/Andrew15-5\" target=\"_blank\" rel=\"noopener nofollow ugc\">\n          <img alt=\"Andrew15-5\" src=\"https://forum.typst.app/uploads/default/original/1X/8c66fc8b1c207ba90488266df18b206a61b1fc49.png\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\" data-dominant-color=\"707C3A\">\n          Andrew15-5\n        </a>\n      </div>\n    </div>\n\n    <div class=\"labels\">\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          layout\n        </span>\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          change request\n        </span>\n    </div>\n  </div>\n</div>\n\n  <div class=\"github-row\">\n    <p class=\"github-body-container\">### Description\n\nThe `reflow` field should've been set to `true` a long time ago<span class=\"show-more-container\"><a href=\"\" rel=\"noopener\" class=\"show-more\">‚Ä¶</a></span><span class=\"excerpt hidden\">. The last instance for this is https://github.com/typst/typst/pull/5136#discussion_r1789849547.\n\n### Use Case\n\nReflow by default is the better default, because that's what most users would expect, IMO.</span></p>\n  </div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<aside class=\"onebox githubissue\" data-onebox-src=\"https://github.com/typst/typst/issues/5363\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/typst/typst/issues/5363\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com/typst/typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"github-row\">\n  <div class=\"github-icon-container\" title=\"Issue\" data-github-private-repo=\"false\">\n\t  <svg width=\"60\" height=\"60\" class=\"github-icon\" viewBox=\"0 0 14 16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg>\n  </div>\n\n  <div class=\"github-info-container\">\n    <h4>\n      <a href=\"https://github.com/typst/typst/issues/5363\" target=\"_blank\" rel=\"noopener nofollow ugc\">`rotate` doesn't work as expected when `reflow: true`</a>\n    </h4>\n\n    <div class=\"github-info\">\n      <div class=\"date\">\n        opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2024-11-03\" data-time=\"22:40:05\" data-timezone=\"UTC\">10:40PM - 03 Nov 24 UTC</span>\n      </div>\n\n\n      <div class=\"user\">\n        <a href=\"https://github.com/Andrew15-5\" target=\"_blank\" rel=\"noopener nofollow ugc\">\n          <img alt=\"Andrew15-5\" src=\"https://forum.typst.app/uploads/default/original/1X/8c66fc8b1c207ba90488266df18b206a61b1fc49.png\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\" data-dominant-color=\"707C3A\">\n          Andrew15-5\n        </a>\n      </div>\n    </div>\n\n    <div class=\"labels\">\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          bug\n        </span>\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          layout\n        </span>\n    </div>\n  </div>\n</div>\n\n  <div class=\"github-row\">\n    <p class=\"github-body-container\">### Description\n\nAs I showed in https://github.com/typst/typst/pull/5330#issueco<span class=\"show-more-container\"><a href=\"\" rel=\"noopener\" class=\"show-more\">‚Ä¶</a></span><span class=\"excerpt hidden\">mment-2449809323, in v0.12.0 to rotate overshoots the size of the content for most degrees when `rotate(reflow: true)`. Previously it was doing the opposite: https://github.com/typst/typst/pull/5330#issuecomment-2452044452. As a result, in never worked as expected, and we need to fix that. At least for the majority of use cases.\n\n```typ\n#set rotate(reflow: true)\n#set page(height: 80pt, width: 120pt, fill: gray)\n#place(block(width: 100%, height: 100%, fill: green))\n#align(center + horizon, rotate(59deg, image(\"images/tiger.jpg\")))\n```\n\nThis blocks https://github.com/typst/typst/pull/5330 that supposed to fix https://github.com/typst/typst/issues/5327.\n\nI'm not sure, but `scale` and `skew` could have the same problem.\n\n### Reproduction URL\n\n_No response_\n\n### Operating system\n\nLinux\n\n### Typst version\n\n- [X] I am using the latest version of Typst</span></p>\n  </div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "@LordBaryhobal, as a nitpick, you should use Markdown language so that the code doesn't look green:\n\n`````md\n````md\n```typ\nyour code\n```\n````\n`````\n\n<details><summary>example</summary>\n\n````md\n```typ\nyour code\n```\n````\n\n</details>\n\nAdditionally, if the `scale()` is used multiple times, then it's better to move repetitive named arguments into a set rule:\n\n```typ\n#set scale(reflow: true)\n\nHello #box(scale(300%)[World])!\n```\n\nOr you can make a wrapper:\n\n```typ\n#let scale(scale, body) = box(std.scale(scale, reflow: true, body))\n\nHello #scale(300%)[World]!\n```\n\nFor the `reflow: true` see these:\n\nhttps://github.com/typst/typst/issues/5327\n\nhttps://github.com/typst/typst/issues/5363",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 22,
      "score": 19.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10335,
      "post_number": 4,
      "username": "AJ_Rush",
      "name": "AJ Rush",
      "created_at": "2025-03-27T16:25:19.943Z",
      "updated_at": "2025-03-27T16:25:19.943Z",
      "cooked": "<p>That did it, thanks!</p>\n<p>I edited the code example in my original post, too.</p>",
      "raw": "That did it, thanks! \n\nI edited the code example in my original post, too.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 18.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 873
    }
  ],
  "scraped_at": "2025-06-10T09:49:58.023780"
}
{
  "topic_metadata": {
    "id": 3420,
    "title": "Why does cetz-plot.plot show only one function?",
    "slug": "why-does-cetz-plot-plot-show-only-one-function",
    "posts_count": 3,
    "created_at": "2025-03-27T04:00:36.122Z",
    "last_posted_at": "2025-03-27T22:15:51.603Z",
    "views": 81,
    "like_count": 2,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "LordBaryhobal",
    "tags": [
      "cetz"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 279
  },
  "posts": [
    {
      "id": 10304,
      "post_number": 1,
      "username": "Chris1",
      "name": "Chris",
      "created_at": "2025-03-27T04:00:36.217Z",
      "updated_at": "2025-03-27T09:18:28.953Z",
      "cooked": "<p>My code is below.</p>\n<p>I would like for it to show both the y=x^2 function and the y=sqrt(x) function.</p>\n<p>However it is only showing one.</p>\n<p>Is there something I need to add.</p>\n<pre><code class=\"lang-auto\">\n#import \"@preview/cetz:0.3.4\"\n#import \"@preview/cetz-plot:0.1.1\"\n\n#cetz.canvas({\n\n  import cetz.draw: *\n  import cetz-plot: *\n  plot.plot(\n    size: (5,5),\n    x-tick-step:1,\n    y-tick-step:5,\n    axis-style: \"school-book\",\n\n    plot.add(\n     domain: (0,5),\n      x=&gt;calc.pow(x,2), \n  ),\n\n    plot.add(\n      domain: (0,5),\n      x=&gt;calc.root(x,2)  \n    )\n  )\n \n})\n</code></pre>\n<p>Also, after the 2 functions have been shown, is there a way to return the point of intersection?</p>\n<p>Thanks.</p>",
      "raw": "My code is below.\n\nI would like for it to show both the y=x^2 function and the y=sqrt(x) function.\n\nHowever it is only showing one.\n\nIs there something I need to add.\n```\n\n#import \"@preview/cetz:0.3.4\"\n#import \"@preview/cetz-plot:0.1.1\"\n\n#cetz.canvas({\n\n  import cetz.draw: *\n  import cetz-plot: *\n  plot.plot(\n    size: (5,5),\n    x-tick-step:1,\n    y-tick-step:5,\n    axis-style: \"school-book\",\n\n    plot.add(\n     domain: (0,5),\n      x=>calc.pow(x,2), \n  ),\n\n    plot.add(\n      domain: (0,5),\n      x=>calc.root(x,2)  \n    )\n  )\n \n})\n```\nAlso, after the 2 functions have been shown, is there a way to return the point of intersection?\n\nThanks.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 36,
      "score": 92.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1269
    },
    {
      "id": 10307,
      "post_number": 2,
      "username": "LordBaryhobal",
      "name": "Baryhobal",
      "created_at": "2025-03-27T07:16:28.535Z",
      "updated_at": "2025-03-27T07:18:23.679Z",
      "cooked": "<p>First of all, you can format your code on the forum in a code block:</p>\n<pre><code class=\"lang-auto\">``‚Äã`typ\nyour code\n``‚Äã`\n</code></pre>\n<p>Regarding your issue, you have to wrap both <code>plot.add</code> calls in curly braces. This is because the function <code>plot.add</code> actually returns an array of draw functions. By wrapping them in braces, it joins the arrays into one</p>\n<p>This should work:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n#import \"@preview/cetz-plot:0.1.1\"\n\n#cetz.canvas({\n  import cetz.draw: *\n  import cetz-plot: *\n  plot.plot(\n    size: (5,5),\n    x-tick-step:1,\n    y-tick-step:5,\n    axis-style: \"school-book\",\n    {\n      plot.add(\n       domain: (0,5),\n        x=&gt;calc.pow(x,2), \n      )\n      plot.add(\n        domain: (0,5),\n        x=&gt;calc.root(x,2)  \n      )\n    }\n  )\n})\n</code></pre>\n<p>For the intersection, I think the easiest is to compute it beforehand and plot it manually<br>\nEDIT: You might want to check this other post: <a href=\"https://forum.typst.app/t/is-it-possible-to-calculate-intersection-points-between-two-cetz-plots/1380\" class=\"inline-onebox\">Is it possible to calculate intersection points between two cetz plots?</a></p>",
      "raw": "First of all, you can format your code on the forum in a code block:\n```\n``‚Äã`typ\nyour code\n``‚Äã`\n```\n\nRegarding your issue, you have to wrap both `plot.add` calls in curly braces. This is because the function `plot.add` actually returns an array of draw functions. By wrapping them in braces, it joins the arrays into one\n\nThis should work:\n```typ\n#import \"@preview/cetz:0.3.4\"\n#import \"@preview/cetz-plot:0.1.1\"\n\n#cetz.canvas({\n  import cetz.draw: *\n  import cetz-plot: *\n  plot.plot(\n    size: (5,5),\n    x-tick-step:1,\n    y-tick-step:5,\n    axis-style: \"school-book\",\n    {\n      plot.add(\n       domain: (0,5),\n        x=>calc.pow(x,2), \n      )\n      plot.add(\n        domain: (0,5),\n        x=>calc.root(x,2)  \n      )\n    }\n  )\n})\n```\n\nFor the intersection, I think the easiest is to compute it beforehand and plot it manually\nEDIT: You might want to check this other post: https://forum.typst.app/t/is-it-possible-to-calculate-intersection-points-between-two-cetz-plots/1380",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 33,
      "score": 41.6,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 585
    },
    {
      "id": 10342,
      "post_number": 3,
      "username": "Chris1",
      "name": "Chris",
      "created_at": "2025-03-27T22:15:51.603Z",
      "updated_at": "2025-03-27T22:15:51.603Z",
      "cooked": "<p>Thank you. That works well.</p>",
      "raw": "Thank you. That works well.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 5.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1269
    }
  ],
  "scraped_at": "2025-06-10T09:49:57.307206"
}
{
  "topic_metadata": {
    "id": 3421,
    "title": "How can I modify a specific detail of a theme (newbie question)?",
    "slug": "how-can-i-modify-a-specific-detail-of-a-theme-newbie-question",
    "posts_count": 2,
    "created_at": "2025-03-27T06:56:39.486Z",
    "last_posted_at": "2025-03-27T07:08:29.280Z",
    "views": 50,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 216
  },
  "posts": [
    {
      "id": 10305,
      "post_number": 1,
      "username": "Mathieu",
      "name": "Mathieu",
      "created_at": "2025-03-27T06:56:39.593Z",
      "updated_at": "2025-03-27T06:56:39.593Z",
      "cooked": "<p>I‚Äôm fooling around with the <a href=\"https://typst.app/universe/package/owlbear\">owlbear</a> theme. It displays a large dropcap at the beginning of the first paragraph:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/e/e60d9b80ed42914a768a6b22bf94056ad9fbecbb.png\" data-download-href=\"https://forum.typst.app/uploads/default/e60d9b80ed42914a768a6b22bf94056ad9fbecbb\" title=\"render\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/e/e60d9b80ed42914a768a6b22bf94056ad9fbecbb_2_690x345.png\" alt=\"render\" data-base62-sha1=\"wP8YgmVRHm539P7KJQi8VCwZYlt\" width=\"690\" height=\"345\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/e/e60d9b80ed42914a768a6b22bf94056ad9fbecbb_2_690x345.png, https://forum.typst.app/uploads/default/original/2X/e/e60d9b80ed42914a768a6b22bf94056ad9fbecbb.png 1.5x, https://forum.typst.app/uploads/default/original/2X/e/e60d9b80ed42914a768a6b22bf94056ad9fbecbb.png 2x\" data-dominant-color=\"F3F1F0\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">render</span><span class=\"informations\">919√ó460 77.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>I‚Äôd like to make this dropcap slightly smaller or larger. What is the canonical way to achieve that? Should I load the them in my document source, then attempt to redefine its internal functions, as in:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/owlbear:0.0.1\": book-template\n#show: book-template  // These two lines simply apply the template\n\n#show par: (it) =&gt; {\n  paragraph_counter.step(level: 2)\n\n  context {\n    if paragraph_counter.get().at(1) == 1 {\n      return book-template.dropcap(\n        height: 10, // &lt;-- this is my edit\n        font: book-template.theme.font.dropcap,\n        fill: book-template.theme.paint.dropcap.fill,\n        stroke: (\n          paint: book-template.theme.paint.dropcap.stroke,\n          thickness: 1.5pt,\n        ),\n        it.body\n      )\n    } else {\n      return it\n    }\n  }\n}\n</code></pre>\n<p>That approach fails because things like <code>paragraph_counter</code> or <code>theme</code> are undefined in this scope.</p>\n<p>Should I instead clone the template and modify it locally? Again, at this point I have no idea what is the canonical/expected way to achieve this.</p>",
      "raw": "I'm fooling around with the [owlbear](https://typst.app/universe/package/owlbear) theme. It displays a large dropcap at the beginning of the first paragraph:\n\n![render|690x345](upload://wP8YgmVRHm539P7KJQi8VCwZYlt.png)\n\nI'd like to make this dropcap slightly smaller or larger. What is the canonical way to achieve that? Should I load the them in my document source, then attempt to redefine its internal functions, as in:\n\n```typ\n#import \"@preview/owlbear:0.0.1\": book-template\n#show: book-template  // These two lines simply apply the template\n\n#show par: (it) => {\n  paragraph_counter.step(level: 2)\n\n  context {\n    if paragraph_counter.get().at(1) == 1 {\n      return book-template.dropcap(\n        height: 10, // <-- this is my edit\n        font: book-template.theme.font.dropcap,\n        fill: book-template.theme.paint.dropcap.fill,\n        stroke: (\n          paint: book-template.theme.paint.dropcap.stroke,\n          thickness: 1.5pt,\n        ),\n        it.body\n      )\n    } else {\n      return it\n    }\n  }\n}\n```\n\nThat approach fails because things like `paragraph_counter` or `theme` are undefined in this scope.\n\nShould I instead clone the template and modify it locally? Again, at this point I have no idea what is the canonical/expected way to achieve this.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 27,
      "score": 85.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1200
    },
    {
      "id": 10306,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-03-27T07:08:29.280Z",
      "updated_at": "2025-03-27T07:08:29.280Z",
      "cooked": "<p>You should clone it locally and modify <code>height</code>. Unfortunately, this is not exposed to the user from the template. You can create an issue at their project <a href=\"https://gitlab.com/doggobit/typst-owlbear/-/issues\">here</a>.</p>",
      "raw": "You should clone it locally and modify `height`. Unfortunately, this is not exposed to the user from the template. You can create an issue at their project [here](https://gitlab.com/doggobit/typst-owlbear/-/issues).",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 26,
      "score": 20.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    }
  ],
  "scraped_at": "2025-06-10T09:49:56.618432"
}
{
  "topic_metadata": {
    "id": 3422,
    "title": "Getting Office 365 Word line spacing in Typst?",
    "slug": "getting-office-365-word-line-spacing-in-typst",
    "posts_count": 9,
    "created_at": "2025-03-27T08:45:50.561Z",
    "last_posted_at": "2025-03-27T16:39:38.614Z",
    "views": 294,
    "like_count": 2,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 8,
    "accepted_answer_username": "Andrew",
    "tags": [
      "text-formatting",
      "word-migration"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 879
  },
  "posts": [
    {
      "id": 10309,
      "post_number": 1,
      "username": "ertugruluyar",
      "name": "Ertuƒürul Uyar",
      "created_at": "2025-03-27T08:45:50.681Z",
      "updated_at": "2025-04-18T12:12:27.166Z",
      "cooked": "<p>I am struggling to set Single Line Spacing, as in the Office 365 Word in Typst.<br>\nI am currently developing a thesis template. And in the cover page, I couldn‚Äôt get the exact measures, they aren‚Äôt getting same. Official template is maked with Office 365 Word.<br>\nSee <a href=\"https://github.com/typst/typst/issues/4224#issuecomment-2755827083\" rel=\"noopener nofollow ugc\">GitHub Issue Comment</a> and later.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">  set text(\n    top-edge: \"ascender\",\n    bottom-edge: \"descender\",\n  )\n\n  // Paragraf bo≈üluklarƒ±nƒ± ayarla. [Set paragraph spacing.]\n  set par(\n    leading: 0.17em,\n    spacing: 0em,\n  )\n</code></pre>\n<p>What I am wondering here should I use <code>top-edge: \"ascender\"</code> and <code>bottom-edge: \"descender\"</code> or <code>leading: 0.25em</code> for Word Single Line Spacing; <code>leading: 0.75em</code> for Word 1.5 Line Spacing; and <code>leading: 1.25em</code> for Word Double Line Spacing with default <code>top-edge</code> and <code>bottom-edge</code> value as mentioned <a href=\"https://github.com/typst/typst/issues/159#issuecomment-1609939896\" rel=\"noopener nofollow ugc\">Solution 2</a></p>\n<p>So, should I keep the default <code>top-edge</code> and <code>bottom-edge</code> value so that roughly equal to Office 365 Word‚Äôs. Or should I keep the change the <code>top-edge</code> and <code>bottom-edge</code> value as I mentioned  above so that with almost exactly same with Office 365 Word‚Äôs.<br>\nWhich one is the best approach to all other things that affected by <code>top-edge</code> and <code>bottom-edge</code> values (equations and table etc.) had consedered.</p>",
      "raw": "I am struggling to set Single Line Spacing, as in the Office 365 Word in Typst.\nI am currently developing a thesis template. And in the cover page, I couldn't get the exact measures, they aren't getting same. Official template is maked with Office 365 Word.\nSee [GitHub Issue Comment](https://github.com/typst/typst/issues/4224#issuecomment-2755827083) and later.\n\n```typst\n  set text(\n    top-edge: \"ascender\",\n    bottom-edge: \"descender\",\n  )\n\n  // Paragraf bo≈üluklarƒ±nƒ± ayarla. [Set paragraph spacing.]\n  set par(\n    leading: 0.17em,\n    spacing: 0em,\n  )\n```\n\nWhat I am wondering here should I use `top-edge: \"ascender\"` and `bottom-edge: \"descender\"` or `leading: 0.25em` for Word Single Line Spacing; `leading: 0.75em` for Word 1.5 Line Spacing; and `leading: 1.25em` for Word Double Line Spacing with default `top-edge` and `bottom-edge` value as mentioned [Solution 2](https://github.com/typst/typst/issues/159#issuecomment-1609939896)\n\nSo, should I keep the default `top-edge` and `bottom-edge` value so that roughly equal to Office 365 Word's. Or should I keep the change the `top-edge` and `bottom-edge` value as I mentioned  above so that with almost exactly same with Office 365 Word's.\nWhich one is the best approach to all other things that affected by `top-edge` and `bottom-edge` values (equations and table etc.) had consedered.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 60,
      "score": 922.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1389
    },
    {
      "id": 10310,
      "post_number": 2,
      "username": "ertugruluyar",
      "name": "Ertuƒürul Uyar",
      "created_at": "2025-03-27T08:52:06.767Z",
      "updated_at": "2025-03-27T08:52:06.767Z",
      "cooked": "<p><code>leading: 0.25em</code> not good for the Times New Roman with 12pt font size, but <code>leading: 0.4em</code> resulted with almost same with first solution mentioned above.</p>",
      "raw": "`leading: 0.25em` not good for the Times New Roman with 12pt font size, but `leading: 0.4em` resulted with almost same with first solution mentioned above.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 59,
      "score": 51.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1389
    },
    {
      "id": 10311,
      "post_number": 3,
      "username": "ertugruluyar",
      "name": "Ertuƒürul Uyar",
      "created_at": "2025-03-27T08:54:38.911Z",
      "updated_at": "2025-03-27T08:54:38.911Z",
      "cooked": "<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://practicaltypography.com/line-spacing.html\">\n  <header class=\"source\">\n\n      <a href=\"https://practicaltypography.com/line-spacing.html\" target=\"_blank\" rel=\"noopener nofollow ugc\">practicaltypography.com</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/359;\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/d/de059dfe97bc1df8a2711c5f2252d1439edaf1a8_2_690x359.jpeg\" class=\"thumbnail\" data-dominant-color=\"787878\" width=\"690\" height=\"359\"></div>\n\n<h3><a href=\"https://practicaltypography.com/line-spacing.html\" target=\"_blank\" rel=\"noopener nofollow ugc\">Line spacing | Butterick‚Äôs Practical Typography</a></h3>\n\n  <p>Butterick‚Äôs Practical Typography</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>This guide is a good reference.</p>",
      "raw": "https://practicaltypography.com/line-spacing.html\n\nThis guide is a good reference.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 57,
      "score": 16.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1389
    },
    {
      "id": 10322,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-27T14:49:07.179Z",
      "updated_at": "2025-03-27T14:49:07.179Z",
      "cooked": "<p>If your template is meant to be used with one specific font and one specific font size, then you can use any solution that gives you the perfect spacing.</p>",
      "raw": "If your template is meant to be used with one specific font and one specific font size, then you can use any solution that gives you the perfect spacing.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 53,
      "score": 40.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10325,
      "post_number": 5,
      "username": "ertugruluyar",
      "name": "Ertuƒürul Uyar",
      "created_at": "2025-03-27T15:00:32.430Z",
      "updated_at": "2025-03-27T15:00:32.430Z",
      "cooked": "<p>Yes, I am gonna use only Times New Roman font. And mostly 12pt font size. But in table.cell and figure.captions, I am gonna use 10pt.</p>\n<p>This way, will be any problem?<br>\nOr should I specify <code>top-edge</code> and <code>bottom-edge</code> on theese special situations with proper leading value?</p>\n<p>Note: Maybe, I could use different font for raw(code) content.</p>",
      "raw": "Yes, I am gonna use only Times New Roman font. And mostly 12pt font size. But in table.cell and figure.captions, I am gonna use 10pt.\n\nThis way, will be any problem?\nOr should I specify `top-edge` and `bottom-edge` on theese special situations with proper leading value?\n\nNote: Maybe, I could use different font for raw(code) content.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 50,
      "score": 15.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1389
    },
    {
      "id": 10330,
      "post_number": 6,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-27T15:13:52.265Z",
      "updated_at": "2025-03-27T15:13:52.265Z",
      "cooked": "<p>Are you sure that the line spacing in tables must be identical? I think the table is generally a very special case, so sometimes to fit everything inside you would have to decrease font size, or line spacing.</p>\n<p>I never had to change the text boundaries in actual documents, nor have I saw someone use it, not that I ask everyone do they use it or not.</p>\n<p>For raw element, you are expected to use a monospaced font. And if the lines are too long, then sometimes you are forced to decrease its font size.</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">show raw: set text(10pt, font: \"Fira Code\")\n</code></pre>",
      "raw": "Are you sure that the line spacing in tables must be identical? I think the table is generally a very special case, so sometimes to fit everything inside you would have to decrease font size, or line spacing.\n\nI never had to change the text boundaries in actual documents, nor have I saw someone use it, not that I ask everyone do they use it or not.\n\nFor raw element, you are expected to use a monospaced font. And if the lines are too long, then sometimes you are forced to decrease its font size.\n\n```typc\nshow raw: set text(10pt, font: \"Fira Code\")\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 48,
      "score": 14.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10332,
      "post_number": 7,
      "username": "ertugruluyar",
      "name": "Ertuƒürul Uyar",
      "created_at": "2025-03-27T16:20:21.203Z",
      "updated_at": "2025-03-27T16:20:21.203Z",
      "cooked": "<p>When I was trying to make the cover of the template in Word in Typst, I added manual spaces such as <code>v(2.5cm)</code>. Although I left almost the same spaces as in Word, the text was not in the same position due to the line spacing.</p>\n<p>The second reason was that in normal text, when I set the leading to 1em, there was much more space between the lines than in Word.</p>\n<p>I gave Deepseek the documentation for <code>top-edge</code> and <code>bottom-edge</code> and <code>leading</code> in Typst to compare the way Word and Typst calculate line spacing. The result is that Word determines the space between the tops of both lines, while Typst by default determines the space between the bottom of the first line and the top of the bottom line. I do this with <code>top-edge: \"ascender\"</code> and <code>bottom-edge: \"decender\"</code> with <code>leading:0.17em</code> and get almost identical results.<br>\nBut I also get a very close result with Times New Roman (12pt) with only <code>leading:0.4em</code>.</p>\n<p>What I‚Äôm wondering here is that I‚Äôm trying to predict what kind of problems changing the top-edge and bottom-edge parameters may cause in the future. Since I can‚Äôt predict exactly what the pros and cons will be, I needed to consult someone who knows.</p>",
      "raw": "When I was trying to make the cover of the template in Word in Typst, I added manual spaces such as `v(2.5cm)`. Although I left almost the same spaces as in Word, the text was not in the same position due to the line spacing.\n\nThe second reason was that in normal text, when I set the leading to 1em, there was much more space between the lines than in Word. \n\nI gave Deepseek the documentation for `top-edge` and `bottom-edge` and `leading` in Typst to compare the way Word and Typst calculate line spacing. The result is that Word determines the space between the tops of both lines, while Typst by default determines the space between the bottom of the first line and the top of the bottom line. I do this with `top-edge: \"ascender\"` and `bottom-edge: \"decender\"` with `leading:0.17em` and get almost identical results.\nBut I also get a very close result with Times New Roman (12pt) with only `leading:0.4em`.\n\nWhat I'm wondering here is that I'm trying to predict what kind of problems changing the top-edge and bottom-edge parameters may cause in the future. Since I can't predict exactly what the pros and cons will be, I needed to consult someone who knows.",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 47,
      "score": 24.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1389
    },
    {
      "id": 10336,
      "post_number": 8,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-27T16:29:27.088Z",
      "updated_at": "2025-03-28T14:26:29.887Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"ertugruluyar\" data-post=\"7\" data-topic=\"3422\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/e/66104C/48.png\" class=\"avatar\"> ertugruluyar:</div>\n<blockquote>\n<p>compare the way Word and Typst calculate line spacing.</p>\n</blockquote>\n</aside>\n<p>Typst doesn‚Äôt have line spacing, hence the <a href=\"https://github.com/typst/typst/issues/4224\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Proposal: change `leading` option to `line-height` ¬∑ Issue #4224 ¬∑ typst/typst ¬∑ GitHub</a>. There is only between-paragraph spacing, which is still using leading.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set par(leading: 0.75em, spacing: 0.75em)\n</code></pre>\n<aside class=\"quote no-group\" data-username=\"ertugruluyar\" data-post=\"7\" data-topic=\"3422\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/e/66104C/48.png\" class=\"avatar\"> ertugruluyar:</div>\n<blockquote>\n<p>What I‚Äôm wondering here is that I‚Äôm trying to predict what kind of problems changing the top-edge and bottom-edge parameters may cause in the future. Since I can‚Äôt predict exactly what the pros and cons will be, I needed to consult someone who knows.</p>\n</blockquote>\n</aside>\n<p>I‚Äôm not a font expert, but if you can make everything look as you want right now, then you can just publish the template and create a new version if any problem arise in the future.</p>",
      "raw": "[quote=\"ertugruluyar, post:7, topic:3422\"]\ncompare the way Word and Typst calculate line spacing.\n[/quote]\n\nTypst doesn't have line spacing, hence the https://github.com/typst/typst/issues/4224. There is only between-paragraph spacing, which is still using leading.\n\n```typ\n#set par(leading: 0.75em, spacing: 0.75em)\n```\n\n[quote=\"ertugruluyar, post:7, topic:3422\"]\nWhat I‚Äôm wondering here is that I‚Äôm trying to predict what kind of problems changing the top-edge and bottom-edge parameters may cause in the future. Since I can‚Äôt predict exactly what the pros and cons will be, I needed to consult someone who knows.\n[/quote]\n\nI'm not a font expert, but if you can make everything look as you want right now, then you can just publish the template and create a new version if any problem arise in the future.",
      "reply_to_post_number": 7,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 42,
      "score": 118.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10337,
      "post_number": 9,
      "username": "ertugruluyar",
      "name": "Ertuƒürul Uyar",
      "created_at": "2025-03-27T16:39:38.614Z",
      "updated_at": "2025-03-27T16:39:38.614Z",
      "cooked": "<p>Thank you very much, I apologize for asking the same thing over and over again. You are right, I can‚Äôt predict everything. If there is a problem in the future, I will think about it then. Maybe in the future there may be a change like the line-height you linked to. Thank you very much again, sorry again.</p>",
      "raw": "Thank you very much, I apologize for asking the same thing over and over again. You are right, I can't predict everything. If there is a problem in the future, I will think about it then. Maybe in the future there may be a change like the line-height you linked to. Thank you very much again, sorry again.",
      "reply_to_post_number": 8,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 40,
      "score": 23.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1389
    }
  ],
  "scraped_at": "2025-06-10T09:49:55.708915"
}
{
  "topic_metadata": {
    "id": 3423,
    "title": "How to include files inside template/package, but parsed from project path?",
    "slug": "how-to-include-files-inside-template-package-but-parsed-from-project-path",
    "posts_count": 3,
    "created_at": "2025-03-27T08:57:12.943Z",
    "last_posted_at": "2025-03-27T15:06:09.404Z",
    "views": 191,
    "like_count": 6,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "packages",
      "templates"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 598
  },
  "posts": [
    {
      "id": 10312,
      "post_number": 1,
      "username": "Birckk",
      "name": "Tobias Olrik Birck Kristensen",
      "created_at": "2025-03-27T08:57:13.203Z",
      "updated_at": "2025-03-27T08:58:39.507Z",
      "cooked": "<p>I‚Äôm working on a template and I have an <code>#include-files()</code> function that would take a list of files and then just <code>#input</code> them inside the template. Specifically to have correct custom footer and page numbering on these ‚Äúpreface‚Äù files before primary contents. And then followed by main body etc.</p>\n<p>Structure:</p>\n<ul>\n<li>Template\n<ul>\n<li>Frontpage</li>\n<li>Preface pages <em>(parsed as paths)</em></li>\n</ul>\n</li>\n<li>Paper</li>\n</ul>\n<p><strong>My problem is:</strong><br>\nI‚Äôm testing this on local and the root is always my package <code>src</code> folder instead of my personal project folder because it‚Äôs my <code>src/main.typ</code> that essentially call the <code>input</code> I presume. But I can‚Äôt seem to figure out despite some similar issues or posts touching on similar subjects, how to get the correct path to be parsed.</p>\n<p><a href=\"https://github.com/typst/typst/issues/2608\" rel=\"noopener nofollow ugc\">mark project root</a>, <a href=\"https://github.com/typst/typst/issues/971\" rel=\"noopener nofollow ugc\">path and string should be different types.</a></p>\n<p><em>And it works fine if not ran as part of a package but just ran as part of my project. Utilizing having prefixed ‚Äú/‚Äù in paths to reference root of project</em></p>\n<p><strong>Error</strong></p>\n<pre><code class=\"lang-auto\">error: file not found()    \n@local/test-template:0.1.0\\src\\functions.typ:6:12\n\n//Actual Path: \nC:\\Users\\*MY-USER*\\AppData\\Local\\typst/packages\\local/test-template/0.1.0\\sections\\preface\\preface.typ\n\n//Expected path: \nC:\\myproject\\test-template\\sections\\preface\\preface.typ\n</code></pre>\n<p><strong>Code:</strong></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">//main.typ\n#show: template.with(\n  //... prior stuff\n  before: ( //my list of files to include\n    preface: \"/sections/preface/preface.typ\",\n    acknowledgement: \"/sections/preface/acknowledgement.typ\",\n    contents: \"/sections/preface/contents.typ\",\n    readers_guide: \"/sections/preface/readers_guide.typ\",\n  ),\n)\n</code></pre>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">//template.typ\n#let template() {\n    include-files(before)\n}\n</code></pre>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">//functions.typ\n#let include-files(file-list) = {\n  let files = file-list.values()\n\n  for file in files {\n    include file\n  }\n}\n</code></pre>",
      "raw": "I'm working on a template and I have an `#include-files()` function that would take a list of files and then just `#input` them inside the template. Specifically to have correct custom footer and page numbering on these \"preface\" files before primary contents. And then followed by main body etc. \n\nStructure: \n+ Template\n  + Frontpage\n  + Preface pages *(parsed as paths)*\n+ Paper\n\n**My problem is:**\nI'm testing this on local and the root is always my package `src` folder instead of my personal project folder because it's my `src/main.typ` that essentially call the `input` I presume. But I can't seem to figure out despite some similar issues or posts touching on similar subjects, how to get the correct path to be parsed.\n\n[mark project root](https://github.com/typst/typst/issues/2608), [path and string should be different types.](https://github.com/typst/typst/issues/971) \n\n*And it works fine if not ran as part of a package but just ran as part of my project. Utilizing having prefixed \"/\" in paths to reference root of project* \n\n**Error**\n```\nerror: file not found()    \n@local/test-template:0.1.0\\src\\functions.typ:6:12\n\n//Actual Path: \nC:\\Users\\*MY-USER*\\AppData\\Local\\typst/packages\\local/test-template/0.1.0\\sections\\preface\\preface.typ\n\n//Expected path: \nC:\\myproject\\test-template\\sections\\preface\\preface.typ\n```\n\n**Code:**\n```typ\n//main.typ\n#show: template.with(\n  //... prior stuff\n  before: ( //my list of files to include\n    preface: \"/sections/preface/preface.typ\",\n    acknowledgement: \"/sections/preface/acknowledgement.typ\",\n    contents: \"/sections/preface/contents.typ\",\n    readers_guide: \"/sections/preface/readers_guide.typ\",\n  ),\n)\n```\n```typ\n//template.typ\n#let template() {\n    include-files(before)\n}\n```\n```typ\n//functions.typ\n#let include-files(file-list) = {\n  let files = file-list.values()\n\n  for file in files {\n    include file\n  }\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 33,
      "score": 746.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1372
    },
    {
      "id": 10318,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-27T13:41:42.223Z",
      "updated_at": "2025-03-27T13:41:42.223Z",
      "cooked": "<p>You don‚Äôt need <code>include-files</code> function as it‚Äôs a simple oneliner:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let files = (\"a.typ\", \"b.typ\", \"c.typ\")\n#files.map(x =&gt; include x).join()\n</code></pre>\n<p>This is actually a pattern that works something like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#for item in items [#item content]\n// is\n#items.map(item =&gt; [#item content]).join()\n</code></pre>\n<p><code>for</code> loop joins the result of its block execution iterations.</p>\n<p>Also, I don‚Äôt see the point in making <code>before</code> a <code>dictionary</code> over <code>array</code>.</p>\n<hr>\n<p>I don‚Äôt understand the error as some context was stripped away. What is the root directory of the project during compilation?</p>\n<p>This works fine for me:</p>\n<pre><code class=\"lang-plaintext\">local/test-template/0.1.0/\n‚îú‚îÄ‚îÄ sections\n‚îÇ   ‚îî‚îÄ‚îÄ preface\n‚îÇ       ‚îú‚îÄ‚îÄ acknowledgement.typ\n‚îÇ       ‚îú‚îÄ‚îÄ contents.typ\n‚îÇ       ‚îú‚îÄ‚îÄ preface.typ\n‚îÇ       ‚îî‚îÄ‚îÄ readers_guide.typ\n‚îî‚îÄ‚îÄ src\n    ‚îú‚îÄ‚îÄ main.typ\n    ‚îî‚îÄ‚îÄ template.typ\n</code></pre>\n<br>\n<pre data-code-wrap=\"sh\"><code class=\"lang-sh\">typst c --root . src/main.typ\n</code></pre>\n<p><a href=\"https://mega.nz/file/KQAyFJBK#66saFVRmRAxSaDuWMPA8IP6_XjGWkIrX50JX6cLD2K0\" rel=\"noopener nofollow ugc\">test-template.zip</a></p>",
      "raw": "You don't need `include-files` function as it's a simple oneliner:\n\n```typ\n#let files = (\"a.typ\", \"b.typ\", \"c.typ\")\n#files.map(x => include x).join()\n```\n\nThis is actually a pattern that works something like this:\n\n```typ\n#for item in items [#item content]\n// is\n#items.map(item => [#item content]).join()\n```\n\n`for` loop joins the result of its block execution iterations.\n\nAlso, I don't see the point in making `before` a `dictionary` over `array`.\n\n---\n\nI don't understand the error as some context was stripped away. What is the root directory of the project during compilation?\n\nThis works fine for me:\n\n```text\nlocal/test-template/0.1.0/\n‚îú‚îÄ‚îÄ sections\n‚îÇ   ‚îî‚îÄ‚îÄ preface\n‚îÇ       ‚îú‚îÄ‚îÄ acknowledgement.typ\n‚îÇ       ‚îú‚îÄ‚îÄ contents.typ\n‚îÇ       ‚îú‚îÄ‚îÄ preface.typ\n‚îÇ       ‚îî‚îÄ‚îÄ readers_guide.typ\n‚îî‚îÄ‚îÄ src\n    ‚îú‚îÄ‚îÄ main.typ\n    ‚îî‚îÄ‚îÄ template.typ\n```\n\n<br>\n\n```sh\ntypst c --root . src/main.typ\n```\n\n[test-template.zip](https://mega.nz/file/KQAyFJBK#66saFVRmRAxSaDuWMPA8IP6_XjGWkIrX50JX6cLD2K0)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 46.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10328,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-03-27T15:06:09.404Z",
      "updated_at": "2025-03-27T15:11:28.871Z",
      "cooked": "<p>File paths such as <code>/sections/preface/preface.typ\"</code> are always relative to where they are used:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// a.typ\n#let my-include(path) = include path\n\n// b.typ\n#import \"@local/test-template:0.1.0\": my-include\n\n#include \"foo.typ\"      // relative to b.typ\n#my-include(\"foo.typ\") // relative to a.typ\n</code></pre>\n<p>in your case, that means your (absolute) paths would be relative to (the package containing) <code>functions.typ</code>. The way around this is to not pass paths, but content to your template:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">  before: ( //my list of files to include\n    preface: include \"/sections/preface/preface.typ\",\n    acknowledgement: include \"/sections/preface/acknowledgement.typ\",\n    contents: include \"/sections/preface/contents.typ\",\n    readers_guide: include \"/sections/preface/readers_guide.typ\",\n  ),\n</code></pre>\n<p>Eventually, there should be a distinct path type that lets you pass paths to other places, while retaining what they‚Äôre relative to, but this doesn‚Äôt exist yet. You can read more on the topic here:</p>\n<aside class=\"quote quote-modified\" data-post=\"1\" data-topic=\"306\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/l/0A3649/48.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/why-are-paths-always-relative-to-the-current-file/306\">Why are paths always relative to the current file?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    Context: I was trying to implement a small function that reads and parses a file with some regex. The function just takes the path to the file and returns the parsed context as dictionary. I wanted to move this function into a package. \n/somewhere/else/lib.typ \n#let parse-xyz(path) = {\n    let data = read(path)\n    ‚Ä¶\n}\n\nmain.typ \n#let values = import-xyz(\"my/path.xyz\");\n\nAfter that I found out that the read call resolves the path relative to the file that contains the function (lib.typ) and not ‚Ä¶\n  </blockquote>\n</aside>\n",
      "raw": "File paths such as `/sections/preface/preface.typ\"` are always relative to where they are used:\n\n```typ\n// a.typ\n#let my-include(path) = include path\n\n// b.typ\n#import \"@local/test-template:0.1.0\": my-include\n\n#include \"foo.typ\"      // relative to b.typ\n#my-include(\"foo.typ\") // relative to a.typ\n```\n\nin your case, that means your (absolute) paths would be relative to (the package containing) `functions.typ`. The way around this is to not pass paths, but content to your template:\n```typc\n  before: ( //my list of files to include\n    preface: include \"/sections/preface/preface.typ\",\n    acknowledgement: include \"/sections/preface/acknowledgement.typ\",\n    contents: include \"/sections/preface/contents.typ\",\n    readers_guide: include \"/sections/preface/readers_guide.typ\",\n  ),\n```\n\nEventually, there should be a distinct path type that lets you pass paths to other places, while retaining what they're relative to, but this doesn't exist yet. You can read more on the topic here:\n\nhttps://forum.typst.app/t/why-are-paths-always-relative-to-the-current-file/306?u=sillyfreak",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 4,
      "reads": 30,
      "score": 126.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:49:54.997602"
}
{
  "topic_metadata": {
    "id": 3435,
    "title": "How to format linguistic example lists?",
    "slug": "how-to-format-linguistic-example-lists",
    "posts_count": 8,
    "created_at": "2025-03-28T07:21:37.483Z",
    "last_posted_at": "2025-04-23T21:58:01.745Z",
    "views": 164,
    "like_count": 3,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 7,
    "word_count": 1649
  },
  "posts": [
    {
      "id": 10348,
      "post_number": 1,
      "username": "dj1121",
      "name": "",
      "created_at": "2025-03-28T07:21:37.637Z",
      "updated_at": "2025-04-18T12:52:23.441Z",
      "cooked": "<p>Hi all,</p>\n<p>I am a linguist, and I would like to use Typst to make linguistic example lists. An example is just a 3-tuple with sentence, gloss, and translation values. Often, it can also just be a single ‚Äúsentence‚Äù value if it‚Äôs English. Printing this via a grid is simple enough:</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/8/8c7cedcafad4b424d9028df2e43f28ba6b80daa4.png\" alt=\"2025-03-28_16-00\" data-base62-sha1=\"k2Ovigc3L3fGAhHqhUYSi66SSXi\" width=\"373\" height=\"68\"></p>\n<p>In linguistics papers, these sorts of examples can be arbitrarily nested. For example, we could refer to examples below as 1a), 2b.i), 3), etc.</p>\n<pre data-code-wrap=\"txt\"><code class=\"lang-txt\">1) a.  [SENTENCE]\n       [GLOSS]\n       [TRANSLATION]\n   b. ...\n   c. ...\n\n2) a. ...\n   b.\n       i. [SENTENCE]\n          [GLOSS]\n          [TRANSLATION]\n       ii. ... \n       iii. ...\n\n3) [SENTENCE]\n   [GLOSS]\n   [TRANSLATION]\n</code></pre>\n<p><strong>As you might expect, I don‚Äôt want to type these out manually every time I write an example. I want to make a function that can print the formatting from an arbitrarily nested list of examples, like the list below:</strong></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let xlist = (\n// Top-level \"1)\" \n (\n     // 1a\n      (sentence: [this is sentence],\n      gloss: [This is the gloss],\n      tran: [this is tran]\n      )\n\n   // 1b\n      (sentence: [this is sentence],\n      gloss: [This is the gloss],\n      tran: [this is tran]\n     )\n\n),\n// Top-level \"2)\"\n( \n  // 2a\n  (sentence: [this is sentence],\n   gloss: [this is gloss],\n   tran: [this is tran],\n   )\n)\n</code></pre>\n<p>I figured this could be accomplished with grid(), but I am lost on how to dynamically allocate grids. I thought about looping over the examples, nesting grid() calls, but I quickly became stuck. I know that each level of the list should have 2 columns (one for label, one for content). Then, the number of rows should depend on how what‚Äôs inside the current level of the list.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// Pass in list of examples\n#let ex(examples) = {\n  \n  grid(\n      columns: 2, // two top main cols\n      rows: examples.len(), // number of top-levels (i.e., 1, 2, 3)\n      column-gutter: 1em,\n      row-gutter: 1em,\n\n      for example in examples {\n\n            // ??\n         \n        }        \n  )\n</code></pre>\n<p>I‚Äôm having the feeling it might be good to use a recursive solution, but I am new to Typst, and thought I should ask for some guidance before I go too far in that direction. Does anyone have guidance as to how to make such a function, or if another solution would be better? Any help would be much appreciated! Thank you.</p>",
      "raw": "Hi all,\n\nI am a linguist, and I would like to use Typst to make linguistic example lists. An example is just a 3-tuple with sentence, gloss, and translation values. Often, it can also just be a single \"sentence\" value if it's English. Printing this via a grid is simple enough:\n\n![2025-03-28_16-00|498x91, 75%](upload://k2Ovigc3L3fGAhHqhUYSi66SSXi.png)\n\nIn linguistics papers, these sorts of examples can be arbitrarily nested. For example, we could refer to examples below as 1a), 2b.i), 3), etc.\n\n```txt\n1) a.  [SENTENCE]\n       [GLOSS]\n       [TRANSLATION]\n   b. ...\n   c. ...\n\n2) a. ...\n   b.\n       i. [SENTENCE]\n          [GLOSS]\n          [TRANSLATION]\n       ii. ... \n       iii. ...\n\n3) [SENTENCE]\n   [GLOSS]\n   [TRANSLATION]\n```\n**As you might expect, I don't want to type these out manually every time I write an example. I want to make a function that can print the formatting from an arbitrarily nested list of examples, like the list below:**\n\n```typ\n#let xlist = (\n// Top-level \"1)\" \n (\n     // 1a\n      (sentence: [this is sentence],\n      gloss: [This is the gloss],\n      tran: [this is tran]\n      )\n\n   // 1b\n      (sentence: [this is sentence],\n      gloss: [This is the gloss],\n      tran: [this is tran]\n     )\n\n),\n// Top-level \"2)\"\n( \n  // 2a\n  (sentence: [this is sentence],\n   gloss: [this is gloss],\n   tran: [this is tran],\n   )\n)\n```\n\nI figured this could be accomplished with grid(), but I am lost on how to dynamically allocate grids. I thought about looping over the examples, nesting grid() calls, but I quickly became stuck. I know that each level of the list should have 2 columns (one for label, one for content). Then, the number of rows should depend on how what's inside the current level of the list.\n\n```typ\n// Pass in list of examples\n#let ex(examples) = {\n  \n  grid(\n      columns: 2, // two top main cols\n      rows: examples.len(), // number of top-levels (i.e., 1, 2, 3)\n      column-gutter: 1em,\n      row-gutter: 1em,\n\n      for example in examples {\n\n            // ??\n         \n        }        \n  )\n```\n\nI'm having the feeling it might be good to use a recursive solution, but I am new to Typst, and thought I should ask for some guidance before I go too far in that direction. Does anyone have guidance as to how to make such a function, or if another solution would be better? Any help would be much appreciated! Thank you.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 45,
      "score": 134.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1397
    },
    {
      "id": 10350,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-03-28T08:23:26.837Z",
      "updated_at": "2025-03-28T08:27:09.742Z",
      "cooked": "<p>Something like this maybe? Credits goes to <a class=\"mention\" href=\"/u/eric\">@Eric</a> for <code>to-enum</code>.</p>\n<p><code>enum</code> and <code>list</code> need to be built recursively with the previous input, hence we use <a href=\"https://typst.app/docs/reference/foundations/array/#definitions-fold\"><code>array.fold</code></a>, otherwise numbers won‚Äôt follow.</p>\n<p>I have split the formatting and display into separate functions, but it‚Äôs honestly possible to just merge both.</p>\n<p>The numbering is set to using a <code>set rule</code>: <code>set enum(numbering: \"1.a.i)\")</code>.</p>\n<aside class=\"quote no-group\" data-username=\"dj1121\" data-post=\"1\" data-topic=\"3435\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/d/145B49/48.png\" class=\"avatar\"> dj1121:</div>\n<blockquote>\n<p>For example, we could refer to examples below as 1a), 2b.i), 3), etc.</p>\n</blockquote>\n</aside>\n<p>As for referencing an <code>enum.item</code>, that‚Äôs still <a href=\"https://github.com/typst/typst/issues/779\">work in progress</a>. Maybe, that‚Äôs better answered in another topic. It is absolutely doable, with a mix of <code>metadata</code> and a custom ref system.</p>\n<details>\n<summary>\nSummary</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let xlist = (\n  (\n    // 1a\n    (\n      sentence: [this is sentence 1 (1a)],\n      gloss: [This is the gloss],\n      tran: [this is tran],\n    ),\n    // 1b\n    (\n      sentence: [this is sentence 2 (1b)],\n      gloss: [This is the gloss],\n      tran: [this is tran],\n    ),\n  ),\n  (\n    // 2a\n    (\n      sentence: [this is sentence 3 (2a)],\n      gloss: [this is gloss],\n      tran: [this is tran],\n    )\n  ),\n  (\n    (\n      (\n        // 3a i\n        sentence: [this is sentence (3a i)],\n        gloss: [this is gloss],\n        tran: [this is tran],\n      ),\n      (\n        // 3a ii\n        sentence: [this is sentence (3a ii)],\n        gloss: [this is gloss],\n        tran: [this is tran],\n      ),\n    ),\n  ),\n)\n#let format(xlist, level: 0) = {\n  // set enum(numbering: \"1.a.i)\")\n  if type(xlist) == dictionary {\n    xlist.values().map(smallcaps).join(\"\\n\")\n  } else if type(xlist) == array {\n    for example in xlist {\n      let body = format(example, level: level + 1)\n      (body,)\n    }\n  }\n}\n#let to-enum(arr) = {\n  set enum(numbering: \"1.a.i)\")\n  arr\n    .fold(\n      (),\n      (items, curr) =&gt; {\n        // If the current entry is an array, append a new subenum to\n        // the last item. Otherwise, create a new enum item.\n        if type(curr) == array { items += (to-enum(curr),) } else {\n          items.push(curr)\n        }\n        items\n      },\n    )\n    .map(enum.item)\n    .join()\n}\n\n#to-enum(format(xlist))\n</code></pre>\n</details>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/9fe76365456363eaad327dc5acab6f99f6e0b22b.png\" data-download-href=\"https://forum.typst.app/uploads/default/9fe76365456363eaad327dc5acab6f99f6e0b22b\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/9fe76365456363eaad327dc5acab6f99f6e0b22b_2_345x500.png\" alt=\"image\" data-base62-sha1=\"mOzFdLiZu2q4XJRWN1eOTwcA7Qn\" width=\"345\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/9fe76365456363eaad327dc5acab6f99f6e0b22b_2_345x500.png, https://forum.typst.app/uploads/default/original/2X/9/9fe76365456363eaad327dc5acab6f99f6e0b22b.png 1.5x, https://forum.typst.app/uploads/default/original/2X/9/9fe76365456363eaad327dc5acab6f99f6e0b22b.png 2x\" data-dominant-color=\"F0F0F0\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">397√ó575 46.4 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "Something like this maybe? Credits goes to @Eric for `to-enum`.\n\n`enum` and `list` need to be built recursively with the previous input, hence we use [`array.fold`](https://typst.app/docs/reference/foundations/array/#definitions-fold), otherwise numbers won't follow.\n\nI have split the formatting and display into separate functions, but it's honestly possible to just merge both.\n\nThe numbering is set to using a `set rule`: `set enum(numbering: \"1.a.i)\")`.\n\n[quote=\"dj1121, post:1, topic:3435\"]\nFor example, we could refer to examples below as 1a), 2b.i), 3), etc.\n[/quote]\n\nAs for referencing an `enum.item`, that's still [work in progress](https://github.com/typst/typst/issues/779). Maybe, that's better answered in another topic. It is absolutely doable, with a mix of `metadata` and a custom ref system.\n\n[details=\"Summary\"]\n```typ\n#let xlist = (\n  (\n    // 1a\n    (\n      sentence: [this is sentence 1 (1a)],\n      gloss: [This is the gloss],\n      tran: [this is tran],\n    ),\n    // 1b\n    (\n      sentence: [this is sentence 2 (1b)],\n      gloss: [This is the gloss],\n      tran: [this is tran],\n    ),\n  ),\n  (\n    // 2a\n    (\n      sentence: [this is sentence 3 (2a)],\n      gloss: [this is gloss],\n      tran: [this is tran],\n    )\n  ),\n  (\n    (\n      (\n        // 3a i\n        sentence: [this is sentence (3a i)],\n        gloss: [this is gloss],\n        tran: [this is tran],\n      ),\n      (\n        // 3a ii\n        sentence: [this is sentence (3a ii)],\n        gloss: [this is gloss],\n        tran: [this is tran],\n      ),\n    ),\n  ),\n)\n#let format(xlist, level: 0) = {\n  // set enum(numbering: \"1.a.i)\")\n  if type(xlist) == dictionary {\n    xlist.values().map(smallcaps).join(\"\\n\")\n  } else if type(xlist) == array {\n    for example in xlist {\n      let body = format(example, level: level + 1)\n      (body,)\n    }\n  }\n}\n#let to-enum(arr) = {\n  set enum(numbering: \"1.a.i)\")\n  arr\n    .fold(\n      (),\n      (items, curr) => {\n        // If the current entry is an array, append a new subenum to\n        // the last item. Otherwise, create a new enum item.\n        if type(curr) == array { items += (to-enum(curr),) } else {\n          items.push(curr)\n        }\n        items\n      },\n    )\n    .map(enum.item)\n    .join()\n}\n\n#to-enum(format(xlist))\n```\n[/details]\n\n![image|345x500](upload://mOzFdLiZu2q4XJRWN1eOTwcA7Qn.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 2,
      "reads": 41,
      "score": 43.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 10357,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-28T11:56:43.031Z",
      "updated_at": "2025-03-31T19:38:29.385Z",
      "cooked": "<p>Here you go (-12 lines):</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let format(xlist, level: 0) = {\n  if type(xlist) == dictionary {\n    xlist.values().map(smallcaps).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example =&gt; (format(example, level: level + 1),)).join()\n  }\n}\n\n#let to-enum(arr) = {\n  set enum(numbering: \"1.a.i)\")\n  let fold-func = (items, curr) =&gt; {\n    // If the current entry is an array, append a new subenum to\n    // the last item. Otherwise, create a new enum item.\n    items + (if type(curr) == array { to-enum(curr) } else { curr },)\n  }\n  arr.fold((), fold-func).map(enum.item).join()\n}\n</code></pre>\n<br>\n<details><summary>Full example</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let format(xlist, level: 0) = {\n  if type(xlist) == dictionary {\n    xlist.values().map(smallcaps).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example =&gt; (format(example, level: level + 1),)).join()\n  }\n}\n\n#let to-enum(arr) = {\n  set enum(numbering: \"1.a.i)\")\n  let fold-func = (items, curr) =&gt; {\n    // If the current entry is an array, append a new subenum to\n    // the last item. Otherwise, create a new enum item.\n    items + (if type(curr) == array { to-enum(curr) } else { curr },)\n  }\n  arr.fold((), fold-func).map(enum.item).join()\n}\n\n#let xlist = (\n  (\n    // Top-level \"1)\"\n    (\n      // 1a\n      sentence: [Der Hund bellt.],\n      gloss: [DEF.MASC.SG.NOM Hund bell-3SG.PRES],\n      tran: [The dog barks.],\n    ),\n    (\n      // 1b\n      sentence: [Die Katze schl√§ft.],\n      gloss: [DEF.FEM.SG.NOM Katze schlaf-3SG.PRES],\n      tran: [The cat sleeps.],\n    ),\n  ),\n  (\n    // Top-level \"2)\"\n    (\n      // 2a\n      sentence: [Wir gehen ins Kino.],\n      gloss: [1PL.NOM geh-1PL.PRES in+das.ACC Kino],\n      tran: [We are going to the cinema.],\n    )\n  ),\n  (\n    // Top-level \"3)\"\n    (\n      // 3a\n      (\n        // 3a i\n        sentence: [Ich habe ein Buch gelesen.],\n        gloss: [1SG.NOM hab-1SG.PRES ein.ACC Buch les-PART.PST],\n        tran: [I have read a book.],\n      ),\n      (\n        // 3a ii\n        sentence: [Sie wird morgen ankommen.],\n        gloss: [3SG.FEM.NOM werd-3SG.PRES morgen an-komm-INF],\n        tran: [She will arrive tomorrow.],\n      ),\n    ),\n  ),\n)\n\n#to-enum(format(xlist))\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/0/04825dafe8807395561ef6b50db2a38cd4dd1dc5.png\" alt=\"image\" data-base62-sha1=\"DTduJVBObjQ3wAgZIYSoHIfBCl\" width=\"507\" height=\"386\"></p>\n</details>\n<hr>\n<p>For numbering patterns with different ending markers for different levels, see <a href=\"https://github.com/typst/typst/issues/6088\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Numbering patterns for nested lists is used incorrectly by the compiler ¬∑ Issue #6088 ¬∑ typst/typst ¬∑ GitHub</a></p>\n<aside class=\"onebox githubissue\" data-onebox-src=\"https://github.com/typst/typst/issues/905\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/typst/typst/issues/905\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com/typst/typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"github-row\">\n  <div class=\"github-icon-container\" title=\"Issue\" data-github-private-repo=\"false\">\n\t  <svg width=\"60\" height=\"60\" class=\"github-icon\" viewBox=\"0 0 14 16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg>\n  </div>\n\n  <div class=\"github-info-container\">\n    <h4>\n      <a href=\"https://github.com/typst/typst/issues/905\" target=\"_blank\" rel=\"noopener nofollow ugc\">More flexible separators in numbering patterns</a>\n    </h4>\n\n    <div class=\"github-info\">\n      <div class=\"date\">\n        opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2023-04-21\" data-time=\"01:07:09\" data-timezone=\"UTC\">01:07AM - 21 Apr 23 UTC</span>\n      </div>\n\n\n      <div class=\"user\">\n        <a href=\"https://github.com/ParadaCarleton\" target=\"_blank\" rel=\"noopener nofollow ugc\">\n          <img alt=\"ParadaCarleton\" src=\"https://forum.typst.app/uploads/default/original/2X/8/8ce7103d4d76700bfdd2e2c2aa685aa6d61ff14f.png\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\" data-dominant-color=\"DEC7E3\">\n          ParadaCarleton\n        </a>\n      </div>\n    </div>\n\n    <div class=\"labels\">\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          feature request\n        </span>\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          scripting\n        </span>\n    </div>\n  </div>\n</div>\n\n  <div class=\"github-row\">\n    <p class=\"github-body-container\">I can't get the numbering to look how I want:\n```\n#set enum(numbering: \"1.a)\")<span class=\"show-more-container\"><a href=\"\" rel=\"noopener\" class=\"show-more\">‚Ä¶</a></span><span class=\"excerpt hidden\">\n```\n![image](https://user-images.githubusercontent.com/71727937/233517079-dd932872-e331-41ad-b2a1-e524fe2d1ea2.png)\nI expected this to give \"1.\" and \"a)\".</span></p>\n  </div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "Here you go (-12 lines):\n\n```typ\n#let format(xlist, level: 0) = {\n  if type(xlist) == dictionary {\n    xlist.values().map(smallcaps).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example => (format(example, level: level + 1),)).join()\n  }\n}\n\n#let to-enum(arr) = {\n  set enum(numbering: \"1.a.i)\")\n  let fold-func = (items, curr) => {\n    // If the current entry is an array, append a new subenum to\n    // the last item. Otherwise, create a new enum item.\n    items + (if type(curr) == array { to-enum(curr) } else { curr },)\n  }\n  arr.fold((), fold-func).map(enum.item).join()\n}\n```\n\n<br>\n\n<details><summary>Full example</summary>\n\n```typ\n#let format(xlist, level: 0) = {\n  if type(xlist) == dictionary {\n    xlist.values().map(smallcaps).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example => (format(example, level: level + 1),)).join()\n  }\n}\n\n#let to-enum(arr) = {\n  set enum(numbering: \"1.a.i)\")\n  let fold-func = (items, curr) => {\n    // If the current entry is an array, append a new subenum to\n    // the last item. Otherwise, create a new enum item.\n    items + (if type(curr) == array { to-enum(curr) } else { curr },)\n  }\n  arr.fold((), fold-func).map(enum.item).join()\n}\n\n#let xlist = (\n  (\n    // Top-level \"1)\"\n    (\n      // 1a\n      sentence: [Der Hund bellt.],\n      gloss: [DEF.MASC.SG.NOM Hund bell-3SG.PRES],\n      tran: [The dog barks.],\n    ),\n    (\n      // 1b\n      sentence: [Die Katze schl√§ft.],\n      gloss: [DEF.FEM.SG.NOM Katze schlaf-3SG.PRES],\n      tran: [The cat sleeps.],\n    ),\n  ),\n  (\n    // Top-level \"2)\"\n    (\n      // 2a\n      sentence: [Wir gehen ins Kino.],\n      gloss: [1PL.NOM geh-1PL.PRES in+das.ACC Kino],\n      tran: [We are going to the cinema.],\n    )\n  ),\n  (\n    // Top-level \"3)\"\n    (\n      // 3a\n      (\n        // 3a i\n        sentence: [Ich habe ein Buch gelesen.],\n        gloss: [1SG.NOM hab-1SG.PRES ein.ACC Buch les-PART.PST],\n        tran: [I have read a book.],\n      ),\n      (\n        // 3a ii\n        sentence: [Sie wird morgen ankommen.],\n        gloss: [3SG.FEM.NOM werd-3SG.PRES morgen an-komm-INF],\n        tran: [She will arrive tomorrow.],\n      ),\n    ),\n  ),\n)\n\n#to-enum(format(xlist))\n```\n\n![image|507x386](upload://DTduJVBObjQ3wAgZIYSoHIfBCl.png)\n\n</details>\n\n---\n\nFor numbering patterns with different ending markers for different levels, see https://github.com/typst/typst/issues/6088\n\nhttps://github.com/typst/typst/issues/905",
      "reply_to_post_number": 2,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 36,
      "score": 32.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10465,
      "post_number": 4,
      "username": "Mark_Hilton",
      "name": "Mark Hilton",
      "created_at": "2025-03-31T15:25:18.220Z",
      "updated_at": "2025-04-18T12:52:45.089Z",
      "cooked": "<aside class=\"quote no-group quote-modified\" data-username=\"Andrew\" data-post=\"3\" data-topic=\"3435\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let format(xlist, level: 0) = {\n  // set enum(numbering: \"1.a.i)\")\n  if type(xlist) == dictionary {\n    xlist.values().map(smallcaps).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example =&gt; (format(example, level: level + 1),)).join()\n  }\n}\n</code></pre>\n</blockquote>\n</aside>\n<p>As a linguist beggining to use Typst, I am interested in this thread on formatting linguistic example lists and think I can follow how your code fits in with that by <a class=\"mention\" href=\"/u/quachpas\">@quachpas</a>.</p>\n<p>I‚Äôm planning to try it, but in the code above, I understand the <code>.map(smallcaps)</code> putting the examples into smallcaps, but I would want my examples to to be in a monospaced font instead. How would I modify the code to achieve that?</p>",
      "raw": "[quote=\"Andrew, post:3, topic:3435\"]\n```typ\n#let format(xlist, level: 0) = {\n  // set enum(numbering: \"1.a.i)\")\n  if type(xlist) == dictionary {\n    xlist.values().map(smallcaps).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example => (format(example, level: level + 1),)).join()\n  }\n}\n```\n[/quote]\nAs a linguist beggining to use Typst, I am interested in this thread on formatting linguistic example lists and think I can follow how your code fits in with that by @quachpas.\n\nI'm planning to try it, but in the code above, I understand the `.map(smallcaps)` putting the examples into smallcaps, but I would want my examples to to be in a monospaced font instead. How would I modify the code to achieve that?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 25,
      "score": 10.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 1276
    },
    {
      "id": 10468,
      "post_number": 5,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-03-31T18:14:15.472Z",
      "updated_at": "2025-04-18T12:53:07.518Z",
      "cooked": "<p><code>map</code> takes any function, the function receives a value and should return content here. We can generalize format so it can change formatting of the word:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let format(xlist, level: 0, wordformat: smallcaps) = {\n  // set enum(numbering: \"1.a.i)\")\n  if type(xlist) == dictionary {\n    xlist.values().map(wordformat).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example =&gt; (format(example, level: level + 1, wordformat: wordformat),)).join()\n  }\n}\n</code></pre>\n<p>Then you can pass <code>wordformat: raw</code> to the function. Or equivalently <code>it =&gt; raw(it)</code> (an anonymous function). Or use a different function than <code>raw</code> if there‚Äôs a better way to format the text, maybe using <code>it =&gt; text(it)</code> with more options added in.</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/9/96442e6ba3dfab4b19c3e8b3a2479267f5e7f6da.png\" alt=\"bild\" data-base62-sha1=\"lrjHiCCWOW0nQNEijHZlghx6fKW\" width=\"273\" height=\"239\"></p>\n<details>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let format(xlist, level: 0, wordformat: smallcaps) = {\n  // set enum(numbering: \"1.a.i)\")\n  if type(xlist) == dictionary {\n    xlist.values().map(wordformat).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example =&gt; (format(example, level: level + 1, wordformat: wordformat),)).join()\n  }\n}\n\n#let to-enum(arr) = {\n  set enum(numbering: \"1.a.i)\")\n  arr\n    .fold(\n      (),\n      (items, curr) =&gt; {\n        // If the current entry is an array, append a new subenum to\n        // the last item. Otherwise, create a new enum item.\n        if type(curr) == array { items += (to-enum(curr),) } else {\n          items.push(curr)\n        }\n        items\n      },\n    )\n    .map(enum.item)\n    .join()\n}\n\n#to-enum(format(\n  (\n    (\n      sentence: \"A sentence\",\n      gloss: \"Gloss\",\n      tran: \"Tran\"\n    ),\n    (\n      sentence: \"A sentence\",\n      gloss: \"Gloss\",\n      tran: \"Tran\"\n    ),\n  )\n, wordformat: raw))\n\n</code></pre>\n</details>",
      "raw": "`map` takes any function, the function receives a value and should return content here. We can generalize format so it can change formatting of the word:\n\n```typ\n#let format(xlist, level: 0, wordformat: smallcaps) = {\n  // set enum(numbering: \"1.a.i)\")\n  if type(xlist) == dictionary {\n    xlist.values().map(wordformat).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example => (format(example, level: level + 1, wordformat: wordformat),)).join()\n  }\n}\n```\n\nThen you can pass `wordformat: raw` to the function. Or equivalently `it => raw(it)` (an anonymous function). Or use a different function than `raw` if there's a better way to format the text, maybe using `it => text(it)` with more options added in.\n\n![bild|273x239](upload://lrjHiCCWOW0nQNEijHZlghx6fKW.png)\n\n\n<details>\n\n```typ\n#let format(xlist, level: 0, wordformat: smallcaps) = {\n  // set enum(numbering: \"1.a.i)\")\n  if type(xlist) == dictionary {\n    xlist.values().map(wordformat).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example => (format(example, level: level + 1, wordformat: wordformat),)).join()\n  }\n}\n\n#let to-enum(arr) = {\n  set enum(numbering: \"1.a.i)\")\n  arr\n    .fold(\n      (),\n      (items, curr) => {\n        // If the current entry is an array, append a new subenum to\n        // the last item. Otherwise, create a new enum item.\n        if type(curr) == array { items += (to-enum(curr),) } else {\n          items.push(curr)\n        }\n        items\n      },\n    )\n    .map(enum.item)\n    .join()\n}\n\n#to-enum(format(\n  (\n    (\n      sentence: \"A sentence\",\n      gloss: \"Gloss\",\n      tran: \"Tran\"\n    ),\n    (\n      sentence: \"A sentence\",\n      gloss: \"Gloss\",\n      tran: \"Tran\"\n    ),\n  )\n, wordformat: raw))\n\n```\n</details>",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 4.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 10470,
      "post_number": 6,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-31T19:31:31.861Z",
      "updated_at": "2025-03-31T19:31:31.861Z",
      "cooked": "<p>There are 2 options: <code>raw</code> and <code>text.with(font: \"monospacedfont\")</code>. First one only works on <code>str</code>ings, second works on <code>str</code>ings and <code>content</code> types. Usually you would use <code>raw</code> one way or another, but here a conversion from <code>content</code> to <code>str</code> should be added that is relatively robust and easy:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/t4t:0.4.2\": get\n\n#let format(xlist, level: 0) = {\n  if type(xlist) == dictionary {\n    xlist.values().map(get.text).map(raw).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example =&gt; (format(example, level: level + 1),)).join()\n  }\n}\n</code></pre>\n<p>But if you will only ever use strings, then you don‚Äôt need that package function.</p>\n<p>The less idiomatic way:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let format(xlist, level: 0) = {\n  if type(xlist) == dictionary {\n    xlist.values().map(text.with(font: \"Liberation Mono\")).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example =&gt; (format(example, level: level + 1),)).join()\n  }\n}\n</code></pre>\n<p>Of course, if you need to, you can move out the formatting function into an input parameter like <a class=\"mention\" href=\"/u/bluss\">@bluss</a> showed above.</p>",
      "raw": "There are 2 options: `raw` and `text.with(font: \"monospacedfont\")`. First one only works on `str`ings, second works on `str`ings and `content` types. Usually you would use `raw` one way or another, but here a conversion from `content` to `str` should be added that is relatively robust and easy:\n\n```typ\n#import \"@preview/t4t:0.4.2\": get\n\n#let format(xlist, level: 0) = {\n  if type(xlist) == dictionary {\n    xlist.values().map(get.text).map(raw).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example => (format(example, level: level + 1),)).join()\n  }\n}\n```\n\nBut if you will only ever use strings, then you don't need that package function.\n\nThe less idiomatic way:\n\n```typ\n#let format(xlist, level: 0) = {\n  if type(xlist) == dictionary {\n    xlist.values().map(text.with(font: \"Liberation Mono\")).join(\"\\n\")\n  } else if type(xlist) == array {\n    xlist.map(example => (format(example, level: level + 1),)).join()\n  }\n}\n```\n\nOf course, if you need to, you can move out the formatting function into an input parameter like @bluss showed above.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 4.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11277,
      "post_number": 7,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-04-18T13:05:50.731Z",
      "updated_at": "2025-04-18T13:05:50.731Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"3\" data-topic=\"3435\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let to-enum(arr) = {\n  set enum(numbering: \"1.a.i)\")\n  let fold-func = (items, curr) =&gt; {\n    // If the current entry is an array, append a new subenum to\n    // the last item. Otherwise, create a new enum item.\n    items + (if type(curr) == array { to-enum(curr) } else { curr },)\n  }\n  arr.fold((), fold-func).map(enum.item).join()\n}\n</code></pre>\n</blockquote>\n</aside>\n<p>not shorter but imo clearer than the <code>fold</code>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let to-enum(elem) = {\n  if type(elem) != array {\n    return elem\n  }\n\n  set enum(numbering: \"1.a.i)\")\n  for e in elem [+ #to-enum(e)]\n}\n</code></pre>",
      "raw": "[quote=\"Andrew, post:3, topic:3435\"]\n```typ\n#let to-enum(arr) = {\n  set enum(numbering: \"1.a.i)\")\n  let fold-func = (items, curr) => {\n    // If the current entry is an array, append a new subenum to\n    // the last item. Otherwise, create a new enum item.\n    items + (if type(curr) == array { to-enum(curr) } else { curr },)\n  }\n  arr.fold((), fold-func).map(enum.item).join()\n}\n```\n[/quote]\n\nnot shorter but imo clearer than the `fold`:\n```typ\n#let to-enum(elem) = {\n  if type(elem) != array {\n    return elem\n  }\n\n  set enum(numbering: \"1.a.i)\")\n  for e in elem [+ #to-enum(e)]\n}\n```",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 18,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 11540,
      "post_number": 8,
      "username": "afiaith",
      "name": "Maja Abramski-Kronenberg",
      "created_at": "2025-04-23T21:58:01.745Z",
      "updated_at": "2025-04-23T21:58:01.745Z",
      "cooked": "<p>tl;dr‚Ä¶</p>\n<p>Is what you need covered by <a href=\"https://typst.app/universe/package/leipzig-glossing\">leipzig-glossing</a>?</p>",
      "raw": "tl;dr‚Ä¶\n\nIs what you need covered by [leipzig-glossing](https://typst.app/universe/package/leipzig-glossing)?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 3.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 91
    }
  ],
  "scraped_at": "2025-06-10T09:49:54.267316"
}
{
  "topic_metadata": {
    "id": 3436,
    "title": "Why are the preview panel and button not shown?",
    "slug": "why-are-the-preview-panel-and-button-not-shown",
    "posts_count": 4,
    "created_at": "2025-03-28T08:30:43.868Z",
    "last_posted_at": "2025-03-28T18:44:51.899Z",
    "views": 63,
    "like_count": 3,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "flokl",
    "tags": [
      "layout",
      "web-app"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 203
  },
  "posts": [
    {
      "id": 10351,
      "post_number": 1,
      "username": "DominicoDino",
      "name": "",
      "created_at": "2025-03-28T08:30:43.999Z",
      "updated_at": "2025-03-31T06:36:15.157Z",
      "cooked": "<p>I‚Äôve been using typst for over a year and suddenly yesterday my preview panel got hidden and I can‚Äôt get it back. I tried deleting the cache and history, force quit safari and restarted my macbook. Nothing seems to fix the issue.<br>\nAttached a screenshot of a new empty document i created to show the problem.<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/a/a97214d2d493950f8facc5f5818b8d40a1d4e4c3.png\" data-download-href=\"https://forum.typst.app/uploads/default/a97214d2d493950f8facc5f5818b8d40a1d4e4c3\" title=\"Screenshot 2025-03-28 at 09.26.38\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/a/a97214d2d493950f8facc5f5818b8d40a1d4e4c3_2_690x395.png\" alt=\"Screenshot 2025-03-28 at 09.26.38\" data-base62-sha1=\"oaZ6RlVqPYray3RYdANqpurPQP1\" width=\"690\" height=\"395\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/a/a97214d2d493950f8facc5f5818b8d40a1d4e4c3_2_690x395.png, https://forum.typst.app/uploads/default/optimized/2X/a/a97214d2d493950f8facc5f5818b8d40a1d4e4c3_2_1035x592.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/a/a97214d2d493950f8facc5f5818b8d40a1d4e4c3_2_1380x790.png 2x\" data-dominant-color=\"1B1A20\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2025-03-28 at 09.26.38</span><span class=\"informations\">3456√ó1982 193 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>As you can see the preview panel on the right is not there and the button to pop out the preview is also missing‚Ä¶ :(</p>",
      "raw": "I've been using typst for over a year and suddenly yesterday my preview panel got hidden and I can't get it back. I tried deleting the cache and history, force quit safari and restarted my macbook. Nothing seems to fix the issue. \nAttached a screenshot of a new empty document i created to show the problem.\n![Screenshot 2025-03-28 at 09.26.38|690x395](upload://oaZ6RlVqPYray3RYdANqpurPQP1.png)\n\nAs you can see the preview panel on the right is not there and the button to pop out the preview is also missing... :(",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 90.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1046
    },
    {
      "id": 10354,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2025-03-28T09:02:16.309Z",
      "updated_at": "2025-03-28T09:02:16.309Z",
      "cooked": "<p>In the menu on the top go to <code>View &gt; Show both panels</code>. It has to be selected to show both, the editor and the preview.</p>",
      "raw": "In the menu on the top go to `View > Show both panels`. It has to be selected to show both, the editor and the preview.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 29,
      "score": 30.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 10355,
      "post_number": 3,
      "username": "DominicoDino",
      "name": "",
      "created_at": "2025-03-28T09:06:16.764Z",
      "updated_at": "2025-03-28T09:06:16.764Z",
      "cooked": "<p>Hahaha thanks that was an easy fix, I don‚Äôt know how that triggered because I never changed anything in those settings. But thanks!!! :)</p>",
      "raw": "Hahaha thanks that was an easy fix, I don't know how that triggered because I never changed anything in those settings. But thanks!!! :)",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 10.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1046
    },
    {
      "id": 10383,
      "post_number": 4,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-03-28T18:44:51.899Z",
      "updated_at": "2025-03-28T18:44:51.899Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/dominicodino\">@DominicoDino</a>, I have moved your question to the <a class=\"hashtag-cooked\" href=\"/c/questions/5\" data-type=\"category\" data-slug=\"questions\" data-id=\"5\" data-ref=\"questions::category\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>Questions</span></a> category and added the <a class=\"hashtag-cooked\" href=\"/tag/web-app\" data-type=\"tag\" data-slug=\"web-app\" data-id=\"31\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>web-app</span></a> tag, please make sure to check the category when creating a topic <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"> Thanks!</p>\n<p>That also means that you can select an answer; I took the freedom of selecting it already, but I still wanted to make you aware that this exists <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hi @DominicoDino, I have moved your question to the #questions::category category and added the #web-app tag, please make sure to check the category when creating a topic :slight_smile: Thanks!\n\nThat also means that you can select an answer; I took the freedom of selecting it already, but I still wanted to make you aware that this exists :slight_smile:",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 21,
      "score": 34.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:49:53.497678"
}
{
  "topic_metadata": {
    "id": 344,
    "title": "Can I access the dimensions of a page?",
    "slug": "can-i-access-the-dimensions-of-a-page",
    "posts_count": 6,
    "created_at": "2024-09-16T13:47:28.441Z",
    "last_posted_at": "2024-10-03T20:16:28.341Z",
    "views": 741,
    "like_count": 8,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "laurmaedje",
    "tags": [
      "scripting",
      "page"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 384
  },
  "posts": [
    {
      "id": 1275,
      "post_number": 1,
      "username": "Brenden_Harrell",
      "name": "Brenden Harrell",
      "created_at": "2024-09-16T13:47:28.600Z",
      "updated_at": "2024-09-23T07:19:18.903Z",
      "cooked": "<p>Hi Everyone,</p>\n<p>I have made the bookletic package that splits the page into two smaller ones for ordering as a booklet. And right now I have the overall page size hardcoded so that I can divide it and set the size for the smaller pages but am trying to find a way to use the built in page sizes. Is there a way to ask the user of a function for a page size and use that within a function to get the actual dimensions of a type of paper?</p>",
      "raw": "Hi Everyone, \n\nI have made the bookletic package that splits the page into two smaller ones for ordering as a booklet. And right now I have the overall page size hardcoded so that I can divide it and set the size for the smaller pages but am trying to find a way to use the built in page sizes. Is there a way to ask the user of a function for a page size and use that within a function to get the actual dimensions of a type of paper?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 86,
      "score": 2987.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 285
    },
    {
      "id": 1283,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-09-16T14:13:31.637Z",
      "updated_at": "2024-09-16T14:13:31.637Z",
      "cooked": "<p>Hello!<br>\nYou can access page size using the <a href=\"https://typst.app/docs/reference/layout/layout/\"><code>layout</code></a> function.<br>\nFrom the official documentation:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#layout(size =&gt; {\n  let half = 50% * size.width\n  [Half a page is #half wide.]\n})\n</code></pre>",
      "raw": "Hello!\nYou can access page size using the [`layout`](https://typst.app/docs/reference/layout/layout/) function.\nFrom the official documentation:\n```typ\n#layout(size => {\n  let half = 50% * size.width\n  [Half a page is #half wide.]\n})\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 87,
      "score": 67.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 1311,
      "post_number": 3,
      "username": "laurmaedje",
      "name": "Laurenz M√§dje",
      "created_at": "2024-09-16T14:49:50.067Z",
      "updated_at": "2024-09-16T14:49:50.067Z",
      "cooked": "<p>To supplement the previous answer: While <code>layout</code> generally gives the dimensions of the currently surrounding container, <code>page.width</code> and <code>page.height</code> give the page height/width specifically. They are only available within <code>context</code>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(width: 500pt)\n#context page.width\n</code></pre>\n<p>However, <code>page.width</code> will always have the value of <code>width</code>, not of <code>height</code> when <code>flipped: true</code>. Moreover, as of Typst 0.11.1 the retrieval does not work when using an explicit <code>#page(width: ..)[..]</code>. This will be fixed in Typst 0.12.</p>\n<p>If it‚Äôs for a smaller piece of layout, the <code>layout</code> approach would be more robust in this regard. However, it comes at the cost of all the content within it being wrapped in a block-level container, so you can‚Äôt e.g. have pagebreaks within it and it can negatively affect layout of things like footnotes.</p>",
      "raw": "To supplement the previous answer: While `layout` generally gives the dimensions of the currently surrounding container, `page.width` and `page.height` give the page height/width specifically. They are only available within `context`.\n\n```typ\n#set page(width: 500pt)\n#context page.width\n````\n\nHowever, `page.width` will always have the value of `width`, not of `height` when `flipped: true`. Moreover, as of Typst 0.11.1 the retrieval does not work when using an explicit `#page(width: ..)[..]`. This will be fixed in Typst 0.12. \n\nIf it's for a smaller piece of layout, the `layout` approach would be more robust in this regard. However, it comes at the cost of all the content within it being wrapped in a block-level container, so you can't e.g. have pagebreaks within it and it can negatively affect layout of things like footnotes.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 83,
      "score": 61.6,
      "accepted_answer": true,
      "trust_level": 4,
      "user_id": 2
    },
    {
      "id": 3246,
      "post_number": 4,
      "username": "Brenden_Harrell",
      "name": "Brenden Harrell",
      "created_at": "2024-10-02T17:56:53.732Z",
      "updated_at": "2024-10-02T17:56:53.732Z",
      "cooked": "<p>I have tried the context approach but have not been able to assign the value to a variable for use throughout the rest of the code. When I assign it like this:<br>\n<code> let variable = context page.width</code></p>\n<p>The variable ends up having the context function itself assigned rather than the actual value. Am I missing something or is this a bug?</p>",
      "raw": "I have tried the context approach but have not been able to assign the value to a variable for use throughout the rest of the code. When I assign it like this:\n``` let variable = context page.width```\n\nThe variable ends up having the context function itself assigned rather than the actual value. Am I missing something or is this a bug?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 50,
      "score": 40.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 285
    },
    {
      "id": 3249,
      "post_number": 5,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-10-02T18:39:50.858Z",
      "updated_at": "2024-10-02T18:39:50.858Z",
      "cooked": "<p>See here:</p>\n<aside class=\"quote quote-modified\" data-post=\"2\" data-topic=\"164\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/laurmaedje/48/14_2.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164/2\">Why is the value I receive from context always content?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    When working with context, you need to put everything that depends on the contextual information into the context block/expression itself. The explicit context expression is a trade-off: You get to know where in the document you are (accessible via <a href=\"https://typst.app/docs/reference/introspection/here/\">here()</a>) and which set rules are active there (accessible via things like text.lang). In return, the context value itself becomes opaque. You cannot peek into it, so everything that depends on the contextual information must happen within it. \nLet‚Äôs lo‚Ä¶\n  </blockquote>\n</aside>\n",
      "raw": "See here:\n\nhttps://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164/2",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 49,
      "score": 54.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 3365,
      "post_number": 6,
      "username": "Brenden_Harrell",
      "name": "Brenden Harrell",
      "created_at": "2024-10-03T20:16:28.341Z",
      "updated_at": "2024-10-03T20:16:28.341Z",
      "cooked": "<p>Thank you! That works! This is the structure that ended up working for others who might need it:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let sig (/*arguments*/) =&gt; {\n//Initialize stuff\n  context {\n    let signature-paper-height = page.height\n    //Rest of package that uses value here\n  }\n}\n</code></pre>",
      "raw": "Thank you! That works! This is the structure that ended up working for others who might need it:\n```typst\n#let sig (/*arguments*/) => {\n//Initialize stuff\n  context {\n    let signature-paper-height = page.height\n    //Rest of package that uses value here\n  }\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 40,
      "score": 38.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 285
    }
  ],
  "scraped_at": "2025-06-10T09:58:51.955716"
}
{
  "topic_metadata": {
    "id": 3450,
    "title": "How to conditionally modify one field (column) in a table?",
    "slug": "how-to-conditionally-modify-one-field-column-in-a-table",
    "posts_count": 7,
    "created_at": "2025-03-29T18:06:23.649Z",
    "last_posted_at": "2025-03-30T14:57:53.653Z",
    "views": 99,
    "like_count": 2,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "tables"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 378
  },
  "posts": [
    {
      "id": 10396,
      "post_number": 1,
      "username": "ondohotola",
      "name": "Eberhard W Lisse",
      "created_at": "2025-03-29T18:06:23.758Z",
      "updated_at": "2025-03-30T12:11:19.945Z",
      "cooked": "<p>Given a table <code>passwords.yaml</code>  with the content of</p>\n<pre data-code-wrap=\"yaml\"><code class=\"lang-yaml\">--- # User, Password, Shell\n-\n    - \"u1\"\n    -  \"p1\"\n    -  \"/bin/sh\"\n-   \n    - \"u2\"\n    -  \"p2\"\n    -  \"/bin/sh\"\n-\n    - \"u3\"\n    -  \"p3\"\n    - \"/opt/homebrew/bin/bash\"\n</code></pre>\n<p>I use the following typst fragment</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let data = yaml(\"passwords.yaml\")\n#figure(\n  kind: table,\n  align(center)[\n    #table(\n      columns: 3,\n      align: (left, left, left),\n      [*#align(center)[User]*], \n        [*#align(center)[Password]*], \n        [*#align(center)[Shell]*],\n      ..data.flatten()\n    )\n  ],\n  caption: [passwords.yaml],\n) &lt;passwords.yaml&gt;\n</code></pre>\n<p>which produces the expected table.</p>\n<p>I would like to obfuscate the passwords (column 1 (starting with 0)) depending on the value of <code>OBF</code> using something like</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let OBF = \"TRUE\"\n#let HASH = \"###########\"\n</code></pre>\n<p>Is that possible without conditionalizing the whole figure?</p>",
      "raw": "Given a table `passwords.yaml`  with the content of\n\n```yaml\n--- # User, Password, Shell\n-\n    - \"u1\"\n    -  \"p1\"\n    -  \"/bin/sh\"\n-   \n    - \"u2\"\n    -  \"p2\"\n    -  \"/bin/sh\"\n-\n    - \"u3\"\n    -  \"p3\"\n    - \"/opt/homebrew/bin/bash\"\n```\nI use the following typst fragment\n\n```typst\n#let data = yaml(\"passwords.yaml\")\n#figure(\n  kind: table,\n  align(center)[\n    #table(\n      columns: 3,\n      align: (left, left, left),\n      [*#align(center)[User]*], \n        [*#align(center)[Password]*], \n        [*#align(center)[Shell]*],\n      ..data.flatten()\n    )\n  ],\n  caption: [passwords.yaml],\n) <passwords.yaml>\n```\nwhich produces the expected table.\n\n\nI would like to obfuscate the passwords (column 1 (starting with 0)) depending on the value of `OBF` using something like\n\n```typst\n#let OBF = \"TRUE\"\n#let HASH = \"###########\"\n```\n\n\nIs that possible without conditionalizing the whole figure?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 140.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 644
    },
    {
      "id": 10397,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-29T18:35:08.671Z",
      "updated_at": "2025-03-29T19:41:05.374Z",
      "cooked": "<p>Hello, this topic is a question, so please use <a class=\"hashtag-cooked\" href=\"/c/questions/5\" data-type=\"category\" data-slug=\"questions\" data-id=\"5\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>Questions</span></a> category for such topics.</p>\n<p>First of all, passwords are a very sensitive topic, so I hope you know what you are doing.</p>\n<p>There can be various solutions, but here is a very simple one + I simplified your code:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let passwords = ```yaml\n--- # User, Password, Shell\n-\n    - \"u1\"\n    -  \"p1\"\n    -  \"/bin/sh\"\n-\n    - \"u2\"\n    -  \"p2\"\n    -  \"/bin/sh\"\n-\n    - \"u3\"\n    -  \"p3\"\n    - \"/opt/homebrew/bin/bash\"\n```.text\n\n#let OBF = false\n#let OBF = true // Comment this to toggle.\n#let HASH = \"###########\"\n\n#let data = yaml(bytes(passwords))\n#if OBF {\n  data = data.map(row =&gt; {\n    row.at(1) = HASH\n    row\n  })\n}\n#show table.cell.where(y: 0): strong\n#figure(\n  table(\n    columns: 3,\n    align: (x, y) =&gt; if y == 0 { center } else { left },\n    table.header[User][Password][Shell],\n    ..data.flatten(),\n  ),\n  caption: [passwords.yaml],\n) &lt;passwords.yaml&gt;\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/6/6b2ae44356d2f0075415bd6d0d4fcdb87dbbd2a6.png\" alt=\"image\" data-base62-sha1=\"fi2Z1zqecOmeZq0tuEqW6a9oQ3c\" width=\"407\" height=\"171\"></p>",
      "raw": "Hello, this topic is a question, so please use #questions category for such topics.\n\nFirst of all, passwords are a very sensitive topic, so I hope you know what you are doing.\n\nThere can be various solutions, but here is a very simple one + I simplified your code:\n\n```typ\n#let passwords = ```yaml\n--- # User, Password, Shell\n-\n    - \"u1\"\n    -  \"p1\"\n    -  \"/bin/sh\"\n-\n    - \"u2\"\n    -  \"p2\"\n    -  \"/bin/sh\"\n-\n    - \"u3\"\n    -  \"p3\"\n    - \"/opt/homebrew/bin/bash\"\n```.text\n\n#let OBF = false\n#let OBF = true // Comment this to toggle.\n#let HASH = \"###########\"\n\n#let data = yaml(bytes(passwords))\n#if OBF {\n  data = data.map(row => {\n    row.at(1) = HASH\n    row\n  })\n}\n#show table.cell.where(y: 0): strong\n#figure(\n  table(\n    columns: 3,\n    align: (x, y) => if y == 0 { center } else { left },\n    table.header[User][Password][Shell],\n    ..data.flatten(),\n  ),\n  caption: [passwords.yaml],\n) <passwords.yaml>\n```\n\n![image|407x171](upload://fi2Z1zqecOmeZq0tuEqW6a9oQ3c.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 20.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10400,
      "post_number": 3,
      "username": "ondohotola",
      "name": "Eberhard W Lisse",
      "created_at": "2025-03-29T18:42:44.838Z",
      "updated_at": "2025-03-29T18:44:08.637Z",
      "cooked": "<p>Thank you.</p>\n<p>I am fully aware of the password sensitivity.</p>\n<p>Is there a way of moving it over to Questions?</p>",
      "raw": "Thank you.\n\nI am fully aware of the password sensitivity.\n\nIs there a way of moving it over to Questions?",
      "reply_to_post_number": 2,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 26,
      "score": 30.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 644
    },
    {
      "id": 10401,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-29T19:39:41.137Z",
      "updated_at": "2025-03-29T19:39:41.137Z",
      "cooked": "<p>Edit your original post and select <a class=\"hashtag-cooked\" href=\"/c/questions/5\" data-type=\"category\" data-slug=\"questions\" data-id=\"5\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>Questions</span></a> category under the title name in the edit window.</p>",
      "raw": "Edit your original post and select #questions category under the title name in the edit window.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 5.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10411,
      "post_number": 5,
      "username": "ondohotola",
      "name": "Eberhard W Lisse",
      "created_at": "2025-03-30T11:21:09.248Z",
      "updated_at": "2025-03-30T11:21:09.248Z",
      "cooked": "<p>Done, thanks you very much</p>",
      "raw": "Done, thanks you very much",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 23,
      "score": 19.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 644
    },
    {
      "id": 10420,
      "post_number": 6,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-03-30T12:12:21.254Z",
      "updated_at": "2025-03-30T12:12:21.254Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/ondohotola\">@ondohotola</a>, thank you for your question! I have changed your post‚Äôs title to bring it in line with the <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">question guidelines</a> and thus make it easier to understand from the title:</p>\n<blockquote>\n<p><strong>Good titles are questions you would ask your friend about Typst.</strong></p>\n</blockquote>\n<p>I also added the <a class=\"hashtag-cooked\" href=\"/tag/tables\" data-type=\"tag\" data-slug=\"tables\" data-id=\"53\" data-ref=\"tables::tag\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>tables</span></a> tag, as it makes your question easier to find. Thank you for already moving your topic as Andrew described <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hi @ondohotola, thank you for your question! I have changed your post‚Äôs title to bring it in line with the [question guidelines](https://forum.typst.app/t/how-to-post-in-the-questions-category/11) and thus make it easier to understand from the title:\n\n> **Good titles are questions you would ask your friend about Typst.**\n\nI also added the #tables::tag tag, as it makes your question easier to find. Thank you for already moving your topic as Andrew described :slight_smile:",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 29.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 10436,
      "post_number": 7,
      "username": "ondohotola",
      "name": "Eberhard W Lisse",
      "created_at": "2025-03-30T14:57:53.653Z",
      "updated_at": "2025-03-30T14:57:53.653Z",
      "cooked": "<p>Ah, ok. Did not know that one either.</p>\n<p>Thank you as well.</p>",
      "raw": "Ah, ok. Did not know that one either.\n\nThank you as well.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 4.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 644
    }
  ],
  "scraped_at": "2025-06-10T09:49:52.746855"
}
{
  "topic_metadata": {
    "id": 3456,
    "title": "How to get the number of the first and last paragraph on a page and show the result in the header?",
    "slug": "how-to-get-the-number-of-the-first-and-last-paragraph-on-a-page-and-show-the-result-in-the-header",
    "posts_count": 15,
    "created_at": "2025-03-30T08:52:39.384Z",
    "last_posted_at": "2025-04-06T10:43:57.782Z",
    "views": 202,
    "like_count": 8,
    "reply_count": 10,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 8,
    "accepted_answer_username": "sijo",
    "tags": [
      "scripting",
      "header-footer",
      "state",
      "query"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 5241
  },
  "posts": [
    {
      "id": 10408,
      "post_number": 1,
      "username": "a_w",
      "name": "Alex",
      "created_at": "2025-03-30T08:52:39.650Z",
      "updated_at": "2025-03-30T10:07:36.764Z",
      "cooked": "<p>I‚Äôm trying to layout pages that contain numbered paragraphs and want to give the reader a better overview where they are (e.g. site contains paragraphs 1‚Äì7). Something like this:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/b/b71b8c1773360ae0890c7c9c4490b124d5de166c.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/b71b8c1773360ae0890c7c9c4490b124d5de166c\" title=\"layout-example\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/b/b71b8c1773360ae0890c7c9c4490b124d5de166c_2_690x489.jpeg\" alt=\"layout-example\" data-base62-sha1=\"q7QoBaw6waHnBQCegdgpu6Jw3uc\" width=\"690\" height=\"489\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/b/b71b8c1773360ae0890c7c9c4490b124d5de166c_2_690x489.jpeg, https://forum.typst.app/uploads/default/optimized/2X/b/b71b8c1773360ae0890c7c9c4490b124d5de166c_2_1035x733.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/b/b71b8c1773360ae0890c7c9c4490b124d5de166c_2_1380x978.jpeg 2x\" data-dominant-color=\"ECECEC\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">layout-example</span><span class=\"informations\">1650√ó1170 151 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>What I‚Äôm struggling with: Paragraphs that span multiple pages and finding the best possible solution overall. Paragraphs can contain linebreaks and formatting and being able to link to them would be cool in the future.</p>\n<p>My first approach of counting the elements was mistaken thinking, as the content itself is already numbered (differences in numbering/doubled numbers). I‚Äôve also realized that wrapping the elements like <code>#par[id: \"1\", lorem(50)]</code> doesn‚Äôt bring obvious benefits in comparison to <code>#par(1)[1.]~#lorem(50)</code> (par numbers attached to the following content) in terms of querying.</p>\n<p>My current quite sorry working example is:</p>\n<details>\n<summary>\nCode</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(width: 100mm, height: 100mm)\n\n#let par(id: none, body) = {\n  show heading.where(level: 4): it =&gt; {\n    set text(weight: \"regular\")\n    [#strong(id + \". \")] + it.body\n  }\n  heading(level: 4, supplement: id)[#body]\n}\n\n#show heading.where(level: 1): it =&gt; {\n  pagebreak(weak: true)\n  it\n}\n\n#set page(\n  header: {\n    context {\n      // Getting current Chapter title (supplement)\n      let headings = query(selector(heading.where(level: 1)))\n      let h = headings.filter(h =&gt; h.location().page() &lt;= here().page()).last()\n      if h != none {\n        h.supplement\n      }\n\n      // Get paragraphs on current page\n      let paragraphs = query(selector(heading.where(level: 4))).filter(h4 =&gt; here().page() == h4.location().page())\n      \n      if paragraphs.len() == 0 { } else if paragraphs.last() == paragraphs.first() {\n        [ ] + paragraphs.first().supplement\n      } else {\n        [ ] + paragraphs.first().supplement + \"-\" + paragraphs.last().supplement\n      }\n  }},\n)\n\n#heading(level: 1, supplement: \"A-Chapter\")[This is Chapter A]\n#par(id: \"1\", lorem(50))\n#par(id: \"2\", lorem(20))\n#par(id: \"3\", lorem(150))\n\n#heading(level: 1, supplement: \"B-Chapter\")[This is Chapter B]\n#par(id: \"11\", lorem(50))\n#par(id: \"12\", lorem(20))\n\n#heading(level: 1, supplement: \"C-Chapter\")[This is Chapter C]\n#par(id: \"21a\", lorem(50))\n</code></pre>\n</details>\n<p>This leads to:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/4/407405a38151ae8944b9e14fd9419ea5776cfd10.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/407405a38151ae8944b9e14fd9419ea5776cfd10\" title=\"query-example\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/4/407405a38151ae8944b9e14fd9419ea5776cfd10_2_259x500.jpeg\" alt=\"query-example\" data-base62-sha1=\"9cb8jGuBO9mhTn7x5tcTRR9znpe\" width=\"259\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/4/407405a38151ae8944b9e14fd9419ea5776cfd10_2_259x500.jpeg, https://forum.typst.app/uploads/default/optimized/2X/4/407405a38151ae8944b9e14fd9419ea5776cfd10_2_388x750.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/4/407405a38151ae8944b9e14fd9419ea5776cfd10_2_518x1000.jpeg 2x\" data-dominant-color=\"EBEBEB\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">query-example</span><span class=\"informations\">876√ó1686 242 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>What I actually like about the approach: <code>#par(id: \"1\", lorem(50))</code> the <code>id</code> as a string gives total control over the ID it can also be <code>I.</code> or <code>22a</code> whenever needed. Even though I have to ‚Äúabuse‚Äù supplement to access it. Using the headline also makes the paragraphs potentially linkable.</p>\n<p>What my questions are:</p>\n<ul>\n<li>\n<p>How can I use state (or something else?) to carry the last paragraph number to the following page(s) theoretically a paragraph could span multiple pages?</p>\n</li>\n<li>\n<p>I don‚Äôt feel this is the best solution to achieve what I want. I‚Äôm fluctuating between ‚Äúthis is overengineered‚Äù (maybe I could just get the highest ID without querying) and this is stupid (setting ID as string, than using supplement). Is there overall a better approach?</p>\n</li>\n</ul>\n<p>Help and guidance greatly appreciated I just couldn‚Äôt figure it out :x</p>",
      "raw": "I'm trying to layout pages that contain numbered paragraphs and want to give the reader a better overview where they are (e.g. site contains paragraphs 1‚Äì7). Something like this:\n\n![layout-example|690x489](upload://q7QoBaw6waHnBQCegdgpu6Jw3uc.jpeg)\n\nWhat I'm struggling with: Paragraphs that span multiple pages and finding the best possible solution overall. Paragraphs can contain linebreaks and formatting and being able to link to them would be cool in the future.\n\nMy first approach of counting the elements was mistaken thinking, as the content itself is already numbered (differences in numbering/doubled numbers). I've also realized that wrapping the elements like `#par[id: \"1\", lorem(50)]` doesn't bring obvious benefits in comparison to `#par(1)[1.]~#lorem(50)` (par numbers attached to the following content) in terms of querying.\n\nMy current quite sorry working example is:\n[details=\"Code\"]\n```typ\n#set page(width: 100mm, height: 100mm)\n\n#let par(id: none, body) = {\n  show heading.where(level: 4): it => {\n    set text(weight: \"regular\")\n    [#strong(id + \". \")] + it.body\n  }\n  heading(level: 4, supplement: id)[#body]\n}\n\n#show heading.where(level: 1): it => {\n  pagebreak(weak: true)\n  it\n}\n\n#set page(\n  header: {\n    context {\n      // Getting current Chapter title (supplement)\n      let headings = query(selector(heading.where(level: 1)))\n      let h = headings.filter(h => h.location().page() <= here().page()).last()\n      if h != none {\n        h.supplement\n      }\n\n      // Get paragraphs on current page\n      let paragraphs = query(selector(heading.where(level: 4))).filter(h4 => here().page() == h4.location().page())\n      \n      if paragraphs.len() == 0 { } else if paragraphs.last() == paragraphs.first() {\n        [ ] + paragraphs.first().supplement\n      } else {\n        [ ] + paragraphs.first().supplement + \"-\" + paragraphs.last().supplement\n      }\n  }},\n)\n\n#heading(level: 1, supplement: \"A-Chapter\")[This is Chapter A]\n#par(id: \"1\", lorem(50))\n#par(id: \"2\", lorem(20))\n#par(id: \"3\", lorem(150))\n\n#heading(level: 1, supplement: \"B-Chapter\")[This is Chapter B]\n#par(id: \"11\", lorem(50))\n#par(id: \"12\", lorem(20))\n\n#heading(level: 1, supplement: \"C-Chapter\")[This is Chapter C]\n#par(id: \"21a\", lorem(50))\n```\n[/details]\n\nThis leads to:\n\n![query-example|259x500](upload://9cb8jGuBO9mhTn7x5tcTRR9znpe.jpeg)\n\nWhat I actually like about the approach: `#par(id: \"1\", lorem(50))` the `id` as a string gives total control over the ID it can also be `I.` or `22a` whenever needed. Even though I have to \"abuse\" supplement to access it. Using the headline also makes the paragraphs potentially linkable.\n\nWhat my questions are:\n\n- How can I use state (or something else?) to carry the last paragraph number to the following page(s) theoretically a paragraph could span multiple pages?\n\n- I don't feel this is the best solution to achieve what I want. I'm fluctuating between \"this is overengineered\" (maybe I could just get the highest ID without querying) and this is stupid (setting ID as string, than using supplement). Is there overall a better approach?\n\nHelp and guidance greatly appreciated I just couldn't figure it out :x",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 43,
      "score": 128.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 566
    },
    {
      "id": 10409,
      "post_number": 2,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-03-30T10:21:26.570Z",
      "updated_at": "2025-03-30T10:25:04.648Z",
      "cooked": "<p>No idea about the bigger picture, but for the particular problem, maybe this works.</p>\n<p>Tag some id information at the start of every paragraph</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">[#metadata((id: id))&lt;par&gt;]\n</code></pre>\n<p>In the header, if there‚Äôs nothing else, remember the last seen start of paragraph</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">let previous_paragraphs = query(selector(&lt;par&gt;).before(here()))\nif paragraphs.len() == 0 and previous_paragraphs.len() &gt; 0 {\n  [ (#previous_paragraphs.last().value.id;)]\n}\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/f/f8426564783e5bec1eb567655f4897168d77534d.png\" alt=\"bild\" data-base62-sha1=\"zqcFgv4RTOfNs5K2suDdyVpSfX7\" width=\"373\" height=\"140\"></p>\n<p>Note that there is already a built-in element called par, so your function should probably have a different name.</p>\n<p>Now that I think of it, your existing approach also gives you another way to solve it - filter on page but use <code>&lt;=</code> instead of <code>==</code> for page, and take the last. Should have the same effect without needing to add metadata elements.</p>",
      "raw": "No idea about the bigger picture, but for the particular problem, maybe this works.\n\nTag some id information at the start of every paragraph\n\n```typc\n[#metadata((id: id))<par>]\n```\n\nIn the header, if there's nothing else, remember the last seen start of paragraph\n\n```typc\nlet previous_paragraphs = query(selector(<par>).before(here()))\nif paragraphs.len() == 0 and previous_paragraphs.len() > 0 {\n  [ (#previous_paragraphs.last().value.id;)]\n}\n```\n\n![bild|373x140](upload://zqcFgv4RTOfNs5K2suDdyVpSfX7.png)\n\n\nNote that there is already a built-in element called par, so your function should probably have a different name.\n\nNow that I think of it, your existing approach also gives you another way to solve it - filter on page but use `<=` instead of `==` for page, and take the last. Should have the same effect without needing to add metadata elements.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 40,
      "score": 38.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 10410,
      "post_number": 3,
      "username": "sijo",
      "name": "",
      "created_at": "2025-03-30T10:48:23.652Z",
      "updated_at": "2025-03-30T10:51:27.646Z",
      "cooked": "<p>That works if you know there cannot be a page without paragraph‚Ä¶ If this case must also be handled you probably need the metadata, for example:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let id(x) = if x.func() == heading { x.body } else { x.value }\n    let pars = query(heading.where(level: 4).or(&lt;h4-end&gt;))\n      .filter(x =&gt; x.location().page() == here().page())\n      .map(id)\n      .dedup()\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -&gt; check if a paragraph starts before and ends after this page\n      let prev = query(heading.where(level: 4).before(here()))\n      let next = query(selector(&lt;h4-end&gt;).after(here()))\n      if prev.len() == 0 or next.len() == 0 {\n        return none\n      }\n      if prev.last().body != next.first().value {\n        return none\n      }\n      return prev.last().body\n    }\n    if pars.len() == 1 {\n      return pars.first()\n    }\n    return [#pars.first() -- #pars.last()]\n  },\n)\n\n#show heading.where(level: 4): it =&gt; it.body + h(1em)\n\n#let my-par(id: none, body) = {\n  parbreak()\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  box[#metadata([#id])&lt;h4-end&gt;]\n}\n\n#heading(level: 1, supplement: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n#my-par(id: \"3\", lorem(150))\n\n#heading(level: 1, supplement: \"B-Chapter\")[This is Chapter B]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"12\", lorem(180))\n\n#heading(level: 1, supplement: \"B-Chapter\")[This is Chapter C]\n#my-par(id: \"21a\", lorem(50))\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/6/667c806df71f29ee53f4bb5898aeef8b464877e8.png\" data-download-href=\"https://forum.typst.app/uploads/default/667c806df71f29ee53f4bb5898aeef8b464877e8\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/6/667c806df71f29ee53f4bb5898aeef8b464877e8_2_690x458.png\" alt=\"image\" data-base62-sha1=\"eCDrCT5PYq3iNCf85fc55uQxHx6\" width=\"690\" height=\"458\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/6/667c806df71f29ee53f4bb5898aeef8b464877e8_2_690x458.png, https://forum.typst.app/uploads/default/optimized/2X/6/667c806df71f29ee53f4bb5898aeef8b464877e8_2_1035x687.png 1.5x, https://forum.typst.app/uploads/default/original/2X/6/667c806df71f29ee53f4bb5898aeef8b464877e8.png 2x\" data-dominant-color=\"EEEEEE\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1368√ó910 341 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Compared to the original solution, this uses the level-4 heading just for the paragraph number rather than the whole paragraph. I think that‚Äôs much cleaner, and then you can use the usual styling system to change the appearance of the paragraph number.</p>\n<p>It could be technically feasible to add the numbering with a <code>par</code> show rule, so that actual paragraphs are automatically numbered as you want (instead of calling a custom-defined <code>par</code> function). But it‚Äôs tricky to work with <code>par</code> show rules, and it becomes a pain when your document has paragraphs that should not be numbered (for example in a table or long caption). So the explicit call for each paragraph is probably better.</p>",
      "raw": "That works if you know there cannot be a page without paragraph... If this case must also be handled you probably need the metadata, for example:\n\n```typ\n#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let id(x) = if x.func() == heading { x.body } else { x.value }\n    let pars = query(heading.where(level: 4).or(<h4-end>))\n      .filter(x => x.location().page() == here().page())\n      .map(id)\n      .dedup()\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -> check if a paragraph starts before and ends after this page\n      let prev = query(heading.where(level: 4).before(here()))\n      let next = query(selector(<h4-end>).after(here()))\n      if prev.len() == 0 or next.len() == 0 {\n        return none\n      }\n      if prev.last().body != next.first().value {\n        return none\n      }\n      return prev.last().body\n    }\n    if pars.len() == 1 {\n      return pars.first()\n    }\n    return [#pars.first() -- #pars.last()]\n  },\n)\n\n#show heading.where(level: 4): it => it.body + h(1em)\n\n#let my-par(id: none, body) = {\n  parbreak()\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  box[#metadata([#id])<h4-end>]\n}\n\n#heading(level: 1, supplement: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n#my-par(id: \"3\", lorem(150))\n\n#heading(level: 1, supplement: \"B-Chapter\")[This is Chapter B]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"12\", lorem(180))\n\n#heading(level: 1, supplement: \"B-Chapter\")[This is Chapter C]\n#my-par(id: \"21a\", lorem(50))\n```\n\n![image|690x458](upload://eCDrCT5PYq3iNCf85fc55uQxHx6.png)\n\n\nCompared to the original solution, this uses the level-4 heading just for the paragraph number rather than the whole paragraph. I think that's much cleaner, and then you can use the usual styling system to change the appearance of the paragraph number.\n\nIt could be technically feasible to add the numbering with a `par` show rule, so that actual paragraphs are automatically numbered as you want (instead of calling a custom-defined `par` function). But it's tricky to work with `par` show rules, and it becomes a pain when your document has paragraphs that should not be numbered (for example in a table or long caption). So the explicit call for each paragraph is probably better.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 36,
      "score": 37.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 10413,
      "post_number": 4,
      "username": "a_w",
      "name": "Alex",
      "created_at": "2025-03-30T11:32:19.172Z",
      "updated_at": "2025-03-30T11:32:19.172Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/bluss\">@bluss</a> this is certainly an interesting idea and an alternative to <code>state()</code>, which I thought would be probably necessary. And you are of course right that my <code>#par</code> needs to be renamed. Thanks.</p>\n<p><a class=\"mention\" href=\"/u/sijo\">@sijo</a> Omg, nice‚Ä¶ thanks! This is already quite close to what I wanted to achieve. Querying between the headlines instead of the pages has the added benefit that I don‚Äôt have to force pagebreak the chapters to get it right. I wish I was as capable with using query <img src=\"https://forum.typst.app/images/emoji/apple/face_holding_back_tears.png?v=12\" title=\":face_holding_back_tears:\" class=\"emoji\" alt=\":face_holding_back_tears:\" loading=\"lazy\" width=\"20\" height=\"20\"> and I wholeheartedly agree using the heading only for the number is indeed much cleaner and probably avoids downstream problems.</p>\n<p>May I ask a follow-up: How would you handle the 3 ‚Äì 11 case or 12 ‚Äì 21a case where the paragraph numbers cross chapters?</p>\n<p>What do you think of the supplement workaround for the short chapter titles?</p>",
      "raw": "@bluss this is certainly an interesting idea and an alternative to `state()`, which I thought would be probably necessary. And you are of course right that my `#par` needs to be renamed. Thanks.\n\n@sijo Omg, nice‚Ä¶ thanks! This is already quite close to what I wanted to achieve. Querying between the headlines instead of the pages has the added benefit that I don't have to force pagebreak the chapters to get it right. I wish I was as capable with using query ü•π and I wholeheartedly agree using the heading only for the number is indeed much cleaner and probably avoids downstream problems.\n\nMay I ask a follow-up: How would you handle the 3 ‚Äì 11 case or 12 ‚Äì 21a case where the paragraph numbers cross chapters?\n\nWhat do you think of the supplement workaround for the short chapter titles?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 11.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 566
    },
    {
      "id": 10421,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-30T12:13:58.734Z",
      "updated_at": "2025-03-31T11:20:38.238Z",
      "cooked": "<p>I‚Äôm not sure if you want more like in the sample page or more like in your example, so I copied the sample page:</p>\n<details><summary>code</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let header = context {\n  let page = here().page()\n  place(right + bottom)[#page]\n  let headings = {\n    query(heading.where(level: 4)).filter(x =&gt; x.location().page() == page)\n  }\n  let current-headings = headings.map(x =&gt; int(x.body.text))\n  if current-headings.len() == 0 {\n    let pars = query(&lt;par&gt;).filter(x =&gt; x.location().page() == page)\n    if pars.len() == 0 { return }\n    let last-headings = query(heading.where(level: 4).before(here()))\n    if last-headings.len() == 0 { return }\n    current-headings = (last-headings.last().body.text,)\n  }\n  if current-headings.len() == 1 { current-headings = current-headings * 2 }\n  let (a, b) = (current-headings.first(), current-headings.last())\n  place(center + bottom)[Nr. #(a)---#b.]\n}\n\n#let decorative-lines = context {\n  let line(start, len, ..args) = std.line(start: start, length: len, ..args)\n  let top = page.margin.top\n  let left = page.margin.left\n  // Vertical line\n  let length = page.height - page.margin.top - page.margin.bottom\n  place(center, line((0%, top + 1mm), length - 1mm, angle: 90deg))\n  // Horizontal line\n  let length = page.width - page.margin.left - page.margin.right\n  place(line((left, top - 3mm), length, stroke: 3pt))\n}\n\n#set page(\n  width: 270mm,\n  height: 250mm,\n  margin: (top: 2cm, rest: 1cm),\n  columns: 2,\n  background: decorative-lines,\n  header: header,\n)\n#set columns(gutter: 3mm * 2)\n#set par(justify: true, first-line-indent: (amount: 1em, all: true))\n// #show par: it =&gt; [#it&lt;par&gt;] // Doesn't work.\n#show par: it =&gt; [#metadata(none)&lt;par&gt;#it&lt;par&gt;#metadata(none)&lt;par&gt;]\n\n#show heading.where(level: 4): set align(center)\n#show heading.where(level: 4): set text(1.5em)\n#show heading.where(level: 4): it =&gt; block(box(it) + \".\")\n\n#(pagebreak() * 118)\n\n==== 210\n#lorem(50)\n\n#lorem(20)\n\n#lorem(40)\n\n#lorem(30)\n\n==== 211\n#lorem(50)\n\n#lorem(50)\n\n==== 212\n#lorem(50)\n\n#lorem(50)\n\n#lorem(60)\n\n#lorem(40)\n\n#lorem(90)\n\n==== 213\n#lorem(70)\n\n==== 214\n#lorem(90)\n\n#lorem(90)\n</code></pre>\n</details>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/7/7c49c80c995caaaaa28515a9eed8e820235d89af.png\" data-download-href=\"https://forum.typst.app/uploads/default/7c49c80c995caaaaa28515a9eed8e820235d89af\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/7/7c49c80c995caaaaa28515a9eed8e820235d89af_2_542x500.png\" alt=\"image\" data-base62-sha1=\"hJvhvl74xmNVIiK8Cmi1gaqPuov\" width=\"542\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/7/7c49c80c995caaaaa28515a9eed8e820235d89af_2_542x500.png, https://forum.typst.app/uploads/default/optimized/2X/7/7c49c80c995caaaaa28515a9eed8e820235d89af_2_813x750.png 1.5x, https://forum.typst.app/uploads/default/original/2X/7/7c49c80c995caaaaa28515a9eed8e820235d89af.png 2x\" data-dominant-color=\"232323\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">959√ó884 280 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/f/f87efd462491815cea24d57906a4711b3e9e957e.png\" data-download-href=\"https://forum.typst.app/uploads/default/f87efd462491815cea24d57906a4711b3e9e957e\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/f/f87efd462491815cea24d57906a4711b3e9e957e_2_550x499.png\" alt=\"image\" data-base62-sha1=\"zsiu8zMkQjl42BPvlGKCheXXA2q\" width=\"550\" height=\"499\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/f/f87efd462491815cea24d57906a4711b3e9e957e_2_550x499.png, https://forum.typst.app/uploads/default/optimized/2X/f/f87efd462491815cea24d57906a4711b3e9e957e_2_825x748.png 1.5x, https://forum.typst.app/uploads/default/original/2X/f/f87efd462491815cea24d57906a4711b3e9e957e.png 2x\" data-dominant-color=\"101010\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">957√ó870 39.4 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>This is a code with manual numbering sections, which makes sense, but it‚Äôs very easy to miscount.</p>\n<p>You can add this assertion to keep yourself in check:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let header = context {\n  let page = here().page()\n  place(right + bottom)[#page]\n  let all-headings = query(heading.where(level: 4))\n  if all-headings.len() == 0 { return }\n  assert(int(all-headings.last().body.text) == all-headings.len())\n  let headings = {\n</code></pre>\n<p>I can change <code>==== 69</code> to <code>#section-break</code>, but I don‚Äôt know enough details of the ideal output.</p>",
      "raw": "I'm not sure if you want more like in the sample page or more like in your example, so I copied the sample page:\n\n<details><summary>code</summary>\n\n```typ\n#let header = context {\n  let page = here().page()\n  place(right + bottom)[#page]\n  let headings = {\n    query(heading.where(level: 4)).filter(x => x.location().page() == page)\n  }\n  let current-headings = headings.map(x => int(x.body.text))\n  if current-headings.len() == 0 {\n    let pars = query(<par>).filter(x => x.location().page() == page)\n    if pars.len() == 0 { return }\n    let last-headings = query(heading.where(level: 4).before(here()))\n    if last-headings.len() == 0 { return }\n    current-headings = (last-headings.last().body.text,)\n  }\n  if current-headings.len() == 1 { current-headings = current-headings * 2 }\n  let (a, b) = (current-headings.first(), current-headings.last())\n  place(center + bottom)[Nr. #(a)---#b.]\n}\n\n#let decorative-lines = context {\n  let line(start, len, ..args) = std.line(start: start, length: len, ..args)\n  let top = page.margin.top\n  let left = page.margin.left\n  // Vertical line\n  let length = page.height - page.margin.top - page.margin.bottom\n  place(center, line((0%, top + 1mm), length - 1mm, angle: 90deg))\n  // Horizontal line\n  let length = page.width - page.margin.left - page.margin.right\n  place(line((left, top - 3mm), length, stroke: 3pt))\n}\n\n#set page(\n  width: 270mm,\n  height: 250mm,\n  margin: (top: 2cm, rest: 1cm),\n  columns: 2,\n  background: decorative-lines,\n  header: header,\n)\n#set columns(gutter: 3mm * 2)\n#set par(justify: true, first-line-indent: (amount: 1em, all: true))\n// #show par: it => [#it<par>] // Doesn't work.\n#show par: it => [#metadata(none)<par>#it<par>#metadata(none)<par>]\n\n#show heading.where(level: 4): set align(center)\n#show heading.where(level: 4): set text(1.5em)\n#show heading.where(level: 4): it => block(box(it) + \".\")\n\n#(pagebreak() * 118)\n\n==== 210\n#lorem(50)\n\n#lorem(20)\n\n#lorem(40)\n\n#lorem(30)\n\n==== 211\n#lorem(50)\n\n#lorem(50)\n\n==== 212\n#lorem(50)\n\n#lorem(50)\n\n#lorem(60)\n\n#lorem(40)\n\n#lorem(90)\n\n==== 213\n#lorem(70)\n\n==== 214\n#lorem(90)\n\n#lorem(90)\n```\n\n</details>\n\n\n![image|542x500](upload://hJvhvl74xmNVIiK8Cmi1gaqPuov.png)\n![image|550x499](upload://zsiu8zMkQjl42BPvlGKCheXXA2q.png)\n\nThis is a code with manual numbering sections, which makes sense, but it's very easy to miscount.\n\nYou can add this assertion to keep yourself in check:\n\n```typ\n#let header = context {\n  let page = here().page()\n  place(right + bottom)[#page]\n  let all-headings = query(heading.where(level: 4))\n  if all-headings.len() == 0 { return }\n  assert(int(all-headings.last().body.text) == all-headings.len())\n  let headings = {\n```\n\nI can change `==== 69` to `#section-break`, but I don't know enough details of the ideal output.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 34,
      "score": 21.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10431,
      "post_number": 6,
      "username": "sijo",
      "name": "",
      "created_at": "2025-03-30T13:21:10.765Z",
      "updated_at": "2025-03-30T13:22:00.804Z",
      "cooked": "<p>The supplement thing is rather hacky, it could cause problems with outlines or references. So I‚Äôd rather use a custom heading command that adds ‚Äúshort title‚Äù metadata that can be retrieved in the header:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let id(x) = if x.func() == heading { x.body } else { x.value }\n    // Returns content showing short chapter title and paragraph number\n    let chap-id(x) = {\n      let shorts = query(selector(&lt;h1-short&gt;).before(x.location()))\n      if shorts.len() == 0 {\n        id(x)\n      } else [\n        #shorts.last().value: #id(x)\n      ]\n    }\n    let pars = query(heading.where(level: 4).or(&lt;h4-end&gt;))\n      .filter(x =&gt; x.location().page() == here().page())\n      .dedup(key: x =&gt; id(x))\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -&gt; check if a paragraph starts before and ends after this page\n      let prev = query(heading.where(level: 4).before(here()))\n      let next = query(selector(&lt;h4-end&gt;).after(here()))\n      if prev.len() == 0 or next.len() == 0 {\n        return none\n      }\n      if prev.last().body != next.first().value {\n        return none\n      }\n      return chap-id(prev.last())\n    }\n    if pars.len() == 1 {\n      return chap-id(pars.first())\n    }\n    return [#chap-id(pars.first()) -- #chap-id(pars.last())]\n  },\n)\n\n#show heading.where(level: 4): it =&gt; it.body + h(1em)\n\n#let my-par(id: none, body) = {\n  parbreak()\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  box[#metadata([#id])&lt;h4-end&gt;]\n}\n\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)&lt;h1-short&gt;]\n}\n\n#my-h1(short: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n#my-par(id: \"3\", lorem(150))\n\n#my-h1(short: \"B-Chapter\")[This is Chapter B]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"12\", lorem(20))\n\n#my-h1(short: \"C-Chapter\")[This is Chapter C]\n#my-par(id: \"21a\", lorem(150))\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/a/a433acff88df3cd0e913697117ff7f65f4b47238.png\" data-download-href=\"https://forum.typst.app/uploads/default/a433acff88df3cd0e913697117ff7f65f4b47238\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/a/a433acff88df3cd0e913697117ff7f65f4b47238_2_690x459.png\" alt=\"image\" data-base62-sha1=\"nqB1ePYnbxwZTlyk6XqAtPbcuPS\" width=\"690\" height=\"459\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/a/a433acff88df3cd0e913697117ff7f65f4b47238_2_690x459.png, https://forum.typst.app/uploads/default/optimized/2X/a/a433acff88df3cd0e913697117ff7f65f4b47238_2_1035x688.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/a/a433acff88df3cd0e913697117ff7f65f4b47238_2_1380x918.png 2x\" data-dominant-color=\"F0F0F0\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1818√ó1210 418 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>You might want to do something smarter when the first and last paragraph on a page are in the same chapter, rather than showing the same short title twice‚Ä¶</p>",
      "raw": "The supplement thing is rather hacky, it could cause problems with outlines or references. So I'd rather use a custom heading command that adds \"short title\" metadata that can be retrieved in the header:\n\n```typ\n#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let id(x) = if x.func() == heading { x.body } else { x.value }\n    // Returns content showing short chapter title and paragraph number\n    let chap-id(x) = {\n      let shorts = query(selector(<h1-short>).before(x.location()))\n      if shorts.len() == 0 {\n        id(x)\n      } else [\n        #shorts.last().value: #id(x)\n      ]\n    }\n    let pars = query(heading.where(level: 4).or(<h4-end>))\n      .filter(x => x.location().page() == here().page())\n      .dedup(key: x => id(x))\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -> check if a paragraph starts before and ends after this page\n      let prev = query(heading.where(level: 4).before(here()))\n      let next = query(selector(<h4-end>).after(here()))\n      if prev.len() == 0 or next.len() == 0 {\n        return none\n      }\n      if prev.last().body != next.first().value {\n        return none\n      }\n      return chap-id(prev.last())\n    }\n    if pars.len() == 1 {\n      return chap-id(pars.first())\n    }\n    return [#chap-id(pars.first()) -- #chap-id(pars.last())]\n  },\n)\n\n#show heading.where(level: 4): it => it.body + h(1em)\n\n#let my-par(id: none, body) = {\n  parbreak()\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  box[#metadata([#id])<h4-end>]\n}\n\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)<h1-short>]\n}\n\n#my-h1(short: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n#my-par(id: \"3\", lorem(150))\n\n#my-h1(short: \"B-Chapter\")[This is Chapter B]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"12\", lorem(20))\n\n#my-h1(short: \"C-Chapter\")[This is Chapter C]\n#my-par(id: \"21a\", lorem(150))\n```\n\n![image|690x459](upload://nqB1ePYnbxwZTlyk6XqAtPbcuPS.png)\n\n\nYou might want to do something smarter when the first and last paragraph on a page are in the same chapter, rather than showing the same short title twice...",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 26.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 10453,
      "post_number": 7,
      "username": "a_w",
      "name": "Alex",
      "created_at": "2025-03-31T09:49:20.608Z",
      "updated_at": "2025-03-31T09:52:36.742Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/sijo\">@sijo</a> this is so helpful, thank you very much! I just tried actually implementing it and I think I ran into one edge case: When two chapters end up on the same page, it looks like this:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/5/51545477553683f6a981f1e767865cdad0f3652d.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/51545477553683f6a981f1e767865cdad0f3652d\" title=\"two-chaps\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/5/51545477553683f6a981f1e767865cdad0f3652d_2_342x499.jpeg\" alt=\"two-chaps\" data-base62-sha1=\"bBtlLWxjFTspW2ZWoePT0snopl3\" width=\"342\" height=\"499\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/5/51545477553683f6a981f1e767865cdad0f3652d_2_342x499.jpeg, https://forum.typst.app/uploads/default/optimized/2X/5/51545477553683f6a981f1e767865cdad0f3652d_2_513x748.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/5/51545477553683f6a981f1e767865cdad0f3652d_2_684x998.jpeg 2x\" data-dominant-color=\"ECECED\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">two-chaps</span><span class=\"informations\">832√ó1216 170 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\nInstead of <code>A-Chapter 1 ‚Äì B-Chapter 1</code></p>\n<p>Even if <code>#shorts.last()</code> should still resolve to <code>B-Chapter</code>? I tried but I couldn‚Äôt figure out if it is the query or the access to <code>chap-id</code> that causes this case to fail.</p>\n<p><a class=\"mention\" href=\"/u/andrew\">@Andrew</a> thanks so much for this additional approach, I will play around with the example too because <code>#metadata(none)&lt;par&gt;#it&lt;par&gt;#metadata(none)&lt;par&gt;</code> is a very interesting approach as well‚Ä¶ this forum is so great and so humbling ‚Äì I could never have come up with the idea of a label-wrapper (actually: I could never have come up with ANY of this, but the idea is especially ‚Äúoh, wow, this is possible?‚Äù).</p>",
      "raw": "@sijo this is so helpful, thank you very much! I just tried actually implementing it and I think I ran into one edge case: When two chapters end up on the same page, it looks like this:\n\n![two-chaps|342x499](upload://bBtlLWxjFTspW2ZWoePT0snopl3.jpeg)\nInstead of `A-Chapter 1 ‚Äì B-Chapter 1`\n\nEven if `#shorts.last()` should still resolve to `B-Chapter`? I tried but I couldn't figure out if it is the query or the access to `chap-id` that causes this case to fail.\n\n@Andrew thanks so much for this additional approach, I will play around with the example too because `#metadata(none)<par>#it<par>#metadata(none)<par>` is a very interesting approach as well‚Ä¶ this forum is so great and so humbling ‚Äì I could never have come up with the idea of a label-wrapper (actually: I could never have come up with ANY of this, but the idea is especially \"oh, wow, this is possible?\").",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 26.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 566
    },
    {
      "id": 10456,
      "post_number": 8,
      "username": "sijo",
      "name": "",
      "created_at": "2025-03-31T11:11:40.541Z",
      "updated_at": "2025-03-31T11:11:40.541Z",
      "cooked": "<p>Ah that‚Äôs because of the <code>dedup</code> call which only checks the id. I‚Äôve refactored the code a bit to avoid that, also using two metadata values per paragraph to simplify the logic:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let get-chap-short(x) = {\n  let shorts = query(selector(&lt;h1-short&gt;).before(x.location()))\n  return shorts.at(-1, default: none)\n}\n\n#let short-and-id(x) = {\n  let short = get-chap-short(x)\n  return (short: short.value, id: x.value)\n}\n\n#let format-header(a, b) = {\n  if b == none or b == a {\n    return [#a.short: #a.id]\n  }\n  if a.short == b.short {\n    return [#a.short: #a.id -- #b.id]\n  }\n  return [#a.short: #a.id -- #b.short: #b.id]\n}\n\n#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let pars = query(selector.or(&lt;h4-start&gt;, &lt;h4-end&gt;))\n      .filter(x =&gt; x.location().page() == here().page())\n      .map(short-and-id)\n      .dedup()\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -&gt; check if a paragraph starts before and ends after this page\n      let prevs = query(selector(&lt;h4-start&gt;).before(here()))\n      let nexts = query(selector(&lt;h4-end&gt;).after(here()))\n      if prevs.len() == 0 or nexts.len() == 0 {\n        return none\n      }\n      let prev = short-and-id(prevs.last())\n      let next = short-and-id(nexts.first())\n      if prev != next { // should not happen\n        return none\n      }\n      return format-header(prev, next)\n    }\n    return format-header(pars.first(), pars.at(-1, default: none))\n  },\n)\n\n#show heading.where(level: 4): it =&gt; it.body + h(1em)\n\n#let my-par(id: none, body) = par({\n  [#metadata([#id])&lt;h4-start&gt;]\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  [#metadata([#id])&lt;h4-end&gt;]\n})\n\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)&lt;h1-short&gt;]\n}\n\n#my-h1(short: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-h1(short: \"B-Chapter\")[This is Chapter B]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n\n#pagebreak()\n\n#my-h1(short: \"C-Chapter\")[This is Chapter C]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-par(id: \"3\", lorem(150))\n\n#my-h1(short: \"D-Chapter\")[This is Chapter D]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"11a\", lorem(20))\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/d/d7cf7537a2a4187eb3cf7b252e7fdb60e2554bdc.png\" data-download-href=\"https://forum.typst.app/uploads/default/d7cf7537a2a4187eb3cf7b252e7fdb60e2554bdc\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/d/d7cf7537a2a4187eb3cf7b252e7fdb60e2554bdc_2_690x459.png\" alt=\"image\" data-base62-sha1=\"uN98dJsTY90nJrOOr0V0kPcQKXq\" width=\"690\" height=\"459\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/d/d7cf7537a2a4187eb3cf7b252e7fdb60e2554bdc_2_690x459.png, https://forum.typst.app/uploads/default/optimized/2X/d/d7cf7537a2a4187eb3cf7b252e7fdb60e2554bdc_2_1035x688.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/d/d7cf7537a2a4187eb3cf7b252e7fdb60e2554bdc_2_1380x918.png 2x\" data-dominant-color=\"F2F2F2\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1430√ó952 265 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "Ah that's because of the `dedup` call which only checks the id. I've refactored the code a bit to avoid that, also using two metadata values per paragraph to simplify the logic:\n\n```typ\n#let get-chap-short(x) = {\n  let shorts = query(selector(<h1-short>).before(x.location()))\n  return shorts.at(-1, default: none)\n}\n\n#let short-and-id(x) = {\n  let short = get-chap-short(x)\n  return (short: short.value, id: x.value)\n}\n\n#let format-header(a, b) = {\n  if b == none or b == a {\n    return [#a.short: #a.id]\n  }\n  if a.short == b.short {\n    return [#a.short: #a.id -- #b.id]\n  }\n  return [#a.short: #a.id -- #b.short: #b.id]\n}\n\n#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let pars = query(selector.or(<h4-start>, <h4-end>))\n      .filter(x => x.location().page() == here().page())\n      .map(short-and-id)\n      .dedup()\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -> check if a paragraph starts before and ends after this page\n      let prevs = query(selector(<h4-start>).before(here()))\n      let nexts = query(selector(<h4-end>).after(here()))\n      if prevs.len() == 0 or nexts.len() == 0 {\n        return none\n      }\n      let prev = short-and-id(prevs.last())\n      let next = short-and-id(nexts.first())\n      if prev != next { // should not happen\n        return none\n      }\n      return format-header(prev, next)\n    }\n    return format-header(pars.first(), pars.at(-1, default: none))\n  },\n)\n\n#show heading.where(level: 4): it => it.body + h(1em)\n\n#let my-par(id: none, body) = par({\n  [#metadata([#id])<h4-start>]\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  [#metadata([#id])<h4-end>]\n})\n\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)<h1-short>]\n}\n\n#my-h1(short: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-h1(short: \"B-Chapter\")[This is Chapter B]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n\n#pagebreak()\n\n#my-h1(short: \"C-Chapter\")[This is Chapter C]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-par(id: \"3\", lorem(150))\n\n#my-h1(short: \"D-Chapter\")[This is Chapter D]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"11a\", lorem(20))\n```\n\n![image|690x459](upload://uN98dJsTY90nJrOOr0V0kPcQKXq.png)",
      "reply_to_post_number": 7,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 116.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 10459,
      "post_number": 9,
      "username": "a_w",
      "name": "Alex",
      "created_at": "2025-03-31T13:44:10.527Z",
      "updated_at": "2025-03-31T13:51:40.710Z",
      "cooked": "<p>Again thank you very much for your effort <a class=\"mention\" href=\"/u/sijo\">@sijo</a>, works like a charm <img src=\"https://forum.typst.app/images/emoji/apple/face_holding_back_tears.png?v=12\" title=\":face_holding_back_tears:\" class=\"emoji\" alt=\":face_holding_back_tears:\" loading=\"lazy\" width=\"20\" height=\"20\"><img src=\"https://forum.typst.app/images/emoji/apple/pray.png?v=12\" title=\":pray:\" class=\"emoji\" alt=\":pray:\" loading=\"lazy\" width=\"20\" height=\"20\"> while implementing I noticed that I oversimplied my example by a factor that now plays a role, since the solution is now way different than I anticipated. I actually have <code>Chapter ‚Ä∫ Subchapter ‚Ä∫ Paragraph</code> or in other words <code>Section ‚Ä∫ Chapter ‚Ä∫ Paragraph</code> I could more or less solve it by going back to the page-based query for the section (‚Äúless‚Äù because it only works for chapters on new pages, which is ok in my case).</p>\n<p>So basically:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let get-section-short() = {\n  let sections = query(selector(&lt;h1-short&gt;))\n  let s = sections.filter(h =&gt; h.location().page() &lt;= here().page()).last()\n  if s != none {\n    s.value\n  }\n}\n\n#let format-header(a, b) = {\n  if b == none or b == a {\n    return [#get-section-short() --- #a.short: #a.id]\n  }\n  if a.short == b.short {\n    return [#get-section-short() ---  #a.short: #a.id -- #b.id]\n  }\n  return [#get-section-short() --- #a.short: #a.id -- #b.short: #b.id]\n}\n\n// h1 for section, h2 for chapter\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)&lt;h1-short&gt;]\n}\n#let my-h2(short: none, ..args) = {\n  heading(level: 2, ..args)\n  [#metadata(short)&lt;h2-short&gt;]\n}\n</code></pre>\n<details>\n<summary>\nFull Code</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let get-section-short() = {\n  let sections = query(selector(&lt;h1-short&gt;))\n  let s = sections.filter(h =&gt; h.location().page() &lt;= here().page()).last()\n  if s != none {\n    s.value\n  }\n}\n\n#let get-chap-short(x) = {\n  let shorts = query(selector(&lt;h2-short&gt;).before(x.location()))\n  return shorts.at(-1, default: none)\n}\n\n#let short-and-id(x) = {\n  let short = get-chap-short(x)\n  return (short: short.value, id: x.value)\n}\n\n#let format-header(a, b) = {\n  if b == none or b == a {\n    return [#get-section-short() --- #a.short: #a.id]\n  }\n  if a.short == b.short {\n    return [#get-section-short() ---  #a.short: #a.id -- #b.id]\n  }\n  return [#get-section-short() --- #a.short: #a.id -- #b.short: #b.id]\n}\n\n#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let pars = query(selector.or(&lt;h4-start&gt;, &lt;h4-end&gt;))\n      .filter(x =&gt; x.location().page() == here().page())\n      .map(short-and-id)\n      .dedup()\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -&gt; check if a paragraph starts before and ends after this page\n      let prevs = query(selector(&lt;h4-start&gt;).before(here()))\n      let nexts = query(selector(&lt;h4-end&gt;).after(here()))\n      if prevs.len() == 0 or nexts.len() == 0 {\n        return none\n      }\n      let prev = short-and-id(prevs.last())\n      let next = short-and-id(nexts.first())\n      if prev != next { // should not happen\n        return none\n      }\n      return format-header(prev, next)\n    }\n    return format-header(pars.first(), pars.at(-1, default: none))\n  },\n)\n\n#show heading.where(level: 4): it =&gt; it.body + h(1em)\n\n#let my-par(id: none, body) = par({\n  [#metadata([#id])&lt;h4-start&gt;]\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  [#metadata([#id])&lt;h4-end&gt;]\n})\n\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)&lt;h1-short&gt;]\n}\n#let my-h2(short: none, ..args) = {\n  heading(level: 2, ..args)\n  [#metadata(short)&lt;h2-short&gt;]\n}\n\n#my-h1(short: \"I. Section\")[This is I. Section]\n#my-h2(short: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-h2(short: \"B-Chapter\")[This is Chapter B]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n\n#pagebreak()\n\n#my-h1(short: \"II. Section\")[This is II. Section]\n#my-h2(short: \"C-Chapter\")[This is Chapter C]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-par(id: \"3\", lorem(150))\n\n#my-h2(short: \"D-Chapter\")[This is Chapter D]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"11a\", lorem(20))\n\n#my-h1(short: \"III. Section\")[This is III. Section]\n#my-h2(short: \"E-Chapter\")[This is Chapter E]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"11a\", lorem(20))\n</code></pre>\n</details>\n<p>This works ok and fails only in cases where the section doesn‚Äôt start on a new page, like so:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/3/3f2a2b02efaa8672251986ba394976fa13781948.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/3f2a2b02efaa8672251986ba394976fa13781948\" title=\"section-chapter\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/3/3f2a2b02efaa8672251986ba394976fa13781948_2_690x460.jpeg\" alt=\"section-chapter\" data-base62-sha1=\"90MqmqQ5QNzYD7UCobiFoEaDuEU\" width=\"690\" height=\"460\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/3/3f2a2b02efaa8672251986ba394976fa13781948_2_690x460.jpeg, https://forum.typst.app/uploads/default/optimized/2X/3/3f2a2b02efaa8672251986ba394976fa13781948_2_1035x690.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/3/3f2a2b02efaa8672251986ba394976fa13781948_2_1380x920.jpeg 2x\" data-dominant-color=\"EDEDED\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">section-chapter</span><span class=\"informations\">1920√ó1282 234 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>If this requires significant restructuring, I‚Äôll just use the solution as is. But if it‚Äôs doable with a reasonable addition to <code>short-and-id()</code> would you mind showing me for peace of mind, please? (Disclaimer: My problems is when I see the double-x-variable-filter.map.depup combination my brain goes into <em>Homer‚Äôs brain monkey with cymbals</em> mode.)</p>",
      "raw": "Again thank you very much for your effort @sijo, works like a charm ü•πüôè while implementing I noticed that I oversimplied my example by a factor that now plays a role, since the solution is now way different than I anticipated. I actually have `Chapter ‚Ä∫ Subchapter ‚Ä∫ Paragraph` or in other words `Section ‚Ä∫ Chapter ‚Ä∫ Paragraph` I could more or less solve it by going back to the page-based query for the section (\"less\" because it only works for chapters on new pages, which is ok in my case).\n\nSo basically:\n```typ\n#let get-section-short() = {\n  let sections = query(selector(<h1-short>))\n  let s = sections.filter(h => h.location().page() <= here().page()).last()\n  if s != none {\n    s.value\n  }\n}\n\n#let format-header(a, b) = {\n  if b == none or b == a {\n    return [#get-section-short() --- #a.short: #a.id]\n  }\n  if a.short == b.short {\n    return [#get-section-short() ---  #a.short: #a.id -- #b.id]\n  }\n  return [#get-section-short() --- #a.short: #a.id -- #b.short: #b.id]\n}\n\n// h1 for section, h2 for chapter\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)<h1-short>]\n}\n#let my-h2(short: none, ..args) = {\n  heading(level: 2, ..args)\n  [#metadata(short)<h2-short>]\n}\n```\n\n[details=\"Full Code\"]\n```typ\n#let get-section-short() = {\n  let sections = query(selector(<h1-short>))\n  let s = sections.filter(h => h.location().page() <= here().page()).last()\n  if s != none {\n    s.value\n  }\n}\n\n#let get-chap-short(x) = {\n  let shorts = query(selector(<h2-short>).before(x.location()))\n  return shorts.at(-1, default: none)\n}\n\n#let short-and-id(x) = {\n  let short = get-chap-short(x)\n  return (short: short.value, id: x.value)\n}\n\n#let format-header(a, b) = {\n  if b == none or b == a {\n    return [#get-section-short() --- #a.short: #a.id]\n  }\n  if a.short == b.short {\n    return [#get-section-short() ---  #a.short: #a.id -- #b.id]\n  }\n  return [#get-section-short() --- #a.short: #a.id -- #b.short: #b.id]\n}\n\n#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let pars = query(selector.or(<h4-start>, <h4-end>))\n      .filter(x => x.location().page() == here().page())\n      .map(short-and-id)\n      .dedup()\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -> check if a paragraph starts before and ends after this page\n      let prevs = query(selector(<h4-start>).before(here()))\n      let nexts = query(selector(<h4-end>).after(here()))\n      if prevs.len() == 0 or nexts.len() == 0 {\n        return none\n      }\n      let prev = short-and-id(prevs.last())\n      let next = short-and-id(nexts.first())\n      if prev != next { // should not happen\n        return none\n      }\n      return format-header(prev, next)\n    }\n    return format-header(pars.first(), pars.at(-1, default: none))\n  },\n)\n\n#show heading.where(level: 4): it => it.body + h(1em)\n\n#let my-par(id: none, body) = par({\n  [#metadata([#id])<h4-start>]\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  [#metadata([#id])<h4-end>]\n})\n\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)<h1-short>]\n}\n#let my-h2(short: none, ..args) = {\n  heading(level: 2, ..args)\n  [#metadata(short)<h2-short>]\n}\n\n#my-h1(short: \"I. Section\")[This is I. Section]\n#my-h2(short: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-h2(short: \"B-Chapter\")[This is Chapter B]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n\n#pagebreak()\n\n#my-h1(short: \"II. Section\")[This is II. Section]\n#my-h2(short: \"C-Chapter\")[This is Chapter C]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-par(id: \"3\", lorem(150))\n\n#my-h2(short: \"D-Chapter\")[This is Chapter D]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"11a\", lorem(20))\n\n#my-h1(short: \"III. Section\")[This is III. Section]\n#my-h2(short: \"E-Chapter\")[This is Chapter E]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"11a\", lorem(20))\n```\n[/details]\n\nThis works ok and fails only in cases where the section doesn't start on a new page, like so:\n![section-chapter|690x460](upload://90MqmqQ5QNzYD7UCobiFoEaDuEU.jpeg)\n\nIf this requires significant restructuring, I'll just use the solution as is. But if it's doable with a reasonable addition to `short-and-id()` would you mind showing me for peace of mind, please? (Disclaimer: My problems is when I see the double-x-variable-filter.map.depup combination my brain goes into *Homer's brain monkey with cymbals* mode.)",
      "reply_to_post_number": 8,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 10.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 566
    },
    {
      "id": 10462,
      "post_number": 10,
      "username": "sijo",
      "name": "",
      "created_at": "2025-03-31T14:21:20.759Z",
      "updated_at": "2025-03-31T14:21:20.759Z",
      "cooked": "<p>I think the proper fix is to change <code>short-and-id</code> to include the section short:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let get-short(label, x) = {\n  let shorts = query(selector(label).before(x.location()))\n  return shorts.at(-1, default: none)\n}\n\n#let shorts-and-id(x) = {\n  let h1 = get-short(&lt;h1-short&gt;, x)\n  let h2 = get-short(&lt;h2-short&gt;, x)\n  return (h1: h1.value, h2: h2.value, id: x.value)\n}\n\n#let header-content(a, b) = {\n  if b == none or b == a {\n    return [#a.h1: #a.h2: #a.id]\n  }\n  if a.h1 == b.h1 {\n    if a.h2 == b.h2 {\n      return [#a.h1: #a.h2: #a.id -- #b.id]\n    }\n    return [#a.h1: #a.h2: #a.id -- #b.h2: #b.id]\n  }\n  return [#a.h1: #a.h2: #a.id -- #b.h1: #b.h2: #b.id]\n}\n\n#let format-header(a, b) = {\n  set text(0.8em)\n  header-content(a, b)\n}\n\n#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let pars = query(selector.or(&lt;h4-start&gt;, &lt;h4-end&gt;))\n      .filter(x =&gt; x.location().page() == here().page())\n      .map(shorts-and-id)\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -&gt; check if a paragraph starts before and ends after this page\n      let prevs = query(selector(&lt;h4-start&gt;).before(here()))\n      let nexts = query(selector(&lt;h4-end&gt;).after(here()))\n      if prevs.len() == 0 or nexts.len() == 0 {\n        return none\n      }\n      let prev = shorts-and-id(prevs.last())\n      let next = shorts-and-id(nexts.first())\n      if prev != next { // should not happen\n        return none\n      }\n      return format-header(prev, next)\n    }\n    return format-header(pars.first(), pars.at(-1, default: none))\n  },\n)\n\n#show heading.where(level: 4): it =&gt; it.body + h(1em)\n\n#let my-par(id: none, body) = par({\n  [#metadata([#id])&lt;h4-start&gt;]\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  [#metadata([#id])&lt;h4-end&gt;]\n})\n\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)&lt;h1-short&gt;]\n}\n#let my-h2(short: none, ..args) = {\n  heading(level: 2, ..args)\n  [#metadata(short)&lt;h2-short&gt;]\n}\n\n#my-h1(short: \"I. Section\")[This is I. Section]\n#my-h2(short: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-h2(short: \"B-Chapter\")[This is Chapter B]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n\n#pagebreak()\n\n#my-h1(short: \"II. Section\")[This is II. Section]\n#my-h2(short: \"C-Chapter\")[This is Chapter C]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-par(id: \"3\", lorem(150))\n\n#my-h2(short: \"D-Chapter\")[This is Chapter D]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"11a\", lorem(20))\n\n#my-h1(short: \"III. Section\")[This is III. Section]\n#my-h2(short: \"E-Chapter\")[This is Chapter E]\n#my-par(id: \"11\", lorem(20))\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/6/6a40de2b200c6dd876a8d172e51c14c3817a8ccd.png\" data-download-href=\"https://forum.typst.app/uploads/default/6a40de2b200c6dd876a8d172e51c14c3817a8ccd\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/6/6a40de2b200c6dd876a8d172e51c14c3817a8ccd_2_690x459.png\" alt=\"image\" data-base62-sha1=\"f9XACd6LRFYHiyqHgoGUpNlAgWN\" width=\"690\" height=\"459\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/6/6a40de2b200c6dd876a8d172e51c14c3817a8ccd_2_690x459.png, https://forum.typst.app/uploads/default/optimized/2X/6/6a40de2b200c6dd876a8d172e51c14c3817a8ccd_2_1035x688.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/6/6a40de2b200c6dd876a8d172e51c14c3817a8ccd_2_1380x918.png 2x\" data-dominant-color=\"F1F1F1\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1432√ó954 286 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "I think the proper fix is to change `short-and-id` to include the section short:\n\n```typ\n#let get-short(label, x) = {\n  let shorts = query(selector(label).before(x.location()))\n  return shorts.at(-1, default: none)\n}\n\n#let shorts-and-id(x) = {\n  let h1 = get-short(<h1-short>, x)\n  let h2 = get-short(<h2-short>, x)\n  return (h1: h1.value, h2: h2.value, id: x.value)\n}\n\n#let header-content(a, b) = {\n  if b == none or b == a {\n    return [#a.h1: #a.h2: #a.id]\n  }\n  if a.h1 == b.h1 {\n    if a.h2 == b.h2 {\n      return [#a.h1: #a.h2: #a.id -- #b.id]\n    }\n    return [#a.h1: #a.h2: #a.id -- #b.h2: #b.id]\n  }\n  return [#a.h1: #a.h2: #a.id -- #b.h1: #b.h2: #b.id]\n}\n\n#let format-header(a, b) = {\n  set text(0.8em)\n  header-content(a, b)\n}\n\n#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let pars = query(selector.or(<h4-start>, <h4-end>))\n      .filter(x => x.location().page() == here().page())\n      .map(shorts-and-id)\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -> check if a paragraph starts before and ends after this page\n      let prevs = query(selector(<h4-start>).before(here()))\n      let nexts = query(selector(<h4-end>).after(here()))\n      if prevs.len() == 0 or nexts.len() == 0 {\n        return none\n      }\n      let prev = shorts-and-id(prevs.last())\n      let next = shorts-and-id(nexts.first())\n      if prev != next { // should not happen\n        return none\n      }\n      return format-header(prev, next)\n    }\n    return format-header(pars.first(), pars.at(-1, default: none))\n  },\n)\n\n#show heading.where(level: 4): it => it.body + h(1em)\n\n#let my-par(id: none, body) = par({\n  [#metadata([#id])<h4-start>]\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  [#metadata([#id])<h4-end>]\n})\n\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)<h1-short>]\n}\n#let my-h2(short: none, ..args) = {\n  heading(level: 2, ..args)\n  [#metadata(short)<h2-short>]\n}\n\n#my-h1(short: \"I. Section\")[This is I. Section]\n#my-h2(short: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-h2(short: \"B-Chapter\")[This is Chapter B]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n\n#pagebreak()\n\n#my-h1(short: \"II. Section\")[This is II. Section]\n#my-h2(short: \"C-Chapter\")[This is Chapter C]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-par(id: \"3\", lorem(150))\n\n#my-h2(short: \"D-Chapter\")[This is Chapter D]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"11a\", lorem(20))\n\n#my-h1(short: \"III. Section\")[This is III. Section]\n#my-h2(short: \"E-Chapter\")[This is Chapter E]\n#my-par(id: \"11\", lorem(20))\n```\n\n![image|690x459](upload://f9XACd6LRFYHiyqHgoGUpNlAgWN.png)",
      "reply_to_post_number": 9,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 30.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 10466,
      "post_number": 11,
      "username": "a_w",
      "name": "Alex",
      "created_at": "2025-03-31T16:50:54.622Z",
      "updated_at": "2025-03-31T16:55:50.829Z",
      "cooked": "<p>Looks really good now and the exceptions are way more maintainable. Thank you for taking the time to even refactor the approach! <img src=\"https://forum.typst.app/images/emoji/apple/pray.png?v=12\" title=\":pray:\" class=\"emoji\" alt=\":pray:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>Of course I managed to overlook two more edge cases <img src=\"https://forum.typst.app/images/emoji/apple/man_facepalming.png?v=12\" title=\":man_facepalming:\" class=\"emoji\" alt=\":man_facepalming:\" loading=\"lazy\" width=\"20\" height=\"20\"> but I‚Äôve tried to catch them as good as I could‚Ä¶ just‚Äìagain‚Äìnot very elegantly: I have chapters that contain no numbered paragraphs like the preface and text-only chapters in between as well.</p>\n<p>I tried to catch them like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// Preface case\n// Get last section headline\n      if prevs.len() == 0 or nexts.len() == 0 {\n        return query(selector(&lt;h1-short&gt;)).filter(x =&gt; x.location().page() &lt;= here().page()).last().value\n      }\n\n// In-between case\n// Get last section + chapter headline\n      if prev != next { // should not happen\n        return query(selector(&lt;h1-short&gt;)).filter(x =&gt; x.location().page() &lt;= here().page()).last().value + \" \" + query(selector(&lt;h2-short&gt;)).filter(x =&gt; x.location().page() &lt;= here().page()).last().value\n      }\n\n// Split exceptions in header-content\n  if b == none {\n    return [#a.h1: #a.h2] //to leave wrong ID away\n  }\n  if b == a {\n    return [#a.h1: #a.h2: #a.id]\n  }\n</code></pre>\n<details>\n<summary>\nFull Code</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let get-short(label, x) = {\n  let shorts = query(selector(label).before(x.location()))\n  return shorts.at(-1, default: none)\n}\n\n#let shorts-and-id(x) = {\n  let h1 = get-short(&lt;h1-short&gt;, x)\n  let h2 = get-short(&lt;h2-short&gt;, x)\n  return (h1: h1.value, h2: h2.value, id: x.value)\n}\n\n#let header-content(a, b) = {\n  if b == none {\n    return [#a.h1: #a.h2]\n  }\n  if b == a {\n    return [#a.h1: #a.h2: #a.id]\n  }\n  if a.h1 == b.h1 {\n    if a.h2 == b.h2 {\n      return [#a.h1: #a.h2: #a.id -- #b.id]\n    }\n    return [#a.h1: #a.h2: #a.id -- #b.h2: #b.id]\n  }\n  return [#a.h1: #a.h2: #a.id -- #b.h1: #b.h2: #b.id]\n}\n\n#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let pars = query(selector.or(&lt;h4-start&gt;, &lt;h4-end&gt;))\n      .filter(x =&gt; x.location().page() == here().page())\n      .map(shorts-and-id)\n      .dedup()\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -&gt; check if a paragraph starts before and ends after this page\n      let prevs = query(selector(&lt;h4-start&gt;).before(here()))\n      let nexts = query(selector(&lt;h4-end&gt;).after(here()))\n      if prevs.len() == 0 or nexts.len() == 0 {\n        return query(selector(&lt;h1-short&gt;)).filter(x =&gt; x.location().page() &lt;= here().page()).last().value\n      }\n      let prev = shorts-and-id(prevs.last())\n      let next = shorts-and-id(nexts.first())\n      if prev != next { // should not happen\n        return query(selector(&lt;h1-short&gt;)).filter(x =&gt; x.location().page() &lt;= here().page()).last().value + \" \" + query(selector(&lt;h2-short&gt;)).filter(x =&gt; x.location().page() &lt;= here().page()).last().value\n      }\n      return header-content(prev, next)\n    }\n    return header-content(pars.first(), pars.at(-1, default: none))\n  },\n)\n\n#show heading.where(level: 4): it =&gt; it.body + h(1em)\n\n#let my-par(id: none, body) = par({\n  [#metadata([#id])&lt;h4-start&gt;]\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  [#metadata([#id])&lt;h4-end&gt;]\n})\n\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)&lt;h1-short&gt;]\n}\n#let my-h2(short: none, ..args) = {\n  heading(level: 2, ..args)\n  [#metadata(short)&lt;h2-short&gt;]\n}\n\n#my-h1(short: \"Preface\")[Preface]\nPreface content #lorem(50)\n#pagebreak()\n\n#my-h1(short: \"I. Section\")[This is I. Section]\n#my-h2(short: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-h2(short: \"B-Chapter\")[This is Chapter B]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n\n#pagebreak()\n\n#my-h1(short: \"II. Section\")[This is II. Section]\n#my-h2(short: \"C-Chapter\")[This is Chapter C]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-par(id: \"3\", lorem(150))\n\n#my-h2(short: \"D-Chapter\")[This is Chapter D]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"11a\", lorem(20))\n\n#my-h1(short: \"III. Section\")[This is III. Section]\n#my-h2(short: \"E-Chapter\")[This is Chapter E]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"11a\", lorem(20))\n\n#my-h2(short: \"F-Chapter\")[This is Chapter F]\nRegular Content #lorem(200)\n\n#my-h2(short: \"G-Chapter\")[This is Chapter G]\nRegular Content #lorem(100)\n\n#my-h2(short: \"H-Chapter\")[This is Chapter H]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n</code></pre>\n</details>\n<p>Resulting in:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/3/313b4a82e56985279ca2bf8d90dafc0405cf5bf0.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/313b4a82e56985279ca2bf8d90dafc0405cf5bf0\" title=\"should-not-happen\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/3/313b4a82e56985279ca2bf8d90dafc0405cf5bf0_2_665x500.jpeg\" alt=\"should-not-happen\" data-base62-sha1=\"71wqrHCvV7WYDbs41uZJcksaWre\" width=\"665\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/3/313b4a82e56985279ca2bf8d90dafc0405cf5bf0_2_665x500.jpeg, https://forum.typst.app/uploads/default/optimized/2X/3/313b4a82e56985279ca2bf8d90dafc0405cf5bf0_2_997x750.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/3/313b4a82e56985279ca2bf8d90dafc0405cf5bf0_2_1330x1000.jpeg 2x\" data-dominant-color=\"EBEBEB\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">should-not-happen</span><span class=\"informations\">1920√ó1442 334 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>It‚Äôs probably not a very ‚Äúclean‚Äù solution. This is for learning purposes only now and I‚Äôm sorry to keep bothering you, but if I may: How would you have solved this? (I‚Äôm quite confident this is the last issue I have with this, since it basically works already thanks to your help!)</p>",
      "raw": "Looks really good now and the exceptions are way more maintainable. Thank you for taking the time to even refactor the approach! üôè\n\nOf course I managed to overlook two more edge cases ü§¶‚Äç‚ôÇÔ∏è but I've tried to catch them as good as I could‚Ä¶ just‚Äìagain‚Äìnot very elegantly: I have chapters that contain no numbered paragraphs like the preface and text-only chapters in between as well.\n\nI tried to catch them like this:\n```typ\n// Preface case\n// Get last section headline\n      if prevs.len() == 0 or nexts.len() == 0 {\n        return query(selector(<h1-short>)).filter(x => x.location().page() <= here().page()).last().value\n      }\n\n// In-between case\n// Get last section + chapter headline\n      if prev != next { // should not happen\n        return query(selector(<h1-short>)).filter(x => x.location().page() <= here().page()).last().value + \" \" + query(selector(<h2-short>)).filter(x => x.location().page() <= here().page()).last().value\n      }\n\n// Split exceptions in header-content\n  if b == none {\n    return [#a.h1: #a.h2] //to leave wrong ID away\n  }\n  if b == a {\n    return [#a.h1: #a.h2: #a.id]\n  }\n```\n\n[details=\"Full Code\"]\n```typ\n#let get-short(label, x) = {\n  let shorts = query(selector(label).before(x.location()))\n  return shorts.at(-1, default: none)\n}\n\n#let shorts-and-id(x) = {\n  let h1 = get-short(<h1-short>, x)\n  let h2 = get-short(<h2-short>, x)\n  return (h1: h1.value, h2: h2.value, id: x.value)\n}\n\n#let header-content(a, b) = {\n  if b == none {\n    return [#a.h1: #a.h2]\n  }\n  if b == a {\n    return [#a.h1: #a.h2: #a.id]\n  }\n  if a.h1 == b.h1 {\n    if a.h2 == b.h2 {\n      return [#a.h1: #a.h2: #a.id -- #b.id]\n    }\n    return [#a.h1: #a.h2: #a.id -- #b.h2: #b.id]\n  }\n  return [#a.h1: #a.h2: #a.id -- #b.h1: #b.h2: #b.id]\n}\n\n#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let pars = query(selector.or(<h4-start>, <h4-end>))\n      .filter(x => x.location().page() == here().page())\n      .map(shorts-and-id)\n      .dedup()\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -> check if a paragraph starts before and ends after this page\n      let prevs = query(selector(<h4-start>).before(here()))\n      let nexts = query(selector(<h4-end>).after(here()))\n      if prevs.len() == 0 or nexts.len() == 0 {\n        return query(selector(<h1-short>)).filter(x => x.location().page() <= here().page()).last().value\n      }\n      let prev = shorts-and-id(prevs.last())\n      let next = shorts-and-id(nexts.first())\n      if prev != next { // should not happen\n        return query(selector(<h1-short>)).filter(x => x.location().page() <= here().page()).last().value + \" \" + query(selector(<h2-short>)).filter(x => x.location().page() <= here().page()).last().value\n      }\n      return header-content(prev, next)\n    }\n    return header-content(pars.first(), pars.at(-1, default: none))\n  },\n)\n\n#show heading.where(level: 4): it => it.body + h(1em)\n\n#let my-par(id: none, body) = par({\n  [#metadata([#id])<h4-start>]\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  [#metadata([#id])<h4-end>]\n})\n\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)<h1-short>]\n}\n#let my-h2(short: none, ..args) = {\n  heading(level: 2, ..args)\n  [#metadata(short)<h2-short>]\n}\n\n#my-h1(short: \"Preface\")[Preface]\nPreface content #lorem(50)\n#pagebreak()\n\n#my-h1(short: \"I. Section\")[This is I. Section]\n#my-h2(short: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-h2(short: \"B-Chapter\")[This is Chapter B]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n\n#pagebreak()\n\n#my-h1(short: \"II. Section\")[This is II. Section]\n#my-h2(short: \"C-Chapter\")[This is Chapter C]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(20))\n#my-par(id: \"3\", lorem(150))\n\n#my-h2(short: \"D-Chapter\")[This is Chapter D]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"11a\", lorem(20))\n\n#my-h1(short: \"III. Section\")[This is III. Section]\n#my-h2(short: \"E-Chapter\")[This is Chapter E]\n#my-par(id: \"11\", lorem(50))\n#my-par(id: \"11a\", lorem(20))\n\n#my-h2(short: \"F-Chapter\")[This is Chapter F]\nRegular Content #lorem(200)\n\n#my-h2(short: \"G-Chapter\")[This is Chapter G]\nRegular Content #lorem(100)\n\n#my-h2(short: \"H-Chapter\")[This is Chapter H]\n#my-par(id: \"1\", lorem(50))\n#my-par(id: \"2\", lorem(20))\n```\n[/details]\n\n\nResulting in:\n![should-not-happen|665x500](upload://71wqrHCvV7WYDbs41uZJcksaWre.jpeg)\n\nIt's probably not a very \"clean\" solution. This is for learning purposes only now and I'm sorry to keep bothering you, but if I may: How would you have solved this? (I'm quite confident this is the last issue I have with this, since it basically works already thanks to your help!)",
      "reply_to_post_number": 10,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 5.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 566
    },
    {
      "id": 10596,
      "post_number": 12,
      "username": "a_w",
      "name": "Alex",
      "created_at": "2025-04-03T13:48:00.337Z",
      "updated_at": "2025-04-03T13:56:07.426Z",
      "cooked": "<p>After happily thinking that I‚Äôve successfully implemented the solution, I ran into (or created) one more edge case: In my real-world example, the paragraphs are inline, so:</p>\n<pre data-code-wrap=\"txt\"><code class=\"lang-txt\">1. First paragraph 2. Second one\n</code></pre>\n<p>instead of</p>\n<pre data-code-wrap=\"txt\"><code class=\"lang-txt\">1. First paragraph\n2. Second one\n</code></pre>\n<p>It didn‚Äôt recognize it at first because it only creates a problem when the last ‚Äúparagraph‚Äù (which is <code>text()</code>) doesn‚Äôt flow onto the next page. (Disclaimer: I‚Äôm not even sure I fully get the problem). But the case looks like so:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/f/f0c08584deb9166a4f92184ed8f17cfa8801ede7.png\" data-download-href=\"https://forum.typst.app/uploads/default/f0c08584deb9166a4f92184ed8f17cfa8801ede7\" title=\"text-problem\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/f/f0c08584deb9166a4f92184ed8f17cfa8801ede7_2_690x233.png\" alt=\"text-problem\" data-base62-sha1=\"ylN4f6lqk0wuI2pWS9frajmkNUP\" width=\"690\" height=\"233\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/f/f0c08584deb9166a4f92184ed8f17cfa8801ede7_2_690x233.png, https://forum.typst.app/uploads/default/optimized/2X/f/f0c08584deb9166a4f92184ed8f17cfa8801ede7_2_1035x349.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/f/f0c08584deb9166a4f92184ed8f17cfa8801ede7_2_1380x466.png 2x\" data-dominant-color=\"EEEEEE\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">text-problem</span><span class=\"informations\">2344√ó792 291 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Can I adapt the prev/next query or adapt the element while keeping it ‚Äúinline‚Äù to get this case right?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">let prevs = query(selector(&lt;h4-start&gt;).before(here()))\nlet nexts = query(selector(&lt;h4-end&gt;).after(here()))\n\n#let my-par(id: none, body) = text({\n  [#metadata([#id])&lt;h4-start&gt;]\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  [#metadata([#id])&lt;h4-end&gt;]\n  // hide(\"‚Äã\") // ‚Üê ü•¥ Uncomment to fix the issue\n})\n</code></pre>\n<p><strong>The best fix I was able to come up with is to end a zero-width space at the end</strong> of my paragraph. But I‚Äôd like to understand the problem and maybe fix it in a non-hacky way if possible.</p>\n<details>\n<summary>\nFull Code Example</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let get-short(label, x) = {\n  let shorts = query(selector(label).before(x.location()))\n  return shorts.at(-1, default: none)\n}\n\n#let shorts-and-id(x) = {\n  let h1 = get-short(&lt;h1-short&gt;, x)\n  let h2 = get-short(&lt;h2-short&gt;, x)\n  return (h1: h1.value, h2: h2.value, id: x.value)\n}\n\n#let header-content(a, b) = {\n  if b == none {\n    return [#a.h1: #a.h2]\n  }\n  if b == a {\n    return [#a.h1: #a.h2: #a.id]\n  }\n  if a.h1 == b.h1 {\n    if a.h2 == b.h2 {\n      return [#a.h1: #a.h2: #a.id -- #b.id]\n    }\n    return [#a.h1: #a.h2: #a.id -- #b.h2: #b.id]\n  }\n  return [#a.h1: #a.h2: #a.id -- #b.h1: #b.h2: #b.id]\n}\n\n#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let pars = query(selector.or(&lt;h4-start&gt;, &lt;h4-end&gt;))\n      .filter(x =&gt; x.location().page() == here().page())\n      .map(shorts-and-id)\n      .dedup()\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -&gt; check if a paragraph starts before and ends after this page\n      let prevs = query(selector(&lt;h4-start&gt;).before(here()))\n      let nexts = query(selector(&lt;h4-end&gt;).after(here()))\n      if prevs.len() == 0 or nexts.len() == 0 {\n        // ‚Üì ü•¥ Still looking for improvement here too\n        return query(selector(&lt;h1-short&gt;)).filter(x =&gt; x.location().page() &lt;= here().page()).last().value \n      }\n      let prev = shorts-and-id(prevs.last())\n      let next = shorts-and-id(nexts.first())\n      if prev != next { // should not happen\n        // ‚Üì ü•¥ Still looking for improvement here too \n        return query(selector(&lt;h1-short&gt;)).filter(x =&gt; x.location().page() &lt;= here().page()).last().value + \" \" + query(selector(&lt;h2-short&gt;)).filter(x =&gt; x.location().page() &lt;= here().page()).last().value\n      }\n      return header-content(prev, next)\n    }\n    return header-content(pars.first(), pars.at(-1, default: none))\n  },\n)\n\n#show heading.where(level: 4): it =&gt; it.body + h(1em)\n\n// Change text() to par() here ‚Üì to see the difference\n#let my-par(id: none, body) = text({\n  [#metadata([#id])&lt;h4-start&gt;]\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  [#metadata([#id])&lt;h4-end&gt;]\n  // hide(\"‚Äã\") // ‚Üê ü•¥ Uncomment to fix the issue\n})\n\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)&lt;h1-short&gt;]\n}\n#let my-h2(short: none, ..args) = {\n  heading(level: 2, ..args)\n  [#metadata(short)&lt;h2-short&gt;]\n}\n\n#my-h1(short: \"Preface\")[Preface]\nPreface content #lorem(50)\n#pagebreak()\n\n#my-h1(short: \"I. Section\")[This is I. Section]\n#my-h2(short: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(50))\n\n//#my-h2(short: \"B-Chapter\")[This is Chapter B]\n#text(red, \"Counter remains at 2‚Äì5 ‚Üë despite (2) ending on the last page\")\n#my-par(id: \"3\", lorem(50))\n#my-par(id: \"4\", lorem(20))\n#my-par(id: \"5\", lorem(40))\n#text(green, \"Counts 5 ‚Üë correctly if it crosses the page \")\n\n// #my-h1(short: \"II. Section\")[This is II. Section]\n// #my-h2(short: \"C-Chapter\")[This is Chapter C]\n// #my-par(id: \"1\", lorem(20))\n// #my-par(id: \"2\", lorem(20))\n// #my-par(id: \"3\", lorem(50))\n\n// #my-h2(short: \"D-Chapter\")[This is Chapter D]\n// #my-par(id: \"11\", lorem(50))\n// #my-par(id: \"11a\", lorem(20))\n\n// #my-h1(short: \"III. Section\")[This is III. Section]\n// #my-h2(short: \"E-Chapter\")[This is Chapter E]\n// #my-par(id: \"11\", lorem(50))\n// #my-par(id: \"11a\", lorem(20))\n\n// #my-h2(short: \"F-Chapter\")[This is Chapter F]\n// Regular Content #lorem(200)\n\n// #my-h2(short: \"G-Chapter\")[This is Chapter G]\n// Regular Content #lorem(100)\n\n// #my-h2(short: \"H-Chapter\")[This is Chapter H]\n// #my-par(id: \"1\", lorem(50))\n// #my-par(id: \"2\", lorem(20))\n</code></pre>\n</details>",
      "raw": "After happily thinking that I've successfully implemented the solution, I ran into (or created) one more edge case: In my real-world example, the paragraphs are inline, so:\n\n```txt\n1. First paragraph 2. Second one\n```\ninstead of\n```txt\n1. First paragraph\n2. Second one\n```\n\nIt didn't recognize it at first because it only creates a problem when the last \"paragraph\" (which is `text()`) doesn't flow onto the next page. (Disclaimer: I'm not even sure I fully get the problem). But the case looks like so:\n\n![text-problem|690x233](upload://ylN4f6lqk0wuI2pWS9frajmkNUP.png)\n\nCan I adapt the prev/next query or adapt the element while keeping it \"inline\" to get this case right?\n\n```typ\nlet prevs = query(selector(<h4-start>).before(here()))\nlet nexts = query(selector(<h4-end>).after(here()))\n\n#let my-par(id: none, body) = text({\n  [#metadata([#id])<h4-start>]\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  [#metadata([#id])<h4-end>]\n  // hide(\"‚Äã\") // ‚Üê ü•¥ Uncomment to fix the issue\n})\n```\n\n**The best fix I was able to come up with is to end a zero-width space at the end** of my paragraph. But I'd like to understand the problem and maybe fix it in a non-hacky way if possible.\n\n\n[details=\"Full Code Example\"]\n```typ\n#let get-short(label, x) = {\n  let shorts = query(selector(label).before(x.location()))\n  return shorts.at(-1, default: none)\n}\n\n#let shorts-and-id(x) = {\n  let h1 = get-short(<h1-short>, x)\n  let h2 = get-short(<h2-short>, x)\n  return (h1: h1.value, h2: h2.value, id: x.value)\n}\n\n#let header-content(a, b) = {\n  if b == none {\n    return [#a.h1: #a.h2]\n  }\n  if b == a {\n    return [#a.h1: #a.h2: #a.id]\n  }\n  if a.h1 == b.h1 {\n    if a.h2 == b.h2 {\n      return [#a.h1: #a.h2: #a.id -- #b.id]\n    }\n    return [#a.h1: #a.h2: #a.id -- #b.h2: #b.id]\n  }\n  return [#a.h1: #a.h2: #a.id -- #b.h1: #b.h2: #b.id]\n}\n\n#set page(\n  width: 100mm,\n  height: 100mm,\n  header: context {\n    let pars = query(selector.or(<h4-start>, <h4-end>))\n      .filter(x => x.location().page() == here().page())\n      .map(shorts-and-id)\n      .dedup()\n    if pars.len() == 0 {\n      // No paragraph starting or ending on this page\n      // -> check if a paragraph starts before and ends after this page\n      let prevs = query(selector(<h4-start>).before(here()))\n      let nexts = query(selector(<h4-end>).after(here()))\n      if prevs.len() == 0 or nexts.len() == 0 {\n        // ‚Üì ü•¥ Still looking for improvement here too\n        return query(selector(<h1-short>)).filter(x => x.location().page() <= here().page()).last().value \n      }\n      let prev = shorts-and-id(prevs.last())\n      let next = shorts-and-id(nexts.first())\n      if prev != next { // should not happen\n        // ‚Üì ü•¥ Still looking for improvement here too \n        return query(selector(<h1-short>)).filter(x => x.location().page() <= here().page()).last().value + \" \" + query(selector(<h2-short>)).filter(x => x.location().page() <= here().page()).last().value\n      }\n      return header-content(prev, next)\n    }\n    return header-content(pars.first(), pars.at(-1, default: none))\n  },\n)\n\n#show heading.where(level: 4): it => it.body + h(1em)\n\n// Change text() to par() here ‚Üì to see the difference\n#let my-par(id: none, body) = text({\n  [#metadata([#id])<h4-start>]\n  if id != none {\n    heading(level: 4, id)\n  }\n  body\n  [#metadata([#id])<h4-end>]\n  // hide(\"‚Äã\") // ‚Üê ü•¥ Uncomment to fix the issue\n})\n\n#let my-h1(short: none, ..args) = {\n  heading(level: 1, ..args)\n  [#metadata(short)<h1-short>]\n}\n#let my-h2(short: none, ..args) = {\n  heading(level: 2, ..args)\n  [#metadata(short)<h2-short>]\n}\n\n#my-h1(short: \"Preface\")[Preface]\nPreface content #lorem(50)\n#pagebreak()\n\n#my-h1(short: \"I. Section\")[This is I. Section]\n#my-h2(short: \"A-Chapter\")[This is Chapter A]\n#my-par(id: \"1\", lorem(20))\n#my-par(id: \"2\", lorem(50))\n\n//#my-h2(short: \"B-Chapter\")[This is Chapter B]\n#text(red, \"Counter remains at 2‚Äì5 ‚Üë despite (2) ending on the last page\")\n#my-par(id: \"3\", lorem(50))\n#my-par(id: \"4\", lorem(20))\n#my-par(id: \"5\", lorem(40))\n#text(green, \"Counts 5 ‚Üë correctly if it crosses the page \")\n\n// #my-h1(short: \"II. Section\")[This is II. Section]\n// #my-h2(short: \"C-Chapter\")[This is Chapter C]\n// #my-par(id: \"1\", lorem(20))\n// #my-par(id: \"2\", lorem(20))\n// #my-par(id: \"3\", lorem(50))\n\n// #my-h2(short: \"D-Chapter\")[This is Chapter D]\n// #my-par(id: \"11\", lorem(50))\n// #my-par(id: \"11a\", lorem(20))\n\n// #my-h1(short: \"III. Section\")[This is III. Section]\n// #my-h2(short: \"E-Chapter\")[This is Chapter E]\n// #my-par(id: \"11\", lorem(50))\n// #my-par(id: \"11a\", lorem(20))\n\n// #my-h2(short: \"F-Chapter\")[This is Chapter F]\n// Regular Content #lorem(200)\n\n// #my-h2(short: \"G-Chapter\")[This is Chapter G]\n// Regular Content #lorem(100)\n\n// #my-h2(short: \"H-Chapter\")[This is Chapter H]\n// #my-par(id: \"1\", lorem(50))\n// #my-par(id: \"2\", lorem(20))\n```\n[/details]",
      "reply_to_post_number": 10,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 4.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 566
    },
    {
      "id": 10683,
      "post_number": 13,
      "username": "sijo",
      "name": "",
      "created_at": "2025-04-06T10:25:46.712Z",
      "updated_at": "2025-04-06T10:26:03.497Z",
      "cooked": "<p>I think normally when metadata is added after a paragraph it‚Äôs not part of the paragraph. In the previous version of this code <code>my-par</code> was making an actual paragraph, so it forced the metadata to be part of the paragraph. Now it‚Äôs not the case anymore. To make the metadata part of the paragraph you can add some more text after it like your invisible space (maybe a cleaner version would be to append <code>#sym.zws</code>), or you can wrap the metadata in a box‚Ä¶</p>",
      "raw": "I think normally when metadata is added after a paragraph it's not part of the paragraph. In the previous version of this code `my-par` was making an actual paragraph, so it forced the metadata to be part of the paragraph. Now it's not the case anymore. To make the metadata part of the paragraph you can add some more text after it like your invisible space (maybe a cleaner version would be to append `#sym.zws`), or you can wrap the metadata in a box...",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 8.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 10685,
      "post_number": 14,
      "username": "a_w",
      "name": "Alex",
      "created_at": "2025-04-06T10:35:46.885Z",
      "updated_at": "2025-04-06T10:35:46.885Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"sijo\" data-post=\"13\" data-topic=\"3456\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/0A3649/48.png\" class=\"avatar\"> sijo:</div>\n<blockquote>\n<p>or you can wrap the metadata in a box‚Ä¶</p>\n</blockquote>\n</aside>\n<p>Ahh, that makes sense! I think <code>box()[#metadata([#id])&lt;h4-end&gt;]</code> might make the least troubles. Thanks for the input! <img src=\"https://forum.typst.app/images/emoji/apple/pray.png?v=12\" title=\":pray:\" class=\"emoji\" alt=\":pray:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "[quote=\"sijo, post:13, topic:3456\"]\nor you can wrap the metadata in a box‚Ä¶\n[/quote]\n\nAhh, that makes sense! I think `box()[#metadata([#id])<h4-end>]` might make the least troubles. Thanks for the input! üôè",
      "reply_to_post_number": 13,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 20,
      "score": 9.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 566
    },
    {
      "id": 10687,
      "post_number": 15,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-06T10:43:57.782Z",
      "updated_at": "2025-04-06T10:43:57.782Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"a_w\" data-post=\"14\" data-topic=\"3456\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/a_w/48/1206_2.png\" class=\"avatar\"> a_w:</div>\n<blockquote>\n<p><code>box()[#metadata([#id])&lt;h4-end&gt;]</code></p>\n</blockquote>\n</aside>\n<p>You can write it like this: <code>box[#metadata[#id]&lt;h4-end&gt;]</code>.</p>",
      "raw": "[quote=\"a_w, post:14, topic:3456\"]\n`box()[#metadata([#id])<h4-end>]`\n[/quote]\n\nYou can write it like this: `box[#metadata[#id]<h4-end>]`.",
      "reply_to_post_number": 14,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 19,
      "score": 18.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:49:52.040099"
}
{
  "topic_metadata": {
    "id": 3466,
    "title": "How can I have a temporary local counter for equations?",
    "slug": "how-can-i-have-a-temporary-local-counter-for-equations",
    "posts_count": 5,
    "created_at": "2025-03-31T13:56:17.463Z",
    "last_posted_at": "2025-03-31T21:48:54.058Z",
    "views": 94,
    "like_count": 7,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "math",
      "counter"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 1113
  },
  "posts": [
    {
      "id": 10460,
      "post_number": 1,
      "username": "heptocat",
      "name": "",
      "created_at": "2025-03-31T13:56:17.600Z",
      "updated_at": "2025-04-18T13:08:51.089Z",
      "cooked": "<p>Hi<br>\nIn my document, I would like to at some points, have equations with a custom, local numbering</p>\n<p>equation (1)</p>\n<p>(i) first local equation<br>\n(ii) second local equation<br>\n(iii) third local equation</p>\n<p>equation (2)</p>\n<p>that does not interfere with the global numbering of equations in the document. I know how to customize the look of the equation number and how to manually set the counter, but not how to switch back to the original number. Ideally I would be able to assign a fresh counter to equations, or have a block that ignores the document‚Äôs equation counter, but it doesn‚Äôt seem possible, so I‚Äôm contented with this hacky approach that <em>almost</em> works (see screenshot):</p>\n<pre><code class=\"lang-auto\">#set enum(numbering: \"(i)\", indent: 1em) // remember the indent you set here, important!\n#set text(font:\"New Computer Modern\")\n#set math.equation(numbering: \"(1)\")\n\n$ a = 1 $&lt;label&gt;\n\n#[\n  // #let c = current math equation counter somehow?\n  #counter(math.equation).update(0)\n  #set math.equation(numbering: \"(i)\", number-align:left+horizon)\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n  // counter(math.equation).update(c)\n]\n\n$ a = 2 $\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/5/5fedffbea12efc38b870ff49e38648b77f03f508.png\" alt=\"image\" data-base62-sha1=\"dGDgKF9vhhbji3q4yxlhFt71UeY\" width=\"518\" height=\"148\"></p>\n<p>it works as I want it, except that the equation a =2 should be numbered 2. I don‚Äôt know how to access the int of the counter (.get().at(0) returns content), or how to create a fresh counter for my block. And ideas on how to achieve this? Cheers!</p>",
      "raw": "Hi\nIn my document, I would like to at some points, have equations with a custom, local numbering\n\nequation (1)\n\n(i) first local equation\n(ii) second local equation\n(iii) third local equation\n\nequation (2)\n\nthat does not interfere with the global numbering of equations in the document. I know how to customize the look of the equation number and how to manually set the counter, but not how to switch back to the original number. Ideally I would be able to assign a fresh counter to equations, or have a block that ignores the document's equation counter, but it doesn't seem possible, so I'm contented with this hacky approach that *almost* works (see screenshot):\n\n```\n#set enum(numbering: \"(i)\", indent: 1em) // remember the indent you set here, important!\n#set text(font:\"New Computer Modern\")\n#set math.equation(numbering: \"(1)\")\n\n$ a = 1 $<label>\n\n#[\n  // #let c = current math equation counter somehow?\n  #counter(math.equation).update(0)\n  #set math.equation(numbering: \"(i)\", number-align:left+horizon)\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n  // counter(math.equation).update(c)\n]\n\n$ a = 2 $\n```\n![image|518x148](upload://dGDgKF9vhhbji3q4yxlhFt71UeY.png)\n\nit works as I want it, except that the equation a =2 should be numbered 2. I don't know how to access the int of the counter (.get().at(0) returns content), or how to create a fresh counter for my block. And ideas on how to achieve this? Cheers!",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 165.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 659
    },
    {
      "id": 10461,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-03-31T14:05:03.748Z",
      "updated_at": "2025-03-31T14:06:21.862Z",
      "cooked": "<p>If you wrap everything in a context, you can write</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#context [\n  #let c = counter(math.equation).get()\n  #counter(math.equation).update(0)\n  #set math.equation(numbering: \"(i)\", number-align:left+horizon)\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n  #counter(math.equation).update(c)\n]\n</code></pre>\n<p>With a small function definition, you can write</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let eq(body) = context {\n  let c = counter(math.equation).get()\n  counter(math.equation).update(0)\n  body\n  counter(math.equation).update(c)\n}\n\n$ a = 1 $&lt;label&gt;\n\n#eq[\n  #set math.equation(numbering: \"(i)\", number-align:left+horizon)\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n</code></pre>\n<aside class=\"quote no-group\" data-username=\"heptocat\" data-post=\"1\" data-topic=\"3466\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/h/2DAB7D/48.png\" class=\"avatar\"> heptocat:</div>\n<blockquote>\n<p>I don‚Äôt know how to access the int of the counter (.get().at(0) returns content)</p>\n</blockquote>\n</aside>\n<p>See <a href=\"https://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164\" class=\"inline-onebox\">Why is the value I receive from context always content?</a></p>",
      "raw": "If you wrap everything in a context, you can write\n\n```typ\n#context [\n  #let c = counter(math.equation).get()\n  #counter(math.equation).update(0)\n  #set math.equation(numbering: \"(i)\", number-align:left+horizon)\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n  #counter(math.equation).update(c)\n]\n```\n\nWith a small function definition, you can write\n\n```typ\n#let eq(body) = context {\n  let c = counter(math.equation).get()\n  counter(math.equation).update(0)\n  body\n  counter(math.equation).update(c)\n}\n\n$ a = 1 $<label>\n\n#eq[\n  #set math.equation(numbering: \"(i)\", number-align:left+horizon)\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n```\n\n[quote=\"heptocat, post:1, topic:3466\"]\nI don‚Äôt know how to access the int of the counter (.get().at(0) returns content)\n[/quote]\nSee https://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 4,
      "reads": 28,
      "score": 70.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 10472,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-31T19:46:26.390Z",
      "updated_at": "2025-03-31T21:49:53.494Z",
      "cooked": "<p>You probably will use this multiple times, in which case this will simplify it even further:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let eq(body, numbering: \"(i)\", number-align: left + horizon) = context {\n  let eq-counter = counter(math.equation)\n  let c = eq-counter.get()\n  eq-counter.update(0)\n  set math.equation(numbering: numbering, number-align: number-align)\n  body\n  eq-counter.update(c)\n}\n\n$ a = 1 $ &lt;label&gt;\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n</code></pre>",
      "raw": "You probably will use this multiple times, in which case this will simplify it even further:\n\n```typ\n#let eq(body, numbering: \"(i)\", number-align: left + horizon) = context {\n  let eq-counter = counter(math.equation)\n  let c = eq-counter.get()\n  eq-counter.update(0)\n  set math.equation(numbering: numbering, number-align: number-align)\n  body\n  eq-counter.update(c)\n}\n\n$ a = 1 $ <label>\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 4.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10475,
      "post_number": 4,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2025-03-31T21:25:42.640Z",
      "updated_at": "2025-03-31T21:28:17.198Z",
      "cooked": "<p>Note that the given solutions only work if the <code>eq</code> function isn‚Äôt used more than 5 times in the document, as otherwise the layout doesn‚Äôt converge. You can read more about why this is the case in <a href=\"https://forum.typst.app/t/why-is-state-final-not-final/1483/2\" class=\"inline-onebox\">Why is State Final not \"final\"? - #2 by SillyFreak</a>.</p>\n<p>The solution I came with is a bit more complex, but works also when used more than 5 times:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set math.equation(numbering: \"(1)\")\n\n#let eq(body, numbering: \"(i)\", number-align: start + horizon) = {\n  // Counter for this \"eq\" function, as each one can contain\n  // a different amount of sub-equations.\n  let eq-counter = counter(\"eq\")\n  eq-counter.step()\n\n  context {\n    // Unique counter for sub-equations in this \"eq\" block.\n    let sub-counter = counter(\"eq/\" + str(eq-counter.get().first()))\n\n    // Use the sub-counter to number the sub-equations.\n    // We need to add 1 since the counter is only stepped the first time\n    // after the first equation (and number) has already been constructed.\n    set math.equation(\n      numbering: (..) =&gt; std.numbering(numbering, sub-counter.get().first() + 1),\n      number-align: number-align\n    )\n      \n    // Step the sub-equation counter for each numbered sub-equation.\n    show math.equation.where(block: true): it =&gt; {\n      if it.numbering != none {\n        sub-counter.step()\n      }\n      it\n    }\n\n    body\n\n    // Step back main equation counter so that the sub-equations\n    // aren't counted towards the main equation number.\n    let sub-eqs = sub-counter.final().first()\n    counter(math.equation).update(n =&gt; n - sub-eqs)\n  }\n}\n</code></pre>",
      "raw": "Note that the given solutions only work if the `eq` function isn't used more than 5 times in the document, as otherwise the layout doesn't converge. You can read more about why this is the case in https://forum.typst.app/t/why-is-state-final-not-final/1483/2?u=eric.\n\nThe solution I came with is a bit more complex, but works also when used more than 5 times:\n```typ\n#set math.equation(numbering: \"(1)\")\n\n#let eq(body, numbering: \"(i)\", number-align: start + horizon) = {\n  // Counter for this \"eq\" function, as each one can contain\n  // a different amount of sub-equations.\n  let eq-counter = counter(\"eq\")\n  eq-counter.step()\n\n  context {\n    // Unique counter for sub-equations in this \"eq\" block.\n    let sub-counter = counter(\"eq/\" + str(eq-counter.get().first()))\n\n    // Use the sub-counter to number the sub-equations.\n    // We need to add 1 since the counter is only stepped the first time\n    // after the first equation (and number) has already been constructed.\n    set math.equation(\n      numbering: (..) => std.numbering(numbering, sub-counter.get().first() + 1),\n      number-align: number-align\n    )\n      \n    // Step the sub-equation counter for each numbered sub-equation.\n    show math.equation.where(block: true): it => {\n      if it.numbering != none {\n        sub-counter.step()\n      }\n      it\n    }\n\n    body\n\n    // Step back main equation counter so that the sub-equations\n    // aren't counted towards the main equation number.\n    let sub-eqs = sub-counter.final().first()\n    counter(math.equation).update(n => n - sub-eqs)\n  }\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 20,
      "score": 69.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 10476,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-03-31T21:48:54.058Z",
      "updated_at": "2025-03-31T22:08:06.131Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Eric\" data-post=\"4\" data-topic=\"3466\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/eric/48/87_2.png\" class=\"avatar\"> Eric:</div>\n<blockquote>\n<p>Note that the given solutions only work if the <code>eq</code> function isn‚Äôt used more than 5 times in the document, as otherwise the layout doesn‚Äôt converge.</p>\n</blockquote>\n</aside>\n<p>This is incorrect.</p>\n<details><summary>eq function used more than 5 times in the document</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let eq(body, numbering: \"(i)\", number-align: left + horizon) = context {\n  let eq-counter = counter(math.equation)\n  let c = eq-counter.get()\n  eq-counter.update(0)\n  set math.equation(numbering: numbering, number-align: number-align)\n  body\n  eq-counter.update(c)\n}\n\n$ a = 1 $ &lt;label&gt;\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n</code></pre>\n</details>\n<p>That is, unless global <code>set math.equation(numbering: \"(1)\")</code> is added, which is actually present in the OP. So, good catch.</p>\n<p>You can combine <code>.step()</code> and <code>.get()</code> like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let eq(body, numbering: \"(i)\", number-align: left + horizon) = {\n  let eq-counter = counter(\"eq\")\n  eq-counter.step()\n  context {\n    let sub-counter = counter(\"eq/\" + str(eq-counter.get().first()))\n    let sub-eq-total = sub-counter.final().first()\n    let value = context std.numbering(numbering, ..sub-counter.get())\n    set math.equation(\n      numbering: (..) =&gt; sub-counter.step() + value,\n      number-align: number-align,\n    )\n    body\n    counter(math.equation).update(n =&gt; n - sub-eq-total)\n  }\n}\n</code></pre>\n<details><summary>Full example</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let eq(body, numbering: \"(i)\", number-align: left + horizon) = {\n  let eq-counter = counter(\"eq\")\n  eq-counter.step()\n  context {\n    let sub-counter = counter(\"eq/\" + str(eq-counter.get().first()))\n    let sub-eq-total = sub-counter.final().first()\n    let value = context std.numbering(numbering, ..sub-counter.get())\n    set math.equation(\n      numbering: (..) =&gt; sub-counter.step() + value,\n      number-align: number-align,\n    )\n    body\n    counter(math.equation).update(n =&gt; n - sub-eq-total)\n  }\n}\n\n#set math.equation(numbering: \"(1)\")\n\n$ a = 1 $ &lt;label&gt;\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n</code></pre>\n</details>",
      "raw": "[quote=\"Eric, post:4, topic:3466\"]\nNote that the given solutions only work if the `eq` function isn‚Äôt used more than 5 times in the document, as otherwise the layout doesn‚Äôt converge.\n[/quote]\n\nThis is incorrect.\n\n<details><summary>eq function used more than 5 times in the document</summary>\n\n```typ\n#let eq(body, numbering: \"(i)\", number-align: left + horizon) = context {\n  let eq-counter = counter(math.equation)\n  let c = eq-counter.get()\n  eq-counter.update(0)\n  set math.equation(numbering: numbering, number-align: number-align)\n  body\n  eq-counter.update(c)\n}\n\n$ a = 1 $ <label>\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n```\n\n</details>\n\nThat is, unless global `set math.equation(numbering: \"(1)\")` is added, which is actually present in the OP. So, good catch.\n\nYou can combine `.step()` and `.get()` like this:\n\n```typ\n#let eq(body, numbering: \"(i)\", number-align: left + horizon) = {\n  let eq-counter = counter(\"eq\")\n  eq-counter.step()\n  context {\n    let sub-counter = counter(\"eq/\" + str(eq-counter.get().first()))\n    let sub-eq-total = sub-counter.final().first()\n    let value = context std.numbering(numbering, ..sub-counter.get())\n    set math.equation(\n      numbering: (..) => sub-counter.step() + value,\n      number-align: number-align,\n    )\n    body\n    counter(math.equation).update(n => n - sub-eq-total)\n  }\n}\n```\n\n<details><summary>Full example</summary>\n\n```typ\n#let eq(body, numbering: \"(i)\", number-align: left + horizon) = {\n  let eq-counter = counter(\"eq\")\n  eq-counter.step()\n  context {\n    let sub-counter = counter(\"eq/\" + str(eq-counter.get().first()))\n    let sub-eq-total = sub-counter.final().first()\n    let value = context std.numbering(numbering, ..sub-counter.get())\n    set math.equation(\n      numbering: (..) => sub-counter.step() + value,\n      number-align: number-align,\n    )\n    body\n    counter(math.equation).update(n => n - sub-eq-total)\n  }\n}\n\n#set math.equation(numbering: \"(1)\")\n\n$ a = 1 $ <label>\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n\n#eq[\n  $ b = 1 $\n  $ b = 2 $\n  $ b = 3 $\n]\n\n$ a = 2 $\n```\n\n</details>",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 19,
      "score": 18.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:49:51.237570"
}
{
  "topic_metadata": {
    "id": 3472,
    "title": "How to make `\"1 / 1\"` numbering ignore the back matter?",
    "slug": "how-to-make-1-1-numbering-ignore-the-back-matter",
    "posts_count": 5,
    "created_at": "2025-04-01T05:53:53.485Z",
    "last_posted_at": "2025-04-01T10:35:06.686Z",
    "views": 52,
    "like_count": 6,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "Y.D.X",
    "tags": [
      "numbering",
      "counter"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 417
  },
  "posts": [
    {
      "id": 10480,
      "post_number": 1,
      "username": "Y.D.X",
      "name": "Y.D.X.",
      "created_at": "2025-04-01T05:53:53.815Z",
      "updated_at": "2025-04-01T06:12:47.167Z",
      "cooked": "<p><a href=\"https://typst.app/docs/reference/introspection/counter/#definitions-display-both\">The <code>\"1 / 1\"</code> numbering pattern</a> displays the current and total number of pages, where the <em>total</em> number means the final top-level count.</p>\n<p>I want to use <code>\"1 / 1\"</code> for main matter, and <code>\"A\"</code> for back matter. Therefore, the final count would be the number of pages of the <em>back</em> matter. How to change it to that of the <em>main</em> matter?</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set page(height: auto, width: 10em)\n\n#set page(numbering: \"1 / 1\")\n\nMain matter // 1 / 3 üëà How to change to 1 / 2?\n#pagebreak()\nMain matter // 2 / 3 üëà How to change to 2 / 2?\n#pagebreak()\n\n// I need \"A\", but let‚Äôs use \"A / 1\" for debugging.\n#set page(numbering: \"A / 1\")\n#counter(page).update(1)\n\nBack matter // A / 3\n#pagebreak()\nBack matter // B / 3\n#pagebreak()\nBack matter // C / 3\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/9243a8914608b1d9a64288690b81bc416e4d1fe8.png\" data-download-href=\"https://forum.typst.app/uploads/default/9243a8914608b1d9a64288690b81bc416e4d1fe8\" title=\"screenshot in the web app\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/9243a8914608b1d9a64288690b81bc416e4d1fe8_2_690x430.png\" alt=\"screenshot in the web app\" data-base62-sha1=\"kRUFqSihX431o0MgWfwMBtGpIbm\" width=\"690\" height=\"430\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/9243a8914608b1d9a64288690b81bc416e4d1fe8_2_690x430.png, https://forum.typst.app/uploads/default/optimized/2X/9/9243a8914608b1d9a64288690b81bc416e4d1fe8_2_1035x645.png 1.5x, https://forum.typst.app/uploads/default/original/2X/9/9243a8914608b1d9a64288690b81bc416e4d1fe8.png 2x\" data-dominant-color=\"EEEFF1\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">screenshot in the web app</span><span class=\"informations\">1100√ó686 121 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Besides, should this behaviour be considered as a bug?</p>\n<h2><a name=\"p-10480-update-1\" class=\"anchor\" href=\"#p-10480-update-1\"></a>Update</h2>\n<p>I find <a href=\"https://typst.app/universe/package/anti-matter/\" class=\"inline-onebox\">anti-matter ‚Äì Typst Universe</a> from the following answer, but its latest release was in December 2023. <s>Is it still relevant today?</s> It can‚Äôt compile with typst v0.13 because ‚Äúonly element functions can be used as selectors‚Äù.</p>\n<aside class=\"quote quote-modified\" data-post=\"2\" data-topic=\"2496\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/q/662200/48.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/how-can-i-continue-frontmatter-numbering-in-backmatter/2496/2\">How can I continue frontmatter numbering in backmatter?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    You can look at the package <a href=\"https://typst.app/universe/package/anti-matter/\" class=\"inline-onebox\">anti-matter ‚Äì Typst Universe</a>. \nIf you don‚Äôt want to use a package, then a simple PoC would be \n#let frontmatter(body) = {\n    set page(numbering: \"i\")\n    body\n}\n#let mainmatter(body) = {\n    set page(numbering: \"1\")\n    context counter(\"antimatter\").update(counter(page).get())\n    body\n}\n#let backmatter(body) = {\n    set page(numbering: \"i\")\n    context counter(page).update(counter(\"antimatter\").get())\n    body    \n}\n\n#show: frontmatter\n#lorem(100)\n#pagebreak()\n#lore‚Ä¶\n  </blockquote>\n</aside>\n",
      "raw": "[The `\"1 / 1\"` numbering pattern](https://typst.app/docs/reference/introspection/counter/#definitions-display-both) displays the current and total number of pages, where the _total_ number means the final top-level count.\n\nI want to use `\"1 / 1\"` for main matter, and `\"A\"` for back matter. Therefore, the final count would be the number of pages of the *back* matter. How to change it to that of the *main* matter?\n\n```typst\n#set page(height: auto, width: 10em)\n\n#set page(numbering: \"1 / 1\")\n\nMain matter // 1 / 3 üëà How to change to 1 / 2?\n#pagebreak()\nMain matter // 2 / 3 üëà How to change to 2 / 2?\n#pagebreak()\n\n// I need \"A\", but let‚Äôs use \"A / 1\" for debugging.\n#set page(numbering: \"A / 1\")\n#counter(page).update(1)\n\nBack matter // A / 3\n#pagebreak()\nBack matter // B / 3\n#pagebreak()\nBack matter // C / 3\n```\n\n![screenshot in the web app|690x430](upload://kRUFqSihX431o0MgWfwMBtGpIbm.png)\n\nBesides, should this behaviour be considered as a bug?\n\n## Update\n\nI find https://typst.app/universe/package/anti-matter/ from the following answer, but its latest release was in December 2023. ~~Is it still relevant today?~~ It can't compile with typst v0.13 because ‚Äúonly element functions can be used as selectors‚Äù.\n\nhttps://forum.typst.app/t/how-can-i-continue-frontmatter-numbering-in-backmatter/2496/2?u=y.d.x",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 29,
      "score": 40.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 292
    },
    {
      "id": 10482,
      "post_number": 2,
      "username": "sijo",
      "name": "",
      "created_at": "2025-04-01T07:32:40.876Z",
      "updated_at": "2025-04-01T07:32:40.876Z",
      "cooked": "<p>As you say <code>1 / 1</code> uses the final counter value. If that‚Äôs not what you want, you can build the footer manually:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(height: auto, width: 10em)\n\n#set page(footer: context align(center)[\n #counter(page).get().first() / #counter(page).at(&lt;main-end&gt;).first()\n])\n\nMain matter\n#pagebreak()\nMain matter\n&lt;main-end&gt;\n\n#pagebreak()\n\n// I need \"A\", but let‚Äôs use \"A / 1\" for debugging.\n#set page(numbering: \"A / 1\", footer: auto)\n#counter(page).update(1)\n\nBack matter // A / 3\n#pagebreak()\nBack matter // B / 3\n#pagebreak()\nBack matter // C / 3\n</code></pre>",
      "raw": "As you say `1 / 1` uses the final counter value. If that's not what you want, you can build the footer manually:\n\n```typ\n#set page(height: auto, width: 10em)\n\n#set page(footer: context align(center)[\n #counter(page).get().first() / #counter(page).at(<main-end>).first()\n])\n\nMain matter\n#pagebreak()\nMain matter\n<main-end>\n\n#pagebreak()\n\n// I need \"A\", but let‚Äôs use \"A / 1\" for debugging.\n#set page(numbering: \"A / 1\", footer: auto)\n#counter(page).update(1)\n\nBack matter // A / 3\n#pagebreak()\nBack matter // B / 3\n#pagebreak()\nBack matter // C / 3\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 25,
      "score": 25.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 10483,
      "post_number": 3,
      "username": "Y.D.X",
      "name": "Y.D.X.",
      "created_at": "2025-04-01T08:02:23.152Z",
      "updated_at": "2025-04-01T10:26:19.031Z",
      "cooked": "<p>Thanks! I didn‚Äôt know labels can be used like that.</p>\n<p>I replace your <code>footer</code> with <code>numbering</code>, and end up with the following.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set page(numbering: (..nums) =&gt; [\n  #nums.pos().first() / #counter(page).at(&lt;main-matter-end&gt;).first()\n])\n\nMain matter\n\n#metadata(\"End of main matter\") &lt;main-matter-end&gt;\n#set page(numbering: \"A\")\n#counter(page).update(1)\n\nBack matter\n</code></pre>",
      "raw": "Thanks! I didn't know labels can be used like that.\n\nI replace your `footer` with `numbering`, and end up with the following.\n\n```typst\n#set page(numbering: (..nums) => [\n  #nums.pos().first() / #counter(page).at(<main-matter-end>).first()\n])\n\nMain matter\n\n#metadata(\"End of main matter\") <main-matter-end>\n#set page(numbering: \"A\")\n#counter(page).update(1)\n\nBack matter\n```",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 23,
      "score": 39.6,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 292
    },
    {
      "id": 10487,
      "post_number": 4,
      "username": "sijo",
      "name": "",
      "created_at": "2025-04-01T09:13:01.083Z",
      "updated_at": "2025-04-01T13:00:05.270Z",
      "cooked": "<p>Ah yes it‚Äôs nicer to just change the numbering! You can mark your own version as accepted answer.</p>",
      "raw": "Ah yes it's nicer to just change the numbering! You can mark your own version as accepted answer.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 23,
      "score": 24.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 10493,
      "post_number": 5,
      "username": "Y.D.X",
      "name": "Y.D.X.",
      "created_at": "2025-04-01T10:35:06.686Z",
      "updated_at": "2025-04-01T10:35:06.686Z",
      "cooked": "<p>It‚Äôs nice of you! And I‚Äôve updated my post with <code>#metadata</code>, because I found the unbound label complains occasionally (e.g., the main matter ends with another label).</p>",
      "raw": "It's nice of you! And I've updated my post with `#metadata`, because I found the unbound label complains occasionally (e.g., the main matter ends with another label).",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 20,
      "score": 19.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 292
    }
  ],
  "scraped_at": "2025-06-10T09:49:50.482429"
}
{
  "topic_metadata": {
    "id": 3480,
    "title": "How can I extend Linguify for language-dependent images? - Converting linguify context to string",
    "slug": "how-can-i-extend-linguify-for-language-dependent-images-converting-linguify-context-to-string",
    "posts_count": 7,
    "created_at": "2025-04-01T12:02:35.478Z",
    "last_posted_at": "2025-04-05T12:57:52.945Z",
    "views": 92,
    "like_count": 6,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "TobiOneCenobi",
    "tags": [
      "scripting",
      "packages"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 1426
  },
  "posts": [
    {
      "id": 10496,
      "post_number": 1,
      "username": "TobiOneCenobi",
      "name": "",
      "created_at": "2025-04-01T12:02:35.692Z",
      "updated_at": "2025-04-05T12:56:53.802Z",
      "cooked": "<p>Hi everyone,</p>\n<p>I‚Äôm currently working on extending the functionality of the <code>linguify</code> package to also handle language-specific images. My goal is to achieve this without explicit conditional logic (like <code>if/else</code> statements), so that users only need to specify the desired language, and the correct image will be displayed automatically.</p>\n<p>For those unfamiliar with it, <code>linguify</code> is a package that helps with internationalization by managing language-specific content defined in TOML files.</p>\n<p>I‚Äôve successfully configured my TOML file to include paths to different language versions of the same image:</p>\n<pre data-code-wrap=\"toml\"><code class=\"lang-toml\">[conf]\ndefault-lang = \"en\"\n\n[lang.en]\ncover_title = \"Pancake Machine\"\ndate = \"Date\"\nrevision = \"Revision\"\nflag_logo = \"Cover/Pictures/Flag_of_the_United_Kingdom_(1-2).webp\"\n\n[lang.de]\ncover_title = \"Pfannkuchenmaschine\"\ndate = \"Datum\"\nrevision = \"Revision\"\nflag_logo = \"Cover/Pictures/Flag_of_Germany.webp\"\n\n[lang.fr]\ncover_title = \"machine √† cr√™pes\"\ndate = \"Date\"\nrevision = \"R√©vision\"\nflag_logo = \"Cover/Pictures/Flag_of_France_(2020√¢__present).webp\"\n</code></pre>\n<p>My idea was to use the <code>linguify</code> function to retrieve the correct image path based on the currently selected language. I envisioned something like this in my template/code:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#image(linguify(\"flag_logo\"))\n</code></pre>\n<p>However, I‚Äôve run into a problem. It seems that the <code>#image()</code> function expects a string representing the image path, while the <code>linguify()</code> function, when used in this context, returns a context object (likely containing more than just the string value).</p>\n<p>I‚Äôm struggling to figure out how to properly extract the string value (the image path) from the context object returned by <code>linguify()</code> so that it can be used by the <code>#image()</code> function.</p>\n<p>Could anyone provide some guidance on how to convert the context returned by <code>linguify(\"flag_logo\")</code> into a simple string containing the image path? Any suggestions or alternative approaches to achieve language-dependent images without explicit logic would be greatly appreciated!</p>",
      "raw": "Hi everyone,\n\nI'm currently working on extending the functionality of the `linguify` package to also handle language-specific images. My goal is to achieve this without explicit conditional logic (like `if/else` statements), so that users only need to specify the desired language, and the correct image will be displayed automatically.\n\nFor those unfamiliar with it, `linguify` is a package that helps with internationalization by managing language-specific content defined in TOML files.\n\nI've successfully configured my TOML file to include paths to different language versions of the same image:\n\n```toml\n[conf]\ndefault-lang = \"en\"\n\n[lang.en]\ncover_title = \"Pancake Machine\"\ndate = \"Date\"\nrevision = \"Revision\"\nflag_logo = \"Cover/Pictures/Flag_of_the_United_Kingdom_(1-2).webp\"\n\n[lang.de]\ncover_title = \"Pfannkuchenmaschine\"\ndate = \"Datum\"\nrevision = \"Revision\"\nflag_logo = \"Cover/Pictures/Flag_of_Germany.webp\"\n\n[lang.fr]\ncover_title = \"machine √† cr√™pes\"\ndate = \"Date\"\nrevision = \"R√©vision\"\nflag_logo = \"Cover/Pictures/Flag_of_France_(2020√¢__present).webp\"\n```\n\nMy idea was to use the `linguify` function to retrieve the correct image path based on the currently selected language. I envisioned something like this in my template/code:\n\n```typ\n#image(linguify(\"flag_logo\"))\n```\n\nHowever, I've run into a problem. It seems that the `#image()` function expects a string representing the image path, while the `linguify()` function, when used in this context, returns a context object (likely containing more than just the string value).\n\nI'm struggling to figure out how to properly extract the string value (the image path) from the context object returned by `linguify()` so that it can be used by the `#image()` function.\n\nCould anyone provide some guidance on how to convert the context returned by `linguify(\"flag_logo\")` into a simple string containing the image path? Any suggestions or alternative approaches to achieve language-dependent images without explicit logic would be greatly appreciated!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 61.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1405
    },
    {
      "id": 10499,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-04-01T12:14:15.639Z",
      "updated_at": "2025-04-01T12:14:15.639Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/tobionecenobi\">@TobiOneCenobi</a>, welcome and thank you for your question! I have changed your post‚Äôs title to bring it in line with the <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">question guidelines</a> and thus make it easier to understand from the title:</p>\n<blockquote>\n<p><strong>Good titles are questions you would ask your friend about Typst.</strong></p>\n</blockquote>\n<hr>\n<p>First of all, the basic problem you‚Äôre facing is the following:</p>\n<aside class=\"quote quote-modified\" data-post=\"2\" data-topic=\"164\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/laurmaedje/48/14_2.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164/2\">Why is the value I receive from context always content?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    When working with context, you need to put everything that depends on the contextual information into the context block/expression itself. The explicit context expression is a trade-off: You get to know where in the document you are (accessible via <a href=\"https://typst.app/docs/reference/introspection/here/\">here()</a>) and which set rules are active there (accessible via things like text.lang). In return, the context value itself becomes opaque. You cannot peek into it, so everything that depends on the contextual information must happen within it. \nLet‚Äôs lo‚Ä¶\n  </blockquote>\n</aside>\n\n<p>Linguify can‚Äôt change that, but it can offer an option that requires <em>you</em> to provide context instead of doing that itself. I also help maintain that package, so I can give a bit of insight. The <code>linguify()</code> function is defined <a href=\"https://github.com/typst-community/linguify/blob/853be0ef1904ff9c2482c16ff52137f3124e89d0/src/linguify.typ#L154-L188\">here</a>, and the problematic code is the following:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">  if from == auto or lang == auto {\n    // context is needed to use the default database or current language\n    context impl()\n  } else {\n    impl()\n  }\n</code></pre>\n<p>As you can see, you can work around this problem by providing the config and language explicitly, but that‚Äôs of course no fun. To support your use case (and have a github account), you could make a PR adding a parameter <code>outside-context: false</code> that, when set to <code>true</code> goes to the <code>else</code> branch. This enables you to get actual strings from the function, at the cost of having to call it as <code>context do-something(linguify(...))</code>.</p>",
      "raw": "Hi @TobiOneCenobi, welcome and thank you for your question! I have changed your post‚Äôs title to bring it in line with the [question guidelines](https://forum.typst.app/t/how-to-post-in-the-questions-category/11) and thus make it easier to understand from the title:\n\n> **Good titles are questions you would ask your friend about Typst.**\n\n---\n\nFirst of all, the basic problem you're facing is the following:\n\nhttps://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164/2?u=sillyfreak\n\nLinguify can't change that, but it can offer an option that requires _you_ to provide context instead of doing that itself. I also help maintain that package, so I can give a bit of insight. The `linguify()` function is defined [here](https://github.com/typst-community/linguify/blob/853be0ef1904ff9c2482c16ff52137f3124e89d0/src/linguify.typ#L154-L188), and the problematic code is the following:\n\n```typc\n  if from == auto or lang == auto {\n    // context is needed to use the default database or current language\n    context impl()\n  } else {\n    impl()\n  }\n```\n\nAs you can see, you can work around this problem by providing the config and language explicitly, but that's of course no fun. To support your use case (and have a github account), you could make a PR adding a parameter `outside-context: false` that, when set to `true` goes to the `else` branch. This enables you to get actual strings from the function, at the cost of having to call it as `context do-something(linguify(...))`.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 31.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 10500,
      "post_number": 3,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-01T12:14:56.323Z",
      "updated_at": "2025-04-01T12:14:56.323Z",
      "cooked": "<p>Context values are opaque and there‚Äôs no way to access their contents.</p>\n<p>Two options I‚Äôm thinking of</p>\n<ol>\n<li>Remove <code>context</code> inside linguify and require the user to call the function with context. Then it would be like <code>#context image(linguify(\"flag_logo\"))</code></li>\n<li>Allow an optional mapper with linguify, that you pass the result through before returning it, it could look like this:</li>\n</ol>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#linguify(\"flag_logo\", map: image.with(width: 50%))\n// just using with to show you can supply arguments in a good way\n</code></pre>",
      "raw": "Context values are opaque and there's no way to access their contents.\n\nTwo options I'm thinking of\n\n1. Remove `context` inside linguify and require the user to call the function with context. Then it would be like `#context image(linguify(\"flag_logo\"))`\n2. Allow an optional mapper with linguify, that you pass the result through before returning it, it could look like this:\n\n```typ\n#linguify(\"flag_logo\", map: image.with(width: 50%))\n// just using with to show you can supply arguments in a good way\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 26,
      "score": 20.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 10648,
      "post_number": 4,
      "username": "TobiOneCenobi",
      "name": "",
      "created_at": "2025-04-04T12:44:40.009Z",
      "updated_at": "2025-04-04T12:46:50.042Z",
      "cooked": "<p>Dear <a class=\"mention\" href=\"/u/sillyfreak\">@SillyFreak</a> and <a class=\"mention\" href=\"/u/bluss\">@bluss</a> ,</p>\n<p>Your suggestions about <code> #context do-something(linguify(...))</code> and <code>#context image(linguify(\"flag_logo\"))</code> were exactly what I needed to get on the right track.</p>\n<p>Building on that, I‚Äôve created a solution by wrapping <code>linguify</code> within my own set of functions. This allows me to read the TOML file, update both my custom state database and the <code>linguify</code> database, and then call my own functions within the Typst context.</p>\n<p>Here‚Äôs the code I‚Äôve put into <code>linguifyPicture.typ</code>:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#import \"@preview/linguify:0.4.2\": set-database as linguify-set-database\n\n#let language-database = state(\"language-database\", none)\n\n#let set-language-database(data) = {\n  language-database.update(data)\n}\n\n#let get-current-language = () =&gt; text.lang\n\n#let load-lang(data) = {\n  linguify-set-database(data) // Set the database for the @preview/linguify package\n  set-language-database(data) // Set the database for our standalone localized-image function\n}\n\n#let get-localized-path(key, current-lang) = {\n  let lang-data = language-database.get()\n  if lang-data == none {\n    panic(\"Language database not set. Call `load-lang()` at the beginning of your document.\")\n    return none\n  }\n\n  let path = none\n  let lang-section-name = current-lang\n\n  if lang-section-name in lang-data.lang {\n    let lang-section = lang-data.lang.at(lang-section-name)\n    if key in lang-section {\n      path = lang-section.at(key)\n    }\n  }\n\n  if path == none and \"default-lang\" in lang-data.conf {\n    let default-lang = lang-data.conf.at(\"default-lang\")\n    let default-lang-section-name = \"lang.\" + default-lang\n    if default-lang-section-name in lang-data.lang {\n      let default-lang-section = lang-data.lang.at(default-lang-section-name)\n      path = default-lang-section.at(key, default: none)\n    }\n  }\n\n  path\n}\n\n#let localized-image(key, ..args) = {\n  let current-lang = get-current-language()\n  let nicePath = get-localized-path(key, current-lang)\n  if not nicePath.starts-with(\"/\") and nicePath != none {\n    nicePath = \"/\" + nicePath\n  }\n  if nicePath != \"badPath\" {\n    image(nicePath, ..args)\n  } else {\n    panic(\"Image key '\" + key + \"' not found for language '\" + current-lang + \"'.\")\n  }\n}\n</code></pre>\n<p>I am not sure the code above is bulletproof‚Ä¶ Here‚Äôs how I‚Äôm using it in <code>main.typ</code>:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#import \"@preview/linguify:0.4.2\": * \n#import \"Tools/linguifyPicture/linguifyPicture.typ\": load-lang, localized-image\n\n#set text(lang: \"de\")\n\n#let lang-data = toml(\"Cover/translations.toml\")\n\n#load-lang(lang-data) //updates both linguify and linguifyPicture database\n\n#context localized-image(\"flag_logo\", /*image arguments here*/)\n</code></pre>\n<p>One thing I discovered is that Typst doesn‚Äôt seem to have built-in support for <code>webp</code> images, so I had to update my TOML file to use <code>.png</code> extensions instead (e.g., <code>\"Cover/Pictures/Flag_of_Germany.webp\"</code> became <code>\"Cover/Pictures/Flag_of_Germany.png\"</code>).</p>\n<p>Thanks again for your helpful insights! This approach seems to be working for my needs.</p>",
      "raw": "Dear @SillyFreak and @bluss ,\n\nYour suggestions about ` #context do-something(linguify(...))` and `#context image(linguify(\"flag_logo\"))` were exactly what I needed to get on the right track.\n\nBuilding on that, I've created a solution by wrapping `linguify` within my own set of functions. This allows me to read the TOML file, update both my custom state database and the `linguify` database, and then call my own functions within the Typst context.\n\nHere's the code I've put into `linguifyPicture.typ`:\n\n```typst\n#import \"@preview/linguify:0.4.2\": set-database as linguify-set-database\n\n#let language-database = state(\"language-database\", none)\n\n#let set-language-database(data) = {\n  language-database.update(data)\n}\n\n#let get-current-language = () => text.lang\n\n#let load-lang(data) = {\n  linguify-set-database(data) // Set the database for the @preview/linguify package\n  set-language-database(data) // Set the database for our standalone localized-image function\n}\n\n#let get-localized-path(key, current-lang) = {\n  let lang-data = language-database.get()\n  if lang-data == none {\n    panic(\"Language database not set. Call `load-lang()` at the beginning of your document.\")\n    return none\n  }\n\n  let path = none\n  let lang-section-name = current-lang\n\n  if lang-section-name in lang-data.lang {\n    let lang-section = lang-data.lang.at(lang-section-name)\n    if key in lang-section {\n      path = lang-section.at(key)\n    }\n  }\n\n  if path == none and \"default-lang\" in lang-data.conf {\n    let default-lang = lang-data.conf.at(\"default-lang\")\n    let default-lang-section-name = \"lang.\" + default-lang\n    if default-lang-section-name in lang-data.lang {\n      let default-lang-section = lang-data.lang.at(default-lang-section-name)\n      path = default-lang-section.at(key, default: none)\n    }\n  }\n\n  path\n}\n\n#let localized-image(key, ..args) = {\n  let current-lang = get-current-language()\n  let nicePath = get-localized-path(key, current-lang)\n  if not nicePath.starts-with(\"/\") and nicePath != none {\n    nicePath = \"/\" + nicePath\n  }\n  if nicePath != \"badPath\" {\n    image(nicePath, ..args)\n  } else {\n    panic(\"Image key '\" + key + \"' not found for language '\" + current-lang + \"'.\")\n  }\n}\n```\n\nI am not sure the code above is bulletproof... Here's how I'm using it in `main.typ`:\n\n```typst\n#import \"@preview/linguify:0.4.2\": * \n#import \"Tools/linguifyPicture/linguifyPicture.typ\": load-lang, localized-image\n\n#set text(lang: \"de\")\n\n#let lang-data = toml(\"Cover/translations.toml\")\n\n#load-lang(lang-data) //updates both linguify and linguifyPicture database\n\n#context localized-image(\"flag_logo\", /*image arguments here*/)\n```\n\nOne thing I discovered is that Typst doesn't seem to have built-in support for `webp` images, so I had to update my TOML file to use `.png` extensions instead (e.g., `\"Cover/Pictures/Flag_of_Germany.webp\"` became `\"Cover/Pictures/Flag_of_Germany.png\"`).\n\nThanks again for your helpful insights! This approach seems to be working for my needs.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 22,
      "score": 74.4,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 1405
    },
    {
      "id": 10664,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-04T21:59:11.687Z",
      "updated_at": "2025-04-04T21:59:11.687Z",
      "cooked": "<p>Here is a simplified version, if you want.</p>\n<details><summary>Code</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/linguify:0.4.2\": set-database as linguify-set-database\n\n#let language-database = state(\"language-database\")\n\n#let set-language-database(data) = language-database.update(data)\n#let get-current-language() = text.lang\n\n#let load-lang(data) = {\n  linguify-set-database(data) // Set the database for the @preview/linguify package\n  set-language-database(data) // Set the database for our standalone localized-image function\n}\n\n#let get-localized-path(key, current-lang) = {\n  let lang-data = language-database.get()\n  if lang-data == none {\n    panic(\"Language database not set. Call `load-lang()` at the beginning of your document.\")\n  }\n\n  let path\n  let lang-section-name = current-lang\n\n  if lang-section-name in lang-data.lang {\n    let lang-section = lang-data.lang.at(lang-section-name)\n    if key in lang-section {\n      path = lang-section.at(key)\n    }\n  }\n\n  if path == none and \"default-lang\" in lang-data.conf {\n    let default-lang = lang-data.conf.at(\"default-lang\")\n    let default-lang-section-name = \"lang.\" + default-lang\n    if default-lang-section-name in lang-data.lang {\n      let default-lang-section = lang-data.lang.at(default-lang-section-name)\n      path = default-lang-section.at(key, default: none)\n    }\n  }\n\n  path\n}\n\n#let localized-image(key, ..args) = {\n  let current-lang = get-current-language()\n  let nicePath = get-localized-path(key, current-lang)\n  if not nicePath.starts-with(\"/\") and nicePath != none {\n    nicePath = \"/\" + nicePath\n  }\n  if nicePath == \"badPath\" {\n    panic(\"Image key '\" + key + \"' not found for language '\" + current-lang + \"'.\")\n  }\n  image(nicePath, ..args)\n}\n</code></pre>\n</details>\n<p>I also see that you know how to write a proper code block for Typst snippets. Could you please fix the code block in <a href=\"https://forum.typst.app/t/how-can-i-extend-linguify-for-language-dependent-images-converting-linguify-context-to-string/3480\">the OP</a> too?</p>",
      "raw": "Here is a simplified version, if you want.\n\n<details><summary>Code</summary>\n\n```typ\n#import \"@preview/linguify:0.4.2\": set-database as linguify-set-database\n\n#let language-database = state(\"language-database\")\n\n#let set-language-database(data) = language-database.update(data)\n#let get-current-language() = text.lang\n\n#let load-lang(data) = {\n  linguify-set-database(data) // Set the database for the @preview/linguify package\n  set-language-database(data) // Set the database for our standalone localized-image function\n}\n\n#let get-localized-path(key, current-lang) = {\n  let lang-data = language-database.get()\n  if lang-data == none {\n    panic(\"Language database not set. Call `load-lang()` at the beginning of your document.\")\n  }\n\n  let path\n  let lang-section-name = current-lang\n\n  if lang-section-name in lang-data.lang {\n    let lang-section = lang-data.lang.at(lang-section-name)\n    if key in lang-section {\n      path = lang-section.at(key)\n    }\n  }\n\n  if path == none and \"default-lang\" in lang-data.conf {\n    let default-lang = lang-data.conf.at(\"default-lang\")\n    let default-lang-section-name = \"lang.\" + default-lang\n    if default-lang-section-name in lang-data.lang {\n      let default-lang-section = lang-data.lang.at(default-lang-section-name)\n      path = default-lang-section.at(key, default: none)\n    }\n  }\n\n  path\n}\n\n#let localized-image(key, ..args) = {\n  let current-lang = get-current-language()\n  let nicePath = get-localized-path(key, current-lang)\n  if not nicePath.starts-with(\"/\") and nicePath != none {\n    nicePath = \"/\" + nicePath\n  }\n  if nicePath == \"badPath\" {\n    panic(\"Image key '\" + key + \"' not found for language '\" + current-lang + \"'.\")\n  }\n  image(nicePath, ..args)\n}\n```\n\n</details>\n\nI also see that you know how to write a proper code block for Typst snippets. Could you please fix the code block in [the OP](https://forum.typst.app/t/how-can-i-extend-linguify-for-language-dependent-images-converting-linguify-context-to-string/3480) too?",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 20,
      "score": 29.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10672,
      "post_number": 6,
      "username": "TobiOneCenobi",
      "name": "",
      "created_at": "2025-04-05T12:23:51.312Z",
      "updated_at": "2025-04-05T12:23:51.312Z",
      "cooked": "<p>That‚Äôs some really well-structured code! I seem to have lost the ability to edit my post after <a class=\"mention\" href=\"/u/sillyfreak\">@SillyFreak</a> kindly updated the title.</p>",
      "raw": "That's some really well-structured code! I seem to have lost the ability to edit my post after @SillyFreak kindly updated the title.",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 23.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1405
    },
    {
      "id": 10675,
      "post_number": 7,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-04-05T12:57:52.945Z",
      "updated_at": "2025-04-05T12:57:52.945Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"TobiOneCenobi\" data-post=\"6\" data-topic=\"3480\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/t/1E7C61/48.png\" class=\"avatar\"> TobiOneCenobi:</div>\n<blockquote>\n<p>I seem to have lost the ability to edit my post</p>\n</blockquote>\n</aside>\n<p>there‚Äôs a time limit for relatively new users of one day. I have fixed the syntax highlighting, which is what I think Andrew was referring to.</p>",
      "raw": "[quote=\"TobiOneCenobi, post:6, topic:3480\"]\nI seem to have lost the ability to edit my post\n[/quote]\n\nthere's a time limit for relatively new users of one day. I have fixed the syntax highlighting, which is what I think Andrew was referring to.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 15,
      "score": 3.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:49:49.631050"
}
{
  "topic_metadata": {
    "id": 3483,
    "title": "How to control spacing between an outer enum and inner bullet list",
    "slug": "how-to-control-spacing-between-an-outer-enum-and-inner-bullet-list",
    "posts_count": 4,
    "created_at": "2025-04-01T12:35:40.652Z",
    "last_posted_at": "2025-04-01T14:59:36.186Z",
    "views": 61,
    "like_count": 2,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "Andrew",
    "tags": [
      "lists",
      "spacing"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 135
  },
  "posts": [
    {
      "id": 10502,
      "post_number": 1,
      "username": "KS84",
      "name": "KS84",
      "created_at": "2025-04-01T12:35:40.781Z",
      "updated_at": "2025-04-01T12:45:11.564Z",
      "cooked": "<p>I have a list like this:</p>\n<pre data-code-wrap=\"markdown\"><code class=\"lang-markdown\">+ Item 1\n\n  - Subitem 1\n  - Subitem 2\n\n+ Item 2\n\n  - Subitem 1\n  - Subitem 2\n</code></pre>\n<p>How can I control the spacing between the outer Item(s) and inner Subitem 1? The <code>spacing</code> and <code>leading</code> parameters don‚Äôt work for them.</p>",
      "raw": "I have a list like this:\n```markdown\n+ Item 1\n\n  - Subitem 1\n  - Subitem 2\n\n+ Item 2\n\n  - Subitem 1\n  - Subitem 2\n```\n\nHow can I control the spacing between the outer Item(s) and inner Subitem 1? The `spacing` and `leading` parameters don't work for them.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 25.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 114
    },
    {
      "id": 10503,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-04-01T12:46:03.076Z",
      "updated_at": "2025-04-01T12:46:03.076Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/ks84\">@KS84</a>, I have moved your question to the <a class=\"hashtag-cooked\" href=\"/c/questions/5\" data-type=\"category\" data-slug=\"questions\" data-id=\"5\" data-ref=\"questions::category\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>Questions</span></a> category, please make sure to check the category when creating a topic <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"> that also means that you can select an answer.</p>\n<p>I also added some tags, as it makes your question easier to find.</p>",
      "raw": "Hi @KS84, I have moved your question to the #questions::category category, please make sure to check the category when creating a topic :slight_smile: that also means that you can select an answer.\n\nI also added some tags, as it makes your question easier to find.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 27,
      "score": 20.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 10508,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-01T14:40:05.658Z",
      "updated_at": "2025-04-01T14:40:05.658Z",
      "cooked": "<p>You mean this?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show enum: it =&gt; {\n  show list: x =&gt; v(1em) + x\n  it\n}\n\n+ Item 1\n  - Subitem 1\n  - Subitem 2\n+ Item 2\n  - Subitem 1\n  - Subitem 2\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/5/538916333e59396f3d34568d0ca4fe42cf069a85.png\" alt=\"image\" data-base62-sha1=\"bUZkTnVvo0WhrUdYc5GTsactCsd\" width=\"145\" height=\"220\"></p>",
      "raw": "You mean this?\n\n```typ\n#show enum: it => {\n  show list: x => v(1em) + x\n  it\n}\n\n+ Item 1\n  - Subitem 1\n  - Subitem 2\n+ Item 2\n  - Subitem 1\n  - Subitem 2\n```\n\n![image|145x220](upload://bUZkTnVvo0WhrUdYc5GTsactCsd.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 15.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10511,
      "post_number": 4,
      "username": "KS84",
      "name": "KS84",
      "created_at": "2025-04-01T14:59:36.186Z",
      "updated_at": "2025-04-01T14:59:36.186Z",
      "cooked": "<p>Yes! This is exactly what I was looking for. Thank you!</p>\n<p><a class=\"mention\" href=\"/u/sillyfreak\">@SillyFreak</a> thank you!</p>",
      "raw": "Yes! This is exactly what I was looking for. Thank you!\n\n@SillyFreak thank you!",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 22,
      "score": 19.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 114
    }
  ],
  "scraped_at": "2025-06-10T09:49:48.876849"
}
