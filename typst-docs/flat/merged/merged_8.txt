{
  "topic_metadata": {
    "id": 1622,
    "title": "Could one create a package that invokes lilypond (an external command) and embeds the result?",
    "slug": "could-one-create-a-package-that-invokes-lilypond-an-external-command-and-embeds-the-result",
    "posts_count": 3,
    "created_at": "2024-11-09T00:06:35.714Z",
    "last_posted_at": "2024-11-10T15:35:46.454Z",
    "views": 181,
    "like_count": 1,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "scripting",
      "packages"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 101
  },
  "posts": [
    {
      "id": 5366,
      "post_number": 1,
      "username": "AlexHarter",
      "name": "Alex Harter",
      "created_at": "2024-11-09T00:06:35.806Z",
      "updated_at": "2024-11-10T15:19:29.589Z",
      "cooked": "<p>What would it take to create a package that provides a lilypond function that invokes the lilypond command and automatically embeds the resulting output?  Are there any packages that do something similar?</p>",
      "raw": "What would it take to create a package that provides a lilypond function that invokes the lilypond command and automatically embeds the resulting output?  Are there any packages that do something similar?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 526.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 774
    },
    {
      "id": 5439,
      "post_number": 2,
      "username": "jbirnick",
      "name": "Johann Birnick",
      "created_at": "2024-11-09T23:53:32.728Z",
      "updated_at": "2024-11-09T23:53:32.728Z",
      "cooked": "<p>Impossible at the moment. A package cannot call an external command.</p>\n<p>If you want to do that for your personal project, you have to make a custom build script that first runs lilypond, puts the output somewhere, and then renders the Typst document (which includes the lilypond output somewhere).</p>",
      "raw": "Impossible at the moment. A package cannot call an external command.\n\nIf you want to do that for your personal project, you have to make a custom build script that first runs lilypond, puts the output somewhere, and then renders the Typst document (which includes the lilypond output somewhere).",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 26,
      "score": 20.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 218
    },
    {
      "id": 5463,
      "post_number": 4,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-11-10T15:35:46.454Z",
      "updated_at": "2024-11-10T15:35:46.454Z",
      "cooked": "<p>This recent answer may interest you:</p>\n<aside class=\"quote quote-modified\" data-post=\"3\" data-topic=\"1607\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/p/F64C96/48.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/how-to-call-external-applications/1607/3\">How to call external applications?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    There has been extensive discussion about this in the past, but this functionality (often referred to as ‚Äúshell escape‚Äù in reference to LaTeX‚Äôs equivalent functionality) unfortunately isn‚Äôt really compatible with several of Typst‚Äôs aspects, including portability (being able to compile the same document in different environments), purity (function calls in Typst must always produce the same result to make memoization possible), security (compiling a Typst document must not produce unexpected side‚Ä¶\n  </blockquote>\n</aside>\n",
      "raw": "This recent answer may interest you:\n\nhttps://forum.typst.app/t/how-to-call-external-applications/1607/3?u=sillyfreak",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 9.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:55:16.801938"
}
{
  "topic_metadata": {
    "id": 1636,
    "title": "Include a whole directory",
    "slug": "include-a-whole-directory",
    "posts_count": 3,
    "created_at": "2024-11-09T15:40:30.734Z",
    "last_posted_at": "2024-11-09T21:30:01.034Z",
    "views": 487,
    "like_count": 2,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "flokl",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 146
  },
  "posts": [
    {
      "id": 5402,
      "post_number": 1,
      "username": "Nguyen_Truong_Son",
      "name": "Nguyen Truong Son",
      "created_at": "2024-11-09T15:40:30.868Z",
      "updated_at": "2024-11-09T15:41:48.032Z",
      "cooked": "<p>Currently I‚Äôm putting 1 chapter to 1 file, then include every file in <code>main.typ</code>. Is there anyway to just include a whole folder, so i just need to create new file without manually import? Tysm!</p>\n<p>This is my current setup (stripped):</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// Report cover\n#include \"Matter/00.FrontPage.typ\"\n\n#include \"Contents/01.Introduction.typ\"\n\n// Biblography\n#include \"Matter/01.Cite.typ\"\n</code></pre>",
      "raw": "Currently I'm putting 1 chapter to 1 file, then include every file in `main.typ`. Is there anyway to just include a whole folder, so i just need to create new file without manually import? Tysm!\n\nThis is my current setup (stripped):\n```typ\n// Report cover\n#include \"Matter/00.FrontPage.typ\"\n\n#include \"Contents/01.Introduction.typ\"\n\n// Biblography\n#include \"Matter/01.Cite.typ\"\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 45,
      "score": 2488.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 203
    },
    {
      "id": 5405,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2024-11-09T18:20:43.948Z",
      "updated_at": "2024-11-09T18:20:43.948Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/nguyen_truong_son\">@Nguyen_Truong_Son</a>,</p>\n<p>unfortunately, this option is not yet built into Typst, there is a ope issue about it <a href=\"https://github.com/typst/typst/issues/2123\" rel=\"noopener nofollow ugc\">here</a>.<br>\nThere is a not-so-nice workaround: if you use Typst locally with the CLI you can run an external script, which reads all the file names of the folder and pass them to Typst via the <a href=\"https://typst.app/docs/reference/foundations/sys\"><code>input</code></a> parameter.</p>",
      "raw": "Hello @Nguyen_Truong_Son,\n\nunfortunately, this option is not yet built into Typst, there is a ope issue about it [here](https://github.com/typst/typst/issues/2123). \nThere is a not-so-nice workaround: if you use Typst locally with the CLI you can run an external script, which reads all the file names of the folder and pass them to Typst via the [`input`](https://typst.app/docs/reference/foundations/sys) parameter.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 38,
      "score": 52.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 5413,
      "post_number": 3,
      "username": "Nguyen_Truong_Son",
      "name": "Nguyen Truong Son",
      "created_at": "2024-11-09T21:30:01.034Z",
      "updated_at": "2024-11-09T21:30:01.034Z",
      "cooked": "<p>Tysm, hope that we will have that feature in near future <img src=\"https://forum.typst.app/images/emoji/apple/smile.png?v=12\" title=\":smile:\" class=\"emoji\" alt=\":smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Tysm, hope that we will have that feature in near future :smile:",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 35,
      "score": 27.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 203
    }
  ],
  "scraped_at": "2025-06-10T09:55:16.072074"
}
{
  "topic_metadata": {
    "id": 1639,
    "title": "How to add a space after a footnote number?",
    "slug": "how-to-add-a-space-after-a-footnote-number",
    "posts_count": 4,
    "created_at": "2024-11-09T19:29:58.394Z",
    "last_posted_at": "2024-11-09T23:13:23.271Z",
    "views": 129,
    "like_count": 2,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "laurmaedje",
    "tags": [
      "layout",
      "footnotes"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 224
  },
  "posts": [
    {
      "id": 5406,
      "post_number": 1,
      "username": "jsx97",
      "name": "jsx97",
      "created_at": "2024-11-09T19:29:58.508Z",
      "updated_at": "2024-11-09T19:30:58.892Z",
      "cooked": "<p>How can I add a space after a footnote number, so that it will be not this:</p>\n<pre data-code-wrap=\"none\"><code class=\"lang-none\">--------\n¬πFootnote\n</code></pre>\n<p>but this?</p>\n<pre data-code-wrap=\"none\"><code class=\"lang-none\">--------\n¬π Footnote\n</code></pre>\n<p>I tried the following example from Typst docs and it works fine:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show footnote.entry: it =&gt; {\n  let loc = it.note.location()\n  numbering(\n    \"1. \",\n    ..counter(footnote).at(loc),\n  )\n  it.note.body\n}\n\nLorem ipsum#footnote[Dolor sit amet]\n\nLorem ipsum#footnote[Dolor sit amet]\n</code></pre>\n<p>But when I tried to replace <code>\"1. \"</code> with <code>\"#super[1 ]\"</code>, it treats <code>#super</code> literally.</p>",
      "raw": "How can I add a space after a footnote number, so that it will be not this:\n\n```none\n--------\n¬πFootnote\n```\n\nbut this?\n\n```none\n--------\n¬π Footnote\n```\n\nI tried the following example from Typst docs and it works fine:\n\n```typ\n#show footnote.entry: it => {\n  let loc = it.note.location()\n  numbering(\n    \"1. \",\n    ..counter(footnote).at(loc),\n  )\n  it.note.body\n}\n\nLorem ipsum#footnote[Dolor sit amet]\n\nLorem ipsum#footnote[Dolor sit amet]\n```\n\nBut when I tried to replace `\"1. \"` with `\"#super[1 ]\"`, it treats `#super` literally.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 370.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 477
    },
    {
      "id": 5407,
      "post_number": 2,
      "username": "a_w",
      "name": "Alex",
      "created_at": "2024-11-09T20:33:03.631Z",
      "updated_at": "2024-11-09T21:00:28.928Z",
      "cooked": "<p>A very simple one line fix is:</p>\n<pre><code class=\"lang-auto\">\" \" + it.note.body\n// Or as a unit\nh(0.2em) + it.note.body\n</code></pre>\n<p>For more on <span class=\"hashtag-raw\">#h</span>() <a href=\"https://typst.app/docs/reference/layout/h/\">see here</a>.</p>\n<p>But I‚Äôm quite certain there will be someone with a better solution right around the corner <img src=\"https://forum.typst.app/images/emoji/apple/blush.png?v=12\" title=\":blush:\" class=\"emoji\" alt=\":blush:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "A very simple one line fix is:\n\n```\n\" \" + it.note.body\n// Or as a unit\nh(0.2em) + it.note.body\n```\nFor more on #h() [see here](https://typst.app/docs/reference/layout/h/).\n\nBut I'm quite certain there will be someone with a better solution right around the corner üòä",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 35.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 566
    },
    {
      "id": 5414,
      "post_number": 3,
      "username": "jsx97",
      "name": "jsx97",
      "created_at": "2024-11-09T21:35:33.179Z",
      "updated_at": "2024-11-09T21:37:23.438Z",
      "cooked": "<p>This works, thank you. But how to keep footnote number superscript at the same time?</p>\n<p>I mean the problem with my original solution is not a lack of space. The problem is that it adds space, but then I cannot figure out how to make the footnote number superscript.</p>",
      "raw": "This works, thank you. But how to keep footnote number superscript at the same time?\n\nI mean the problem with my original solution is not a lack of space. The problem is that it adds space, but then I cannot figure out how to make the footnote number superscript.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 15.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 477
    },
    {
      "id": 5419,
      "post_number": 4,
      "username": "laurmaedje",
      "name": "Laurenz M√§dje",
      "created_at": "2024-11-09T23:13:23.271Z",
      "updated_at": "2024-11-09T23:13:23.271Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"jsx97\" data-post=\"1\" data-topic=\"1639\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/j/3DA8FF/48.png\" class=\"avatar\"> jsx97:</div>\n<blockquote>\n<p><span class=\"hashtag-raw\">#super</span>[1 ]</p>\n</blockquote>\n</aside>\n<p>Instead of putting the <code>super</code> into the <code>\"1.\"</code>, put it around the numbering. Like this:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">super(numbering(\n  \"1. \",\n  ..counter(footnote).at(loc),\n))\n</code></pre>\n<p>The string in the numbering is a numbering pattern rather than arbitrary content.</p>",
      "raw": "[quote=\"jsx97, post:1, topic:1639\"]\n#super[1 ]\n[/quote]\n\nInstead of putting the `super` into the `\"1.\"`, put it around the numbering. Like this:\n```typc\nsuper(numbering(\n  \"1. \",\n  ..counter(footnote).at(loc),\n))\n```\nThe string in the numbering is a numbering pattern rather than arbitrary content.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 24,
      "score": 29.8,
      "accepted_answer": true,
      "trust_level": 4,
      "user_id": 2
    }
  ],
  "scraped_at": "2025-06-10T09:55:15.343334"
}
{
  "topic_metadata": {
    "id": 164,
    "title": "Why is the value I receive from context always content?",
    "slug": "why-is-the-value-i-receive-from-context-always-content",
    "posts_count": 4,
    "created_at": "2024-09-15T10:09:32.125Z",
    "last_posted_at": "2025-02-07T13:55:54.926Z",
    "views": 1362,
    "like_count": 12,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "laurmaedje",
    "tags": [
      "scripting",
      "context"
    ],
    "category_id": 5,
    "participant_count": 1,
    "word_count": 879
  },
  "posts": [
    {
      "id": 660,
      "post_number": 1,
      "username": "laurmaedje",
      "name": "Laurenz M√§dje",
      "created_at": "2024-09-15T10:09:32.287Z",
      "updated_at": "2024-09-19T17:47:16.832Z",
      "cooked": "<p>I am trying to use a counter to switch between displaying something and not displaying it. To do that, I check whether the counter is even and then increase it by one.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let my-counter = counter(\"my-counter\")\n\n#let alternate(it) = {\n  let value = context my-counter.get().first()\n  if calc.even(value) {\n    it\n  }\n  my-counter.step()\n}\n\n#alternate[I'm visible]\n#alternate[I'm not]\n#alternate[I'm again visible]\n</code></pre>\n<p>However, when trying to use the value from the context, I get this error:</p>\n<pre><code class=\"lang-plaintext\">error: expected integer, found content\n</code></pre>\n<p>Why is this happening and how can I get the value from the context?</p>",
      "raw": "I am trying to use a counter to switch between displaying something and not displaying it. To do that, I check whether the counter is even and then increase it by one.\n\n```typ\n#let my-counter = counter(\"my-counter\")\n\n#let alternate(it) = {\n  let value = context my-counter.get().first()\n  if calc.even(value) {\n    it\n  }\n  my-counter.step()\n}\n\n#alternate[I'm visible]\n#alternate[I'm not]\n#alternate[I'm again visible]\n```\n\nHowever, when trying to use the value from the context, I get this error:\n```text\nerror: expected integer, found content\n```\nWhy is this happening and how can I get the value from the context?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 140,
      "score": 3913.0,
      "accepted_answer": false,
      "trust_level": 4,
      "user_id": 2
    },
    {
      "id": 661,
      "post_number": 2,
      "username": "laurmaedje",
      "name": "Laurenz M√§dje",
      "created_at": "2024-09-15T10:10:01.536Z",
      "updated_at": "2024-09-15T10:10:01.536Z",
      "cooked": "<p>When working with context, you need to put everything that depends on the contextual information into the context block/expression itself. The explicit <code>context</code> expression is a trade-off: You get to know <em>where in the document</em> you are (accessible via <a href=\"https://typst.app/docs/reference/introspection/here/\"><code>here()</code></a>) and <em>which set rules</em> are active there (accessible via things like <code>text.lang</code>). In return, the context value itself becomes opaque. You cannot peek into it, so everything that depends on the contextual information must happen within it.</p>\n<p>Let‚Äôs look at this example to understand why:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let val = context text.lang + \"!\"\n\n#set text(lang: \"de\")\n#val // \"de!\"\n\n#set text(lang: \"fr\")\n#val // \"fr!\"\n</code></pre>\n<p>We have a context expression that accesses the text language and adds an exclamation point to it. We store the resulting value in <code>val</code>. Then, we use it in multiple places of our document. As the comments indicate, it outputs different things: once ‚Äúde!‚Äù and once ‚Äúfr!‚Äù.</p>\n<p>Now, let‚Äôs try using that same <code>val</code> and performing a string operation on it:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let val = context text.lang + \"!\"\n\n// error: type content has no method `starts-with`\n#if val.starts-with(\"d\") {\n  ..\n}\n</code></pre>\n<p>Typst complains with <code>type content has no method `starts-with` </code>. But why is <code>val</code> of type content rather than string?</p>\n<p>Because <code>val</code> is <em>not well-defined</em> unless you put it into the document, as content. Depending on where in the document you put <code>val</code>, it can produce different things. <code>val</code> is not a string, it can <em>become</em> a string once it knows all the relevant contextual information. As long as <code>val</code> is just stored in a variable, the code within the context block never actually runs! And if you put it into the document twice, then it runs twice.</p>\n<p>Thus, to fix the error, we must move all logic that depends on the contextual information into the context itself. Since the <code>starts-with</code> logic depends on the text language, we must move it inside:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let val() = text.lang + \"!\"\n\n#context {\n  if val().starts-with(\"d\") {\n    ..\n  }\n}\n</code></pre>\n<p>To encapsulate the logic of adding the exlamation point, we have turned <code>val</code> into a function. Context will pass through from where it is made available to every called function.</p>\n<p>Note that since context wraps any expression and <code>if ..</code> happens to be one, we can actually also just write it like this, without extra braces:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#context if val().starts-with(\"d\") { .. }\n</code></pre>\n<p>Equipped with this knowledge, let‚Äôs take another look at the original problem. The goal was to display something if a counter is even and then step it. The conditional that checks <code>calc.even</code> definitely depends on the counter value and must thus move into the context expression:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let my-counter = counter(\"my-counter\")\n\n#let alternate(it) = context {\n  let value = my-counter.get().first()\n  if calc.even(value) {\n    it\n  }\n  my-counter.step()\n}\n\n#alternate[I'm visible]\n#alternate[I'm not]\n#alternate[I'm again visible]\n</code></pre>\n<h3><a name=\"p-661-where-to-put-the-context-block-1\" class=\"anchor\" href=\"#p-661-where-to-put-the-context-block-1\"></a>Where to put the context block?</h3>\n<p>You might have noticed that, technically, the <em>counter step</em> does not depend on the current counter value, so there‚Äôs no need to put it into the context. We could just as well write this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let alternate(it) = {\n  context {\n    let value = my-counter.get().first()\n    if calc.even(value) {\n      it\n    }\n  }\n  my-counter.step()\n}\n</code></pre>\n<p>In this case, there‚Äôs no harm in having the step within the context as well and it makes the code a little simpler, so I‚Äôve opted for that. However, you might ask yourself where best to put the context block in general. To answer that question, consider <strong>what information you want to acquire.</strong></p>\n<p>The information provided by a context block is uniform across the whole block. If you have additional set rules or counter updates <em>within</em> the block, you‚Äôll not see the effects of those.</p>\n<p>Thus, if you put your whole document into one big context block, you‚Äôll be able to get the default values of Typst‚Äôs standard properties, but not much more. Sometimes that‚Äôs enough and then there‚Äôs no harm in putting everything into a big context block. <sup class=\"footnote-ref\"><a href=\"#footnote-661-1\" id=\"footnote-ref-661-1\">[1]</a></sup></p>\n<p>On the other hand, sometimes you need to work with local information, like the current font size or counters that step often. Then, you probably want to keep your context closely scoped to your logic.</p>\n<hr class=\"footnotes-sep\">\n\n<ol class=\"footnotes-list\">\n<li id=\"footnote-661-1\" class=\"footnote-item\"><p>Well, at least once Typst 0.12 is released. As of Typst 0.11.1, there are still a few bugs with contexts that wrap around pagebreaks creating empty pages. <a href=\"#footnote-ref-661-1\" class=\"footnote-backref\">‚Ü©Ô∏é</a></p>\n</li>\n</ol>",
      "raw": "When working with context, you need to put everything that depends on the contextual information into the context block/expression itself. The explicit `context` expression is a trade-off: You get to know _where in the document_ you are (accessible via [`here()`](https://typst.app/docs/reference/introspection/here/)) and _which set rules_ are active there (accessible via things like `text.lang`). In return, the context value itself becomes opaque. You cannot peek into it, so everything that depends on the contextual information must happen within it.\n\nLet's look at this example to understand why:\n\n```typ\n#let val = context text.lang + \"!\"\n\n#set text(lang: \"de\")\n#val // \"de!\"\n\n#set text(lang: \"fr\")\n#val // \"fr!\"\n```\n\nWe have a context expression that accesses the text language and adds an exclamation point to it. We store the resulting value in `val`. Then, we use it in multiple places of our document. As the comments indicate, it outputs different things: once \"de!\" and once \"fr!\".\n\nNow, let's try using that same `val` and performing a string operation on it:\n\n```typ\n#let val = context text.lang + \"!\"\n\n// error: type content has no method `starts-with`\n#if val.starts-with(\"d\") {\n  ..\n}\n```\n\nTypst complains with ``type content has no method `starts-with` ``. But why is `val` of type content rather than string? \n\nBecause `val` is _not well-defined_ unless you put it into the document, as content. Depending on where in the document you put `val`, it can produce different things. `val` is not a string, it can _become_ a string once it knows all the relevant contextual information. As long as `val` is just stored in a variable, the code within the context block never actually runs! And if you put it into the document twice, then it runs twice.\n\nThus, to fix the error, we must move all logic that depends on the contextual information into the context itself. Since the `starts-with` logic depends on the text language, we must move it inside:\n\n```typ\n#let val() = text.lang + \"!\"\n\n#context {\n  if val().starts-with(\"d\") {\n    ..\n  }\n}\n```\n\nTo encapsulate the logic of adding the exlamation point, we have turned `val` into a function. Context will pass through from where it is made available to every called function. \n\nNote that since context wraps any expression and `if ..` happens to be one, we can actually also just write it like this, without extra braces:\n\n```typ\n#context if val().starts-with(\"d\") { .. }\n```\n\nEquipped with this knowledge, let's take another look at the original problem. The goal was to display something if a counter is even and then step it. The conditional that checks `calc.even` definitely depends on the counter value and must thus move into the context expression:\n\n```typ\n#let my-counter = counter(\"my-counter\")\n\n#let alternate(it) = context {\n  let value = my-counter.get().first()\n  if calc.even(value) {\n    it\n  }\n  my-counter.step()\n}\n\n#alternate[I'm visible]\n#alternate[I'm not]\n#alternate[I'm again visible]\n```\n\n### Where to put the context block?\nYou might have noticed that, technically, the _counter step_ does not depend on the current counter value, so there's no need to put it into the context. We could just as well write this:\n\n```typ\n#let alternate(it) = {\n  context {\n    let value = my-counter.get().first()\n    if calc.even(value) {\n      it\n    }\n  }\n  my-counter.step()\n}\n```\n\nIn this case, there's no harm in having the step within the context as well and it makes the code a little simpler, so I've opted for that. However, you might ask yourself where best to put the context block in general. To answer that question, consider **what information you want to acquire.**\n\nThe information provided by a context block is uniform across the whole block. If you have additional set rules or counter updates _within_ the block, you'll not see the effects of those.\n\nThus, if you put your whole document into one big context block, you'll be able to get the default values of Typst's standard properties, but not much more. Sometimes that's enough and then there's no harm in putting everything into a big context block. [^1]\n\nOn the other hand, sometimes you need to work with local information, like the current font size or counters that step often. Then, you probably want to keep your context closely scoped to your logic.\n\n[^1]: Well, at least once Typst 0.12 is released. As of Typst 0.11.1, there are still a few bugs with contexts that wrap around pagebreaks creating empty pages.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 9,
      "reads": 135,
      "score": 792.0,
      "accepted_answer": true,
      "trust_level": 4,
      "user_id": 2
    },
    {
      "id": 8332,
      "post_number": 3,
      "username": "laurmaedje",
      "name": "Laurenz M√§dje",
      "created_at": "2025-02-07T13:55:31.645Z",
      "updated_at": "2025-02-07T13:55:31.645Z",
      "cooked": "<p>A post was split to a new topic: <a href=\"/t/can-contextual-math-attachments-be-properly-aligned/2718\">Can contextual math attachments be properly aligned?</a></p>",
      "raw": "A post was split to a new topic: [Can contextual math attachments be properly aligned?](/t/can-contextual-math-attachments-be-properly-aligned/2718)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 57,
      "score": 31.4,
      "accepted_answer": false,
      "trust_level": 4,
      "user_id": 2
    },
    {
      "id": 8333,
      "post_number": 4,
      "username": "laurmaedje",
      "name": "Laurenz M√§dje",
      "created_at": "2025-02-07T13:55:54.926Z",
      "updated_at": "2025-02-07T13:55:54.926Z",
      "cooked": "",
      "raw": "",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 56,
      "score": 11.2,
      "accepted_answer": false,
      "trust_level": 4,
      "user_id": 2
    }
  ],
  "scraped_at": "2025-06-10T09:58:58.015737"
}
{
  "topic_metadata": {
    "id": 1643,
    "title": "What is the simplest way to define multiple similar functions?",
    "slug": "what-is-the-simplest-way-to-define-multiple-similar-functions",
    "posts_count": 3,
    "created_at": "2024-11-09T22:27:06.139Z",
    "last_posted_at": "2024-11-10T00:25:47.984Z",
    "views": 107,
    "like_count": 1,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Eric",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 342
  },
  "posts": [
    {
      "id": 5417,
      "post_number": 1,
      "username": "moe",
      "name": "",
      "created_at": "2024-11-09T22:27:06.342Z",
      "updated_at": "2024-11-10T15:17:30.494Z",
      "cooked": "<p>hey! i‚Äôm writing a small math library which includes this snippet:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let theorem_impl(type, caption, body) = {\n  align(\n    center,\n    figure(\n      caption: figure.caption(\n        position: top,\n        caption,\n      ),\n      kind: lower(type),\n      supplement: type,\n      box(\n        fill: rgb(\"#eee\"),\n        stroke: 1pt + rgb(\"000\"),\n        inset: 5pt,\n        body,\n      ),\n    ),\n  )\n}\n\n#let theorem(caption: [], body) = theorem_impl(\n  \"Theorem\",\n  caption,\n  body,\n)\n\n#let proposition(caption: [], body) = theorem_impl(\n  \"Proposition\",\n  caption,\n  body,\n)\n\n#let lemma(caption: [], body) = theorem_impl(\n  \"Lemma\",\n  caption,\n  body,\n)\n</code></pre>\n<p>i was curious if there‚Äôs a manner by which to label the three derivative functions dynamically via a loop, as opposed to manually defining each of them, as the naive solution:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#for theorem-type in ([Theorem], [Proposition], [Lemma]) {\n  let theorem-type(caption: [], body) = theorem_impl(\n    type,\n    caption,\n    body,\n  )\n}\n</code></pre>\n<p>did not seem to work. thanks!</p>",
      "raw": "hey! i'm writing a small math library which includes this snippet:\n\n```typ\n#let theorem_impl(type, caption, body) = {\n  align(\n    center,\n    figure(\n      caption: figure.caption(\n        position: top,\n        caption,\n      ),\n      kind: lower(type),\n      supplement: type,\n      box(\n        fill: rgb(\"#eee\"),\n        stroke: 1pt + rgb(\"000\"),\n        inset: 5pt,\n        body,\n      ),\n    ),\n  )\n}\n\n#let theorem(caption: [], body) = theorem_impl(\n  \"Theorem\",\n  caption,\n  body,\n)\n\n#let proposition(caption: [], body) = theorem_impl(\n  \"Proposition\",\n  caption,\n  body,\n)\n\n#let lemma(caption: [], body) = theorem_impl(\n  \"Lemma\",\n  caption,\n  body,\n)\n```\n\ni was curious if there's a manner by which to label the three derivative functions dynamically via a loop, as opposed to manually defining each of them, as the naive solution:\n```typ\n#for theorem-type in ([Theorem], [Proposition], [Lemma]) {\n  let theorem-type(caption: [], body) = theorem_impl(\n    type,\n    caption,\n    body,\n  )\n}\n```\n\ndid not seem to work. thanks!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 206.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 783
    },
    {
      "id": 5432,
      "post_number": 2,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2024-11-09T23:25:08.048Z",
      "updated_at": "2024-11-09T23:25:54.435Z",
      "cooked": "<p>Defining functions in a loop won‚Äôt work, as they would then only be accessible from inside the loop. However, you can simplify your code a bit by using the <a href=\"https://typst.app/docs/reference/foundations/function/#definitions-with\"><code>with</code></a> function to pre-apply some arguments:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let theorem_impl(type, caption: [], body) = {\n  ...\n}\n\n#let theorem = theorem_impl.with(\"Theorem\")\n#let proposition = theorem_impl.with(\"Proposition\")\n#let lemma = theorem_impl.with(\"Lemma\")\n</code></pre>\n<p>The <code>with</code> function here gives you a new function where the <code>type</code> parameter is already set to the passed value. Note that I added a default value for the <code>caption</code> parameter, as the new functions will share the same parameter structure as the original implementation.</p>\n<p>For completeness, I want to point out that there already exist some packages for theorems, such as <a href=\"https://typst.app/universe/package/ctheorems\"><code>ctheorems</code></a>, <a href=\"https://typst.app/universe/package/lemmify\"><code>lemmify</code></a>, and <a href=\"https://typst.app/universe/package/great-theorems\"><code>great-theorems</code></a>.</p>\n<hr>\n<p><em>On an unrelated note, please try to put any questions in the <a class=\"hashtag-cooked\" href=\"/c/questions/5\" data-type=\"category\" data-slug=\"questions\" data-id=\"5\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>Questions</span></a> category. If you can move this topic yourself, don‚Äôt hesitate to do so. If not, don‚Äôt worry, as a moderator will take care of it.</em></p>",
      "raw": "Defining functions in a loop won't work, as they would then only be accessible from inside the loop. However, you can simplify your code a bit by using the [`with`](https://typst.app/docs/reference/foundations/function/#definitions-with) function to pre-apply some arguments:\n\n```typ\n#let theorem_impl(type, caption: [], body) = {\n  ...\n}\n\n#let theorem = theorem_impl.with(\"Theorem\")\n#let proposition = theorem_impl.with(\"Proposition\")\n#let lemma = theorem_impl.with(\"Lemma\")\n```\nThe `with` function here gives you a new function where the `type` parameter is already set to the passed value. Note that I added a default value for the `caption` parameter, as the new functions will share the same parameter structure as the original implementation.\n\nFor completeness, I want to point out that there already exist some packages for theorems, such as [`ctheorems`](https://typst.app/universe/package/ctheorems), [`lemmify`](https://typst.app/universe/package/lemmify), and [`great-theorems`](https://typst.app/universe/package/great-theorems).\n\n---\n\n_On an unrelated note, please try to put any questions in the #questions category. If you can move this topic yourself, don't hesitate to do so. If not, don't worry, as a moderator will take care of it._",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 31,
      "score": 41.2,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 5440,
      "post_number": 3,
      "username": "moe",
      "name": "",
      "created_at": "2024-11-10T00:25:47.984Z",
      "updated_at": "2024-11-10T00:25:47.984Z",
      "cooked": "<p>thanks! ill take a look at the existing packages as well, they look great, and i appreciate the explanation. ive moved the post to questions, too.</p>",
      "raw": "thanks! ill take a look at the existing packages as well, they look great, and i appreciate the explanation. ive moved the post to questions, too.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 5.4,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 783
    }
  ],
  "scraped_at": "2025-06-10T09:55:14.633333"
}
{
  "topic_metadata": {
    "id": 1649,
    "title": "How to indent code blocks by default",
    "slug": "how-to-indent-code-blocks-by-default",
    "posts_count": 2,
    "created_at": "2024-11-10T09:19:43.676Z",
    "last_posted_at": "2024-11-10T09:49:32.394Z",
    "views": 127,
    "like_count": 0,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "flokl",
    "tags": [],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 97
  },
  "posts": [
    {
      "id": 5445,
      "post_number": 1,
      "username": "fxn",
      "name": "Xavier Noria",
      "created_at": "2024-11-10T09:19:43.808Z",
      "updated_at": "2024-11-10T09:19:43.808Z",
      "cooked": "<p>Absolute newbie here. Is there a way to configure a document so that all code blocks (triple backquotes) are indented by a certain amount? Like they do in O‚ÄôReilly books, for example.</p>",
      "raw": "Absolute newbie here. Is there a way to configure a document so that all code blocks (triple backquotes) are indented by a certain amount? Like they do in O'Reilly books, for example.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 486.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 784
    },
    {
      "id": 5446,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2024-11-10T09:49:32.394Z",
      "updated_at": "2024-11-10T09:49:32.394Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/fxn\">@fxn</a>,</p>\n<p>you can use a show rule to get all <code>raw</code> elements, and use <code>pad</code> to indent them. With the option <code>block: true</code> only the triple backquotes get affected.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#show raw.where(block: true): it =&gt; pad(left: 2em, it)\n\n#lorem(30)\n```\nif (right &lt; left) {\ntmp = right;\nright = left;\nleft = tmp;\n}\n```\nTest `test`. #lorem(30) \n</code></pre>\n<details>\n<summary>\nResult</summary>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/d/d7fed9bff8266f6000e6d1d0e894adbd652250ab.png\" alt=\"test\" data-base62-sha1=\"uOMFBlVybtR5wI5beelnsWDslar\" width=\"595\" height=\"296\"></p>\n</details>",
      "raw": "Hello @fxn,\n\nyou can use a show rule to get all `raw` elements, and use `pad` to indent them. With the option `block: true` only the triple backquotes get affected. \n````typst\n#show raw.where(block: true): it => pad(left: 2em, it)\n\n#lorem(30)\n```\nif (right < left) {\ntmp = right;\nright = left;\nleft = tmp;\n}\n```\nTest `test`. #lorem(30) \n````\n[details=\"Result\"]\n![test|595x296](upload://uOMFBlVybtR5wI5beelnsWDslar.png)\n[/details]",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 26.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    }
  ],
  "scraped_at": "2025-06-10T09:55:13.891703"
}
{
  "topic_metadata": {
    "id": 1650,
    "title": "Cetz plot - How can I hide the shared-zero in school-book axis style?",
    "slug": "cetz-plot-how-can-i-hide-the-shared-zero-in-school-book-axis-style",
    "posts_count": 3,
    "created_at": "2024-11-10T10:14:22.870Z",
    "last_posted_at": "2024-11-10T18:46:10.626Z",
    "views": 145,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Gaweringo",
    "tags": [
      "graphics",
      "cetz"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 121
  },
  "posts": [
    {
      "id": 5447,
      "post_number": 1,
      "username": "Flavio",
      "name": "Flavio",
      "created_at": "2024-11-10T10:14:22.955Z",
      "updated_at": "2024-11-10T15:13:47.480Z",
      "cooked": "<p>I‚Äôve seen in the source code this comment. But i don‚Äôt find a way to set this parameter to false and hide the ‚Äú0‚Äù in the axis.<br>\nThanks a lot!</p>\n<blockquote>\n<p>/// <span class=\"hashtag-raw\">#show-parameter-block</span>(‚Äúshared-zero‚Äù, (‚Äúbool‚Äù, ‚Äúcontent‚Äù), default: ‚Äú$0$‚Äù, [School-book style axes only: Content to display at the plots origin (0,0). If set to <code>false</code>, nothing is shown. Having this set, suppresses auto-generated ticks for $0$!])</p>\n</blockquote>",
      "raw": "I've seen in the source code this comment. But i don't find a way to set this parameter to false and hide the \"0\" in the axis.\nThanks a lot!\n\n> /// #show-parameter-block(\"shared-zero\", (\"bool\", \"content\"), default: \"$0$\", [School-book style axes only: Content to display at the plots origin (0,0). If set to `false`, nothing is shown. Having this set, suppresses auto-generated ticks for $0$!])",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 471.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 622
    },
    {
      "id": 5455,
      "post_number": 2,
      "username": "Gaweringo",
      "name": "Gaweringo",
      "created_at": "2024-11-10T14:26:08.420Z",
      "updated_at": "2024-11-10T14:26:08.420Z",
      "cooked": "<p>Seems like <code>set-style(axes: (shared-zero: false))</code> is how you set the <code>shared-zero</code> parameter.</p>\n<p>Found it here:</p><aside class=\"onebox githubblob\" data-onebox-src=\"https://github.com/mariunaise/HDA-Thesis/blob/80a1eca011db268ba52728eeb352c6d145fc177e/graphics/quantizers/two-bit-enroll.typ#L7\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/mariunaise/HDA-Thesis/blob/80a1eca011db268ba52728eeb352c6d145fc177e/graphics/quantizers/two-bit-enroll.typ#L7\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/mariunaise/HDA-Thesis/blob/80a1eca011db268ba52728eeb352c6d145fc177e/graphics/quantizers/two-bit-enroll.typ#L7\" target=\"_blank\" rel=\"noopener nofollow ugc\">mariunaise/HDA-Thesis/blob/80a1eca011db268ba52728eeb352c6d145fc177e/graphics/quantizers/two-bit-enroll.typ#L7</a></h4>\n\n\n\n    <pre class=\"onebox\"><code class=\"lang-typ\">\n      <ol class=\"start lines\" start=\"1\" style=\"counter-reset: li-counter 0 ;\">\n          <li>#import \"@preview/cetz:0.2.2\": canvas, plot, draw, palette</li>\n          <li></li>\n          <li>#let line_style = (stroke: (paint: black, thickness: 2pt))</li>\n          <li>#let dashed = (stroke: (dash: \"dashed\"))</li>\n          <li>#canvas({</li>\n          <li>  import draw: *</li>\n          <li class=\"selected\">  set-style(axes: (shared-zero: false))</li>\n          <li>  plot.plot(size: (8,6),</li>\n          <li>    x-tick-step: 0.25,</li>\n          <li>    y-label: $cal(Q)(2, 1, tilde(x))$,</li>\n          <li>    x-label: $tilde(x)$,</li>\n          <li>    y-tick-step: none,</li>\n          <li>    y-ticks: ((0.25, [00]), (0.5, [01]), (0.75, [10]), (1, [11])),</li>\n          <li>    axis-style: \"left\",</li>\n          <li>    //x-min: 0,</li>\n          <li>    x-max: 1,</li>\n          <li>    y-min: 0,</li>\n      </ol>\n    </code></pre>\n\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "Seems like `set-style(axes: (shared-zero: false))` is how you set the `shared-zero` parameter.\n\nFound it here:\nhttps://github.com/mariunaise/HDA-Thesis/blob/80a1eca011db268ba52728eeb352c6d145fc177e/graphics/quantizers/two-bit-enroll.typ#L7",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 32,
      "score": 86.4,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 770
    },
    {
      "id": 5468,
      "post_number": 3,
      "username": "Flavio",
      "name": "Flavio",
      "created_at": "2024-11-10T18:46:10.626Z",
      "updated_at": "2024-11-10T18:46:10.626Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Gaweringo\" data-post=\"2\" data-topic=\"1650\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/gaweringo/48/1181_2.png\" class=\"avatar\"> Gaweringo:</div>\n<blockquote>\n<p><code>canvas, plot, draw, palette</code></p>\n</blockquote>\n</aside>\n<p>Works perfectly, thanks a lot!!!</p>",
      "raw": "[quote=\"Gaweringo, post:2, topic:1650\"]\n`canvas, plot, draw, palette`\n[/quote]\n\nWorks perfectly, thanks a lot!!!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 29,
      "score": 5.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 622
    }
  ],
  "scraped_at": "2025-06-10T09:55:13.181733"
}
{
  "topic_metadata": {
    "id": 1652,
    "title": "Is there a way to make arguments of element function optional/dependent?",
    "slug": "is-there-a-way-to-make-arguments-of-element-function-optional-dependent",
    "posts_count": 7,
    "created_at": "2024-11-10T11:08:24.642Z",
    "last_posted_at": "2024-11-11T04:02:35.519Z",
    "views": 361,
    "like_count": 9,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "Eric",
    "tags": [
      "scripting",
      "layout"
    ],
    "category_id": 5,
    "participant_count": 5,
    "word_count": 429
  },
  "posts": [
    {
      "id": 5449,
      "post_number": 1,
      "username": "a_w",
      "name": "Alex",
      "created_at": "2024-11-10T11:08:24.779Z",
      "updated_at": "2024-11-10T11:09:23.565Z",
      "cooked": "<p>Say you have a longer element function where one or multiple parameters depend on something. Is there a way to make single (or multiple) parameters optional without repeating the whole element in an if-clause?</p>\n<p>Non-working example to showcase what I mean:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let warning = true\n#block(\n  stroke: 1pt + black,\n  (if warning { (fill: red) }), //something like that\n  inset: 10pt,\n  radius: 2pt,\n)[Test]\n</code></pre>\n<details>\n<summary>\nExample Result</summary>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/c/cd88184edef046d1c943f7bd6016732c32c5130b.png\" alt=\"test-showcase\" data-base62-sha1=\"tkdsJPoy49bmIJsnq4KHmr52ufh\" width=\"244\" height=\"188\"></p>\n</details>\n<p>PS: I know you could define a variable like <code>fill: some-fillcolor</code> and make that dependent on x. But I was wondering if it was possible, so it is not necessary to restore defaults or change multiple parameters combined at once etc.</p>",
      "raw": "Say you have a longer element function where one or multiple parameters depend on something. Is there a way to make single (or multiple) parameters optional without repeating the whole element in an if-clause?\n\nNon-working example to showcase what I mean:\n\n```typ\n#let warning = true\n#block(\n  stroke: 1pt + black,\n  (if warning { (fill: red) }), //something like that\n  inset: 10pt,\n  radius: 2pt,\n)[Test]\n```\n\n[details=\"Example Result\"]\n![test-showcase|244x188](upload://tkdsJPoy49bmIJsnq4KHmr52ufh.png)\n[/details]\n\nPS: I know you could define a variable like `fill: some-fillcolor` and make that dependent on x. But I was wondering if it was possible, so it is not necessary to restore defaults or change multiple parameters combined at once etc.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 43,
      "score": 1488.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 566
    },
    {
      "id": 5454,
      "post_number": 2,
      "username": "LordBaryhobal",
      "name": "Baryhobal",
      "created_at": "2024-11-10T13:47:47.315Z",
      "updated_at": "2024-11-10T13:47:47.315Z",
      "cooked": "<p>You have two options afaik</p>\n<ol>\n<li>If in the value:<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let warning = true\n#block(\n  fill: if warning {red} else {none}\n)[test]\n</code></pre>\n</li>\n<li>Args dictionary:<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let warning = true\n#let args = (:)\n#if warning {\n  args.insert(\"fill\", red)\n}\n#block(..args)[Test]\n</code></pre>\n</li>\n</ol>",
      "raw": "You have two options afaik\n1. If in the value:\n    ```typ\n    #let warning = true\n    #block(\n      fill: if warning {red} else {none}\n    )[test]\n    ```\n2. Args dictionary:\n    ```typ\n    #let warning = true\n    #let args = (:)\n    #if warning {\n      args.insert(\"fill\", red)\n    }\n    #block(..args)[Test]\n    ```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 41,
      "score": 43.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 585
    },
    {
      "id": 5467,
      "post_number": 3,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2024-11-10T16:25:33.473Z",
      "updated_at": "2024-11-10T16:25:33.473Z",
      "cooked": "<p>You were actually already very close to something that works. You just need spread the if statement with the dictionary with <code>..</code> instead of passing it as is:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let warning = true\n#block(\n  stroke: 1pt + black,\n  ..if warning { (fill: red) },\n  inset: 10pt,\n  radius: 2pt,\n)[Test]\n</code></pre>",
      "raw": "You were actually already very close to something that works. You just need spread the if statement with the dictionary with `..` instead of passing it as is:\n\n```typ\n#let warning = true\n#block(\n  stroke: 1pt + black,\n  ..if warning { (fill: red) },\n  inset: 10pt,\n  radius: 2pt,\n)[Test]\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 37,
      "score": 157.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 5469,
      "post_number": 4,
      "username": "a_w",
      "name": "Alex",
      "created_at": "2024-11-10T19:30:32.466Z",
      "updated_at": "2024-11-10T19:33:22.524Z",
      "cooked": "<p>Aahhh, perfect! Thank you both. I learned from all approaches! I would have marked both answers as solution, but since that is not possible the one <a class=\"mention\" href=\"/u/eric\">@Eric</a> gave is maybe even a little closer to what I want to achieve since it omits the parameter completely and is the very compact at the same time.</p>\n<p><img src=\"https://forum.typst.app/images/emoji/apple/pray.png?v=12\" title=\":pray:\" class=\"emoji only-emoji\" alt=\":pray:\" loading=\"lazy\" width=\"20\" height=\"20\"><img src=\"https://forum.typst.app/images/emoji/apple/pray.png?v=12\" title=\":pray:\" class=\"emoji only-emoji\" alt=\":pray:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Aahhh, perfect! Thank you both. I learned from all approaches! I would have marked both answers as solution, but since that is not possible the one @Eric gave is maybe even a little closer to what I want to achieve since it omits the parameter completely and is the very compact at the same time.\n\nüôèüôè",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 34,
      "score": 71.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 566
    },
    {
      "id": 5473,
      "post_number": 5,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2024-11-10T23:12:45.123Z",
      "updated_at": "2024-11-10T23:13:41.183Z",
      "cooked": "<p>I think your solution is very idiomatic. To make it even a little more compact, let me note:<br>\n<code>else {none}</code> can be omitted altogether since if-statements without an else statement will produce <code>none</code> in the negative branch.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#block(\n  fill: if warning {red}\n)\n</code></pre>\n<p>This should then be the shortest solution of all :)</p>",
      "raw": "I think your solution is very idiomatic. To make it even a little more compact, let me note:\n`else {none}` can be omitted altogether since if-statements without an else statement will produce `none` in the negative branch. \n```typ\n#block(\n  fill: if warning {red}\n)\n```\nThis should then be the shortest solution of all :)",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 31.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    },
    {
      "id": 5474,
      "post_number": 6,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2024-11-10T23:15:45.140Z",
      "updated_at": "2024-11-10T23:15:45.140Z",
      "cooked": "<p>Erics solution is of course great when you have more than one parameter depending on the warning (which could be a common case). Otherwise, <code>fill: if warning {red}</code> seems a tad more readable.</p>",
      "raw": "Erics solution is of course great when you have more than one parameter depending on the warning (which could be a common case). Otherwise, `fill: if warning {red}` seems a tad more readable.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 16.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    },
    {
      "id": 5479,
      "post_number": 7,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-11T04:02:35.519Z",
      "updated_at": "2024-11-11T04:02:35.519Z",
      "cooked": "<p>Eric‚Äôs solution is also necessary when the default value of the parameter isn‚Äôt <code>none</code>. For example, <code>stroke: if warning { red }</code> for a table would cause it to not have any stroke if <code>warning</code> is false, which might be fair (but might not be the desired behavior, depending on what one wishes to do). Personally, I usually use the <code>if warning { red }</code> solution because what I usually want is precisely to have it be <code>none</code> (i.e. remove stroke / fill / ‚Ä¶), but it all depends on your goal <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Eric's solution is also necessary when the default value of the parameter isn't `none`. For example, `stroke: if warning { red }` for a table would cause it to not have any stroke if `warning` is false, which might be fair (but might not be the desired behavior, depending on what one wishes to do). Personally, I usually use the `if warning { red }` solution because what I usually want is precisely to have it be `none` (i.e. remove stroke / fill / ...), but it all depends on your goal :slight_smile:",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 28,
      "score": 45.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:55:12.473814"
}
{
  "topic_metadata": {
    "id": 1657,
    "title": "How to apply set rules to custom functions?",
    "slug": "how-to-apply-set-rules-to-custom-functions",
    "posts_count": 2,
    "created_at": "2024-11-10T14:44:48.809Z",
    "last_posted_at": "2024-11-10T15:39:00.397Z",
    "views": 388,
    "like_count": 3,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "flokl",
    "tags": [
      "scripting",
      "packages"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 149
  },
  "posts": [
    {
      "id": 5458,
      "post_number": 1,
      "username": "MartyByrde",
      "name": "MartyByrde",
      "created_at": "2024-11-10T14:44:49.058Z",
      "updated_at": "2024-11-10T14:44:49.058Z",
      "cooked": "<p>Hey guys I am frequently using function in my documents. For example</p>\n<pre><code class=\"lang-auto\">#let formatXY(msg, color: blue) = {\ntext(msg, color)\n}\n</code></pre>\n<p>Now having declared a function we can simply use it and provide arguments to it. Like:</p>\n<pre><code class=\"lang-auto\">Some paragraph #formatXY(\"test\")\n</code></pre>\n<p>My question now is how to for instance set the color of all future formatXY calls to be red instead. When trying to use a set / show rule, I get the hint / error that: ‚Äúonly element functions can be used in set rules‚Äù.</p>\n<p>For example: <code>#set formatXY(color:red)</code></p>\n<p>Has anyone of you figured this one out or is it impossible to use show / set rules for custom functions?</p>",
      "raw": "Hey guys I am frequently using function in my documents. For example\n```\n#let formatXY(msg, color: blue) = {\ntext(msg, color)\n}\n```\nNow having declared a function we can simply use it and provide arguments to it. Like:\n\n```\nSome paragraph #formatXY(\"test\")\n```\n\nMy question now is how to for instance set the color of all future formatXY calls to be red instead. When trying to use a set / show rule, I get the hint / error that: \"only element functions can be used in set rules\".\n\nFor example: `#set formatXY(color:red)`\n\nHas anyone of you figured this one out or is it impossible to use show / set rules for custom functions?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 44,
      "score": 1768.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 689
    },
    {
      "id": 5466,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2024-11-10T15:39:00.397Z",
      "updated_at": "2024-11-10T15:41:37.416Z",
      "cooked": "<p>Hi,</p>\n<p>you can overwrite your function like this.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let formatXY = formatXY.with(color: red)\n</code></pre>\n<p>It will be possible to use show / set on custom functions in the future with custom elements, but for now you can use the above.</p>",
      "raw": "Hi,\n\nyou can overwrite your function like this.\n```typst\n#let formatXY = formatXY.with(color: red)\n```\nIt will be possible to use show / set on custom functions in the future with custom elements, but for now you can use the above.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 44,
      "score": 133.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    }
  ],
  "scraped_at": "2025-06-10T09:55:11.741112"
}
{
  "topic_metadata": {
    "id": 1660,
    "title": "How come this does not generate a grid as expected?",
    "slug": "how-come-this-does-not-generate-a-grid-as-expected",
    "posts_count": 3,
    "created_at": "2024-11-10T21:00:45.632Z",
    "last_posted_at": "2024-11-10T21:50:14.230Z",
    "views": 228,
    "like_count": 4,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Eric",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 487
  },
  "posts": [
    {
      "id": 5470,
      "post_number": 1,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2024-11-10T21:00:45.753Z",
      "updated_at": "2024-11-10T21:43:32.011Z",
      "cooked": "<p>Hello!</p>\n<p>I have the following code:</p>\n<pre><code class=\"lang-auto\">// Define the vimg function to create image rectangles with text\n#let vimg(body) = {\n  rect(width: 50mm, height: 30mm)[\n    #text(body)\n  ]\n}\n\n// Example logos array for testing\n#let Example_logos = (\"Example 1\", \"Example 2\", \"Example 3\", \"Example 4\")\n\n// Example 1: Manual Approach (Works as Expected)\n#figure(\n  grid(\n    columns: 2,       // Enforce a two-column layout\n    gutter: 20mm,     // Space between columns\n\n    // Manually adding each logo, assuming we have four logos for example\n    vimg(\"Example 1\"),\n    vimg(\"Example 2\"),\n    vimg(\"Example 3\"),\n    vimg(\"Example 4\")\n  )\n)\n\n// Example 2: For Loop Approach (Problem Case)\n#figure(\n  grid(\n    columns: 2,       // Enforce a two-column layout\n    gutter: 20mm,     // Space between columns\n\n    // Using a `for` loop to add each logo dynamically\n    if Example_logos != none {\n      for logo in Example_logos {\n        vimg(logo)\n      }\n    }\n  )\n)\n\n</code></pre>\n<p>It generates the following:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/4/40b8c48efde1b645bc4ac556b919774695aaad86.png\" data-download-href=\"https://forum.typst.app/uploads/default/40b8c48efde1b645bc4ac556b919774695aaad86\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/4/40b8c48efde1b645bc4ac556b919774695aaad86_2_382x500.png\" alt=\"image\" data-base62-sha1=\"9eyq7vNtoPaEbq1tV0ob7PoN2rs\" width=\"382\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/4/40b8c48efde1b645bc4ac556b919774695aaad86_2_382x500.png, https://forum.typst.app/uploads/default/optimized/2X/4/40b8c48efde1b645bc4ac556b919774695aaad86_2_573x750.png 1.5x, https://forum.typst.app/uploads/default/original/2X/4/40b8c48efde1b645bc4ac556b919774695aaad86.png 2x\" data-dominant-color=\"FCFCFC\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">644√ó841 26.1 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>What I want is the first, where I do it manually and the 4 inputs are lay out in a grid. When using the for loop it becomes just one vertical line?</p>\n<p>I want to use grid and get this to work with for loop. No packages.</p>\n<p>Kind regards</p>",
      "raw": "Hello!\n\nI have the following code:\n\n```\n// Define the vimg function to create image rectangles with text\n#let vimg(body) = {\n  rect(width: 50mm, height: 30mm)[\n    #text(body)\n  ]\n}\n\n// Example logos array for testing\n#let Example_logos = (\"Example 1\", \"Example 2\", \"Example 3\", \"Example 4\")\n\n// Example 1: Manual Approach (Works as Expected)\n#figure(\n  grid(\n    columns: 2,       // Enforce a two-column layout\n    gutter: 20mm,     // Space between columns\n\n    // Manually adding each logo, assuming we have four logos for example\n    vimg(\"Example 1\"),\n    vimg(\"Example 2\"),\n    vimg(\"Example 3\"),\n    vimg(\"Example 4\")\n  )\n)\n\n// Example 2: For Loop Approach (Problem Case)\n#figure(\n  grid(\n    columns: 2,       // Enforce a two-column layout\n    gutter: 20mm,     // Space between columns\n\n    // Using a `for` loop to add each logo dynamically\n    if Example_logos != none {\n      for logo in Example_logos {\n        vimg(logo)\n      }\n    }\n  )\n)\n\n```\n\nIt generates the following:\n\n![image|382x500](upload://9eyq7vNtoPaEbq1tV0ob7PoN2rs.png)\n\nWhat I want is the first, where I do it manually and the 4 inputs are lay out in a grid. When using the for loop it becomes just one vertical line?\n\nI want to use grid and get this to work with for loop. No packages.\n\nKind regards",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 966.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    },
    {
      "id": 5471,
      "post_number": 2,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2024-11-10T21:39:25.542Z",
      "updated_at": "2024-11-10T21:39:25.542Z",
      "cooked": "<p>By using a for loop for inserting the images, you end up creating just a single grid cell that contains a sequence of all images. What you need to use, is the <a href=\"https://typst.app/docs/reference/foundations/arguments/#spreading\">spreading</a> of arguments via the <code>..</code> operator, which is then easiest done not with a for loop, but by <a href=\"https://typst.app/docs/reference/foundations/array/#definitions-map\">mapping</a> the <code>Example_logos</code> array to an array of image elements. Assuming that <code>Example_logos</code> is not <code>none</code>, you can then write this as</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">grid(\n  columns: 2,\n  gutter: 20mm,\n  ..Example_logos.map(vimg)\n)\n</code></pre>\n<p>If you still prefer a for loop, you need to make sure that an array is built from it, and not a single piece of content containing all the images. As the results of each loop iteration are in the end joined together, you need to make sure that each iteration yields an array with the image as its single entry:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">grid(\n  columns: 2,\n  gutter: 20mm,\n  ..for logo in Example_logos {\n    (vimg(logo),)\n  }\n)\n</code></pre>\n<p>If you cannot always assume that <code>Example_logos</code> isn‚Äôt <code>none</code>, you can put the <code>if</code> statement <em>after</em> the <code>..</code>, so that whatever is inside that statement is spread into the arguments of the grid:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">grid(\n  columns: 2,\n  gutter: 20mm,\n  ..if Example_logos != none {\n    Example_logos.map(vimg)\n  }\n)\n</code></pre>\n<hr>\n<p><em>On an unrelated note, please try to put questions in the <a class=\"hashtag-cooked\" href=\"/c/questions/5\" data-type=\"category\" data-slug=\"questions\" data-id=\"5\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>Questions</span></a> category, so that it‚Äôs easier to find for other people. This will also allow you to later mark a solution. Also, you can get proper Typst syntax highlighting by creating your code blocks with a language identifier as in</em></p>\n<pre><code class=\"lang-auto\">```typ\n#let vimg(body) = { ... }\n```\n</code></pre>",
      "raw": "By using a for loop for inserting the images, you end up creating just a single grid cell that contains a sequence of all images. What you need to use, is the [spreading](https://typst.app/docs/reference/foundations/arguments/#spreading) of arguments via the `..` operator, which is then easiest done not with a for loop, but by [mapping](https://typst.app/docs/reference/foundations/array/#definitions-map) the `Example_logos` array to an array of image elements. Assuming that `Example_logos` is not `none`, you can then write this as\n\n```typc\ngrid(\n  columns: 2,\n  gutter: 20mm,\n  ..Example_logos.map(vimg)\n)\n```\n\nIf you still prefer a for loop, you need to make sure that an array is built from it, and not a single piece of content containing all the images. As the results of each loop iteration are in the end joined together, you need to make sure that each iteration yields an array with the image as its single entry:\n```typc\ngrid(\n  columns: 2,\n  gutter: 20mm,\n  ..for logo in Example_logos {\n    (vimg(logo),)\n  }\n)\n```\nIf you cannot always assume that `Example_logos` isn't `none`, you can put the `if` statement _after_ the `..`, so that whatever is inside that statement is spread into the arguments of the grid:\n```typc\ngrid(\n  columns: 2,\n  gutter: 20mm,\n  ..if Example_logos != none {\n    Example_logos.map(vimg)\n  }\n)\n```\n---\n_On an unrelated note, please try to put questions in the #questions category, so that it's easier to find for other people. This will also allow you to later mark a solution. Also, you can get proper Typst syntax highlighting by creating your code blocks with a language identifier as in_\n````\n```typ\n#let vimg(body) = { ... }\n```\n````",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 27,
      "score": 105.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 5472,
      "post_number": 3,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2024-11-10T21:50:14.230Z",
      "updated_at": "2024-11-10T21:50:14.230Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Eric\" data-post=\"2\" data-topic=\"1660\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/eric/48/87_2.png\" class=\"avatar\"> Eric:</div>\n<blockquote>\n<pre><code class=\"lang-auto\">grid(\n  columns: 2,\n  gutter: 20mm,\n  ..Example_logos.map(vimg)\n)\n</code></pre>\n</blockquote>\n</aside>\n<p>Thank you Eric, a very simple question I had but a great explanation I could follow.</p>\n<p>Kind regards</p>",
      "raw": "[quote=\"Eric, post:2, topic:1660\"]\n```\ngrid(\n  columns: 2,\n  gutter: 20mm,\n  ..Example_logos.map(vimg)\n)\n```\n[/quote]\n\nThank you Eric, a very simple question I had but a great explanation I could follow.\n\nKind regards",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 2,
      "reads": 23,
      "score": 94.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    }
  ],
  "scraped_at": "2025-06-10T09:55:10.833082"
}
{
  "topic_metadata": {
    "id": 1664,
    "title": "How to use bibliography with subfiles",
    "slug": "how-to-use-bibliography-with-subfiles",
    "posts_count": 4,
    "created_at": "2024-11-11T06:09:47.342Z",
    "last_posted_at": "2024-11-14T19:35:23.144Z",
    "views": 185,
    "like_count": 2,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "PgBiel",
    "tags": [
      "literature",
      "bibtex"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 237
  },
  "posts": [
    {
      "id": 5482,
      "post_number": 1,
      "username": "Mr_study",
      "name": "Mr study",
      "created_at": "2024-11-11T06:09:47.518Z",
      "updated_at": "2025-02-05T15:05:02.667Z",
      "cooked": "<p>I have a question about using bibliographies in subfiles in the latest version 0.12.0.</p>\n<p>The lastest update broke my code with the changes to <a class=\"hashtag-cooked\" href=\"/tag/locate\" data-type=\"tag\" data-slug=\"locate\" data-id=\"64\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>locate</span></a>. How can I cite my bibtex file from the subfile without making producing the references at the end of the subfile?</p>\n<p>Before the latest update I had a main file for my thesis and included a chapter with <code>#include \"chapt_validation.typ\"</code>. Inside chapt_validation.typ I reference papers from my bibtex file with <code>#cite(&lt;paper_name&gt;, form:\"author\")</code> and <code>#locate(loc =&gt; bib_state.at(query(&lt;here_is_valid_chapt&gt;, loc).first().location()))</code> at the end of the subfile, which only produced a reference section in the main file.</p>\n<p>How can I convert this typst code to the new version?</p>",
      "raw": "I have a question about using bibliographies in subfiles in the latest version 0.12.0.\n\nThe lastest update broke my code with the changes to #locate. How can I cite my bibtex file from the subfile without making producing the references at the end of the subfile?\n\nBefore the latest update I had a main file for my thesis and included a chapter with ```#include \"chapt_validation.typ\"```. Inside chapt_validation.typ I reference papers from my bibtex file with ```#cite(<paper_name>, form:\"author\")``` and ```#locate(loc => bib_state.at(query(<here_is_valid_chapt>, loc).first().location()))``` at the end of the subfile, which only produced a reference section in the main file. \n\nHow can I convert this typst code to the new version?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 43,
      "score": 578.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 789
    },
    {
      "id": 5484,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-11T09:22:02.784Z",
      "updated_at": "2024-11-11T09:22:02.784Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/mr_study\">@Mr_study</a> and welcome!<br>\nDon‚Äôt hesitate to read about how to convert locate to context expressions at <a href=\"https://forum.typst.app/t/how-to-use-context-instead-of-a-callback-function-in-locate-function-calls/965\" class=\"inline-onebox\">How to use context instead of a callback function in locate function calls?</a></p>",
      "raw": "Hello @Mr_study and welcome!\nDon't hesitate to read about how to convert locate to context expressions at https://forum.typst.app/t/how-to-use-context-instead-of-a-callback-function-in-locate-function-calls/965",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 41,
      "score": 28.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 5619,
      "post_number": 3,
      "username": "Mr_study",
      "name": "Mr study",
      "created_at": "2024-11-14T05:05:09.087Z",
      "updated_at": "2024-11-14T05:05:09.087Z",
      "cooked": "<p>Thanks for the help.<br>\nWith your direction I managed to fix the issue by replacing:<br>\n<code>#locate(loc =&gt; bib_state.at(query(&lt;here_is_intro_chapt&gt;, loc).first().location()))</code><br>\nwith<br>\n<code>#context {bib_state.at(query(&lt;here_is_intro_chapt&gt;).first().location()) }</code></p>",
      "raw": "Thanks for the help.\nWith your direction I managed to fix the issue by replacing:\n```#locate(loc => bib_state.at(query(<here_is_intro_chapt>, loc).first().location()))```\nwith\n```#context {bib_state.at(query(<here_is_intro_chapt>).first().location()) }```",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 33,
      "score": 26.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 789
    },
    {
      "id": 5639,
      "post_number": 4,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-14T19:35:23.144Z",
      "updated_at": "2024-11-14T19:35:50.961Z",
      "cooked": "<p>Even better, you can replace the query with <code>locate()</code> (it has a new purpose now: find the location of something):</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#context bib_state.at(locate(&lt;here_is_intro_chapt&gt;))\n</code></pre>\n<p>(Also, please don‚Äôt forget to mark an answer as a solution if you managed to solve your problem, thank you <img src=\"https://forum.typst.app/images/emoji/apple/smiley.png?v=12\" title=\":smiley:\" class=\"emoji\" alt=\":smiley:\" loading=\"lazy\" width=\"20\" height=\"20\">)</p>",
      "raw": "Even better, you can replace the query with `locate()` (it has a new purpose now: find the location of something):\n\n```typ\n#context bib_state.at(locate(<here_is_intro_chapt>))\n```\n\n(Also, please don't forget to mark an answer as a solution if you managed to solve your problem, thank you :smiley:)",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 60.6,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:55:10.132551"
}
{
  "topic_metadata": {
    "id": 1668,
    "title": "How do I left-align list items in a centered list?",
    "slug": "how-do-i-left-align-list-items-in-a-centered-list",
    "posts_count": 4,
    "created_at": "2024-11-11T13:52:09.332Z",
    "last_posted_at": "2024-11-13T20:20:27.264Z",
    "views": 136,
    "like_count": 4,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "ParaN3xus",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 187
  },
  "posts": [
    {
      "id": 5487,
      "post_number": 1,
      "username": "Kevin",
      "name": "Kevin",
      "created_at": "2024-11-11T13:52:09.440Z",
      "updated_at": "2024-11-11T13:52:09.440Z",
      "cooked": "<p>See below code:</p>\n<pre><code class=\"lang-auto\">= Unwanted aligned:\n#align(center, [\n  + This is a long list entry. Every item is centered!\n  + Small entry\n  + Booze\n])\n\n= Wanted aligned:\n#align(center, [\n  + #align(left, [This is a long list entry, but how I want it!])\n  + #align(left, [Small entry])\n  + #align(left, [Booze])\n])\n</code></pre>\n<p>My question is: I would like the output under the ‚ÄúWanted aligned‚Äù. Right now I can solve this by specifying the alignment for each list item, but this is a bit tedious.</p>\n<p>Is there a better way to achieve this?</p>",
      "raw": "See below code:\n\n```\n= Unwanted aligned:\n#align(center, [\n  + This is a long list entry. Every item is centered!\n  + Small entry\n  + Booze\n])\n\n= Wanted aligned:\n#align(center, [\n  + #align(left, [This is a long list entry, but how I want it!])\n  + #align(left, [Small entry])\n  + #align(left, [Booze])\n])\n```\n\nMy question is: I would like the output under the \"Wanted aligned\". Right now I can solve this by specifying the alignment for each list item, but this is a bit tedious. \n\nIs there a better way to achieve this?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 415.4,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 791
    },
    {
      "id": 5491,
      "post_number": 2,
      "username": "ParaN3xus",
      "name": "ParaN3xus",
      "created_at": "2024-11-11T14:43:49.154Z",
      "updated_at": "2024-11-11T14:43:49.154Z",
      "cooked": "<p>Use <code>show</code> statement:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#align(\n  center,\n  [\n    #show enum.item: align.with(left)\n    + This is a long list entry. Every item is centered!\n    + Small entry\n    + Booze\n  ],\n)\n</code></pre>",
      "raw": "Use `show` statement:\n```typ\n#align(\n  center,\n  [\n    #show enum.item: align.with(left)\n    + This is a long list entry. Every item is centered!\n    + Small entry\n    + Booze\n  ],\n)\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 26,
      "score": 60.0,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 14
    },
    {
      "id": 5523,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-11-11T21:27:08.653Z",
      "updated_at": "2024-11-11T21:27:08.653Z",
      "cooked": "<p>Alternatively, make a centered block (that is by default only the width required by the list) within which everything is left-aligned. This also works if there is more content than just the list:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#align(center, block[\n  #set align(left)\n  + This is a long list entry, but how I want it!\n  + Small entry\n  + Booze\n  voil√†\n])\n</code></pre>",
      "raw": "Alternatively, make a centered block (that is by default only the width required by the list) within which everything is left-aligned. This also works if there is more content than just the list:\n```typ\n#align(center, block[\n  #set align(left)\n  + This is a long list entry, but how I want it!\n  + Small entry\n  + Booze\n  voil√†\n])\n```",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 20,
      "score": 18.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 5603,
      "post_number": 4,
      "username": "Kevin",
      "name": "Kevin",
      "created_at": "2024-11-13T20:20:27.264Z",
      "updated_at": "2024-11-13T20:20:27.264Z",
      "cooked": "<p>Thanks both of you! It‚Äôs a shame that I can only mark one as a solution, but it worked perfectly <img src=\"https://forum.typst.app/images/emoji/apple/smiley.png?v=12\" title=\":smiley:\" class=\"emoji\" alt=\":smiley:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Thanks both of you! It's a shame that I can only mark one as a solution, but it worked perfectly :smiley:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 13,
      "score": 2.4,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 791
    }
  ],
  "scraped_at": "2025-06-10T09:55:09.421933"
}
{
  "topic_metadata": {
    "id": 1670,
    "title": "How to make different custom references for images and tables that are placed in figures?",
    "slug": "how-to-make-different-custom-references-for-images-and-tables-that-are-placed-in-figures",
    "posts_count": 3,
    "created_at": "2024-11-11T14:22:55.741Z",
    "last_posted_at": "2024-11-12T19:57:10.434Z",
    "views": 176,
    "like_count": 2,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "flokl",
    "tags": [
      "scripting",
      "layout",
      "tables",
      "figures",
      "images"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 191
  },
  "posts": [
    {
      "id": 5490,
      "post_number": 1,
      "username": "Dice",
      "name": "",
      "created_at": "2024-11-11T14:22:55.910Z",
      "updated_at": "2024-11-11T14:22:55.910Z",
      "cooked": "<p>Hello! At the moment, I am in the process of writing a typst template that will meet the standards for the design of a thesis document for my university.</p>\n<p>According to the university standard, references to tables and figures in the text have different signatures. Considering the documentation by ref I use this code:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set ref(supplement: it =&gt; {\n  if it.func() == heading {\n    \"chap.\"\n  } else if it.func() == figure {\n    \"fig.\"\n  } else {\n    \"smth.\"    \n  }\n})\n</code></pre>\n<p>This code currently works only for figures, because images and tables placed in the figures for making corresponding captions for them. What should I do to make different refs for images and tables that are placed in figures?</p>",
      "raw": "Hello! At the moment, I am in the process of writing a typst template that will meet the standards for the design of a thesis document for my university. \n\nAccording to the university standard, references to tables and figures in the text have different signatures. Considering the documentation by ref I use this code:\n\n```typst\n#set ref(supplement: it => {\n  if it.func() == heading {\n    \"chap.\"\n  } else if it.func() == figure {\n    \"fig.\"\n  } else {\n    \"smth.\"    \n  }\n})\n```\nThis code currently works only for figures, because images and tables placed in the figures for making corresponding captions for them. What should I do to make different refs for images and tables that are placed in figures?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 694.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 790
    },
    {
      "id": 5501,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2024-11-11T18:52:08.634Z",
      "updated_at": "2024-11-11T18:52:08.634Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/dice\">@Dice</a>,</p>\n<p>figures have the key <code>kind</code> to differentiate them by type. The default values are <code>image</code>, <code>table</code>, and <code>raw</code>, but custom <code>kind</code> types can also be used.<br>\nIn your case, this would work:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set ref(supplement: it =&gt; {\n  if it.func() == heading {\n    \"chap.\"\n  } else if it.func() == figure {\n    if it.kind == table {\n      \"tbl.\"\n    } else if it.kind == image {\n      \"img.\"\n    }  else if it.kind == raw {\n      \"lst.\"\n    } else {\n      // none default figure kinds\n      it.supplement\n    }\n  } else {\n    \"smth.\"    \n  }\n})\n</code></pre>",
      "raw": "Hi @Dice,\n\nfigures have the key `kind` to differentiate them by type. The default values are `image`, `table`, and `raw`, but custom `kind` types can also be used.\nIn your case, this would work:\n```typst\n#set ref(supplement: it => {\n  if it.func() == heading {\n    \"chap.\"\n  } else if it.func() == figure {\n    if it.kind == table {\n      \"tbl.\"\n    } else if it.kind == image {\n      \"img.\"\n    }  else if it.kind == raw {\n      \"lst.\"\n    } else {\n      // none default figure kinds\n      it.supplement\n    }\n  } else {\n    \"smth.\"    \n  }\n})\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 19,
      "score": 38.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 5553,
      "post_number": 3,
      "username": "Dice",
      "name": "",
      "created_at": "2024-11-12T19:57:10.434Z",
      "updated_at": "2024-11-12T19:57:10.434Z",
      "cooked": "<p>Your solution solved my problem, thanks!</p>",
      "raw": "Your solution solved my problem, thanks!",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 14,
      "score": 17.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 790
    }
  ],
  "scraped_at": "2025-06-10T09:55:08.701551"
}
{
  "topic_metadata": {
    "id": 1675,
    "title": "How can I draw strictly diagonally dominant matrices with ellipses?",
    "slug": "how-can-i-draw-strictly-diagonally-dominant-matrices-with-ellipses",
    "posts_count": 7,
    "created_at": "2024-11-11T17:08:57.699Z",
    "last_posted_at": "2024-11-14T04:01:51.523Z",
    "views": 261,
    "like_count": 0,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 6,
    "accepted_answer_username": "ian",
    "tags": [
      "math"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 1436
  },
  "posts": [
    {
      "id": 5497,
      "post_number": 1,
      "username": "infinitymdm",
      "name": "Marcus Mellor",
      "created_at": "2024-11-11T17:08:57.876Z",
      "updated_at": "2024-11-11T17:08:57.876Z",
      "cooked": "<p>Hi folks! I‚Äôm trying to more or less replicate this matrix from a textbook (with slightly different expressions):<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/3/3356066ff9735d0520e75f7984b3c57ddc59853f.png\" data-download-href=\"https://forum.typst.app/uploads/default/3356066ff9735d0520e75f7984b3c57ddc59853f\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/3/3356066ff9735d0520e75f7984b3c57ddc59853f_2_690x259.png\" alt=\"image\" data-base62-sha1=\"7k8ERgx8GXus2an0KbWANvQ7FtJ\" width=\"690\" height=\"259\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/3/3356066ff9735d0520e75f7984b3c57ddc59853f_2_690x259.png, https://forum.typst.app/uploads/default/original/2X/3/3356066ff9735d0520e75f7984b3c57ddc59853f.png 1.5x, https://forum.typst.app/uploads/default/original/2X/3/3356066ff9735d0520e75f7984b3c57ddc59853f.png 2x\" data-dominant-color=\"F9F9F9\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">940√ó354 37.1 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>The expressions are easy, but I‚Äôm having some difficulty with the upper and lower triangular regions. I‚Äôd like to find a way to replicate the way this text shows it, with ellipses indicating where the zeros are, but I‚Äôm not (yet) experienced enough with typst to figure it out.</p>\n<p>Here‚Äôs the source I‚Äôm using for my not-yet-complete poor man‚Äôs version of this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$\n  bold(A) = mat(delim: #(\"[\", \"]\"),\n    1/(3 h_0), 1/3 (1/h_1 - 1/h_0), 1/(3 h_1),    0,   dots.h,    dots.h,   dots.h, dots.h, 0     ;\n    h_0,       2 (h_1 - h_0),       h_1,          0,   dots.down, ,         ,       ,       dots.v;\n    0,         h_1,                 2(h_2 - h_1), h_2, 0,         dots.down,,       ,       dots.v;\n  )                                                                                                                                                                            $ \n</code></pre>\n<p>And here‚Äôs how that looks (again, don‚Äôt worry about the expressions, just the triangular portion with the zeros):<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/1/133dd1a7f4a717c64b50b85c69dcbe9ddca5a4da.png\" data-download-href=\"https://forum.typst.app/uploads/default/133dd1a7f4a717c64b50b85c69dcbe9ddca5a4da\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/1/133dd1a7f4a717c64b50b85c69dcbe9ddca5a4da_2_517x108.png\" alt=\"image\" data-base62-sha1=\"2Kdw8ZEs8y3rM3VZGYhM27xHJIC\" width=\"517\" height=\"108\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/1/133dd1a7f4a717c64b50b85c69dcbe9ddca5a4da_2_517x108.png, https://forum.typst.app/uploads/default/optimized/2X/1/133dd1a7f4a717c64b50b85c69dcbe9ddca5a4da_2_775x162.png 1.5x, https://forum.typst.app/uploads/default/original/2X/1/133dd1a7f4a717c64b50b85c69dcbe9ddca5a4da.png 2x\" data-dominant-color=\"F7F7F7\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1018√ó214 26.1 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>The separated groups of dots are obviously not ideal. I can‚Äôt help but feel there‚Äôs a better way to do this. Any advice for me?</p>",
      "raw": "Hi folks! I'm trying to more or less replicate this matrix from a textbook (with slightly different expressions): \n![image|690x259](upload://7k8ERgx8GXus2an0KbWANvQ7FtJ.png)\n\nThe expressions are easy, but I'm having some difficulty with the upper and lower triangular regions. I'd like to find a way to replicate the way this text shows it, with ellipses indicating where the zeros are, but I'm not (yet) experienced enough with typst to figure it out.\n\nHere's the source I'm using for my not-yet-complete poor man's version of this: \n```typ\n$\n  bold(A) = mat(delim: #(\"[\", \"]\"),\n    1/(3 h_0), 1/3 (1/h_1 - 1/h_0), 1/(3 h_1),    0,   dots.h,    dots.h,   dots.h, dots.h, 0     ;\n    h_0,       2 (h_1 - h_0),       h_1,          0,   dots.down, ,         ,       ,       dots.v;\n    0,         h_1,                 2(h_2 - h_1), h_2, 0,         dots.down,,       ,       dots.v;\n  )                                                                                                                                                                            $ \n```\n\nAnd here's how that looks (again, don't worry about the expressions, just the triangular portion with the zeros):\n![image|690x145, 75%](upload://2Kdw8ZEs8y3rM3VZGYhM27xHJIC.png)\n\nThe separated groups of dots are obviously not ideal. I can't help but feel there's a better way to do this. Any advice for me?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 39,
      "score": 1052.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 408
    },
    {
      "id": 5502,
      "post_number": 2,
      "username": "Sinthoras",
      "name": "",
      "created_at": "2024-11-11T19:01:58.502Z",
      "updated_at": "2024-11-11T19:01:58.502Z",
      "cooked": "<p>A bad solution which abuses the line and space commands is</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#[\n#set line(stroke: (dash: \"dotted\"))\n#let horizontal = { \n  line(start: (-0.25em, 0.3em), end: (1.0em, 0.3em)) \n  h(-0.17em)\n}\n$\n  bold(A) = mat(delim: #(\"[\", \"]\"),\n    1/(3 h_0), 1/3 (1/h_1 - 1/h_0), 1/(3 h_1),    0,   #horizontal,    #horizontal,   #horizontal, #horizontal, 0     ;\n    h_0,       2 (h_1 - h_0),       h_1,          0,   #line(start: (-0.4em, -0.9em), end: (0.7em, 0.2em)), ,         ,       ,       dots.v;\n    0,         h_1,                 2(h_2 - h_1), h_2, 0,         #line(start: (-0.5em, -0.5em), end: (1em, 1em)),,       ,       dots.v;\n  )                                                                                                          $\n]\n</code></pre>\n<p>which results in<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/9/977e692ff8fadc22436b12bbe55cdae077d8b6f3.png\" alt=\"image\" data-base62-sha1=\"lCaVN3xgXV3BsKnMEOU3rOqXAYj\" width=\"687\" height=\"169\"></p>",
      "raw": "A bad solution which abuses the line and space commands is \n\n```typst\n#[\n#set line(stroke: (dash: \"dotted\"))\n#let horizontal = { \n  line(start: (-0.25em, 0.3em), end: (1.0em, 0.3em)) \n  h(-0.17em)\n}\n$\n  bold(A) = mat(delim: #(\"[\", \"]\"),\n    1/(3 h_0), 1/3 (1/h_1 - 1/h_0), 1/(3 h_1),    0,   #horizontal,    #horizontal,   #horizontal, #horizontal, 0     ;\n    h_0,       2 (h_1 - h_0),       h_1,          0,   #line(start: (-0.4em, -0.9em), end: (0.7em, 0.2em)), ,         ,       ,       dots.v;\n    0,         h_1,                 2(h_2 - h_1), h_2, 0,         #line(start: (-0.5em, -0.5em), end: (1em, 1em)),,       ,       dots.v;\n  )                                                                                                          $\n]\n```\nwhich results in \n![image|687x169](upload://lCaVN3xgXV3BsKnMEOU3rOqXAYj.png)",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 16.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 511
    },
    {
      "id": 5504,
      "post_number": 3,
      "username": "infinitymdm",
      "name": "Marcus Mellor",
      "created_at": "2024-11-11T19:11:10.451Z",
      "updated_at": "2024-11-11T19:11:10.451Z",
      "cooked": "<p>Unfortunately, I don‚Äôt think that will work well for the completed matrix. I have several columns that are a tad wider than the rest along the diagonal. Here‚Äôs the complete matrix:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$                                                                                                                                                                                                                                            \n    bold(A) = mat(delim: #(\"[\", \"]\"),                                                                                                                                                                                                        \n        1/(3 h_0), 1/3 (1/h_1 - 1/h_0), 1/(3 h_1),    0,         dots.h,               dots.h,                      0            ;                                                                                                           \n        h_0,       2 (h_1 + h_0),       h_1,          0,         dots.h,               dots.h,                      0            ;                                                                                                           \n        0,         h_1,                 2(h_2 + h_1), h_2,       dots.down,            ,                            dots.v       ;                                                                                                           \n        dots.v,    dots.down,           dots.down,    dots.down, dots.down,            dots.down,                   dots.v       ;                                                                                                           \n        dots.v,    ,                    dots.down,    h_(n-3),   2(h_(n-3) + h_(n-2)), h_(n-2),                     0            ;                                                                                                           \n        0,         dots.h,              dots.h,       0,         h_(n-2),              2(h_(n-2) + h_(n-1)),        h_(n-1)      ;                                                                                                           \n        0,         dots.h,              dots.h,       0,         1/(3 h_(n-2)),        1/3 (1/h_(n-1) - 1/h_(n-2)), 1/(3 h_(n-1));                                                                                                           \n                                                                                                                                                                                                                                             \n    )                                                                                                                                                                                                                                        \n$ \n</code></pre>\n<p>That ^ looks like this:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/968d76953ac84230530556bde290d25fa9ad2308.png\" data-download-href=\"https://forum.typst.app/uploads/default/968d76953ac84230530556bde290d25fa9ad2308\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/968d76953ac84230530556bde290d25fa9ad2308_2_690x204.png\" alt=\"image\" data-base62-sha1=\"ltQHEAlY3TbpLaYHTERDMT2Gh1m\" width=\"690\" height=\"204\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/968d76953ac84230530556bde290d25fa9ad2308_2_690x204.png, https://forum.typst.app/uploads/default/original/2X/9/968d76953ac84230530556bde290d25fa9ad2308.png 1.5x, https://forum.typst.app/uploads/default/original/2X/9/968d76953ac84230530556bde290d25fa9ad2308.png 2x\" data-dominant-color=\"FAFAFA\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">761√ó225 22.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>I‚Äôll give your solution a go as a quick fix. I may be able to fiddle with it until it looks ok this time, but ideally there‚Äôs a more flexible solution.</p>",
      "raw": "Unfortunately, I don't think that will work well for the completed matrix. I have several columns that are a tad wider than the rest along the diagonal. Here's the complete matrix:\n\n```typ\n$                                                                                                                                                                                                                                            \n    bold(A) = mat(delim: #(\"[\", \"]\"),                                                                                                                                                                                                        \n        1/(3 h_0), 1/3 (1/h_1 - 1/h_0), 1/(3 h_1),    0,         dots.h,               dots.h,                      0            ;                                                                                                           \n        h_0,       2 (h_1 + h_0),       h_1,          0,         dots.h,               dots.h,                      0            ;                                                                                                           \n        0,         h_1,                 2(h_2 + h_1), h_2,       dots.down,            ,                            dots.v       ;                                                                                                           \n        dots.v,    dots.down,           dots.down,    dots.down, dots.down,            dots.down,                   dots.v       ;                                                                                                           \n        dots.v,    ,                    dots.down,    h_(n-3),   2(h_(n-3) + h_(n-2)), h_(n-2),                     0            ;                                                                                                           \n        0,         dots.h,              dots.h,       0,         h_(n-2),              2(h_(n-2) + h_(n-1)),        h_(n-1)      ;                                                                                                           \n        0,         dots.h,              dots.h,       0,         1/(3 h_(n-2)),        1/3 (1/h_(n-1) - 1/h_(n-2)), 1/(3 h_(n-1));                                                                                                           \n                                                                                                                                                                                                                                             \n    )                                                                                                                                                                                                                                        \n$ \n```\n\nThat ^ looks like this:\n![image|690x204](upload://ltQHEAlY3TbpLaYHTERDMT2Gh1m.png)\n\nI'll give your solution a go as a quick fix. I may be able to fiddle with it until it looks ok this time, but ideally there's a more flexible solution.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 11.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 408
    },
    {
      "id": 5508,
      "post_number": 4,
      "username": "infinitymdm",
      "name": "Marcus Mellor",
      "created_at": "2024-11-11T20:13:04.455Z",
      "updated_at": "2024-11-11T20:13:04.455Z",
      "cooked": "<p>Using your solution I was able to get a semi-acceptable result, but it‚Äôs pretty ugly:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/9e48ca35179ae13a600e3e2e160db598c956e21b.png\" data-download-href=\"https://forum.typst.app/uploads/default/9e48ca35179ae13a600e3e2e160db598c956e21b\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/9e48ca35179ae13a600e3e2e160db598c956e21b_2_690x177.png\" alt=\"image\" data-base62-sha1=\"mAfoiw22SpSMRtv9XTfwl2f4Hnd\" width=\"690\" height=\"177\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/9e48ca35179ae13a600e3e2e160db598c956e21b_2_690x177.png, https://forum.typst.app/uploads/default/original/2X/9/9e48ca35179ae13a600e3e2e160db598c956e21b.png 1.5x, https://forum.typst.app/uploads/default/original/2X/9/9e48ca35179ae13a600e3e2e160db598c956e21b.png 2x\" data-dominant-color=\"F9F9F9\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">902√ó232 31.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Here‚Äôs the code:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let (x0, x1, y0, y1) = (-0.5em, 6.6em, -0.2em, 1em)\n#let v_line = line(stroke: (dash: \"dotted\"), start: (0em, y0), end: (0em, y1))\n#let h_line = line(stroke: (dash: \"dotted\"), start: (x0, 0.5em), end: (x1, 0.5em))\n#let d_line = line(stroke: (dash: \"dotted\"), start: (x0, y0), end: (x1, 1em))\n$\n    bold(A) = mat(delim: #(\"[\", \"]\"),\n        1/(3 h_0), 1/3 (1/h_1 - 1/h_0), 1/(3 h_1),    0,         #h_line,              #h_line,                     0            ;\n        h_0,       2 (h_1 + h_0),       h_1,          0,         #h_line,              #h_line,                     0            ;\n        0,         h_1,                 2(h_2 + h_1), h_2,       #d_line,              ,                            #v_line      ;\n        #v_line,   #d_line,             #d_line,      #d_line,   #d_line,              #d_line,                     #v_line      ;\n        #v_line,   ,                    #d_line,      h_(n-3),   2(h_(n-3) + h_(n-2)), h_(n-2),                     0            ;\n        0,         #h_line,             #h_line,      0,         h_(n-2),              2(h_(n-2) + h_(n-1)),        h_(n-1)      ;\n        0,         #h_line,             #h_line,      0,         1/(3 h_(n-2)),        1/3 (1/h_(n-1) - 1/h_(n-2)), 1/(3 h_(n-1));\n    )\n$ \n</code></pre>\n<p>This also has the undesirable side effect of making the matrix very wide, since the lines are now the widest elements in most columns. I understand that some additional width is inevitable in order to make sure all the diagonal lines end up parallel, but the way things are spaced here makes the matrix hard to visually parse. I‚Äôm not sure how to solve this.</p>",
      "raw": "Using your solution I was able to get a semi-acceptable result, but it's pretty ugly:\n\n![image|690x177](upload://mAfoiw22SpSMRtv9XTfwl2f4Hnd.png)\n\nHere's the code:\n```typ\n#let (x0, x1, y0, y1) = (-0.5em, 6.6em, -0.2em, 1em)\n#let v_line = line(stroke: (dash: \"dotted\"), start: (0em, y0), end: (0em, y1))\n#let h_line = line(stroke: (dash: \"dotted\"), start: (x0, 0.5em), end: (x1, 0.5em))\n#let d_line = line(stroke: (dash: \"dotted\"), start: (x0, y0), end: (x1, 1em))\n$\n    bold(A) = mat(delim: #(\"[\", \"]\"),\n        1/(3 h_0), 1/3 (1/h_1 - 1/h_0), 1/(3 h_1),    0,         #h_line,              #h_line,                     0            ;\n        h_0,       2 (h_1 + h_0),       h_1,          0,         #h_line,              #h_line,                     0            ;\n        0,         h_1,                 2(h_2 + h_1), h_2,       #d_line,              ,                            #v_line      ;\n        #v_line,   #d_line,             #d_line,      #d_line,   #d_line,              #d_line,                     #v_line      ;\n        #v_line,   ,                    #d_line,      h_(n-3),   2(h_(n-3) + h_(n-2)), h_(n-2),                     0            ;\n        0,         #h_line,             #h_line,      0,         h_(n-2),              2(h_(n-2) + h_(n-1)),        h_(n-1)      ;\n        0,         #h_line,             #h_line,      0,         1/(3 h_(n-2)),        1/3 (1/h_(n-1) - 1/h_(n-2)), 1/(3 h_(n-1));\n    )\n$ \n```\n\nThis also has the undesirable side effect of making the matrix very wide, since the lines are now the widest elements in most columns. I understand that some additional width is inevitable in order to make sure all the diagonal lines end up parallel, but the way things are spaced here makes the matrix hard to visually parse. I'm not sure how to solve this.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 11.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 408
    },
    {
      "id": 5524,
      "post_number": 5,
      "username": "infinitymdm",
      "name": "Marcus Mellor",
      "created_at": "2024-11-11T21:27:23.510Z",
      "updated_at": "2024-11-11T21:27:23.510Z",
      "cooked": "<p>Well, I solved some problems (and created several new ones) using a really nasty hack: I‚Äôm using almost entirely negative starting positions for each line, as that doesn‚Äôt seem to affect the column width. Look if you dare.</p>\n<details>\n<summary>\nawful hacky code</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// This is perhpas the most horrific typst code I've written                                                                               \n#let v_line_1 = line(stroke: (dash: \"dotted\"), start: (0.3em, -2.6em), end: (0.3em, 1em))                                                  \n#let v_line_2 = line(stroke: (dash: \"dotted\"), start: (0.5em, -2.6em), end: (0.5em, 1em))                                                  \n#let h_line_1 = line(stroke: (dash: \"dotted\"), start: (-12em, 0em), end: (0em, 0em))                                                       \n#let d_line_1 = line(stroke: (dash: \"dotted\"), start: (-11.6em, -4.6em), end: (0.2em, -0.3em))                                             \n#let h_line_2 = line(stroke: (dash: \"dotted\"), start: (-16em, 0em), end: (0em, 0em))                                                       \n#let d_line_2 = line(stroke: (dash: \"dotted\"), start: (-16em, -4.6em), end: (0em, 0em))                                                    \n#let d_line_3 = line(stroke: (dash: \"dotted\"), start: (-8em, -1.2em), end: (-0.7em, 1.2em))                                                \n#let d_line_4 = line(stroke: (dash: \"dotted\"), start: (-9em, -1.2em), end: (-1em, 1.2em))                                                  \n#let d_line_5 = line(stroke: (dash: \"dotted\"), start: (-11em, -1.2em), end: (-2.5em, 1.2em))                                               \n$                                                                                                                                          \n    A = mat(delim: #(\"[\", \"]\"),                                                                                                            \n        1/(3 h_0), 1/3 (1/h_1 - 1/h_0), 1/(3 h_1),            &amp;0,         ,                     ,                  #h_line_2 0            ;\n        h_0,       2 (h_1 + h_0),       h_1,                  &amp;0,         ,                     ,                  #h_line_2 0            ;\n        0,         h_1,                 2(h_2 + h_1),         &amp;h_2,       ,                     ,                                         ;\n        ,          ,                    ,                     &amp;,          ,                     ,                                         ;\n        ,          ,                    ,           #d_line_3 &amp;,#d_line_4 ,           #d_line_5 ,                            #v_line_2    ;\n        #v_line_1, ,                    ,                     &amp;h_(n-3),   2(h_(n-3) + h_(n-2)), h_(n-2),           #d_line_2 0            ;\n        0,         ,                    , #d_line_1 #h_line_1 &amp;0,         h_(n-2),              2(h_(n-2) + h_(n-1)),        h_(n-1)      ;\n        0,         ,                    ,           #h_line_1 &amp;0,         1/(3 h_(n-2)),        1/3 (1/h_(n-1) - 1/h_(n-2)), 1/(3 h_(n-1));\n                                                                                                                                           \n    )                                                                                                                                      \n$ \n</code></pre>\n</details>\n<p>That renders like this:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/f/f1bfd80f4a975eab9e86312e952472e9219719e1.png\" data-download-href=\"https://forum.typst.app/uploads/default/f1bfd80f4a975eab9e86312e952472e9219719e1\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/f/f1bfd80f4a975eab9e86312e952472e9219719e1_2_690x211.png\" alt=\"image\" data-base62-sha1=\"yuC5Qawh5Z6SdTYozQNx76VyXoB\" width=\"690\" height=\"211\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/f/f1bfd80f4a975eab9e86312e952472e9219719e1_2_690x211.png, https://forum.typst.app/uploads/default/original/2X/f/f1bfd80f4a975eab9e86312e952472e9219719e1.png 1.5x, https://forum.typst.app/uploads/default/original/2X/f/f1bfd80f4a975eab9e86312e952472e9219719e1.png 2x\" data-dominant-color=\"F9F9F9\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">805√ó247 31.8 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Of course, now I have the following new problems:</p>\n<ul>\n<li>columns with lines in front of them get extra spacing for some reason (thus the alignment in col 4)</li>\n<li>the diagonal lines aren‚Äôt parallel at all</li>\n</ul>\n<p>I really hope there‚Äôs a better way to do this.</p>",
      "raw": "Well, I solved some problems (and created several new ones) using a really nasty hack: I'm using almost entirely negative starting positions for each line, as that doesn't seem to affect the column width. Look if you dare.\n\n[details=\"awful hacky code\"]\n```typ\n// This is perhpas the most horrific typst code I've written                                                                               \n#let v_line_1 = line(stroke: (dash: \"dotted\"), start: (0.3em, -2.6em), end: (0.3em, 1em))                                                  \n#let v_line_2 = line(stroke: (dash: \"dotted\"), start: (0.5em, -2.6em), end: (0.5em, 1em))                                                  \n#let h_line_1 = line(stroke: (dash: \"dotted\"), start: (-12em, 0em), end: (0em, 0em))                                                       \n#let d_line_1 = line(stroke: (dash: \"dotted\"), start: (-11.6em, -4.6em), end: (0.2em, -0.3em))                                             \n#let h_line_2 = line(stroke: (dash: \"dotted\"), start: (-16em, 0em), end: (0em, 0em))                                                       \n#let d_line_2 = line(stroke: (dash: \"dotted\"), start: (-16em, -4.6em), end: (0em, 0em))                                                    \n#let d_line_3 = line(stroke: (dash: \"dotted\"), start: (-8em, -1.2em), end: (-0.7em, 1.2em))                                                \n#let d_line_4 = line(stroke: (dash: \"dotted\"), start: (-9em, -1.2em), end: (-1em, 1.2em))                                                  \n#let d_line_5 = line(stroke: (dash: \"dotted\"), start: (-11em, -1.2em), end: (-2.5em, 1.2em))                                               \n$                                                                                                                                          \n    A = mat(delim: #(\"[\", \"]\"),                                                                                                            \n        1/(3 h_0), 1/3 (1/h_1 - 1/h_0), 1/(3 h_1),            &0,         ,                     ,                  #h_line_2 0            ;\n        h_0,       2 (h_1 + h_0),       h_1,                  &0,         ,                     ,                  #h_line_2 0            ;\n        0,         h_1,                 2(h_2 + h_1),         &h_2,       ,                     ,                                         ;\n        ,          ,                    ,                     &,          ,                     ,                                         ;\n        ,          ,                    ,           #d_line_3 &,#d_line_4 ,           #d_line_5 ,                            #v_line_2    ;\n        #v_line_1, ,                    ,                     &h_(n-3),   2(h_(n-3) + h_(n-2)), h_(n-2),           #d_line_2 0            ;\n        0,         ,                    , #d_line_1 #h_line_1 &0,         h_(n-2),              2(h_(n-2) + h_(n-1)),        h_(n-1)      ;\n        0,         ,                    ,           #h_line_1 &0,         1/(3 h_(n-2)),        1/3 (1/h_(n-1) - 1/h_(n-2)), 1/(3 h_(n-1));\n                                                                                                                                           \n    )                                                                                                                                      \n$ \n```\n[/details]\n\nThat renders like this: \n![image|690x211](upload://yuC5Qawh5Z6SdTYozQNx76VyXoB.png)\n\nOf course, now I have the following new problems:\n- columns with lines in front of them get extra spacing for some reason (thus the alignment in col 4)\n- the diagonal lines aren't parallel at all\n\nI really hope there's a better way to do this.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 56.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 408
    },
    {
      "id": 5594,
      "post_number": 6,
      "username": "ian",
      "name": "Ian",
      "created_at": "2024-11-13T17:29:38.207Z",
      "updated_at": "2024-11-13T17:29:38.207Z",
      "cooked": "<p>This looks like a perfect job for fletcher: <a href=\"https://typst.app/universe/package/fletcher/\" class=\"inline-onebox\">fletcher ‚Äì Typst Universe</a></p>\n<p>I‚Äôm not fully sure how you would use it to integrate with the matrix itself. You may need to redefine the mat command, or potentially include the matrix <em>inside</em> the diagram. But if you want fancy lines connecting things, fletcher is the place to start.</p>",
      "raw": "This looks like a perfect job for fletcher: https://typst.app/universe/package/fletcher/\n\nI'm not fully sure how you would use it to integrate with the matrix itself. You may need to redefine the mat command, or potentially include the matrix *inside* the diagram. But if you want fancy lines connecting things, fletcher is the place to start.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 24.0,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 25
    },
    {
      "id": 5618,
      "post_number": 7,
      "username": "infinitymdm",
      "name": "Marcus Mellor",
      "created_at": "2024-11-14T04:01:51.523Z",
      "updated_at": "2024-11-14T04:01:51.523Z",
      "cooked": "<p>I gave fletcher a try. It definitely produces a much better result, but still not quite perfect. Here‚Äôs what I ended up with:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$\n    A = mat(delim: #(\"[\",\"]\"),\n        #diagram(\n            spacing: 0pt,\n            node((0,0), $1/(3 h_0)$),     node((1,0), $-1/3 (1/h_1 + 1/h_0)$), node((2,0), $1/(3 h_1)$),                 node((3,0), $0$),             edge((3,0), (6,0), \"dotted\"),                                                     node((6,0), $0$),\n            node((0,1), $h_0$),           node((1,1), $2 (h_1 + h_0)$),        node((2,1), $h_1$),                       node((3,1), $0$),             edge((3,1), (6,1), \"dotted\"),                                                     node((6,1), $0$),\n            node((0,2), $0$),             node((1,2), $h_1$),                  node((2,2), $2(h_2 + h_1)$, defocus: -1), node((3,2), $h_2$),           edge((3,1), (6,4), \"dotted\"),                                                     edge((6,1), (6,4), \"dotted\"),\n            edge((0,2), (0,5), \"dotted\"), edge((0,2), (3,5), \"dotted\"),        edge((1,2), (3,4), \"dotted\"),             edge((2,2), (4,4), \"dotted\"), edge((3,2), (5,4), \"dotted\"),                     node((5,3), height: 2em),\n                                                                                                                         node((3,4), $h_(n-3)$),       node((4,4), $2(h_(n-3) + h_(n-2))$, defocus: -1), node((5,4), $h_(n-2)$),                      node((6,4), $0$),\n            node((0,5), $0$),             edge((0,5), (3,5), \"dotted\"),                                                  node((3,5), $0$),             node((4,5), $h_(n-2)$),                           node((5,5), $2(h_(n-2) + h_(n-1))$),         node((6,5), $h_(n-1)$),\n            node((0,6), $0$),             edge((0,6), (3,6), \"dotted\"),                                                  node((3,6), $0$),             node((4,6), $1/(3 h_(n-2))$),                     node((5,6), $-1/3 (1/h_(n-1) + 1/h_(n-2))$), node((6,6), $1/(3 h_(n-1))$)\n        )\n    )\n$\n</code></pre>\n<p>which looks like this:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/2/2a804ecc66741fbd38de72011942a7539b66b9c7.png\" data-download-href=\"https://forum.typst.app/uploads/default/2a804ecc66741fbd38de72011942a7539b66b9c7\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/2/2a804ecc66741fbd38de72011942a7539b66b9c7_2_690x239.png\" alt=\"image\" data-base62-sha1=\"63YX1mdeNIutrUFn1QRRVjLMD1t\" width=\"690\" height=\"239\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/2/2a804ecc66741fbd38de72011942a7539b66b9c7_2_690x239.png, https://forum.typst.app/uploads/default/original/2X/2/2a804ecc66741fbd38de72011942a7539b66b9c7.png 1.5x, https://forum.typst.app/uploads/default/original/2X/2/2a804ecc66741fbd38de72011942a7539b66b9c7.png 2x\" data-dominant-color=\"FAFAFA\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">756√ó262 31.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>I still feel that there ought to be a better way to do this sort of thing, but this is admittedly a pretty niche use case. For now this is good enough.</p>",
      "raw": "I gave fletcher a try. It definitely produces a much better result, but still not quite perfect. Here's what I ended up with:\n\n```typ\n$\n    A = mat(delim: #(\"[\",\"]\"),\n        #diagram(\n            spacing: 0pt,\n            node((0,0), $1/(3 h_0)$),     node((1,0), $-1/3 (1/h_1 + 1/h_0)$), node((2,0), $1/(3 h_1)$),                 node((3,0), $0$),             edge((3,0), (6,0), \"dotted\"),                                                     node((6,0), $0$),\n            node((0,1), $h_0$),           node((1,1), $2 (h_1 + h_0)$),        node((2,1), $h_1$),                       node((3,1), $0$),             edge((3,1), (6,1), \"dotted\"),                                                     node((6,1), $0$),\n            node((0,2), $0$),             node((1,2), $h_1$),                  node((2,2), $2(h_2 + h_1)$, defocus: -1), node((3,2), $h_2$),           edge((3,1), (6,4), \"dotted\"),                                                     edge((6,1), (6,4), \"dotted\"),\n            edge((0,2), (0,5), \"dotted\"), edge((0,2), (3,5), \"dotted\"),        edge((1,2), (3,4), \"dotted\"),             edge((2,2), (4,4), \"dotted\"), edge((3,2), (5,4), \"dotted\"),                     node((5,3), height: 2em),\n                                                                                                                         node((3,4), $h_(n-3)$),       node((4,4), $2(h_(n-3) + h_(n-2))$, defocus: -1), node((5,4), $h_(n-2)$),                      node((6,4), $0$),\n            node((0,5), $0$),             edge((0,5), (3,5), \"dotted\"),                                                  node((3,5), $0$),             node((4,5), $h_(n-2)$),                           node((5,5), $2(h_(n-2) + h_(n-1))$),         node((6,5), $h_(n-1)$),\n            node((0,6), $0$),             edge((0,6), (3,6), \"dotted\"),                                                  node((3,6), $0$),             node((4,6), $1/(3 h_(n-2))$),                     node((5,6), $-1/3 (1/h_(n-1) + 1/h_(n-2))$), node((6,6), $1/(3 h_(n-1))$)\n        )\n    )\n$\n```\nwhich looks like this: \n![image|690x239](upload://63YX1mdeNIutrUFn1QRRVjLMD1t.png)\n\nI still feel that there ought to be a better way to do this sort of thing, but this is admittedly a pretty niche use case. For now this is good enough.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 8.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 408
    }
  ],
  "scraped_at": "2025-06-10T09:55:07.991856"
}
{
  "topic_metadata": {
    "id": 1677,
    "title": "How to blend a color with an image and make the image transparent?",
    "slug": "how-to-blend-a-color-with-an-image-and-make-the-image-transparent",
    "posts_count": 7,
    "created_at": "2024-11-11T19:06:47.408Z",
    "last_posted_at": "2024-11-12T11:24:07.416Z",
    "views": 569,
    "like_count": 1,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "Eric",
    "tags": [],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 512
  },
  "posts": [
    {
      "id": 5503,
      "post_number": 1,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2024-11-11T19:06:47.498Z",
      "updated_at": "2024-11-11T19:06:47.498Z",
      "cooked": "<p>Hello!</p>\n<p>I am unsure where to start with a MWE, but suppose I want to take an image and do the following operations:</p>\n<ol>\n<li>‚ÄòMultiply‚Äô it with a color (let‚Äôs say blue) so that a picture of a sunset gets a bluish tint</li>\n<li>Make the image transparent, how do I control the opacity of the <code>image</code> function?</li>\n</ol>\n<p>Kind regards</p>",
      "raw": "Hello!\n\nI am unsure where to start with a MWE, but suppose I want to take an image and do the following operations:\n\n1. 'Multiply' it with a color (let's say blue) so that a picture of a sunset gets a bluish tint\n2. Make the image transparent, how do I control the opacity of the `image` function?\n\nKind regards",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 47,
      "score": 2899.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    },
    {
      "id": 5506,
      "post_number": 2,
      "username": "LordBaryhobal",
      "name": "Baryhobal",
      "created_at": "2024-11-11T20:05:14.209Z",
      "updated_at": "2024-11-11T20:05:14.209Z",
      "cooked": "<p>I don‚Äôt think you can currently modify the opacity of an image<br>\nA workaround I have used though is overlaying it with a filled box (this works both for ‚Äúdecreasing the opacity‚Äù - i.e. overlaying a semi-transparent white box - and for ‚Äúmixing a color‚Äù - i.e. a semi-transparent box fill with another color)</p>",
      "raw": "I don't think you can currently modify the opacity of an image\nA workaround I have used though is overlaying it with a filled box (this works both for \"decreasing the opacity\" - i.e. overlaying a semi-transparent white box - and for \"mixing a color\" - i.e. a semi-transparent box fill with another color)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 46,
      "score": 24.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 585
    },
    {
      "id": 5507,
      "post_number": 3,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2024-11-11T20:07:29.753Z",
      "updated_at": "2024-11-11T20:07:29.753Z",
      "cooked": "<p>Do you happen to have a simple example of that you can share? :)</p>",
      "raw": "Do you happen to have a simple example of that you can share? :)",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 43,
      "score": 13.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    },
    {
      "id": 5510,
      "post_number": 4,
      "username": "LordBaryhobal",
      "name": "Baryhobal",
      "created_at": "2024-11-11T20:24:26.936Z",
      "updated_at": "2024-11-11T20:24:26.936Z",
      "cooked": "<p>A very hacky way of doing it:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let overlay(img, color) = context {\n  let m = measure(img)\n  stack(\n    img,\n    move(\n      dy: -m.height,\n      box(width: m.width, height: m.height, fill: color)\n    )\n  )\n}\n#overlay(my-image, red.transparentize(50%))\n</code></pre>\n<p>I‚Äôd be very interested to see if someone else can come up with a better solution</p>",
      "raw": "A very hacky way of doing it:\n```typ\n#let overlay(img, color) = context {\n  let m = measure(img)\n  stack(\n    img,\n    move(\n      dy: -m.height,\n      box(width: m.width, height: m.height, fill: color)\n    )\n  )\n}\n#overlay(my-image, red.transparentize(50%))\n```\nI'd be very interested to see if someone else can come up with a better solution",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 42,
      "score": 28.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 585
    },
    {
      "id": 5515,
      "post_number": 5,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2024-11-11T20:44:12.857Z",
      "updated_at": "2024-11-11T20:44:12.857Z",
      "cooked": "<p>Two things I can note here:</p>\n<ul>\n<li>\n<p>If the image is larger than the container it is placed in, it is resized automatically to fit. However, this is by default not reflected in the measured size, as measuring happens on an unbounded canvas. I would recommend using the <a href=\"https://typst.app/docs/reference/layout/layout/\"><code>layout</code></a> function and passing the bounds in measure.</p>\n</li>\n<li>\n<p>By using <a href=\"https://typst.app/docs/reference/layout/place/\"><code>place</code></a>, you can simplify this quite a bit, as you can set the alignment to the top left of the parent block (here the <code>layout</code> element), so that you don‚Äôt need to move the box manually.</p>\n</li>\n</ul>\n<p>Other than that, the idea is the exact same :)</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let overlay(img, color) = layout(bounds =&gt; {\n  let size = measure(img, ..bounds)\n  img\n  place(top + left, block(..size, fill: color))\n})\n</code></pre>",
      "raw": "Two things I can note here:\n\n- If the image is larger than the container it is placed in, it is resized automatically to fit. However, this is by default not reflected in the measured size, as measuring happens on an unbounded canvas. I would recommend using the [`layout`](https://typst.app/docs/reference/layout/layout/) function and passing the bounds in measure.\n\n- By using [`place`](https://typst.app/docs/reference/layout/place/), you can simplify this quite a bit, as you can set the alignment to the top left of the parent block (here the `layout` element), so that you don't need to move the box manually.\n\nOther than that, the idea is the exact same :)\n\n```typ\n#let overlay(img, color) = layout(bounds => {\n  let size = measure(img, ..bounds)\n  img\n  place(top + left, block(..size, fill: color))\n})\n```",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 42,
      "score": 273.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 5517,
      "post_number": 6,
      "username": "LordBaryhobal",
      "name": "Baryhobal",
      "created_at": "2024-11-11T21:03:42.243Z",
      "updated_at": "2024-11-11T21:03:42.243Z",
      "cooked": "<p>I thought it would probably involve the <code>layout</code> function but I didn‚Äôt know about passing the bounds to <code>measure</code><br>\nThanks for the explanation <img src=\"https://forum.typst.app/images/emoji/apple/+1.png?v=12\" title=\":+1:\" class=\"emoji\" alt=\":+1:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "I thought it would probably involve the `layout` function but I didn't know about passing the bounds to `measure`\nThanks for the explanation :+1:",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 36,
      "score": 27.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 585
    },
    {
      "id": 5536,
      "post_number": 7,
      "username": "Marco",
      "name": "Marco",
      "created_at": "2024-11-12T11:24:07.416Z",
      "updated_at": "2024-11-12T17:17:55.709Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"AhmedSalih\" data-post=\"1\" data-topic=\"1677\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/a/2DAB7D/48.png\" class=\"avatar\"> AhmedSalih:</div>\n<blockquote>\n<ol start=\"2\">\n<li>Make the image transparent, how do I control the opacity of the <code>image</code> function?</li>\n</ol>\n</blockquote>\n</aside>\n<p>When looking for similar functionality i came accross this question and later on a package that seems to do what you were looking for.</p>\n<p>Transparancy is not supported by Typst directly, but the package <a href=\"https://typst.app/universe/package/grayness/\">grayness</a> supports parsing of images and performing operations on the image.<br>\nOne of the operations is transparent image.</p>\n<p>I created this example:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#import \"@preview/grayness:0.2.0\": *\n\n#let data = read(\"nadine-e-ZPP-zP8HYG0-unsplash.jpg\", encoding:none)\n#transparent-image(data,alpha:75%)\n\n#block(fill:gradient.linear(red, blue, angle: 45deg).sharp(2),inset:1cm, transparent-image(data,alpha:75%)) \n</code></pre>\n<p>Photo by <a href=\"https://unsplash.com/photos/round-white-led-light-ZPP-zP8HYG0\" rel=\"noopener nofollow ugc\">Nadine E on Unsplash</a>.</p>\n<p>That results is the following:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/5/559c3215e4dc9686e2bd73b834e3f1e50f652057.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/559c3215e4dc9686e2bd73b834e3f1e50f652057\" title=\"transparancy-example\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/5/559c3215e4dc9686e2bd73b834e3f1e50f652057_2_353x499.jpeg\" alt=\"transparancy-example\" data-base62-sha1=\"cdleqbhwaBpnKO6gkoC1mLm30kn\" width=\"353\" height=\"499\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/5/559c3215e4dc9686e2bd73b834e3f1e50f652057_2_353x499.jpeg, https://forum.typst.app/uploads/default/optimized/2X/5/559c3215e4dc9686e2bd73b834e3f1e50f652057_2_529x748.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/5/559c3215e4dc9686e2bd73b834e3f1e50f652057_2_706x998.jpeg 2x\" data-dominant-color=\"9A939A\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">transparancy-example</span><span class=\"informations\">1488√ó2105 102 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Note that the plugin can become slow on bigger images, but transparancy is possible.</p>",
      "raw": "[quote=\"AhmedSalih, post:1, topic:1677\"]\n2. Make the image transparent, how do I control the opacity of the `image` function?\n[/quote]\n\nWhen looking for similar functionality i came accross this question and later on a package that seems to do what you were looking for.\n\nTransparancy is not supported by Typst directly, but the package [grayness](https://typst.app/universe/package/grayness/) supports parsing of images and performing operations on the image.\nOne of the operations is transparent image.\n\nI created this example:\n\n```typst\n#import \"@preview/grayness:0.2.0\": *\n\n#let data = read(\"nadine-e-ZPP-zP8HYG0-unsplash.jpg\", encoding:none)\n#transparent-image(data,alpha:75%)\n\n#block(fill:gradient.linear(red, blue, angle: 45deg).sharp(2),inset:1cm, transparent-image(data,alpha:75%)) \n```\nPhoto by [Nadine E on Unsplash](https://unsplash.com/photos/round-white-led-light-ZPP-zP8HYG0).\n\nThat results is the following:\n![transparancy-example|353x499](upload://cdleqbhwaBpnKO6gkoC1mLm30kn.jpeg)\n\n\nNote that the plugin can become slow on bigger images, but transparancy is possible.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 34,
      "score": 71.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 720
    }
  ],
  "scraped_at": "2025-06-10T09:55:07.241733"
}
{
  "topic_metadata": {
    "id": 1678,
    "title": "How to format datetime to show for example \"5th of January 2020\"?",
    "slug": "how-to-format-datetime-to-show-for-example-5th-of-january-2020",
    "posts_count": 8,
    "created_at": "2024-11-11T19:44:17.252Z",
    "last_posted_at": "2024-11-11T21:21:41.101Z",
    "views": 286,
    "like_count": 6,
    "reply_count": 6,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "LordBaryhobal",
    "tags": [],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 500
  },
  "posts": [
    {
      "id": 5505,
      "post_number": 1,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2024-11-11T19:44:17.484Z",
      "updated_at": "2024-11-11T19:44:40.814Z",
      "cooked": "<p>Hello!</p>\n<p>I have read through the documentation of <code>datetime</code> in <code>typst</code> here (<a href=\"https://typst.app/docs/reference/foundations/datetime/\" class=\"inline-onebox\">Datetime Type ‚Äì Typst Documentation</a>) and gotten to this:</p>\n<pre><code class=\"lang-auto\">datetime.today().display(\"[day] of [month repr:long] [year]\")\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/c/c9b01d60fbbf3631a3eb907e5fec0254afab8bc1.png\" alt=\"image\" data-base62-sha1=\"sMdikEzdWsciECrae5H2RgvArWV\" width=\"192\" height=\"39\"></p>\n<p>But how can I get it to do correctly, the 2nd, 3rd, 10th, 15th of a month etc. so it comes out as <code>5th of January 2020</code> for example?</p>\n<p>Kind regards</p>",
      "raw": "Hello!\n\nI have read through the documentation of `datetime` in `typst` here (https://typst.app/docs/reference/foundations/datetime/) and gotten to this:\n\n```\ndatetime.today().display(\"[day] of [month repr:long] [year]\")\n```\n![image|192x39](upload://sMdikEzdWsciECrae5H2RgvArWV.png)\n\nBut how can I get it to do correctly, the 2nd, 3rd, 10th, 15th of a month etc. so it comes out as `5th of January 2020` for example?\n\nKind regards",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 1241.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    },
    {
      "id": 5509,
      "post_number": 2,
      "username": "LordBaryhobal",
      "name": "Baryhobal",
      "created_at": "2024-11-11T20:14:30.164Z",
      "updated_at": "2024-11-11T21:15:32.926Z",
      "cooked": "<p>You will have to manually find the appropriate suffix<br>\nSomething like this should work for your needs</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let my-date(..args) = {\n  let date = if args.pos().len() == 0 {\n    datetime.today()\n  } else {\n    args.pos().first()\n  }\n  let day = date.day()\n  let suffix = if day in (11, 12, 13) { \"th\" } else {\n    (\"st\", \"nd\", \"rd\").at(calc.rem(day - 1, 10), default: \"th\")\n  }\n  date.display(\"[day padding:none]\" + suffix + \" of [month repr:long] [year]\")\n}\nToday: #my-date()\\\nCustom date: #my-date(datetime(year: 2020, month: 1, day: 5))\n</code></pre>\n<p>EDIT: implemented Eric‚Äôs fix</p>",
      "raw": "You will have to manually find the appropriate suffix\nSomething like this should work for your needs\n```typ\n#let my-date(..args) = {\n  let date = if args.pos().len() == 0 {\n    datetime.today()\n  } else {\n    args.pos().first()\n  }\n  let day = date.day()\n  let suffix = if day in (11, 12, 13) { \"th\" } else {\n    (\"st\", \"nd\", \"rd\").at(calc.rem(day - 1, 10), default: \"th\")\n  }\n  date.display(\"[day padding:none]\" + suffix + \" of [month repr:long] [year]\")\n}\nToday: #my-date()\\\nCustom date: #my-date(datetime(year: 2020, month: 1, day: 5))\n```\n\nEDIT: implemented Eric's fix",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 29,
      "score": 35.8,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 585
    },
    {
      "id": 5513,
      "post_number": 3,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2024-11-11T20:32:23.412Z",
      "updated_at": "2024-11-11T21:09:22.456Z",
      "cooked": "<p>Watch out when determining the suffix, you currently have an off-by-one error at the start of the month, and wrong suffixes for 21, 22, 23 and 31 ;)</p>\n<p>Something like this should do it</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">let suffix = if day in (11, 12, 13) { \"th\" } else {\n  (\"st\", \"nd\", \"rd\").at(calc.rem(day - 1, 10), default: \"th\")\n}\n</code></pre>",
      "raw": "Watch out when determining the suffix, you currently have an off-by-one error at the start of the month, and wrong suffixes for 21, 22, 23 and 31 ;)\n\nSomething like this should do it\n```typc\nlet suffix = if day in (11, 12, 13) { \"th\" } else {\n  (\"st\", \"nd\", \"rd\").at(calc.rem(day - 1, 10), default: \"th\")\n}\n```",
      "reply_to_post_number": 2,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 27,
      "score": 35.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 5514,
      "post_number": 4,
      "username": "LordBaryhobal",
      "name": "Baryhobal",
      "created_at": "2024-11-11T20:34:19.630Z",
      "updated_at": "2024-11-11T20:34:19.630Z",
      "cooked": "<p><img src=\"https://forum.typst.app/images/emoji/apple/man_facepalming.png?v=12\" title=\":man_facepalming:\" class=\"emoji\" alt=\":man_facepalming:\" loading=\"lazy\" width=\"20\" height=\"20\"> <img src=\"https://forum.typst.app/images/emoji/apple/man_facepalming.png?v=12\" title=\":man_facepalming:\" class=\"emoji\" alt=\":man_facepalming:\" loading=\"lazy\" width=\"20\" height=\"20\"> <img src=\"https://forum.typst.app/images/emoji/apple/man_facepalming.png?v=12\" title=\":man_facepalming:\" class=\"emoji\" alt=\":man_facepalming:\" loading=\"lazy\" width=\"20\" height=\"20\"> indeed, thank you for your correction <img src=\"https://forum.typst.app/images/emoji/apple/sweat_smile.png?v=12\" title=\":sweat_smile:\" class=\"emoji\" alt=\":sweat_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": ":man_facepalming: :man_facepalming: :man_facepalming: indeed, thank you for your correction :sweat_smile:",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 5.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 585
    },
    {
      "id": 5516,
      "post_number": 5,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2024-11-11T21:02:57.387Z",
      "updated_at": "2024-11-11T21:07:04.919Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Eric\" data-post=\"3\" data-topic=\"1678\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/eric/48/87_2.png\" class=\"avatar\"> Eric:</div>\n<blockquote>\n<pre><code class=\"lang-auto\">let suffix = if day in (11, 12, 13) { \"th\" } else {\n  (\"st\", \"nd\", \"rd\").at(calc.rem(day, 10) - 1, default: \"th\")\n}\n</code></pre>\n</blockquote>\n</aside>\n<p>This errors with 10 though:</p>\n<pre><code class=\"lang-auto\">my-date(datetime(year: 2020, month: 1, day: 10))\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/3/3728ebbb707b51c4822fc37d6cddaedf28b3ec95.png\" alt=\"image\" data-base62-sha1=\"7RXVRMww76VSOMQWYjt6EyFqL5z\" width=\"197\" height=\"54\"></p>\n<p>Any suggestions :) ?</p>\n<p>EDIT: ChatGPT believes this to be a solution which works according to my test:</p>\n<pre><code class=\"lang-auto\">  let my_date(..args) = {\n    // Determine the date, defaulting to today if no argument is provided.\n    let date = if args.pos().len() == 0 {\n      datetime.today()\n    } else {\n      args.pos().first()\n    }\n    \n    // Calculate the day and determine the correct suffix.\n    let day = date.day()\n    let suffix = if day in (11, 12, 13) {\n      \"th\"\n    } else if calc.rem(day, 10) == 1 {\n      \"st\"\n    } else if calc.rem(day, 10) == 2 {\n      \"nd\"\n    } else if calc.rem(day, 10) == 3 {\n      \"rd\"\n    } else {\n      \"th\"\n    }\n\n  // Display the formatted date.\n  date.display(\"[day padding:none]\" + suffix + \" of [month repr:long] [year]\")\n}\n</code></pre>",
      "raw": "[quote=\"Eric, post:3, topic:1678\"]\n```\nlet suffix = if day in (11, 12, 13) { \"th\" } else {\n  (\"st\", \"nd\", \"rd\").at(calc.rem(day, 10) - 1, default: \"th\")\n}\n```\n[/quote]\n\nThis errors with 10 though:\n\n```\nmy-date(datetime(year: 2020, month: 1, day: 10))\n```\n\n![image|197x54](upload://7RXVRMww76VSOMQWYjt6EyFqL5z.png)\n\nAny suggestions :) ?\n\nEDIT: ChatGPT believes this to be a solution which works according to my test:\n\n```\n  let my_date(..args) = {\n    // Determine the date, defaulting to today if no argument is provided.\n    let date = if args.pos().len() == 0 {\n      datetime.today()\n    } else {\n      args.pos().first()\n    }\n    \n    // Calculate the day and determine the correct suffix.\n    let day = date.day()\n    let suffix = if day in (11, 12, 13) {\n      \"th\"\n    } else if calc.rem(day, 10) == 1 {\n      \"st\"\n    } else if calc.rem(day, 10) == 2 {\n      \"nd\"\n    } else if calc.rem(day, 10) == 3 {\n      \"rd\"\n    } else {\n      \"th\"\n    }\n\n  // Display the formatted date.\n  date.display(\"[day padding:none]\" + suffix + \" of [month repr:long] [year]\")\n}\n```",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 27,
      "score": 10.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    },
    {
      "id": 5518,
      "post_number": 6,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2024-11-11T21:09:30.635Z",
      "updated_at": "2024-11-11T21:09:30.635Z",
      "cooked": "<p>Oops, you‚Äôre right, it should be <code>calc.rem(day - 1, 10)</code> instead of <code>calc.rem(day, 10) - 1</code>, I have edited my above reply. Your more explicit code by ChatGPT also works of course!</p>",
      "raw": "Oops, you're right, it should be `calc.rem(day - 1, 10)` instead of `calc.rem(day, 10) - 1`, I have edited my above reply. Your more explicit code by ChatGPT also works of course!",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 23,
      "score": 24.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 5521,
      "post_number": 7,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2024-11-11T21:17:49.559Z",
      "updated_at": "2024-11-11T21:17:49.559Z",
      "cooked": "<p>Thank you Eric, I have used your fix with the solution provided above</p>\n<p>Thank you to both of you! :)</p>",
      "raw": "Thank you Eric, I have used your fix with the solution provided above\n\nThank you to both of you! :)",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 9.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    },
    {
      "id": 5522,
      "post_number": 8,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-11-11T21:21:41.101Z",
      "updated_at": "2024-11-11T21:22:29.790Z",
      "cooked": "<p>May I suggest the <code>nth</code> package? <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/universe/package/nth/\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/universe/package/nth/\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/universe/package/nth/\" target=\"_blank\" rel=\"noopener\">nth ‚Äì Typst Universe</a></h3>\n\n  <p>Add english ordinals to numbers, eg. 1st, 2nd, 3rd, 4th.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>then you don‚Äôt have to do this logic yourself:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/nth:1.0.1\": *\n\n#let my-date(date) = nth(date.day()) + date.display(\" of [month repr:long] [year]\")\n\nToday: #my-date(datetime.today())\\\nCustom date: #my-date(datetime(year: 2020, month: 1, day: 5))\n</code></pre>\n<p>or replace <code>nth</code> with <code>nths</code> if you want superscript</p>",
      "raw": "May I suggest the `nth` package? :slight_smile: \n\nhttps://typst.app/universe/package/nth/\n\nthen you don't have to do this logic yourself:\n```typ\n#import \"@preview/nth:1.0.1\": *\n\n#let my-date(date) = nth(date.day()) + date.display(\" of [month repr:long] [year]\")\n\nToday: #my-date(datetime.today())\\\nCustom date: #my-date(datetime(year: 2020, month: 1, day: 5))\n```\n\nor replace `nth` with `nths` if you want superscript",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 19,
      "score": 58.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:55:06.522030"
}
{
  "topic_metadata": {
    "id": 1681,
    "title": "How to remake this outline in Typst?",
    "slug": "how-to-remake-this-outline-in-typst",
    "posts_count": 7,
    "created_at": "2024-11-11T22:57:58.443Z",
    "last_posted_at": "2024-11-12T21:31:04.025Z",
    "views": 934,
    "like_count": 3,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "LordBaryhobal",
    "tags": [
      "outline"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 817
  },
  "posts": [
    {
      "id": 5525,
      "post_number": 1,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2024-11-11T22:57:58.561Z",
      "updated_at": "2024-11-12T16:36:55.971Z",
      "cooked": "<p>Hi!</p>\n<p>To be honest I am really struggling to make this kind of outline in Typst:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/0/05bfed3026c7ea34f406bd1739404755ac3a5569.png\" data-download-href=\"https://forum.typst.app/uploads/default/05bfed3026c7ea34f406bd1739404755ac3a5569\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/0/05bfed3026c7ea34f406bd1739404755ac3a5569_2_690x286.png\" alt=\"image\" data-base62-sha1=\"ORAskKsxYRIsUk0j11YVW2Ou9P\" width=\"690\" height=\"286\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/0/05bfed3026c7ea34f406bd1739404755ac3a5569_2_690x286.png, https://forum.typst.app/uploads/default/optimized/2X/0/05bfed3026c7ea34f406bd1739404755ac3a5569_2_1035x429.png 1.5x, https://forum.typst.app/uploads/default/original/2X/0/05bfed3026c7ea34f406bd1739404755ac3a5569.png 2x\" data-dominant-color=\"FBFAFA\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1164√ó484 61.4 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>I am sure it should be simple enough but the best I have is:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">  #set heading(numbering: \"1.1\")\n\n  #show outline.entry.where(\n  level: 1\n  ): it =&gt; {\n    v(12pt, weak: true)\n    strong(it)\n  }\n\n  #outline(indent: auto)\n  \n  = Introduction\n  = Background\n  == History\n  == State of the Art\n  = Analysis\n  == Setup\n  === Testing\n  ==== How four looks\n</code></pre>\n<p>Which gives:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/e/eca186a50646e30f780f3fc41af2e389ba0dffcf.png\" data-download-href=\"https://forum.typst.app/uploads/default/eca186a50646e30f780f3fc41af2e389ba0dffcf\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/e/eca186a50646e30f780f3fc41af2e389ba0dffcf_2_690x280.png\" alt=\"image\" data-base62-sha1=\"xLkKy2dzdRZ8TnhsKPoX3oipWdF\" width=\"690\" height=\"280\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/e/eca186a50646e30f780f3fc41af2e389ba0dffcf_2_690x280.png, https://forum.typst.app/uploads/default/original/2X/e/eca186a50646e30f780f3fc41af2e389ba0dffcf.png 1.5x, https://forum.typst.app/uploads/default/original/2X/e/eca186a50646e30f780f3fc41af2e389ba0dffcf.png 2x\" data-dominant-color=\"F3F3F4\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">731√ó297 32.4 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>So I am missing the horizontal line below contents, same font size and colouring etc‚Ä¶ the examples on the web are not helping me right now, hope someone here might know</p>\n<p>Kind regards</p>",
      "raw": "Hi!\n\nTo be honest I am really struggling to make this kind of outline in Typst:\n\n![image|690x286](upload://ORAskKsxYRIsUk0j11YVW2Ou9P.png)\n\nI am sure it should be simple enough but the best I have is:\n\n```typst\n  #set heading(numbering: \"1.1\")\n\n  #show outline.entry.where(\n  level: 1\n  ): it => {\n    v(12pt, weak: true)\n    strong(it)\n  }\n\n  #outline(indent: auto)\n  \n  = Introduction\n  = Background\n  == History\n  == State of the Art\n  = Analysis\n  == Setup\n  === Testing\n  ==== How four looks\n```\n\nWhich gives:\n\n![image|690x280](upload://xLkKy2dzdRZ8TnhsKPoX3oipWdF.png)\n\nSo I am missing the horizontal line below contents, same font size and colouring etc.. the examples on the web are not helping me right now, hope someone here might know\n\nKind regards",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 95,
      "score": 4574.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    },
    {
      "id": 5526,
      "post_number": 2,
      "username": "LordBaryhobal",
      "name": "Baryhobal",
      "created_at": "2024-11-12T00:39:20.160Z",
      "updated_at": "2024-11-12T00:41:09.190Z",
      "cooked": "<p>To underline the outline‚Äôs title, you can wrap it inside a box with a bottom border like so:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#outline(\n  indent: auto,\n  title: box(\n    stroke: (bottom: black),\n    inset: (\n      bottom: 0.4em,\n      right: 4cm\n    ),\n    text(size: 1.5em)[Contents]\n  )\n)\n</code></pre>\n<p>Regarding the same font size and coloring, I think you might want to use a show-set rule like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show outline: set text(font: \"Public Sans\", size: 12pt, fill: black)\n</code></pre>\n<p>EDIT: Result with both of these changes<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/c/c3f3e9ac1fd770368ab57315ebcce9842f9dd287.png\" data-download-href=\"https://forum.typst.app/uploads/default/c3f3e9ac1fd770368ab57315ebcce9842f9dd287\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/c/c3f3e9ac1fd770368ab57315ebcce9842f9dd287_2_690x293.png\" alt=\"image\" data-base62-sha1=\"rXtGCBZrp5NriPoZgxBG9DZlabJ\" width=\"690\" height=\"293\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/c/c3f3e9ac1fd770368ab57315ebcce9842f9dd287_2_690x293.png, https://forum.typst.app/uploads/default/original/2X/c/c3f3e9ac1fd770368ab57315ebcce9842f9dd287.png 1.5x, https://forum.typst.app/uploads/default/original/2X/c/c3f3e9ac1fd770368ab57315ebcce9842f9dd287.png 2x\" data-dominant-color=\"F1F1F1\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">827√ó352 45.8 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "To underline the outline's title, you can wrap it inside a box with a bottom border like so:\n```typ\n#outline(\n  indent: auto,\n  title: box(\n    stroke: (bottom: black),\n    inset: (\n      bottom: 0.4em,\n      right: 4cm\n    ),\n    text(size: 1.5em)[Contents]\n  )\n)\n```\n\nRegarding the same font size and coloring, I think you might want to use a show-set rule like this:\n```typ\n#show outline: set text(font: \"Public Sans\", size: 12pt, fill: black)\n```\n\nEDIT: Result with both of these changes\n![image|690x293](upload://rXtGCBZrp5NriPoZgxBG9DZlabJ.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 81,
      "score": 171.2,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 585
    },
    {
      "id": 5546,
      "post_number": 3,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2024-11-12T16:22:12.515Z",
      "updated_at": "2024-11-12T16:22:12.515Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"LordBaryhobal\" data-post=\"2\" data-topic=\"1681\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/lordbaryhobal/48/855_2.png\" class=\"avatar\"> LordBaryhobal:</div>\n<blockquote>\n<p><code>text(size: 1.5em)[Contents]</code></p>\n</blockquote>\n</aside>\n<p>Thank you!</p>\n<p>I was able to modify it enough to represent what I want and get it to work. I ended up using a <code>context {}</code> block, but I like your solution too.</p>\n<p>To control the ‚Äú.‚Äù spacing I did <code>fill:  box(repeat(text(fill: black, \".\"), gap:0.8em, justify: true))</code></p>\n<p>Kind regards</p>",
      "raw": "[quote=\"LordBaryhobal, post:2, topic:1681\"]\n`text(size: 1.5em)[Contents]`\n[/quote]\n\nThank you!\n\nI was able to modify it enough to represent what I want and get it to work. I ended up using a `context {}` block, but I like your solution too.\n\nTo control the \".\" spacing I did `fill:  box(repeat(text(fill: black, \".\"), gap:0.8em, justify: true))`\n\nKind regards",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 71,
      "score": 74.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    },
    {
      "id": 5548,
      "post_number": 4,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-11-12T16:39:58.687Z",
      "updated_at": "2024-11-12T16:39:58.687Z",
      "cooked": "<p>note that the <code>repeat</code> function doesn‚Äôt align the dots below each other. If you want that, I recommend <a href=\"https://typst.app/universe/package/outrageous\">outrageous</a> which does support that out of the box. That package is very useful in general to replicate LaTeX-style outlines.</p>\n<p>(PS: I added <a class=\"hashtag-cooked\" href=\"/tag/outline\" data-type=\"tag\" data-slug=\"outline\" data-id=\"83\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>outline</span></a> to your post. If the outlines you‚Äôre trying to remake are LaTeX ones, consider adding <a class=\"hashtag-cooked\" href=\"/tag/latex-migration\" data-type=\"tag\" data-slug=\"latex-migration\" data-id=\"92\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>latex-migration</span></a> as well)</p>",
      "raw": "note that the `repeat` function doesn't align the dots below each other. If you want that, I recommend [outrageous](https://typst.app/universe/package/outrageous) which does support that out of the box. That package is very useful in general to replicate LaTeX-style outlines.\n\n(PS: I added #outline to your post. If the outlines you're trying to remake are LaTeX ones, consider adding #latex-migration as well)",
      "reply_to_post_number": 3,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 0,
      "reads": 71,
      "score": 24.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 5550,
      "post_number": 5,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2024-11-12T17:11:37.726Z",
      "updated_at": "2024-11-12T17:11:37.726Z",
      "cooked": "<p>Thanks for adding that.</p>\n<p>I did see that library and wish I could find a native way to do the ‚Äú.‚Äù spread as pretty.</p>\n<p>Unfortunately the licensing term for that package is <code>outrageous</code>:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/c/cbb58b9fd38cbb89b96f510119b302db791290a8.png\" data-download-href=\"https://forum.typst.app/uploads/default/cbb58b9fd38cbb89b96f510119b302db791290a8\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/c/cbb58b9fd38cbb89b96f510119b302db791290a8_2_690x59.png\" alt=\"image\" data-base62-sha1=\"t45SUNkplBblMWCIgDqdhPKb8ne\" width=\"690\" height=\"59\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/c/cbb58b9fd38cbb89b96f510119b302db791290a8_2_690x59.png, https://forum.typst.app/uploads/default/optimized/2X/c/cbb58b9fd38cbb89b96f510119b302db791290a8_2_1035x88.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/c/cbb58b9fd38cbb89b96f510119b302db791290a8_2_1380x118.png 2x\" data-dominant-color=\"FAFAF8\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">2202√ó190 32.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Any derived work if I understand correctly must be disclosed in its full source - I am surprised if one can find it in <code>@preview</code> unless I have a major misunderstanding.</p>\n<p>Kind regards</p>",
      "raw": "Thanks for adding that.\n\nI did see that library and wish I could find a native way to do the \".\" spread as pretty.\n\nUnfortunately the licensing term for that package is `outrageous`:\n\n![image|690x59](upload://t45SUNkplBblMWCIgDqdhPKb8ne.png)\n\nAny derived work if I understand correctly must be disclosed in its full source - I am surprised if one can find it in `@preview` unless I have a major misunderstanding.\n\nKind regards",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 70,
      "score": 44.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    },
    {
      "id": 5551,
      "post_number": 6,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-11-12T18:00:24.439Z",
      "updated_at": "2024-11-12T18:00:24.439Z",
      "cooked": "<p>The good thing is that this particular piece of code was adapted from an MIT-licensed package: <a href=\"https://github.com/EpicEricEE/typst-plugins/blob/b13b0e1bc30beba65ff19d029e2dad61239a2819/outex/src/outex.typ#L1-L27\" class=\"inline-onebox\">typst-plugins/outex/src/outex.typ at b13b0e1bc30beba65ff19d029e2dad61239a2819 ¬∑ EpicEricEE/typst-plugins ¬∑ GitHub</a> so you can simply take that function, properly attribute it, and not bother with outrageous.</p>\n<p>Regarding GPL ‚Äì disclaimer, I‚Äôm not a lawyer ‚Äì there was some discussion on Discord <a href=\"https://discord.com/channels/1054443721975922748/1194684809906237500/1245827228781117516\">beginning here</a>, in the course of which I also found the following SE post:</p>\n<aside class=\"onebox stackexchange\" data-onebox-src=\"https://opensource.stackexchange.com/questions/2735/gpl-licensed-latex-template-implications-for-resulting-work\">\n  <header class=\"source\">\n\n      <a href=\"https://opensource.stackexchange.com/questions/2735/gpl-licensed-latex-template-implications-for-resulting-work\" target=\"_blank\" rel=\"noopener\">opensource.stackexchange.com</a>\n  </header>\n\n  <article class=\"onebox-body\">\n      <a href=\"https://opensource.stackexchange.com/users/4758/malexmave\" target=\"_blank\" rel=\"noopener\">\n    <img alt=\"malexmave\" src=\"https://forum.typst.app/uploads/default/original/2X/9/99f6f8d809564be16981bd11b7430d50933b0b08.jpeg\" class=\"thumbnail onebox-avatar\" data-dominant-color=\"7C7059\" width=\"256\" height=\"256\">\n  </a>\n\n<h4>\n  <a href=\"https://opensource.stackexchange.com/questions/2735/gpl-licensed-latex-template-implications-for-resulting-work\" target=\"_blank\" rel=\"noopener\">GPL-Licensed LaTeX template - implications for resulting work?</a>\n</h4>\n\n<div class=\"tags\">\n  <strong>gpl, derivative-works</strong>\n</div>\n\n<div class=\"date\">\n  \n  \n  <a href=\"https://opensource.stackexchange.com/users/4758/malexmave\" target=\"_blank\" rel=\"noopener\">\n    malexmave\n  </a>\n  on <a href=\"https://opensource.stackexchange.com/questions/2735/gpl-licensed-latex-template-implications-for-resulting-work\" target=\"_blank\" rel=\"noopener\">11:28AM - 09 Apr 16 UTC</a>\n</div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>Regarding which I wrote</p>\n<blockquote>\n<p>The accepted answer is of the opinion that a PDF file is considered ‚Äúobject code‚Äù that resulted from compiling <s>LaTeX</s> Typst source code, and if some of that source code is GPL, that means the whole derived work needs to be GPL licensed. Many other users agree, but the discussion under the accepted answer also has doubts that this is the correct interpretation: another interpretation is that the ‚Äúcompilation‚Äù is actually interpreting the source files, and the PDF is the <em>output</em> of the interpreted code, not a <em>translated form</em> of the compiled code.</p>\n<p>I think it‚Äôs fair to say that the open source SE community (and the FSF, whose opinion is referenced by the answer) probably has a bias towards the former interpretation; I personally agree more with the latter camp (even though user PhillipPirrip is not convincing to me, Max Xiong makes a good case for that interpretation - no pun intended).</p>\n<p>* The two discrepancies are that the post is about LaTeX, and that the code in question is a template that iiuc includes a tex file that would be changed directly; it‚Äôs not <em>only</em> about using a library.</p>\n<p>‚Äì SillyFreak <a href=\"https://discord.com/channels/1054443721975922748/1194684809906237500/1246855965341646880\">on Discord</a>, <span class=\"discourse-local-date\" data-date=\"2024-06-02\" data-email-preview=\"2024-06-02T16:00:00Z UTC\" data-time=\"18:00:00\" data-timezone=\"Europe/Vienna\">2024-06-02T16:00:00Z</span></p>\n</blockquote>\n<p>So I don‚Äôt think it‚Äôs clear-cut, but I understand the hesitance.</p>",
      "raw": "The good thing is that this particular piece of code was adapted from an MIT-licensed package: https://github.com/EpicEricEE/typst-plugins/blob/b13b0e1bc30beba65ff19d029e2dad61239a2819/outex/src/outex.typ#L1-L27 so you can simply take that function, properly attribute it, and not bother with outrageous.\n\nRegarding GPL -- disclaimer, I'm not a lawyer -- there was some discussion on Discord [beginning here](https://discord.com/channels/1054443721975922748/1194684809906237500/1245827228781117516), in the course of which I also found the following SE post:\n\nhttps://opensource.stackexchange.com/questions/2735/gpl-licensed-latex-template-implications-for-resulting-work\n\nRegarding which I wrote\n\n> The accepted answer is of the opinion that a PDF file is considered \"object code\" that resulted from compiling ~~LaTeX~~ Typst source code, and if some of that source code is GPL, that means the whole derived work needs to be GPL licensed. Many other users agree, but the discussion under the accepted answer also has doubts that this is the correct interpretation: another interpretation is that the \"compilation\" is actually interpreting the source files, and the PDF is the *output* of the interpreted code, not a *translated form* of the compiled code.\n>\n> I think it's fair to say that the open source SE community (and the FSF, whose opinion is referenced by the answer) probably has a bias towards the former interpretation; I personally agree more with the latter camp (even though user PhillipPirrip is not convincing to me, Max Xiong makes a good case for that interpretation - no pun intended).\n>\n>\\* The two discrepancies are that the post is about LaTeX, and that the code in question is a template that iiuc includes a tex file that would be changed directly; it's not *only* about using a library.\n>\n> -- SillyFreak [on Discord](https://discord.com/channels/1054443721975922748/1194684809906237500/1246855965341646880), [date=2024-06-02 time=18:00:00 timezone=\"Europe/Vienna\"]\n\nSo I don't think it's clear-cut, but I understand the hesitance.",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 65,
      "score": 43.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 5566,
      "post_number": 7,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2024-11-12T21:31:04.025Z",
      "updated_at": "2024-11-12T21:31:04.025Z",
      "cooked": "<p>The <a href=\"https://typst.app/docs/reference/layout/repeat/\"><code>repeat</code></a> function has in fact gained this capability in v0.12, as you can now set a <code>gap</code> between the repeated elements, and whether to <code>justify</code> them (i.e. whether the gap can be increased to completely fill the available width). If you combine this with a right-align, and a constant width of all page numbers (which is still a bit annoying to achieve), this should make the dot alignment possible.</p>\n<p>The API and behavior should be the exact same as in the <code>outex</code> code piece you linked.</p>",
      "raw": "The [`repeat`](https://typst.app/docs/reference/layout/repeat/) function has in fact gained this capability in v0.12, as you can now set a `gap` between the repeated elements, and whether to `justify` them (i.e. whether the gap can be increased to completely fill the available width). If you combine this with a right-align, and a constant width of all page numbers (which is still a bit annoying to achieve), this should make the dot alignment possible.\n\nThe API and behavior should be the exact same as in the `outex` code piece you linked.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 50,
      "score": 80.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 88
    }
  ],
  "scraped_at": "2025-06-10T09:55:05.633522"
}
{
  "topic_metadata": {
    "id": 1684,
    "title": "Why are list items, paragraphs and the first line of example and definition statements misaligned?",
    "slug": "why-are-list-items-paragraphs-and-the-first-line-of-example-and-definition-statements-misaligned",
    "posts_count": 4,
    "created_at": "2024-11-12T11:21:50.464Z",
    "last_posted_at": "2024-12-19T05:02:31.385Z",
    "views": 99,
    "like_count": 0,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "ArthurAraruna",
    "tags": [
      "layout",
      "alignment"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 389
  },
  "posts": [
    {
      "id": 5535,
      "post_number": 1,
      "username": "Oscar",
      "name": "acsor43215",
      "created_at": "2024-11-12T11:21:50.670Z",
      "updated_at": "2024-12-19T05:01:41.340Z",
      "cooked": "<p>Hi everyone, I‚Äôm using Typst to typeset my master‚Äôs thesis, and differently to other documents I have written in the past with Typst, there are paragraphs, list items or titles of definitions and examples that are horizontally misaligned. An example of this is below.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/8e4b6fb428927feb3709b5d21805533db3486941.png\" data-download-href=\"https://forum.typst.app/uploads/default/8e4b6fb428927feb3709b5d21805533db3486941\" title=\"Misaligned list items.\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/8e4b6fb428927feb3709b5d21805533db3486941_2_690x158.png\" alt=\"Misaligned list items.\" data-base62-sha1=\"kiNqbNa0bva4DYkIgYtbor1CmwF\" width=\"690\" height=\"158\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/8/8e4b6fb428927feb3709b5d21805533db3486941_2_690x158.png, https://forum.typst.app/uploads/default/original/2X/8/8e4b6fb428927feb3709b5d21805533db3486941.png 1.5x, https://forum.typst.app/uploads/default/original/2X/8/8e4b6fb428927feb3709b5d21805533db3486941.png 2x\" data-dominant-color=\"EEEEEE\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Misaligned list items.</span><span class=\"informations\">746√ó171 36.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/5/5c337ec9b229a4bfedc3ab003fcd05a4f5d2afca.png\" data-download-href=\"https://forum.typst.app/uploads/default/5c337ec9b229a4bfedc3ab003fcd05a4f5d2afca\" title=\"Misaligned first lines of example box.\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/5/5c337ec9b229a4bfedc3ab003fcd05a4f5d2afca_2_690x242.png\" alt=\"Misaligned first lines of example box.\" data-base62-sha1=\"d9EfPFJHYbHdg1YdgheEmyjHmdQ\" width=\"690\" height=\"242\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/5/5c337ec9b229a4bfedc3ab003fcd05a4f5d2afca_2_690x242.png, https://forum.typst.app/uploads/default/original/2X/5/5c337ec9b229a4bfedc3ab003fcd05a4f5d2afca.png 1.5x, https://forum.typst.app/uploads/default/original/2X/5/5c337ec9b229a4bfedc3ab003fcd05a4f5d2afca.png 2x\" data-dominant-color=\"F5F5F5\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Misaligned first lines of example box.</span><span class=\"informations\">721√ó253 35 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>I have already tried commenting out all of the templates and style commands I use, but this had no effect at all in the document. Could this be an instance of <a href=\"https://github.com/typst/typst/issues/529\" rel=\"noopener nofollow ugc\">issue #529</a> from the GitHub repository? Irrespective of this, is there a workaround to overcome this? I am really puzzled, because I‚Äôm reusing the same setup of some of the packages I have used in the past (<a href=\"https://typst.app/universe/package/lemmify\">lemmify</a>, for instance) but I‚Äôm getting this problem for the first time only now.</p>",
      "raw": "Hi everyone, I'm using Typst to typeset my master's thesis, and differently to other documents I have written in the past with Typst, there are paragraphs, list items or titles of definitions and examples that are horizontally misaligned. An example of this is below.\n\n![Misaligned list items.|690x158](upload://kiNqbNa0bva4DYkIgYtbor1CmwF.png)\n![Misaligned first lines of example box.|690x242](upload://d9EfPFJHYbHdg1YdgheEmyjHmdQ.png)\n\nI have already tried commenting out all of the templates and style commands I use, but this had no effect at all in the document. Could this be an instance of [issue #529](https://github.com/typst/typst/issues/529) from the GitHub repository? Irrespective of this, is there a workaround to overcome this? I am really puzzled, because I'm reusing the same setup of some of the packages I have used in the past ([lemmify](https://typst.app/universe/package/lemmify), for instance) but I'm getting this problem for the first time only now.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 185.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 602
    },
    {
      "id": 5537,
      "post_number": 2,
      "username": "ArthurAraruna",
      "name": "Arthur Rodrigues Araruna",
      "created_at": "2024-11-12T12:51:17.247Z",
      "updated_at": "2024-11-12T12:51:17.247Z",
      "cooked": "<p>I think you didn‚Äôt notice, but the paragraphs seem to be centralized, and not ragged right.</p>\n<p>Try <code>set align(left)</code>, or <code>set align(horizon)</code> if you want it to also work with RTL languages, before the text you want to influence.</p>\n<p>Maybe the alignment is being set by some function you‚Äôre calling and that function does not restrict the rule to a block, so it leaks to the rest of the document.</p>",
      "raw": "I think you didn't notice, but the paragraphs seem to be centralized, and not ragged right.\n\nTry `set align(left)`, or `set align(horizon)` if you want it to also work with RTL languages, before the text you want to influence.\n\nMaybe the alignment is being set by some function you're calling and that function does not restrict the rule to a block, so it leaks to the rest of the document.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 14.8,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 684
    },
    {
      "id": 5542,
      "post_number": 3,
      "username": "Oscar",
      "name": "acsor43215",
      "created_at": "2024-11-12T14:58:45.356Z",
      "updated_at": "2024-11-12T14:58:45.356Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"ArthurAraruna\" data-post=\"2\" data-topic=\"1684\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/a/00298C/48.png\" class=\"avatar\"> ArthurAraruna:</div>\n<blockquote>\n<p>I think you didn‚Äôt notice, but the paragraphs seem to be centralized, and not ragged right.</p>\n</blockquote>\n</aside>\n<p>Yes, that‚Äôs right. All these elements are centered. That‚Äôs something I had already noticed before, but I wanted to keep things simple in the title and description.</p>\n<p>That said, I think I have found a solution. Following your advice, I‚Äôm forcing left alignment on lemmify elements:</p>\n<pre><code class=\"lang-auto\">show thm-selector(\"default-theorems\"): x =&gt; {\n    set align(left)\n\n    x\n}\n\nshow thm-selector(\"my-theorems\"): x =&gt; {\n    set align(left)\n\n    x\n}\n</code></pre>\n<p>I had a quick scroll through the whole document and all elements seem to be correctly aligned now.</p>",
      "raw": "[quote=\"ArthurAraruna, post:2, topic:1684\"]\nI think you didn‚Äôt notice, but the paragraphs seem to be centralized, and not ragged right.\n[/quote]\n\nYes, that's right. All these elements are centered. That's something I had already noticed before, but I wanted to keep things simple in the title and description.\n\nThat said, I think I have found a solution. Following your advice, I'm forcing left alignment on lemmify elements:\n\n```\nshow thm-selector(\"default-theorems\"): x => {\n    set align(left)\n\n    x\n}\n\nshow thm-selector(\"my-theorems\"): x => {\n    set align(left)\n\n    x\n}\n```\n\nI had a quick scroll through the whole document and all elements seem to be correctly aligned now.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 18,
      "score": 3.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 602
    },
    {
      "id": 6765,
      "post_number": 4,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-19T05:02:31.385Z",
      "updated_at": "2024-12-19T05:02:31.385Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/oscar\">@Oscar</a>, if your reply solved the problem, please mark it as a solution with the <img src=\"https://forum.typst.app/images/emoji/apple/white_check_mark.png?v=12\" title=\":white_check_mark:\" class=\"emoji\" alt=\":white_check_mark:\" loading=\"lazy\" width=\"20\" height=\"20\"> button, otherwise let us know if you still need help. Thanks!</p>\n<p>(I‚Äôve also changed your post‚Äôs title to be a question, as per our guidelines.)</p>",
      "raw": "Hey @Oscar, if your reply solved the problem, please mark it as a solution with the :white_check_mark: button, otherwise let us know if you still need help. Thanks!\n\n(I've also changed your post's title to be a question, as per our guidelines.)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 15,
      "score": 8.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:55:04.821725"
}
{
  "topic_metadata": {
    "id": 1690,
    "title": "How to Color Parts of Code Snippets?",
    "slug": "how-to-color-parts-of-code-snippets",
    "posts_count": 5,
    "created_at": "2024-11-12T16:37:00.390Z",
    "last_posted_at": "2024-11-20T05:29:25.767Z",
    "views": 389,
    "like_count": 2,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "sjfhsjfh",
    "tags": [],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 532
  },
  "posts": [
    {
      "id": 5547,
      "post_number": 1,
      "username": "Hasan",
      "name": "Hasan",
      "created_at": "2024-11-12T16:37:00.540Z",
      "updated_at": "2024-11-12T16:42:13.609Z",
      "cooked": "<p>Is there for method without a package for coloring parts of a coding block e.g.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">```‚Äã\nEnter a 24-hour time: 09:19\nCloset departure time is 8:00, arriving at 10:16\n```‚Äã\n</code></pre>\n<p>Outputs the text with no color. When I want to make <code>09:19</code> colored red. I cannot use the <code>#text(fill: red)</code> function  as the text inside the backtics is treated as a string and the <code>#raw()</code> function accepts strings only. I am aware that I could break this block into lines and color that part only, but its a bit time consuming.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">`Enter a 24-hour time:` #text(fill: red)[`09:19`] \\\n`Closet departure times is 8:00, arriving at 10:16`\n</code></pre>\n<p>Thank you for reading</p>",
      "raw": "Is there for method without a package for coloring parts of a coding block e.g.\n\n```typ\n```‚Äã\nEnter a 24-hour time: 09:19\nCloset departure time is 8:00, arriving at 10:16\n```‚Äã\n```\nOutputs the text with no color. When I want to make `09:19` colored red. I cannot use the `#text(fill: red)` function  as the text inside the backtics is treated as a string and the `#raw()` function accepts strings only. I am aware that I could break this block into lines and color that part only, but its a bit time consuming.\n```typ\n`Enter a 24-hour time:` #text(fill: red)[`09:19`] \\\n`Closet departure times is 8:00, arriving at 10:16`\n``` \n\nThank you for reading",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 37,
      "score": 1642.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 766
    },
    {
      "id": 5573,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-13T08:42:09.650Z",
      "updated_at": "2024-11-13T08:43:27.393Z",
      "cooked": "<p>Hello,</p>\n<p>Raw‚Äôs highlighting is set within the compiler. The only way to style it according to custom needs, would be to write a <a href=\"https://typst.app/docs/reference/text/raw/#definitions-line:~:text=syntaxes,-str\">theme file</a>.</p>\n<p>If you are trying to copy raw‚Äôs font, you may want to try using a Sans Serif Font, e.g., DejaVu Sans Mono.</p>\n<p>A quick hack is to use <code>lang: \"c\"</code>.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/d/db771b23d48bb9167a75e55471e4b0164e59b826.png\" data-download-href=\"https://forum.typst.app/uploads/default/db771b23d48bb9167a75e55471e4b0164e59b826\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/d/db771b23d48bb9167a75e55471e4b0164e59b826_2_690x300.png\" alt=\"image\" data-base62-sha1=\"vjtKt2mgkDgLo9HS7WBR4qb8Wzk\" width=\"690\" height=\"300\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/d/db771b23d48bb9167a75e55471e4b0164e59b826_2_690x300.png, https://forum.typst.app/uploads/default/original/2X/d/db771b23d48bb9167a75e55471e4b0164e59b826.png 1.5x, https://forum.typst.app/uploads/default/original/2X/d/db771b23d48bb9167a75e55471e4b0164e59b826.png 2x\" data-dominant-color=\"F6F6F6\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">886√ó386 55 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let s = \"Enter a 24-hour time: 09:19\nCloset departure time is 8:00, arriving at 10:16\"\n#let r = raw(s, lang: \"c\")\n\n#repr(r)\n\n#r\n\n#s\n\n#text(font: \"DejaVu Sans Mono\", size: 0.8em,  s)\n</code></pre>\n<p>Then you can use text‚Äôs styling to have colored times!</p>",
      "raw": "Hello,\n\nRaw's highlighting is set within the compiler. The only way to style it according to custom needs, would be to write a [theme file](https://typst.app/docs/reference/text/raw/#definitions-line:~:text=syntaxes,-str).\n\nIf you are trying to copy raw's font, you may want to try using a Sans Serif Font, e.g., DejaVu Sans Mono.\n\nA quick hack is to use `lang: \"c\"`.\n\n![image|690x300](upload://vjtKt2mgkDgLo9HS7WBR4qb8Wzk.png)\n```typst\n#let s = \"Enter a 24-hour time: 09:19\nCloset departure time is 8:00, arriving at 10:16\"\n#let r = raw(s, lang: \"c\")\n\n#repr(r)\n\n#r\n\n#s\n\n#text(font: \"DejaVu Sans Mono\", size: 0.8em,  s)\n```\n\nThen you can use text's styling to have colored times!",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 26.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 5583,
      "post_number": 3,
      "username": "sjfhsjfh",
      "name": "sjfhsjfh",
      "created_at": "2024-11-13T11:57:49.645Z",
      "updated_at": "2024-11-13T11:57:49.645Z",
      "cooked": "<p>Maybe you could try using regex to specify what you want exactly:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show regex(\"\\d{1,2}:\\d{2}\"): set text(fill: red)\n\n``\nEnter a 24-hour time: 09:19\nCloset departure time is 8:00, arriving at 10:16\n``\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/8/891d35a637441d7eda514043fd1ab90bef44aef2.png\" alt=\"Result\" data-base62-sha1=\"jyXZFtDc0gdyeRoms4PUU9oLHP4\" width=\"464\" height=\"64\"></p>",
      "raw": "Maybe you could try using regex to specify what you want exactly:\n\n```typ\n#show regex(\"\\d{1,2}:\\d{2}\"): set text(fill: red)\n\n``\nEnter a 24-hour time: 09:19\nCloset departure time is 8:00, arriving at 10:16\n``\n```\n\n![Result|464x64](upload://jyXZFtDc0gdyeRoms4PUU9oLHP4.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 15.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 120
    },
    {
      "id": 5850,
      "post_number": 4,
      "username": "Hasan",
      "name": "Hasan",
      "created_at": "2024-11-19T21:44:44.323Z",
      "updated_at": "2024-11-19T21:44:44.323Z",
      "cooked": "<p>Thank you! I think my best bet is to use a mono-spaced font, so I can color parts of text based on my likings, since it isn‚Äôt about numbers. I want to color that part because in context it is inputed by user. Anyhow, if I want to use this method i.e. just using a mono-spaced font, can I make the text pre-formatted?</p>",
      "raw": "Thank you! I think my best bet is to use a mono-spaced font, so I can color parts of text based on my likings, since it isn't about numbers. I want to color that part because in context it is inputed by user. Anyhow, if I want to use this method i.e. just using a mono-spaced font, can I make the text pre-formatted?",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 19.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 766
    },
    {
      "id": 5854,
      "post_number": 5,
      "username": "sjfhsjfh",
      "name": "sjfhsjfh",
      "created_at": "2024-11-20T05:29:25.767Z",
      "updated_at": "2024-11-20T05:33:53.312Z",
      "cooked": "<h2><a name=\"p-5854-using-raw-content-1\" class=\"anchor\" href=\"#p-5854-using-raw-content-1\"></a>Using <code>raw</code> content</h2>\n<p>Mark the preferred part with a <code>label</code>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show &lt;user-input&gt;: set text(fill: red)\n\n`Enter a 24-hour time:` `09:19` &lt;user-input&gt; \\\n\n`Closet departure times is 8:00, arriving at 10:16`\n</code></pre>\n<p>If you would like to use an external text, replace the fixed <code>raw</code> block (<code> `09:19` &lt;user-input&gt;</code>) with <code>#raw(input-text, block: false) &lt;user-input&gt;</code>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show &lt;user-input&gt;: set text(fill: red)\n\n#let text-input = \"09:19\"\n\n`Enter a 24-hour time:` #raw(text-input, block: false) &lt;user-input&gt; \\\n\n`Closet departure times is 8:00, arriving at 10:16`\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/5/5c9d5e7d4a81bd1e7db0421a4848c343dd34573e.png\" data-download-href=\"https://forum.typst.app/uploads/default/5c9d5e7d4a81bd1e7db0421a4848c343dd34573e\" title=\"Result\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/5/5c9d5e7d4a81bd1e7db0421a4848c343dd34573e_2_690x104.png\" alt=\"Result\" data-base62-sha1=\"ddj5wckAMcpyxYEzcWyFRZNoevk\" width=\"690\" height=\"104\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/5/5c9d5e7d4a81bd1e7db0421a4848c343dd34573e_2_690x104.png, https://forum.typst.app/uploads/default/original/2X/5/5c9d5e7d4a81bd1e7db0421a4848c343dd34573e.png 1.5x, https://forum.typst.app/uploads/default/original/2X/5/5c9d5e7d4a81bd1e7db0421a4848c343dd34573e.png 2x\" data-dominant-color=\"F3F2F2\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Result</span><span class=\"informations\">881√ó133 11.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<h2><a name=\"p-5854-simply-markup-mode-2\" class=\"anchor\" href=\"#p-5854-simply-markup-mode-2\"></a>Simply Markup Mode</h2>\n<p>However, if you just want to use a mono-spaced font, then you should make a function to fill the text in different colors for simplicity.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set text(font: \"DejaVu Sans Mono\")\n\n#let user-input(s) = text(fill: red, s)\n\nEnter a 24-hour time: #user-input[09:19] \\\nCloset departure time is 8:00, arriving at 10:16\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/8/8de58ef81e428209a4bf46314f37e00d7abbb19f.png\" alt=\"Result\" data-base62-sha1=\"kfh9iXInjX6n1F9ijI01S0mp8Rh\" width=\"618\" height=\"104\"></p>",
      "raw": "## Using `raw` content\n\nMark the preferred part with a `label`:\n\n```typ\n#show <user-input>: set text(fill: red)\n\n`Enter a 24-hour time:` `09:19` <user-input> \\\n\n`Closet departure times is 8:00, arriving at 10:16`\n```\n\nIf you would like to use an external text, replace the fixed `raw` block (`` `09:19` <user-input>``) with `#raw(input-text, block: false) <user-input>`.\n\n```typ\n#show <user-input>: set text(fill: red)\n\n#let text-input = \"09:19\"\n\n`Enter a 24-hour time:` #raw(text-input, block: false) <user-input> \\\n\n`Closet departure times is 8:00, arriving at 10:16`\n```\n\n![Result|690x104](upload://ddj5wckAMcpyxYEzcWyFRZNoevk.png)\n\n## Simply Markup Mode\n\nHowever, if you just want to use a mono-spaced font, then you should make a function to fill the text in different colors for simplicity.\n\n```typ\n#set text(font: \"DejaVu Sans Mono\")\n\n#let user-input(s) = text(fill: red, s)\n\nEnter a 24-hour time: #user-input[09:19] \\\nCloset departure time is 8:00, arriving at 10:16\n```\n![Result|618x104](upload://kfh9iXInjX6n1F9ijI01S0mp8Rh.png)",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 20,
      "score": 48.8,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 120
    }
  ],
  "scraped_at": "2025-06-10T09:55:04.111707"
}
{
  "topic_metadata": {
    "id": 1691,
    "title": "How to pagebreak before an heading, only if a certain condition is achieved?",
    "slug": "how-to-pagebreak-before-an-heading-only-if-a-certain-condition-is-achieved",
    "posts_count": 18,
    "created_at": "2024-11-12T16:48:45.233Z",
    "last_posted_at": "2025-04-14T08:29:50.013Z",
    "views": 918,
    "like_count": 35,
    "reply_count": 7,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 7,
    "accepted_answer_username": "Xodarap",
    "tags": [
      "scripting",
      "layout"
    ],
    "category_id": 5,
    "participant_count": 7,
    "word_count": 1910
  },
  "posts": [
    {
      "id": 5549,
      "post_number": 1,
      "username": "Nasmevka",
      "name": "Thomas Teixeira",
      "created_at": "2024-11-12T16:48:45.467Z",
      "updated_at": "2025-04-26T20:21:09.702Z",
      "cooked": "<p>Hi !<br>\nNew user of Typst, so far it‚Äôs sooo good. I really wish it was a thing when I was going through uni ahah.</p>\n<hr>\n<p>I‚Äôm trying to add a <code>pagebreak</code> before every <code>heading(level: 1)</code>, but only if they are below half the page.</p>\n<p>Adding a pagebreak is easy with :</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">show heading.where(level: 1, outlined: true): it =&gt; {\n\tpagebreak()\n\tit\n}\n</code></pre>\n<p>But when trying to add a little logic, I keep getting redundancy errors.</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">show heading.where(level: 1, outlined: true): it =&gt; {\n\tif it.location().position().y &gt; page.height * .5 {\n\t\tpagebreak()\n\t}\n\tit\n}\n</code></pre>\n<p>And I think I understand why (feel free to explain either way :)) ), but what I don‚Äôt understand is :</p>\n<ul>\n<li>Why adding the line <code>v(0pt)</code> above the <code>pagebreak</code> fixes the redundancy error ? (afterward, the outline is garbage, containing the wrong page number)</li>\n<li>How can I fix this issue without a hacky trick, if it‚Äôs even possible.</li>\n</ul>\n<hr>\n<p><em>About the solution I chose</em><br>\nI choose another question as the solution (<a href=\"https://forum.typst.app/t/why-do-i-need-state-for-some-here-some-specific-show-rules/1784\">this one</a> from <a class=\"mention\" href=\"/u/xodarap\">@Xodarap</a>), since they are both extremely related and <a class=\"mention\" href=\"/u/xodarap\">@Xodarap</a> received answers are interesting and a good way to learn more how Typst work.</p>",
      "raw": "Hi !\nNew user of Typst, so far it's sooo good. I really wish it was a thing when I was going through uni ahah.\n\n___\n\nI'm trying to add a `pagebreak` before every `heading(level: 1)`, but only if they are below half the page.\n\nAdding a pagebreak is easy with : \n```typc\nshow heading.where(level: 1, outlined: true): it => {\n\tpagebreak()\n\tit\n}\n```\n\nBut when trying to add a little logic, I keep getting redundancy errors.\n```typc\nshow heading.where(level: 1, outlined: true): it => {\n\tif it.location().position().y > page.height * .5 {\n\t\tpagebreak()\n\t}\n\tit\n}\n```\nAnd I think I understand why (feel free to explain either way :)) ), but what I don't understand is : \n- Why adding the line `v(0pt)` above the `pagebreak` fixes the redundancy error ? (afterward, the outline is garbage, containing the wrong page number)\n- How can I fix this issue without a hacky trick, if it's even possible.\n\n---\n*About the solution I chose*\nI choose another question as the solution ([this one](https://forum.typst.app/t/why-do-i-need-state-for-some-here-some-specific-show-rules/1784) from @Xodarap), since they are both extremely related and @Xodarap received answers are interesting and a good way to learn more how Typst work.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 106,
      "score": 2436.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 796
    },
    {
      "id": 5574,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-13T09:05:56.942Z",
      "updated_at": "2024-11-13T09:08:27.407Z",
      "cooked": "<p>Hello and welcome!</p>\n<p>If your error is</p>\n<pre data-code-wrap=\"shell\"><code class=\"lang-shell\">warning: layout did not converge within 5 attempts\n = hint: check if any states or queries are updating themselves\n</code></pre>\n<p>This is normal, do not panic.</p>\n<p>Let‚Äôs start with a simple question: if your heading was to be before the pagebreak, do you think you would get the same error? The answer is <em>no</em>.</p>\n<p>What you wrote diverges in an infinite loop:</p>\n<ul>\n<li>You add a pagebreak if the heading is halfway through the page by comparing to the heading element‚Äôs y position</li>\n<li>You add the heading itself.</li>\n<li>Backtracking, the heading‚Äôs position has ‚Ä¶ changed!</li>\n<li>Typst tries to resolve this layout, but cannot do it within 5 attempts, hence the error, and you probably don‚Äôt have the result you hoped for.</li>\n</ul>\n<p>Now, how do you actually write this condition? You have to use an element that does not move with your pagebreak. The simplest way is to add a <a href=\"https://typst.app/docs/reference/introspection/metadata/\"><code>metadata</code></a> element. By querying that element‚Äôs position instead, you make sure you don‚Äôt have any ‚Äúloops‚Äù <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading.where(level: 1, outlined: true): it =&gt; {\n  let h1 = query(metadata.where(value: \"foo\").before(here()))  \n  if h1.len() != 0 and h1.first().location().position().y &gt; page.height * .5 {\n    pagebreak()\n  }\n  it\n}\n\n= A\n\n#lorem(500)\n\n#metadata(\"foo\")\n= B\n</code></pre>\n<p>For additional reading, you might want to take a look at the following threads:</p>\n<ul>\n<li><a href=\"https://forum.typst.app/t/how-to-create-a-pagebreak-before-every-depth-1-heading-except-for-the-outline/904\" class=\"inline-onebox\">How to create a pagebreak before every depth 1 heading except for the outline?</a></li>\n<li><a href=\"https://forum.typst.app/t/how-to-put-first-order-headings-start-on-odd-numbered-pages/1564/2\" class=\"inline-onebox\">How to put first-order headings start on odd-numbered pages? - #2 by Eric</a></li>\n</ul>",
      "raw": "Hello and welcome!\n\nIf your error is \n```shell\nwarning: layout did not converge within 5 attempts\n = hint: check if any states or queries are updating themselves\n```\nThis is normal, do not panic.\n\nLet's start with a simple question: if your heading was to be before the pagebreak, do you think you would get the same error? The answer is _no_. \n\nWhat you wrote diverges in an infinite loop:\n- You add a pagebreak if the heading is halfway through the page by comparing to the heading element's y position\n- You add the heading itself.\n- Backtracking, the heading's position has ... changed!\n- Typst tries to resolve this layout, but cannot do it within 5 attempts, hence the error, and you probably don't have the result you hoped for.\n\nNow, how do you actually write this condition? You have to use an element that does not move with your pagebreak. The simplest way is to add a [`metadata`](https://typst.app/docs/reference/introspection/metadata/) element. By querying that element's position instead, you make sure you don't have any \"loops\" :slight_smile: \n\n```typ\n#show heading.where(level: 1, outlined: true): it => {\n  let h1 = query(metadata.where(value: \"foo\").before(here()))  \n  if h1.len() != 0 and h1.first().location().position().y > page.height * .5 {\n    pagebreak()\n  }\n  it\n}\n\n= A\n\n#lorem(500)\n\n#metadata(\"foo\")\n= B\n```\n\nFor additional reading, you might want to take a look at the following threads:\n- https://forum.typst.app/t/how-to-create-a-pagebreak-before-every-depth-1-heading-except-for-the-outline/904\n- https://forum.typst.app/t/how-to-put-first-order-headings-start-on-odd-numbered-pages/1564/2",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 93,
      "score": 68.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 5581,
      "post_number": 3,
      "username": "Nasmevka",
      "name": "Thomas Teixeira",
      "created_at": "2024-11-13T10:24:55.721Z",
      "updated_at": "2024-11-13T10:24:55.721Z",
      "cooked": "<p>Thank you so much for your answer.<br>\nSo I did understand correctly why the warning was shown.</p>\n<p>Sadly, that mean I cannot achieve what I want without a manual intervention ?<br>\nIf the only way to <code>pagebreak</code> after mid-page is to use a metadata tag before every heading, I do think the best solution is to just write the whole document and manually add <code>pagebreak</code> at the end.</p>",
      "raw": "Thank you so much for your answer.\nSo I did understand correctly why the warning was shown.\n\nSadly, that mean I cannot achieve what I want without a manual intervention ? \nIf the only way to `pagebreak` after mid-page is to use a metadata tag before every heading, I do think the best solution is to just write the whole document and manually add `pagebreak` at the end.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 88,
      "score": 47.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 796
    },
    {
      "id": 5587,
      "post_number": 4,
      "username": "sjfhsjfh",
      "name": "sjfhsjfh",
      "created_at": "2024-11-13T15:44:12.468Z",
      "updated_at": "2024-11-13T15:44:12.468Z",
      "cooked": "<p>I think the point in this case is that where is <code>here()</code> exactly calculated. I‚Äôm not sure since I did not read the source code, but I made an alternative <code>my-location</code> to make it work:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let my-location = state(\"my-location\", (:))\n\n#let smartbreak(percentage) = (\n  context {\n    if my-location.get().y &gt; page.height * (100% - percentage) {\n      pagebreak()\n    }\n  }\n)\n\n#show heading.where(level: 1, outlined: true): it =&gt; {\n  context my-location.update(here().position())\n  smartbreak(50%)\n  it\n}\n</code></pre>\n<p>And the outline should be working properly using this impl.</p>\n<p>However the compiler (Tinymist) is still telling me the layout does not converge in 5 attempts on may laptop, but not on another device. This is kinda weird and I‚Äôm not sure is this an issue about Tinymist or Typst. <img src=\"https://forum.typst.app/images/emoji/apple/grin.png?v=12\" title=\":grin:\" class=\"emoji\" alt=\":grin:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "I think the point in this case is that where is `here()` exactly calculated. I'm not sure since I did not read the source code, but I made an alternative `my-location` to make it work:\n\n```typ\n#let my-location = state(\"my-location\", (:))\n\n#let smartbreak(percentage) = (\n  context {\n    if my-location.get().y > page.height * (100% - percentage) {\n      pagebreak()\n    }\n  }\n)\n\n#show heading.where(level: 1, outlined: true): it => {\n  context my-location.update(here().position())\n  smartbreak(50%)\n  it\n}\n```\n\nAnd the outline should be working properly using this impl.\n\nHowever the compiler (Tinymist) is still telling me the layout does not converge in 5 attempts on may laptop, but not on another device. This is kinda weird and I'm not sure is this an issue about Tinymist or Typst. :grin:",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 87,
      "score": 107.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 120
    },
    {
      "id": 5680,
      "post_number": 5,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2024-11-15T19:13:23.739Z",
      "updated_at": "2024-11-16T18:03:56.970Z",
      "cooked": "<p>I am very interested why this solution works and the original in the question does not.</p>\n<details>\n<summary>\nWhy doesn't this work?</summary>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#show heading.where(level: 1, outlined: true): it =&gt; {\n  context if here().position().y &gt; page.height * 50% {\n    pagebreak()\n  }\n  it\n}\n</code></pre>\n</details>\n<p>They seem very similar. The only difference is that the original uses <code>it.location()</code> and this one uses <code>here()</code> and a state. I think an explanation of this phenomenon would provide valuable insights about typst‚Äôs location handling or probably the state machinery.</p>\n<p>EDIT: or maybe I just don‚Äôt understand <code>show</code> rules.</p>",
      "raw": "I am very interested why this solution works and the original in the question does not.\n\n[details=\"Why doesn't this work?\"]\n```typst\n#show heading.where(level: 1, outlined: true): it => {\n  context if here().position().y > page.height * 50% {\n    pagebreak()\n  }\n  it\n}\n```\n[/details]\n\n\nThey seem very similar. The only difference is that the original uses `it.location()` and this one uses `here()` and a state. I think an explanation of this phenomenon would provide valuable insights about typst's location handling or probably the state machinery.\n\nEDIT: or maybe I just don't understand `show` rules.",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 77,
      "score": 35.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 5765,
      "post_number": 6,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-18T07:50:15.911Z",
      "updated_at": "2024-11-18T07:50:15.911Z",
      "cooked": "<p>I think you have the correct understanding of show rules. <a class=\"mention\" href=\"/u/sjfhsjfh\">@sjfhsjfh</a> (thanks!) is using an independent state variable and updating it outside the context expression, which is probably why it works. It ‚Äúforces‚Äù the hand of the compiler to get the correct location in between the steps of getting the page height.</p>",
      "raw": "I think you have the correct understanding of show rules. @sjfhsjfh (thanks!) is using an independent state variable and updating it outside the context expression, which is probably why it works. It \"forces\" the hand of the compiler to get the correct location in between the steps of getting the page height.",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 71,
      "score": 29.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 5805,
      "post_number": 7,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2024-11-18T18:38:21.219Z",
      "updated_at": "2024-11-18T18:38:21.219Z",
      "cooked": "<p>As the original question is actually solved, but I have still open questions about why it works or rather why not, I opened a new question for this: <a href=\"https://forum.typst.app/t/why-do-i-need-state-for-some-here-some-specific-show-rules/1784\" class=\"inline-onebox\">Why do I need state for some (here some specific) show rules?</a></p>",
      "raw": "As the original question is actually solved, but I have still open questions about why it works or rather why not, I opened a new question for this: https://forum.typst.app/t/why-do-i-need-state-for-some-here-some-specific-show-rules/1784",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 69,
      "score": 28.8,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 5830,
      "post_number": 8,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2024-11-19T12:58:49.470Z",
      "updated_at": "2024-11-19T12:59:29.550Z",
      "cooked": "<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let my-location = state(\"my-location\", (:))\n\n#let smartbreak(percentage) = (\n  context {\n    if my-location.get().y &gt; page.height * (100% - percentage) {\n      pagebreak()\n    }\n  }\n)\n\n#show heading.where(level: 1, outlined: true): it =&gt; {\n  context my-location.update(here().position())\n  smartbreak(50%)\n  it\n}\n\n= flora\n#lorem(400)\n\n= fauna\n#lorem(400)\n\n= ergo\n#lorem(400)\n</code></pre>\n<p>This example shows that <a class=\"mention\" href=\"/u/sjfhsjfh\">@sjfhsjfh</a> 's solutions actually doesn‚Äôt work. It was just coincidence that it is sufficient for the above example. (the online editor gives me the same warning, layout does not converge.)</p>\n<p><a class=\"mention\" href=\"/u/quachpas\">@quachpas</a> No offense, but this indicates that we both don‚Äôt really understand what is going on.</p>",
      "raw": "```typst\n#let my-location = state(\"my-location\", (:))\n\n#let smartbreak(percentage) = (\n  context {\n    if my-location.get().y > page.height * (100% - percentage) {\n      pagebreak()\n    }\n  }\n)\n\n#show heading.where(level: 1, outlined: true): it => {\n  context my-location.update(here().position())\n  smartbreak(50%)\n  it\n}\n\n= flora\n#lorem(400)\n\n= fauna\n#lorem(400)\n\n= ergo\n#lorem(400)\n```\n\nThis example shows that @sjfhsjfh 's solutions actually doesn't work. It was just coincidence that it is sufficient for the above example. (the online editor gives me the same warning, layout does not converge.)\n\n@quachpas No offense, but this indicates that we both don't really understand what is going on.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 68,
      "score": 178.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 5847,
      "post_number": 9,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2024-11-19T19:03:07.052Z",
      "updated_at": "2024-11-19T19:33:50.193Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/nasmevka\">@Nasmevka</a> a solution has finally been found <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>Credits go to <a class=\"mention\" href=\"/u/quachpas\">@quachpas</a> and <a class=\"mention\" href=\"/u/jbirnick\">@jbirnick</a></p>\n<p>I would recommend the following commands in your file:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">// threshold can be adjusted\n#let threshold = 50%\n// unique string so that you don't need to worry that other calls to metadata might interfere with this functionality\n#let abc = \"yfadslfkjlafjkwhtoii\"\n\n#show heading: it =&gt; {\n  metadata(abc)\n  context {\n    let m = query(metadata.where(value: abc).before(here())).last()\n    if m.location().position().y &gt; page.height * threshold {\n      pagebreak()\n    }\n  }\n  it\n}\n</code></pre>\n<p>That was a really nice question. Many lessons learned :)</p>",
      "raw": "@Nasmevka a solution has finally been found :slight_smile: \n\nCredits go to @quachpas and @jbirnick\n\nI would recommend the following commands in your file:\n```typst\n// threshold can be adjusted\n#let threshold = 50%\n// unique string so that you don't need to worry that other calls to metadata might interfere with this functionality\n#let abc = \"yfadslfkjlafjkwhtoii\"\n\n#show heading: it => {\n  metadata(abc)\n  context {\n    let m = query(metadata.where(value: abc).before(here())).last()\n    if m.location().position().y > page.height * threshold {\n      pagebreak()\n    }\n  }\n  it\n}\n```\n\nThat was a really nice question. Many lessons learned :)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 63,
      "score": 57.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 5853,
      "post_number": 10,
      "username": "sjfhsjfh",
      "name": "sjfhsjfh",
      "created_at": "2024-11-20T05:15:29.049Z",
      "updated_at": "2024-11-20T05:15:29.049Z",
      "cooked": "<p>It does work, the layout converges but not in 5 attempts. I guess it‚Äôs better to have a compile option to specify the maximum attempts. BTW, your solution generates the same warning as the count of heading increases.</p>",
      "raw": "It does work, the layout converges but not in 5 attempts. I guess it's better to have a compile option to specify the maximum attempts. BTW, your solution generates the same warning as the count of heading increases.",
      "reply_to_post_number": 8,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 2,
      "reads": 57,
      "score": 71.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 120
    },
    {
      "id": 5857,
      "post_number": 11,
      "username": "jbirnick",
      "name": "Johann Birnick",
      "created_at": "2024-11-20T06:05:14.095Z",
      "updated_at": "2024-11-20T16:30:17.026Z",
      "cooked": "<p>Yeah good point, the number of iterations that this needs grows linearly with the number of headings. That‚Äôs very bad, making it unusable in practice.</p>\n<p>It‚Äôs because say in iteration 2 one heading gets fixed. This moves all the content which comes later. So it introduces new bad headings. But those can only be fixed in iteration 3, and moving them introduces new bad headings, which can only be fixed in iteration 4, and so on.</p>\n<p>Unfortunately, I think this problem is <em>unavoidable</em> with the current layout engine. (Because with <code>context</code> you can only ever look at past iterations, never the current iteration, so you can basically only fix one heading per iteration.)</p>\n<p>You can decrease the number of iterations needed by:</p>\n<ul>\n<li>making the threshold closer to 100% (because then less headings need to be fixed) (EDIT: actually this might not be fully accurate)</li>\n<li>having headings on e.g. the highest level <em>always</em> make a <code>pagebreak</code>, so that fixing the lower level headings basically only moves the subsequent content <em>within the current chapter</em> (and then make the chapters not too long)</li>\n</ul>",
      "raw": "Yeah good point, the number of iterations that this needs grows linearly with the number of headings. That's very bad, making it unusable in practice.\n\nIt's because say in iteration 2 one heading gets fixed. This moves all the content which comes later. So it introduces new bad headings. But those can only be fixed in iteration 3, and moving them introduces new bad headings, which can only be fixed in iteration 4, and so on.\n\nUnfortunately, I think this problem is _unavoidable_ with the current layout engine. (Because with `context` you can only ever look at past iterations, never the current iteration, so you can basically only fix one heading per iteration.)\n\nYou can decrease the number of iterations needed by:\n\n- making the threshold closer to 100% (because then less headings need to be fixed) (EDIT: actually this might not be fully accurate)\n- having headings on e.g. the highest level _always_ make a `pagebreak`, so that fixing the lower level headings basically only moves the subsequent content _within the current chapter_ (and then make the chapters not too long)",
      "reply_to_post_number": 10,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 59,
      "score": 41.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 218
    },
    {
      "id": 5858,
      "post_number": 12,
      "username": "jbirnick",
      "name": "Johann Birnick",
      "created_at": "2024-11-20T06:15:14.067Z",
      "updated_at": "2024-11-20T06:15:14.067Z",
      "cooked": "<p>This is a perfect example where a ‚Äúlinear‚Äù layout engine (like I think TeX employs it, maybe) that goes through the document from ‚Äústart to finish‚Äù would be desirable. I think your heading thing is easily implementable in TeX with only a single iteration basically. A similar application are counters, a topic that I thought about a lot.</p>\n<p>But Typst layout engine works differently, and also has advantages, as Laurenz was pointing out to me. I hope to understand it at some point and then I can maybe also see if it‚Äôs possible to find a solution to such problems.</p>",
      "raw": "This is a perfect example where a \"linear\" layout engine (like I think TeX employs it, maybe) that goes through the document from \"start to finish\" would be desirable. I think your heading thing is easily implementable in TeX with only a single iteration basically. A similar application are counters, a topic that I thought about a lot.\n\nBut Typst layout engine works differently, and also has advantages, as Laurenz was pointing out to me. I hope to understand it at some point and then I can maybe also see if it's possible to find a solution to such problems.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 58,
      "score": 56.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 218
    },
    {
      "id": 5889,
      "post_number": 13,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2024-11-20T10:52:30.225Z",
      "updated_at": "2024-11-20T10:52:30.225Z",
      "cooked": "<p>How do you know that it works, but not in 5 attempts? Have you tried it with more attempts? (How do you do that :))</p>\n<p>I‚Äôm sorry if my accusation was wrong and your solution actually does work. My reasoning for that is bsed on <a class=\"mention\" href=\"/u/jbirnick\">@jbirnick</a>‚Äôs solution from the other topic: <a href=\"https://forum.typst.app/t/why-do-i-need-state-for-some-here-some-specific-show-rules/1784/2\" class=\"inline-onebox\">Why do I need state for some (here some specific) show rules? - #2 by jbirnick</a></p>\n<p>The way I understood it, it made a lot of sense to me. But maybe your solution actually works and (I understood it wrong or <a class=\"mention\" href=\"/u/jbirnick\">@jbirnick</a> is just wrong).</p>\n<p>Would be nice to have that clarified as well, but as it seems to me we‚Äôd need a compilation with more than 5 attempts for that.</p>",
      "raw": "How do you know that it works, but not in 5 attempts? Have you tried it with more attempts? (How do you do that :))\n\nI'm sorry if my accusation was wrong and your solution actually does work. My reasoning for that is bsed on @jbirnick's solution from the other topic: https://forum.typst.app/t/why-do-i-need-state-for-some-here-some-specific-show-rules/1784/2\n\nThe way I understood it, it made a lot of sense to me. But maybe your solution actually works and (I understood it wrong or @jbirnick is just wrong).\n\nWould be nice to have that clarified as well, but as it seems to me we'd need a compilation with more than 5 attempts for that.",
      "reply_to_post_number": 10,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 59,
      "score": 21.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 5891,
      "post_number": 14,
      "username": "sjfhsjfh",
      "name": "sjfhsjfh",
      "created_at": "2024-11-20T11:11:11.646Z",
      "updated_at": "2024-11-20T11:11:11.646Z",
      "cooked": "<p>Typst is open-source so you just simply modify the limit and compile a custom one. I‚Äôm pretty sure this problem cannot be avoided since the requirement requires multiple iterations to work. Adding a CLI arg would be convenient for such demand.</p>",
      "raw": "Typst is open-source so you just simply modify the limit and compile a custom one. I'm pretty sure this problem cannot be avoided since the requirement requires multiple iterations to work. Adding a CLI arg would be convenient for such demand.",
      "reply_to_post_number": 13,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 59,
      "score": 41.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 120
    },
    {
      "id": 5915,
      "post_number": 15,
      "username": "jbirnick",
      "name": "Johann Birnick",
      "created_at": "2024-11-20T17:09:13.312Z",
      "updated_at": "2024-11-20T17:09:13.312Z",
      "cooked": "<p>If anyone is interested, here is a ‚Äúnatural‚Äù document which doesn‚Äôt converge in 5 iterations:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// threshold can be adjusted\n#let threshold = 50%\n// unique string so that you don't need to worry that other calls to metadata might interfere with this functionality\n#let abc = \"yfadslfkjlafjkwhtoii\"\n\n#show heading: it =&gt; {\n  metadata(abc)\n  context {\n    let m = query(metadata.where(value: abc).before(here())).last()\n    if m.location().position().y &gt; page.height * threshold {\n      pagebreak()\n    }\n  }\n  it\n}\n\n#let parlengths = (597, 557, 560, 464, 676, 622, 241, 621, 627, 487, 234, 616, 536)\n\n#for length in parlengths {\n  heading(\"some heading\")\n  lorem(length)\n}\n</code></pre>",
      "raw": "If anyone is interested, here is a \"natural\" document which doesn't converge in 5 iterations:\n\n```typ\n// threshold can be adjusted\n#let threshold = 50%\n// unique string so that you don't need to worry that other calls to metadata might interfere with this functionality\n#let abc = \"yfadslfkjlafjkwhtoii\"\n\n#show heading: it => {\n  metadata(abc)\n  context {\n    let m = query(metadata.where(value: abc).before(here())).last()\n    if m.location().position().y > page.height * threshold {\n      pagebreak()\n    }\n  }\n  it\n}\n\n#let parlengths = (597, 557, 560, 464, 676, 622, 241, 621, 627, 487, 234, 616, 536)\n\n#for length in parlengths {\n  heading(\"some heading\")\n  lorem(length)\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 58,
      "score": 31.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 218
    },
    {
      "id": 5972,
      "post_number": 16,
      "username": "Nasmevka",
      "name": "Thomas Teixeira",
      "created_at": "2024-11-21T16:23:02.152Z",
      "updated_at": "2024-11-21T16:23:02.152Z",
      "cooked": "<p>Thank you everyone for all those insights !<br>\nI‚Äôm sad there isn‚Äôt a ‚Äúfinal‚Äù (and by that I mean working with every document) solution but will mark the metadata trick as the solution for now.</p>\n<p>Thanks again !</p>",
      "raw": "Thank you everyone for all those insights !\nI'm sad there isn't a \"final\" (and by that I mean working with every document) solution but will mark the metadata trick as the solution for now.\n\nThanks again !",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 56,
      "score": 31.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 796
    },
    {
      "id": 6005,
      "post_number": 17,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2024-11-23T11:59:59.475Z",
      "updated_at": "2024-11-23T11:59:59.475Z",
      "cooked": "<p>As it doesn‚Äôt seem possible (yet) to do that with a conditional <code>pagebreak</code>, I propose a very different solution, whose idea <a href=\"https://gist.github.com/PgBiel/2976c9d0ed5638ef57633ce7233928ea\" rel=\"noopener nofollow ugc\">originally</a> came from <a class=\"mention\" href=\"/u/pgbiel\">@PgBiel</a> as a workaround for when <code>sticky</code> blocks weren‚Äôt a thing yet.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading: it =&gt; {\n  let threshold = 50%\n  block(breakable: false, height: threshold, spacing: 0pt)\n  v(-threshold)\n  it\n}\n</code></pre>\n<p>The block basically reserves the space that should be available to place the heading in. If that space isn‚Äôt available on the current page, it is moved to the next page. The negative vertical spacing then ensures that the block doesn‚Äôt actually take up the reserved space.</p>",
      "raw": "As it doesn't seem possible (yet) to do that with a conditional `pagebreak`, I propose a very different solution, whose idea [originally](https://gist.github.com/PgBiel/2976c9d0ed5638ef57633ce7233928ea) came from @PgBiel as a workaround for when `sticky` blocks weren't a thing yet.\n\n```typ\n#show heading: it => {\n  let threshold = 50%\n  block(breakable: false, height: threshold, spacing: 0pt)\n  v(-threshold)\n  it\n}\n```\n\nThe block basically reserves the space that should be available to place the heading in. If that space isn't available on the current page, it is moved to the next page. The negative vertical spacing then ensures that the block doesn't actually take up the reserved space.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 7,
      "reads": 59,
      "score": 161.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 11060,
      "post_number": 18,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-14T08:29:50.013Z",
      "updated_at": "2025-04-14T08:29:50.013Z",
      "cooked": "<p>I asked Eric on discord and he made this updated version (his work, not mine to be clear), which solved a problem I had with the first version of the negative space solution:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading: it =&gt; {\n  let threshold = 50%\n  block(breakable: false, height: threshold)\n  v(-threshold, weak: true)\n  it\n}\n</code></pre>\n<p>This works well in my template now, thank you!</p>\n<p>(The observed problem in the previous one: a heading at the start of the page was pushed down. The new version also has the nice property that it seems to leave my document unchanged if the threshold is <code>0cm</code> which is reassuring.</p>\n<p>I thought it was worth sharing the improvement in the same thread.)</p>",
      "raw": "I asked Eric on discord and he made this updated version (his work, not mine to be clear), which solved a problem I had with the first version of the negative space solution:\n\n```typ\n#show heading: it => {\n  let threshold = 50%\n  block(breakable: false, height: threshold)\n  v(-threshold, weak: true)\n  it\n}\n```\n\nThis works well in my template now, thank you!\n\n(The observed problem in the previous one: a heading at the start of the page was pushed down. The new version also has the nice property that it seems to leave my document unchanged if the threshold is `0cm` which is reassuring.\n\nI thought it was worth sharing the improvement in the same thread.)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 42,
      "score": 118.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    }
  ],
  "scraped_at": "2025-06-10T09:55:03.402445"
}
{
  "topic_metadata": {
    "id": 1694,
    "title": "How to fully control visualization of a glossary in glossarium?",
    "slug": "how-to-fully-control-visualization-of-a-glossary-in-glossarium",
    "posts_count": 8,
    "created_at": "2024-11-12T20:19:56.020Z",
    "last_posted_at": "2024-11-19T13:32:43.134Z",
    "views": 269,
    "like_count": 4,
    "reply_count": 6,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "glossarium"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 1023
  },
  "posts": [
    {
      "id": 5555,
      "post_number": 1,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2024-11-12T20:19:56.180Z",
      "updated_at": "2024-11-22T10:59:46.077Z",
      "cooked": "<p>Hello!</p>\n<p>I am using the package glossarium to define a nomenclature. I need to define other ‚Äúglossaries‚Äù later, such as ‚Äúacronyms‚Äù, but for now what I have is:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#import \"@preview/unify:0.6.0\": unit\n#import \"@preview/glossarium:0.5.1\": make-glossary, register-glossary, print-glossary, gls, glspl\n#show link: set text(fill: rgb(160,20,40))\n#show: make-glossary\n\n#let entry-list = (\n  // Physics Variables (Group A)\n  (\n    key: \"g\",\n    short: $g$,\n    long: \"Gravitational Constant\",\n    description: unit(\"meter per second squared\"),\n    group: \"Physics Variables\",\n  ),\n  (\n    key: \"H\",\n    short: $H$,\n    long: \"Wave height\",\n    description: unit(\"meter\"),\n    group: \"Physics Variables\",\n  ),\n  (\n    key: \"D\",\n    short: $D$,\n    long: \"Water depth\",\n    description: unit(\"meter\"),\n    group: \"Physics Variables\",\n  ),\n  (\n    key: \"lambda\",\n    short: $Œª$,\n    long: \"Wave length\",\n    description: unit(\"meter\"),\n    group: \"Physics Variables\",\n  ),\n  (\n    key: \"T\",\n    short: $T$,\n    long: \"Period\",\n    description: unit(\"second\"),\n    group: \"Physics Variables\",\n  ),\n\n  // SPH Variables (Group B)\n  (\n    key: \"delta-p\",\n    short: $Œî p$,\n    long: \"Initial particle distance. Also denoted as Dp or dp\",\n    description: unit(\"meter\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"h\",\n    short: $h$,\n    long: \"Smoothing length\",\n    description: unit(\"meter\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"c\",\n    short: $c$,\n    long: \"Speed of sound\",\n    description: unit(\"meter per second\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"V\",\n    short: $V$,\n    long: \"Volume\",\n    description: unit(\"meter cubed\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"rho\",\n    short: $œÅ$,\n    long: \"Density\",\n    description: unit(\"kg/m^3\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"p\",\n    short: $p$,\n    long: \"Pressure\",\n    description: unit(\"Pa\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"m\",\n    short: $m$,\n    long: \"Mass\",\n    description: unit(\"kg\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"u\",\n    short: $bold(u)$,\n    long: \"Velocity\",\n    description: unit(\"m/s\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"x\",\n    short: $bold(x)$,\n    long: \"Position\",\n    description: unit(\"meter\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"gamma\",\n    short: $Œì$,\n    long: \"Dissipation\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"omega\",\n    short: $Œ©$,\n    long: \"Domain\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"domega-xi\",\n    short: $d Œ©_x_i$,\n    long: \"Volume of particle i at position \" + $bold(x)_i$,\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"omega-V\",\n    short: $‚àÇŒ©_V$,\n    long: \"Volume of support domain\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"omega-S\",\n    short: $‚àÇŒ©_S$,\n    long: \"Surface of support domain\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"W\",\n    short: $W$,\n    long: \"Smoothing Kernel\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"A\",\n    short: $A$,\n    long: \"Arbitrary property for SPH estimation\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"gamma-adiabatic\",\n    short: $Œ≥$,\n    long: \"Adiabatic Index\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"Pi\",\n    short: $Œ†$,\n    long: \"Modeled Viscosity\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"epsilon\",\n    short: $Œµ$,\n    long: \"Numerical constant used in artificial viscosity to avoid dividing by zero\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"kappa\",\n    short: $Œ∫$,\n    long: \"Scaling constant used to determine size of smoothing kernel radius\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"L2-norm\",\n    short: $||bold(x)_i - bold(x)_j||$,\n    long: [L#super[2]-norm],\n    description: [],\n    group: \"SPH Variables\",\n  ),\n)\n#register-glossary(entry-list)\n// Your document body\n#print-glossary(\n  show-all: true,\n entry-list\n)\n</code></pre>\n<p>It generates:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/2/2080f6b154ea6bc7cb5c93026253ebbd949216ca.png\" data-download-href=\"https://forum.typst.app/uploads/default/2080f6b154ea6bc7cb5c93026253ebbd949216ca\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/2/2080f6b154ea6bc7cb5c93026253ebbd949216ca_2_413x499.png\" alt=\"image\" data-base62-sha1=\"4DxA6GT0V8JweIqgRemsPe6iZFo\" width=\"413\" height=\"499\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/2/2080f6b154ea6bc7cb5c93026253ebbd949216ca_2_413x499.png, https://forum.typst.app/uploads/default/original/2X/2/2080f6b154ea6bc7cb5c93026253ebbd949216ca.png 1.5x, https://forum.typst.app/uploads/default/original/2X/2/2080f6b154ea6bc7cb5c93026253ebbd949216ca.png 2x\" data-dominant-color=\"F7F7F7\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">614√ó743 37 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>But I need it to generate  this:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/5/51ec2ba794c7d7c0a401c7d2a9a2e45f2cf5fc2e.png\" data-download-href=\"https://forum.typst.app/uploads/default/51ec2ba794c7d7c0a401c7d2a9a2e45f2cf5fc2e\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/5/51ec2ba794c7d7c0a401c7d2a9a2e45f2cf5fc2e_2_376x500.png\" alt=\"image\" data-base62-sha1=\"bGIFqgK3Cojby0STnOoGZfhwDWm\" width=\"376\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/5/51ec2ba794c7d7c0a401c7d2a9a2e45f2cf5fc2e_2_376x500.png, https://forum.typst.app/uploads/default/original/2X/5/51ec2ba794c7d7c0a401c7d2a9a2e45f2cf5fc2e.png 1.5x, https://forum.typst.app/uploads/default/original/2X/5/51ec2ba794c7d7c0a401c7d2a9a2e45f2cf5fc2e.png 2x\" data-dominant-color=\"FBFBFB\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">534√ó709 55.2 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>So basically I need to:</p>\n<ul>\n<li>Remove bold description text</li>\n<li>Set units to the right</li>\n<li>Sort entries such that entries with units go to the top for a neater look</li>\n</ul>\n<p>I think this should be possible, I am just very uncertain on how to overload show in this case</p>\n<p>Kind regards</p>",
      "raw": "Hello!\n\nI am using the package glossarium to define a nomenclature. I need to define other \"glossaries\" later, such as \"acronyms\", but for now what I have is:\n\n```typst\n#import \"@preview/unify:0.6.0\": unit\n#import \"@preview/glossarium:0.5.1\": make-glossary, register-glossary, print-glossary, gls, glspl\n#show link: set text(fill: rgb(160,20,40))\n#show: make-glossary\n\n#let entry-list = (\n  // Physics Variables (Group A)\n  (\n    key: \"g\",\n    short: $g$,\n    long: \"Gravitational Constant\",\n    description: unit(\"meter per second squared\"),\n    group: \"Physics Variables\",\n  ),\n  (\n    key: \"H\",\n    short: $H$,\n    long: \"Wave height\",\n    description: unit(\"meter\"),\n    group: \"Physics Variables\",\n  ),\n  (\n    key: \"D\",\n    short: $D$,\n    long: \"Water depth\",\n    description: unit(\"meter\"),\n    group: \"Physics Variables\",\n  ),\n  (\n    key: \"lambda\",\n    short: $Œª$,\n    long: \"Wave length\",\n    description: unit(\"meter\"),\n    group: \"Physics Variables\",\n  ),\n  (\n    key: \"T\",\n    short: $T$,\n    long: \"Period\",\n    description: unit(\"second\"),\n    group: \"Physics Variables\",\n  ),\n\n  // SPH Variables (Group B)\n  (\n    key: \"delta-p\",\n    short: $Œî p$,\n    long: \"Initial particle distance. Also denoted as Dp or dp\",\n    description: unit(\"meter\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"h\",\n    short: $h$,\n    long: \"Smoothing length\",\n    description: unit(\"meter\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"c\",\n    short: $c$,\n    long: \"Speed of sound\",\n    description: unit(\"meter per second\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"V\",\n    short: $V$,\n    long: \"Volume\",\n    description: unit(\"meter cubed\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"rho\",\n    short: $œÅ$,\n    long: \"Density\",\n    description: unit(\"kg/m^3\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"p\",\n    short: $p$,\n    long: \"Pressure\",\n    description: unit(\"Pa\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"m\",\n    short: $m$,\n    long: \"Mass\",\n    description: unit(\"kg\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"u\",\n    short: $bold(u)$,\n    long: \"Velocity\",\n    description: unit(\"m/s\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"x\",\n    short: $bold(x)$,\n    long: \"Position\",\n    description: unit(\"meter\"),\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"gamma\",\n    short: $Œì$,\n    long: \"Dissipation\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"omega\",\n    short: $Œ©$,\n    long: \"Domain\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"domega-xi\",\n    short: $d Œ©_x_i$,\n    long: \"Volume of particle i at position \" + $bold(x)_i$,\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"omega-V\",\n    short: $‚àÇŒ©_V$,\n    long: \"Volume of support domain\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"omega-S\",\n    short: $‚àÇŒ©_S$,\n    long: \"Surface of support domain\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"W\",\n    short: $W$,\n    long: \"Smoothing Kernel\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"A\",\n    short: $A$,\n    long: \"Arbitrary property for SPH estimation\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"gamma-adiabatic\",\n    short: $Œ≥$,\n    long: \"Adiabatic Index\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"Pi\",\n    short: $Œ†$,\n    long: \"Modeled Viscosity\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"epsilon\",\n    short: $Œµ$,\n    long: \"Numerical constant used in artificial viscosity to avoid dividing by zero\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"kappa\",\n    short: $Œ∫$,\n    long: \"Scaling constant used to determine size of smoothing kernel radius\",\n    description: [],\n    group: \"SPH Variables\",\n  ),\n  (\n    key: \"L2-norm\",\n    short: $||bold(x)_i - bold(x)_j||$,\n    long: [L#super[2]-norm],\n    description: [],\n    group: \"SPH Variables\",\n  ),\n)\n#register-glossary(entry-list)\n// Your document body\n#print-glossary(\n  show-all: true,\n entry-list\n)\n```\n\nIt generates:\n\n![image|413x499](upload://4DxA6GT0V8JweIqgRemsPe6iZFo.png)\n\nBut I need it to generate  this:\n\n![image|376x500](upload://bGIFqgK3Cojby0STnOoGZfhwDWm.png)\n\nSo basically I need to:\n\n* Remove bold description text\n* Set units to the right\n* Sort entries such that entries with units go to the top for a neater look\n\nI think this should be possible, I am just very uncertain on how to overload show in this case\n\nKind regards",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 39,
      "score": 1057.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    },
    {
      "id": 5575,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-13T09:33:58.331Z",
      "updated_at": "2024-11-13T09:34:39.592Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/ahmedsalih\">@AhmedSalih</a>,<br>\nthis would require many changes in the print-glossary arguments. I suggest to look at <code>user-print-glossary</code> to make it return a table instead!<br>\nA good start would be the following</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#print-glossary(\n  show-all: true,\n  user-print-glossary: (entries, groups, ..) =&gt; {\n    table(\n      columns: 3,\n      stroke: 0pt,\n      ..for group in groups {\n        (\n          table.cell(group, colspan: 3),\n          ..for entry in entries.filter(x =&gt; x.group == group) {\n            (\n              entry.short,\n              entry.long,\n              entry.description\n            )\n          }\n        )\n      }\n    )\n  },\n  entry-list\n)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/d/d358ac2fe607e6d85acd96d1de376203ee466afc.png\" data-download-href=\"https://forum.typst.app/uploads/default/d358ac2fe607e6d85acd96d1de376203ee466afc\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/d/d358ac2fe607e6d85acd96d1de376203ee466afc_2_430x499.png\" alt=\"image\" data-base62-sha1=\"u9EJ2szSfq3jP3Oz7s0AWR9EgmU\" width=\"430\" height=\"499\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/d/d358ac2fe607e6d85acd96d1de376203ee466afc_2_430x499.png, https://forum.typst.app/uploads/default/optimized/2X/d/d358ac2fe607e6d85acd96d1de376203ee466afc_2_645x748.png 1.5x, https://forum.typst.app/uploads/default/original/2X/d/d358ac2fe607e6d85acd96d1de376203ee466afc.png 2x\" data-dominant-color=\"F9F9F9\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">693√ó804 90.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Afterwards, depending on whether you need other features of glossarium, you would need to recover them in some way.</p>",
      "raw": "Hello @AhmedSalih,\nthis would require many changes in the print-glossary arguments. I suggest to look at `user-print-glossary` to make it return a table instead! \nA good start would be the following\n```typ\n#print-glossary(\n  show-all: true,\n  user-print-glossary: (entries, groups, ..) => {\n    table(\n      columns: 3,\n      stroke: 0pt,\n      ..for group in groups {\n        (\n          table.cell(group, colspan: 3),\n          ..for entry in entries.filter(x => x.group == group) {\n            (\n              entry.short,\n              entry.long,\n              entry.description\n            )\n          }\n        )\n      }\n    )\n  },\n  entry-list\n)\n```\n![image|430x499](upload://u9EJ2szSfq3jP3Oz7s0AWR9EgmU.png)\n\nAfterwards, depending on whether you need other features of glossarium, you would need to recover them in some way.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 33,
      "score": 46.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 5590,
      "post_number": 3,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2024-11-13T16:39:18.392Z",
      "updated_at": "2024-11-13T16:39:18.392Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"quachpas\" data-post=\"2\" data-topic=\"1694\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/q/662200/48.png\" class=\"avatar\"> quachpas:</div>\n<blockquote>\n<pre><code class=\"lang-auto\">#print-glossary(\n  show-all: true,\n  user-print-glossary: (entries, groups, ..) =&gt; {\n    table(\n      columns: 3,\n      stroke: 0pt,\n      ..for group in groups {\n        (\n          table.cell(group, colspan: 3),\n          ..for entry in entries.filter(x =&gt; x.group == group) {\n            (\n              entry.short,\n              entry.long,\n              entry.description\n            )\n          }\n        )\n      }\n    )\n  },\n  entry-list\n)\n</code></pre>\n</blockquote>\n</aside>\n<p>Thank you so much! I did not know it was so easy, I could not find that kind of example in the library. I am so happy right now, <code>typst</code>, has so much potential, so much opportunity in simplicity!</p>\n<p>I will try to modify it to match my needs exactly, but already so close.</p>\n<p>Kind regards</p>",
      "raw": "[quote=\"quachpas, post:2, topic:1694\"]\n```\n#print-glossary(\n  show-all: true,\n  user-print-glossary: (entries, groups, ..) => {\n    table(\n      columns: 3,\n      stroke: 0pt,\n      ..for group in groups {\n        (\n          table.cell(group, colspan: 3),\n          ..for entry in entries.filter(x => x.group == group) {\n            (\n              entry.short,\n              entry.long,\n              entry.description\n            )\n          }\n        )\n      }\n    )\n  },\n  entry-list\n)\n```\n[/quote]\n\nThank you so much! I did not know it was so easy, I could not find that kind of example in the library. I am so happy right now, `typst`, has so much potential, so much opportunity in simplicity!\n\nI will try to modify it to match my needs exactly, but already so close.\n\nKind regards",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 1,
      "reads": 25,
      "score": 35.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    },
    {
      "id": 5623,
      "post_number": 4,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-14T08:41:23.607Z",
      "updated_at": "2024-11-14T08:41:23.607Z",
      "cooked": "<p>You can also take a look at other packages. Searching for <a href=\"https://typst.app/universe/search?q=acro\">acro</a>, or <a href=\"https://typst.app/universe/search?q=glo\">glo</a> should give you some good results.</p>",
      "raw": "You can also take a look at other packages. Searching for [acro](https://typst.app/universe/search?q=acro), or [glo](https://typst.app/universe/search?q=glo) should give you some good results.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 9.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 5826,
      "post_number": 5,
      "username": "Vojtech_Liska",
      "name": "Vojtƒõch Li≈°ka",
      "created_at": "2024-11-19T11:10:07.709Z",
      "updated_at": "2024-11-19T11:10:07.709Z",
      "cooked": "<p>Hello, I tried just copy pasting this into typst.<br>\nWhen I try <span class=\"hashtag-raw\">#gls</span>(‚Äúg‚Äù) i gen an error.</p>\n<p>What do I do wrong?</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/e/e68f5f7e45e7ed5f2edb4451eb0f5b9f31f4a006.png\" data-download-href=\"https://forum.typst.app/uploads/default/e68f5f7e45e7ed5f2edb4451eb0f5b9f31f4a006\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/e/e68f5f7e45e7ed5f2edb4451eb0f5b9f31f4a006_2_690x266.png\" alt=\"image\" data-base62-sha1=\"wTCZAWPLK0UMq9UdEqeOkXYWpp4\" width=\"690\" height=\"266\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/e/e68f5f7e45e7ed5f2edb4451eb0f5b9f31f4a006_2_690x266.png, https://forum.typst.app/uploads/default/original/2X/e/e68f5f7e45e7ed5f2edb4451eb0f5b9f31f4a006.png 1.5x, https://forum.typst.app/uploads/default/original/2X/e/e68f5f7e45e7ed5f2edb4451eb0f5b9f31f4a006.png 2x\" data-dominant-color=\"24242D\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">878√ó339 54.2 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "Hello, I tried just copy pasting this into typst.\nWhen I try #gls(\"g\") i gen an error.\n\nWhat do I do wrong?\n\n![image|690x266](upload://wTCZAWPLK0UMq9UdEqeOkXYWpp4.png)",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 8.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 824
    },
    {
      "id": 5832,
      "post_number": 6,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-19T13:11:33.656Z",
      "updated_at": "2024-11-19T13:11:33.656Z",
      "cooked": "<p>Hello, can you show your entire code please?</p>",
      "raw": "Hello, can you show your entire code please?",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 8.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 5833,
      "post_number": 7,
      "username": "Vojtech_Liska",
      "name": "Vojtƒõch Li≈°ka",
      "created_at": "2024-11-19T13:26:15.014Z",
      "updated_at": "2024-11-19T13:26:15.014Z",
      "cooked": "<p>This should be minimum working example</p>\n<pre><code class=\"lang-auto\">#import \"@preview/unify:0.6.0\": unit\n#import \"@preview/glossarium:0.5.1\": make-glossary, register-glossary, print-glossary, gls, glspl\n#show link: set text(fill: rgb(160,20,40))\n#show: make-glossary\n\n#let entry-list = (\n  // Physics Variables (Group A)\n  (\n    key: \"g\",\n    short: $g$,\n    long: \"Gravitational Constant\",\n    description: unit(\"meter per second squared\"),\n    group: \"Physics Variables\",\n  ),\n\n)\n#register-glossary(entry-list)\n// Your document \n\n#gls(\"g\")\n\n#print-glossary(\n  show-all: true,\n  user-print-glossary: (entries, groups, ..) =&gt; {\n    table(\n      columns: 3,\n      stroke: 0pt,\n      ..for group in groups {\n        (\n          table.cell(group, colspan: 3),\n          ..for entry in entries.filter(x =&gt; x.group == group) {\n            (\n              entry.short,\n              entry.long,\n              entry.description\n            )\n          }\n        )\n      }\n    )\n  },\n  entry-list\n)\n</code></pre>",
      "raw": "This should be minimum working example\n\n```\n#import \"@preview/unify:0.6.0\": unit\n#import \"@preview/glossarium:0.5.1\": make-glossary, register-glossary, print-glossary, gls, glspl\n#show link: set text(fill: rgb(160,20,40))\n#show: make-glossary\n\n#let entry-list = (\n  // Physics Variables (Group A)\n  (\n    key: \"g\",\n    short: $g$,\n    long: \"Gravitational Constant\",\n    description: unit(\"meter per second squared\"),\n    group: \"Physics Variables\",\n  ),\n\n)\n#register-glossary(entry-list)\n// Your document \n\n#gls(\"g\")\n\n#print-glossary(\n  show-all: true,\n  user-print-glossary: (entries, groups, ..) => {\n    table(\n      columns: 3,\n      stroke: 0pt,\n      ..for group in groups {\n        (\n          table.cell(group, colspan: 3),\n          ..for entry in entries.filter(x => x.group == group) {\n            (\n              entry.short,\n              entry.long,\n              entry.description\n            )\n          }\n        )\n      }\n    )\n  },\n  entry-list\n)\n```",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 68.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 824
    },
    {
      "id": 5834,
      "post_number": 8,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-19T13:32:43.134Z",
      "updated_at": "2024-11-19T13:34:13.998Z",
      "cooked": "<p>Ah yes. That‚Äôs the thing with what I showed earlier. You have to implement the features of glossarium. The original function to print the glossary is a bit more complex.</p>\n<p>try with</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#print-glossary(\n  show-all: true,\n  user-print-glossary: (entries, groups, ..) =&gt; {\n    table(\n      columns: 3,\n      stroke: 0pt,\n      ..for group in groups {\n        (\n          table.cell(group, colspan: 3),\n          ..for entry in entries.filter(x =&gt; x.group == group) {\n            (\n              entry.short,\n              entry.long,\n              [\n                #figure(\n                  kind: \"glossarium_figure\", \n                  supplement: \"\",\n                  caption: entry.description,\n                )[]\n                #label(entry.key)\n                #figure(\n                  kind: \"glossarium_figure\", \n                  supplement: \"\",\n                )[]\n                #label(entry.key + \":pl\")\n              ]\n            )\n          }\n        )\n      }\n    )\n  },\n  entry-list\n)\n</code></pre>\n<p>instead</p>\n<p>There‚Äôs no ‚Äúeasy way‚Äù as of now to fully control the glossary. It‚Äôs a work in progress, however.</p>",
      "raw": "Ah yes. That's the thing with what I showed earlier. You have to implement the features of glossarium. The original function to print the glossary is a bit more complex.\n\ntry with\n```typ\n#print-glossary(\n  show-all: true,\n  user-print-glossary: (entries, groups, ..) => {\n    table(\n      columns: 3,\n      stroke: 0pt,\n      ..for group in groups {\n        (\n          table.cell(group, colspan: 3),\n          ..for entry in entries.filter(x => x.group == group) {\n            (\n              entry.short,\n              entry.long,\n              [\n                #figure(\n                  kind: \"glossarium_figure\", \n                  supplement: \"\",\n                  caption: entry.description,\n                )[]\n                #label(entry.key)\n                #figure(\n                  kind: \"glossarium_figure\", \n                  supplement: \"\",\n                )[]\n                #label(entry.key + \":pl\")\n              ]\n            )\n          }\n        )\n      }\n    )\n  },\n  entry-list\n)\n```\ninstead\n\nThere's no \"easy way\" as of now to fully control the glossary. It's a work in progress, however.",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 18.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    }
  ],
  "scraped_at": "2025-06-10T09:55:02.641737"
}
{
  "topic_metadata": {
    "id": 1695,
    "title": "Why do I receive an \"Unexpected argument\" error in anonymous function creater function?",
    "slug": "why-do-i-receive-an-unexpected-argument-error-in-anonymous-function-creater-function",
    "posts_count": 9,
    "created_at": "2024-11-12T20:33:21.554Z",
    "last_posted_at": "2024-11-15T05:27:04.388Z",
    "views": 409,
    "like_count": 1,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 8,
    "accepted_answer_username": "Xodarap",
    "tags": [
      "scripting",
      "numbering"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 1271
  },
  "posts": [
    {
      "id": 5556,
      "post_number": 1,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2024-11-12T20:33:21.820Z",
      "updated_at": "2024-11-12T21:35:08.474Z",
      "cooked": "<p>I want to create my own counter with different levels. Sadly I‚Äôm struggling with updating the value. Now I just get the error message: ‚Äúunexpected argument‚Äù</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let template(\n  exercise-heading-prefix: \"Exercise\",\n  exercise-heading-numbering-format: \"1\",\n  subexercise-heading-prefix: \"\",\n  subexercise-heading-numbering-format: \"a)\",\n  subsubexercise-heading-prefix: \"\",\n  subsubexercise-heading-numbering-format: \"(i)\",\n) = {\n  // custom exercise headings\n  let counter-exercise = counter(\"counter-exercise\")\n\n  let counter_incr(i) = a =&gt; {\n    // to array\n    if type(a) == int { a = (a,) }\n    assert(type(a) == array, message: \"counter update got unexpected type\")\n\n    // a = a.slice(0, i)\n    // a.at(-1) += 1\n\n    while a.len() &lt; 3 {\n      a.push(0)\n    }\n    a.at(i - 1) += 1\n    for idx in range(i, 3) {\n      a.at(idx) = 0\n    }\n\n    return a\n  }\n\n  let base_exercise_heading(prefix, num-format, level, content) = {\n    let w = (\"medium\", \"regular\", \"regular\").at(level - 1)\n    let fontsize = 16pt - 2pt * (level - 1)\n    let fup = counter_incr(level)\n    context counter-exercise.update(fup)\n    text(size: fontsize, weight: w)[\n      #prefix\n      #context {\n        counter-exercise.display(num-format)\n      }\n      #if content != [] [ \\- #content ]\n    ]\n  }\n\n  let exercise(prefix: none, num-format: none, content) = {\n    let level = 1\n    if prefix == none { prefix = exercise-heading-prefix }\n    if num-format == none { num-format = exercise-heading-numbering-format }\n    base_exercise_heading(prefix, num-format, level, content)\n  }\n\n  let subexercise(prefix: none, num-format: none, content) = {\n    let level = 2\n    if prefix == none { prefix = subexercise-heading-prefix }\n    if num-format == none { num-format = subexercise-heading-numbering-format }\n    base_exercise_heading(prefix, num-format, level, content)\n  }\n\n  return (\n    \"exercise\": exercise,\n    \"subexercise\": subexercise,\n  )\n}\n\n#let (exercise, subexercise) = template()\n\n#set heading(numbering: \"I.\")\n\n= Mandatory Exercises\n\n#exercise[]\n\nHere we go. #lorem(30)\n\n\n#exercise[Binary]\n\n#lorem(50)\n\n#subexercise[]\\\n#lorem(10)\n\n#subexercise[]\\\n#lorem(12)\n\n#exercise[Hexa-decimal]\n\n#lorem(30)\n\n\n= Elective Compulsory Exercises\n\n\n#exercise[Foo]\n\n#lorem(50). That's all. Trivial.\n\n\n#exercise(num-format: \"I\")[Roman]\n\nThat was easy.\n\n#exercise[]\n\n#lorem(20)\n</code></pre>\n<p>EDIT: sry missed to send the error, here is a picture<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/8d9f3f3d80d38f169f299bb666b23a934cb153f4.png\" data-download-href=\"https://forum.typst.app/uploads/default/8d9f3f3d80d38f169f299bb666b23a934cb153f4\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/8d9f3f3d80d38f169f299bb666b23a934cb153f4_2_690x370.png\" alt=\"image\" data-base62-sha1=\"kcQvwM3A9kYdoPez5cW5RPqlERC\" width=\"690\" height=\"370\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/8/8d9f3f3d80d38f169f299bb666b23a934cb153f4_2_690x370.png, https://forum.typst.app/uploads/default/original/2X/8/8d9f3f3d80d38f169f299bb666b23a934cb153f4.png 1.5x, https://forum.typst.app/uploads/default/original/2X/8/8d9f3f3d80d38f169f299bb666b23a934cb153f4.png 2x\" data-dominant-color=\"311228\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">746√ó401 30.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>I don‚Äôt understand why it‚Äôs complaining about an unexpected argument but it is actually pointing to the parameter definition of this anonymous function.</p>",
      "raw": "I want to create my own counter with different levels. Sadly I'm struggling with updating the value. Now I just get the error message: \"unexpected argument\"\n\n```typ\n#let template(\n  exercise-heading-prefix: \"Exercise\",\n  exercise-heading-numbering-format: \"1\",\n  subexercise-heading-prefix: \"\",\n  subexercise-heading-numbering-format: \"a)\",\n  subsubexercise-heading-prefix: \"\",\n  subsubexercise-heading-numbering-format: \"(i)\",\n) = {\n  // custom exercise headings\n  let counter-exercise = counter(\"counter-exercise\")\n\n  let counter_incr(i) = a => {\n    // to array\n    if type(a) == int { a = (a,) }\n    assert(type(a) == array, message: \"counter update got unexpected type\")\n\n    // a = a.slice(0, i)\n    // a.at(-1) += 1\n\n    while a.len() < 3 {\n      a.push(0)\n    }\n    a.at(i - 1) += 1\n    for idx in range(i, 3) {\n      a.at(idx) = 0\n    }\n\n    return a\n  }\n\n  let base_exercise_heading(prefix, num-format, level, content) = {\n    let w = (\"medium\", \"regular\", \"regular\").at(level - 1)\n    let fontsize = 16pt - 2pt * (level - 1)\n    let fup = counter_incr(level)\n    context counter-exercise.update(fup)\n    text(size: fontsize, weight: w)[\n      #prefix\n      #context {\n        counter-exercise.display(num-format)\n      }\n      #if content != [] [ \\- #content ]\n    ]\n  }\n\n  let exercise(prefix: none, num-format: none, content) = {\n    let level = 1\n    if prefix == none { prefix = exercise-heading-prefix }\n    if num-format == none { num-format = exercise-heading-numbering-format }\n    base_exercise_heading(prefix, num-format, level, content)\n  }\n\n  let subexercise(prefix: none, num-format: none, content) = {\n    let level = 2\n    if prefix == none { prefix = subexercise-heading-prefix }\n    if num-format == none { num-format = subexercise-heading-numbering-format }\n    base_exercise_heading(prefix, num-format, level, content)\n  }\n\n  return (\n    \"exercise\": exercise,\n    \"subexercise\": subexercise,\n  )\n}\n\n#let (exercise, subexercise) = template()\n\n#set heading(numbering: \"I.\")\n\n= Mandatory Exercises\n\n#exercise[]\n\nHere we go. #lorem(30)\n\n\n#exercise[Binary]\n\n#lorem(50)\n\n#subexercise[]\\\n#lorem(10)\n\n#subexercise[]\\\n#lorem(12)\n\n#exercise[Hexa-decimal]\n\n#lorem(30)\n\n\n= Elective Compulsory Exercises\n\n\n#exercise[Foo]\n\n#lorem(50). That's all. Trivial.\n\n\n#exercise(num-format: \"I\")[Roman]\n\nThat was easy.\n\n#exercise[]\n\n#lorem(20)\n```\n\nEDIT: sry missed to send the error, here is a picture\n![image|690x370](upload://kcQvwM3A9kYdoPez5cW5RPqlERC.png)\n\nI don't understand why it's complaining about an unexpected argument but it is actually pointing to the parameter definition of this anonymous function.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 49,
      "score": 1764.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 5559,
      "post_number": 2,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2024-11-12T20:47:56.947Z",
      "updated_at": "2024-11-12T20:47:56.947Z",
      "cooked": "<p>Oh, I think I got it. the <code>counter.update()</code> function calls my anonymous function with the current counter value with each number a separate argument.</p>\n<p>At this point I should probably write <code>(..a) =&gt; ...</code>.</p>\n<p>As a bonus: Is this an acceptable way to implement a custom multilevel counter? Or am I missing a much more convenient way?</p>",
      "raw": "Oh, I think I got it. the `counter.update()` function calls my anonymous function with the current counter value with each number a separate argument.\n\nAt this point I should probably write `(..a) => ...`.\n\n\n\nAs a bonus: Is this an acceptable way to implement a custom multilevel counter? Or am I missing a much more convenient way?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 42,
      "score": 8.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 5560,
      "post_number": 3,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2024-11-12T21:04:05.584Z",
      "updated_at": "2024-11-12T21:15:40.240Z",
      "cooked": "<p>This here is a working solution:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#{\n  let counter-exercise = counter(\"counter-exercise\")\n  let counter_incr(i) = (..a) =&gt; {\n    a = a.pos()\n    while a.len() &lt; 3 { a.push(0) }\n    a.at(i - 1) += 1\n    for idx in range(i, 3) { a.at(idx) = 0 }\n    return a\n  }\n  let base_exercise_heading(prefix, num-format, level, content) = {\n    let w = (\"medium\", \"regular\", \"regular\").at(level - 1)\n    let fontsize = 16pt - 2pt * (level - 1)\n    context {\n      counter-exercise.update(counter_incr(level))\n      let val = counter-exercise.get().at(level - 1) + 1\n      text(size: fontsize, weight: w)[\n        #prefix\n        #numbering(num-format, val)\n        #if content != [] [ \\- #content ]\n      ]\n    }\n  }\n}\n</code></pre>\n<p>I‚Äôm fine with this for now‚Ä¶</p>\n<p>However I still wonder:<br>\nIs that really the way to do it? Seems a bit ugly to me. I can well imagine that I have fabricated something here that is actually much simpler.</p>\n<p>Would really appreciate your thoughts ;)</p>",
      "raw": "This here is a working solution:\n```typ\n#{\n  let counter-exercise = counter(\"counter-exercise\")\n  let counter_incr(i) = (..a) => {\n    a = a.pos()\n    while a.len() < 3 { a.push(0) }\n    a.at(i - 1) += 1\n    for idx in range(i, 3) { a.at(idx) = 0 }\n    return a\n  }\n  let base_exercise_heading(prefix, num-format, level, content) = {\n    let w = (\"medium\", \"regular\", \"regular\").at(level - 1)\n    let fontsize = 16pt - 2pt * (level - 1)\n    context {\n      counter-exercise.update(counter_incr(level))\n      let val = counter-exercise.get().at(level - 1) + 1\n      text(size: fontsize, weight: w)[\n        #prefix\n        #numbering(num-format, val)\n        #if content != [] [ \\- #content ]\n      ]\n    }\n  }\n}\n```\n\nI'm fine with this for now...\n\nHowever I still wonder:\nIs that really the way to do it? Seems a bit ugly to me. I can well imagine that I have fabricated something here that is actually much simpler.\n\nWould really appreciate your thoughts ;)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 43,
      "score": 23.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 5568,
      "post_number": 4,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-12T21:37:57.850Z",
      "updated_at": "2024-11-12T21:37:57.850Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/xodarap\">@Xodarap</a>, welcome to the forum! I‚Äôve updated your post title in accordance with our question post guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>Make sure your title is a question you‚Äôd ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Xodarap, welcome to the forum! I‚Äôve updated your post title in accordance with our question post guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nMake sure your title is a question you‚Äôd ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 36,
      "score": 42.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 5569,
      "post_number": 5,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-12T21:39:38.156Z",
      "updated_at": "2024-11-12T21:39:38.156Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Xodarap\" data-post=\"3\" data-topic=\"1695\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/x/D58100/48.png\" class=\"avatar\"> Xodarap:</div>\n<blockquote>\n<p>Is that really the way to do it? Seems a bit ugly to me. I can well imagine that I have fabricated something here that is actually much simpler</p>\n</blockquote>\n</aside>\n<p>I believe you can replace <code>counter-exercise.update(counter_incr(level))</code> by <code>counter-exercise.step(level: level)</code>; see docs here: <a href=\"https://typst.app/docs/reference/introspection/counter/#definitions-step\" class=\"inline-onebox\">Counter Type ‚Äì Typst Documentation</a></p>",
      "raw": "[quote=\"Xodarap, post:3, topic:1695\"]\nIs that really the way to do it? Seems a bit ugly to me. I can well imagine that I have fabricated something here that is actually much simpler\n[/quote]\n\nI believe you can replace `counter-exercise.update(counter_incr(level))` by `counter-exercise.step(level: level)`; see docs here: https://typst.app/docs/reference/introspection/counter/#definitions-step",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 36,
      "score": 7.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 5571,
      "post_number": 6,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2024-11-13T00:04:35.496Z",
      "updated_at": "2024-11-13T00:14:23.116Z",
      "cooked": "<p>Thank you for your answer.</p>\n<p>Yes, it seems that step with the level parameter behaves like that. Unfortunately it doesn‚Äôt state this behavior in the documentation. This is why i thought that complicated about this in the first place. There is definitely  room for improvement.</p>\n<p>There is still a problem: the step-update of only takes affect right after the surrounding context environment. One possible workaround would be to split the function into two separate context blocks. But is that the supposed design?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#{\n  // custom exercise headings\n  let counter-exercise = counter(\"counter-exercise\")\n\n  let base_exercise_heading(prefix, num-format, level, content) = {\n    let w = if level == 1 { \"medium\" } else { \"regular\" }\n    let fontsize = 16pt - 2pt * (level - 1)\n    context counter-exercise.step(level: level )\n    context text(size: fontsize, weight: w)[\n      #prefix\n      #numbering(num-format, counter-exercise.get().at(level - 1))\n      #if content != [] [ \\- #content ]\n    ]\n  }\n}\n</code></pre>\n<p>This code does the trick. But there are still 2 <code>context</code> expressions.</p>",
      "raw": "Thank you for your answer.\n\nYes, it seems that step with the level parameter behaves like that. Unfortunately it doesn't state this behavior in the documentation. This is why i thought that complicated about this in the first place. There is definitely  room for improvement.\n\nThere is still a problem: the step-update of only takes affect right after the surrounding context environment. One possible workaround would be to split the function into two separate context blocks. But is that the supposed design?\n\n```typ\n#{\n  // custom exercise headings\n  let counter-exercise = counter(\"counter-exercise\")\n\n  let base_exercise_heading(prefix, num-format, level, content) = {\n    let w = if level == 1 { \"medium\" } else { \"regular\" }\n    let fontsize = 16pt - 2pt * (level - 1)\n    context counter-exercise.step(level: level )\n    context text(size: fontsize, weight: w)[\n      #prefix\n      #numbering(num-format, counter-exercise.get().at(level - 1))\n      #if content != [] [ \\- #content ]\n    ]\n  }\n}\n```\nThis code does the trick. But there are still 2 `context` expressions.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 31.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 5591,
      "post_number": 7,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-13T16:54:27.221Z",
      "updated_at": "2024-11-13T16:54:27.221Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Xodarap\" data-post=\"6\" data-topic=\"1695\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/x/D58100/48.png\" class=\"avatar\"> Xodarap:</div>\n<blockquote>\n<p>There is still a problem: the step-update of only takes affect right after the surrounding context environment. One possible workaround would be to split the function into two separate context blocks. But is that the supposed design?</p>\n</blockquote>\n</aside>\n<p>You can remove the first <code>context</code>; <code>.step()</code> doesn‚Äôt require context. But yes, this is intended. The <code>.step()</code> function simply inserts into the document a command that says ‚Äúfrom here onwards in the document, any attempt to read the counter will see its value increased by 1.‚Äù Now, what <code>context</code> does is: it creates an element which must be placed into the document. That element is responsible for running the code you wrote inside the context block using the document introspection information made available to it. In particular, when you write <code>here()</code> inside the context block, you will always get the same location: the location of that element. Also, when you get counter values by writing <code>.get()</code>, that is equivalent to <code>.at(here())</code>, so you will always be getting the counter value at the location of that element. Therefore, when you step the counter inside a context block, the updated counter value isn‚Äôt visible inside that same context block because you‚Äôre always using the location at the start of it. The only way to react to the updated value is to begin the context block after the step.</p>",
      "raw": "[quote=\"Xodarap, post:6, topic:1695\"]\nThere is still a problem: the step-update of only takes affect right after the surrounding context environment. One possible workaround would be to split the function into two separate context blocks. But is that the supposed design?\n[/quote]\n\nYou can remove the first `context`; `.step()` doesn't require context. But yes, this is intended. The `.step()` function simply inserts into the document a command that says \"from here onwards in the document, any attempt to read the counter will see its value increased by 1.\" Now, what `context` does is: it creates an element which must be placed into the document. That element is responsible for running the code you wrote inside the context block using the document introspection information made available to it. In particular, when you write `here()` inside the context block, you will always get the same location: the location of that element. Also, when you get counter values by writing `.get()`, that is equivalent to `.at(here())`, so you will always be getting the counter value at the location of that element. Therefore, when you step the counter inside a context block, the updated counter value isn't visible inside that same context block because you're always using the location at the start of it. The only way to react to the updated value is to begin the context block after the step.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 29,
      "score": 20.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 5656,
      "post_number": 8,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2024-11-15T02:50:29.657Z",
      "updated_at": "2024-11-15T02:50:29.657Z",
      "cooked": "<p>Thank you for the explanation <a class=\"mention\" href=\"/u/pgbiel\">@PgBiel</a> .</p>\n<p>As a solution to this Question:<br>\nThe anonymous function I defined is later on called with potentially several integers by <code>counter-exercise.update()</code>. That means that the number of arguments ist variable and it is not an array with variable length. Therefore it is best to use an argument sink like <code>(..a) =&gt; {&lt;impl&gt;}</code>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let counter_incr(i) = (..a) =&gt; {\n    a = a.pos()\n    while a.len() &lt; 3 { a.push(0) }\n    a.at(i - 1) += 1\n    for idx in range(i, 3) { a.at(idx) = 0 }\n    return a\n}\n</code></pre>\n<hr>\n<p>That is however only the original question.With that being fixed, I discovered (with the help of <a class=\"mention\" href=\"/u/pgbiel\">@PgBiel</a>) that my implementation was overly complicated and the logic I intended with my anonymous functions for different levels is all build in as a sane default in the <code>counter.step()</code> function. (I still think this could be more clear in the documentation). With this knowledge the <code>base_exercise_heading()</code> function can be simplified like this. (This also takes care of some other bugs I didn‚Äôt realize before, because I didn‚Äôt understand <code>context</code>. Now I do :))</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let base_exercise_heading(prefix, num-format, level, content) = {\n  let w = if level == 1 { \"medium\" } else { \"regular\" }\n  let fontsize = 16pt - 2pt * (level - 1)\n  counter-exercise.step(level: level)\n  context text(size: fontsize, weight: w)[\n    #prefix\n    #numbering(num-format, counter-exercise.get().at(level - 1))\n    #if content != [] [ \\- #content ]\n  ]\n}\n</code></pre>\n<p>That means <code>counter_incr()</code> can be dropped completely.</p>",
      "raw": "Thank you for the explanation @PgBiel .\n\nAs a solution to this Question:\nThe anonymous function I defined is later on called with potentially several integers by `counter-exercise.update()`. That means that the number of arguments ist variable and it is not an array with variable length. Therefore it is best to use an argument sink like `(..a) => {<impl>}`.\n\n```typ\n#let counter_incr(i) = (..a) => {\n    a = a.pos()\n    while a.len() < 3 { a.push(0) }\n    a.at(i - 1) += 1\n    for idx in range(i, 3) { a.at(idx) = 0 }\n    return a\n}\n```\n----\n\nThat is however only the original question.With that being fixed, I discovered (with the help of @PgBiel) that my implementation was overly complicated and the logic I intended with my anonymous functions for different levels is all build in as a sane default in the `counter.step()` function. (I still think this could be more clear in the documentation). With this knowledge the `base_exercise_heading()` function can be simplified like this. (This also takes care of some other bugs I didn't realize before, because I didn't understand `context`. Now I do :))\n\n```typ\n#let base_exercise_heading(prefix, num-format, level, content) = {\n  let w = if level == 1 { \"medium\" } else { \"regular\" }\n  let fontsize = 16pt - 2pt * (level - 1)\n  counter-exercise.step(level: level)\n  context text(size: fontsize, weight: w)[\n    #prefix\n    #numbering(num-format, counter-exercise.get().at(level - 1))\n    #if content != [] [ \\- #content ]\n  ]\n}\n```\nThat means `counter_incr()` can be dropped completely.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 145.0,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 5657,
      "post_number": 9,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-15T05:27:04.388Z",
      "updated_at": "2024-11-15T05:27:04.388Z",
      "cooked": "<p>Feel free to mark your post as a solution <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Feel free to mark your post as a solution :slight_smile:",
      "reply_to_post_number": 8,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 4.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:55:01.911662"
}
