{
  "topic_metadata": {
    "id": 2377,
    "title": "How to use `eval` to recover declared variable?",
    "slug": "how-to-use-eval-to-recover-declared-variable",
    "posts_count": 3,
    "created_at": "2025-01-12T11:34:31.022Z",
    "last_posted_at": "2025-01-12T17:29:56.764Z",
    "views": 139,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 472
  },
  "posts": [
    {
      "id": 7409,
      "post_number": 1,
      "username": "Alex",
      "name": "Alex",
      "created_at": "2025-01-12T11:34:31.187Z",
      "updated_at": "2025-01-12T11:34:31.187Z",
      "cooked": "<p>Hello everyone,</p>\n<p>For a personal project i have automated imports of pages into main.typ using a json file with the following structure :</p>\n<pre data-code-wrap=\"json\"><code class=\"lang-json\">{\n    \"reglement\": [],\n    \"officiel\": [\n        \"Braban\\u00e7onne\",\n        \"WoltjeKreet\",\n        \"Gaudeamus\",\n        \"IoVivat\",\n        \"marche_etudiants\",\n        \"LiedVanGeenTaal\",\n        \"WoltjeClubLied\"\n    ],\n    \"leekes\": [],\n    \"groupe_folklorique\": [],\n    \"andere\": [],\n    \"index\": [],\n    \"others\": [\n        \"fulltext\",\n        \"repetition\"\n    ]\n}\n</code></pre>\n<p>Basically, the keys in the following json file represent section of the the future text and the array represent variables to include.</p>\n<p>I retrieve the content of the json in a dict and i iterate over each “section” and “variable”. After that i use  <code>eval()</code> to call and use my variables :</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">// in main.typ\n\n#import \"imports.typ\" : * // for importing variables\n\n// normal call of my variable previously defined\n#sacre_page\n#WoltjeClubLied\n#CridesPres\n#Gaudeamus\n#Brabançonne  // Variable brabançonne here\n#marche_etudiants\n#IoVivat\n#LiedVanGeenTaal\n\n// using json, dictionnary and eval\n#for key in dict.keys() {\n  for songname in dict.at(key){\n    \"#\" + str(songname) + linebreak() // used to debug -&gt; correct names\n    eval(\"#\" + str(songname), mode : \"markup\") // unknown variable Brabançonne \n  }\n}\n</code></pre>\n<p>I suppose it could be due to the scope of the evaluated code that is not the same as the code  located on top.  Unfortunately i don’t really know how to correctly define it.<br>\nAnother supposition is to evaluate the code including the <code>#import \"imports.typ\" : *</code></p>\n<p>For more insight you can check the project here : <a href=\"https://typst.app/project/rA51dz4VMV7DFc6XDUxMfn\" class=\"inline-onebox\">Typst</a> and <code>main.typ</code> should be the most useful file to check.<br>\n( <img src=\"https://forum.typst.app/images/emoji/apple/warning.png?v=12\" title=\":warning:\" class=\"emoji\" alt=\":warning:\" loading=\"lazy\" width=\"20\" height=\"20\"> It is quite big and partially automated via python script so not everything make sense. )<br>\nThank you in advance for your help</p>",
      "raw": "Hello everyone, \n\nFor a personal project i have automated imports of pages into main.typ using a json file with the following structure : \n\n```json\n{\n    \"reglement\": [],\n    \"officiel\": [\n        \"Braban\\u00e7onne\",\n        \"WoltjeKreet\",\n        \"Gaudeamus\",\n        \"IoVivat\",\n        \"marche_etudiants\",\n        \"LiedVanGeenTaal\",\n        \"WoltjeClubLied\"\n    ],\n    \"leekes\": [],\n    \"groupe_folklorique\": [],\n    \"andere\": [],\n    \"index\": [],\n    \"others\": [\n        \"fulltext\",\n        \"repetition\"\n    ]\n}\n```\n\nBasically, the keys in the following json file represent section of the the future text and the array represent variables to include. \n\nI retrieve the content of the json in a dict and i iterate over each \"section\" and \"variable\". After that i use  `eval()` to call and use my variables : \n\n```typst\n// in main.typ\n\n#import \"imports.typ\" : * // for importing variables\n\n// normal call of my variable previously defined\n#sacre_page\n#WoltjeClubLied\n#CridesPres\n#Gaudeamus\n#Brabançonne  // Variable brabançonne here\n#marche_etudiants\n#IoVivat\n#LiedVanGeenTaal\n\n// using json, dictionnary and eval\n#for key in dict.keys() {\n  for songname in dict.at(key){\n    \"#\" + str(songname) + linebreak() // used to debug -> correct names\n    eval(\"#\" + str(songname), mode : \"markup\") // unknown variable Brabançonne \n  }\n}\n```\nI suppose it could be due to the scope of the evaluated code that is not the same as the code  located on top.  Unfortunately i don't really know how to correctly define it. \nAnother supposition is to evaluate the code including the `#import \"imports.typ\" : *`\n\nFor more insight you can check the project here : https://typst.app/project/rA51dz4VMV7DFc6XDUxMfn and `main.typ` should be the most useful file to check.\n( :warning: It is quite big and partially automated via python script so not everything make sense. )\nThank you in advance for your help",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 491.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 987
    },
    {
      "id": 7412,
      "post_number": 2,
      "username": "Alex",
      "name": "Alex",
      "created_at": "2025-01-12T13:53:01.857Z",
      "updated_at": "2025-01-12T13:53:01.857Z",
      "cooked": "<p>The <code>import</code> hypothesis was correct so i implemented the following workaround :</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let dict = json(\"songs.json\")\n\n#for key in dict.keys() {\n  \n  for songname in dict.at(key){\n    eval(str(\"import \\\"imports.typ\\\" : *\\n\")+str(songname), mode: \"code\")\n  }\n}\n</code></pre>\n<p>I still think there’s a better way to do the same since for each song of each new page we make the same import.<br>\nFor the moment it will be marked as solution</p>",
      "raw": "The `import` hypothesis was correct so i implemented the following workaround : \n```\n#let dict = json(\"songs.json\")\n\n#for key in dict.keys() {\n  \n  for songname in dict.at(key){\n    eval(str(\"import \\\"imports.typ\\\" : *\\n\")+str(songname), mode: \"code\")\n  }\n}\n```\n\nI still think there's a better way to do the same since for each song of each new page we make the same import. \nFor the moment it will be marked as solution",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 15.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 987
    },
    {
      "id": 7420,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-12T17:29:56.764Z",
      "updated_at": "2025-01-12T17:29:56.764Z",
      "cooked": "<p>The <code>eval</code> function has a <code>scope</code> parameter. Let’s say I have</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// imports.typ\n#let foo = \"hello\"\n\n// main.typ\n#import \"imports.typ\": *\n\n#foo  // hello\n</code></pre>\n<p>then using the scope parameter I could also write</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"imports.typ\": *\n\n#eval(\"foo\", mode: \"code\", scope: (foo: foo))\n</code></pre>\n<p>This is not useful yet, since you’d have to write all the variable names. However you can use the <a href=\"https://typst.app/docs/reference/foundations/dictionary/#constructor\"><code>dictionary</code> constructor</a> to convert a module (<code>imports.typ</code>) into a dictionary, and pass that as the <code>scope</code>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"imports.typ\" as imports\n\n#eval(\"foo\", mode: \"code\", scope: dictionary(imports))\n</code></pre>\n<p>(as an aside, I used <code>mode: \"code\"</code> to avoid having to add the <code>#</code> to the variable)</p>\n<p>You may notice that you’re not doing a lot with eval, and you have a dictionary already. So you can further simplify this to</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"imports.typ\" as imports\n\n#dictionary(imports).at(\"foo\")\n</code></pre>",
      "raw": "The `eval` function has a `scope` parameter. Let's say I have\n\n```typ\n// imports.typ\n#let foo = \"hello\"\n\n// main.typ\n#import \"imports.typ\": *\n\n#foo  // hello\n```\n\nthen using the scope parameter I could also write\n\n```typ\n#import \"imports.typ\": *\n\n#eval(\"foo\", mode: \"code\", scope: (foo: foo))\n```\n\nThis is not useful yet, since you'd have to write all the variable names. However you can use the [`dictionary` constructor](https://typst.app/docs/reference/foundations/dictionary/#constructor) to convert a module (`imports.typ`) into a dictionary, and pass that as the `scope`:\n\n```typ\n#import \"imports.typ\" as imports\n\n#eval(\"foo\", mode: \"code\", scope: dictionary(imports))\n```\n\n(as an aside, I used `mode: \"code\"` to avoid having to add the `#` to the variable)\n\nYou may notice that you're not doing a lot with eval, and you have a dictionary already. So you can further simplify this to\n\n```typ\n#import \"imports.typ\" as imports\n\n#dictionary(imports).at(\"foo\")\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 27,
      "score": 70.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:52:54.580165"
}
{
  "topic_metadata": {
    "id": 2379,
    "title": "How to set a different font for headings?",
    "slug": "how-to-set-a-different-font-for-headings",
    "posts_count": 5,
    "created_at": "2025-01-12T11:40:30.738Z",
    "last_posted_at": "2025-03-09T15:42:42.696Z",
    "views": 471,
    "like_count": 6,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Thorsten",
    "tags": [
      "styling",
      "fonts"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 194
  },
  "posts": [
    {
      "id": 7411,
      "post_number": 1,
      "username": "Thorsten",
      "name": "Thorsten",
      "created_at": "2025-01-12T11:40:30.866Z",
      "updated_at": "2025-01-13T08:48:44.267Z",
      "cooked": "<p>Hi,</p>\n<p>how do I style headings’ font differently from paragraphs?</p>\n<p>I looked in the docs, but I can’t find a solution. “font“ does not seem to be a valid key in heading styles.</p>\n<p><em>EDIT:</em> Damn, this was one of those cases in which you had to go public on a forum and find the solution a minute afterwards yourself…</p>\n<pre><code class=\"lang-auto\">#show heading.where(\n  level: 2\n): it =&gt; text(\n  font: \"Atma\",\n  size: 20pt,\n  weight: \"regular\",\n  style: \"normal\",\n  it.body,\n)\n</code></pre>",
      "raw": "Hi,\n\nhow do I style headings' font differently from paragraphs?\n\nI looked in the docs, but I can't find a solution. “font“ does not seem to be a valid key in heading styles.\n\n*EDIT:* Damn, this was one of those cases in which you had to go public on a forum and find the solution a minute afterwards yourself..\n\n```\n#show heading.where(\n  level: 2\n): it => text(\n  font: \"Atma\",\n  size: 20pt,\n  weight: \"regular\",\n  style: \"normal\",\n  it.body,\n)\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 44,
      "score": 1973.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1035
    },
    {
      "id": 7414,
      "post_number": 2,
      "username": "Thorsten",
      "name": "Thorsten",
      "created_at": "2025-01-12T15:49:29.814Z",
      "updated_at": "2025-01-12T16:57:28.634Z",
      "cooked": "<p>This is solved.</p>\n<pre><code class=\"lang-auto\">#show heading.where(\n  level: 2\n): it =&gt; text(\n  font: \"Atma\",\n  size: 20pt,\n  weight: \"regular\",\n  style: \"normal\",\n  it.body,\n)\n</code></pre>",
      "raw": "This is solved.\n\n```\n#show heading.where(\n  level: 2\n): it => text(\n  font: \"Atma\",\n  size: 20pt,\n  weight: \"regular\",\n  style: \"normal\",\n  it.body,\n)\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 39,
      "score": 27.8,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 1035
    },
    {
      "id": 7415,
      "post_number": 3,
      "username": "Mathemensch",
      "name": "Alexander Schulz",
      "created_at": "2025-01-12T16:18:10.514Z",
      "updated_at": "2025-01-12T16:18:10.514Z",
      "cooked": "<p>It would be nice if you share your solution, so others can benefit from your work. <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "It would be nice if you share your solution, so others can benefit from your work. :slight_smile:",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 36,
      "score": 22.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 307
    },
    {
      "id": 7416,
      "post_number": 4,
      "username": "flokl",
      "name": "",
      "created_at": "2025-01-12T16:39:24.038Z",
      "updated_at": "2025-01-12T16:39:24.038Z",
      "cooked": "<p>They have shared the solution, see the “Edit” and the code block in the initial post.</p>",
      "raw": "They have shared the solution, see the \"Edit\" and the code block in the initial post.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 36,
      "score": 37.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 9526,
      "post_number": 5,
      "username": "Pihee",
      "name": "",
      "created_at": "2025-03-09T15:42:42.696Z",
      "updated_at": "2025-03-09T15:42:42.696Z",
      "cooked": "<p>I had a problem with this code : the body’s text appeared right after the title, without a breakline, so I tried something else :</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#show heading.where( level: 2 ): set text(\n  font: \"Atma\",\n  size: 20pt,\n  weight: \"regular\",\n  style: \"normal\",)\n</code></pre>\n<p>I find it more practical. Maybe because I don’t fully understand the “it” parameter in the previous code.</p>\n<p>Hope I helped a bit ;)</p>",
      "raw": "I had a problem with this code : the body's text appeared right after the title, without a breakline, so I tried something else :\n```typst\n#show heading.where( level: 2 ): set text(\n  font: \"Atma\",\n  size: 20pt,\n  weight: \"regular\",\n  style: \"normal\",)\n```\nI find it more practical. Maybe because I don't fully understand the \"it\" parameter in the previous code.\n\nHope I helped a bit ;)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 19,
      "score": 73.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1318
    }
  ],
  "scraped_at": "2025-06-10T09:52:53.838331"
}
{
  "topic_metadata": {
    "id": 2382,
    "title": "How to stretch an image over the entire page?",
    "slug": "how-to-stretch-an-image-over-the-entire-page",
    "posts_count": 2,
    "created_at": "2025-01-12T19:48:02.346Z",
    "last_posted_at": "2025-01-12T20:03:20.252Z",
    "views": 195,
    "like_count": 0,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "flokl",
    "tags": [
      "layout",
      "images"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 113
  },
  "posts": [
    {
      "id": 7422,
      "post_number": 1,
      "username": "Olaf",
      "name": "Olaf",
      "created_at": "2025-01-12T19:48:02.562Z",
      "updated_at": "2025-01-12T19:48:26.229Z",
      "cooked": "<p>I would like to fill a page completely with an image, borderless if possible. It should not be a background image. And no header or footer should be displayed. But the page should be included in the numbering.</p>\n<p>I have achieved the extension of the image into the margin with pad(). But I’m not sure if this is the right solution.</p>\n<p>How can I now suppress the header and footer on this page only?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#pagebreak()\n\n#pad(\n  x: -72pt,\n  y: -82pt,\n  image(\"image.jpeg\", width: 100%),\n)\n\n#pagebreak()\n</code></pre>",
      "raw": "I would like to fill a page completely with an image, borderless if possible. It should not be a background image. And no header or footer should be displayed. But the page should be included in the numbering. \n\nI have achieved the extension of the image into the margin with pad(). But I'm not sure if this is the right solution.\n\nHow can I now suppress the header and footer on this page only?\n\n\n```typ\n#pagebreak()\n\n#pad(\n  x: -72pt,\n  y: -82pt,\n  image(\"image.jpeg\", width: 100%),\n)\n\n#pagebreak()\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 677.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 418
    },
    {
      "id": 7423,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2025-01-12T20:03:20.252Z",
      "updated_at": "2025-01-12T20:05:51.536Z",
      "cooked": "<p>You can create a new page with zero margin and no header or footer.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#page(margin: 0pt, image(width: 100%, height: 100%, \"image.png\"))\n</code></pre>",
      "raw": "You can create a new page with zero margin and no header or footer.\n```typ\n#page(margin: 0pt, image(width: 100%, height: 100%, \"image.png\"))\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 37,
      "score": 12.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    }
  ],
  "scraped_at": "2025-06-10T09:52:53.099285"
}
{
  "topic_metadata": {
    "id": 2389,
    "title": "How to write and align type inference rules?",
    "slug": "how-to-write-and-align-type-inference-rules",
    "posts_count": 3,
    "created_at": "2025-01-13T16:28:06.373Z",
    "last_posted_at": "2025-01-13T20:05:39.427Z",
    "views": 204,
    "like_count": 3,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Eric",
    "tags": [
      "math",
      "latex-migration"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 713
  },
  "posts": [
    {
      "id": 7435,
      "post_number": 1,
      "username": "Marvin",
      "name": "Marvin",
      "created_at": "2025-01-13T16:28:06.499Z",
      "updated_at": "2025-01-14T07:21:58.513Z",
      "cooked": "<p>Hi! I started learning Typst yesterday and I’m currently in the process of translating some LaTeX code to Typst and was wondering how I can elegantly (and typographically beautiful) write type inference (i.e. natural deduction, gentzen, sequent calculus) diagrams.</p>\n<p>In LaTeX I use</p>\n<pre data-code-wrap=\"latex\"><code class=\"lang-latex\">\\begin{mathpar}\n    \\inferrule*[right=Var]\n    {x : \\tau \\in \\Gamma}\n    {\\Gamma \\vdash x : \\tau}\n\n    \\inferrule*[right=Abs]\n    {\\Gamma, x : \\tau_1 \\vdash e : \\tau_2}\n    {\\Gamma \\vdash \\lambda x : \\tau_1.\\ e : \\tau_1 \\to \\tau_2}\n\n    \\inferrule*[right=App]\n    {\\Gamma \\vdash e_1 : \\tau_1 \\to \\tau_2 \\\\\n     \\Gamma \\vdash e_2 : \\tau_1}\n    {\\Gamma \\vdash e_1\\ e_2 : \\tau_2}\n\\end{mathpar}\n</code></pre>\n<p>Which results in the following:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/d/daead0e468e4fe1afc3afed5cb209d39dd52c89f.png\" data-download-href=\"https://forum.typst.app/uploads/default/daead0e468e4fe1afc3afed5cb209d39dd52c89f\" title=\"2025-01-13_17-24\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/d/daead0e468e4fe1afc3afed5cb209d39dd52c89f_2_690x205.png\" alt=\"2025-01-13_17-24\" data-base62-sha1=\"veDb7WyxwyJTf1HeqmrhJE8gXVB\" width=\"690\" height=\"205\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/d/daead0e468e4fe1afc3afed5cb209d39dd52c89f_2_690x205.png, https://forum.typst.app/uploads/default/original/2X/d/daead0e468e4fe1afc3afed5cb209d39dd52c89f.png 1.5x, https://forum.typst.app/uploads/default/original/2X/d/daead0e468e4fe1afc3afed5cb209d39dd52c89f.png 2x\" data-dominant-color=\"FCFCFC\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">2025-01-13_17-24</span><span class=\"informations\">912×272 13.8 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>In Typst the only thing I could come up with is using stacks (or grids) to manually align curryst prooftrees (which is a bit overkill for these diagrams I think):</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#align(center, stack(dir: ttb, spacing: 2em, stack(dir: ltr, spacing: 15%,\n  proof-tree(\n    rule(\n      name: smallcaps(\"Var\"),\n      $Gamma tack x : tau$,\n      $x : tau in Gamma$\n    )\n  ),\n\n  proof-tree(\n    rule(\n      name: smallcaps(\"Abs\"),\n      $Gamma tack lambda x : tau_1.e : tau_1 arrow tau_2$,\n      $Gamma, x : tau_1 tack e : tau_2$\n    )\n  )\n),\n  proof-tree(\n    rule(\n      name: smallcaps(\"App\"),\n      $Gamma tack e_1 \" \" e_2 : tau_2$,\n      $Gamma tack e_1 : tau_1 arrow tau_2$,\n      $Gamma tack e_2 : tau_1$\n    )\n  )\n))\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/e/e3ac829c40689b4c7f36fd483b70dd08cdf2b180.png\" data-download-href=\"https://forum.typst.app/uploads/default/e3ac829c40689b4c7f36fd483b70dd08cdf2b180\" title=\"2025-01-13_17-26\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/e/e3ac829c40689b4c7f36fd483b70dd08cdf2b180_2_690x151.png\" alt=\"2025-01-13_17-26\" data-base62-sha1=\"wu5ZcJxzikr7hY3ZseDiYMjSY0g\" width=\"690\" height=\"151\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/e/e3ac829c40689b4c7f36fd483b70dd08cdf2b180_2_690x151.png, https://forum.typst.app/uploads/default/original/2X/e/e3ac829c40689b4c7f36fd483b70dd08cdf2b180.png 1.5x, https://forum.typst.app/uploads/default/original/2X/e/e3ac829c40689b4c7f36fd483b70dd08cdf2b180.png 2x\" data-dominant-color=\"FBFBFB\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">2025-01-13_17-26</span><span class=\"informations\">963×211 12.8 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>I particularly don’t like how I have to manually adjust the spacing (compared to mathpar), especially if I had a lot more than three diagrams.</p>\n<p>Is there any better way to do this? Is there something similar “magical” to <code>mathpar</code> in Typst?</p>",
      "raw": "Hi! I started learning Typst yesterday and I'm currently in the process of translating some LaTeX code to Typst and was wondering how I can elegantly (and typographically beautiful) write type inference (i.e. natural deduction, gentzen, sequent calculus) diagrams.\n\nIn LaTeX I use\n\n```latex\n\\begin{mathpar}\n    \\inferrule*[right=Var]\n    {x : \\tau \\in \\Gamma}\n    {\\Gamma \\vdash x : \\tau}\n\n    \\inferrule*[right=Abs]\n    {\\Gamma, x : \\tau_1 \\vdash e : \\tau_2}\n    {\\Gamma \\vdash \\lambda x : \\tau_1.\\ e : \\tau_1 \\to \\tau_2}\n\n    \\inferrule*[right=App]\n    {\\Gamma \\vdash e_1 : \\tau_1 \\to \\tau_2 \\\\\n     \\Gamma \\vdash e_2 : \\tau_1}\n    {\\Gamma \\vdash e_1\\ e_2 : \\tau_2}\n\\end{mathpar}\n```\n\nWhich results in the following:\n\n![2025-01-13_17-24|690x205](upload://veDb7WyxwyJTf1HeqmrhJE8gXVB.png)\n\nIn Typst the only thing I could come up with is using stacks (or grids) to manually align curryst prooftrees (which is a bit overkill for these diagrams I think):\n\n```typst\n#align(center, stack(dir: ttb, spacing: 2em, stack(dir: ltr, spacing: 15%,\n  proof-tree(\n    rule(\n      name: smallcaps(\"Var\"),\n      $Gamma tack x : tau$,\n      $x : tau in Gamma$\n    )\n  ),\n\n  proof-tree(\n    rule(\n      name: smallcaps(\"Abs\"),\n      $Gamma tack lambda x : tau_1.e : tau_1 arrow tau_2$,\n      $Gamma, x : tau_1 tack e : tau_2$\n    )\n  )\n),\n  proof-tree(\n    rule(\n      name: smallcaps(\"App\"),\n      $Gamma tack e_1 \" \" e_2 : tau_2$,\n      $Gamma tack e_1 : tau_1 arrow tau_2$,\n      $Gamma tack e_2 : tau_1$\n    )\n  )\n))\n```\n\n![2025-01-13_17-26|690x151](upload://wu5ZcJxzikr7hY3ZseDiYMjSY0g.png)\n\nI particularly don't like how I have to manually adjust the spacing (compared to mathpar), especially if I had a lot more than three diagrams.\n\nIs there any better way to do this? Is there something similar \"magical\" to `mathpar` in Typst?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 37,
      "score": 827.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1039
    },
    {
      "id": 7437,
      "post_number": 2,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2025-01-13T19:54:25.183Z",
      "updated_at": "2025-01-13T19:57:39.251Z",
      "cooked": "<p>There is no inbuilt <code>mathpar</code> alternative, but it is possible to write something similar yourself, as I have done with the following code:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let mathpar(\n  numbering: auto,\n  row-gutter: 1.2em, // can be set to 'auto'\n  column-gutter: 2.5em,\n  ..children\n) = layout(bounds =&gt; {\n  // Resolve parameters\n  let numbering = if numbering == auto { math.equation.numbering } else { numbering }\n  let row-gutter = if row-gutter == auto { par.leading } else { row-gutter.to-absolute() }\n  let column-gutter = column-gutter.to-absolute()\n  let children = children.pos().map(child =&gt; [#child])\n\n  // Spread children into lines\n  let widths = children.map(child =&gt; measure(child).width)\n  let lines = ((children: (), remaining: bounds.width),)\n  for (child, width) in children.zip(widths) {\n    if (\n      child.func() == linebreak or\n      (lines.last().remaining - width) / (lines.last().children.len() + 2) &lt; column-gutter\n    ){\n      lines.push((children: (), remaining: bounds.width))\n    }\n\n    if child.func() != linebreak {\n      lines.last().children.push(child)\n      lines.last().remaining -= width\n    }\n  }\n\n  // Layout children in math mode for baseline alignment\n  par(leading: row-gutter, math.equation(numbering: numbering, block: true,\n    for (i, line) in lines.enumerate() {\n      let space = h(line.remaining / (line.children.len() + 1))\n      par(leading: par.leading, space + line.children.join(space) + space)\n      if i != lines.len() - 1 { linebreak() }\n    }\n  ))\n})\n</code></pre>\n<p>It is by no means perfect, but when used with your example, it certainly does the job. You can use it like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// This is necessary, because the default math font does not\n// support small capitals, so we have to explicitly switch\n// back to the text font here.\n#show smallcaps: set text(font: \"Libertinus Serif\")\n\n#mathpar(\n  proof-tree(\n    rule(\n      name: smallcaps(\"Var\"),\n      $Gamma tack x : tau$,\n      $x : tau in Gamma$\n    )\n  ),\n  proof-tree(\n    rule(\n      name: smallcaps(\"Abs\"),\n      $Gamma tack lambda x : tau_1.e : tau_1 arrow tau_2$,\n      $Gamma, x : tau_1 tack e : tau_2$\n    )\n  ),\n  proof-tree(\n    rule(\n      name: smallcaps(\"App\"),\n      $Gamma tack e_1 \" \" e_2 : tau_2$,\n      $Gamma tack e_1 : tau_1 arrow tau_2$,\n      $Gamma tack e_2 : tau_1$\n    )\n  ),\n)\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/6/63630b4dc9b8530108818979b207a383a72d4504.png\" alt=\"Output of above Code\" data-base62-sha1=\"ebdtbmQeCIrZDkMLbzz3mfMT5iI\" width=\"595\" height=\"144\"></p>\n<p>You can of course play around with the parameters to improve the spacing. When <code>row-gutter</code> is set to <code>auto</code>, it will use whatever value is used in <code>par.spacing</code>, which defaults to <code>0.65em</code>. A larger value looks better here though, as there are fractions involved, which like to get close to each other.</p>\n<p><em>(I might have overcomplicated this a bit, so if someone has a simpler solution, please share!)</em></p>",
      "raw": "There is no inbuilt `mathpar` alternative, but it is possible to write something similar yourself, as I have done with the following code:\n```typ\n#let mathpar(\n  numbering: auto,\n  row-gutter: 1.2em, // can be set to 'auto'\n  column-gutter: 2.5em,\n  ..children\n) = layout(bounds => {\n  // Resolve parameters\n  let numbering = if numbering == auto { math.equation.numbering } else { numbering }\n  let row-gutter = if row-gutter == auto { par.leading } else { row-gutter.to-absolute() }\n  let column-gutter = column-gutter.to-absolute()\n  let children = children.pos().map(child => [#child])\n\n  // Spread children into lines\n  let widths = children.map(child => measure(child).width)\n  let lines = ((children: (), remaining: bounds.width),)\n  for (child, width) in children.zip(widths) {\n    if (\n      child.func() == linebreak or\n      (lines.last().remaining - width) / (lines.last().children.len() + 2) < column-gutter\n    ){\n      lines.push((children: (), remaining: bounds.width))\n    }\n\n    if child.func() != linebreak {\n      lines.last().children.push(child)\n      lines.last().remaining -= width\n    }\n  }\n\n  // Layout children in math mode for baseline alignment\n  par(leading: row-gutter, math.equation(numbering: numbering, block: true,\n    for (i, line) in lines.enumerate() {\n      let space = h(line.remaining / (line.children.len() + 1))\n      par(leading: par.leading, space + line.children.join(space) + space)\n      if i != lines.len() - 1 { linebreak() }\n    }\n  ))\n})\n```\n\nIt is by no means perfect, but when used with your example, it certainly does the job. You can use it like this:\n```typ\n// This is necessary, because the default math font does not\n// support small capitals, so we have to explicitly switch\n// back to the text font here.\n#show smallcaps: set text(font: \"Libertinus Serif\")\n\n#mathpar(\n  proof-tree(\n    rule(\n      name: smallcaps(\"Var\"),\n      $Gamma tack x : tau$,\n      $x : tau in Gamma$\n    )\n  ),\n  proof-tree(\n    rule(\n      name: smallcaps(\"Abs\"),\n      $Gamma tack lambda x : tau_1.e : tau_1 arrow tau_2$,\n      $Gamma, x : tau_1 tack e : tau_2$\n    )\n  ),\n  proof-tree(\n    rule(\n      name: smallcaps(\"App\"),\n      $Gamma tack e_1 \" \" e_2 : tau_2$,\n      $Gamma tack e_1 : tau_1 arrow tau_2$,\n      $Gamma tack e_2 : tau_1$\n    )\n  ),\n)\n```\n\n![Output of above Code|595x144](upload://ebdtbmQeCIrZDkMLbzz3mfMT5iI.png)\n\nYou can of course play around with the parameters to improve the spacing. When `row-gutter` is set to `auto`, it will use whatever value is used in `par.spacing`, which defaults to `0.65em`. A larger value looks better here though, as there are fractions involved, which like to get close to each other.\n\n_(I might have overcomplicated this a bit, so if someone has a simpler solution, please share!)_",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 29,
      "score": 40.8,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 7438,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-13T20:05:39.427Z",
      "updated_at": "2025-01-13T20:05:39.427Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/marvin\">@Marvin</a>, could you maybe try to revise your post’s title to be a complete question as per the <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">question guidelines</a>:</p>\n<blockquote>\n<p><strong>Good titles are questions you would ask your friend about Typst.</strong></p>\n</blockquote>\n<p>We hope by adhering to this, we make the information in this forum easy to find in the future. Thanks!</p>",
      "raw": "Hi @Marvin, could you maybe try to revise your post’s title to be a complete question as per the [question guidelines](https://forum.typst.app/t/how-to-post-in-the-questions-category/11):\n\n> **Good titles are questions you would ask your friend about Typst.**\n\nWe hope by adhering to this, we make the information in this forum easy to find in the future. Thanks!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 75.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:52:52.379871"
}
{
  "topic_metadata": {
    "id": 2391,
    "title": "What Are Best Practices for Allowing Users to Modify Constants in Typst Packages?",
    "slug": "what-are-best-practices-for-allowing-users-to-modify-constants-in-typst-packages",
    "posts_count": 2,
    "created_at": "2025-01-13T22:52:04.803Z",
    "last_posted_at": "2025-01-13T23:18:51.577Z",
    "views": 180,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "xkevio",
    "tags": [
      "scripting",
      "package-authoring"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 443
  },
  "posts": [
    {
      "id": 7439,
      "post_number": 1,
      "username": "Alex",
      "name": "Alex",
      "created_at": "2025-01-13T22:52:04.938Z",
      "updated_at": "2025-02-02T20:06:02.491Z",
      "cooked": "<p>Hi everyone,</p>\n<p>I’m currently working on a Typst project destined to become a package and would love to know how to design it so users can decide whether or not to modify certain constants. The goal is to give them the flexibility to customize the package while keeping it simple and intuitive.</p>\n<p>In this project, I have a large number of constants (e.g., font choices, spacings, font sizes) that control the layout and appearance of elements. Here’s an example of how the constants look:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">// in constant.typ\n#let _Title-font = \"Source Sans Pro\"       // Title font\n#let _Header-tune-font = \"Noto Sans\"       // \"Air:\" font\n#let _Title-spacing = 0.2cm                // Spacing between title and header\n#let _Title-fontsize = 14pt                // Title font size\n// ... and many more\n</code></pre>\n<p>I want users to be able to <strong>use the package defaults</strong> without any extra configuration or <strong>easily modify specific constants</strong> if they need to customize the layout.</p>\n<p>For the moment i’m thinking of using <code>state</code> but it comes with certain disavantages such as updating the whole project and forcing the user to use longer and “less intuitive” syntax :</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">// in constant.typ\n#let _Title-font = state(\"it\",\"Source Sans Pro\") \n// in main.typ\n#_Title-font.update(it =&gt; \"Arial\")\n</code></pre>\n<p>The ideal solution would be something like <code>#set</code> that allows users to override things with very clear and understandable syntax. For example:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set _Title-font = \"Arial\"\n</code></pre>\n<p>In summary i have this questions :</p>\n<ul>\n<li>How do you typically design Typst packages to make some constants easily customizable?</li>\n<li>Is there a better alternative to using <code>state</code> for this purpose? Or a hack that i can develop to make it easier for the end user ?</li>\n<li>If previous quesiton is no, do you think requiring users to use <code>#_Title-font.update(...)</code> is acceptable, or would you consider it too cumbersome?</li>\n</ul>\n<p>Thank you in advance for your time and help. Since I started typst, I’ve found the community very responsive and helpful.</p>",
      "raw": "Hi everyone,\n\nI'm currently working on a Typst project destined to become a package and would love to know how to design it so users can decide whether or not to modify certain constants. The goal is to give them the flexibility to customize the package while keeping it simple and intuitive.\n\nIn this project, I have a large number of constants (e.g., font choices, spacings, font sizes) that control the layout and appearance of elements. Here's an example of how the constants look:\n\n```typst\n// in constant.typ\n#let _Title-font = \"Source Sans Pro\"       // Title font\n#let _Header-tune-font = \"Noto Sans\"       // \"Air:\" font\n#let _Title-spacing = 0.2cm                // Spacing between title and header\n#let _Title-fontsize = 14pt                // Title font size\n// ... and many more\n```\n\nI want users to be able to **use the package defaults** without any extra configuration or **easily modify specific constants** if they need to customize the layout.\n\nFor the moment i'm thinking of using `state` but it comes with certain disavantages such as updating the whole project and forcing the user to use longer and \"less intuitive\" syntax : \n```typst\n// in constant.typ\n#let _Title-font = state(\"it\",\"Source Sans Pro\") \n// in main.typ\n#_Title-font.update(it => \"Arial\")\n```\n\nThe ideal solution would be something like `#set` that allows users to override things with very clear and understandable syntax. For example:\n```typst\n#set _Title-font = \"Arial\"\n```\nIn summary i have this questions : \n- How do you typically design Typst packages to make some constants easily customizable?\n- Is there a better alternative to using `state` for this purpose? Or a hack that i can develop to make it easier for the end user ?\n- If previous quesiton is no, do you think requiring users to use `#_Title-font.update(...)` is acceptable, or would you consider it too cumbersome?\n\nThank you in advance for your time and help. Since I started typst, I've found the community very responsive and helpful.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 49,
      "score": 514.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 987
    },
    {
      "id": 7440,
      "post_number": 2,
      "username": "xkevio",
      "name": "Kevio",
      "created_at": "2025-01-13T23:18:51.577Z",
      "updated_at": "2025-01-13T23:19:42.659Z",
      "cooked": "<p>The idiomatic way, so far at least until we get custom elements and types, is to make all these variables (not constants) parameters of your template function which the user would apply with <code>#show: template.with(...)</code>.</p>\n<p>You could still keep your template-defined values in <code>constant.typ</code> by utilizing named parameters, like so:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import constant.typ: *\n#let my-template(\n  title-font: _Title-font,\n  title-spacing: _Title-spacing,\n  ..., // and so on\n  body\n) = {\n  // Your show and set rules.\n  body\n}\n</code></pre>\n<p>That way the user can either choose to override these values with <code>#show: my-template.with(title-font: \"Comic Sans\")</code> or leave them as-is by not providing the named parameter, see also <a href=\"https://typst.app/docs/tutorial/making-a-template/\" class=\"inline-onebox\">Making a Template – Typst Documentation</a>.</p>",
      "raw": "The idiomatic way, so far at least until we get custom elements and types, is to make all these variables (not constants) parameters of your template function which the user would apply with `#show: template.with(...)`.\n\nYou could still keep your template-defined values in `constant.typ` by utilizing named parameters, like so:\n```typ\n#import constant.typ: *\n#let my-template(\n  title-font: _Title-font,\n  title-spacing: _Title-spacing,\n  ..., // and so on\n  body\n) = {\n  // Your show and set rules.\n  body\n}\n```\n\nThat way the user can either choose to override these values with `#show: my-template.with(title-font: \"Comic Sans\")` or leave them as-is by not providing the named parameter, see also https://typst.app/docs/tutorial/making-a-template/.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 47,
      "score": 79.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 21
    }
  ],
  "scraped_at": "2025-06-10T09:52:51.680492"
}
{
  "topic_metadata": {
    "id": 2408,
    "title": "How do I draw a segment of a circle?",
    "slug": "how-do-i-draw-a-segment-of-a-circle",
    "posts_count": 4,
    "created_at": "2025-01-14T17:36:04.243Z",
    "last_posted_at": "2025-01-15T11:23:24.310Z",
    "views": 152,
    "like_count": 5,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Mathemensch",
    "tags": [
      "cetz"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 186
  },
  "posts": [
    {
      "id": 7510,
      "post_number": 1,
      "username": "M4R1S",
      "name": "Maris Baier",
      "created_at": "2025-01-14T17:36:04.433Z",
      "updated_at": "2025-01-14T17:36:04.433Z",
      "cooked": "<p>What’s the easiest way to draw a circle but only from angle_1 to angle_2?<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/e/e1e41506eaa82365324035a9ddc782f240d3547f.png\" data-download-href=\"https://forum.typst.app/uploads/default/e1e41506eaa82365324035a9ddc782f240d3547f\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/e/e1e41506eaa82365324035a9ddc782f240d3547f_2_690x424.png\" alt=\"image\" data-base62-sha1=\"wek5RxY6Y9bXDgSdamlrqHnSAmX\" width=\"690\" height=\"424\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/e/e1e41506eaa82365324035a9ddc782f240d3547f_2_690x424.png, https://forum.typst.app/uploads/default/original/2X/e/e1e41506eaa82365324035a9ddc782f240d3547f.png 1.5x, https://forum.typst.app/uploads/default/original/2X/e/e1e41506eaa82365324035a9ddc782f240d3547f.png 2x\" data-dominant-color=\"E5EDF3\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">770×474 117 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "What's the easiest way to draw a circle but only from angle_1 to angle_2?\n![image|690x424](upload://wek5RxY6Y9bXDgSdamlrqHnSAmX.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 42,
      "score": 343.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 643
    },
    {
      "id": 7524,
      "post_number": 2,
      "username": "Mathemensch",
      "name": "Alexander Schulz",
      "created_at": "2025-01-14T23:32:15.905Z",
      "updated_at": "2025-01-14T23:32:15.905Z",
      "cooked": "<p>You can use the <code>arc</code> function.<br>\nHere is an example:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let circle-segment(start, stop) = canvas({\n  import draw: *\n\n  let arc-color = rgb(\"#76BDE9\")\n    \n    //Draw the blue circle segment in three parts/lines/strokes\n    merge-path(\n      fill: arc-color,\n      stroke: none,\n      {\n      line((0,0), (start, 1))\n      arc((0,0), start: start, stop: stop, anchor: \"origin\")\n      line((0,0), (stop, 1))\n    })\n\n    //Draw the black start and stop lines\n    line((0,0), (start, 1.3))\n    line((0,0), (stop, 1.3))\n})\n</code></pre>\n<p>The result could look something like this:<br>\n<a href=\"https://typst.app/project/rwkY7GDDuI8iy8QXzanAF2\" class=\"onebox\" target=\"_blank\" rel=\"noopener\">https://typst.app/project/rwkY7GDDuI8iy8QXzanAF2</a></p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/9442d30a2ba4fb30d4ad6aee614f781173bd5a62.png\" data-download-href=\"https://forum.typst.app/uploads/default/9442d30a2ba4fb30d4ad6aee614f781173bd5a62\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/9442d30a2ba4fb30d4ad6aee614f781173bd5a62_2_690x349.png\" alt=\"image\" data-base62-sha1=\"l9zPQiQW19HWgsfzjQaTCDtOKX0\" width=\"690\" height=\"349\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/9442d30a2ba4fb30d4ad6aee614f781173bd5a62_2_690x349.png, https://forum.typst.app/uploads/default/original/2X/9/9442d30a2ba4fb30d4ad6aee614f781173bd5a62.png 1.5x, https://forum.typst.app/uploads/default/original/2X/9/9442d30a2ba4fb30d4ad6aee614f781173bd5a62.png 2x\" data-dominant-color=\"EFF3F6\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">920×466 66.4 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "You can use the `arc` function.\nHere is an example:\n```typ\n#let circle-segment(start, stop) = canvas({\n  import draw: *\n\n  let arc-color = rgb(\"#76BDE9\")\n    \n    //Draw the blue circle segment in three parts/lines/strokes\n    merge-path(\n      fill: arc-color,\n      stroke: none,\n      {\n      line((0,0), (start, 1))\n      arc((0,0), start: start, stop: stop, anchor: \"origin\")\n      line((0,0), (stop, 1))\n    })\n\n    //Draw the black start and stop lines\n    line((0,0), (start, 1.3))\n    line((0,0), (stop, 1.3))\n})\n```\n\nThe result could look something like this:\nhttps://typst.app/project/rwkY7GDDuI8iy8QXzanAF2\n\n![image|690x349](upload://l9zPQiQW19HWgsfzjQaTCDtOKX0.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 38,
      "score": 57.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 307
    },
    {
      "id": 7531,
      "post_number": 3,
      "username": "M4R1S",
      "name": "Maris Baier",
      "created_at": "2025-01-15T08:52:45.833Z",
      "updated_at": "2025-01-15T08:52:45.833Z",
      "cooked": "<p>Thanks a lot, I was especially missing</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">arc(..., anchor:\"origin\")\n</code></pre>",
      "raw": "Thanks a lot, I was especially missing\n```typ\narc(..., anchor:\"origin\")\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 11.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 643
    },
    {
      "id": 7543,
      "post_number": 4,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-15T11:23:24.310Z",
      "updated_at": "2025-01-15T11:24:51.793Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/m4r1s\">@M4R1S</a>, thanks for your question! If you feel the response you got has sufficiently answered your question, be sure to give it a checkmark. This will help others find the solution in the future. Thanks!</p>\n<p>(also, thanks <a class=\"mention\" href=\"/u/mathemensch\">@Mathemensch</a> for fixing the line in your “full rotation” example, it was bugging me in the question’s example screenshot <img src=\"https://forum.typst.app/images/emoji/apple/stuck_out_tongue.png?v=12\" title=\":stuck_out_tongue:\" class=\"emoji\" alt=\":stuck_out_tongue:\" loading=\"lazy\" width=\"20\" height=\"20\">)</p>",
      "raw": "Hi @M4R1S, thanks for your question! If you feel the response you got has sufficiently answered your question, be sure to give it a checkmark. This will help others find the solution in the future. Thanks!\n\n(also, thanks @Mathemensch for fixing the line in your \"full rotation\" example, it was bugging me in the question's example screenshot :stuck_out_tongue:)",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 30,
      "score": 36.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:52:50.969850"
}
{
  "topic_metadata": {
    "id": 2419,
    "title": "How can I start page numbering on the first page?",
    "slug": "how-can-i-start-page-numbering-on-the-first-page",
    "posts_count": 3,
    "created_at": "2025-01-15T05:54:05.062Z",
    "last_posted_at": "2025-01-15T11:18:28.663Z",
    "views": 484,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "neuralpain",
    "tags": [
      "numbering",
      "page"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 488
  },
  "posts": [
    {
      "id": 7529,
      "post_number": 1,
      "username": "jaivishnuks",
      "name": "jaivishnuks",
      "created_at": "2025-01-15T05:54:05.265Z",
      "updated_at": "2025-01-15T11:16:24.846Z",
      "cooked": "<p>I am new to Typst and using it for preparing assignments for my masters course work … when i set the page number using <code>set page(numbering)</code> i noticed that contents of my first page completely moved to second page and only the title remained in the first page. it seems that the first page is automatically treated as a title page when we switch on numbering…<br>\nSince my document does not need a title page… how do i set this off …<br>\nSnippets of my typst code is give below…</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set text(\n  font: \"New Computer Modern\",\n  size: 13pt\n)\n\n#let title = [Tutorial No.1]\n\n#let author = [Jaivishnu K.S]\n\n#align(center, text(16pt)[\n  *#title*\n])\n\n#align(center, text(13pt)[\n  #author])\n\n#set enum(numbering: \"1.a)\")\n\n#set par(justify: true,leading:3em,spacing: 2em)\n\n#set heading(numbering: \"1.a)\")\n#set page(numbering: \"1\")\n\n#v(10pt)\n\n+ Evaluate the following\n\t+ $overline(b) dot overline(c)$ where  b = (1,4,17) and c=(-4,-3,1) \\  $overline(b) dot overline(c) = b_i c_i = -4-12+17 = 1$\n</code></pre>",
      "raw": "I am new to Typst and using it for preparing assignments for my masters course work .... when i set the page number using `set page(numbering)` i noticed that contents of my first page completely moved to second page and only the title remained in the first page. it seems that the first page is automatically treated as a title page when we switch on numbering.. \nSince my document does not need a title page... how do i set this off ... \nSnippets of my typst code is give below... \n\n```typ\n#set text(\n  font: \"New Computer Modern\",\n  size: 13pt\n)\n\n#let title = [Tutorial No.1]\n\n#let author = [Jaivishnu K.S]\n\n#align(center, text(16pt)[\n  *#title*\n])\n\n#align(center, text(13pt)[\n  #author])\n\n#set enum(numbering: \"1.a)\")\n\n#set par(justify: true,leading:3em,spacing: 2em)\n\n#set heading(numbering: \"1.a)\")\n#set page(numbering: \"1\")\n\n#v(10pt)\n\n+ Evaluate the following\n\t+ $overline(b) dot overline(c)$ where  b = (1,4,17) and c=(-4,-3,1) \\  $overline(b) dot overline(c) = b_i c_i = -4-12+17 = 1$\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 48,
      "score": 1219.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1054
    },
    {
      "id": 7530,
      "post_number": 2,
      "username": "neuralpain",
      "name": "neuralpain",
      "created_at": "2025-01-15T07:35:25.138Z",
      "updated_at": "2025-01-15T07:56:44.804Z",
      "cooked": "<p><img src=\"https://forum.typst.app/uploads/default/original/1X/330078baf19fa0907af79ed20bd09ba6c7025cc2.png?v=12\" title=\":typstguy_talking:\" class=\"emoji emoji-custom\" alt=\":typstguy_talking:\" loading=\"lazy\" width=\"20\" height=\"20\"> Hi <a class=\"mention\" href=\"/u/jaivishnuks\">@jaivishnuks</a>, welcome to the community! <img src=\"https://forum.typst.app/images/emoji/apple/wave.png?v=12\" title=\":wave:\" class=\"emoji\" alt=\":wave:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>Typst code is interpreted line-by-line, therefore, when using the <code>page</code> function after the code for <code>title</code> like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#align(center, text(16pt)[#title])\n// [...]\n#set page(numbering: \"1\")\n</code></pre>\n<p>it only affects the elements which come after.</p>\n<blockquote>\n<p>It should be noted that whenever you set a new page layout, the content which comes after the <code>page</code> function is displayed starting on a new page.</p>\n</blockquote>\n<p>This is good for when you only want certain pages to have different layouts. For example, when creating a cover page, you may want the margins for that first page to be set differently, and you may also not want any numbering on that page. You would write the code something similar to this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(margin: (x: 3in, y: 2in)) // page settings for cover (numbering is not displayed)\n#lorem(180)\n\n#set page(margin: 2.5cm, numbering: \"1\") // page settings for the rest of the document (numbering begins now)\n#lorem(2000)\n</code></pre>\n<p>As shown above, the cover page has a different page margin than the rest of the document and does not include numbering like the rest of the document.</p>\n<p><strong>For your situation, placing the code for the page layout at the top would suffice.</strong></p>\n<p>I hope this was helpful and you have a fantastic time writing in Typst! <img src=\"https://forum.typst.app/uploads/default/original/1X/274f848b78859852628e9efdb7d0aefa6c38bb26.png?v=12\" title=\":typstguy:\" class=\"emoji emoji-custom\" alt=\":typstguy:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": ":typstguy_talking: Hi @jaivishnuks, welcome to the community! :wave:\n\nTypst code is interpreted line-by-line, therefore, when using the `page` function after the code for `title` like this:\n\n```typ\n#align(center, text(16pt)[#title])\n// [...]\n#set page(numbering: \"1\")\n```\n\nit only affects the elements which come after.\n\n> It should be noted that whenever you set a new page layout, the content which comes after the `page` function is displayed starting on a new page.\n\nThis is good for when you only want certain pages to have different layouts. For example, when creating a cover page, you may want the margins for that first page to be set differently, and you may also not want any numbering on that page. You would write the code something similar to this:\n\n```typ\n#set page(margin: (x: 3in, y: 2in)) // page settings for cover (numbering is not displayed)\n#lorem(180)\n\n#set page(margin: 2.5cm, numbering: \"1\") // page settings for the rest of the document (numbering begins now)\n#lorem(2000)\n```\n\nAs shown above, the cover page has a different page margin than the rest of the document and does not include numbering like the rest of the document.\n\n**For your situation, placing the code for the page layout at the top would suffice.**\n\nI hope this was helpful and you have a fantastic time writing in Typst! :typstguy:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 45,
      "score": 63.6,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 946
    },
    {
      "id": 7542,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-15T11:18:28.663Z",
      "updated_at": "2025-01-15T11:18:28.663Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/jaivishnuks\">@jaivishnuks</a>, welcome and thank you for your question! I have changed your post’s title to bring it in line with the <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">question guidelines</a> and thus make it easier to understand from the title:</p>\n<blockquote>\n<p><strong>Good titles are questions you would ask your friend about Typst.</strong></p>\n</blockquote>\n<p>I also formatted your code a bit; clicking on the pencil symbol you should be able to see what I changed, and the question guidelines also provide some guidance on how to show Typst code.</p>",
      "raw": "Hi @jaivishnuks, welcome and thank you for your question! I have changed your post’s title to bring it in line with the [question guidelines](https://forum.typst.app/t/how-to-post-in-the-questions-category/11) and thus make it easier to understand from the title:\n\n> **Good titles are questions you would ask your friend about Typst.**\n\nI also formatted your code a bit; clicking on the pencil symbol you should be able to see what I changed, and the question guidelines also provide some guidance on how to show Typst code.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 35,
      "score": 61.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:52:50.233008"
}
{
  "topic_metadata": {
    "id": 2422,
    "title": "How to keep a consistent figure caption and outline after changing the style of the figure caption?",
    "slug": "how-to-keep-a-consistent-figure-caption-and-outline-after-changing-the-style-of-the-figure-caption",
    "posts_count": 3,
    "created_at": "2025-01-15T09:43:46.807Z",
    "last_posted_at": "2025-01-31T09:57:10.075Z",
    "views": 339,
    "like_count": 0,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "chxp",
    "tags": [
      "outline",
      "figures"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 816
  },
  "posts": [
    {
      "id": 7535,
      "post_number": 1,
      "username": "chxp",
      "name": "chxp",
      "created_at": "2025-01-15T09:43:46.991Z",
      "updated_at": "2025-02-21T20:57:33.269Z",
      "cooked": "<p>I am trying to write the supporting information of the paper by using <code>typst</code>.  The code is provided as follows.</p>\n<p>However, the format of the outline is not consistent with figure captions, for example:</p>\n<ul>\n<li><code>Figure 1:</code> in the outline, but <code>Figure S1. </code> in the figure caption.</li>\n<li>Normal font of <code>Figure 1:</code> in the outline, but bold in the figure caption. I want the <code>Figure 1:</code> in the outline changed into a bold font as that in the figure caption.</li>\n</ul>\n<p>Thanks for your help.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set page(\"a4\", margin: auto)\n\n// Long and short captions for the outline\n#let in-outline = state(\"in-outline\", false)\n#show outline: it =&gt; {\n  in-outline.update(true)\n  it\n  in-outline.update(false)\n}\n#let ffcaption(long, short) = context if in-outline.get() { short } else { long }\n\n// table\n#show table.cell.where(y: 0): strong\n\n// Change figure caption from Figure 1: to *Figure 1.*\n#show figure.caption: it =&gt; [\n    #text(weight: \"bold\")[\n        #it.supplement S#it.counter.display(it.numbering).\n    ~]#it.body\n]\n\n// make tabel caption on the top\n#show figure.where(\n    kind: table\n): set figure.caption(position: top)\n\n// outline for image and table\n#outline(\n    target: figure.where(kind: image).or(figure.where(kind: table)),\n)\n\n// figure\n#figure(\n    rect(height:6cm, width: 11cm, fill: red),\n    caption: ffcaption([A curious figure.], [Short1]),\n) &lt;fig1&gt;\n\n\n#figure(\n    rect(height:10cm, width: 5cm, fill: blue),\n    caption: ffcaption([A curious figure.], [Short2 for]),\n) &lt;fig2&gt;\n\n\n#figure(\n    table(\n        columns: 2,\n        stroke: (_, y) =&gt; (\n            top: if y &lt;= 1 { 1pt } else { 0pt },\n            bottom: 1pt,\n        ),\n        [*Amount*], [*Ingredient*],\n        [360g], [Baking flour],\n        [Drizzle], [Vanilla extract],\n    ),\n    caption: ffcaption([a caption],[Table short]),\n) &lt;tbl1&gt;\n\n\n#figure(\n    table(\n        columns: 2,\n        stroke: (_, y) =&gt; (\n            top: if y &lt;= 1 { 1pt } else { 0pt },\n            bottom: 1pt,\n        ),\n        [*Amount*], [*Ingredient*],\n        [360g], [Baking flour],\n    ),\n    caption: ffcaption([a caption with very very very much much long long long long of of of new new new text is o with out a n ew c],\n        [table, short2])\n) &lt;tbl2&gt;\n\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/6/682e74361cee15f31268b45aa3ec16713f484120.png\" data-download-href=\"https://forum.typst.app/uploads/default/682e74361cee15f31268b45aa3ec16713f484120\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/6/682e74361cee15f31268b45aa3ec16713f484120_2_347x500.png\" alt=\"image\" data-base62-sha1=\"eRDbpvWXugMZ7chJUNpqpOrnRT2\" width=\"347\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/6/682e74361cee15f31268b45aa3ec16713f484120_2_347x500.png, https://forum.typst.app/uploads/default/optimized/2X/6/682e74361cee15f31268b45aa3ec16713f484120_2_520x750.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/6/682e74361cee15f31268b45aa3ec16713f484120_2_694x1000.png 2x\" data-dominant-color=\"D4C3D1\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">725×1043 36.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "I am trying to write the supporting information of the paper by using `typst`.  The code is provided as follows.\n\nHowever, the format of the outline is not consistent with figure captions, for example:\n- `Figure 1:` in the outline, but `Figure S1. ` in the figure caption.\n- Normal font of `Figure 1:` in the outline, but bold in the figure caption. I want the `Figure 1:` in the outline changed into a bold font as that in the figure caption.\n\nThanks for your help.\n\n```typst\n#set page(\"a4\", margin: auto)\n\n// Long and short captions for the outline\n#let in-outline = state(\"in-outline\", false)\n#show outline: it => {\n  in-outline.update(true)\n  it\n  in-outline.update(false)\n}\n#let ffcaption(long, short) = context if in-outline.get() { short } else { long }\n\n// table\n#show table.cell.where(y: 0): strong\n\n// Change figure caption from Figure 1: to *Figure 1.*\n#show figure.caption: it => [\n    #text(weight: \"bold\")[\n        #it.supplement S#it.counter.display(it.numbering).\n    ~]#it.body\n]\n\n// make tabel caption on the top\n#show figure.where(\n    kind: table\n): set figure.caption(position: top)\n\n// outline for image and table\n#outline(\n    target: figure.where(kind: image).or(figure.where(kind: table)),\n)\n\n// figure\n#figure(\n    rect(height:6cm, width: 11cm, fill: red),\n    caption: ffcaption([A curious figure.], [Short1]),\n) <fig1>\n\n\n#figure(\n    rect(height:10cm, width: 5cm, fill: blue),\n    caption: ffcaption([A curious figure.], [Short2 for]),\n) <fig2>\n\n\n#figure(\n    table(\n        columns: 2,\n        stroke: (_, y) => (\n            top: if y <= 1 { 1pt } else { 0pt },\n            bottom: 1pt,\n        ),\n        [*Amount*], [*Ingredient*],\n        [360g], [Baking flour],\n        [Drizzle], [Vanilla extract],\n    ),\n    caption: ffcaption([a caption],[Table short]),\n) <tbl1>\n\n\n#figure(\n    table(\n        columns: 2,\n        stroke: (_, y) => (\n            top: if y <= 1 { 1pt } else { 0pt },\n            bottom: 1pt,\n        ),\n        [*Amount*], [*Ingredient*],\n        [360g], [Baking flour],\n    ),\n    caption: ffcaption([a caption with very very very much much long long long long of of of new new new text is o with out a n ew c],\n        [table, short2])\n) <tbl2>\n\n```\n![image|347x500](upload://eRDbpvWXugMZ7chJUNpqpOrnRT2.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 40,
      "score": 1638.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1055
    },
    {
      "id": 7586,
      "post_number": 2,
      "username": "chxp",
      "name": "chxp",
      "created_at": "2025-01-16T14:55:36.212Z",
      "updated_at": "2025-01-16T14:55:36.212Z",
      "cooked": "<p>I found I must restyle the content of the <code>outline</code> by myself. I found the following solutions, although I do not fully understand the following script.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">// from: https://github.com/typst/typst/discussions/4515\n#show outline.entry: it=&gt; if &lt;no-prefix&gt; != it.fields().at(\n    default: {},\n    \"label\",\n) [#outline.entry(\n    it.level,\n    it.element,\n    {\n        [*#it.element.caption.supplement *]\n        [*#numbering(\n            it.element.numbering,\n            ..it.element.counter.at(it.element.location()),\n        )*]\n        [*.* ]\n        // figure.caption.separator\n        it.element.caption.body\n    },\n    it.fill,\n    [#it.page]\n)&lt;no-prefix&gt;] else {it}\n\n</code></pre>",
      "raw": "I found I must restyle the content of the `outline` by myself. I found the following solutions, although I do not fully understand the following script.\n\n```typst\n// from: https://github.com/typst/typst/discussions/4515\n#show outline.entry: it=> if <no-prefix> != it.fields().at(\n    default: {},\n    \"label\",\n) [#outline.entry(\n    it.level,\n    it.element,\n    {\n        [*#it.element.caption.supplement *]\n        [*#numbering(\n            it.element.numbering,\n            ..it.element.counter.at(it.element.location()),\n        )*]\n        [*.* ]\n        // figure.caption.separator\n        it.element.caption.body\n    },\n    it.fill,\n    [#it.page]\n)<no-prefix>] else {it}\n\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 56.4,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 1055
    },
    {
      "id": 8059,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-31T09:57:10.075Z",
      "updated_at": "2025-01-31T09:57:10.075Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/chxp\">@chxp</a>, if the solution you found was sufficient to you, feel free to mark your reply as the accepted answer. It makes it easier for future readers to find the solution.</p>\n<hr>\n<aside class=\"quote no-group\" data-username=\"chxp\" data-post=\"2\" data-topic=\"2422\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/c/B7441C/48.png\" class=\"avatar\"> chxp:</div>\n<blockquote>\n<p>although I do not fully understand the following script</p>\n</blockquote>\n</aside>\n<p>Here’s an explanation that hopefully makes sense to you. First, I tried to “clean up” (which is subjective of course) the code and try to bring both the caption and outline styling in a similar form, so that it’s easier to compare them.</p>\n<p>Here they are:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show figure.caption: it =&gt; {\n  text(weight: \"bold\", {\n    [#it.supplement S]\n    context it.counter.display(it.numbering)\n    [.~]\n  })\n  it.body\n}\n\n#show outline.entry: it =&gt; {\n  let entry-label = it.fields().at(\"label\", default: none)\n  if entry-label == &lt;no-prefix&gt; {\n    return it\n  }\n\n  let elem = it.element\n  let new-entry = outline.entry(\n    it.level,\n    it.element,\n    {\n      text(weight: \"bold\", {\n        [#it.element.caption.supplement S]\n        numbering(it.element.numbering, ..it.element.counter.at(it.element.location()))\n        [.~]\n      })\n      // figure.caption.separator\n      it.element.caption.body\n    },\n    it.fill,\n    [#it.page]\n  )\n  [#new-entry&lt;no-prefix&gt;]\n}\n</code></pre>\n<p>The cleanup mostly consisted of</p>\n<ul>\n<li>using <code>{...}</code> instead of <code>[...]</code> in a few places so that whitespace doesn’t change the result\n<ul>\n<li>thus also breaking some of the code over multiple lines</li>\n</ul>\n</li>\n<li>use variables <code>entry-label</code>, <code>elem</code> and <code>new-entry</code> to make the code “flatter”</li>\n</ul>\n<p>Both snippets now contain a <code>text(weight: \"bold\", {...})</code> part that is in charge of the supplement and numbering; I assume that’s not the problem, but the surrounding code.</p>\n<p>This code contains a show rule for <code>outline.entry</code> that creates a new <code>outline.entry</code> when it runs. Without any countermeasures, this would lead to infinite recursion: There is a new entry? Run the show rule! Now there’s an <em>even newer</em> entry, so run the show rule again!</p>\n<p>To solve this, the show rule must recognize whether it is processing an entry that it itself created. The following code does this:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">// get the label of the entry. a regular entry won't have one\nlet entry-label = it.fields().at(\"label\", default: none)\n// if the label is present, return the entry unmodified, preventing another run of the show rule\nif entry-label == &lt;no-prefix&gt; {\n  return it\n}\n\nlet new-entry = ...\n// return the new entry, but first attach a label to it\n[#new-entry&lt;no-prefix&gt;]\n</code></pre>\n<p>(the old code had a big <code>if ... [...] else {it}</code> that achieved the same, but this way I think it’s more obvious what the <code>return it</code> is connected to)</p>",
      "raw": "Hi @chxp, if the solution you found was sufficient to you, feel free to mark your reply as the accepted answer. It makes it easier for future readers to find the solution.\n\n---\n\n[quote=\"chxp, post:2, topic:2422\"]\nalthough I do not fully understand the following script\n[/quote]\n\nHere's an explanation that hopefully makes sense to you. First, I tried to \"clean up\" (which is subjective of course) the code and try to bring both the caption and outline styling in a similar form, so that it's easier to compare them.\n\nHere they are:\n\n```typ\n#show figure.caption: it => {\n  text(weight: \"bold\", {\n    [#it.supplement S]\n    context it.counter.display(it.numbering)\n    [.~]\n  })\n  it.body\n}\n\n#show outline.entry: it => {\n  let entry-label = it.fields().at(\"label\", default: none)\n  if entry-label == <no-prefix> {\n    return it\n  }\n\n  let elem = it.element\n  let new-entry = outline.entry(\n    it.level,\n    it.element,\n    {\n      text(weight: \"bold\", {\n        [#it.element.caption.supplement S]\n        numbering(it.element.numbering, ..it.element.counter.at(it.element.location()))\n        [.~]\n      })\n      // figure.caption.separator\n      it.element.caption.body\n    },\n    it.fill,\n    [#it.page]\n  )\n  [#new-entry<no-prefix>]\n}\n```\n\nThe cleanup mostly consisted of\n- using `{...}` instead of `[...]` in a few places so that whitespace doesn't change the result\n  - thus also breaking some of the code over multiple lines\n- use variables `entry-label`, `elem` and `new-entry` to make the code \"flatter\"\n\nBoth snippets now contain a `text(weight: \"bold\", {...})` part that is in charge of the supplement and numbering; I assume that's not the problem, but the surrounding code.\n\nThis code contains a show rule for `outline.entry` that creates a new `outline.entry` when it runs. Without any countermeasures, this would lead to infinite recursion: There is a new entry? Run the show rule! Now there's an _even newer_ entry, so run the show rule again!\n\nTo solve this, the show rule must recognize whether it is processing an entry that it itself created. The following code does this:\n\n```typc\n// get the label of the entry. a regular entry won't have one\nlet entry-label = it.fields().at(\"label\", default: none)\n// if the label is present, return the entry unmodified, preventing another run of the show rule\nif entry-label == <no-prefix> {\n  return it\n}\n\nlet new-entry = ...\n// return the new entry, but first attach a label to it\n[#new-entry<no-prefix>]\n```\n(the old code had a big `if ... [...] else {it}` that achieved the same, but this way I think it's more obvious what the `return it` is connected to)",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 26,
      "score": 30.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:52:49.513839"
}
{
  "topic_metadata": {
    "id": 2425,
    "title": "Is it possible to show and hide text blocks based on a conditional?",
    "slug": "is-it-possible-to-show-and-hide-text-blocks-based-on-a-conditional",
    "posts_count": 5,
    "created_at": "2025-01-15T19:51:36.565Z",
    "last_posted_at": "2025-01-15T22:26:47.785Z",
    "views": 231,
    "like_count": 1,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "flokl",
    "tags": [
      "scripting",
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 426
  },
  "posts": [
    {
      "id": 7550,
      "post_number": 1,
      "username": "kfold3",
      "name": "Ali",
      "created_at": "2025-01-15T19:51:36.737Z",
      "updated_at": "2025-01-15T19:55:27.618Z",
      "cooked": "<p>I have writing an examination paper for my students in which I am simultaneously writing the solutions as well. When I am done, I’d like to simply set a flag which hides all the blocks with the solutions rather than me commenting each solution block out. Is it possible to do something like the following</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">flag_for_solution = false\n\n*Question x.* Question statement\n\n// solution block\nif flag_for_solution \n   #block(fill: luma(230), inset: 8pt,radius: 4pt, width:100%) \n   [ \n     Solutions in this block\n   ]\nelse don't show the block\n</code></pre>\n<p>For comparison purposes, I do something similar in latex using the <code>comments</code> package, which works something like this</p>\n<pre data-code-wrap=\"tex\"><code class=\"lang-tex\">\\includecomment{solution}  # shows the block\n\\excludecomment{solution}  # hides the block\n\n\\begin{document}\n   \\begin{solution}\n      Solution here\n   \\end{solution}\n\\end{document}\n</code></pre>",
      "raw": "I have writing an examination paper for my students in which I am simultaneously writing the solutions as well. When I am done, I'd like to simply set a flag which hides all the blocks with the solutions rather than me commenting each solution block out. Is it possible to do something like the following\n\n```typ\nflag_for_solution = false\n\n*Question x.* Question statement\n\n// solution block\nif flag_for_solution \n   #block(fill: luma(230), inset: 8pt,radius: 4pt, width:100%) \n   [ \n     Solutions in this block\n   ]\nelse don't show the block\n```\nFor comparison purposes, I do something similar in latex using the `comments` package, which works something like this \n\n```tex\n\\includecomment{solution}  # shows the block\n\\excludecomment{solution}  # hides the block\n\n\\begin{document}\n   \\begin{solution}\n      Solution here\n   \\end{solution}\n\\end{document}\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 1011.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 998
    },
    {
      "id": 7551,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2025-01-15T20:20:48.699Z",
      "updated_at": "2025-01-15T20:21:25.733Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/kfold3\">@kfold3</a> welcome!</p>\n<p>That’s definitely possible with Typst! You might find the <a href=\"https://typst.app/docs/reference/scripting/\">documentation</a> helpful, but your example code almost works.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let flag_for_solution = false\n\n*Question x.* Question statement\n\n// solution block\n#if flag_for_solution [ \n   #block(fill: luma(230), inset: 8pt,radius: 4pt, width:100%)[ \n     Solutions in this block\n   ]\n ]\nelse don't show the block\n</code></pre>\n<details>\n<summary>\nOutput</summary>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/93102f251745e62fcbe5dd0c4500c2c5c6d2e03b.png\" data-download-href=\"https://forum.typst.app/uploads/default/93102f251745e62fcbe5dd0c4500c2c5c6d2e03b\" title=\"1\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/93102f251745e62fcbe5dd0c4500c2c5c6d2e03b_2_690x196.png\" alt=\"1\" data-base62-sha1=\"kYYRtFMVUfRT7HMfHUxghRV23cD\" width=\"690\" height=\"196\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/93102f251745e62fcbe5dd0c4500c2c5c6d2e03b_2_690x196.png, https://forum.typst.app/uploads/default/optimized/2X/9/93102f251745e62fcbe5dd0c4500c2c5c6d2e03b_2_1035x294.png 1.5x, https://forum.typst.app/uploads/default/original/2X/9/93102f251745e62fcbe5dd0c4500c2c5c6d2e03b.png 2x\" data-dominant-color=\"FEFEFE\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">1</span><span class=\"informations\">1191×339 27.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/4/4a5dbbaf6338c34f6e3cd52e37a6d6bd4fac5914.png\" data-download-href=\"https://forum.typst.app/uploads/default/4a5dbbaf6338c34f6e3cd52e37a6d6bd4fac5914\" title=\"2\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/4/4a5dbbaf6338c34f6e3cd52e37a6d6bd4fac5914_2_690x238.png\" alt=\"2\" data-base62-sha1=\"aBS9CoC788KX0MXwScloNMZfAkk\" width=\"690\" height=\"238\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/4/4a5dbbaf6338c34f6e3cd52e37a6d6bd4fac5914_2_690x238.png, https://forum.typst.app/uploads/default/optimized/2X/4/4a5dbbaf6338c34f6e3cd52e37a6d6bd4fac5914_2_1035x357.png 1.5x, https://forum.typst.app/uploads/default/original/2X/4/4a5dbbaf6338c34f6e3cd52e37a6d6bd4fac5914.png 2x\" data-dominant-color=\"FBFBFB\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">2</span><span class=\"informations\">1191×412 37.4 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>",
      "raw": "Hi @kfold3 welcome!\n\nThat's definitely possible with Typst! You might find the [documentation](https://typst.app/docs/reference/scripting/) helpful, but your example code almost works.\n```typ\n#let flag_for_solution = false\n\n*Question x.* Question statement\n\n// solution block\n#if flag_for_solution [ \n   #block(fill: luma(230), inset: 8pt,radius: 4pt, width:100%)[ \n     Solutions in this block\n   ]\n ]\nelse don't show the block\n```\n\n[details=\"Output\"]\n![1|690x196](upload://kYYRtFMVUfRT7HMfHUxghRV23cD.png)\n![2|690x238](upload://aBS9CoC788KX0MXwScloNMZfAkk.png)\n[/details]",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 21.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 7552,
      "post_number": 3,
      "username": "kfold3",
      "name": "Ali",
      "created_at": "2025-01-15T20:29:57.983Z",
      "updated_at": "2025-01-15T20:29:57.983Z",
      "cooked": "<p>Thank you this is great.<br>\nAs a matter of convenience, is it possible to make a shorthand for this? Something like</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#define myblock = \n     #if flag_for_solution [ \n        #block(fill: luma(230), inset: 8pt,radius: 4pt, width:100%)[]\n\n// and then I can just do \n#myblock[\n   my text here\n]\n</code></pre>\n<p>And thanks for the welcome!  I just got started with Typst a few days ago, coming from a heavy latex background. I do wish that typst also allowed <code>\\</code> as a command prefix (i.e., <code>\\mu, \\integral, \\hat</code>) which would really help with the muscle memory as well as copying/pasting long latex snippets. I also wish that the block math was <code>$$</code> rather than a single <code>$</code>.  But other than these minor inconveniences, I am loving it!</p>",
      "raw": "Thank you this is great.  \nAs a matter of convenience, is it possible to make a shorthand for this? Something like \n```typ\n#define myblock = \n     #if flag_for_solution [ \n        #block(fill: luma(230), inset: 8pt,radius: 4pt, width:100%)[]\n\n// and then I can just do \n#myblock[\n   my text here\n]\n```\n\nAnd thanks for the welcome!  I just got started with Typst a few days ago, coming from a heavy latex background. I do wish that typst also allowed `\\` as a command prefix (i.e., `\\mu, \\integral, \\hat`) which would really help with the muscle memory as well as copying/pasting long latex snippets. I also wish that the block math was `$$` rather than a single `$`.  But other than these minor inconveniences, I am loving it!",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 32,
      "score": 46.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 998
    },
    {
      "id": 7553,
      "post_number": 4,
      "username": "flokl",
      "name": "",
      "created_at": "2025-01-15T20:32:10.394Z",
      "updated_at": "2025-01-15T20:33:28.609Z",
      "cooked": "<p>Sure I was about to add it to my post above, here it is with the use of a <a href=\"https://typst.app/docs/reference/foundations/function/\">function</a></p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let flag_for_solution = true\n\n#let solution(body) = if flag_for_solution {\n  block(fill: luma(230), inset: 8pt,radius: 4pt, width:100%, body) \n}\n\n*Question x.* Question statement\n\n// solution block\n#solution[\n  Solutions in this block\n]\nelse don't show the block\n</code></pre>",
      "raw": "Sure I was about to add it to my post above, here it is with the use of a [function](https://typst.app/docs/reference/foundations/function/)\n```typst\n#let flag_for_solution = true\n\n#let solution(body) = if flag_for_solution {\n  block(fill: luma(230), inset: 8pt,radius: 4pt, width:100%, body) \n}\n\n*Question x.* Question statement\n\n// solution block\n#solution[\n  Solutions in this block\n]\nelse don't show the block\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 51.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 7556,
      "post_number": 5,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-15T22:26:47.785Z",
      "updated_at": "2025-01-15T22:26:47.785Z",
      "cooked": "<p>In addition to this technique, there are already a few packages based on it that may provide you with some additional desirable features, or inspiration on how to implement them. see here: <a href=\"https://typst.app/universe/search?q=exam\">search results for “exam”</a></p>",
      "raw": "In addition to this technique, there are already a few packages based on it that may provide you with some additional desirable features, or inspiration on how to implement them. see here: [search results for \"exam\"](https://typst.app/universe/search?q=exam)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 10.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:52:48.789267"
}
{
  "topic_metadata": {
    "id": 2430,
    "title": "Is it possible to link my personal account to my company account?",
    "slug": "is-it-possible-to-link-my-personal-account-to-my-company-account",
    "posts_count": 2,
    "created_at": "2025-01-15T22:52:44.418Z",
    "last_posted_at": "2025-01-18T19:55:02.530Z",
    "views": 58,
    "like_count": 0,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "laurmaedje",
    "tags": [
      "web-app"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 104
  },
  "posts": [
    {
      "id": 7559,
      "post_number": 1,
      "username": "Thomas_Browne",
      "name": "Delphos AI",
      "created_at": "2025-01-15T22:52:44.523Z",
      "updated_at": "2025-01-16T08:19:52.365Z",
      "cooked": "<p>Hi I have just purchased a 5-person Pro pack for my company, but I have a personal account and I’d like to know if it’s possible to link my personal account to my company account so that I can access both personal and company projects from one login? On github for example I can create a paid-for “organisation” and be a member of that from my personal account.</p>",
      "raw": "Hi I have just purchased a 5-person Pro pack for my company, but I have a personal account and I’d like to know if it’s possible to link my personal account to my company account so that I can access both personal and company projects from one login? On github for example I can create a paid-for “organisation” and be a member of that from my personal account.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 10.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1057
    },
    {
      "id": 7635,
      "post_number": 2,
      "username": "laurmaedje",
      "name": "Laurenz Mädje",
      "created_at": "2025-01-18T19:55:02.530Z",
      "updated_at": "2025-01-18T21:09:35.876Z",
      "cooked": "<p>You cannot link two accounts in that way. But you can create a team and join it with your personal account and the effect should be similar to how GitHub organizations work.</p>",
      "raw": "You cannot link two accounts in that way. But you can create a team and join it with your personal account and the effect should be similar to how GitHub organizations work.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 4.2,
      "accepted_answer": true,
      "trust_level": 4,
      "user_id": 2
    }
  ],
  "scraped_at": "2025-06-10T09:52:48.040300"
}
{
  "topic_metadata": {
    "id": 2434,
    "title": "Why does layout diverge with automatic theorem numbering?",
    "slug": "why-does-layout-diverge-with-automatic-theorem-numbering",
    "posts_count": 3,
    "created_at": "2025-01-16T05:44:08.835Z",
    "last_posted_at": "2025-01-17T14:02:05.584Z",
    "views": 89,
    "like_count": 0,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "scripting",
      "layout",
      "introspection"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 530
  },
  "posts": [
    {
      "id": 7564,
      "post_number": 1,
      "username": "Void",
      "name": "Void",
      "created_at": "2025-01-16T05:44:09.078Z",
      "updated_at": "2025-01-17T14:01:44.227Z",
      "cooked": "<p>I am working on a library for automatic theorem numbering when I encountered some “layout did not converge within 5 attempts” issue. The minimal reproducing example is this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let section(loc) = (counter(heading).at(loc).at(0, default: 0), )\n\n#let create-theorem(thm-name, heading-provider, thm-counter, last-heading-state) = body =&gt; block[\n  #context {\n    let curr-heading = heading-provider(here())\n    if (last-heading-state.get() != curr-heading) {\n      thm-counter.update(0)\n      last-heading-state.update(curr-heading)\n    }\n  }\n  #thm-counter.step()\n  #context strong[#thm-name #numbering(\"1.\", ..(heading-provider(here()) + thm-counter.get()))]\n  #body\n]\n\n#let theorem = create-theorem(\"Theorem\", section, counter(\"theorem\"), state(\"last-heading-thm\"))\n#let corollary = create-theorem(\"Corollary\", loc =&gt; section(loc) + counter(\"theorem\").at(loc), counter(\"corollary\"), state(\"last-heading-cor\"))\n\n#set heading(numbering: \"1.\")\n= \n#theorem[]\n#theorem[]\n#corollary[]\n#corollary[]\n</code></pre>\n<p>Here, each theorem-like environment uses a heading function, a counter to number the theorems, and a state to track whether we should reset this counter.<br>\nFor example, we would expect theorems to be numbered absolutely and reset at each section as ., and corollaries to be attached to theorems, numbered as ...<br>\nHowever, once I add 2 theorems and 2 corollaries, as in this example, the layout does not converge.<br>\nI have completely no idea why this example would diverge, but here’s a few observations:</p>\n<ul>\n<li>If we change the definition of <span class=\"hashtag-raw\">#theorem</span> and <span class=\"hashtag-raw\">#corollary</span> to:</li>\n</ul>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let theorem = create-theorem(\"Theorem\", loc =&gt; (), counter(\"theorem\"), state(\"last-heading-thm\"))\n#let corollary = create-theorem(\"Corollary\", loc =&gt; counter(\"theorem\").at(loc), counter(\"corollary\"), state(\"last-heading-cor\"))\n</code></pre>\n<p>The example will then converge, so the heading counter somehow plays a role here. (But it is constant throughout the layout. How?)</p>\n<ul>\n<li>If we change the definition of <span class=\"hashtag-raw\">#corollary</span> to:</li>\n</ul>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let corollary = create-theorem(\"Corollary\", section, counter(\"corollary\"), state(\"last-heading-cor\"))\n</code></pre>\n<p>to not depend on counter(“theorem”), then it would also converge. So counter(“theorem”) somehow also plays a role here.</p>\n<ul>\n<li>If you only have 1 theorem and 2 corollaries, or 2 theorems and 1 corollary, everything converges. Only when you increase to 2 theorems and 2 corollaries does the layout diverge.</li>\n</ul>\n<p>I’d like to know why this behavior happens and how to fix it.</p>",
      "raw": "I am working on a library for automatic theorem numbering when I encountered some \"layout did not converge within 5 attempts\" issue. The minimal reproducing example is this:\n\n```typ\n#let section(loc) = (counter(heading).at(loc).at(0, default: 0), )\n\n#let create-theorem(thm-name, heading-provider, thm-counter, last-heading-state) = body => block[\n  #context {\n    let curr-heading = heading-provider(here())\n    if (last-heading-state.get() != curr-heading) {\n      thm-counter.update(0)\n      last-heading-state.update(curr-heading)\n    }\n  }\n  #thm-counter.step()\n  #context strong[#thm-name #numbering(\"1.\", ..(heading-provider(here()) + thm-counter.get()))]\n  #body\n]\n\n#let theorem = create-theorem(\"Theorem\", section, counter(\"theorem\"), state(\"last-heading-thm\"))\n#let corollary = create-theorem(\"Corollary\", loc => section(loc) + counter(\"theorem\").at(loc), counter(\"corollary\"), state(\"last-heading-cor\"))\n\n#set heading(numbering: \"1.\")\n= \n#theorem[]\n#theorem[]\n#corollary[]\n#corollary[]\n```\n\nHere, each theorem-like environment uses a heading function, a counter to number the theorems, and a state to track whether we should reset this counter. \nFor example, we would expect theorems to be numbered absolutely and reset at each section as <section-index>.<thm-index>, and corollaries to be attached to theorems, numbered as <section-index>.<thm-index>.<cor-index>. \nHowever, once I add 2 theorems and 2 corollaries, as in this example, the layout does not converge. \nI have completely no idea why this example would diverge, but here's a few observations: \n- If we change the definition of #theorem and #corollary to: \n```typ\n#let theorem = create-theorem(\"Theorem\", loc => (), counter(\"theorem\"), state(\"last-heading-thm\"))\n#let corollary = create-theorem(\"Corollary\", loc => counter(\"theorem\").at(loc), counter(\"corollary\"), state(\"last-heading-cor\"))\n```\nThe example will then converge, so the heading counter somehow plays a role here. (But it is constant throughout the layout. How?)\n- If we change the definition of #corollary to: \n```typ\n#let corollary = create-theorem(\"Corollary\", section, counter(\"corollary\"), state(\"last-heading-cor\"))\n```\nto not depend on counter(\"theorem\"), then it would also converge. So counter(\"theorem\") somehow also plays a role here. \n- If you only have 1 theorem and 2 corollaries, or 2 theorems and 1 corollary, everything converges. Only when you increase to 2 theorems and 2 corollaries does the layout diverge. \n\nI'd like to know why this behavior happens and how to fix it.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 180.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1058
    },
    {
      "id": 7568,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-01-16T09:10:33.801Z",
      "updated_at": "2025-01-16T09:10:33.801Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/void\">@Void</a>,</p>\n<p>There is a hint provided</p>\n<pre data-code-wrap=\"shell\"><code class=\"lang-shell\">= hint: check if any states or queries are updating themselves\n</code></pre>\n<p>In your code, you write a conditional that checks the value of a state, and updates it.</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">if (last-heading-state.get() != curr-heading) {\n  thm-counter.update(0)\n  last-heading-state.update(curr-heading)\n}\n</code></pre>\n<p>that should be the source of your issues.</p>\n<p>You can look up a great example of how to manage counter at <a href=\"https://github.com/jbirnick/typst-rich-counters/blob/main/lib.typ\"><code>rich-counters</code></a>. It is used jointly with <a href=\"https://github.com/jbirnick/typst-great-theorems\"><code>great-theorems</code></a> to provide theorems environments.</p>",
      "raw": "Hello @Void,\n\nThere is a hint provided\n\n```shell\n= hint: check if any states or queries are updating themselves\n```\n\nIn your code, you write a conditional that checks the value of a state, and updates it.\n\n```typc\nif (last-heading-state.get() != curr-heading) {\n  thm-counter.update(0)\n  last-heading-state.update(curr-heading)\n}\n```\n\nthat should be the source of your issues.\n\nYou can look up a great example of how to manage counter at [`rich-counters`](https://github.com/jbirnick/typst-rich-counters/blob/main/lib.typ). It is used jointly with [`great-theorems`](https://github.com/jbirnick/typst-great-theorems) to provide theorems environments.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 20.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 7607,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-01-17T14:02:05.584Z",
      "updated_at": "2025-01-17T14:02:05.584Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/void\">@Void</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Void, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 9.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:52:47.346528"
}
{
  "topic_metadata": {
    "id": 2437,
    "title": "How do I fix the warning “counter.display without context is deprecated",
    "slug": "how-do-i-fix-the-warning-counter-display-without-context-is-deprecated",
    "posts_count": 7,
    "created_at": "2025-01-16T09:29:55.692Z",
    "last_posted_at": "2025-01-16T10:23:05.664Z",
    "views": 163,
    "like_count": 2,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "counter",
      "context"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 375
  },
  "posts": [
    {
      "id": 7570,
      "post_number": 1,
      "username": "This_isYE",
      "name": "This isYE",
      "created_at": "2025-01-16T09:29:55.882Z",
      "updated_at": "2025-01-16T10:08:01.216Z",
      "cooked": "<p>New to typst,</p>\n<p>when defining the appendix function:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// Define the appendix function\n#let appendix = it =&gt; {\n  appendix_counter.step(); // Increment the counter\n  heading(numbering:none , supplement: \"Appendix\")[\n    A#lower[ppendix] \n    #appendix_counter.display(\"A.\")  #swiggly line here\n    #h(5pt)\n    #it\n  ]\n}\n</code></pre>\n<p>I keep getting  this error:</p>\n<pre><code class=\"lang-auto\">caused this warning:\n`counter.display `without context is deprecated\n\nUse it in a `context` expression instead\n</code></pre>\n<p>What should I do?</p>",
      "raw": "New to typst,\n\nwhen defining the appendix function:\n```typ \n// Define the appendix function\n#let appendix = it => {\n  appendix_counter.step(); // Increment the counter\n  heading(numbering:none , supplement: \"Appendix\")[\n    A#lower[ppendix] \n    #appendix_counter.display(\"A.\")  #swiggly line here\n    #h(5pt)\n    #it\n  ]\n}\n```\n\nI keep getting  this error: \n```\ncaused this warning:\n`counter.display `without context is deprecated\n\nUse it in a `context` expression instead\n```\nWhat should I do?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 719.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1060
    },
    {
      "id": 7572,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-01-16T09:40:38.482Z",
      "updated_at": "2025-01-16T09:40:38.482Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/this_isye\">@This_isYE</a>, please update your question your topic! I think something like “How do I fix the warning “<code>counter.display </code>without context is deprecated””? should do.</p>\n<p>The fix is simple, you use a <a href=\"https://typst.app/docs/reference/context/\"><code>context</code></a> expression!</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#context appendix_counter.display(\"A.\")\n</code></pre>\n<p>P.S.: don’t hesitate to provide a <strong>reproducible</strong> example, for example, your code is missing the variable appendix_counter. Removing any unnecessary parts of your code to produce a <strong>minimal</strong> example also helps.</p>",
      "raw": "Hello @This_isYE, please update your question your topic! I think something like \"How do I fix the warning \"`counter.display `without context is deprecated\"\"? should do.\n\nThe fix is simple, you use a [`context`](https://typst.app/docs/reference/context/) expression!\n\n```typ\n#context appendix_counter.display(\"A.\")\n```\n\nP.S.: don't hesitate to provide a **reproducible** example, for example, your code is missing the variable appendix_counter. Removing any unnecessary parts of your code to produce a **minimal** example also helps.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 24.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 7573,
      "post_number": 3,
      "username": "This_isYE",
      "name": "This isYE",
      "created_at": "2025-01-16T09:46:14.235Z",
      "updated_at": "2025-01-16T09:46:14.235Z",
      "cooked": "<p>Sorry for the nuisance, first time here,</p>\n<p>How do I reproduce my issue here(how to run typst in question or reply ) ?</p>",
      "raw": "Sorry for the nuisance, first time here,\n\nHow do I reproduce my issue here(how to run typst in question or reply ) ?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 9.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1060
    },
    {
      "id": 7575,
      "post_number": 4,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-01-16T09:49:52.652Z",
      "updated_at": "2025-01-16T09:49:52.652Z",
      "cooked": "<p>It is absolutely not a nuisance, sorry if I sounded harsh. I meant to give you advice on how to best receive an answer promptly!</p>\n<p>You cannot run Typst on the forum, what I meant is that you should provide code that can run standalone. Basically, copy paste what you wrote in an editor and see if it compiles. If it does not, remove unnecessary elements that are not relevant to the question.</p>\n<p>Don’t hesitate to ask more questions if you need to!</p>",
      "raw": "It is absolutely not a nuisance, sorry if I sounded harsh. I meant to give you advice on how to best receive an answer promptly! \n\nYou cannot run Typst on the forum, what I meant is that you should provide code that can run standalone. Basically, copy paste what you wrote in an editor and see if it compiles. If it does not, remove unnecessary elements that are not relevant to the question.\n\nDon't hesitate to ask more questions if you need to!",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 22,
      "score": 74.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 7576,
      "post_number": 5,
      "username": "This_isYE",
      "name": "This isYE",
      "created_at": "2025-01-16T09:55:31.122Z",
      "updated_at": "2025-01-16T09:55:48.764Z",
      "cooked": "<p>okey, so code is this(with your fix):</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">//defining rules and whatnot\n....\n// Define the appendix function\n#let appendix = it =&gt; {\n  appendix_counter.step(); // Increment the counter\n  heading(numbering:none , supplement: \"Appendix\")[\n    A#lower[ppendix] \n    #context appendix_counter.display(\"A.\") \n    #h(5pt)\n    #it\n  ]\n}\n\n//body goes here\n\n//example of appendix\n#appendix[Global Result]\n        #line(length: 100%, stroke: 0.7pt)\n</code></pre>\n<p>Result (this is an image, i still do not know how to make code run here<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/9940cec11282b5d4ecd6f41386c6c63b07600aec.png\" data-download-href=\"https://forum.typst.app/uploads/default/9940cec11282b5d4ecd6f41386c6c63b07600aec\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/9940cec11282b5d4ecd6f41386c6c63b07600aec_2_690x61.png\" alt=\"image\" data-base62-sha1=\"lRJTXX4hpMweA3tRAnOA0CqnG4A\" width=\"690\" height=\"61\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/9940cec11282b5d4ecd6f41386c6c63b07600aec_2_690x61.png, https://forum.typst.app/uploads/default/original/2X/9/9940cec11282b5d4ecd6f41386c6c63b07600aec.png 1.5x, https://forum.typst.app/uploads/default/original/2X/9/9940cec11282b5d4ecd6f41386c6c63b07600aec.png 2x\" data-dominant-color=\"F9F9F9\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">853×76 3.94 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>when calling <a class=\"hashtag-cooked\" href=\"/tag/outline\" data-type=\"tag\" data-slug=\"outline\" data-id=\"83\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>outline</span></a> it shows like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\"> #outline()\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/926ce68819d5c917f42e0053953a4e9d562fb56c.png\" data-download-href=\"https://forum.typst.app/uploads/default/926ce68819d5c917f42e0053953a4e9d562fb56c\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/926ce68819d5c917f42e0053953a4e9d562fb56c_2_690x44.png\" alt=\"image\" data-base62-sha1=\"kTl1NkhhArQpcFeYL0ojXoQTgyE\" width=\"690\" height=\"44\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/926ce68819d5c917f42e0053953a4e9d562fb56c_2_690x44.png, https://forum.typst.app/uploads/default/original/2X/9/926ce68819d5c917f42e0053953a4e9d562fb56c.png 1.5x, https://forum.typst.app/uploads/default/original/2X/9/926ce68819d5c917f42e0053953a4e9d562fb56c.png 2x\" data-dominant-color=\"F7F7F7\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">696×45 5.94 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>is there a way to get the A in appendix A to show also in the outline</p>",
      "raw": "okey, so code is this(with your fix):\n\n\n```typ\n//defining rules and whatnot\n....\n// Define the appendix function\n#let appendix = it => {\n  appendix_counter.step(); // Increment the counter\n  heading(numbering:none , supplement: \"Appendix\")[\n    A#lower[ppendix] \n    #context appendix_counter.display(\"A.\") \n    #h(5pt)\n    #it\n  ]\n}\n\n//body goes here\n\n//example of appendix\n#appendix[Global Result]\n        #line(length: 100%, stroke: 0.7pt)\n```\nResult (this is an image, i still do not know how to make code run here\n![image|690x61](upload://lRJTXX4hpMweA3tRAnOA0CqnG4A.png)\n\nwhen calling #outline it shows like this:\n```typ\n #outline()\n```\n![image|690x44, 100%](upload://kTl1NkhhArQpcFeYL0ojXoQTgyE.png)\n\nis there a way to get the A in appendix A to show also in the outline",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 19.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1060
    },
    {
      "id": 7577,
      "post_number": 6,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-01-16T10:05:39.884Z",
      "updated_at": "2025-01-16T10:05:50.581Z",
      "cooked": "<p>Unfortunately, I cannot reproduce your issue with the outline, it shows up on my side.</p>",
      "raw": "Unfortunately, I cannot reproduce your issue with the outline, it shows up on my side.",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 8.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 7578,
      "post_number": 7,
      "username": "This_isYE",
      "name": "This isYE",
      "created_at": "2025-01-16T10:23:05.664Z",
      "updated_at": "2025-01-16T10:23:05.664Z",
      "cooked": "<p>can you provide code?</p>",
      "raw": "can you provide code?",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 15,
      "score": 3.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1060
    }
  ],
  "scraped_at": "2025-06-10T09:52:46.593183"
}
{
  "topic_metadata": {
    "id": 2441,
    "title": "How do I create a block with a style that can cross pages?",
    "slug": "how-do-i-create-a-block-with-a-style-that-can-cross-pages",
    "posts_count": 7,
    "created_at": "2025-01-16T12:44:59.999Z",
    "last_posted_at": "2025-01-29T12:36:03.968Z",
    "views": 177,
    "like_count": 5,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "gezepi",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 247
  },
  "posts": [
    {
      "id": 7582,
      "post_number": 1,
      "username": "TheColdPot",
      "name": "TheColdPot",
      "created_at": "2025-01-16T12:45:00.234Z",
      "updated_at": "2025-01-17T07:43:58.796Z",
      "cooked": "<p>I can use <code>box</code> to create a block with a style (such as a background). But as a <code>box</code>, this prevents from the block from crossing pages. How can I achieve a cross-page one?</p>",
      "raw": "I can use `box` to create a block with a style (such as a background). But as a `box`, this prevents from the block from crossing pages. How can I achieve a cross-page one?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 276.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 495
    },
    {
      "id": 7592,
      "post_number": 2,
      "username": "gezepi",
      "name": "",
      "created_at": "2025-01-17T07:00:29.758Z",
      "updated_at": "2025-01-29T12:37:32.582Z",
      "cooked": "<p>Does this achieve the result you’re looking for?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(\"a6\")\n\n#lorem(60)\n\n#block(\n  //breakable: true, //defaults to true as pointed out by laurmaedje\n  stroke: red,\n  radius: 1em,\n  outset: .5em\n)[\n  #lorem(60)\n\n  #lorem(60)\n]\n</code></pre>\n<details>\n<summary>\nOutput</summary>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/810649b01cf752ebd3aee9c07bd7f47cd2efeab7.png\" data-download-href=\"https://forum.typst.app/uploads/default/810649b01cf752ebd3aee9c07bd7f47cd2efeab7\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/810649b01cf752ebd3aee9c07bd7f47cd2efeab7_2_244x499.png\" alt=\"image\" data-base62-sha1=\"ipp43866f8VWCKbQ6EWLbxM9eUn\" width=\"244\" height=\"499\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/8/810649b01cf752ebd3aee9c07bd7f47cd2efeab7_2_244x499.png, https://forum.typst.app/uploads/default/optimized/2X/8/810649b01cf752ebd3aee9c07bd7f47cd2efeab7_2_366x748.png 1.5x, https://forum.typst.app/uploads/default/original/2X/8/810649b01cf752ebd3aee9c07bd7f47cd2efeab7.png 2x\" data-dominant-color=\"EFEDEE\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">425×868 110 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>\n<p>The key here is <code>breakable: true</code> so that the block is allowed to be broken into multiple parts at the page boundaries.</p>",
      "raw": "Does this achieve the result you're looking for?\n\n```typ\n#set page(\"a6\")\n\n#lorem(60)\n\n#block(\n  //breakable: true, //defaults to true as pointed out by laurmaedje\n  stroke: red,\n  radius: 1em,\n  outset: .5em\n)[\n  #lorem(60)\n\n  #lorem(60)\n]\n```\n\n[details=\"Output\"]\n![image|244x499](upload://ipp43866f8VWCKbQ6EWLbxM9eUn.png)\n[/details]\n\nThe key here is `breakable: true` so that the block is allowed to be broken into multiple parts at the page boundaries.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 21.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 326
    },
    {
      "id": 7593,
      "post_number": 3,
      "username": "laurmaedje",
      "name": "Laurenz Mädje",
      "created_at": "2025-01-17T07:24:41.006Z",
      "updated_at": "2025-01-17T07:24:41.006Z",
      "cooked": "<p>Blocks are actually breakable by default. The important thing is: Use a block, not a box. A box is specifically for making something <em>inline</em>, i.e. in lines with text in a paragraph.</p>",
      "raw": "Blocks are actually breakable by default. The important thing is: Use a block, not a box. A box is specifically for making something _inline_, i.e. in lines with text in a paragraph.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 32,
      "score": 56.4,
      "accepted_answer": false,
      "trust_level": 4,
      "user_id": 2
    },
    {
      "id": 7726,
      "post_number": 4,
      "username": "Bolt",
      "name": "",
      "created_at": "2025-01-20T23:00:37.630Z",
      "updated_at": "2025-01-20T23:00:37.630Z",
      "cooked": "<p>Is there a way to do this without having the bottom border at the end of a page, or top border at the start of a page? They give the appearance that the entire block is visible.</p>",
      "raw": "Is there a way to do this without having the bottom border at the end of a page, or top border at the start of a page? They give the appearance that the entire block is visible.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 4.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 737
    },
    {
      "id": 7986,
      "post_number": 5,
      "username": "TheColdPot",
      "name": "TheColdPot",
      "created_at": "2025-01-29T11:45:28.250Z",
      "updated_at": "2025-01-29T11:45:28.250Z",
      "cooked": "<p>Thank you! It solved the case. Sorry that I can only set one answer as the solution.</p>",
      "raw": "Thank you! It solved the case. Sorry that I can only set one answer as the solution.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 3.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 495
    },
    {
      "id": 7987,
      "post_number": 6,
      "username": "TheColdPot",
      "name": "TheColdPot",
      "created_at": "2025-01-29T11:58:53.272Z",
      "updated_at": "2025-01-29T11:58:53.272Z",
      "cooked": "<p>Sorry for disturbing. However, can I set a style for those cross pages? For example, I want to disable the rounded corner at the junction of the pages, can I achieve that in a simple way?</p>",
      "raw": "Sorry for disturbing. However, can I set a style for those cross pages? For example, I want to disable the rounded corner at the junction of the pages, can I achieve that in a simple way?",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 15,
      "score": 23.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 495
    },
    {
      "id": 7988,
      "post_number": 7,
      "username": "gezepi",
      "name": "",
      "created_at": "2025-01-29T12:36:03.968Z",
      "updated_at": "2025-01-29T12:36:03.968Z",
      "cooked": "<p>To my knowledge there is no way to style a block like that.  I would be happy if someone proves me wrong though.</p>",
      "raw": "To my knowledge there is no way to style a block like that.  I would be happy if someone proves me wrong though.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 15,
      "score": 23.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 326
    }
  ],
  "scraped_at": "2025-06-10T09:52:45.501377"
}
{
  "topic_metadata": {
    "id": 2448,
    "title": "How could I display no headings in the PDF?",
    "slug": "how-could-i-display-no-headings-in-the-pdf",
    "posts_count": 2,
    "created_at": "2025-01-17T12:28:55.808Z",
    "last_posted_at": "2025-01-17T12:34:43.521Z",
    "views": 49,
    "like_count": 1,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 90
  },
  "posts": [
    {
      "id": 7601,
      "post_number": 1,
      "username": "chxp",
      "name": "chxp",
      "created_at": "2025-01-17T12:28:55.963Z",
      "updated_at": "2025-01-17T12:29:43.666Z",
      "cooked": "<p>How could I display no headings in the PDF? (Removing them completely and not filling them with white.)</p>\n<p>I use the heading to classify the content and fold the content under the heading in the script.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set page(\"a4\", margin: auto)\n\n= red pic\n// figure\n#figure(\n    rect(height:6cm, width: 11cm, fill: red),\n    caption: [A curious figure.],\n) &lt;fig1&gt;\n\n#figure(\n    rect(height:10cm, width: 5cm, fill: red),\n    caption: [A curious figure.],\n) &lt;fig2&gt;\n\n= blue pic\n#figure(\n    rect(height:2cm, width: 8cm, fill: blue),\n    caption: [A curious figure.],\n) &lt;fig3&gt;\n\n</code></pre>",
      "raw": "How could I display no headings in the PDF? (Removing them completely and not filling them with white.)\n\nI use the heading to classify the content and fold the content under the heading in the script.\n\n```typst\n#set page(\"a4\", margin: auto)\n\n= red pic\n// figure\n#figure(\n    rect(height:6cm, width: 11cm, fill: red),\n    caption: [A curious figure.],\n) <fig1>\n\n#figure(\n    rect(height:10cm, width: 5cm, fill: red),\n    caption: [A curious figure.],\n) <fig2>\n\n= blue pic\n#figure(\n    rect(height:2cm, width: 8cm, fill: blue),\n    caption: [A curious figure.],\n) <fig3>\n\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 25.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1055
    },
    {
      "id": 7602,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-01-17T12:34:43.521Z",
      "updated_at": "2025-01-17T12:34:43.521Z",
      "cooked": "<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">show heading: none\n</code></pre>",
      "raw": "```typc\nshow heading: none\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 25,
      "score": 20.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    }
  ],
  "scraped_at": "2025-06-10T09:52:44.721733"
}
{
  "topic_metadata": {
    "id": 2450,
    "title": "Why does 'set' not affect the output of a user defined function?",
    "slug": "why-does-set-not-affect-the-output-of-a-user-defined-function",
    "posts_count": 9,
    "created_at": "2025-01-17T16:48:50.348Z",
    "last_posted_at": "2025-01-18T19:05:30.552Z",
    "views": 124,
    "like_count": 3,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 7,
    "accepted_answer_username": "flokl",
    "tags": [
      "scripting",
      "styling"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 806
  },
  "posts": [
    {
      "id": 7610,
      "post_number": 1,
      "username": "Simon",
      "name": "Simon",
      "created_at": "2025-01-17T16:48:50.512Z",
      "updated_at": "2025-01-18T19:04:34.180Z",
      "cooked": "<p>Hi, folks!</p>\n<p>I’m trying to understand <em>set</em> with user defined functions and I’m confused about this behavour as I’m not able to use <em>set</em> to alter the width of the block created in the function <em>opening</em>.</p>\n<p>Any ideas? Thanks in advance, Simon</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let opening(txt)=block(width:400pt, text(size: 40pt,txt))\n\n//sets on document level\n#set text(size: 20pt) //as expected, changes only font size of document scoped block\n#set block(width:200pt) //as expected, changes only width of document scoped block\n\n//function call\n#opening([\n//sets in the scope of the function\n#set text(size: 10pt) //as expected, changes only font size of functional created text \n#set block(width:800pt) //not working, does not change width of functional created block\n#lorem(30)]\n)\n\n//a block created in document scope\n#block(\n  inset: 12pt,\n  radius: 4pt,\n  lorem(30),\n)\n\n\n</code></pre>",
      "raw": "Hi, folks! \n\nI'm trying to understand *set* with user defined functions and I'm confused about this behavour as I'm not able to use *set* to alter the width of the block created in the function *opening*. \n\nAny ideas? Thanks in advance, Simon\n\n```typ //function with ist own scope?\n#let opening(txt)=block(width:400pt, text(size: 40pt,txt))\n\n//sets on document level\n#set text(size: 20pt) //as expected, changes only font size of document scoped block\n#set block(width:200pt) //as expected, changes only width of document scoped block\n\n//function call\n#opening([\n//sets in the scope of the function\n#set text(size: 10pt) //as expected, changes only font size of functional created text \n#set block(width:800pt) //not working, does not change width of functional created block\n#lorem(30)]\n)\n\n//a block created in document scope\n#block(\n  inset: 12pt,\n  radius: 4pt,\n  lorem(30),\n)\n\n\n ```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 241.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1062
    },
    {
      "id": 7613,
      "post_number": 2,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2025-01-17T19:59:57.622Z",
      "updated_at": "2025-01-17T20:16:56.399Z",
      "cooked": "<p>Please give some more information on the problem at hand. What outcome do you expect and how does the actual output differ from that?</p>\n<p>[ To me everything seems to be working es expected. ]</p>\n<p>PS: you should probably adjust your title according to the guidlines of this forum. Therefore please reformulate it as a question. Thanks ;)</p>",
      "raw": "Please give some more information on the problem at hand. What outcome do you expect and how does the actual output differ from that?\n\n[ To me everything seems to be working es expected. ]\n\n\nPS: you should probably adjust your title according to the guidlines of this forum. Therefore please reformulate it as a question. Thanks ;)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 5.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 7614,
      "post_number": 3,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2025-01-17T20:12:42.369Z",
      "updated_at": "2025-01-17T20:14:49.642Z",
      "cooked": "<p>Maybe you should have a look at this slightly changed example. Here I added strokes to the three different calls to <code>block</code> to clarify where you use all of them.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let opening(txt)=block(width:200pt, stroke: black, text(size: 40pt,txt))\n\n//sets on document level\n#set text(size: 20pt) //as expected, changes only font size of document scoped block\n#set block(width:300pt, stroke: blue) //as expected, changes only width of document scoped block\n\n//function call\n#opening(\n  [\n    //sets in the scope of the function\n    #set text(size: 10pt) //as expected, changes only font size of functional created text \n    #set block(width:400pt) //not working, does not change width of functional created block\n    \n    #lorem(30)\n    #block(stroke: red, lorem(50))\n    #lorem(30)\n  ]\n)\n\n//a block created in document scope\n#block(\n  inset: 12pt,\n  radius: 4pt,\n  lorem(30),\n)\n</code></pre>\n<p>This is the output:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/7/774def3626365917fb5da4bb001f5ee20afff4a0.png\" data-download-href=\"https://forum.typst.app/uploads/default/774def3626365917fb5da4bb001f5ee20afff4a0\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/7/774def3626365917fb5da4bb001f5ee20afff4a0_2_497x500.png\" alt=\"image\" data-base62-sha1=\"h1pN9ayYhl16NfZVUEJIqYpj0je\" width=\"497\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/7/774def3626365917fb5da4bb001f5ee20afff4a0_2_497x500.png, https://forum.typst.app/uploads/default/original/2X/7/774def3626365917fb5da4bb001f5ee20afff4a0.png 1.5x, https://forum.typst.app/uploads/default/original/2X/7/774def3626365917fb5da4bb001f5ee20afff4a0.png 2x\" data-dominant-color=\"EFEFEF\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">727×731 157 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>If you want to see the affected text sequences of your calls to text more clearly (e.g. where the size is actually adjusted) you can also use the color parameter for text.</p>",
      "raw": "Maybe you should have a look at this slightly changed example. Here I added strokes to the three different calls to `block` to clarify where you use all of them.\n\n```typst\n#let opening(txt)=block(width:200pt, stroke: black, text(size: 40pt,txt))\n\n//sets on document level\n#set text(size: 20pt) //as expected, changes only font size of document scoped block\n#set block(width:300pt, stroke: blue) //as expected, changes only width of document scoped block\n\n//function call\n#opening(\n  [\n    //sets in the scope of the function\n    #set text(size: 10pt) //as expected, changes only font size of functional created text \n    #set block(width:400pt) //not working, does not change width of functional created block\n    \n    #lorem(30)\n    #block(stroke: red, lorem(50))\n    #lorem(30)\n  ]\n)\n\n//a block created in document scope\n#block(\n  inset: 12pt,\n  radius: 4pt,\n  lorem(30),\n)\n```\n\nThis is the output:\n![image|497x500](upload://h1pN9ayYhl16NfZVUEJIqYpj0je.png)\n\n\nIf you want to see the affected text sequences of your calls to text more clearly (e.g. where the size is actually adjusted) you can also use the color parameter for text.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 29,
      "score": 25.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 7615,
      "post_number": 4,
      "username": "Simon",
      "name": "Simon",
      "created_at": "2025-01-17T20:36:47.364Z",
      "updated_at": "2025-01-17T20:37:42.008Z",
      "cooked": "<p>Hi there,</p>\n<p>okay, you pass a new block to the <em>opening</em> function. So now two blocks are nested. Its interesting for me that now <em><span class=\"hashtag-raw\">#set</span> block</em> inside the call of <em>opening</em> is effecting only the most nested block.</p>\n<p>My main question is: why can I change the text size by including a <em>set text(size: …)</em> in the content of the <em>opening</em> function call, but I can not change the width of the block created in that function by using a identical <em>set block(width: …)</em>?</p>\n<p>Regards Simon</p>",
      "raw": "Hi there,\n\nokay, you pass a new block to the *opening* function. So now two blocks are nested. Its interesting for me that now *#set block* inside the call of *opening* is effecting only the most nested block.\n\nMy main question is: why can I change the text size by including a *set text(size: ...)* in the content of the *opening* function call, but I can not change the width of the block created in that function by using a identical *set block(width: ...)*?\n\nRegards Simon",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 5.0,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1062
    },
    {
      "id": 7618,
      "post_number": 5,
      "username": "Xodarap",
      "name": "Xodarap",
      "created_at": "2025-01-18T00:25:58.600Z",
      "updated_at": "2025-01-18T00:25:58.600Z",
      "cooked": "<p>The width of the block is indeed changed by the your <code>set block ...</code> statement. See the red block, it has width 400 instead of 300. (if you remove the <code>set block()</code> the red block will have width 300.</p>\n<p>It works the same as the text size.</p>\n<p>You are defining a function <code>opening</code> which creates a block with a specific size. Why would instructions inside the body of this block affect the outer block ??? (think about it for a second, this would be an absolute nightmare … xD)</p>",
      "raw": "The width of the block is indeed changed by the your `set block ...` statement. See the red block, it has width 400 instead of 300. (if you remove the `set block()` the red block will have width 300.\n\n\nIt works the same as the text size.\n\n\nYou are defining a function `opening` which creates a block with a specific size. Why would instructions inside the body of this block affect the outer block ??? (think about it for a second, this would be an absolute nightmare ... xD)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 10.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 797
    },
    {
      "id": 7623,
      "post_number": 6,
      "username": "Simon",
      "name": "Simon",
      "created_at": "2025-01-18T08:58:26.146Z",
      "updated_at": "2025-01-18T09:00:43.618Z",
      "cooked": "<p>but <em>set text(size …)</em> on line 11 in your example inside the <em>opening</em> function <strong>does</strong> change the font size in the red AND the black surrounded block…</p>",
      "raw": "but *set text(size ...)* on line 11 in your example inside the *opening* function **does** change the font size in the red AND the black surrounded block...",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 10.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1062
    },
    {
      "id": 7624,
      "post_number": 7,
      "username": "flokl",
      "name": "",
      "created_at": "2025-01-18T09:56:13.606Z",
      "updated_at": "2025-01-18T09:57:11.792Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/simon\">@Simon</a>,<br>\nas <a class=\"mention\" href=\"/u/xodarap\">@Xodarap</a> already showed with the <code>block</code>s, set rules do only affect elements after the rule and inside the same or a nested scope. It does <strong>not</strong> change the surrounding elements.<br>\nMaybe this makes it clear for you, I have inlined your <code>opening(txt)</code> function:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">//sets on document level\n#set text(size: 20pt)\n#set block(width:200pt) \n\n// Inlined \"opening(txt)\" function\n#block(\n  width:400pt, \n  text(\n    size: 40pt, \n    [\n      This is some text // Added additional text\n      //sets in the scope of the function\n      #set text(size: 10pt)\n      #set block(width:800pt) ) // There is no block below, that can be affected by the set rule\n\n      #lorem(40) // Effected by the above text set rule\n      // Equal to #text(lorem(40)) \n      // Equal to #text(size: 10pt, lorem(40)) with the above set rule applied\n    ]\n  )\n)\n\n//a block created in document scope\n#block(\n  inset: 12pt,\n  radius: 4pt,\n  lorem(30),\n)\n</code></pre>\n<details>\n<summary>\nOutput</summary>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/97e224b73f805cd37cc9bc86aa3074ab1fbf67eb.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/97e224b73f805cd37cc9bc86aa3074ab1fbf67eb\" title=\"1\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/97e224b73f805cd37cc9bc86aa3074ab1fbf67eb_2_487x499.jpeg\" alt=\"1\" data-base62-sha1=\"lFCBHtdLiQQLoPM2iv4XKpvX6wr\" width=\"487\" height=\"499\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/97e224b73f805cd37cc9bc86aa3074ab1fbf67eb_2_487x499.jpeg, https://forum.typst.app/uploads/default/optimized/2X/9/97e224b73f805cd37cc9bc86aa3074ab1fbf67eb_2_730x748.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/9/97e224b73f805cd37cc9bc86aa3074ab1fbf67eb_2_974x998.jpeg 2x\" data-dominant-color=\"F8F8F8\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">1</span><span class=\"informations\">1134×1164 98.4 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>",
      "raw": "Hi @Simon, \nas @Xodarap already showed with the `block`s, set rules do only affect elements after the rule and inside the same or a nested scope. It does **not** change the surrounding elements.\nMaybe this makes it clear for you, I have inlined your `opening(txt)` function:\n```typ\n//sets on document level\n#set text(size: 20pt)\n#set block(width:200pt) \n\n// Inlined \"opening(txt)\" function\n#block(\n  width:400pt, \n  text(\n    size: 40pt, \n    [\n      This is some text // Added additional text\n      //sets in the scope of the function\n      #set text(size: 10pt)\n      #set block(width:800pt) ) // There is no block below, that can be affected by the set rule\n\n      #lorem(40) // Effected by the above text set rule\n      // Equal to #text(lorem(40)) \n      // Equal to #text(size: 10pt, lorem(40)) with the above set rule applied\n    ]\n  )\n)\n\n//a block created in document scope\n#block(\n  inset: 12pt,\n  radius: 4pt,\n  lorem(30),\n)\n```\n\n[details=\"Output\"]\n![1|487x499](upload://lFCBHtdLiQQLoPM2iv4XKpvX6wr.jpeg)\n[/details]",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 26,
      "score": 50.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 7627,
      "post_number": 8,
      "username": "Simon",
      "name": "Simon",
      "created_at": "2025-01-18T12:49:46.188Z",
      "updated_at": "2025-01-18T12:49:46.188Z",
      "cooked": "<p>thanks,</p>\n<blockquote>\n<p>There is no block below, that can be affected by the set rule</p>\n</blockquote>\n<p>now its clear</p>",
      "raw": "thanks,\n\n> There is no block below, that can be affected by the set rule\n\nnow its clear",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 4.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1062
    },
    {
      "id": 7632,
      "post_number": 9,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-01-18T19:05:30.552Z",
      "updated_at": "2025-01-18T19:05:30.552Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/simon\">@Simon</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Simon, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: [How to post in the Questions category](https://forum.typst.app/t/how-to-post-in-the-questions-category/11)\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 21,
      "score": 24.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:52:44.020138"
}
{
  "topic_metadata": {
    "id": 2452,
    "title": "How to modify a raw block without triggering 'maximum show rule depth exceeded'?",
    "slug": "how-to-modify-a-raw-block-without-triggering-maximum-show-rule-depth-exceeded",
    "posts_count": 7,
    "created_at": "2025-01-18T00:16:38.685Z",
    "last_posted_at": "2025-01-22T00:18:26.396Z",
    "views": 258,
    "like_count": 5,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "janekfleper",
    "tags": [
      "scripting",
      "styling"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 634
  },
  "posts": [
    {
      "id": 7617,
      "post_number": 1,
      "username": "gpr",
      "name": "Greg",
      "created_at": "2025-01-18T00:16:38.822Z",
      "updated_at": "2025-01-18T19:09:47.762Z",
      "cooked": "<p>I would like to implement Asciidoc-like Callouts (<a href=\"https://docs.asciidoctor.org/asciidoc/latest/verbatim/callouts/\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Callouts | Asciidoctor Docs</a>). In order to do so, I process the raw blocks for <code>// 1</code> style comments and replace them with <code>①</code> circled numbers. It’s actually quite straightforward:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show raw.where(block: true): it =&gt; {\n  set text(size: 1.25em) // fix https://github.com/typst/typst/issues/1331\n\n  it = it.text.replace(regex(\"// \\((\\d+)\\)\"),\n      i =&gt; str.from-unicode(9311 + int(i.captures.at(0))))\n\n  // endless loop\n  raw(it, block: true, lang: \"java\")\n}\n</code></pre>\n<p>I get the error <code>maximum show rule depth exceeded</code> which it seems is an endless loop because it tries to reapply the <code>show</code> rule over and over again even after the replacement. With (<code>raw(it, lang: \"java\")</code>) it already works, but this is no code block, it’s inline raw code.</p>\n<p>How to circumvent the endless loop (<code>maximum show rule depth exceeded</code>)?</p>",
      "raw": "I would like to implement Asciidoc-like Callouts (https://docs.asciidoctor.org/asciidoc/latest/verbatim/callouts/). In order to do so, I process the raw blocks for `// 1` style comments and replace them with `①` circled numbers. It's actually quite straightforward:\n\n```typ\n#show raw.where(block: true): it => {\n  set text(size: 1.25em) // fix https://github.com/typst/typst/issues/1331\n\n  it = it.text.replace(regex(\"// \\((\\d+)\\)\"),\n      i => str.from-unicode(9311 + int(i.captures.at(0))))\n\n  // endless loop\n  raw(it, block: true, lang: \"java\")\n}\n```\n\nI get the error `maximum show rule depth exceeded` which it seems is an endless loop because it tries to reapply the `show` rule over and over again even after the replacement. With (`raw(it, lang: \"java\")`) it already works, but this is no code block, it's inline raw code.\n\nHow to circumvent the endless loop (`maximum show rule depth exceeded`)?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 43,
      "score": 928.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1052
    },
    {
      "id": 7619,
      "post_number": 2,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-01-18T01:25:56.220Z",
      "updated_at": "2025-01-18T01:33:08.924Z",
      "cooked": "<p>You should use a nested show rule to do the replacement you want. That way you don’t have to call <code>raw()</code> again which will cause an infinite loop, as you already noticed yourself.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show raw.where(block: true): it =&gt; {\n  show regex(\"// \\((\\d+)\\)\"): it =&gt; {\n    // do your string replacement here\n  }\n\n  it\n}\n</code></pre>",
      "raw": "You should use a nested show rule to do the replacement you want. That way you don't have to call `raw()` again which will cause an infinite loop, as you already noticed yourself.\n\n```typ\n#show raw.where(block: true): it => {\n  show regex(\"// \\((\\d+)\\)\"): it => {\n    // do your string replacement here\n  }\n\n  it\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 41,
      "score": 28.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 7633,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-01-18T19:10:45.891Z",
      "updated_at": "2025-01-18T19:10:45.891Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/gpr\">@gpr</a>, welcome to the forum! I’ve added some tags and also changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>In addition, if <a class=\"mention\" href=\"/u/janekfleper\">@janekfleper</a>’s answer helped you, make sure to mark it as a solution. If not, let us know if you have further questions!</p>",
      "raw": "Hey @gpr, welcome to the forum! I’ve added some tags and also changed your question post’s title to better fit our guidelines: [How to post in the Questions category](https://forum.typst.app/t/how-to-post-in-the-questions-category/11)\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:\n\nIn addition, if @janekfleper's answer helped you, make sure to mark it as a solution. If not, let us know if you have further questions!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 32.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 7647,
      "post_number": 4,
      "username": "gpr",
      "name": "Greg",
      "created_at": "2025-01-18T22:18:10.960Z",
      "updated_at": "2025-01-19T11:27:56.345Z",
      "cooked": "<p>Thanks, it works great for normal raw blocks without syntax highlighting:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show raw.where(block: true): rawblock =&gt; {\n  show regex(\"// &lt;(\\d+)&gt;\"): match =&gt; {\n    match.text.replace(regex(\"// &lt;(\\d+)&gt;\"),\n      i =&gt; str.from-unicode(9311 + int(i.captures.at(0))))\n  }\n  rawblock\n  // repr(rawblock)\n}\n\n```\npublic class HelloWorld {                  // &lt;1&gt;\n  public static void main(String[] args) { // &lt;2&gt;\n    System.out.println(\"Hello, World!\");   // &lt;3&gt;\n  }\n}\n```\n\n#set enum(numbering: \"①\")\n+ The class name is `HelloWorld`\n+ This is the method signature\n+ This is the call to `stdout`\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/9/94ac9ff614cfb42bd8057b75fcebc2021be46be8.png\" alt=\"2025-01-18 23_10_55-admonitions – Typst\" data-base62-sha1=\"ldevMEZmMsgzEbERfID8L4BqXhu\" width=\"476\" height=\"223\"></p>\n<p>I find, it fits nicely with the numbered list with circled numbers <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"> .</p>\n<p>But unfortunately it breaks when trying to use syntax highlighted code:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">```java\npublic class HelloWorld {                  // &lt;1&gt;\n  public static void main(String[] args) { // &lt;2&gt;\n    System.out.println(\"Hello, World!\");   // &lt;3&gt;\n  }\n}\n```\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/93e5c67f0ceaa9faff0b2ff41a25ebe6778de4d0.png\" data-download-href=\"https://forum.typst.app/uploads/default/93e5c67f0ceaa9faff0b2ff41a25ebe6778de4d0\" title=\"2025-01-18 23_13_37-admonitions – Typst Kopie\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/93e5c67f0ceaa9faff0b2ff41a25ebe6778de4d0_2_650x500.png\" alt=\"2025-01-18 23_13_37-admonitions – Typst Kopie\" data-base62-sha1=\"l6mtJH0E1IpGk5FGNzet6uFWONG\" width=\"650\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/93e5c67f0ceaa9faff0b2ff41a25ebe6778de4d0_2_650x500.png, https://forum.typst.app/uploads/default/original/2X/9/93e5c67f0ceaa9faff0b2ff41a25ebe6778de4d0.png 1.5x, https://forum.typst.app/uploads/default/original/2X/9/93e5c67f0ceaa9faff0b2ff41a25ebe6778de4d0.png 2x\" data-dominant-color=\"F6F8F9\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">2025-01-18 23_13_37-admonitions – Typst Kopie</span><span class=\"informations\">851×654 88 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>The symbols are replaced in <code>raw.text</code> and <code>raw.lines.line.text</code> but not in the last two styled elements.</p>",
      "raw": "Thanks, it works great for normal raw blocks without syntax highlighting:\n\n````typ\n#show raw.where(block: true): rawblock => {\n  show regex(\"// <(\\d+)>\"): match => {\n    match.text.replace(regex(\"// <(\\d+)>\"),\n      i => str.from-unicode(9311 + int(i.captures.at(0))))\n  }\n  rawblock\n  // repr(rawblock)\n}\n\n```\npublic class HelloWorld {                  // <1>\n  public static void main(String[] args) { // <2>\n    System.out.println(\"Hello, World!\");   // <3>\n  }\n}\n```\n\n#set enum(numbering: \"①\")\n+ The class name is `HelloWorld`\n+ This is the method signature\n+ This is the call to `stdout`\n````\n\n![2025-01-18 23_10_55-admonitions – Typst|476x223](upload://ldevMEZmMsgzEbERfID8L4BqXhu.png)\n\nI find, it fits nicely with the numbered list with circled numbers :slight_smile: .\n\nBut unfortunately it breaks when trying to use syntax highlighted code:\n\n````typ\n```java\npublic class HelloWorld {                  // <1>\n  public static void main(String[] args) { // <2>\n    System.out.println(\"Hello, World!\");   // <3>\n  }\n}\n```\n````\n\n![2025-01-18 23_13_37-admonitions – Typst Kopie|650x500](upload://l6mtJH0E1IpGk5FGNzet6uFWONG.png)\n\nThe symbols are replaced in `raw.text` and `raw.lines.line.text` but not in the last two styled elements.",
      "reply_to_post_number": 2,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 27.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1052
    },
    {
      "id": 7648,
      "post_number": 5,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-01-19T00:34:27.637Z",
      "updated_at": "2025-01-19T00:34:27.637Z",
      "cooked": "<p>The only solution I can think of is to use an additional show rule that hides the forward slashes and to reduce the regex show rule to only match <code> &lt;1&gt;</code>. This is of course far from an elegant solution…</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show raw.where(block: true, lang: \"java\"): it =&gt; {\n  show \"//\": \"\"\n  show regex(\" &lt;(\\d+)&gt;\"): it =&gt; {\n    // do your string replacement here\n  }\n  it\n}\n</code></pre>",
      "raw": "The only solution I can think of is to use an additional show rule that hides the forward slashes and to reduce the regex show rule to only match ` <1>`. This is of course far from an elegant solution...\n\n```typ\n#show raw.where(block: true, lang: \"java\"): it => {\n  show \"//\": \"\"\n  show regex(\" <(\\d+)>\"): it => {\n    // do your string replacement here\n  }\n  it\n}\n```",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 32,
      "score": 36.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 7675,
      "post_number": 6,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-19T11:40:34.581Z",
      "updated_at": "2025-01-19T11:40:34.581Z",
      "cooked": "<p>A completely different approach could be to use Codly’s code highlight features:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/3/35eb54fcaa1fa85f0be53a43bd38bbd12365372c.png\" data-download-href=\"https://forum.typst.app/uploads/default/35eb54fcaa1fa85f0be53a43bd38bbd12365372c\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/3/35eb54fcaa1fa85f0be53a43bd38bbd12365372c_2_690x333.png\" alt=\"image\" data-base62-sha1=\"7GZv98mcZ4Wmc2OfCH6lVv0hyGw\" width=\"690\" height=\"333\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/3/35eb54fcaa1fa85f0be53a43bd38bbd12365372c_2_690x333.png, https://forum.typst.app/uploads/default/optimized/2X/3/35eb54fcaa1fa85f0be53a43bd38bbd12365372c_2_1035x499.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/3/35eb54fcaa1fa85f0be53a43bd38bbd12365372c_2_1380x666.png 2x\" data-dominant-color=\"F3F3F3\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1966×949 157 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/universe/package/codly\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/universe/package/codly\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/universe/package/codly\" target=\"_blank\" rel=\"noopener\">codly – Typst Universe</a></h3>\n\n  <p>Codly is a beautiful code presentation template with many features like smart indentation, line numbering, highlighting, etc.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>Or maybe Codly’s implementation can give some pointers on how you could do it in the way you imagined it initially.</p>",
      "raw": "A completely different approach could be to use Codly's code highlight features:\n\n![image|690x333](upload://7GZv98mcZ4Wmc2OfCH6lVv0hyGw.png)\n\nhttps://typst.app/universe/package/codly\n\nOr maybe Codly's implementation can give some pointers on how you could do it in the way you imagined it initially.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 31,
      "score": 41.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7755,
      "post_number": 7,
      "username": "gpr",
      "name": "Greg",
      "created_at": "2025-01-22T00:18:26.396Z",
      "updated_at": "2025-01-22T00:18:26.396Z",
      "cooked": "<p>Thanks, so this actually works. Maybe someone finds this via Google, here is the code:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show raw.where(block: true): rawblock =&gt; {\n  show \"//\": \"\"\n  show regex(\" &lt;(\\d+)&gt;\"): match =&gt; {\n    match.text.replace(regex(\" &lt;(\\d+)&gt;\"),\n      i =&gt; str.from-unicode(9311 + int(i.captures.at(0))))\n  }\n  rawblock\n}\n\n'``java\npublic class HelloWorld {                  // &lt;1&gt;\n  public static void main(String[] args) { // &lt;2&gt;\n    System.out.println(\"Hello, World!\");   // &lt;3&gt;\n  } // &lt;4&gt;\n} // &lt;5&gt;\n'``\n\n#set enum(numbering: \"①\")\n+ The class name is `HelloWorld`\n+ This is the method signature\n+ This is the call to `stdout`\n</code></pre>",
      "raw": "Thanks, so this actually works. Maybe someone finds this via Google, here is the code:\n\n```typ\n#show raw.where(block: true): rawblock => {\n  show \"//\": \"\"\n  show regex(\" <(\\d+)>\"): match => {\n    match.text.replace(regex(\" <(\\d+)>\"),\n      i => str.from-unicode(9311 + int(i.captures.at(0))))\n  }\n  rawblock\n}\n\n'``java\npublic class HelloWorld {                  // <1>\n  public static void main(String[] args) { // <2>\n    System.out.println(\"Hello, World!\");   // <3>\n  } // <4>\n} // <5>\n'``\n\n#set enum(numbering: \"①\")\n+ The class name is `HelloWorld`\n+ This is the method signature\n+ This is the call to `stdout`\n```",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 25,
      "score": 20.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1052
    }
  ],
  "scraped_at": "2025-06-10T09:52:43.283135"
}
{
  "topic_metadata": {
    "id": 2462,
    "title": "How to check if a variable exists?",
    "slug": "how-to-check-if-a-variable-exists",
    "posts_count": 6,
    "created_at": "2025-01-18T20:18:22.800Z",
    "last_posted_at": "2025-01-19T11:19:17.728Z",
    "views": 440,
    "like_count": 4,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 6,
    "accepted_answer_username": "laurmaedje",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 507
  },
  "posts": [
    {
      "id": 7638,
      "post_number": 1,
      "username": "Florian",
      "name": "Florian",
      "created_at": "2025-01-18T20:18:22.999Z",
      "updated_at": "2025-01-19T11:23:51.886Z",
      "cooked": "<p>Hey <img src=\"https://forum.typst.app/images/emoji/apple/wave.png?v=12\" title=\":wave:\" class=\"emoji\" alt=\":wave:\" loading=\"lazy\" width=\"20\" height=\"20\"> ,</p>\n<p>I am trying to check if a variable exists - but as far as i could imagine doing it, i don’t see a way to do it.</p>\n<p>Say i’d like to detect if “a” is being <s>defined</s> declared - i thought of using something like <code>if a ...</code> which of course fails.</p>\n<p>So how actually check if an variable exists?</p>",
      "raw": "Hey :wave: ,\n\nI am trying to check if a variable exists - but as far as i could imagine doing it, i don't see a way to do it.\n\nSay i'd like to detect if \"a\" is being ~~defined~~ declared - i thought of using something like `if a ...` which of course fails.\n\nSo how actually check if an variable exists?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 61,
      "score": 1847.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 251
    },
    {
      "id": 7639,
      "post_number": 2,
      "username": "gpr",
      "name": "Greg",
      "created_at": "2025-01-18T20:42:11.177Z",
      "updated_at": "2025-01-18T20:42:11.177Z",
      "cooked": "<p>You can check it yourself, e.g.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let a\n</code></pre>\n<p><code>a</code> is declared but not defined. The representation of <code>a</code> is</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">repr(a) // none\n</code></pre>\n<p><code>none</code>. So checking for <code>none</code> should be sufficient:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#{a == none} // true\n</code></pre>\n<p>Since <code>if</code> requires a boolean condition to be met, we can check:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#if a == none [Yes] else [No] // Yes\n</code></pre>\n<p>On the other hand. <code>a</code> is not <code>none</code> when it is defined:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let a = 5 // declared and defined\n#{a == none} // false\n</code></pre>",
      "raw": "You can check it yourself, e.g.\n\n```typ\n#let a\n```\n\n`a` is declared but not defined. The representation of `a` is\n\n```typ\nrepr(a) // none\n```\n\n`none`. So checking for `none` should be sufficient:\n\n```typ\n#{a == none} // true\n```\n\nSince `if` requires a boolean condition to be met, we can check:\n\n```typ\n#if a == none [Yes] else [No] // Yes\n```\n\nOn the other hand. `a` is not `none` when it is defined:\n\n```typ\n#let a = 5 // declared and defined\n#{a == none} // false\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 61,
      "score": 57.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1052
    },
    {
      "id": 7641,
      "post_number": 3,
      "username": "Florian",
      "name": "Florian",
      "created_at": "2025-01-18T21:11:47.416Z",
      "updated_at": "2025-01-18T21:11:47.416Z",
      "cooked": "<p>Dear <a class=\"mention\" href=\"/u/gpr\">@gpr</a> - thank you very much for your expressive example! I am so sorry i didn’t make clear that i actually try to detect if a variable is already declared (not defined). <img src=\"https://forum.typst.app/images/emoji/apple/bowing_man.png?v=12\" title=\":bowing_man:\" class=\"emoji\" alt=\":bowing_man:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Dear @gpr - thank you very much for your expressive example! I am so sorry i didn't make clear that i actually try to detect if a variable is already declared (not defined). :bowing_man:",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 55,
      "score": 16.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 251
    },
    {
      "id": 7644,
      "post_number": 5,
      "username": "gpr",
      "name": "Greg",
      "created_at": "2025-01-18T21:29:23.647Z",
      "updated_at": "2025-01-18T22:21:11.133Z",
      "cooked": "<p>Sorry, maybe I misunderstood something, but this is how you would check whether a variable is defined:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">a != none // checks whether a is defined\n</code></pre>\n<p>Evaluates to <code>true</code> if <code>a</code> is defined, e.g.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#{if a != none [a is defined here continue...]}\n</code></pre>\n<p>As far as I know there is no syntax like <code>if a</code></p>",
      "raw": "Sorry, maybe I misunderstood something, but this is how you would check whether a variable is defined:\n\n```typ\na != none // checks whether a is defined\n```\nEvaluates to `true` if `a` is defined, e.g.\n\n```typ\n#{if a != none [a is defined here continue...]}\n````\n\nAs far as I know there is no syntax like `if a`",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 53,
      "score": 30.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1052
    },
    {
      "id": 7652,
      "post_number": 6,
      "username": "laurmaedje",
      "name": "Laurenz Mädje",
      "created_at": "2025-01-19T08:57:10.892Z",
      "updated_at": "2025-01-19T08:57:10.892Z",
      "cooked": "<p>This will error if <code>a</code> is not in scope. I think what <a class=\"mention\" href=\"/u/florian\">@Florian</a> is trying to do is to check whether it is in scope.</p>\n<p>It’s not possible to check this (at least I’m not aware of any way). There is a small exception: If the bindings come from an imported module, you can convert the whole module to a dictionary with the dictionary constructor and check whether it’s contained. For the standard library definitions that module would be <code>std</code>. That lets you solve a subproblem of your question.</p>\n<p>All that said: Even if there was a way, it would be quite unorthodox to perform such a check. What are you actually trying to achieve? Maybe there is a better way.</p>",
      "raw": "This will error if `a` is not in scope. I think what @Florian is trying to do is to check whether it is in scope.\n\nIt's not possible to check this (at least I'm not aware of any way). There is a small exception: If the bindings come from an imported module, you can convert the whole module to a dictionary with the dictionary constructor and check whether it's contained. For the standard library definitions that module would be `std`. That lets you solve a subproblem of your question.\n\nAll that said: Even if there was a way, it would be quite unorthodox to perform such a check. What are you actually trying to achieve? Maybe there is a better way.",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 40,
      "score": 28.0,
      "accepted_answer": true,
      "trust_level": 4,
      "user_id": 2
    },
    {
      "id": 7659,
      "post_number": 7,
      "username": "Florian",
      "name": "Florian",
      "created_at": "2025-01-19T11:19:17.728Z",
      "updated_at": "2025-01-19T11:19:17.728Z",
      "cooked": "<p>Thanks a lot <a class=\"mention\" href=\"/u/gpr\">@gpr</a> and <a class=\"mention\" href=\"/u/laurmaedje\">@laurmaedje</a>.</p>\n<p>I am recently thinking of and writing modules for different use cases.</p>\n<p>And of course i am aware of a) the immutable nature of the processing pipeline diverging to the best result and b) i usually would recommend to put a lot of the data preparing to a preprocessing outside of Typst.</p>\n<p>But i experiment a lot with different ways to use Typst as the interface for more or less complex tasks which leads to a annoyingly enjoyable experience creating user interfaces in the Typst scripting language.</p>\n<p>In that regard i thought about using state variables behind the scenes, to allow modules to implicitly use the state of other modules.</p>\n<p>Don’t get me wrong i think that’s a bit of an antipattern since it could raise issues but in terms of exploring what one could achieve i was interested to find out if it’s possible.</p>",
      "raw": "Thanks a lot @gpr and @laurmaedje.\n\nI am recently thinking of and writing modules for different use cases.\n\nAnd of course i am aware of a) the immutable nature of the processing pipeline diverging to the best result and b) i usually would recommend to put a lot of the data preparing to a preprocessing outside of Typst.\n\nBut i experiment a lot with different ways to use Typst as the interface for more or less complex tasks which leads to a annoyingly enjoyable experience creating user interfaces in the Typst scripting language.\n\nIn that regard i thought about using state variables behind the scenes, to allow modules to implicitly use the state of other modules.\n\nDon't get me wrong i think that's a bit of an antipattern since it could raise issues but in terms of exploring what one could achieve i was interested to find out if it's possible.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 39,
      "score": 7.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 251
    }
  ],
  "scraped_at": "2025-06-10T09:52:42.550126"
}
{
  "topic_metadata": {
    "id": 2466,
    "title": "How can I update state inside a ctheorems environment?",
    "slug": "how-can-i-update-state-inside-a-ctheorems-environment",
    "posts_count": 5,
    "created_at": "2025-01-19T08:01:44.475Z",
    "last_posted_at": "2025-01-19T12:03:28.681Z",
    "views": 83,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "state"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 628
  },
  "posts": [
    {
      "id": 7651,
      "post_number": 1,
      "username": "Ilya",
      "name": "Ilya",
      "created_at": "2025-01-19T08:01:44.652Z",
      "updated_at": "2025-01-19T23:07:59.608Z",
      "cooked": "<p>In MWE below i have dictionary which i want to update every time Problem environment is created. I need this updated dictionary to use in FMT constructor.<br>\nThe problem is that after updating the <code>test_dict</code> typst does not see the change.<br>\nI understand that <code>test_dict.get()</code> is equivalent to <code>test_dict.at(here())</code>, so  i can assume that both <code>dict_test.update()</code> function and <code>test_dict.get()</code> are evaluated at location <code>here()</code>, which causes the problem.<br>\nHowever, i find it counterintuitive, because they still go after each other.<br>\nSo the question is if there is a way to make <code>test</code> variable contain updated version of test_dict</p>\n<p><strong>UPD.</strong> Ok, i made it work by changing<br>\n<code>let test = test_dict.get().at(\"some_array\")</code><br>\nto<br>\n<code>let test = context test_dict.get().at(\"some_array\")</code><br>\nNow will try to figure out why it works<br>\n<strong>UPD2</strong> Still need help, because now <code>test</code> is of type content and is useless</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/ctheorems:1.1.3\": *\n#show: thmrules\n\n// create test dictionary\n#let test_dict = state(\"test\",\n  (\n    \"some_array\": ()\n  )\n)\n\n#let problem = thmenv(\n  \"problem\",\n  none,\n  none,\n  (name, number, body) =&gt; context {\n    //get current problem number\n    let number = thmcounters.get().at(\"counters\").at(\"problem\").at(0)\n    //update test_dict\n    test_dict.update(x =&gt; {\n      let y = x\n      //push \"body\" of problem into \"some_array\"\n      y.at(\"some_array\").push(body)\n      return y\n    })\n    //now the next line of code is the problem\n    // test_dict did get updated, \n    //but variable \"test\" does not contain updated version of it\n    let test = test_dict.get().at(\"some_array\")\n    let title = text(emph(\"Problem\")+str(number)+\".\")\n    [\n      #title #body\\\n      #test\n    ]\n }\n)\n\n//This should output: Problem1. first problem\n//                              (first problem)\n#problem[first problem]\n\n#context {\n  test_dict.get()\n}\n</code></pre>",
      "raw": "In MWE below i have dictionary which i want to update every time Problem environment is created. I need this updated dictionary to use in FMT constructor.\nThe problem is that after updating the ```test_dict``` typst does not see the change. \nI understand that ```test_dict.get()``` is equivalent to ```test_dict.at(here())```, so  i can assume that both ```dict_test.update()``` function and ```test_dict.get()``` are evaluated at location ```here()```, which causes the problem.\nHowever, i find it counterintuitive, because they still go after each other.\nSo the question is if there is a way to make ```test``` variable contain updated version of test_dict\n\n**UPD.** Ok, i made it work by changing \n```let test = test_dict.get().at(\"some_array\")```\nto\n```let test = context test_dict.get().at(\"some_array\")```\nNow will try to figure out why it works\n**UPD2** Still need help, because now ```test``` is of type content and is useless\n```typ\n#import \"@preview/ctheorems:1.1.3\": *\n#show: thmrules\n\n// create test dictionary\n#let test_dict = state(\"test\",\n  (\n    \"some_array\": ()\n  )\n)\n\n#let problem = thmenv(\n  \"problem\",\n  none,\n  none,\n  (name, number, body) => context {\n    //get current problem number\n    let number = thmcounters.get().at(\"counters\").at(\"problem\").at(0)\n    //update test_dict\n    test_dict.update(x => {\n      let y = x\n      //push \"body\" of problem into \"some_array\"\n      y.at(\"some_array\").push(body)\n      return y\n    })\n    //now the next line of code is the problem\n    // test_dict did get updated, \n    //but variable \"test\" does not contain updated version of it\n    let test = test_dict.get().at(\"some_array\")\n    let title = text(emph(\"Problem\")+str(number)+\".\")\n    [\n      #title #body\\\n      #test\n    ]\n }\n)\n\n//This should output: Problem1. first problem\n//                              (first problem)\n#problem[first problem]\n\n#context {\n  test_dict.get()\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 196.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1068
    },
    {
      "id": 7660,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-19T11:20:43.638Z",
      "updated_at": "2025-01-19T11:20:43.638Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/ilya\">@Ilya</a>, could you maybe try to revise your post’s title to be a complete question as per the <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\">question guidelines</a>:</p>\n<blockquote>\n<p><strong>Good titles are questions you would ask your friend about Typst.</strong></p>\n</blockquote>\n<p>We hope by adhering to this, we make the information in this forum easy to find in the future. Thanks!</p>",
      "raw": "Hi @Ilya, could you maybe try to revise your post’s title to be a complete question as per the [question guidelines](https://forum.typst.app/t/how-to-post-in-the-questions-category/11):\n\n> **Good titles are questions you would ask your friend about Typst.**\n\nWe hope by adhering to this, we make the information in this forum easy to find in the future. Thanks!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 14.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7661,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-19T11:21:37.674Z",
      "updated_at": "2025-01-19T11:23:19.933Z",
      "cooked": "<p>While I don’t use ctheorems in particular, your updates look like you’re running into this:</p>\n<aside class=\"quote quote-modified\" data-post=\"2\" data-topic=\"164\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/laurmaedje/48/14_2.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164/2\">Why is the value I receive from context always content?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    When working with context, you need to put everything that depends on the contextual information into the context block/expression itself. The explicit context expression is a trade-off: You get to know where in the document you are (accessible via <a href=\"https://typst.app/docs/reference/introspection/here/\">here()</a>) and which set rules are active there (accessible via things like text.lang). In return, the context value itself becomes opaque. You cannot peek into it, so everything that depends on the contextual information must happen within it. \nLet’s lo…\n  </blockquote>\n</aside>\n\n<p>Maybe that helps you until someone with more experience with ctheorems responds.</p>",
      "raw": "While I don't use ctheorems in particular, your updates look like you're running into this:\n\nhttps://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164/2?u=sillyfreak\n\nMaybe that helps you until someone with more experience with ctheorems responds.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 9.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7662,
      "post_number": 4,
      "username": "Florian",
      "name": "Florian",
      "created_at": "2025-01-19T11:33:49.033Z",
      "updated_at": "2025-01-19T11:35:41.588Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/ilya\">@Ilya</a> - i fear i don’t understand what you want to achieve.</p>\n<p>What should <code>thmenv</code> do?</p>\n<p>Should it save the current problem (as passed as argument) to the dictionary and then print it in the given way?</p>",
      "raw": "Hi @Ilya - i fear i don't understand what you want to achieve.\n\nWhat should `thmenv` do?\n\nShould it save the current problem (as passed as argument) to the dictionary and then print it in the given way?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 4.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 251
    },
    {
      "id": 7683,
      "post_number": 5,
      "username": "Ilya",
      "name": "Ilya",
      "created_at": "2025-01-19T12:03:28.681Z",
      "updated_at": "2025-01-19T12:03:28.681Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/florian\">@Florian</a><br>\nWhat i wanted to achieve is to get updated version of <code>test_dict</code> withing the scope of <code>thmenv</code> constructor to then use it’s value as i wish<br>\n<a class=\"mention\" href=\"/u/sillyfreak\">@SillyFreak</a> and UNDRL pointed out that nested contexts should be used in and it works indeed.<br>\nThe achievement <img src=\"https://forum.typst.app/images/emoji/apple/grinning.png?v=12\" title=\":grinning:\" class=\"emoji\" alt=\":grinning:\" loading=\"lazy\" width=\"20\" height=\"20\"> :</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/ctheorems:1.1.3\": *\n#show: thmrules.with(qed-symbol: $square$)\n\n#show link: it =&gt; {\n  set text(fill:\n    if (type(it.dest) == \"label\") { green } else { green }\n  )\n  it\n}\n#show ref: it =&gt; {\n  link(it.target, it)\n}\n\n#let qa_text = state(\"qa\",\n  (:)\n)\n\n#let hyper_problem = thmenv(\n  \"problem\",\n  none,\n  none,\n  (name, number, body) =&gt; context {\n    let number = thmcounters.get().at(\"counters\").at(\"problem\").at(0)\n    let num_identifier = \"problem\"+str(number)\n    qa_text.update(x =&gt; {\n      let y = x\n      y.insert(num_identifier, (\"p_content\": body))\n      return y\n    })\n    context {\n    let p_key = qa_text.final().at(num_identifier)\n    let loc = if (\"ans_content\" in p_key.keys() and p_key.at(\"ans_content\") != []) {&lt;temploc&gt;} else {&lt;temploc2&gt;}\n    let num_rect = rect(\n        stroke: none,\n        inset: 0em,\n        place(\n          right,\n          dx: -100% - 8pt,\n          link(loc)[#text(\n            str(number)+\".\"\n          )])+body)\n          [#num_rect]}\n    }\n)\n\n#let answer = (ans_cnt) =&gt; context {\n  let number = thmcounters.get().at(\"counters\").at(\"problem\").at(0)\n  qa_text.update(x =&gt; {\n    let y = x\n    y.at(\"problem\"+str(number)).insert(\"ans_content\", ans_cnt)\n    return y\n  })\n}\n\n#hyper_problem[first problem]\n#answer[answer to first problem]\n\n#hyper_problem[second problem]\n\n#context qa_text.get()\n\ntemplocation &lt;temploc&gt;\n\ntemploc2 &lt;temploc2&gt;\n</code></pre>",
      "raw": "Hi @Florian \nWhat i wanted to achieve is to get updated version of ```test_dict``` withing the scope of ```thmenv``` constructor to then use it's value as i wish\n@SillyFreak and UNDRL pointed out that nested contexts should be used in and it works indeed.\nThe achievement :grinning: :\n```typ\n#import \"@preview/ctheorems:1.1.3\": *\n#show: thmrules.with(qed-symbol: $square$)\n\n#show link: it => {\n  set text(fill:\n    if (type(it.dest) == \"label\") { green } else { green }\n  )\n  it\n}\n#show ref: it => {\n  link(it.target, it)\n}\n\n#let qa_text = state(\"qa\",\n  (:)\n)\n\n#let hyper_problem = thmenv(\n  \"problem\",\n  none,\n  none,\n  (name, number, body) => context {\n    let number = thmcounters.get().at(\"counters\").at(\"problem\").at(0)\n    let num_identifier = \"problem\"+str(number)\n    qa_text.update(x => {\n      let y = x\n      y.insert(num_identifier, (\"p_content\": body))\n      return y\n    })\n    context {\n    let p_key = qa_text.final().at(num_identifier)\n    let loc = if (\"ans_content\" in p_key.keys() and p_key.at(\"ans_content\") != []) {<temploc>} else {<temploc2>}\n    let num_rect = rect(\n        stroke: none,\n        inset: 0em,\n        place(\n          right,\n          dx: -100% - 8pt,\n          link(loc)[#text(\n            str(number)+\".\"\n          )])+body)\n          [#num_rect]}\n    }\n)\n\n#let answer = (ans_cnt) => context {\n  let number = thmcounters.get().at(\"counters\").at(\"problem\").at(0)\n  qa_text.update(x => {\n    let y = x\n    y.at(\"problem\"+str(number)).insert(\"ans_content\", ans_cnt)\n    return y\n  })\n}\n\n#hyper_problem[first problem]\n#answer[answer to first problem]\n\n#hyper_problem[second problem]\n\n#context qa_text.get()\n\ntemplocation <temploc>\n\ntemploc2 <temploc2>\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 24,
      "score": 64.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1068
    }
  ],
  "scraped_at": "2025-06-10T09:52:41.793897"
}
{
  "topic_metadata": {
    "id": 2467,
    "title": "Is there a way to do hatched in-filling like this in Typst/CeTz?",
    "slug": "is-there-a-way-to-do-hatched-in-filling-like-this-in-typst-cetz",
    "posts_count": 7,
    "created_at": "2025-01-19T09:42:25.575Z",
    "last_posted_at": "2025-01-19T22:01:52.351Z",
    "views": 262,
    "like_count": 3,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 6,
    "accepted_answer_username": "Eric",
    "tags": [
      "graphics",
      "cetz"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 587
  },
  "posts": [
    {
      "id": 7654,
      "post_number": 1,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2025-01-19T09:42:25.748Z",
      "updated_at": "2025-01-19T11:01:56.336Z",
      "cooked": "<p>Hi!</p>\n<p>Would anyone know how to replicate something like this?</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/1/1693767000be3b5f71cc698f191a61fc1c6b4489.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/1693767000be3b5f71cc698f191a61fc1c6b4489\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/1/1693767000be3b5f71cc698f191a61fc1c6b4489_2_690x338.jpeg\" alt=\"image\" data-base62-sha1=\"3dIrnyJLQeuZnNZHhJTQotDVUaR\" width=\"690\" height=\"338\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/1/1693767000be3b5f71cc698f191a61fc1c6b4489_2_690x338.jpeg, https://forum.typst.app/uploads/default/original/2X/1/1693767000be3b5f71cc698f191a61fc1c6b4489.jpeg 1.5x, https://forum.typst.app/uploads/default/original/2X/1/1693767000be3b5f71cc698f191a61fc1c6b4489.jpeg 2x\" data-dominant-color=\"D1D1D1\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">734×360 115 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\nSource: <a href=\"https://etc.usf.edu/clipart/76600/76648/76648_materialsym.htm\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Mechanical Drawing Cross Hatching of Material Symbols | ClipArt ETC</a></p>\n<p>Specifically, the cast iron (top left)</p>\n<p>Kind regards</p>",
      "raw": "Hi!\n\nWould anyone know how to replicate something like this?\n\n![image|690x338](upload://3dIrnyJLQeuZnNZHhJTQotDVUaR.jpeg)\nSource: https://etc.usf.edu/clipart/76600/76648/76648_materialsym.htm\n\nSpecifically, the cast iron (top left)\n\nKind regards",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 54,
      "score": 955.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    },
    {
      "id": 7658,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-19T11:08:41.184Z",
      "updated_at": "2025-01-19T11:08:41.184Z",
      "cooked": "<p>There is a pattern type for repeated fillings: <a href=\"https://typst.app/docs/reference/visualize/pattern/\" class=\"inline-onebox\">Pattern Type – Typst Documentation</a></p>\n<p>I’m not sure it would help with all of these, but the repeating ones (those except for face hardened steal, leather, glass) should be possible by creating a pattern. Since I assume the others will/are allowed to eventually repeat as well, you could probably also do those. Face hardened steel and glass may require separate patterns for “edge” and “bulk area” since they’re not uniform.</p>",
      "raw": "There is a pattern type for repeated fillings: https://typst.app/docs/reference/visualize/pattern/\n\nI'm not sure it would help with all of these, but the repeating ones (those except for face hardened steal, leather, glass) should be possible by creating a pattern. Since I assume the others will/are allowed to eventually repeat as well, you could probably also do those. Face hardened steel and glass may require separate patterns for \"edge\" and \"bulk area\" since they're not uniform.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 49,
      "score": 19.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7682,
      "post_number": 3,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2025-01-19T12:03:23.746Z",
      "updated_at": "2025-01-19T12:03:23.746Z",
      "cooked": "<p>Thanks!</p>\n<p>I got this now:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let pat = pattern(size: (20pt, 20pt))[\n  #place(line(start: (0%, 100%), end: (100%, 0%)))\n]\n\n#rect(fill: pat, width: 8cm, height: 5cm, stroke: 1pt)\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/8/8f2fe7a735218bfdc26dce1837df0c42bec9012a.png\" alt=\"image\" data-base62-sha1=\"kqGUFz0N70ks91maGK2cgOX7u1Y\" width=\"598\" height=\"397\"></p>\n<p>So now I want to do two things:</p>\n<ol>\n<li>I want to make the lines “overlap” so that it is a continous line with no gaps</li>\n<li>If possible, I want to flip the “diagonal direction”, notice how there is more white in top left corner compared to right bottom corner. I want to have that flipped like the original image</li>\n</ol>\n<p>I hope someone knows how :)</p>",
      "raw": "Thanks!\n\nI got this now:\n\n```typst\n#let pat = pattern(size: (20pt, 20pt))[\n  #place(line(start: (0%, 100%), end: (100%, 0%)))\n]\n\n#rect(fill: pat, width: 8cm, height: 5cm, stroke: 1pt)\n```\n\n![image|598x397](upload://kqGUFz0N70ks91maGK2cgOX7u1Y.png)\n\nSo now I want to do two things:\n\n1. I want to make the lines \"overlap\" so that it is a continous line with no gaps\n2. If possible, I want to flip the \"diagonal direction\", notice how there is more white in top left corner compared to right bottom corner. I want to have that flipped like the original image\n\nI hope someone knows how :)",
      "reply_to_post_number": 2,
      "reply_count": 3,
      "quote_count": 0,
      "like_count": 0,
      "reads": 48,
      "score": 24.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    },
    {
      "id": 7684,
      "post_number": 4,
      "username": "Florian",
      "name": "Florian",
      "created_at": "2025-01-19T12:14:57.111Z",
      "updated_at": "2025-01-19T12:17:06.551Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/ahmedsalih\">@AhmedSalih</a>,</p>\n<p>one way to do achieve individual renderings for a block could be the <code>layout()</code>-function:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// given you'd want to fill this block\n#rect(width: 8cm, height: 5cm)[\n  #context layout(size =&gt; {\n    size\n    // Individual line calculations and\n    // drawings here, using size\n  })\n]\n</code></pre>\n<p>I haven’t done this (drawing patterns) yet and i don’t know how performant such an approach is.</p>",
      "raw": "Hi @AhmedSalih,\n\none way to do achieve individual renderings for a block could be the `layout()`-function:\n\n```typ\n// given you'd want to fill this block\n#rect(width: 8cm, height: 5cm)[\n  #context layout(size => {\n    size\n    // Individual line calculations and\n    // drawings here, using size\n  })\n]\n```\n\nI haven't done this (drawing patterns) yet and i don't know how performant such an approach is.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 47,
      "score": 34.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 251
    },
    {
      "id": 7685,
      "post_number": 5,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-19T12:43:35.171Z",
      "updated_at": "2025-01-19T12:43:35.171Z",
      "cooked": "<p>problem 1: the locations where the line is “interrupted” is where four tiles come together. your pattern has black at the top right and bottom left corners, but not at the top left and bottom right corners. You can fix that by adding some lines that fill these few pixels:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let pat = pattern(size: (20pt, 20pt), {\n  place(line(start: (0%, 100%), end: (100%, 0%)))\n  place(line(start: (50%, 150%), end: (150%, 50%)))\n  place(line(start: (-50%, 50%), end: (50%, -50%)))\n})\n\n#rect(fill: pat, width: 8cm, height: 5cm, stroke: 1pt)\n</code></pre>\n<p>It doesn’t matter here, but another source of “too short” lines could be the <a href=\"https://typst.app/docs/reference/visualize/stroke/#constructor-cap\">stroke’s cap</a>: <code>square</code> and <code>round</code> caps will extend beyond the end according to the thickness, filling some parts of the pattern that may otherwise be missing.</p>\n<hr>\n<p>I don’t know about problem 2; there’s <a href=\"https://typst.app/docs/reference/visualize/pattern/#constructor-relative\"><code>pattern.relative</code></a> but it doesn’t support what you need. I think <code>pattern</code> could sensibly get an “alignment” that defines where the pattern fill is originating from. You could <a href=\"https://github.com/typst/typst/issues\">open an issue</a> about it.</p>",
      "raw": "problem 1: the locations where the line is \"interrupted\" is where four tiles come together. your pattern has black at the top right and bottom left corners, but not at the top left and bottom right corners. You can fix that by adding some lines that fill these few pixels:\n\n```typ\n#let pat = pattern(size: (20pt, 20pt), {\n  place(line(start: (0%, 100%), end: (100%, 0%)))\n  place(line(start: (50%, 150%), end: (150%, 50%)))\n  place(line(start: (-50%, 50%), end: (50%, -50%)))\n})\n\n#rect(fill: pat, width: 8cm, height: 5cm, stroke: 1pt)\n```\n\nIt doesn't matter here, but another source of \"too short\" lines could be the [stroke's cap](https://typst.app/docs/reference/visualize/stroke/#constructor-cap): `square` and `round` caps will extend beyond the end according to the thickness, filling some parts of the pattern that may otherwise be missing.\n\n---\n\nI don't know about problem 2; there's [`pattern.relative`](https://typst.app/docs/reference/visualize/pattern/#constructor-relative) but it doesn't support what you need. I think `pattern` could sensibly get an \"alignment\" that defines where the pattern fill is originating from. You could [open an issue](https://github.com/typst/typst/issues) about it.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 46,
      "score": 84.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7687,
      "post_number": 6,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2025-01-19T14:04:36.113Z",
      "updated_at": "2025-01-19T14:04:36.113Z",
      "cooked": "<p>For your first problem, I would recommend using the <a href=\"https://typst.app/universe/package/modpattern/\"><code>modpattern</code></a> package, which gets rid of the gaps automatically. To then move the lines, you could use the <a href=\"https://typst.app/docs/reference/layout/move/\"><code>move</code></a> function. This doesn’t flip the diagonal direction, but it still allows you to adjust the positioning of the lines.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/modpattern:0.1.0\": modpattern\n\n#let pat = modpattern((20pt, 20pt))[\n  #move(dx: 50%, line(start: (0%, 100%), end: (100%, 0%)))\n]\n\n#rect(fill: pat, width: 8cm, height: 5cm, stroke: 1pt)\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/e/eecf41531ac592f5e39e0d6d0f3d1e0aa44095ad.png\" alt=\"image\" data-base62-sha1=\"y4BGaq0TLmpdSyBXhphlz7MV0kZ\" width=\"290\" height=\"186\"></p>",
      "raw": "For your first problem, I would recommend using the [`modpattern`](https://typst.app/universe/package/modpattern/) package, which gets rid of the gaps automatically. To then move the lines, you could use the [`move`](https://typst.app/docs/reference/layout/move/) function. This doesn't flip the diagonal direction, but it still allows you to adjust the positioning of the lines.\n\n```typ\n#import \"@preview/modpattern:0.1.0\": modpattern\n\n#let pat = modpattern((20pt, 20pt))[\n  #move(dx: 50%, line(start: (0%, 100%), end: (100%, 0%)))\n]\n\n#rect(fill: pat, width: 8cm, height: 5cm, stroke: 1pt)\n```\n\n![image|581x372, 50%](upload://y4BGaq0TLmpdSyBXhphlz7MV0kZ.png)",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 43,
      "score": 68.6,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 7693,
      "post_number": 7,
      "username": "AhmedSalih",
      "name": "",
      "created_at": "2025-01-19T22:01:52.351Z",
      "updated_at": "2025-01-19T22:01:52.351Z",
      "cooked": "<p>Thank you all!</p>\n<p>This was exactly what I needed.</p>\n<p>Kind regards</p>",
      "raw": "Thank you all!\n\nThis was exactly what I needed.\n\nKind regards",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 36,
      "score": 12.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 786
    }
  ],
  "scraped_at": "2025-06-10T09:52:40.999652"
}
{
  "topic_metadata": {
    "id": 2479,
    "title": "How can I show code listings from codly in \"Code snippets\" outline?",
    "slug": "how-can-i-show-code-listings-from-codly-in-code-snippets-outline",
    "posts_count": 5,
    "created_at": "2025-01-20T12:48:42.683Z",
    "last_posted_at": "2025-01-20T13:16:50.000Z",
    "views": 146,
    "like_count": 4,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "Eric",
    "tags": [
      "outline"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 207
  },
  "posts": [
    {
      "id": 7704,
      "post_number": 1,
      "username": "JohnDough",
      "name": "John Dough",
      "created_at": "2025-01-20T12:48:42.894Z",
      "updated_at": "2025-01-21T17:08:32.032Z",
      "cooked": "<p>Hey there,</p>\n<p>is there any possibility to show Code snippets in a outline. I have some code snippet like this:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#figure(\n    [```rust\n    fn main() {\n        println!(\"Hello World\");\n    }\n    ```],\n    caption: [Hello World in Rust]\n)\n</code></pre>\n<p>In the outline I tried to work with the <code>target: figure.where(kind: ...)</code> thingy, but did not find the right kind.</p>\n<p>I would be really thankful for some suggestions on this topic.</p>\n<p>Greetings<br>\nJohn</p>",
      "raw": "Hey there,\n\nis there any possibility to show Code snippets in a outline. I have some code snippet like this:\n\n```typst\n#figure(\n    [```rust\n    fn main() {\n        println!(\"Hello World\");\n    }\n    ```],\n    caption: [Hello World in Rust]\n)\n```\n\nIn the outline I tried to work with the `target: figure.where(kind: ...)` thingy, but did not find the right kind.\n\nI would be really thankful for some suggestions on this topic.\n\nGreetings\nJohn",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 645.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1021
    },
    {
      "id": 7705,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-01-20T12:58:41.969Z",
      "updated_at": "2025-01-20T13:12:30.340Z",
      "cooked": "<p><s>If you are aiming to specifically select your listings, you should assign a custom <code>kind</code> to your figures.</s><br>\nA POC would be</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show outline.entry: it =&gt; {\n  it\n  align(center, rect(stroke: stroke(dash: \"dotted\"), it.element))\n}\n\n#outline(target: figure.where(kind: raw))\n\n#let f = figure(\n    [```rust\n    fn main() {\n        println!(\"Hello World\");\n    }\n    ```],\n    caption: [Hello World in Rust],\n)\n#f\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/b/b990b4b1c79be0b7617b7b2ccb19617db7fec837.png\" data-download-href=\"https://forum.typst.app/uploads/default/b990b4b1c79be0b7617b7b2ccb19617db7fec837\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/b/b990b4b1c79be0b7617b7b2ccb19617db7fec837_2_690x291.png\" alt=\"image\" data-base62-sha1=\"qtAmuPOM6HALjt4gCvoid8LOUjt\" width=\"690\" height=\"291\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/b/b990b4b1c79be0b7617b7b2ccb19617db7fec837_2_690x291.png, https://forum.typst.app/uploads/default/original/2X/b/b990b4b1c79be0b7617b7b2ccb19617db7fec837.png 1.5x, https://forum.typst.app/uploads/default/original/2X/b/b990b4b1c79be0b7617b7b2ccb19617db7fec837.png 2x\" data-dominant-color=\"FAFBFB\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">870×367 32.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "~~If you are aiming to specifically select your listings, you should assign a custom `kind` to your figures.~~\nA POC would be\n\n```typ\n#show outline.entry: it => {\n  it\n  align(center, rect(stroke: stroke(dash: \"dotted\"), it.element))\n}\n\n#outline(target: figure.where(kind: raw))\n\n#let f = figure(\n    [```rust\n    fn main() {\n        println!(\"Hello World\");\n    }\n    ```],\n    caption: [Hello World in Rust],\n)\n#f\n```\n![image|690x291](upload://qtAmuPOM6HALjt4gCvoid8LOUjt.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 24,
      "score": 29.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 7706,
      "post_number": 3,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2025-01-20T13:05:36.151Z",
      "updated_at": "2025-01-20T13:05:36.151Z",
      "cooked": "<p>The kind associated to code listings is <code>raw</code>. You don’t need to set it explicitly on the figures, but for a custom outline, the target would then be <code>figure.where(kind: raw)</code>.</p>",
      "raw": "The kind associated to code listings is `raw`. You don't need to set it explicitly on the figures, but for a custom outline, the target would then be `figure.where(kind: raw)`.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 21,
      "score": 59.2,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 7707,
      "post_number": 4,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-01-20T13:13:09.425Z",
      "updated_at": "2025-01-20T13:13:09.425Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Eric\" data-post=\"3\" data-topic=\"2479\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/eric/48/87_2.png\" class=\"avatar\"> Eric:</div>\n<blockquote>\n<p>The kind associated to code listings is <code>raw</code>.</p>\n</blockquote>\n</aside>\n<p>Sometimes I forget how straightforward things are in Typst <img src=\"https://forum.typst.app/images/emoji/apple/sweat_smile.png?v=12\" title=\":sweat_smile:\" class=\"emoji\" alt=\":sweat_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "[quote=\"Eric, post:3, topic:2479\"]\nThe kind associated to code listings is `raw`.\n[/quote]\n\nSometimes I forget how straightforward things are in Typst :sweat_smile:",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 22,
      "score": 4.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 7708,
      "post_number": 5,
      "username": "JohnDough",
      "name": "John Dough",
      "created_at": "2025-01-20T13:16:50.000Z",
      "updated_at": "2025-01-20T13:16:50.000Z",
      "cooked": "<p>Thank you both for your blazingly fast reply. Every time I am more amazed by how straightforward typst is.</p>",
      "raw": "Thank you both for your blazingly fast reply. Every time I am more amazed by how straightforward typst is.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 14.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1021
    }
  ],
  "scraped_at": "2025-06-10T09:52:40.239754"
}
{
  "topic_metadata": {
    "id": 2480,
    "title": "How to write content at the bottom of a page?",
    "slug": "how-to-write-content-at-the-bottom-of-a-page",
    "posts_count": 3,
    "created_at": "2025-01-20T14:24:44.267Z",
    "last_posted_at": "2025-01-26T14:35:41.633Z",
    "views": 265,
    "like_count": 2,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "layout",
      "touying",
      "alignment",
      "presentation",
      "text"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 168
  },
  "posts": [
    {
      "id": 7710,
      "post_number": 1,
      "username": "Sinthoras",
      "name": "",
      "created_at": "2025-01-20T14:24:44.444Z",
      "updated_at": "2025-01-20T14:26:29.330Z",
      "cooked": "<p>I am using Touying to create a presentation.</p>\n<p>I want to create a custom command that puts its arguments to the bottom of the current slide[1] for directly showing the source of images, etc. (Like a footnote, but without the footnote^^)</p>\n<p>How can I achieve this?</p>\n<p>My current suboptimal solution is something like:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let source(content) = {\n  align(bottom+right, content)\n}\n</code></pre>\n<p>This works as long as the source command is the last command of the page, but not anymore if I write something after the source command, because then the content after the source command comes after the source-content. Therefore I am wondering if there is a better solution.</p>\n<p>[1]: And applies some styling to it, but that is irrelevant for the question</p>",
      "raw": "I am using Touying to create a presentation. \n\nI want to create a custom command that puts its arguments to the bottom of the current slide[1] for directly showing the source of images, etc. (Like a footnote, but without the footnote^^) \n\nHow can I achieve this?\n\nMy current suboptimal solution is something like:\n```typst\n#let source(content) = {\n  align(bottom+right, content)\n}\n```\nThis works as long as the source command is the last command of the page, but not anymore if I write something after the source command, because then the content after the source command comes after the source-content. Therefore I am wondering if there is a better solution.\n\n\n\n\n[1]: And applies some styling to it, but that is irrelevant for the question",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 1137.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 511
    },
    {
      "id": 7724,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-01-20T20:40:23.577Z",
      "updated_at": "2025-01-20T20:40:23.577Z",
      "cooked": "<p>This sound like a use case for <a href=\"https://typst.app/docs/reference/layout/place/#parameters-float\" class=\"inline-onebox\">Place Function – Typst Documentation</a> with <code>float: true</code> :)</p>",
      "raw": "This sound like a use case for https://typst.app/docs/reference/layout/place/#parameters-float with `float: true` :)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 34,
      "score": 66.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 7875,
      "post_number": 3,
      "username": "Sinthoras",
      "name": "",
      "created_at": "2025-01-26T14:35:41.633Z",
      "updated_at": "2025-01-26T14:35:41.633Z",
      "cooked": "<p>I just noticed that I forgot to thank you. I implemented your hint (the same day you gave it) and it worked. Thank you! :)</p>",
      "raw": "I just noticed that I forgot to thank you. I implemented your hint (the same day you gave it) and it worked. Thank you! :)",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 58.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 511
    }
  ],
  "scraped_at": "2025-06-10T09:52:39.529750"
}
{
  "topic_metadata": {
    "id": 2485,
    "title": "How to correctly customize equation numbering & referencing simultaneously?",
    "slug": "how-to-correctly-customize-equation-numbering-referencing-simultaneously",
    "posts_count": 7,
    "created_at": "2025-01-20T16:29:02.225Z",
    "last_posted_at": "2025-05-14T16:22:30.825Z",
    "views": 234,
    "like_count": 2,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "Eric",
    "tags": [
      "scripting",
      "math",
      "numbering",
      "referencing"
    ],
    "category_id": 5,
    "participant_count": 5,
    "word_count": 659
  },
  "posts": [
    {
      "id": 7716,
      "post_number": 1,
      "username": "Gijs_Bellaard",
      "name": "Gijs Bellaard",
      "created_at": "2025-01-20T16:29:02.362Z",
      "updated_at": "2025-05-13T19:23:42.442Z",
      "cooked": "<p>Suppose I have custom equation numbering &amp; referencing as follows.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set math.equation(numbering: it =&gt; numbering(\"(1.1)\", counter(heading).get().at(0), it)) \n\n#set heading(numbering: \"1.1\")\n\n#show heading.where(level: 1): it =&gt; {\n  counter(math.equation).update(0)\n  it\n}\n\n#show ref: it =&gt; {\n    let el = it.element\n    if (el != none and el.func() == math.equation) {\n      let loc = el.location()\n      return link(loc,numbering(\n        el.numbering,\n        ..counter(math.equation).at(loc)\n      ))\n    }\n    return it\n  }\n\n\n= \n\n$ a^2 + b^2 = c^2 $ &lt;eq&gt;\n\n= \n\n$ a^2 + b^2 = c^2 $\n\nNow look at this reference: @eq.\nIt should say (1.1) but it says (2.1)\n</code></pre>\n<p>Notice that the equation referencing is <em>wrong</em>.<br>\nHow would one go about fixing this?</p>",
      "raw": "Suppose I have custom equation numbering & referencing as follows.\n\n```typ  \n#set math.equation(numbering: it => numbering(\"(1.1)\", counter(heading).get().at(0), it)) \n\n#set heading(numbering: \"1.1\")\n\n#show heading.where(level: 1): it => {\n  counter(math.equation).update(0)\n  it\n}\n\n#show ref: it => {\n    let el = it.element\n    if (el != none and el.func() == math.equation) {\n      let loc = el.location()\n      return link(loc,numbering(\n        el.numbering,\n        ..counter(math.equation).at(loc)\n      ))\n    }\n    return it\n  }\n\n\n= \n\n$ a^2 + b^2 = c^2 $ <eq>\n\n= \n\n$ a^2 + b^2 = c^2 $\n\nNow look at this reference: @eq.\nIt should say (1.1) but it says (2.1)\n```\n\nNotice that the equation referencing is _wrong_.\nHow would one go about fixing this?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 50,
      "score": 720.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1075
    },
    {
      "id": 7721,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2025-01-20T19:15:25.663Z",
      "updated_at": "2025-01-20T19:47:23.688Z",
      "cooked": "<p><s>I think the  following solution is quite nice: <a href=\"https://forum.typst.app/t/wrong-numbering-for-the-equation/1403/2\" class=\"inline-onebox\">Wrong numbering for the equation - #2 by Eric</a>. Basically you don’t change the <code>ref</code>, but just reset the equation counter after each heading.</s></p>",
      "raw": "~~I think the  following solution is quite nice: https://forum.typst.app/t/wrong-numbering-for-the-equation/1403/2?u=flokl. Basically you don't change the `ref`, but just reset the equation counter after each heading.~~",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 43,
      "score": 23.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 7722,
      "post_number": 3,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2025-01-20T19:43:47.538Z",
      "updated_at": "2025-01-20T19:46:55.180Z",
      "cooked": "<p>From what I can tell, the goal of the show rule on <code>ref</code> is to change the appearance of a reference from <em>Equation 2.1</em> to just <em>(2.1)</em>. The unfortunate thing is that you have to explicitly call <code>numbering(..)</code> in the show rule, so the numbering function set in the rule for equations is always called with the context of the reference (instead of the context of the equation itself). The only possible workaround I could think of right now, is using a regex show rule to remove the supplement like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show ref: it =&gt; {\n  let el = it.element\n  if (el != none and el.func() == math.equation) {\n    // May need to adjust this when using letters in numbering\n    show regex(\"\\p{letter}+\\s+\"): none\n    it\n  } else {\n    it\n  }\n}\n</code></pre>\n<p>Other than that, there are some potentially related issues you could follow:</p>\n<ul>\n<li><a href=\"https://github.com/typst/typst/issues/1896\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Ergonomic numbering-by-section · Issue #1896 · typst/typst · GitHub</a></li>\n<li><a href=\"https://github.com/typst/typst/issues/3930\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Providing different `context`s · Issue #3930 · typst/typst · GitHub</a></li>\n<li><a href=\"https://github.com/typst/typst/issues/4646\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Numbering contexts do not include styles · Issue #4646 · typst/typst · GitHub</a></li>\n<li><a href=\"https://github.com/EpicEricEE/typst-equate/issues/3\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">`numbering` function does not get local counter for sub-equations · Issue #3 · EpicEricEE/typst-equate · GitHub</a> (for the same issue in the equate package)</li>\n</ul>",
      "raw": "From what I can tell, the goal of the show rule on `ref` is to change the appearance of a reference from _Equation 2.1_ to just _(2.1)_. The unfortunate thing is that you have to explicitly call `numbering(..)` in the show rule, so the numbering function set in the rule for equations is always called with the context of the reference (instead of the context of the equation itself). The only possible workaround I could think of right now, is using a regex show rule to remove the supplement like this:\n\n```typ\n#show ref: it => {\n  let el = it.element\n  if (el != none and el.func() == math.equation) {\n    // May need to adjust this when using letters in numbering\n    show regex(\"\\p{letter}+\\s+\"): none\n    it\n  } else {\n    it\n  }\n}\n```\n\nOther than that, there are some potentially related issues you could follow:\n- https://github.com/typst/typst/issues/1896\n- https://github.com/typst/typst/issues/3930\n- https://github.com/typst/typst/issues/4646\n- https://github.com/EpicEricEE/typst-equate/issues/3 (for the same issue in the equate package)",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 41,
      "score": 48.2,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 7723,
      "post_number": 4,
      "username": "Gijs_Bellaard",
      "name": "Gijs Bellaard",
      "created_at": "2025-01-20T19:52:26.086Z",
      "updated_at": "2025-01-20T19:52:26.086Z",
      "cooked": "<p>Sad to hear this.</p>\n<p>I’ve accepted your answer as the solution, however, I do hope that somebody comes up with something better.</p>",
      "raw": "Sad to hear this.\n\nI've accepted your answer as the solution, however, I do hope that somebody comes up with something better.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 7.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1075
    },
    {
      "id": 12363,
      "post_number": 5,
      "username": "John",
      "name": "John",
      "created_at": "2025-05-12T23:47:47.841Z",
      "updated_at": "2025-05-12T23:47:47.841Z",
      "cooked": "<p>This works for me. But it’s probably fragile.<br>\nNotice that where you had <code>el.numbering</code>, I have hardcoded “(1,1)”. So it’s not very flexible. Either the concept of “element” is not well documented, or I missed it. I wonder what <code>el.numbering</code> is and if it has structure that would be useful here.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">    #show heading.where(level:1): it =&gt; {\n        counter(math.equation).update(0)\n        it\n    }\n\n    // Format equation references.\n    // Uses the top-level heading number first\n    #set math.equation(numbering: n =&gt; {\n        numbering(\"(1.1)\", counter(heading).get().first(), n)})\n\n    // References to equations are modified from \"Equation (x.y)\"\n    // to \"(x.y)\".\n    // This is hacky because \"(1.1)\" is hardcoded.\n    #show ref: it =&gt; {\n        let eq = math.equation\n        let el = it.element\n        if el != none and el.func() == eq {\n            link(el.location(),\n                numbering(\n                    \"(1.1)\",\n                    counter(heading).at(el.location()).first(),\n                    counter(eq).at(el.location()).first()\n                )\n            )\n        } else {\n            // Other references as usual.\n            it\n        }\n    }\n</code></pre>\n<p>If I use <code>el.numbering</code> rather than “(1.1)”, then I get an error:</p>\n<pre><code class=\"lang-auto\">error: unexpected argument\n   ┌─ lib/gjl_template.typ:33:34\n   │\n33 │     #set math.equation(numbering: n =&gt; {\n   │                                   ^\n</code></pre>",
      "raw": "This works for me. But it's probably fragile.\nNotice that where you had `el.numbering`, I have hardcoded \"(1,1)\". So it's not very flexible. Either the concept of \"element\" is not well documented, or I missed it. I wonder what `el.numbering` is and if it has structure that would be useful here.\n\n```typst\n    #show heading.where(level:1): it => {\n        counter(math.equation).update(0)\n        it\n    }\n\n    // Format equation references.\n    // Uses the top-level heading number first\n    #set math.equation(numbering: n => {\n        numbering(\"(1.1)\", counter(heading).get().first(), n)})\n\n    // References to equations are modified from \"Equation (x.y)\"\n    // to \"(x.y)\".\n    // This is hacky because \"(1.1)\" is hardcoded.\n    #show ref: it => {\n        let eq = math.equation\n        let el = it.element\n        if el != none and el.func() == eq {\n            link(el.location(),\n                numbering(\n                    \"(1.1)\",\n                    counter(heading).at(el.location()).first(),\n                    counter(eq).at(el.location()).first()\n                )\n            )\n        } else {\n            // Other references as usual.\n            it\n        }\n    }\n```\n\nIf I use `el.numbering` rather than \"(1.1)\", then I get an error:\n```\nerror: unexpected argument\n   ┌─ lib/gjl_template.typ:33:34\n   │\n33 │     #set math.equation(numbering: n => {\n   │                                   ^\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 3.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1572
    },
    {
      "id": 12447,
      "post_number": 6,
      "username": "Lima",
      "name": "Jan-Øivind Lima",
      "created_at": "2025-05-14T11:13:02.015Z",
      "updated_at": "2025-05-14T11:14:17.637Z",
      "cooked": "<p>I am not sure if I understand completely, but if you want to reference only the number you can use empty brackets after the reference.<br>\nE.g.<br>\n<span class=\"mention\">@eq</span>:derivative \\\\ this yields Equation 4.2<br>\n<span class=\"mention\">@eq</span>:derivative[<span class=\"chcklst-box fa fa-square-o fa-fw\"></span>] \\\\ this yields 4.2</p>",
      "raw": "I am not sure if I understand completely, but if you want to reference only the number you can use empty brackets after the reference. \nE.g.\n@eq:derivative \\\\\\ this yields Equation 4.2\n@eq:derivative[[\\]] \\\\\\ this yields 4.2",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 23.4,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1598
    },
    {
      "id": 12458,
      "post_number": 7,
      "username": "John",
      "name": "John",
      "created_at": "2025-05-14T16:22:30.825Z",
      "updated_at": "2025-05-14T16:24:32.325Z",
      "cooked": "<p>I confirm this works.</p>\n<p>I missed this before, but it is documented in the subheading “Syntax” on the documentation page for <a href=\"https://typst.app/docs/reference/model/ref/\">ref</a></p>\n<p>I should note that if you have asked for parentheses, for example with <code>numbering(\"(1.1)\",...</code>, then you get, following your example <code>(4.2)</code> rather than <code>Equation (4.2)</code>.</p>\n<p>It would be cleaner are more flexible to change the behavior with a bit of code in one place. But appending <code>[]</code> does work.</p>",
      "raw": "I confirm this works. \n\nI missed this before, but it is documented in the subheading \"Syntax\" on the documentation page for [ref](https://typst.app/docs/reference/model/ref/)\n\nI should note that if you have asked for parentheses, for example with `numbering(\"(1.1)\",...`, then you get, following your example `(4.2)` rather than `Equation (4.2)`.\n\nIt would be cleaner are more flexible to change the behavior with a bit of code in one place. But appending `[]` does work.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 3.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1572
    }
  ],
  "scraped_at": "2025-06-10T09:52:38.821322"
}
