{
  "topic_metadata": {
    "id": 4210,
    "title": "How to indent paragraphs following a list without affecting the paragraph after a heading?",
    "slug": "how-to-indent-paragraphs-following-a-list-without-affecting-the-paragraph-after-a-heading",
    "posts_count": 4,
    "created_at": "2025-05-21T12:57:03.130Z",
    "last_posted_at": "2025-05-21T19:06:31.126Z",
    "views": 37,
    "like_count": 4,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "Andrew",
    "tags": [
      "layout",
      "lists"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 193
  },
  "posts": [
    {
      "id": 12865,
      "post_number": 1,
      "username": "fungai2000",
      "name": "",
      "created_at": "2025-05-21T12:57:03.250Z",
      "updated_at": "2025-05-21T21:29:22.077Z",
      "cooked": "<p>I would like the paragraph that follows a numbered or bullet list to be indented. I have not figured out how to do so without also affecting the first paragraph after a heading, which I’d like to keep unindented as is the default. See the example below:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set par(first-line-indent: (amount: 1em, all: false), justify: true, leading: .6em, spacing: .6em)\n\n= Heading\n\n#lorem(30)\n\n+ item 1\n+ item 2\n+ item 3\n\nI would like this paragraph to be indented. #lorem(30)\n</code></pre>",
      "raw": "I would like the paragraph that follows a numbered or bullet list to be indented. I have not figured out how to do so without also affecting the first paragraph after a heading, which I'd like to keep unindented as is the default. See the example below:\n\n```\n#set par(first-line-indent: (amount: 1em, all: false), justify: true, leading: .6em, spacing: .6em)\n\n= Heading\n\n#lorem(30)\n\n+ item 1\n+ item 2\n+ item 3\n\nI would like this paragraph to be indented. #lorem(30)\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 38.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 1518
    },
    {
      "id": 12866,
      "post_number": 2,
      "username": "sijo",
      "name": "",
      "created_at": "2025-05-21T13:12:30.390Z",
      "updated_at": "2025-05-21T13:12:30.390Z",
      "cooked": "<p>Maybe something like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show enum: it =&gt; it + v(0pt, weak: true) + par(none)\n</code></pre>\n<p>This inserts an empty paragraph after the enumeration, so the actual paragraph is not the first one anymore. The weak vertical space is used to remove the default spacing between the enum and the empty paragraph.</p>",
      "raw": "Maybe something like this:\n\n```\n#show enum: it => it + v(0pt, weak: true) + par(none)\n```\n\nThis inserts an empty paragraph after the enumeration, so the actual paragraph is not the first one anymore. The weak vertical space is used to remove the default spacing between the enum and the empty paragraph.",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 58.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 12875,
      "post_number": 3,
      "username": "fungai2000",
      "name": "",
      "created_at": "2025-05-21T13:55:15.480Z",
      "updated_at": "2025-05-21T13:55:50.985Z",
      "cooked": "<p>Brilliant, thank you! It does the job and simply. Thank you also for taking time to explain how it works.</p>",
      "raw": "Brilliant, thank you! It does the job and simply. Thank you also for taking time to explain how it works.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 15,
      "score": 18.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 1518
    },
    {
      "id": 12905,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-21T19:06:31.126Z",
      "updated_at": "2025-05-21T19:06:31.126Z",
      "cooked": "<p>I think block without spacing makes more sense, and <code>none</code> for paragraph looks weird, never seen that before.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set par(first-line-indent: 1em, justify: true, leading: 0.6em, spacing: 0.6em)\n#show enum: it =&gt; it + block(spacing: 0pt) + par[]\n</code></pre>",
      "raw": "I think block without spacing makes more sense, and `none` for paragraph looks weird, never seen that before.\n\n```typ\n#set par(first-line-indent: 1em, justify: true, leading: 0.6em, spacing: 0.6em)\n#show enum: it => it + block(spacing: 0pt) + par[]\n```",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 14,
      "score": 32.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:47:29.974993"
}
{
  "topic_metadata": {
    "id": 4214,
    "title": "Can a set or show rule be used to style the text content in a figure from outside of the figure?",
    "slug": "can-a-set-or-show-rule-be-used-to-style-the-text-content-in-a-figure-from-outside-of-the-figure",
    "posts_count": 10,
    "created_at": "2025-05-21T16:24:17.030Z",
    "last_posted_at": "2025-05-22T17:42:30.545Z",
    "views": 61,
    "like_count": 2,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 7,
    "accepted_answer_username": "Andrew",
    "tags": [
      "scripting",
      "figures"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 1140
  },
  "posts": [
    {
      "id": 12892,
      "post_number": 1,
      "username": "Haden",
      "name": "",
      "created_at": "2025-05-21T16:24:17.164Z",
      "updated_at": "2025-05-22T19:08:50.560Z",
      "cooked": "<p>Good day!</p>\n<p>My employer uses Quarto for automated reporting, and I’m currently working on a typst template that will be applied to our reports as a custom format. All of our figures (images and tables) include several text annotations at the bottom of the figure, which need to be styled. I can achieve the desired result in typst by including <code>align</code> and <code>text</code> in the <code>figure</code> call:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set figure.caption(position: top)\n#show figure.caption: set align(left)\n\n#figure(\n  {\n    // an image\n    rect(fill: red)\n    // annotations\n    align(\n        left,\n        text(size: 10pt)[\n            Program Path: mypath/file.csv \\\n            Abbreviations: DV = dependent variable \\\n        ]\n    )\n  },\n  caption: [My Caption]\n)\n</code></pre>\n<p>My question is, can I apply the same styling using a show/set rule outside of the figure, so that I can keep the styling and “artifact” creation steps separate?</p>\n<p>I can almost get the desired result by simply using:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show figure: it =&gt; {\n  set align(left)\n  set text(size: 10pt)\n  it\n}\n\n#figure(\n  {\n    rect(fill: red)\n    [\n        Program Path: mypath/file.csv \\\n        Abbreviations: DV = dependent variable \\\n    ]\n  },\n  caption: [My Caption]\n)\n</code></pre>\n<p>Except that the code above also shifts the image (which should be centered), to the left.</p>\n<p>Any guidance would be appreciated!</p>",
      "raw": "Good day!\n\nMy employer uses Quarto for automated reporting, and I'm currently working on a typst template that will be applied to our reports as a custom format. All of our figures (images and tables) include several text annotations at the bottom of the figure, which need to be styled. I can achieve the desired result in typst by including `align` and `text` in the `figure` call:\n\n```typ\n#set figure.caption(position: top)\n#show figure.caption: set align(left)\n\n#figure(\n  {\n    // an image\n    rect(fill: red)\n    // annotations\n    align(\n        left,\n        text(size: 10pt)[\n            Program Path: mypath/file.csv \\\n            Abbreviations: DV = dependent variable \\\n        ]\n    )\n  },\n  caption: [My Caption]\n)\n```\n\nMy question is, can I apply the same styling using a show/set rule outside of the figure, so that I can keep the styling and \"artifact\" creation steps separate?\n\nI can almost get the desired result by simply using: \n\n```typ \n#show figure: it => {\n  set align(left)\n  set text(size: 10pt)\n  it\n}\n\n#figure(\n  {\n    rect(fill: red)\n    [\n        Program Path: mypath/file.csv \\\n        Abbreviations: DV = dependent variable \\\n    ]\n  },\n  caption: [My Caption]\n)\n```\nExcept that the code above also shifts the image (which should be centered), to the left.\n\nAny guidance would be appreciated!",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 13.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1635
    },
    {
      "id": 12898,
      "post_number": 2,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-05-21T17:00:00.955Z",
      "updated_at": "2025-05-21T17:00:00.955Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Haden\" data-post=\"1\" data-topic=\"4214\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/h/F64C96/48.png\" class=\"avatar\"> Haden:</div>\n<blockquote>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">    [\n      Program Path: mypath/file.csv \\\n      Abbreviations: DV = dependent variable \\\n    ]\n</code></pre>\n</blockquote>\n</aside>\n<p>I think you can introduce your own function here, making it</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#annotation[\n   Program Path: mypath/file.csv \\\n   Abbreviations: DV = dependent variable \\\n]\n</code></pre>\n<p>Then you have separated style from markup by only just a function call, but that’s enough. The function itself can either contain the styling, or mark up the content so that it’s recognizable somehow and leave style for a show rule.</p>",
      "raw": "[quote=\"Haden, post:1, topic:4214\"]\n```\n    [\n      Program Path: mypath/file.csv \\\n      Abbreviations: DV = dependent variable \\\n    ]\n```\n[/quote]\n\nI think you can introduce your own function here, making it\n\n```typst\n#annotation[\n   Program Path: mypath/file.csv \\\n   Abbreviations: DV = dependent variable \\\n]\n```\n\nThen you have separated style from markup by only just a function call, but that's enough. The function itself can either contain the styling, or mark up the content so that it's recognizable somehow and leave style for a show rule.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 18,
      "score": 3.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 12906,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-21T19:22:34.584Z",
      "updated_at": "2025-05-21T19:22:34.584Z",
      "cooked": "<p>Hello. Do you actually want the caption to be not centered (above the image)? If not, then a separate function indeed would be the cleanest solution:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set figure.caption(position: top)\n\n#let annotations(body) = align(center, block({\n  set align(left)\n  set text(size: 10pt)\n  body\n}))\n\n#figure(rect(), caption: [My Caption])\n#annotations[\n  Program Path: mypath/file.csv \\\n  Abbreviations: DV = dependent variable\n]\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/f/f8365a49a6a82314f3fa3d99b82147f5809d36b3.png\" alt=\"image\" data-base62-sha1=\"zpMRusZTZwNSORXDnlcozDELKNR\" width=\"330\" height=\"180\"></p>",
      "raw": "Hello. Do you actually want the caption to be not centered (above the image)? If not, then a separate function indeed would be the cleanest solution:\n\n```typ\n#set figure.caption(position: top)\n\n#let annotations(body) = align(center, block({\n  set align(left)\n  set text(size: 10pt)\n  body\n}))\n\n#figure(rect(), caption: [My Caption])\n#annotations[\n  Program Path: mypath/file.csv \\\n  Abbreviations: DV = dependent variable\n]\n```\n\n![image|441x240, 75%](upload://zpMRusZTZwNSORXDnlcozDELKNR.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 3.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12913,
      "post_number": 4,
      "username": "Haden",
      "name": "",
      "created_at": "2025-05-21T21:48:58.668Z",
      "updated_at": "2025-05-21T21:48:58.668Z",
      "cooked": "<p>Thank you both for your replies. Yes, <a class=\"mention\" href=\"/u/andrew\">@Andrew</a>, the caption should be left-aligned as well. Based on your response, would the simplest solution be to add a show rule to your suggestion, or did you have something else in mind?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show figure.caption: set align(left)\n</code></pre>",
      "raw": "Thank you both for your replies. Yes, @Andrew, the caption should be left-aligned as well. Based on your response, would the simplest solution be to add a show rule to your suggestion, or did you have something else in mind? \n\n```typ\n#show figure.caption: set align(left)\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 8.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1635
    },
    {
      "id": 12915,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-21T21:57:52.397Z",
      "updated_at": "2025-05-21T21:57:52.397Z",
      "cooked": "<p>How caption should behave if it’s longer than annotations or image?</p>",
      "raw": "How caption should behave if it's longer than annotations or image?",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 3.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12917,
      "post_number": 6,
      "username": "Haden",
      "name": "",
      "created_at": "2025-05-21T22:06:48.027Z",
      "updated_at": "2025-05-21T22:06:48.027Z",
      "cooked": "<p>It should wrap with a hanging indent.</p>\n<p>I’ll include the actual test case from my template below. If it muddies the water, let me know and I’ll edit the post to remove it.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/87d3d2e0b5d6b79cbab770b3b382611d383a19b2.png\" data-download-href=\"https://forum.typst.app/uploads/default/87d3d2e0b5d6b79cbab770b3b382611d383a19b2\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/87d3d2e0b5d6b79cbab770b3b382611d383a19b2_2_407x375.png\" alt=\"image\" data-base62-sha1=\"jnAhU59vXVkWSuW4hibKI6K3F06\" width=\"407\" height=\"375\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/8/87d3d2e0b5d6b79cbab770b3b382611d383a19b2_2_407x375.png, https://forum.typst.app/uploads/default/optimized/2X/8/87d3d2e0b5d6b79cbab770b3b382611d383a19b2_2_610x562.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/8/87d3d2e0b5d6b79cbab770b3b382611d383a19b2_2_814x750.png 2x\" data-dominant-color=\"F6F6F6\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1032×950 101 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>The relevant template code is:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// FIGURES\n    #show figure: set block(sticky: true, breakable: true)\n    #set figure.caption(position: top)\n    #show figure.caption: it =&gt; context {\n        set text(font: \"Amaranth\", weight: \"bold\")\n        set align(left)\n        let n = if it.kind == image {\n            counter(figure.where(kind: image)).display()\n        } else if it.kind == table {\n            counter(figure.where(kind: table)).display()\n        } else {\n            none\n        }\n        // hanging indent only works if included inside the block\n        // block is needed so that sticky figures don't widow their titles \n        block(\n            par(\n                hanging-indent: 1in,\n                box(width: 1in, it.supplement + [ ] + n + [:]) + it.body\n            )\n        )\n    }\n}\n</code></pre>\n<p>And the call:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#figure(\n    {\n        image(\"pathtofile.png\")\n        align(\n            left,\n            text(size: 10pt)[\n                Program Path: artifacts/create-data.jl \\\n                Legend: #lorem(60) \\ \n                Abbreviations: CL = clearance, \\\n            ]\n        )\n    },\n    placement: none,\n    caption: [Schematic Representation of Proposed PK Model],\n    kind: image,\n    supplement: [Figure]\n)\n\n\n</code></pre>",
      "raw": "It should wrap with a hanging indent. \n\nI'll include the actual test case from my template below. If it muddies the water, let me know and I'll edit the post to remove it.\n\n![image|543x500, 75%](upload://jnAhU59vXVkWSuW4hibKI6K3F06.png)\n\nThe relevant template code is: \n\n```typ\n// FIGURES\n    #show figure: set block(sticky: true, breakable: true)\n    #set figure.caption(position: top)\n    #show figure.caption: it => context {\n        set text(font: \"Amaranth\", weight: \"bold\")\n        set align(left)\n        let n = if it.kind == image {\n            counter(figure.where(kind: image)).display()\n        } else if it.kind == table {\n            counter(figure.where(kind: table)).display()\n        } else {\n            none\n        }\n        // hanging indent only works if included inside the block\n        // block is needed so that sticky figures don't widow their titles \n        block(\n            par(\n                hanging-indent: 1in,\n                box(width: 1in, it.supplement + [ ] + n + [:]) + it.body\n            )\n        )\n    }\n}\n```\n\nAnd the call:\n\n```typ\n#figure(\n    {\n        image(\"pathtofile.png\")\n        align(\n            left,\n            text(size: 10pt)[\n                Program Path: artifacts/create-data.jl \\\n                Legend: #lorem(60) \\ \n                Abbreviations: CL = clearance, \\\n            ]\n        )\n    },\n    placement: none,\n    caption: [Schematic Representation of Proposed PK Model],\n    kind: image,\n    supplement: [Figure]\n)\n\n\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 8.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1635
    },
    {
      "id": 12939,
      "post_number": 7,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-22T12:23:22.160Z",
      "updated_at": "2025-05-22T12:25:58.042Z",
      "cooked": "<p>There are a lot of explicit things that are default anyway, so they basically just don’t give anything other than more code. I also noticed that basically the width of everything is the max width of caption/annotations/body. If this is what you want, then all three do have to be inside the same block, i.e., inside the figure. I think a basic wrapper with additional argument is the way.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set figure.caption(position: top)\n#show figure: set block(sticky: true, breakable: true)\n#show figure.caption: it =&gt; context {\n  let numbering = if it.kind == image {\n    [~] + counter(figure.where(kind: image)).display()\n  } else if it.kind == table {\n    [~] + counter(figure.where(kind: table)).display()\n  } // kind: raw is excluded\n  set text(font: \"Amaranth\", weight: \"bold\")\n  set align(left)\n  grid(\n    columns: (1in, auto),\n    [#it.supplement#numbering#it.separator], it.body,\n  )\n}\n\n#let figure(annotations: none, body, ..args) = std.figure(..args, {\n  body\n  set align(left)\n  set text(10pt)\n  annotations\n})\n\n#figure(\n  rect(width: 15cm, height: 9cm),\n  caption: lorem(15),\n  annotations: [\n    Program Path: artifacts/create-data.jl \\\n    Legend: #lorem(60) \\\n    Abbreviations:\n    CL = clearance, \\\n  ],\n)\n\n#v(5em)\n\n#figure(\n  table(columns: 2)[][][],\n  caption: lorem(15),\n  annotations: [\n    Program Path: artifacts/create-data.jl \\\n    Legend: #lorem(10) \\\n    Abbreviations:\n    CL = clearance, \\\n  ],\n)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/e/e666dd40596fb24834e8005bbbccff36436f1867.png\" data-download-href=\"https://forum.typst.app/uploads/default/e666dd40596fb24834e8005bbbccff36436f1867\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/e/e666dd40596fb24834e8005bbbccff36436f1867_2_426x500.png\" alt=\"image\" data-base62-sha1=\"wSecDG5m7U3M7PwlBpXCLH2BfjV\" width=\"426\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/e/e666dd40596fb24834e8005bbbccff36436f1867_2_426x500.png, https://forum.typst.app/uploads/default/original/2X/e/e666dd40596fb24834e8005bbbccff36436f1867.png 1.5x, https://forum.typst.app/uploads/default/original/2X/e/e666dd40596fb24834e8005bbbccff36436f1867.png 2x\" data-dominant-color=\"151515\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">607×712 49.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "There are a lot of explicit things that are default anyway, so they basically just don't give anything other than more code. I also noticed that basically the width of everything is the max width of caption/annotations/body. If this is what you want, then all three do have to be inside the same block, i.e., inside the figure. I think a basic wrapper with additional argument is the way.\n\n```typ\n#set figure.caption(position: top)\n#show figure: set block(sticky: true, breakable: true)\n#show figure.caption: it => context {\n  let numbering = if it.kind == image {\n    [~] + counter(figure.where(kind: image)).display()\n  } else if it.kind == table {\n    [~] + counter(figure.where(kind: table)).display()\n  } // kind: raw is excluded\n  set text(font: \"Amaranth\", weight: \"bold\")\n  set align(left)\n  grid(\n    columns: (1in, auto),\n    [#it.supplement#numbering#it.separator], it.body,\n  )\n}\n\n#let figure(annotations: none, body, ..args) = std.figure(..args, {\n  body\n  set align(left)\n  set text(10pt)\n  annotations\n})\n\n#figure(\n  rect(width: 15cm, height: 9cm),\n  caption: lorem(15),\n  annotations: [\n    Program Path: artifacts/create-data.jl \\\n    Legend: #lorem(60) \\\n    Abbreviations:\n    CL = clearance, \\\n  ],\n)\n\n#v(5em)\n\n#figure(\n  table(columns: 2)[][][],\n  caption: lorem(15),\n  annotations: [\n    Program Path: artifacts/create-data.jl \\\n    Legend: #lorem(10) \\\n    Abbreviations:\n    CL = clearance, \\\n  ],\n)\n```\n\n![image|426x500](upload://wSecDG5m7U3M7PwlBpXCLH2BfjV.png)",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 13,
      "score": 7.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12953,
      "post_number": 8,
      "username": "Haden",
      "name": "",
      "created_at": "2025-05-22T15:30:33.380Z",
      "updated_at": "2025-05-22T17:36:49.591Z",
      "cooked": "<p>Thanks, Andrew.</p>\n<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"7\" data-topic=\"4214\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>There are a lot of explicit things that are default anyway</p>\n</blockquote>\n</aside>\n<p>Can you elaborate here? Also, is there a reason for using <code>grid</code> over a <code>box</code>?</p>\n<p>The solution you proposed works if the code is in the same document as the content; however, if I remove it to a template I get an error, <code>unexpected argument: annotations</code></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">//temp.typ\n#let report(doc) = {\n  //solution code\n  doc\n} \n\n// test.typ\n#import \"temp.typ\": *\n#show: report.with()\n\n#figure(\n  rect(width: 15cm, height: 9cm),\n  caption: lorem(15),\n  annotations: [\n    Program Path: artifacts/create-data.jl \\\n    Legend: #lorem(60) \\\n    Abbreviations:\n    CL = clearance, \\\n  ],\n)\n\n#outline(\n  title: \"List of Figures\",\n  target: figure.where(kind: image)\n)\n</code></pre>\n<p>There’s also an error with the subsequent <code>#outline</code> that, <code>where() can only be called on element functions </code>.</p>",
      "raw": "Thanks, Andrew.\n\n[quote=\"Andrew, post:7, topic:4214\"]\nThere are a lot of explicit things that are default anyway\n[/quote]\n\nCan you elaborate here? Also, is there a reason for using `grid` over a `box`?\n\nThe solution you proposed works if the code is in the same document as the content; however, if I remove it to a template I get an error, `unexpected argument: annotations`\n\n```typ\n//temp.typ\n#let report(doc) = {\n  //solution code\n  doc\n} \n\n// test.typ\n#import \"temp.typ\": *\n#show: report.with()\n\n#figure(\n  rect(width: 15cm, height: 9cm),\n  caption: lorem(15),\n  annotations: [\n    Program Path: artifacts/create-data.jl \\\n    Legend: #lorem(60) \\\n    Abbreviations:\n    CL = clearance, \\\n  ],\n)\n\n#outline(\n  title: \"List of Figures\",\n  target: figure.where(kind: image)\n)\n```\n\nThere's also an error with the subsequent `#outline` that, `where() can only be called on element functions `.",
      "reply_to_post_number": 7,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 1,
      "reads": 13,
      "score": 22.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1635
    },
    {
      "id": 12964,
      "post_number": 9,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-22T17:02:03.887Z",
      "updated_at": "2025-05-22T17:02:03.887Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Haden\" data-post=\"8\" data-topic=\"4214\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/h/F64C96/48.png\" class=\"avatar\"> Haden:</div>\n<blockquote>\n<p>Can you elaborate here?</p>\n</blockquote>\n</aside>\n<p>The <a href=\"https://typst.app/docs/reference/model/figure/#parameters-placement\"><code>figure.placement</code></a> is <code>none</code> by default. The <a href=\"https://typst.app/docs/reference/model/figure/#parameters-kind\"><code>figure.kind</code></a> is determined by the content automatically. Even with the wrapper, it works as expected, so also no reason to set it. The same goes to <a href=\"https://typst.app/docs/reference/model/figure/#parameters-supplement\"><code>figure.supplement</code></a>.</p>\n<aside class=\"quote no-group\" data-username=\"Haden\" data-post=\"8\" data-topic=\"4214\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/h/F64C96/48.png\" class=\"avatar\"> Haden:</div>\n<blockquote>\n<p>Also, is there a reason for using <code>grid</code> over a <code>box</code>?</p>\n</blockquote>\n</aside>\n<p>The <code>grid</code> is used instead of <code>box</code> and <code>par</code> (and <code>block</code>). It’s just better suited for this. See <a href=\"https://github.com/typst/typst/issues/2422\" class=\"inline-onebox\">Horizontal `stack` does not correctly resize its children · Issue #2422 · typst/typst · GitHub</a>.</p>\n<aside class=\"quote no-group\" data-username=\"Haden\" data-post=\"8\" data-topic=\"4214\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/h/F64C96/48.png\" class=\"avatar\"> Haden:</div>\n<blockquote>\n<p>I remove it to a template I get an error, <code>unexpected argument: annotations</code></p>\n</blockquote>\n</aside>\n<p>The things defined in the template function are scoped to that function and not accessible from outside, i.e., define it outside.</p>\n<aside class=\"quote no-group\" data-username=\"Haden\" data-post=\"8\" data-topic=\"4214\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/h/F64C96/48.png\" class=\"avatar\"> Haden:</div>\n<blockquote>\n<p>There’s also an error with the subsequent <code>#outline</code> that, <code>where() can only be called on element functions </code>.</p>\n</blockquote>\n</aside>\n<p>You don’t have a comma after <code>  title: \"List of Figures\"</code>. The <code>  target: figure.where(kind: image)</code> uses custom wrapper function, so either use <code>std.figure</code> or rename the function.</p>",
      "raw": "[quote=\"Haden, post:8, topic:4214\"]\nCan you elaborate here?\n[/quote]\n\nThe [`figure.placement`](https://typst.app/docs/reference/model/figure/#parameters-placement) is `none` by default. The [`figure.kind`](https://typst.app/docs/reference/model/figure/#parameters-kind) is determined by the content automatically. Even with the wrapper, it works as expected, so also no reason to set it. The same goes to [`figure.supplement`](https://typst.app/docs/reference/model/figure/#parameters-supplement).\n\n[quote=\"Haden, post:8, topic:4214\"]\nAlso, is there a reason for using `grid` over a `box`?\n[/quote]\n\nThe `grid` is used instead of `box` and `par` (and `block`). It's just better suited for this. See https://github.com/typst/typst/issues/2422.\n\n[quote=\"Haden, post:8, topic:4214\"]\nI remove it to a template I get an error, `unexpected argument: annotations`\n[/quote]\n\nThe things defined in the template function are scoped to that function and not accessible from outside, i.e., define it outside.\n\n[quote=\"Haden, post:8, topic:4214\"]\nThere’s also an error with the subsequent `#outline` that, `where() can only be called on element functions `.\n[/quote]\n\nYou don't have a comma after `  title: \"List of Figures\"`. The `  target: figure.where(kind: image)` uses custom wrapper function, so either use `std.figure` or rename the function.",
      "reply_to_post_number": 8,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 11,
      "score": 2.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12971,
      "post_number": 10,
      "username": "Haden",
      "name": "",
      "created_at": "2025-05-22T17:42:30.545Z",
      "updated_at": "2025-05-22T17:42:30.545Z",
      "cooked": "<p>Thank you for your help and the additional clarification, <a class=\"mention\" href=\"/u/andrew\">@Andrew</a>. Everything is working.</p>",
      "raw": "Thank you for your help and the additional clarification, @Andrew. Everything is working.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 12,
      "score": 17.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1635
    }
  ],
  "scraped_at": "2025-06-10T09:47:29.255510"
}
{
  "topic_metadata": {
    "id": 4215,
    "title": "How to export CeTZ figures as separated SVG files?",
    "slug": "how-to-export-cetz-figures-as-separated-svg-files",
    "posts_count": 8,
    "created_at": "2025-05-21T16:29:37.591Z",
    "last_posted_at": "2025-05-22T19:03:25.460Z",
    "views": 98,
    "like_count": 5,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 7,
    "accepted_answer_username": "Andrew",
    "tags": [
      "scripting",
      "cetz"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 614
  },
  "posts": [
    {
      "id": 12894,
      "post_number": 1,
      "username": "Raul_Durand",
      "name": "Raul Durand",
      "created_at": "2025-05-21T16:29:37.716Z",
      "updated_at": "2025-05-21T21:29:46.781Z",
      "cooked": "<p>I’ve created a long document containing dozens of figures using CetZ. I’d like to programmatically export each CetZ figure as a separate SVG file so I can use them individually in a different context.</p>\n<p>What’s the best way to achieve this?</p>",
      "raw": "I’ve created a long document containing dozens of figures using CetZ. I’d like to programmatically export each CetZ figure as a separate SVG file so I can use them individually in a different context. \n\nWhat’s the best way to achieve this?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 34,
      "score": 71.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 583
    },
    {
      "id": 12896,
      "post_number": 2,
      "username": "joffdd",
      "name": "Joff",
      "created_at": "2025-05-21T16:41:39.391Z",
      "updated_at": "2025-05-21T16:41:39.391Z",
      "cooked": "<p>While this is not an automated way to achieve it, what I have done is creating a new empty project in the web app with the lines of code below, setting document size to <code>auto</code>, copying the cetz figure code and exporting the document as svg, which I then uploaded to my actual project.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#import \"@preview/cetz:0.3.4\"\n#set page(margin: 5mm, fill: white, width: auto, height: auto)\n\n// Your cetz figure here\n</code></pre>\n<p>But I would love to see a more automated workflow for this. Or ideally this would not be required because making no performance difference to just leaving whatever number of cetz figures in the document. My experience is that having a few dozens of objects in cetz, especially with relative positioning, makes the whole document super slow even when not actively working on the figures (which in my understanding shouldn’t be the case wrt caching etc…)</p>",
      "raw": "While this is not an automated way to achieve it, what I have done is creating a new empty project in the web app with the lines of code below, setting document size to `auto`, copying the cetz figure code and exporting the document as svg, which I then uploaded to my actual project.\n\n```typst\n#import \"@preview/cetz:0.3.4\"\n#set page(margin: 5mm, fill: white, width: auto, height: auto)\n\n// Your cetz figure here\n```\n\nBut I would love to see a more automated workflow for this. Or ideally this would not be required because making no performance difference to just leaving whatever number of cetz figures in the document. My experience is that having a few dozens of objects in cetz, especially with relative positioning, makes the whole document super slow even when not actively working on the figures (which in my understanding shouldn't be the case wrt caching etc...)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 6.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1494
    },
    {
      "id": 12907,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-21T19:37:20.222Z",
      "updated_at": "2025-05-21T19:38:59.476Z",
      "cooked": "<p>FYI, the name is <a href=\"https://cetz-package.github.io/\">CeTZ</a>.</p>\n<p>How exactly are figures inserted in the source file? If plainly from the markup mode, then it would be something like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n\n#set page(width: auto, height: auto, margin: 0.5pt)\n#set pagebreak(weak: true)\n\n#cetz.canvas(cetz.draw.circle(()))\n#pagebreak()\n\n#cetz.canvas(cetz.draw.circle(()))\n#pagebreak()\n</code></pre>\n<p>See <a href=\"https://github.com/typst/typst/issues/5741\" class=\"inline-onebox\">Add support for inside/center/outside strokes (change stroke bounding box) · Issue #5741 · typst/typst · GitHub</a> about page margins.</p>\n<p>Or maybe this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n\n#set page(width: auto, height: auto, margin: 0.5pt)\n\n#let canvas(..args) = cetz.canvas(..args) + pagebreak(weak: true)\n\n#canvas(cetz.draw.circle(()))\n\n#canvas(cetz.draw.circle(()))\n</code></pre>\n<p>Then obviously just compile into SVG format and you will have one figure per page, i.e., one figure per SVG file.</p>",
      "raw": "FYI, the name is [CeTZ](https://cetz-package.github.io/).\n\nHow exactly are figures inserted in the source file? If plainly from the markup mode, then it would be something like this:\n\n```typ\n#import \"@preview/cetz:0.3.4\"\n\n#set page(width: auto, height: auto, margin: 0.5pt)\n#set pagebreak(weak: true)\n\n#cetz.canvas(cetz.draw.circle(()))\n#pagebreak()\n\n#cetz.canvas(cetz.draw.circle(()))\n#pagebreak()\n```\n\nSee https://github.com/typst/typst/issues/5741 about page margins.\n\nOr maybe this:\n\n```typ\n#import \"@preview/cetz:0.3.4\"\n\n#set page(width: auto, height: auto, margin: 0.5pt)\n\n#let canvas(..args) = cetz.canvas(..args) + pagebreak(weak: true)\n\n#canvas(cetz.draw.circle(()))\n\n#canvas(cetz.draw.circle(()))\n```\n\nThen obviously just compile into SVG format and you will have one figure per page, i.e., one figure per SVG file.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 32,
      "score": 31.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12911,
      "post_number": 4,
      "username": "Raul_Durand",
      "name": "Raul Durand",
      "created_at": "2025-05-21T20:47:53.271Z",
      "updated_at": "2025-05-21T20:47:53.271Z",
      "cooked": "<p>The figures are embedded within a long report, alongside text, tables, equations, and other elements. I would prefer to keep the original source code unchanged. However, the source code could be included in another file where the extraction of the figures can take place.</p>",
      "raw": "The figures are embedded within a long report, alongside text, tables, equations, and other elements. I would prefer to keep the original source code unchanged. However, the source code could be included in another file where the extraction of the figures can take place.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 11.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 583
    },
    {
      "id": 12914,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-21T21:52:52.115Z",
      "updated_at": "2025-05-21T21:53:48.162Z",
      "cooked": "<p>You don’t say how the <code>canvas</code> is called, so you might have to change the source after all, because you can’t identify/tag figures without doing anything.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n\n#let canvas(..args) = {\n  let body = cetz.canvas(..args)\n  [#body#metadata(body)&lt;something&gt;]\n}\n\n#lorem(50)\n#canvas(cetz.draw.circle(()))\n#lorem(50)\n#canvas(cetz.draw.circle(()))\n#lorem(50)\n</code></pre>\n<br>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(width: auto, height: auto, margin: 0.5pt)\n#show: doc =&gt; context {\n  place(hide(doc))\n  query(&lt;something&gt;)\n    .map(x =&gt; x.value)\n    .intersperse(pagebreak(weak: true))\n    .join()\n}\n\n#include \"source.typ\"\n</code></pre>",
      "raw": "You don't say how the `canvas` is called, so you might have to change the source after all, because you can't identify/tag figures without doing anything.\n\n```typ\n#import \"@preview/cetz:0.3.4\"\n\n#let canvas(..args) = {\n  let body = cetz.canvas(..args)\n  [#body#metadata(body)<something>]\n}\n\n#lorem(50)\n#canvas(cetz.draw.circle(()))\n#lorem(50)\n#canvas(cetz.draw.circle(()))\n#lorem(50)\n```\n\n<br>\n\n```typ\n#set page(width: auto, height: auto, margin: 0.5pt)\n#show: doc => context {\n  place(hide(doc))\n  query(<something>)\n    .map(x => x.value)\n    .intersperse(pagebreak(weak: true))\n    .join()\n}\n\n#include \"source.typ\"\n```",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 33,
      "score": 36.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12956,
      "post_number": 6,
      "username": "Raul_Durand",
      "name": "Raul Durand",
      "created_at": "2025-05-22T16:17:02.145Z",
      "updated_at": "2025-05-22T16:19:52.748Z",
      "cooked": "<p>Wow, that is interesting!</p>\n<p>The way I call is</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#figure(caption: [Bending stress], placement:none,\n    cetz.canvas({\n        import cetz.draw: *\n        // stuff\n    }), \n)&lt;fig:bending-stress&gt;\n</code></pre>\n<p>Maybe a show rule could modify the <code>cetz.canvas</code> behavior.</p>",
      "raw": "Wow, that is interesting!\n\nThe way I call is \n```\n#figure(caption: [Bending stress], placement:none,\n    cetz.canvas({\n        import cetz.draw: *\n        // stuff\n    }), \n)<fig:bending-stress>\n```\n\nMaybe a show rule could modify the `cetz.canvas` behavior.",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 10.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 583
    },
    {
      "id": 12966,
      "post_number": 7,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-22T17:19:40.070Z",
      "updated_at": "2025-05-22T17:20:33.214Z",
      "cooked": "<p>No, the <code>canvas</code> function uses <code>context</code> right away, so there is absolutely no way to get that without help from the inside of the library.</p>\n<p>Since you are using <code>figure</code>, this means it can be used instead, but only if all figures are from CeTZ. Otherwise, you can check for whether the <code>it.body.func() == (context {}).func()</code> and hopefully any other figures don’t use <code>context</code>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/cetz:0.3.4\"\n\n#show figure: it =&gt; [#it#metadata(it.body)&lt;something&gt;]\n\n#lorem(50)\n\n#figure(caption: [Bending stress], cetz.canvas({\n  import cetz.draw: *\n  circle(())\n})) &lt;fig:bending-stress&gt;\n\n#lorem(50)\n\n#figure(cetz.canvas({\n  import cetz.draw: *\n  circle(())\n}))\n\n#lorem(50)\n</code></pre>",
      "raw": "No, the `canvas` function uses `context` right away, so there is absolutely no way to get that without help from the inside of the library.\n\nSince you are using `figure`, this means it can be used instead, but only if all figures are from CeTZ. Otherwise, you can check for whether the `it.body.func() == (context {}).func()` and hopefully any other figures don't use `context`.\n\n```typ\n#import \"@preview/cetz:0.3.4\"\n\n#show figure: it => [#it#metadata(it.body)<something>]\n\n#lorem(50)\n\n#figure(caption: [Bending stress], cetz.canvas({\n  import cetz.draw: *\n  circle(())\n})) <fig:bending-stress>\n\n#lorem(50)\n\n#figure(cetz.canvas({\n  import cetz.draw: *\n  circle(())\n}))\n\n#lorem(50)\n```",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 22,
      "score": 29.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12975,
      "post_number": 8,
      "username": "Raul_Durand",
      "name": "Raul Durand",
      "created_at": "2025-05-22T19:03:25.460Z",
      "updated_at": "2025-05-22T19:03:25.460Z",
      "cooked": "<p>Excellent! Thanks <a class=\"mention\" href=\"/u/andrew\">@Andrew</a>. I learned a lot!</p>",
      "raw": "Excellent! Thanks @Andrew. I learned a lot!",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 22,
      "score": 19.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 583
    }
  ],
  "scraped_at": "2025-06-10T09:47:28.465145"
}
{
  "topic_metadata": {
    "id": 4218,
    "title": "Why is my random shuffle always producing the same result when using Suiji?",
    "slug": "why-is-my-random-shuffle-always-producing-the-same-result-when-using-suiji",
    "posts_count": 10,
    "created_at": "2025-05-22T06:55:57.049Z",
    "last_posted_at": "2025-05-23T05:24:05.389Z",
    "views": 113,
    "like_count": 10,
    "reply_count": 7,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 6,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "scripting",
      "suiji"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 1481
  },
  "posts": [
    {
      "id": 12922,
      "post_number": 1,
      "username": "Daniel",
      "name": "Daniel Cook",
      "created_at": "2025-05-22T06:55:57.191Z",
      "updated_at": "2025-05-22T20:20:33.028Z",
      "cooked": "<p>I’m really stuck with this. I’d like to have a function that will randomize some options, but no matter how I go about it the randomization from suiji doesn’t seem to work quite randomly. To be more specific, all of the calls to the function result in the same randomization. What is expected is that each call to the function will have a different result.</p>\n<p>How can I have a different random list each call to the function?</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#import \"@preview/suiji:0.4.0\": *\n\n#let rng = gen-rng(1)\n\n#let randomize(options) = {\n  (_ , options) = shuffle(rng, options)\n  options.join(\", \")\n}\n\n#let options = (\"A\", \"B\", \"C\", \"D\")\n  \n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n</code></pre>\n<p>Results in</p>\n<p>D, B, C, A (repeated five times)</p>",
      "raw": "I'm really stuck with this. I'd like to have a function that will randomize some options, but no matter how I go about it the randomization from suiji doesn't seem to work quite randomly. To be more specific, all of the calls to the function result in the same randomization. What is expected is that each call to the function will have a different result.\n\nHow can I have a different random list each call to the function?\n\n```typst\n#import \"@preview/suiji:0.4.0\": *\n\n#let rng = gen-rng(1)\n\n#let randomize(options) = {\n  (_ , options) = shuffle(rng, options)\n  options.join(\", \")\n}\n\n#let options = (\"A\", \"B\", \"C\", \"D\")\n  \n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n```\n\nResults in \n\nD, B, C, A (repeated five times)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 40,
      "score": 83.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 94
    },
    {
      "id": 12925,
      "post_number": 2,
      "username": "gezepi",
      "name": "",
      "created_at": "2025-05-22T07:56:03.138Z",
      "updated_at": "2025-05-22T07:56:03.138Z",
      "cooked": "<p>Because each function in Typst is purely functional, there can’t be any state internal to the function (it can’t remember anything).  This means we need to give different arguments if we want different outputs (in this case different orderings).<br>\nEach time Suiji generates a random number it takes the <code>rng</code> value and also returns a new value that needs to be stored.  Then that new value is passed into the next function to use randomness.</p>\n<p>You code becomes:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/suiji:0.4.0\": *\n\n#let rng = gen-rng(1)\n\n#let randomize(options-arg, rng-arg) = {\n  let (rng-local , options-local) = shuffle(rng-arg, options-arg)\n  (rng-local, options-local.join(\", \"))\n}\n\n#let options = (\"A\", \"B\", \"C\", \"D\")\n\n#let (rng, output) = randomize(options, rng)\n#output\n\n#let (rng, output) = randomize(options, rng)\n#output\n\n#let (rng, output) = randomize(options, rng)\n#output\n\n#let (rng, output) = randomize(options, rng)\n#output\n\n#let (rng, output) = randomize(options, rng)\n#output\n</code></pre>\n<p>Results in:</p>\n<pre><code class=\"lang-plaintext\">D, B, C, A\nC, B, D, A\nC, D, B, A\nB, C, A, D\nD, A, C, B\n</code></pre>",
      "raw": "Because each function in Typst is purely functional, there can't be any state internal to the function (it can't remember anything).  This means we need to give different arguments if we want different outputs (in this case different orderings).\nEach time Suiji generates a random number it takes the `rng` value and also returns a new value that needs to be stored.  Then that new value is passed into the next function to use randomness.\n\nYou code becomes:\n```\n#import \"@preview/suiji:0.4.0\": *\n\n#let rng = gen-rng(1)\n\n#let randomize(options-arg, rng-arg) = {\n  let (rng-local , options-local) = shuffle(rng-arg, options-arg)\n  (rng-local, options-local.join(\", \"))\n}\n\n#let options = (\"A\", \"B\", \"C\", \"D\")\n\n#let (rng, output) = randomize(options, rng)\n#output\n\n#let (rng, output) = randomize(options, rng)\n#output\n\n#let (rng, output) = randomize(options, rng)\n#output\n\n#let (rng, output) = randomize(options, rng)\n#output\n\n#let (rng, output) = randomize(options, rng)\n#output\n```\nResults in:\n```text\nD, B, C, A\nC, B, D, A\nC, D, B, A\nB, C, A, D\nD, A, C, B\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 40,
      "score": 103.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 326
    },
    {
      "id": 12927,
      "post_number": 3,
      "username": "Daniel",
      "name": "Daniel Cook",
      "created_at": "2025-05-22T08:29:43.367Z",
      "updated_at": "2025-05-22T08:29:43.367Z",
      "cooked": "<p>This is a good explanation, thank you!</p>\n<p>My use case for this is for a package, and a user wouldn’t be able to manage handling <code>rng</code> constantly. I’ve tried to deal with this using <code>state</code> but if there are a number of calls to the function then it doesn’t resolve after a while (resulting in repeats).</p>\n<p>Do you happen to know if there is some way to update state?</p>\n<p>Here is what I tried (I realize the nested expression isn’t necessary, but you get the idea):</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#import \"@preview/suiji:0.4.0\": *\n\n#let rng = state(\"rng\", gen-rng(1))\n\n#let randomize(options) = {\n  context {\n    let _rng = none\n    let _options = none\n    (_rng, _options) = shuffle(rng.get(), options)\n    rng.update(_rng)\n    _options.join(\",\")\n  }\n}\n\n#let options = (\"A\", \"B\", \"C\", \"D\")\n  \n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n</code></pre>",
      "raw": "This is a good explanation, thank you! \n\nMy use case for this is for a package, and a user wouldn't be able to manage handling `rng` constantly. I've tried to deal with this using `state` but if there are a number of calls to the function then it doesn't resolve after a while (resulting in repeats). \n\nDo you happen to know if there is some way to update state? \n\nHere is what I tried (I realize the nested expression isn't necessary, but you get the idea):\n\n```typst\n#import \"@preview/suiji:0.4.0\": *\n\n#let rng = state(\"rng\", gen-rng(1))\n\n#let randomize(options) = {\n  context {\n    let _rng = none\n    let _options = none\n    (_rng, _options) = shuffle(rng.get(), options)\n    rng.update(_rng)\n    _options.join(\",\")\n  }\n}\n\n#let options = (\"A\", \"B\", \"C\", \"D\")\n  \n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n\n#randomize(options)\n```",
      "reply_to_post_number": 2,
      "reply_count": 3,
      "quote_count": 0,
      "like_count": 0,
      "reads": 39,
      "score": 22.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 94
    },
    {
      "id": 12930,
      "post_number": 4,
      "username": "gezepi",
      "name": "",
      "created_at": "2025-05-22T09:28:02.698Z",
      "updated_at": "2025-05-22T09:28:02.698Z",
      "cooked": "<p>I remember reading recently in an answer on the forum that using both <code>get()</code> and <code>update()</code> on a state in one context is not ideal.  I tried searching for the post that I am vaguely remembering but didn’t find it.</p>\n<p>I see in the <a href=\"https://typst.app/docs/reference/introspection/state/\">state page</a> of the documents that <code>update()</code> can be given a function that:</p>\n<blockquote>\n<p>receives the previous state and has to return the new state.</p>\n</blockquote>\n<p>After some trial-and-error I ended up with the following.  It stores the most recent ordering of <code>options</code> in the state with <code>rng</code> (as an array).</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/suiji:0.4.0\": *\n\n#let options = (\"A\", \"B\", \"C\", \"D\")\n#let rng-and-options = state(\"rng\", (gen-rng(1), options))\n\n#let randomize(rng-and-options-local) = context {\n  rng-and-options-local.update((current) =&gt; {\n    let (rng-cur, options-cur) = current\n    let (rng-new, options-new) = shuffle(rng-cur, options-cur)\n  \n    let new-state = (rng-new, options-new)\n    return new-state\n  })\n  rng-and-options-local.get().at(1).join(\", \")\n}\n\n#for _ in range(10) [\n  #randomize(rng-and-options)\n  #linebreak()\n]\n</code></pre>\n<p>Because the state is a parameter of the function, you can create a second set of options (and state):</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let options2 = (\"A\", \"B\", \"C\", \"D\", \"E\")\n#let rng-and-options2 = state(\"rng\", (gen-rng(1), options2))\n</code></pre>\n<p>And call the <code>randomize()</code> function with either of the states.</p>",
      "raw": "I remember reading recently in an answer on the forum that using both `get()` and `update()` on a state in one context is not ideal.  I tried searching for the post that I am vaguely remembering but didn't find it.\n\nI see in the [state page](https://typst.app/docs/reference/introspection/state/) of the documents that `update()` can be given a function that:\n> receives the previous state and has to return the new state.\n\nAfter some trial-and-error I ended up with the following.  It stores the most recent ordering of `options` in the state with `rng` (as an array).\n```\n#import \"@preview/suiji:0.4.0\": *\n\n#let options = (\"A\", \"B\", \"C\", \"D\")\n#let rng-and-options = state(\"rng\", (gen-rng(1), options))\n\n#let randomize(rng-and-options-local) = context {\n  rng-and-options-local.update((current) => {\n    let (rng-cur, options-cur) = current\n    let (rng-new, options-new) = shuffle(rng-cur, options-cur)\n  \n    let new-state = (rng-new, options-new)\n    return new-state\n  })\n  rng-and-options-local.get().at(1).join(\", \")\n}\n\n#for _ in range(10) [\n  #randomize(rng-and-options)\n  #linebreak()\n]\n```\nBecause the state is a parameter of the function, you can create a second set of options (and state):\n```\n#let options2 = (\"A\", \"B\", \"C\", \"D\", \"E\")\n#let rng-and-options2 = state(\"rng\", (gen-rng(1), options2))\n```\nAnd call the `randomize()` function with either of the states.",
      "reply_to_post_number": 3,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 39,
      "score": 32.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 326
    },
    {
      "id": 12932,
      "post_number": 5,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-05-22T09:40:51.199Z",
      "updated_at": "2025-05-22T09:40:51.199Z",
      "cooked": "<p>I think what <a class=\"mention\" href=\"/u/gezepi\">@gezepi</a> recommended is fundamentally the only way to do it usefully.</p>\n<p>The problem you have with state is layout convergence, see this post for details: <a href=\"https://forum.typst.app/t/why-is-state-final-not-final/1483\" class=\"inline-onebox\">Why is State Final not \"final\"?</a> In that thread I suggest a solution that, applied to your situation, would look roughly like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let rng = state(\"rng\", (gen-rng(1), none))\n\n#let randomize(options) = {\n  rng.update(((rng, _)) =&gt; shuffle(rng, options))\n  context rng.get().last()\n}\n</code></pre>\n<p>The <code>rng</code> state now contains the actual rng and the most recent result. The update is not done through a get…update cascade, so that’s good!</p>\n<p><em>However</em>, this function doesn’t give you an array; it gives you content: <a href=\"https://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164/2\" class=\"inline-onebox\">Why is the value I receive from context always content? - #2 by laurmaedje</a> The typical way around this is to pull the <code>context</code> keyword out:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let rng = state(\"rng\", (gen-rng(1), none))\n\n#let randomize(options) = {\n  rng.update(((rng, _)) =&gt; shuffle(rng, options))\n  rng.get().last()\n}\n\n...\n\n#context randomize(options)\n</code></pre>\n<p>But in this case that also doesn’t work: <code>randomize()</code> uses <code>update()</code>, and an update itself <em>is</em> content. So unless you really only need to output the randomized array (in which case content is fine), that’s also not a full solution. If that’s all you need, <a class=\"mention\" href=\"/u/gezepi\">@gezepi</a>’s second post (or my first snippet) gives you an answer.</p>\n<p>Assuming you want to use the randomized array further down, you’ll need to separate the update from the result, e.g. like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let randomize(options) = {\n  rng.update(((rng, _)) =&gt; shuffle(rng, options))\n}\n#let get-randomized() = {\n  rng.get().last()\n}\n\n...\n\n#randomize(options)\n#context get-randomized()\n</code></pre>\n<p>… but imo then you’re basically in the same situation as at the start, where you had to handle the rng variable (instead of the state update) separately on each call.</p>",
      "raw": "I think what @gezepi recommended is fundamentally the only way to do it usefully.\n\nThe problem you have with state is layout convergence, see this post for details: https://forum.typst.app/t/why-is-state-final-not-final/1483?u=sillyfreak In that thread I suggest a solution that, applied to your situation, would look roughly like this:\n\n```\n#let rng = state(\"rng\", (gen-rng(1), none))\n\n#let randomize(options) = {\n  rng.update(((rng, _)) => shuffle(rng, options))\n  context rng.get().last()\n}\n```\nThe `rng` state now contains the actual rng and the most recent result. The update is not done through a get...update cascade, so that's good!\n\n_However_, this function doesn't give you an array; it gives you content: https://forum.typst.app/t/why-is-the-value-i-receive-from-context-always-content/164/2?u=sillyfreak The typical way around this is to pull the `context` keyword out:\n\n```\n#let rng = state(\"rng\", (gen-rng(1), none))\n\n#let randomize(options) = {\n  rng.update(((rng, _)) => shuffle(rng, options))\n  rng.get().last()\n}\n\n...\n\n#context randomize(options)\n```\n\nBut in this case that also doesn't work: `randomize()` uses `update()`, and an update itself _is_ content. So unless you really only need to output the randomized array (in which case content is fine), that's also not a full solution. If that's all you need, @gezepi's second post (or my first snippet) gives you an answer.\n\nAssuming you want to use the randomized array further down, you'll need to separate the update from the result, e.g. like this:\n\n```\n#let randomize(options) = {\n  rng.update(((rng, _)) => shuffle(rng, options))\n}\n#let get-randomized() = {\n  rng.get().last()\n}\n\n...\n\n#randomize(options)\n#context get-randomized()\n```\n\n... but imo then you're basically in the same situation as at the start, where you had to handle the rng variable (instead of the state update) separately on each call.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 36,
      "score": 27.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 12933,
      "post_number": 6,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-05-22T09:43:53.871Z",
      "updated_at": "2025-05-22T09:43:53.871Z",
      "cooked": "<p>Actually I just had one more idea that I’ll put separately; using callbacks:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let rng = state(\"rng\", (gen-rng(1), none))\n\n#let randomize(options, callback) = {\n  rng.update(((rng, _)) =&gt; shuffle(rng, options))\n  context callback(rng.get().last())\n}\n\n#let options = (\"A\", \"B\", \"C\", \"D\")\n\n#randomize(options, shuffled =&gt; [#shuffled])\n\n#randomize(options, shuffled =&gt; [#shuffled])\n</code></pre>\n<p>This lets you make a single <code>randomize</code> call and hides the random handling, but it requires you to put everything that depends on the random result in a callback. This probably becomes annoying when you need multiple random things at the same time (meaning you have nested callbacks).</p>",
      "raw": "Actually I just had one more idea that I'll put separately; using callbacks:\n\n```\n#let rng = state(\"rng\", (gen-rng(1), none))\n\n#let randomize(options, callback) = {\n  rng.update(((rng, _)) => shuffle(rng, options))\n  context callback(rng.get().last())\n}\n\n#let options = (\"A\", \"B\", \"C\", \"D\")\n\n#randomize(options, shuffled => [#shuffled])\n\n#randomize(options, shuffled => [#shuffled])\n```\n\nThis lets you make a single `randomize` call and hides the random handling, but it requires you to put everything that depends on the random result in a callback. This probably becomes annoying when you need multiple random things at the same time (meaning you have nested callbacks).",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 32,
      "score": 41.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 12934,
      "post_number": 7,
      "username": "Daniel",
      "name": "Daniel Cook",
      "created_at": "2025-05-22T09:47:52.862Z",
      "updated_at": "2025-05-22T09:47:52.862Z",
      "cooked": "<p>Wow. There’s a lot here, and I know its a complicated problem because of the limitations of state.<br>\nI’ll take a look and try to flesh out some of your suggestions to see if they’ll work with what I have in mind.</p>\n<p>I can’t say thank you enough!</p>",
      "raw": "Wow. There's a lot here, and I know its a complicated problem because of the limitations of state.\nI'll take a look and try to flesh out some of your suggestions to see if they'll work with what I have in mind. \n\nI can't say thank you enough!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 31,
      "score": 51.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 94
    },
    {
      "id": 12935,
      "post_number": 8,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-05-22T09:49:38.149Z",
      "updated_at": "2025-05-22T09:49:38.149Z",
      "cooked": "<aside class=\"quote no-group quote-modified\" data-username=\"gezepi\" data-post=\"4\" data-topic=\"4218\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/g/C34CE0/48.png\" class=\"avatar\"> gezepi:</div>\n<blockquote>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let randomize(rng-and-options-local) = context {\n  rng-and-options-local.update(...)\n  rng-and-options-local.get().at(1).join(\", \")\n}\n</code></pre>\n</blockquote>\n</aside>\n<p>Note that there’s a slight difference between our suggestions, <a class=\"mention\" href=\"/u/gezepi\">@gezepi</a>. You have a <code>context</code> around the whole function, while I only wrap <code>get()</code>. That makes a difference! Context is frozen when a <code>context</code> expression starts, so your <code>get()</code> will actually retrieve the value <em>before</em> randomizing. Note how the first line you print contains “A, B, C, D” and not something random.</p>",
      "raw": "[quote=\"gezepi, post:4, topic:4218\"]\n```\n#let randomize(rng-and-options-local) = context {\n  rng-and-options-local.update(...)\n  rng-and-options-local.get().at(1).join(\", \")\n}\n```\n[/quote]\n\nNote that there's a slight difference between our suggestions, @gezepi. You have a `context` around the whole function, while I only wrap `get()`. That makes a difference! Context is frozen when a `context` expression starts, so your `get()` will actually retrieve the value _before_ randomizing. Note how the first line you print contains \"A, B, C, D\" and not something random.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 32,
      "score": 21.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 12955,
      "post_number": 9,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-22T15:43:37.470Z",
      "updated_at": "2025-05-22T15:43:37.470Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"gezepi\" data-post=\"4\" data-topic=\"4218\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/g/C34CE0/48.png\" class=\"avatar\"> gezepi:</div>\n<blockquote>\n<p>I remember reading recently in an answer on the forum that using both <code>get()</code> and <code>update()</code> on a state in one context is not ideal. I tried searching for the post that I am vaguely remembering but didn’t find it.</p>\n</blockquote>\n</aside>\n<p>Here you go: <a href=\"https://forum.typst.app/t/how-to-keep-exercise-and-solution-together-in-source-but-render-them-separately/3999/3\" class=\"inline-onebox\">How to keep exercise and solution together in source, but render them separately? - #3 by Andrew</a>.</p>",
      "raw": "[quote=\"gezepi, post:4, topic:4218\"]\nI remember reading recently in an answer on the forum that using both `get()` and `update()` on a state in one context is not ideal. I tried searching for the post that I am vaguely remembering but didn’t find it.\n[/quote]\n\nHere you go: https://forum.typst.app/t/how-to-keep-exercise-and-solution-together-in-source-but-render-them-separately/3999/3?u=andrew.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 30,
      "score": 21.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12998,
      "post_number": 10,
      "username": "Daniel",
      "name": "Daniel Cook",
      "created_at": "2025-05-23T05:24:05.389Z",
      "updated_at": "2025-05-23T05:24:05.389Z",
      "cooked": "<p>After hashing this out a bit with my use case, I’m going to mark this as a solution.</p>\n<p>There are a few other caveats:</p>\n<ol>\n<li>Nesting these will result in non-convergence.</li>\n<li>If there are multiple steps or multiple arrays that need to be shuffled/etc, it is possible. It seems the best way is to have a nested function that does all of the randomization necessary step by step. I have one use case that takes two arrays of options, both arrays have to go through suiji <span class=\"hashtag-raw\">#choice</span>, then combined together for a shuffle. Doing those steps all together and keeping the intermittent arrays stored in state works. An alternative is to store a dictionary as the state and reference the keys later post callback.</li>\n</ol>\n<p>So, it seems to work. I have yet to modify my project but it looks like it will work out. This does make for a different structure/approach for code (i.e. you basically have to make the randomization the last thing and so everything else should be done first).</p>",
      "raw": "After hashing this out a bit with my use case, I'm going to mark this as a solution.\n\nThere are a few other caveats:\n\n1. Nesting these will result in non-convergence.\n2. If there are multiple steps or multiple arrays that need to be shuffled/etc, it is possible. It seems the best way is to have a nested function that does all of the randomization necessary step by step. I have one use case that takes two arrays of options, both arrays have to go through suiji #choice, then combined together for a shuffle. Doing those steps all together and keeping the intermittent arrays stored in state works. An alternative is to store a dictionary as the state and reference the keys later post callback.\n\nSo, it seems to work. I have yet to modify my project but it looks like it will work out. This does make for a different structure/approach for code (i.e. you basically have to make the randomization the last thing and so everything else should be done first).",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 5.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 94
    }
  ],
  "scraped_at": "2025-06-10T09:47:27.545136"
}
{
  "topic_metadata": {
    "id": 4223,
    "title": "How can I disable presentation title in header in touying (simple theme)?",
    "slug": "how-can-i-disable-presentation-title-in-header-in-touying-simple-theme",
    "posts_count": 2,
    "created_at": "2025-05-22T09:31:32.152Z",
    "last_posted_at": "2025-05-22T10:18:55.774Z",
    "views": 26,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "aarnent",
    "tags": [
      "touying"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 70
  },
  "posts": [
    {
      "id": 12931,
      "post_number": 1,
      "username": "Tamas_K_Papp",
      "name": "Tamas K. Papp",
      "created_at": "2025-05-22T09:31:32.304Z",
      "updated_at": "2025-05-22T19:21:52.505Z",
      "cooked": "<p>I wish to maximize slide space. I am using the simple theme in touying, but it puts the presentation title above the slide title. How can I get rid of that?</p>",
      "raw": "I wish to maximize slide space. I am using the simple theme in touying, but it puts the presentation title above the slide title. How can I get rid of that?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 15,
      "score": 33.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1120
    },
    {
      "id": 12937,
      "post_number": 2,
      "username": "aarnent",
      "name": "",
      "created_at": "2025-05-22T10:18:55.774Z",
      "updated_at": "2025-05-22T10:18:55.774Z",
      "cooked": "<p>Do you mean the header? The <a href=\"https://touying-typ.github.io/docs/themes/simple#initialization\">docs</a> go over all the options you can change. In your case, it’d be fixed with</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show: simple-theme.with(\n  header: none\n)\n</code></pre>",
      "raw": "Do you mean the header? The [docs](https://touying-typ.github.io/docs/themes/simple#initialization) go over all the options you can change. In your case, it'd be fixed with\n\n```typ\n#show: simple-theme.with(\n  header: none\n)\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 14,
      "score": 32.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 501
    }
  ],
  "scraped_at": "2025-06-10T09:47:26.781773"
}
{
  "topic_metadata": {
    "id": 4227,
    "title": "Can I format a heading without a newline?",
    "slug": "can-i-format-a-heading-without-a-newline",
    "posts_count": 7,
    "created_at": "2025-05-22T13:52:15.742Z",
    "last_posted_at": "2025-05-22T17:05:35.864Z",
    "views": 54,
    "like_count": 4,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "sijo",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 453
  },
  "posts": [
    {
      "id": 12944,
      "post_number": 1,
      "username": "kescobo",
      "name": "Kevin Bonham",
      "created_at": "2025-05-22T13:52:15.845Z",
      "updated_at": "2025-05-22T19:10:02.969Z",
      "cooked": "<p>I’d like to create a heading format so that eg</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">== My internal header\n\n#lorem(50)\n</code></pre>\n<p>Gets formatted to look the way</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#text(14pt, weight: \"bold\")[My internal header:] #lorem(50)\n</code></pre>\n<p>would look. Is that possible? If I need to remove the blank line between the header and the paragraph text, that’s fine too, though I don’t know if that makes a difference.</p>",
      "raw": "I'd like to create a heading format so that eg\n\n```typst\n== My internal header\n\n#lorem(50)\n```\n\nGets formatted to look the way\n\n```typst\n#text(14pt, weight: \"bold\")[My internal header:] #lorem(50)\n```\n\nwould look. Is that possible? If I need to remove the blank line between the header and the paragraph text, that's fine too, though I don't know if that makes a difference.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 74.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 508
    },
    {
      "id": 12949,
      "post_number": 2,
      "username": "sijo",
      "name": "",
      "created_at": "2025-05-22T14:37:37.298Z",
      "updated_at": "2025-05-22T17:00:30.053Z",
      "cooked": "<p>You can use something like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading.where(level: 2): it =&gt; {\n  set text(14pt)\n  box(it) + \":\"\n}\n\n== My internal header\n#lorem(50)\n</code></pre>\n<p>You could replace <code>box(it)</code> with <code>it.body</code> but this wouldn’t compose very well with other show-it rules since it removes the heading element.</p>\n<p>Note that you will need to start the section content right after the title in markup (no empty line).</p>",
      "raw": "You can use something like this:\n\n```typ\n#show heading.where(level: 2): it => {\n  set text(14pt)\n  box(it) + \":\"\n}\n\n== My internal header\n#lorem(50)\n```\n\nYou could replace `box(it)` with `it.body` but this wouldn't compose very well with other show-it rules since it removes the heading element.\n\nNote that you will need to start the section content right after the title in markup (no empty line).",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 2,
      "reads": 19,
      "score": 43.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 12960,
      "post_number": 3,
      "username": "kescobo",
      "name": "Kevin Bonham",
      "created_at": "2025-05-22T16:31:49.095Z",
      "updated_at": "2025-05-22T16:31:49.095Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"sijo\" data-post=\"2\" data-topic=\"4227\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/0A3649/48.png\" class=\"avatar\"> sijo:</div>\n<blockquote>\n<p>this doesn’t compose very well with other show-it rules since it removes the heading element.</p>\n</blockquote>\n</aside>\n<p>Good to note, but that’s ok for my current use-case. Thanks!</p>",
      "raw": "[quote=\"sijo, post:2, topic:4227\"]\nthis doesn’t compose very well with other show-it rules since it removes the heading element.\n[/quote]\n\nGood to note, but that's ok for my current use-case. Thanks!",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 18,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 508
    },
    {
      "id": 12961,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-22T16:42:07.116Z",
      "updated_at": "2025-05-22T16:43:33.829Z",
      "cooked": "<p>Hello. Here is a robust yet hacky solution:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading.where(level: 2): it =&gt; {\n  set text(14pt)\n  box(it) + \":\"\n}\n\n#show: doc =&gt; {\n  let i = 0\n  let elements = doc.children\n  while i &lt; elements.len() {\n    if elements.at(i).func() == heading and elements.at(i).depth == 2 {\n      elements.at(i)\n      let j = i + 1\n      while (\n        j &lt; elements.len() and elements.at(j).func() in (parbreak, [ ].func())\n      ) {\n        j += 1\n      }\n      if j &gt;= elements.len() { break }\n      \" \"\n      i = j\n    }\n    elements.at(i)\n    i += 1\n  }\n}\n\n== Heading\n// space\n#lorem(50)\n\n== Heading\n#lorem(50)\n\n== Heading\n\n#lorem(50)\n\n#heading(depth: 2)[Heading]#lorem(50)\n\n== Heading\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/4/464406c1f8a8d9c2913ecba9393846ddab3f0963.png\" alt=\"image\" data-base62-sha1=\"a1BasVrayWgmit7zZtxOkHMYrC3\" width=\"593\" height=\"374\"></p>\n<p>You can start writing a paragraph however you want, but global show rules can break something else. Though only real testing can say for sure. If there is a top-level styling added, then the <code>styled</code> element will have to be parsed a bit differently, though still should be possible.</p>",
      "raw": "Hello. Here is a robust yet hacky solution:\n\n```typ\n#show heading.where(level: 2): it => {\n  set text(14pt)\n  box(it) + \":\"\n}\n\n#show: doc => {\n  let i = 0\n  let elements = doc.children\n  while i < elements.len() {\n    if elements.at(i).func() == heading and elements.at(i).depth == 2 {\n      elements.at(i)\n      let j = i + 1\n      while (\n        j < elements.len() and elements.at(j).func() in (parbreak, [ ].func())\n      ) {\n        j += 1\n      }\n      if j >= elements.len() { break }\n      \" \"\n      i = j\n    }\n    elements.at(i)\n    i += 1\n  }\n}\n\n== Heading\n// space\n#lorem(50)\n\n== Heading\n#lorem(50)\n\n== Heading\n\n#lorem(50)\n\n#heading(depth: 2)[Heading]#lorem(50)\n\n== Heading\n```\n\n![image|593x374](upload://a1BasVrayWgmit7zZtxOkHMYrC3.png)\n\nYou can start writing a paragraph however you want, but global show rules can break something else. Though only real testing can say for sure. If there is a top-level styling added, then the `styled` element will have to be parsed a bit differently, though still should be possible.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 17,
      "score": 38.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12962,
      "post_number": 5,
      "username": "kescobo",
      "name": "Kevin Bonham",
      "created_at": "2025-05-22T16:51:28.181Z",
      "updated_at": "2025-05-22T16:51:28.181Z",
      "cooked": "<p>Woah, neat! I barely understand what’s going on, but the results speak for themselves <img src=\"https://forum.typst.app/images/emoji/apple/smile.png?v=12\" title=\":smile:\" class=\"emoji\" alt=\":smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Woah, neat! I barely understand what's going on, but the results speak for themselves :smile:",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 13,
      "score": 7.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 508
    },
    {
      "id": 12963,
      "post_number": 6,
      "username": "sijo",
      "name": "",
      "created_at": "2025-05-22T17:00:14.690Z",
      "updated_at": "2025-05-22T17:01:21.736Z",
      "cooked": "<aside class=\"quote no-group quote-modified\" data-username=\"kescobo\" data-post=\"3\" data-topic=\"4227\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/k/19798D/48.png\" class=\"avatar\"> kescobo:</div>\n<blockquote>\n<aside class=\"quote no-group quote-modified\" data-username=\"sijo\" data-post=\"2\" data-topic=\"4227\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/0A3649/48.png\" class=\"avatar\"> sijo:</div>\n<blockquote>\n<p>this doesn’t compose very well with other show-it rules since it removes the heading element.</p>\n</blockquote>\n</aside>\n<p>Good to note, but that’s ok for my current use-case. Thanks!</p>\n</blockquote>\n</aside>\n<p>To be clear, the given code (with <code>box(it)</code>) doesn’t have that problem because it preserves the <code>it</code> value instead of replacing it with <code>it.body</code>.</p>",
      "raw": "[quote=\"kescobo, post:3, topic:4227, full:true\"]\n[quote=\"sijo, post:2, topic:4227\"]\nthis doesn’t compose very well with other show-it rules since it removes the heading element.\n[/quote]\n\nGood to note, but that’s ok for my current use-case. Thanks!\n[/quote]\n\nTo be clear, the given code (with `box(it)`) doesn't have that problem because it preserves the `it` value instead of replacing it with `it.body`.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 2,
      "like_count": 0,
      "reads": 12,
      "score": 2.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 12965,
      "post_number": 7,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-22T17:05:35.864Z",
      "updated_at": "2025-05-22T17:05:35.864Z",
      "cooked": "<p>The algorithm goes over all elements in the <code>sequence</code> element and filters out <code>parbreak</code> and <code>space</code> elements that go after the <code>depth: 2</code> headings. And adds a single space after all the removed stuff if there is still something after the heading.</p>",
      "raw": "The algorithm goes over all elements in the `sequence` element and filters out `parbreak` and `space` elements that go after the `depth: 2` headings. And adds a single space after all the removed stuff if there is still something after the heading.",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 12,
      "score": 2.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:47:26.055124"
}
{
  "topic_metadata": {
    "id": 4228,
    "title": "How can I emulate LaTeX `\\part`s?",
    "slug": "how-can-i-emulate-latex-part-s",
    "posts_count": 2,
    "created_at": "2025-05-22T13:59:42.245Z",
    "last_posted_at": "2025-05-22T14:11:16.923Z",
    "views": 48,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "layout",
      "latex-migration"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 36
  },
  "posts": [
    {
      "id": 12946,
      "post_number": 1,
      "username": "TheJanzap",
      "name": "",
      "created_at": "2025-05-22T13:59:42.380Z",
      "updated_at": "2025-05-22T19:20:41.971Z",
      "cooked": "<p>I would like to recreate the LaTeX <code>\\part</code> function in my documents.<br>\nHow can I do that?</p>",
      "raw": "I would like to recreate the LaTeX `\\part` function in my documents.\nHow can I do that?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 20.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 132
    },
    {
      "id": 12947,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-05-22T14:11:16.923Z",
      "updated_at": "2025-05-22T14:11:16.923Z",
      "cooked": "<p>I think this should fit your needs</p>\n<aside class=\"quote quote-modified\" data-post=\"6\" data-topic=\"3906\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/part-independent-section/3906/6\">Part independent section</a> <a class=\"badge-category__wrapper \" href=\"/c/showcase/6\"><span data-category-id=\"6\" style=\"--category-badge-color: #239DAD; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"This is the place to post in if you want to show off something you created with Typst: Be it the most beautiful paper you have ever seen or something extremely out-of-the box and crazy.\"><span class=\"badge-category__name\">Showcase</span></span></a>\n  </div>\n  <blockquote>\n    You can simplify this by using numbering, counter, and spread operator: \n#set heading(numbering: (..nums) =&gt; {\n  let chapter-count = counter(\"chapter counter\")\n  if nums.pos().len() == 1 {\n    // Level 1: Roman numerals for Parts.\n    numbering(\"I\", ..nums)\n  } else if nums.pos().len() == 2 {\n    // Level 2: Use the chapter state counter and increment it.\n    chapter-count.step()\n    str(chapter-count.get().first() + 1)\n    // or\n    // context numbering(\"1\", ..chapter-count.get())\n  } else {\n  …\n  </blockquote>\n</aside>\n",
      "raw": "I think this should fit your needs\n\nhttps://forum.typst.app/t/part-independent-section/3906/6?u=quachpas",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 25,
      "score": 40.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    }
  ],
  "scraped_at": "2025-06-10T09:47:25.336972"
}
{
  "topic_metadata": {
    "id": 4239,
    "title": "How do I use #case while maintaining & alignment?",
    "slug": "how-do-i-use-case-while-maintaining-alignment",
    "posts_count": 3,
    "created_at": "2025-05-23T04:56:05.172Z",
    "last_posted_at": "2025-05-24T04:19:05.198Z",
    "views": 45,
    "like_count": 2,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "cetz",
      "mannot"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 433
  },
  "posts": [
    {
      "id": 12995,
      "post_number": 1,
      "username": "NeoPrim",
      "name": "",
      "created_at": "2025-05-23T04:56:05.284Z",
      "updated_at": "2025-05-24T14:05:18.738Z",
      "cooked": "<p>I have the following LP problem formulation:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">$\n  min quad &amp;9x_1 + 12x_2 + 10x_3 + 12x_4 + y_1 + y_2 + y_3 + y_4 \\\n  s.t. quad &amp;x_1 - 100 = y_1 \\\n            &amp;y_1 + x_2 - 150 = y_2 \\\n            &amp;y_2 + x_3 - 200 = y_3 \\\n            &amp;y_3 + x_4 - 170 = y_4 \\\n            &amp; x_1 gt.eq 100 \\\n            &amp;y_1 + x_2 gt.eq 150 \\\n            &amp;y_2 + x_3 gt.eq 200 \\\n            &amp;y_3 + x_4 gt.eq 170 \\\n            &amp;x_t, y_t gt.eq 0 quad forall t = 1, dots, 4 \n$\n</code></pre>\n<p>I’d like to maintain the alignment as it currently stands while adding the <span class=\"hashtag-raw\">#case</span> as shown below:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/0/07b92fe90b8cebbe640b3db010b6a465ead73ecd.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/07b92fe90b8cebbe640b3db010b6a465ead73ecd\" title=\"Screenshot 2025-05-23 at 12.55.10\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/0/07b92fe90b8cebbe640b3db010b6a465ead73ecd_2_690x439.jpeg\" alt=\"Screenshot 2025-05-23 at 12.55.10\" data-base62-sha1=\"16k6rvOmIJFo8mj3XyUhW2INOoZ\" width=\"690\" height=\"439\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/0/07b92fe90b8cebbe640b3db010b6a465ead73ecd_2_690x439.jpeg, https://forum.typst.app/uploads/default/optimized/2X/0/07b92fe90b8cebbe640b3db010b6a465ead73ecd_2_1035x658.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/0/07b92fe90b8cebbe640b3db010b6a465ead73ecd_2_1380x878.jpeg 2x\" data-dominant-color=\"F6F9F8\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2025-05-23 at 12.55.10</span><span class=\"informations\">1920×1223 54.9 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "I have the following LP problem formulation:\n```typst\n$\n  min quad &9x_1 + 12x_2 + 10x_3 + 12x_4 + y_1 + y_2 + y_3 + y_4 \\\n  s.t. quad &x_1 - 100 = y_1 \\\n            &y_1 + x_2 - 150 = y_2 \\\n            &y_2 + x_3 - 200 = y_3 \\\n            &y_3 + x_4 - 170 = y_4 \\\n            & x_1 gt.eq 100 \\\n            &y_1 + x_2 gt.eq 150 \\\n            &y_2 + x_3 gt.eq 200 \\\n            &y_3 + x_4 gt.eq 170 \\\n            &x_t, y_t gt.eq 0 quad forall t = 1, dots, 4 \n$\n```\nI'd like to maintain the alignment as it currently stands while adding the #case as shown below:\n![Screenshot 2025-05-23 at 12.55.10|690x439](upload://16k6rvOmIJFo8mj3XyUhW2INOoZ.jpeg)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 4.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1600
    },
    {
      "id": 13019,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-23T13:41:22.250Z",
      "updated_at": "2025-05-23T13:42:15.417Z",
      "cooked": "<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/mannot:0.3.0\": *\n#import \"@preview/cetz:0.3.4\"\n\n#let annotate-brace(start, end, body) = {\n  cetz.decorations.brace(start, end, name: \"a\", stroke: green)\n  cetz.draw.content(\"a.east\", anchor: \"west\", padding: 0.2, text(green, body))\n}\n\n#let offset-brace-start-end(start, end) = (\n  (rel: (0.5, +0.5em), to: (start, \"-|\", end)),\n  (rel: (0.5, -0.5em), to: end),\n)\n\n$\n   min quad &amp; 9x_1 + 12x_2 + 10x_3 + 12x_4 + y_1 + y_2 + y_3 + y_4 \\\n  s.t. quad &amp; x_1 - 100 = mark(y_1, tag: #&lt;y1&gt;)                    \\\n            &amp; y_1 + x_2 - 150 = y_2                                \\\n            &amp; y_2 + x_3 - 200 = y_3                                \\\n            &amp; y_3 + x_4 - 170 = mark(y_4, tag: #&lt;y4&gt;)              \\\n            &amp; x_1 &gt;= mark(100, tag: #&lt;100&gt;)                        \\\n            &amp; y_1 + x_2 &gt;= 150                                     \\\n            &amp; y_2 + x_3 &gt;= 200                                     \\\n            &amp; y_3 + x_4 &gt;= mark(170, tag: #&lt;170&gt;)                  \\\n            &amp; x_t, y_t &gt;= 0 quad forall t = 1, dots, 4             \\\n  #annot-cetz((&lt;y1&gt;, &lt;y4&gt;, &lt;100&gt;, &lt;170&gt;), cetz, {\n    annotate-brace(..offset-brace-start-end(\"y1\", \"y4\"))[I.B.]\n    annotate-brace(..offset-brace-start-end(\"100\", \"170\"))[D.F.]\n  })\n$\n</code></pre>\n<p>Or slightly more compact:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/mannot:0.3.0\": *\n#import \"@preview/cetz:0.3.4\"\n\n#let annotate-brace(start, end, body) = {\n  cetz.decorations.brace(start, end, name: \"a\", stroke: green)\n  cetz.draw.content(\"a.east\", anchor: \"west\", padding: 0.2, text(green, body))\n}\n\n#let offset-brace-start-end(start, end) = (\n  (rel: (0.5, +0.5em), to: (start, \"-|\", end)),\n  (rel: (0.5, -0.5em), to: end),\n)\n\n#let tag(body, tag) = mark(body, tag: label(tag))\n\n$\n   min quad &amp; 9x_1 + 12x_2 + 10x_3 + 12x_4 + y_1 + y_2 + y_3 + y_4 \\\n  s.t. quad &amp; x_1 - 100 = tag(y_1, \"y1\")                           \\\n            &amp; y_1 + x_2 - 150 = y_2                                \\\n            &amp; y_2 + x_3 - 200 = y_3                                \\\n            &amp; y_3 + x_4 - 170 = tag(y_4, \"y4\")                     \\\n            &amp; x_1 &gt;= tag(100, \"100\")                               \\\n            &amp; y_1 + x_2 &gt;= 150                                     \\\n            &amp; y_2 + x_3 &gt;= 200                                     \\\n            &amp; y_3 + x_4 &gt;= tag(170, \"170\")                         \\\n            &amp; x_t, y_t &gt;= 0 quad forall t = 1, dots, 4             \\\n  #annot-cetz((&lt;y1&gt;, &lt;y4&gt;, &lt;100&gt;, &lt;170&gt;), cetz, {\n    annotate-brace(..offset-brace-start-end(\"y1\", \"y4\"))[I.B.]\n    annotate-brace(..offset-brace-start-end(\"100\", \"170\"))[D.F.]\n  })\n$\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/7/708fbff4841421f4be5079d1c91526cc5a08161f.png\" alt=\"image\" data-base62-sha1=\"g3LstqLOb05L2jKjFWuNf1SAGNV\" width=\"343\" height=\"246\"></p>\n<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/universe/package/mannot\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/universe/package/mannot\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/universe/package/mannot\" target=\"_blank\" rel=\"noopener\">mannot – Typst Universe</a></h3>\n\n  <p>A package for marking and annotating in math blocks.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>Cc <a class=\"mention\" href=\"/u/ryuryu\">@ryuryu</a></p>",
      "raw": "```typ\n#import \"@preview/mannot:0.3.0\": *\n#import \"@preview/cetz:0.3.4\"\n\n#let annotate-brace(start, end, body) = {\n  cetz.decorations.brace(start, end, name: \"a\", stroke: green)\n  cetz.draw.content(\"a.east\", anchor: \"west\", padding: 0.2, text(green, body))\n}\n\n#let offset-brace-start-end(start, end) = (\n  (rel: (0.5, +0.5em), to: (start, \"-|\", end)),\n  (rel: (0.5, -0.5em), to: end),\n)\n\n$\n   min quad & 9x_1 + 12x_2 + 10x_3 + 12x_4 + y_1 + y_2 + y_3 + y_4 \\\n  s.t. quad & x_1 - 100 = mark(y_1, tag: #<y1>)                    \\\n            & y_1 + x_2 - 150 = y_2                                \\\n            & y_2 + x_3 - 200 = y_3                                \\\n            & y_3 + x_4 - 170 = mark(y_4, tag: #<y4>)              \\\n            & x_1 >= mark(100, tag: #<100>)                        \\\n            & y_1 + x_2 >= 150                                     \\\n            & y_2 + x_3 >= 200                                     \\\n            & y_3 + x_4 >= mark(170, tag: #<170>)                  \\\n            & x_t, y_t >= 0 quad forall t = 1, dots, 4             \\\n  #annot-cetz((<y1>, <y4>, <100>, <170>), cetz, {\n    annotate-brace(..offset-brace-start-end(\"y1\", \"y4\"))[I.B.]\n    annotate-brace(..offset-brace-start-end(\"100\", \"170\"))[D.F.]\n  })\n$\n```\n\nOr slightly more compact:\n\n```typ\n#import \"@preview/mannot:0.3.0\": *\n#import \"@preview/cetz:0.3.4\"\n\n#let annotate-brace(start, end, body) = {\n  cetz.decorations.brace(start, end, name: \"a\", stroke: green)\n  cetz.draw.content(\"a.east\", anchor: \"west\", padding: 0.2, text(green, body))\n}\n\n#let offset-brace-start-end(start, end) = (\n  (rel: (0.5, +0.5em), to: (start, \"-|\", end)),\n  (rel: (0.5, -0.5em), to: end),\n)\n\n#let tag(body, tag) = mark(body, tag: label(tag))\n\n$\n   min quad & 9x_1 + 12x_2 + 10x_3 + 12x_4 + y_1 + y_2 + y_3 + y_4 \\\n  s.t. quad & x_1 - 100 = tag(y_1, \"y1\")                           \\\n            & y_1 + x_2 - 150 = y_2                                \\\n            & y_2 + x_3 - 200 = y_3                                \\\n            & y_3 + x_4 - 170 = tag(y_4, \"y4\")                     \\\n            & x_1 >= tag(100, \"100\")                               \\\n            & y_1 + x_2 >= 150                                     \\\n            & y_2 + x_3 >= 200                                     \\\n            & y_3 + x_4 >= tag(170, \"170\")                         \\\n            & x_t, y_t >= 0 quad forall t = 1, dots, 4             \\\n  #annot-cetz((<y1>, <y4>, <100>, <170>), cetz, {\n    annotate-brace(..offset-brace-start-end(\"y1\", \"y4\"))[I.B.]\n    annotate-brace(..offset-brace-start-end(\"100\", \"170\"))[D.F.]\n  })\n$\n```\n\n![image|343x246](upload://g3LstqLOb05L2jKjFWuNf1SAGNV.png)\n\nhttps://typst.app/universe/package/mannot\n\nCc @ryuryu",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 23.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13058,
      "post_number": 3,
      "username": "NeoPrim",
      "name": "",
      "created_at": "2025-05-24T04:19:05.198Z",
      "updated_at": "2025-05-24T04:19:05.198Z",
      "cooked": "<p>Wow thank you. I would have never come up with this on my own <img src=\"https://forum.typst.app/images/emoji/apple/joy.png?v=12\" title=\":joy:\" class=\"emoji\" alt=\":joy:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Wow thank you. I would have never come up with this on my own :joy:",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 16,
      "score": 18.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1600
    }
  ],
  "scraped_at": "2025-06-10T09:47:24.536423"
}
{
  "topic_metadata": {
    "id": 4243,
    "title": "Can typst have an infinite page like a webpage",
    "slug": "can-typst-have-an-infinite-page-like-a-webpage",
    "posts_count": 6,
    "created_at": "2025-05-23T09:41:35.281Z",
    "last_posted_at": "2025-05-23T18:13:02.265Z",
    "views": 116,
    "like_count": 2,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 327
  },
  "posts": [
    {
      "id": 13004,
      "post_number": 1,
      "username": "chaos",
      "name": "chaos",
      "created_at": "2025-05-23T09:41:35.494Z",
      "updated_at": "2025-05-23T09:41:35.494Z",
      "cooked": "<p>I was working on a html note template. Suddenly, I found an infinite typst doc is exactly what I want. Is it possible?</p>",
      "raw": "I was working on a html note template. Suddenly, I found an infinite typst doc is exactly what I want. Is it possible?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 44,
      "score": 43.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1644
    },
    {
      "id": 13008,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-05-23T10:30:32.077Z",
      "updated_at": "2025-05-23T10:30:32.077Z",
      "cooked": "<p>yes, you can <code>set page(height: auto)</code>. The page will grow with its content. I use this setup for previewing content with tinymist, that is ultimately meant to be exported as html.</p>\n<p>You can still put pagebreaks in there if you want; if you explicitly <em>don’t</em> want any pagebreaks, even when a package inserts them, you can also add <code>show pagebreak: none</code>.</p>",
      "raw": "yes, you can `set page(height: auto)`. The page will grow with its content. I use this setup for previewing content with tinymist, that is ultimately meant to be exported as html.\n\nYou can still put pagebreaks in there if you want; if you explicitly _don't_ want any pagebreaks, even when a package inserts them, you can also add `show pagebreak: none`.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 44,
      "score": 43.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 13010,
      "post_number": 3,
      "username": "chaos",
      "name": "chaos",
      "created_at": "2025-05-23T10:47:28.154Z",
      "updated_at": "2025-05-23T10:48:19.021Z",
      "cooked": "<p>Incredible typst! Thanks a lot, I’m glad to have an answer here.</p>",
      "raw": "Incredible typst! Thanks a lot, I'm glad to have an answer here.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 40,
      "score": 8.0,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1644
    },
    {
      "id": 13022,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-23T14:04:57.777Z",
      "updated_at": "2025-05-23T14:04:57.777Z",
      "cooked": "<p>Hello. HTML template? Are you talking about experimental HTML export? It doesn’t have any height restrictions, well, because it’s a webpage.</p>\n<pre data-code-wrap=\"txt\"><code class=\"lang-txt\"> typc file.typ -f html --features=html\nwarning: html export is under active development and incomplete\n = hint: its behaviour may change at any time\n = hint: do not rely on this feature for production use cases\n = hint: see https://github.com/typst/typst/issues/5512 for more information\n\nwarning: pagebreak was ignored during HTML export\n  ┌─ file.typ:2:1\n  │\n2 │ #pagebreak()\n  │  ^^^^^^^^^^^\n</code></pre>",
      "raw": "Hello. HTML template? Are you talking about experimental HTML export? It doesn't have any height restrictions, well, because it's a webpage.\n\n```txt\n typc file.typ -f html --features=html\nwarning: html export is under active development and incomplete\n = hint: its behaviour may change at any time\n = hint: do not rely on this feature for production use cases\n = hint: see https://github.com/typst/typst/issues/5512 for more information\n\nwarning: pagebreak was ignored during HTML export\n  ┌─ file.typ:2:1\n  │\n2 │ #pagebreak()\n  │  ^^^^^^^^^^^\n```",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 21.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13023,
      "post_number": 6,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-05-23T14:16:53.075Z",
      "updated_at": "2025-05-23T14:16:53.075Z",
      "cooked": "<p>I think they meant that they started with HTML (because of the unlimited height) and then realized that except for the paged layout, <em>regular</em> Typst is closer to what they were looking for.</p>",
      "raw": "I think they meant that they started with HTML (because of the unlimited height) and then realized that except for the paged layout, _regular_ Typst is closer to what they were looking for.",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 6.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 13040,
      "post_number": 7,
      "username": "chaos",
      "name": "chaos",
      "created_at": "2025-05-23T18:13:02.265Z",
      "updated_at": "2025-05-24T07:03:54.545Z",
      "cooked": "<p>I reconsider the need for writing and reading my own note. Since it won’t be published or printed into journal, there’s no need for keeping the pagebreak. That’s why I want creat a custom html for note.<br>\nBarely cares the output format. But thank you for reminding me the html exporting. Now I have more options to restore and read my notes.<br>\nNow I have a new idea. Thinking of a wide display in landscape orientation. Perhaps it’s not a good idea to read with scrolling, while leaving much blank space around. A tiling overview of paper with pagebreaks takes full use of the screen.<br>\nThanks anyway!</p>",
      "raw": "I reconsider the need for writing and reading my own note. Since it won't be published or printed into journal, there's no need for keeping the pagebreak. That's why I want creat a custom html for note.\nBarely cares the output format. But thank you for reminding me the html exporting. Now I have more options to restore and read my notes.\nNow I have a new idea. Thinking of a wide display in landscape orientation. Perhaps it's not a good idea to read with scrolling, while leaving much blank space around. A tiling overview of paper with pagebreaks takes full use of the screen.\nThanks anyway!",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 6.0,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1644
    }
  ],
  "scraped_at": "2025-06-10T09:47:23.777026"
}
{
  "topic_metadata": {
    "id": 4245,
    "title": "How to provide assets (image files) with a template so that they could eventually be overwritten?",
    "slug": "how-to-provide-assets-image-files-with-a-template-so-that-they-could-eventually-be-overwritten",
    "posts_count": 5,
    "created_at": "2025-05-23T10:13:20.432Z",
    "last_posted_at": "2025-05-23T20:41:44.459Z",
    "views": 51,
    "like_count": 4,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "vmartel08",
    "tags": [
      "templates",
      "images"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 592
  },
  "posts": [
    {
      "id": 13006,
      "post_number": 1,
      "username": "mononym",
      "name": "",
      "created_at": "2025-05-23T10:13:20.545Z",
      "updated_at": "2025-05-23T10:16:02.876Z",
      "cooked": "<p>Hello. I have question regarding templates and images.</p>\n<p>I made <a href=\"https://typst.app/universe/package/lumen/\">this template</a>. The code sits in <a href=\"https://codeberg.org/mononym/typst-ulb-phd-cover\" rel=\"noopener nofollow ugc\">this repo</a>.</p>\n<p>The template is a cover page and some parts of it are made up of images. A set of images is provided with the template (located in <code>./template/logos</code>).</p>\n<p>The package structure is:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">.\n├── lib.typ\n├── template\n│   ├── logos\n│   │   ├── archi.png\n│   │   ├── FNR.png\n│   │   ├── FNRS-en.png\n│   │   └── FNRS-fr.png\n│   └── main.typ\n└── typst.toml\n</code></pre>\n<p>When creating a new project from the template in the Typst app, the <code>#show</code> function in <code>main.typ</code> does not allow making use of images outside the <code>template</code> folder.</p>\n<p>This is the working default:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#import \"@preview/lumen:0.1.0\": cover\n#show: cover(\n  logo: \"template/logos/archi.png\",\n  [...]\n  fund-logo: \"template/logos/FNRS-fr.png\",\n)\n</code></pre>\n<p>But what I try to make possible is that the user can upload own images and use them in the <code>#show</code> function:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#import \"@preview/lumen:0.1.0\": cover\n#show: cover(\n  logo: \"science.png\",\n  [...]\n  fund-logo: \"new-fund.png\",\n)\n</code></pre>\n<p>Basically I need some help to understand how assets and link to images work for templates.<br>\nThanks !</p>",
      "raw": "Hello. I have question regarding templates and images.\n\nI made [this template](https://typst.app/universe/package/lumen/). The code sits in [this repo](https://codeberg.org/mononym/typst-ulb-phd-cover). \n\nThe template is a cover page and some parts of it are made up of images. A set of images is provided with the template (located in `./template/logos`).\n\nThe package structure is:\n```\n.\n├── lib.typ\n├── template\n│   ├── logos\n│   │   ├── archi.png\n│   │   ├── FNR.png\n│   │   ├── FNRS-en.png\n│   │   └── FNRS-fr.png\n│   └── main.typ\n└── typst.toml\n```\n\nWhen creating a new project from the template in the Typst app, the `#show` function in `main.typ` does not allow making use of images outside the `template` folder. \n\nThis is the working default:\n```typst\n#import \"@preview/lumen:0.1.0\": cover\n#show: cover(\n  logo: \"template/logos/archi.png\",\n  [...]\n  fund-logo: \"template/logos/FNRS-fr.png\",\n)\n```\n\nBut what I try to make possible is that the user can upload own images and use them in the `#show` function:\n```typst\n#import \"@preview/lumen:0.1.0\": cover\n#show: cover(\n  logo: \"science.png\",\n  [...]\n  fund-logo: \"new-fund.png\",\n)\n```\nBasically I need some help to understand how assets and link to images work for templates. \nThanks !",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 44.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1419
    },
    {
      "id": 13011,
      "post_number": 2,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-05-23T10:49:47.607Z",
      "updated_at": "2025-05-23T10:55:00.713Z",
      "cooked": "<p>Hi there,</p>\n<p>I believe this PR contains the answer to your question. It’s not released yet but you can access it: <a href=\"https://github.com/typst/packages/blob/07b827f8915838224b2ff9aee162cf0e0c86d092/docs/resources.md\" class=\"inline-onebox\">packages/docs/resources.md at 07b827f8915838224b2ff9aee162cf0e0c86d092 · typst/packages · GitHub</a></p>\n<p>The proper way to let the people using your template overwrite the file to use is to take content as an argument directly, not a string. For example, you should replace this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let cover-page(logo-path: \"logo.png\", title) = {\n  image(logo-path)\n  heading(title)\n}\n</code></pre>\n<p>With something like:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let cover-page(logo: image(\"logo.png\"), title) = {\n  logo\n  heading(title)\n}\n</code></pre>\n<p>EDIT: Also this:</p>\n<aside class=\"quote\" data-post=\"2\" data-topic=\"3063\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/lordbaryhobal/48/855_2.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/how-to-receive-a-user-supplied-path-in-a-package-function/3063/2\">How to receive a user supplied path in a package function?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    Packages cannot access project files, unless the package is installed inside of the project \nIf you want to pass an image to your template, you will have to read it in your project and pass the image object to the template \n#let img = image(\"my_nice_image.png\")\n#show: my-template.with(img)\n  </blockquote>\n</aside>\n",
      "raw": "Hi there, \n\nI believe this PR contains the answer to your question. It's not released yet but you can access it: https://github.com/typst/packages/blob/07b827f8915838224b2ff9aee162cf0e0c86d092/docs/resources.md\n\nThe proper way to let the people using your template overwrite the file to use is to take content as an argument directly, not a string. For example, you should replace this:\n\n```typ\n#let cover-page(logo-path: \"logo.png\", title) = {\n  image(logo-path)\n  heading(title)\n}\n```\nWith something like:\n\n```typ \n#let cover-page(logo: image(\"logo.png\"), title) = {\n  logo\n  heading(title)\n}\n```\n\n\nEDIT: Also this: \n\nhttps://forum.typst.app/t/how-to-receive-a-user-supplied-path-in-a-package-function/3063/2?u=vmartel08",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 3,
      "reads": 18,
      "score": 58.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 13025,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-23T14:33:42.152Z",
      "updated_at": "2025-05-23T14:47:44.284Z",
      "cooked": "<p>This is true for basic usage, but for something more complex a closure hack by <a class=\"mention\" href=\"/u/sillyfreak\">@SillyFreak</a> can be used:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let cover(logo: none, doc) = {\n  [Logo: #image(logo(), width: 69%)]\n  doc\n}\n</code></pre>\n<br>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@local/name:0.0.0\": cover\n#show: cover.with(logo: () =&gt; read(\"tiger.jpg\", encoding: none))\n</code></pre>\n<p>You either have to mandate that users provide the closure or check the type and do stuff accordingly to it.</p>\n<p>To make it slightly better, define an additional read function:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let read-image = read.with(encoding: none)\n\n#let cover(logo: none, doc) = {\n  [Logo: #image(logo(), width: 69%)]\n  doc\n}\n</code></pre>\n<br>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@local/name:0.0.0\": cover, read-image\n#show: cover.with(logo: () =&gt; read-image(\"tiger.jpg\"))\n</code></pre>\n<p>This is still not very complex, so here, if you just need to edit <code>image</code> settings, you can pass <code>image.with(\"file\")</code>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show: cover.with(logo: image.with(\"tiger.jpg\"))\n</code></pre>\n<br>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let cover(logo: none, doc) = {\n  [Logo: #logo(width: 69%)]\n  doc\n}\n</code></pre>\n<p>If you want, for example (package structure does have 4 predefined logo file names), to override a directory full of assets, then I’m pretty sure <code>logo: image =&gt; read(\"localdir/\" + image)</code> should work and is complex enough for the hack to be actually useful.</p>",
      "raw": "This is true for basic usage, but for something more complex a closure hack by @SillyFreak can be used:\n\n\n```typ\n#let cover(logo: none, doc) = {\n  [Logo: #image(logo(), width: 69%)]\n  doc\n}\n```\n\n<br>\n\n```typ\n#import \"@local/name:0.0.0\": cover\n#show: cover.with(logo: () => read(\"tiger.jpg\", encoding: none))\n```\n\nYou either have to mandate that users provide the closure or check the type and do stuff accordingly to it.\n\nTo make it slightly better, define an additional read function:\n\n```typ\n#let read-image = read.with(encoding: none)\n\n#let cover(logo: none, doc) = {\n  [Logo: #image(logo(), width: 69%)]\n  doc\n}\n```\n\n<br>\n\n```typ\n#import \"@local/name:0.0.0\": cover, read-image\n#show: cover.with(logo: () => read-image(\"tiger.jpg\"))\n```\n\nThis is still not very complex, so here, if you just need to edit `image` settings, you can pass `image.with(\"file\")`:\n\n```typ\n#show: cover.with(logo: image.with(\"tiger.jpg\"))\n```\n\n<br>\n\n```typ\n#let cover(logo: none, doc) = {\n  [Logo: #logo(width: 69%)]\n  doc\n}\n```\n\nIf you want, for example (package structure does have 4 predefined logo file names), to override a directory full of assets, then I'm pretty sure `logo: image => read(\"localdir/\" + image)` should work and is complex enough for the hack to be actually useful.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 13.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13046,
      "post_number": 4,
      "username": "mononym",
      "name": "",
      "created_at": "2025-05-23T20:19:59.731Z",
      "updated_at": "2025-05-23T20:19:59.731Z",
      "cooked": "<p>Thanks, that is exactly the explanation I was looking for !</p>\n<p>I changed the image path strings with an image object each in <a href=\"https://codeberg.org/mononym/typst-ulb-phd-cover/commit/6ad186ec52f4927307929eb4cdb6c3f293830252\" rel=\"noopener nofollow ugc\">this commit</a>. I’ll stil have to make tests to see if it works as expected.</p>",
      "raw": "Thanks, that is exactly the explanation I was looking for !\n\nI changed the image path strings with an image object each in [this commit](https://codeberg.org/mononym/typst-ulb-phd-cover/commit/6ad186ec52f4927307929eb4cdb6c3f293830252). I'll stil have to make tests to see if it works as expected.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 23.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1419
    },
    {
      "id": 13048,
      "post_number": 5,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-05-23T20:41:44.459Z",
      "updated_at": "2025-05-23T20:41:44.459Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/mononym\">@mononym</a>, glad you got a satisfying answer! Please don’t forget to mark it as the solution, so that others can more easily find it later. Thanks!</p>",
      "raw": "Hi @mononym, glad you got a satisfying answer! Please don’t forget to mark it as the solution, so that others can more easily find it later. Thanks!",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 3.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:47:23.045111"
}
{
  "topic_metadata": {
    "id": 4246,
    "title": "How to display short figure caption in bold and long in italic?",
    "slug": "how-to-display-short-figure-caption-in-bold-and-long-in-italic",
    "posts_count": 4,
    "created_at": "2025-05-23T11:16:42.455Z",
    "last_posted_at": "2025-06-02T06:15:32.437Z",
    "views": 57,
    "like_count": 2,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 358
  },
  "posts": [
    {
      "id": 13014,
      "post_number": 1,
      "username": "typst_user",
      "name": "",
      "created_at": "2025-05-23T11:16:42.605Z",
      "updated_at": "2025-05-23T16:09:33.286Z",
      "cooked": "<p>Hi all, I’m currently learning Typst and plan to use it for my thesis.</p>\n<p>I have the following issue: I would like to give each figure and short and long caption. In the table of content, only the short caption should be displayed. In the figure itself, I would like to have all text in <em>italic</em>, an additionally, the Figure word, the figure number and the short caption in <strong>bold</strong>. Thanks to this forum, I’ve already managed to give each figure a long and short caption with the following snippet:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let in-outline = state(\"in-outline\", false)\n\n#show outline: it =&gt; {\n  in-outline.update(true)\n  it\n  in-outline.update(false)\n}\n#let flex-caption(long, short) = context if in-outline.get() { short } else { long }\n</code></pre>\n<p>I would like to modify this function like this (concat the short and long string):</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let flex-caption(long, short) = context if in-outline.get() { short } else { short + long }\n</code></pre>\n<p>To make the figure word and figure number in bold and italic, and the rest only in italic, I’ve found this snippet:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show figure.caption: it =&gt; [\n  #emph[*#it.supplement #context it.counter.display(it.numbering):*~#it.body]\n]\n</code></pre>\n<p>How can I now modify this code that I get the following:<br>\n<em><strong>Figure 1: This is the short caption.</strong> This is the long caption.</em></p>",
      "raw": "Hi all, I'm currently learning Typst and plan to use it for my thesis.\n\nI have the following issue: I would like to give each figure and short and long caption. In the table of content, only the short caption should be displayed. In the figure itself, I would like to have all text in *italic*, an additionally, the Figure word, the figure number and the short caption in **bold**. Thanks to this forum, I've already managed to give each figure a long and short caption with the following snippet:\n```\n#let in-outline = state(\"in-outline\", false)\n\n#show outline: it => {\n  in-outline.update(true)\n  it\n  in-outline.update(false)\n}\n#let flex-caption(long, short) = context if in-outline.get() { short } else { long }\n```\nI would like to modify this function like this (concat the short and long string):\n```\n#let flex-caption(long, short) = context if in-outline.get() { short } else { short + long }\n```\nTo make the figure word and figure number in bold and italic, and the rest only in italic, I've found this snippet:\n```\n#show figure.caption: it => [\n  #emph[*#it.supplement #context it.counter.display(it.numbering):*~#it.body]\n]\n```\nHow can I now modify this code that I get the following:\n***Figure 1: This is the short caption.** This is the long caption.*",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 74.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1643
    },
    {
      "id": 13026,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-23T15:04:20.357Z",
      "updated_at": "2025-05-23T15:05:15.541Z",
      "cooked": "<p>Hi. Here you go:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let in-outline = state(\"in-outline\", false)\n\n#let flex-caption(short, long) = context {\n  if in-outline.get() [#short] else [#strong(short). #long]\n}\n\n#show outline: it =&gt; in-outline.update(true) + it + in-outline.update(false)\n\n#show figure.caption.where(kind: image): it =&gt; {\n  let numbering = if it.numbering != none {\n    [~] + context it.counter.display(it.numbering)\n  }\n  emph[*#it.supplement#numbering#it.separator*#it.body]\n}\n\n#outline(target: figure.where(kind: image))\n\n#figure(rect(), caption: flex-caption[Short][Long #lorem(9)])\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/6/61407da659496cd8263f70af43d1d4d129dcdbd8.png\" data-download-href=\"https://forum.typst.app/uploads/default/61407da659496cd8263f70af43d1d4d129dcdbd8\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/6/61407da659496cd8263f70af43d1d4d129dcdbd8_2_690x145.png\" alt=\"image\" data-base62-sha1=\"dSku6yDlNmFTObrUCE2PIk8mbMY\" width=\"690\" height=\"145\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/6/61407da659496cd8263f70af43d1d4d129dcdbd8_2_690x145.png, https://forum.typst.app/uploads/default/original/2X/6/61407da659496cd8263f70af43d1d4d129dcdbd8.png 1.5x, https://forum.typst.app/uploads/default/original/2X/6/61407da659496cd8263f70af43d1d4d129dcdbd8.png 2x\" data-dominant-color=\"131313\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">712×150 12.9 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "Hi. Here you go:\n\n\n```typ\n#let in-outline = state(\"in-outline\", false)\n\n#let flex-caption(short, long) = context {\n  if in-outline.get() [#short] else [#strong(short). #long]\n}\n\n#show outline: it => in-outline.update(true) + it + in-outline.update(false)\n\n#show figure.caption.where(kind: image): it => {\n  let numbering = if it.numbering != none {\n    [~] + context it.counter.display(it.numbering)\n  }\n  emph[*#it.supplement#numbering#it.separator*#it.body]\n}\n\n#outline(target: figure.where(kind: image))\n\n#figure(rect(), caption: flex-caption[Short][Long #lorem(9)])\n```\n\n![image|690x145](upload://dSku6yDlNmFTObrUCE2PIk8mbMY.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 38.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13034,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-05-23T16:10:40.429Z",
      "updated_at": "2025-05-23T16:10:40.429Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/typst_user\">@typst_user</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @typst_user, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 23.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 13559,
      "post_number": 4,
      "username": "typst_user",
      "name": "",
      "created_at": "2025-06-02T06:15:32.437Z",
      "updated_at": "2025-06-02T06:15:32.437Z",
      "cooked": "<p>Many thanks, works like a charm!</p>",
      "raw": "Many thanks, works like a charm!",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 11,
      "score": 17.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1643
    }
  ],
  "scraped_at": "2025-06-10T09:47:22.289459"
}
{
  "topic_metadata": {
    "id": 4259,
    "title": "Is there a cleaner way to draw a heatmap using Lilaq?",
    "slug": "is-there-a-cleaner-way-to-draw-a-heatmap-using-lilaq",
    "posts_count": 4,
    "created_at": "2025-05-24T04:47:47.101Z",
    "last_posted_at": "2025-05-24T21:24:11.109Z",
    "views": 128,
    "like_count": 7,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "lilaq"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 621
  },
  "posts": [
    {
      "id": 13060,
      "post_number": 1,
      "username": "Dmitriy",
      "name": "Dmitriy",
      "created_at": "2025-05-24T04:47:47.205Z",
      "updated_at": "2025-05-24T16:00:12.926Z",
      "cooked": "<p>Hello,</p>\n<p>my current solution is this:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let words = (\n  \"first\",\n  \"second\",\n  \"third\",\n  \"fourth\",\n  \"fifth\",\n  \"sixth\",\n  \"seventh\",\n  \"eighth\",\n  \"ninth\",\n  \"tenth\",\n  \"eleventh\",\n  \"tvelveth\"\n);\n#let len = words.len()\n\n#let dia = lq.diagram(\n  width: 10cm, height: 10cm,\n  lq.colormesh(\n    lq.linspace(0, len - 1, num: len),\n    lq.linspace(0, len - 1, num: len),\n    (x, y) =&gt; x * y, // for illustration purposes, for real data use the array\n        // data\n        //  .at(calc.floor(y))\n        //  .at(calc.floor(x)),\n    map: color.map.viridis\n  ),\n\n  xaxis: (\n    ticks: words.map(rotate.with(-90deg, reflow: true)).enumerate(),\n    subticks: none,\n    position: top,\n  ),\n\n  yaxis: (\n    ticks: words.enumerate(),\n    subticks: none,\n    inverted: true,\n  ),\n)\n\n#let legend = lq.diagram(\n  width: 0.25cm,\n  height: 10cm,\n  lq.colormesh(\n    interpolation: \"smooth\",\n    lq.linspace(0, 1),\n    lq.linspace(0, 1),\n    (x, y) =&gt; y\n  ),\n  xaxis: none,\n  yaxis: (\n    position: right,\n    subticks: none,\n    tick-distance: 0.2,\n  )\n)\n\n#figure(\n  grid(\n    align: bottom,\n    gutter: 0.5cm,\n    columns: 2,\n    dia,\n    legend,\n  ),\n  scope: \"parent\",\n  placement: auto,\n  caption: [My heatmap]\n) &lt;heat-map&gt;\n</code></pre>\n<p>And the result looks something like this:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/5/5ceccba2e98998d55d277ff19f6b7cd10a25f640.png\" data-download-href=\"https://forum.typst.app/uploads/default/5ceccba2e98998d55d277ff19f6b7cd10a25f640\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/5/5ceccba2e98998d55d277ff19f6b7cd10a25f640_2_277x250.png\" alt=\"image\" data-base62-sha1=\"dg3g4nktwukklYHTSYC7g7EFlkY\" width=\"277\" height=\"250\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/5/5ceccba2e98998d55d277ff19f6b7cd10a25f640_2_277x250.png, https://forum.typst.app/uploads/default/optimized/2X/5/5ceccba2e98998d55d277ff19f6b7cd10a25f640_2_415x375.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/5/5ceccba2e98998d55d277ff19f6b7cd10a25f640_2_554x500.png 2x\" data-dominant-color=\"7B7B9C\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1153×1038 64.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Still, something tells me this can be implemented easier and cleaner. Any suggestions?</p>",
      "raw": "Hello,\n\nmy current solution is this:\n\n```typst\n#let words = (\n  \"first\",\n  \"second\",\n  \"third\",\n  \"fourth\",\n  \"fifth\",\n  \"sixth\",\n  \"seventh\",\n  \"eighth\",\n  \"ninth\",\n  \"tenth\",\n  \"eleventh\",\n  \"tvelveth\"\n);\n#let len = words.len()\n\n#let dia = lq.diagram(\n  width: 10cm, height: 10cm,\n  lq.colormesh(\n    lq.linspace(0, len - 1, num: len),\n    lq.linspace(0, len - 1, num: len),\n    (x, y) => x * y, // for illustration purposes, for real data use the array\n        // data\n        //  .at(calc.floor(y))\n        //  .at(calc.floor(x)),\n    map: color.map.viridis\n  ),\n\n  xaxis: (\n    ticks: words.map(rotate.with(-90deg, reflow: true)).enumerate(),\n    subticks: none,\n    position: top,\n  ),\n\n  yaxis: (\n    ticks: words.enumerate(),\n    subticks: none,\n    inverted: true,\n  ),\n)\n\n#let legend = lq.diagram(\n  width: 0.25cm,\n  height: 10cm,\n  lq.colormesh(\n    interpolation: \"smooth\",\n    lq.linspace(0, 1),\n    lq.linspace(0, 1),\n    (x, y) => y\n  ),\n  xaxis: none,\n  yaxis: (\n    position: right,\n    subticks: none,\n    tick-distance: 0.2,\n  )\n)\n\n#figure(\n  grid(\n    align: bottom,\n    gutter: 0.5cm,\n    columns: 2,\n    dia,\n    legend,\n  ),\n  scope: \"parent\",\n  placement: auto,\n  caption: [My heatmap]\n) <heat-map>\n```\n\nAnd the result looks something like this:\n![image|555x500, 50%](upload://dg3g4nktwukklYHTSYC7g7EFlkY.png)\n\n\nStill, something tells me this can be implemented easier and cleaner. Any suggestions?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 43,
      "score": 93.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1628
    },
    {
      "id": 13082,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-24T15:16:15.721Z",
      "updated_at": "2025-05-24T15:17:03.578Z",
      "cooked": "<p>My suggestion is to request the addition of a continuous legend for the heatmap diagram.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/lilaq:0.3.0\" as lq\n\n/// Style for heatmap diagram.\n#let heatmap-style(doc) = {\n  set rotate(reflow: true)\n  show: lq.set-diagram(\n    xaxis: (subticks: none, position: top),\n    yaxis: (subticks: none, inverted: true),\n    width: 10cm,\n    height: 10cm,\n  )\n  doc\n}\n\n/// Continuous legend style for heatmap diagram.\n#let heatmap-legend-style(doc) = {\n  show: lq.set-diagram(\n    yaxis: (position: right, subticks: none, tick-distance: 0.2),\n    xaxis: none,\n    width: 0.25cm,\n    height: 10cm,\n  )\n  doc\n}\n\n#let heatmap-with-legend(diagram, range) = grid(\n  columns: 2,\n  align: bottom,\n  gutter: 0.5cm,\n  heatmap-style(diagram),\n  heatmap-legend-style(lq.diagram(lq.colormesh(\n    interpolation: \"smooth\",\n    range,\n    range,\n    (_, y) =&gt; y,\n  ))),\n)\n\n#let words = (\n  \"first\",\n  \"second\",\n  \"third\",\n  \"fourth\",\n  \"fifth\",\n  \"sixth\",\n  \"seventh\",\n  \"eighth\",\n  \"ninth\",\n  \"tenth\",\n  \"eleventh\",\n  \"twelveth\",\n)\n\n#let length = words.len()\n#let x = lq.linspace(2, 20, num: length)\n#let y = lq.linspace(-4, 15, num: length)\n\n#figure(\n  heatmap-with-legend(\n    lq.diagram(\n      xaxis: (ticks: x.zip(words.map(rotate.with(-90deg)))),\n      yaxis: (ticks: y.zip(words)),\n      lq.colormesh(x, y, (x, y) =&gt; x * y, map: color.map.viridis),\n    ),\n    lq.linspace(0, 1),\n  ),\n  caption: [My heatmap],\n) &lt;heat-map&gt;\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/7/7643a121214ab3c5bb7e9a59934d25ec4c910522.png\" alt=\"image\" data-base62-sha1=\"gSdeGuf2aMswDkEfGYxGMYgS9hg\" width=\"236\" height=\"224\"></p>",
      "raw": "My suggestion is to request the addition of a continuous legend for the heatmap diagram.\n\n```typ\n#import \"@preview/lilaq:0.3.0\" as lq\n\n/// Style for heatmap diagram.\n#let heatmap-style(doc) = {\n  set rotate(reflow: true)\n  show: lq.set-diagram(\n    xaxis: (subticks: none, position: top),\n    yaxis: (subticks: none, inverted: true),\n    width: 10cm,\n    height: 10cm,\n  )\n  doc\n}\n\n/// Continuous legend style for heatmap diagram.\n#let heatmap-legend-style(doc) = {\n  show: lq.set-diagram(\n    yaxis: (position: right, subticks: none, tick-distance: 0.2),\n    xaxis: none,\n    width: 0.25cm,\n    height: 10cm,\n  )\n  doc\n}\n\n#let heatmap-with-legend(diagram, range) = grid(\n  columns: 2,\n  align: bottom,\n  gutter: 0.5cm,\n  heatmap-style(diagram),\n  heatmap-legend-style(lq.diagram(lq.colormesh(\n    interpolation: \"smooth\",\n    range,\n    range,\n    (_, y) => y,\n  ))),\n)\n\n#let words = (\n  \"first\",\n  \"second\",\n  \"third\",\n  \"fourth\",\n  \"fifth\",\n  \"sixth\",\n  \"seventh\",\n  \"eighth\",\n  \"ninth\",\n  \"tenth\",\n  \"eleventh\",\n  \"twelveth\",\n)\n\n#let length = words.len()\n#let x = lq.linspace(2, 20, num: length)\n#let y = lq.linspace(-4, 15, num: length)\n\n#figure(\n  heatmap-with-legend(\n    lq.diagram(\n      xaxis: (ticks: x.zip(words.map(rotate.with(-90deg)))),\n      yaxis: (ticks: y.zip(words)),\n      lq.colormesh(x, y, (x, y) => x * y, map: color.map.viridis),\n    ),\n    lq.linspace(0, 1),\n  ),\n  caption: [My heatmap],\n) <heat-map>\n```\n\n![image|473x448, 50%](upload://gSdeGuf2aMswDkEfGYxGMYgS9hg.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 37,
      "score": 32.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13101,
      "post_number": 3,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2025-05-24T21:21:30.262Z",
      "updated_at": "2025-05-24T21:22:52.063Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/dmitriy\">@Dmitriy</a>, let me tell you a secret but you gotta keep it ;)</p>\n<p>There exists <code>lq.colorbar</code> and you can use it like this</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">\n#show: lq.set-diagram(\n  height: 10cm,\n)\n\n#let heatmap = lq.colormesh(\n  lq.linspace(0, len - 1, num: len),\n  lq.linspace(0, len - 1, num: len),\n  (x, y) =&gt; x * y, \n)\n\n#lq.diagram(\n  width: 10cm, \n\n  heatmap,\n\n  xaxis: (\n    ticks: words.map(rotate.with(-90deg, reflow: true)).enumerate(),\n    subticks: none,\n    position: top,\n  ),\n\n  yaxis: (\n    ticks: words.enumerate(),\n    subticks: none,\n    inverted: true,\n  ),\n)\n#lq.colorbar(heatmap)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/1/1d8f46ed6691a86f4fa978ed349ff206100c0e39.png\" data-download-href=\"https://forum.typst.app/uploads/default/1d8f46ed6691a86f4fa978ed349ff206100c0e39\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/1/1d8f46ed6691a86f4fa978ed349ff206100c0e39_2_416x375.png\" alt=\"image\" data-base62-sha1=\"4duOBXScnMUyRcadZ4i8vfmvk2B\" width=\"416\" height=\"375\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/1/1d8f46ed6691a86f4fa978ed349ff206100c0e39_2_416x375.png, https://forum.typst.app/uploads/default/original/2X/1/1d8f46ed6691a86f4fa978ed349ff206100c0e39.png 1.5x, https://forum.typst.app/uploads/default/original/2X/1/1d8f46ed6691a86f4fa978ed349ff206100c0e39.png 2x\" data-dominant-color=\"767899\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">611×550 50.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>It takes the numeric data and automatically scales everything as it should be.</p>\n<p>This feature is (almost) entirely undocumented and for a reason: I’m not yet decided on the usage design − should it be something extra that the user needs to place on their own (like it is currently  − more powerful but also more manual) or should it be just something you call within <code>lq.diagram</code> and it’s automatically placed somewhere? And there are many more questions concerning the API.</p>\n<p>But you can try it out and give feedback on the rough idea of it (I know that there are still severe limitations, for example the height of the color bar can only be set through a set rule and the width not at all).</p>",
      "raw": "Hi @Dmitriy, let me tell you a secret but you gotta keep it ;)\n\nThere exists `lq.colorbar` and you can use it like this\n```typ\n\n#show: lq.set-diagram(\n  height: 10cm,\n)\n\n#let heatmap = lq.colormesh(\n  lq.linspace(0, len - 1, num: len),\n  lq.linspace(0, len - 1, num: len),\n  (x, y) => x * y, \n)\n\n#lq.diagram(\n  width: 10cm, \n\n  heatmap,\n\n  xaxis: (\n    ticks: words.map(rotate.with(-90deg, reflow: true)).enumerate(),\n    subticks: none,\n    position: top,\n  ),\n\n  yaxis: (\n    ticks: words.enumerate(),\n    subticks: none,\n    inverted: true,\n  ),\n)\n#lq.colorbar(heatmap)\n```\n![image|555x500, 75%](upload://4duOBXScnMUyRcadZ4i8vfmvk2B.png)\n\nIt takes the numeric data and automatically scales everything as it should be. \n\nThis feature is (almost) entirely undocumented and for a reason: I'm not yet decided on the usage design − should it be something extra that the user needs to place on their own (like it is currently  − more powerful but also more manual) or should it be just something you call within `lq.diagram` and it's automatically placed somewhere? And there are many more questions concerning the API.\n\nBut you can try it out and give feedback on the rough idea of it (I know that there are still severe limitations, for example the height of the color bar can only be set through a set rule and the width not at all).",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 37,
      "score": 47.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    },
    {
      "id": 13102,
      "post_number": 4,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2025-05-24T21:24:11.109Z",
      "updated_at": "2025-05-24T21:24:11.109Z",
      "cooked": "<p>Oh and for some wicked reason, the tick labels sometimes don’t line up with the ticks on the color bar. I haven’t yet figured out why :/</p>",
      "raw": "Oh and for some wicked reason, the tick labels sometimes don't line up with the ticks on the color bar. I haven't yet figured out why :/",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 34,
      "score": 41.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    }
  ],
  "scraped_at": "2025-06-10T09:47:21.590365"
}
{
  "topic_metadata": {
    "id": 4260,
    "title": "How to prevent footnotes in headings from expanding to PDF TOC/Contents",
    "slug": "how-to-prevent-footnotes-in-headings-from-expanding-to-pdf-toc-contents",
    "posts_count": 3,
    "created_at": "2025-05-24T05:28:20.831Z",
    "last_posted_at": "2025-05-24T15:22:12.307Z",
    "views": 53,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "outline",
      "footnotes"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 250
  },
  "posts": [
    {
      "id": 13061,
      "post_number": 1,
      "username": "Jarko",
      "name": "Jarko",
      "created_at": "2025-05-24T05:28:21.004Z",
      "updated_at": "2025-05-24T15:23:19.626Z",
      "cooked": "<details><summary>I have noticed a peculiar thing about footnotes in headings. They show up nicely in the main document, but add visual clutter to the table of contents, as shown on my example below (click here to open).</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(paper: \"a7\")\n\n== My Heading #footnote[#link(\"https://typst.app/\")[Link to typst];]\n\n#lorem(50)\n\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/9cd44afa9df0c8ddeb25251b269ac64e428aef23.png\" data-download-href=\"https://forum.typst.app/uploads/default/9cd44afa9df0c8ddeb25251b269ac64e428aef23\" title=\"Screenshot\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/9cd44afa9df0c8ddeb25251b269ac64e428aef23_2_556x500.png\" alt=\"Screenshot\" data-base62-sha1=\"mnnjTa5eo7qdIzRRQ7Mivq5QwXF\" width=\"556\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/9cd44afa9df0c8ddeb25251b269ac64e428aef23_2_556x500.png, https://forum.typst.app/uploads/default/optimized/2X/9/9cd44afa9df0c8ddeb25251b269ac64e428aef23_2_834x750.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/9/9cd44afa9df0c8ddeb25251b269ac64e428aef23_2_1112x1000.png 2x\" data-dominant-color=\"D7D6DB\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot</span><span class=\"informations\">1170×1052 124 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>\n<p><strong>How can I keep using footnotes in headers, but keep the TOC clean?</strong></p>",
      "raw": "<details><summary>I have noticed a peculiar thing about footnotes in headings. They show up nicely in the main document, but add visual clutter to the table of contents, as shown on my example below (click here to open).</summary>\n\n```typ\n#set page(paper: \"a7\")\n\n== My Heading #footnote[#link(\"https://typst.app/\")[Link to typst];]\n\n#lorem(50)\n\n```\n\n![Screenshot|556x500](upload://mnnjTa5eo7qdIzRRQ7Mivq5QwXF.png)\n\n</details>\n\n**How can I keep using footnotes in headers, but keep the TOC clean?**",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 25.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1287
    },
    {
      "id": 13073,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-05-24T12:43:06.895Z",
      "updated_at": "2025-05-24T12:45:29.717Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/jarko\">@Jarko</a>,</p>\n<p>this is a known issue tracked in <a href=\"https://github.com/typst/typst/issues/2415\">#2415</a>. There are some solutions in a related thread (<a href=\"https://github.com/typst/typst/issues/1889\">1889</a>).</p>\n<p>There are different ways to do this, but the simplest one I recommend is to split the bookmark and the actual heading. Then, it’s just a matter of convenience. You can wrap it all in a custom function.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(paper: \"a7\")\n#{\n  show heading: none\n  heading(\"Heading\")\n}\n#heading(bookmarked: false)[Heading#footnote[Footnote]]\n#lorem(50)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/d/db3c4f48256c3478f5d1077e36993dc37bca9ed9.png\" data-download-href=\"https://forum.typst.app/uploads/default/db3c4f48256c3478f5d1077e36993dc37bca9ed9\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/d/db3c4f48256c3478f5d1077e36993dc37bca9ed9_2_351x500.png\" alt=\"image\" data-base62-sha1=\"vhrMiil9gmzky7n97OGVli8BMtX\" width=\"351\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/d/db3c4f48256c3478f5d1077e36993dc37bca9ed9_2_351x500.png, https://forum.typst.app/uploads/default/optimized/2X/d/db3c4f48256c3478f5d1077e36993dc37bca9ed9_2_526x750.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/d/db3c4f48256c3478f5d1077e36993dc37bca9ed9_2_702x1000.png 2x\" data-dominant-color=\"F1F1F1\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">950×1350 131 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>For completeness, see:</p>\n<ul>\n<li><a href=\"https://forum.typst.app/t/how-can-i-exclude-part-of-a-heading-from-the-outline/1299/2\" class=\"inline-onebox\">How can I exclude part of a heading from the outline? - #2 by TheJanzap</a></li>\n<li><a href=\"https://forum.typst.app/t/how-to-add-an-invisible-heading-to-an-outline/685\" class=\"inline-onebox\">How to add an invisible Heading to an outline?</a></li>\n<li><a href=\"https://forum.typst.app/t/how-to-add-an-empty-heading-to-the-pdf-outline/1172\" class=\"inline-onebox\">How to add an empty heading to the PDF outline?</a></li>\n</ul>",
      "raw": "Hello @Jarko,\n\nthis is a known issue tracked in [#2415](https://github.com/typst/typst/issues/2415). There are some solutions in a related thread ([1889](https://github.com/typst/typst/issues/1889)).\n\nThere are different ways to do this, but the simplest one I recommend is to split the bookmark and the actual heading. Then, it's just a matter of convenience. You can wrap it all in a custom function.\n\n```typ\n#set page(paper: \"a7\")\n#{\n  show heading: none\n  heading(\"Heading\")\n}\n#heading(bookmarked: false)[Heading#footnote[Footnote]]\n#lorem(50)\n```\n![image|351x500](upload://vhrMiil9gmzky7n97OGVli8BMtX.png)\n\nFor completeness, see:\n- https://forum.typst.app/t/how-can-i-exclude-part-of-a-heading-from-the-outline/1299/2\n- https://forum.typst.app/t/how-to-add-an-invisible-heading-to-an-outline/685\n- https://forum.typst.app/t/how-to-add-an-empty-heading-to-the-pdf-outline/1172",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 26,
      "score": 35.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 13083,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-24T15:22:12.307Z",
      "updated_at": "2025-05-24T15:22:12.307Z",
      "cooked": "<blockquote>\n<p>PDF TOC/Contents</p>\n</blockquote>\n<p>FYI, it is called <a href=\"https://pdfa.org/glossary-of-pdf-terms/#:~:text=in%20any%20way.-,Outline,is%20commonly%20known%20as%20Bookmarks.,-Package\">Document Outline</a>.</p>",
      "raw": "> PDF TOC/Contents\n\nFYI, it is called [Document Outline](https://pdfa.org/glossary-of-pdf-terms/#:~:text=in%20any%20way.-,Outline,is%20commonly%20known%20as%20Bookmarks.,-Package).",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 4.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:47:20.886286"
}
{
  "topic_metadata": {
    "id": 4262,
    "title": "How can I \"set\" a default value for an exist custom function parameter?",
    "slug": "how-can-i-set-a-default-value-for-an-exist-custom-function-parameter",
    "posts_count": 2,
    "created_at": "2025-05-24T07:50:26.226Z",
    "last_posted_at": "2025-05-24T08:45:47.471Z",
    "views": 47,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 213
  },
  "posts": [
    {
      "id": 13066,
      "post_number": 1,
      "username": "M4R1S",
      "name": "Maris Baier",
      "created_at": "2025-05-24T07:50:26.341Z",
      "updated_at": "2025-05-24T08:37:27.163Z",
      "cooked": "<p>Hi,<br>\nspecifically I have this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/physica:0.9.5\": *\n$ dd(x,y,p:and) $\n</code></pre>\n<p>I want to “set” (?) the “p:and” as the default so that I can write:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$ dd(x,y) $\n</code></pre>\n<p>Would someone be so kind as to tell me how to do this?</p>",
      "raw": "Hi,\nspecifically I have this:\n\n```\n#import \"@preview/physica:0.9.5\": *\n$ dd(x,y,p:and) $\n```\n\nI want to \"set\" (?) the \"p:and\" as the default so that I can write:\n```\n$ dd(x,y) $\n```\nWould someone be so kind as to tell me how to do this?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 20.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 643
    },
    {
      "id": 13069,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-05-24T08:45:47.471Z",
      "updated_at": "2025-05-24T08:45:47.471Z",
      "cooked": "<p>Hi! I’ve changed your post’s title to hopefully make it more easy to understand from the topic list.</p>\n<hr>\n<p>The tool for doing this would be <a href=\"https://typst.app/docs/reference/foundations/function/#definitions-with\"><code>with</code></a>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/physica:0.9.5\": *\n#let dd = dd.with(p: $and$)\n$ dd(x, y) $\n$ dd(x, y, p: or) $\n</code></pre>\n<p>With built-in function you’d use a <a href=\"https://typst.app/docs/reference/styling/#set-rules\">set rule</a>, but those don’t work for custom ones like the ones from physica.</p>\n<p>Note that if you have multiple files, you have to do this in every file. A way around this could be making your own wrapper module, like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// physica.typ\n#import \"@preview/physica:0.9.5\": *\n#let dd = dd.with(p: $and$)\n\n// main.typ\n#import \"physica.typ\": *\n$ dd(x, y) $\n$ dd(x, y, p: or) $\n</code></pre>\n<p>(this can be useful anyway, because you can’t accidentally import two different versions of physica when you only import it once anyway)</p>",
      "raw": "Hi! I've changed your post's title to hopefully make it more easy to understand from the topic list.\n\n---\n\nThe tool for doing this would be [`with`](https://typst.app/docs/reference/foundations/function/#definitions-with):\n\n```\n#import \"@preview/physica:0.9.5\": *\n#let dd = dd.with(p: $and$)\n$ dd(x, y) $\n$ dd(x, y, p: or) $\n```\n\nWith built-in function you'd use a [set rule](https://typst.app/docs/reference/styling/#set-rules), but those don't work for custom ones like the ones from physica.\n\nNote that if you have multiple files, you have to do this in every file. A way around this could be making your own wrapper module, like this:\n\n```\n// physica.typ\n#import \"@preview/physica:0.9.5\": *\n#let dd = dd.with(p: $and$)\n\n// main.typ\n#import \"physica.typ\": *\n$ dd(x, y) $\n$ dd(x, y, p: or) $\n```\n(this can be useful anyway, because you can't accidentally import two different versions of physica when you only import it once anyway)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 29,
      "score": 40.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:47:20.177900"
}
{
  "topic_metadata": {
    "id": 4273,
    "title": "How do I dynamically add content from a dictionary defined in a template?",
    "slug": "how-do-i-dynamically-add-content-from-a-dictionary-defined-in-a-template",
    "posts_count": 4,
    "created_at": "2025-05-25T12:58:41.248Z",
    "last_posted_at": "2025-05-25T20:22:56.711Z",
    "views": 57,
    "like_count": 1,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "Andrew",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 802
  },
  "posts": [
    {
      "id": 13106,
      "post_number": 1,
      "username": "Niklas",
      "name": "Niklas",
      "created_at": "2025-05-25T12:58:41.351Z",
      "updated_at": "2025-05-25T12:58:41.351Z",
      "cooked": "<p>I am using typst for my homework and notes for university. For this I need to reference theorems, lemmas, etc. from the lectures. I want to add a section to the end of my note where all the lecture references, used in that note, are listed and the parts of my note, that refer to these entries, also link to the respective headings.<br>\nTo avoid always retyping the theorems, I frequently use on different documents, I tried to create a template in which I collected all the lecture references and I dynamically add the parts which I need to the document.</p>\n<p>My file <code>template.typ</code> looks like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let lecture_refs = (\n  def1_1: (\n    lecture: 1,\n    index: 1,\n    type: \"Definition\",\n    content: [This is my first definition.],\n  ),\n  the1_2: (\n    lecture: 1,\n    index: 2,\n    type: \"Theorem\",\n    content: [This is the second entry but its a theorem.],\n  ),\n  the2_1: (\n    lecture: 2,\n    index: 1,\n    type: \"Theorem\",\n    content: [This theorem is relevant but I won't need it for the notes.],\n  ),\n  def2_2: (\n    lecture: 2,\n    index: 2,\n    type: \"Definition\",\n    content: [Let's define some more items.],\n  ),\n  lem3_1: (\n    lecture: 3,\n    index: 1,\n    type: \"Lemma\",\n    content: [Now we add a lemma for a change.],\n  ),\n)\n\n#let lecture_ref(def) = context {\n  let state = state(\"used_literature_refs\")\n  let array = state.get()\n  if array == none {\n    state.update((def,))\n  }\n  else if not array.contains(def) {\n    state.update((..array,def))\n  }\n  ref(label(def))\n}\n\n#let used_lecture_refs() = context {\n  let used = state(\"used_literature_refs\").final()\n  if (used != none and used.len() &gt; 0) {\n    text[= Lecture References]\n    set heading(numbering: \"1.1\")\n    for (key, value) in lecture_refs {\n      if key in used {\n        counter(heading).update((value.lecture, value.index - 1))\n        text[\n          #heading(depth: 2, supplement: value.type)[#value.type]#label(key)\n          #value.content\n        ]\n      }\n    }\n  }\n}\n\n#let template(doc) = {\n  doc\n  used_lecture_refs()\n}\n</code></pre>\n<p>Using this template I am able to render <code>note.typ</code> with the following content:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"template.typ\": template, lecture_ref\n\n#show: template\n\n= Homework\n\nIn my homework I need to reference some content from the lectures like #lecture_ref(\"def1_1\"), #lecture_ref(\"the1_2\"), #lecture_ref(\"def2_2\")\n\nUnused lecture references should not appear in the document\n</code></pre>\n<p>But when I add another reference typst fails to render the document.</p>\n<p>My modified <code>note.typ</code> looks like this</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"template.typ\": template, lecture_ref\n\n#show: template\n\n= Homework\n\nIn my homework I need to reference some content from the lectures like #lecture_ref(\"def1_1\"), #lecture_ref(\"the1_2\"), #lecture_ref(\"def2_2\"), #lecture_ref(\"lem3_1\")\n\nUnused lecture references should not appear in the document\n</code></pre>\n<p>I get the error <code>warning: layout did not converge within 5 attempts</code>. I assume it’s due to the scope I am using to keep track of the used IDs.</p>\n<p>I am not sure how to fix this or what I am doing wrong when modifying the state.</p>",
      "raw": "I am using typst for my homework and notes for university. For this I need to reference theorems, lemmas, etc. from the lectures. I want to add a section to the end of my note where all the lecture references, used in that note, are listed and the parts of my note, that refer to these entries, also link to the respective headings.\nTo avoid always retyping the theorems, I frequently use on different documents, I tried to create a template in which I collected all the lecture references and I dynamically add the parts which I need to the document.\n\nMy file `template.typ` looks like this:\n```typ\n#let lecture_refs = (\n  def1_1: (\n    lecture: 1,\n    index: 1,\n    type: \"Definition\",\n    content: [This is my first definition.],\n  ),\n  the1_2: (\n    lecture: 1,\n    index: 2,\n    type: \"Theorem\",\n    content: [This is the second entry but its a theorem.],\n  ),\n  the2_1: (\n    lecture: 2,\n    index: 1,\n    type: \"Theorem\",\n    content: [This theorem is relevant but I won't need it for the notes.],\n  ),\n  def2_2: (\n    lecture: 2,\n    index: 2,\n    type: \"Definition\",\n    content: [Let's define some more items.],\n  ),\n  lem3_1: (\n    lecture: 3,\n    index: 1,\n    type: \"Lemma\",\n    content: [Now we add a lemma for a change.],\n  ),\n)\n\n#let lecture_ref(def) = context {\n  let state = state(\"used_literature_refs\")\n  let array = state.get()\n  if array == none {\n    state.update((def,))\n  }\n  else if not array.contains(def) {\n    state.update((..array,def))\n  }\n  ref(label(def))\n}\n\n#let used_lecture_refs() = context {\n  let used = state(\"used_literature_refs\").final()\n  if (used != none and used.len() > 0) {\n    text[= Lecture References]\n    set heading(numbering: \"1.1\")\n    for (key, value) in lecture_refs {\n      if key in used {\n        counter(heading).update((value.lecture, value.index - 1))\n        text[\n          #heading(depth: 2, supplement: value.type)[#value.type]#label(key)\n          #value.content\n        ]\n      }\n    }\n  }\n}\n\n#let template(doc) = {\n  doc\n  used_lecture_refs()\n}\n```\n\nUsing this template I am able to render `note.typ` with the following content:\n```typ\n#import \"template.typ\": template, lecture_ref\n\n#show: template\n\n= Homework\n\nIn my homework I need to reference some content from the lectures like #lecture_ref(\"def1_1\"), #lecture_ref(\"the1_2\"), #lecture_ref(\"def2_2\")\n\nUnused lecture references should not appear in the document\n```\n\nBut when I add another reference typst fails to render the document.\n\nMy modified `note.typ` looks like this\n```typ\n#import \"template.typ\": template, lecture_ref\n\n#show: template\n\n= Homework\n\nIn my homework I need to reference some content from the lectures like #lecture_ref(\"def1_1\"), #lecture_ref(\"the1_2\"), #lecture_ref(\"def2_2\"), #lecture_ref(\"lem3_1\")\n\nUnused lecture references should not appear in the document\n```\n\nI get the error `warning: layout did not converge within 5 attempts`. I assume it's due to the scope I am using to keep track of the used IDs.\n\nI am not sure how to fix this or what I am doing wrong when modifying the state.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 44.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1647
    },
    {
      "id": 13110,
      "post_number": 2,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-05-25T13:54:54.465Z",
      "updated_at": "2025-05-25T13:55:17.658Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Niklas\" data-post=\"1\" data-topic=\"4273\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/niklas/48/3100_2.png\" class=\"avatar\"> Niklas:</div>\n<blockquote>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">  if array == none {\n    state.update((def,))\n  }\n  else if not array.contains(def) {\n    state.update((..array,def))\n  }\n</code></pre>\n</blockquote>\n</aside>\n<p>I don’t know if this is enough to resolve but this is a place where get and update can be combined into a single update and in that case it <em>should</em> be combined. As in <code>state.update(old_array =&gt; compute_new(old_array))</code></p>",
      "raw": "[quote=\"Niklas, post:1, topic:4273\"]\n```typc\n  if array == none {\n    state.update((def,))\n  }\n  else if not array.contains(def) {\n    state.update((..array,def))\n  }\n```\n[/quote]\n\nI don't know if this is enough to resolve but this is a place where get and update can be combined into a single update and in that case it _should_ be combined. As in `state.update(old_array => compute_new(old_array))`",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 23,
      "score": 9.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 13121,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-25T16:59:15.589Z",
      "updated_at": "2025-05-25T16:59:24.468Z",
      "cooked": "<p>Hello. You are stepping into the same trap as <a href=\"https://forum.typst.app/t/how-to-keep-exercise-and-solution-together-in-source-but-render-them-separately/3999/3\" class=\"inline-onebox\">How to keep exercise and solution together in source, but render them separately? - #3 by Andrew</a> and <a href=\"https://forum.typst.app/t/why-is-my-random-shuffle-always-producing-the-same-result-when-using-suiji/4218/9\" class=\"inline-onebox\">Why is my random shuffle always producing the same result when using Suiji? - #9 by Andrew</a>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let ref-type = (definition: \"Definition\", theorem: \"Theorem\", lemma: \"Lemma\")\n#let lecture-refs = (\n  def1-1: (\n    lecture: 1,\n    index: 1,\n    type: ref-type.definition,\n    content: [This is my first definition.],\n  ),\n  the1-2: (\n    lecture: 1,\n    index: 2,\n    type: ref-type.theorem,\n    content: [This is the second entry but its a theorem.],\n  ),\n  the2-1: (\n    lecture: 2,\n    index: 1,\n    type: ref-type.theorem,\n    content: [This theorem is relevant but I won't need it for the notes.],\n  ),\n  def2-2: (\n    lecture: 2,\n    index: 2,\n    type: ref-type.definition,\n    content: [Let's define some more items.],\n  ),\n  lem3-1: (\n    lecture: 3,\n    index: 1,\n    type: ref-type.lemma,\n    content: [Now we add a lemma for a change.],\n  ),\n)\n\n#let lecture-ref(def) = context {\n  let state = state(\"used-literature-refs\", ())\n  let array = state.get()\n  if not array.contains(def) {\n    state.update(array =&gt; array + (def,))\n  }\n  ref(label(def))\n}\n\n#let used-lecture-refs() = context {\n  let used = state(\"used-literature-refs\").final()\n  if used.len() == 0 { return }\n  [= Lecture References]\n  set heading(numbering: \"1.1\")\n  for (key, value) in used.map(key =&gt; (key, lecture-refs.at(key))) {\n    counter(heading).update((value.lecture, value.index - 1))\n    [#heading(depth: 2, supplement: value.type)[#value.type]#label(key)]\n    value.content\n  }\n}\n\n#let template(doc) = {\n  doc\n  used-lecture-refs()\n}\n\n#show: template\n\n= Homework\nIn my homework I need to reference some content from the lectures like\n#lecture-ref(\"def1-1\"), #lecture-ref(\"the1-2\"), #lecture-ref(\"def2-2\"),\n#lecture-ref(\"lem3-1\")\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/b/b8f6623941607e36c5632c9824fe133c817e62a3.png\" data-download-href=\"https://forum.typst.app/uploads/default/b8f6623941607e36c5632c9824fe133c817e62a3\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/b/b8f6623941607e36c5632c9824fe133c817e62a3_2_690x365.png\" alt=\"image\" data-base62-sha1=\"qofJcWYDCPaHMLiz2FEJHsaqawH\" width=\"690\" height=\"365\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/b/b8f6623941607e36c5632c9824fe133c817e62a3_2_690x365.png, https://forum.typst.app/uploads/default/original/2X/b/b8f6623941607e36c5632c9824fe133c817e62a3.png 1.5x, https://forum.typst.app/uploads/default/original/2X/b/b8f6623941607e36c5632c9824fe133c817e62a3.png 2x\" data-dominant-color=\"141414\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">784×415 44.1 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "Hello. You are stepping into the same trap as https://forum.typst.app/t/how-to-keep-exercise-and-solution-together-in-source-but-render-them-separately/3999/3?u=andrew and https://forum.typst.app/t/why-is-my-random-shuffle-always-producing-the-same-result-when-using-suiji/4218/9?u=andrew.\n\n```typ\n#let ref-type = (definition: \"Definition\", theorem: \"Theorem\", lemma: \"Lemma\")\n#let lecture-refs = (\n  def1-1: (\n    lecture: 1,\n    index: 1,\n    type: ref-type.definition,\n    content: [This is my first definition.],\n  ),\n  the1-2: (\n    lecture: 1,\n    index: 2,\n    type: ref-type.theorem,\n    content: [This is the second entry but its a theorem.],\n  ),\n  the2-1: (\n    lecture: 2,\n    index: 1,\n    type: ref-type.theorem,\n    content: [This theorem is relevant but I won't need it for the notes.],\n  ),\n  def2-2: (\n    lecture: 2,\n    index: 2,\n    type: ref-type.definition,\n    content: [Let's define some more items.],\n  ),\n  lem3-1: (\n    lecture: 3,\n    index: 1,\n    type: ref-type.lemma,\n    content: [Now we add a lemma for a change.],\n  ),\n)\n\n#let lecture-ref(def) = context {\n  let state = state(\"used-literature-refs\", ())\n  let array = state.get()\n  if not array.contains(def) {\n    state.update(array => array + (def,))\n  }\n  ref(label(def))\n}\n\n#let used-lecture-refs() = context {\n  let used = state(\"used-literature-refs\").final()\n  if used.len() == 0 { return }\n  [= Lecture References]\n  set heading(numbering: \"1.1\")\n  for (key, value) in used.map(key => (key, lecture-refs.at(key))) {\n    counter(heading).update((value.lecture, value.index - 1))\n    [#heading(depth: 2, supplement: value.type)[#value.type]#label(key)]\n    value.content\n  }\n}\n\n#let template(doc) = {\n  doc\n  used-lecture-refs()\n}\n\n#show: template\n\n= Homework\nIn my homework I need to reference some content from the lectures like\n#lecture-ref(\"def1-1\"), #lecture-ref(\"the1-2\"), #lecture-ref(\"def2-2\"),\n#lecture-ref(\"lem3-1\")\n```\n\n![image|690x365](upload://qofJcWYDCPaHMLiz2FEJHsaqawH.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 14.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13133,
      "post_number": 4,
      "username": "Niklas",
      "name": "Niklas",
      "created_at": "2025-05-25T20:22:56.711Z",
      "updated_at": "2025-05-25T20:22:56.711Z",
      "cooked": "<p>Thank you very much! This fixed my problem.</p>",
      "raw": "Thank you very much! This fixed my problem.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 18.4,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1647
    }
  ],
  "scraped_at": "2025-06-10T09:47:19.475265"
}
{
  "topic_metadata": {
    "id": 4280,
    "title": "How to draw tree diagrams in Typst?",
    "slug": "how-to-draw-tree-diagrams-in-typst",
    "posts_count": 3,
    "created_at": "2025-05-25T15:14:09.321Z",
    "last_posted_at": "2025-05-25T16:05:54.843Z",
    "views": 104,
    "like_count": 3,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "Netzwerk2",
    "tags": [
      "graphics"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 299
  },
  "posts": [
    {
      "id": 13116,
      "post_number": 1,
      "username": "Michael_Ronin",
      "name": "Michael  Ronin",
      "created_at": "2025-05-25T15:14:09.370Z",
      "updated_at": "2025-05-25T15:47:46.432Z",
      "cooked": "<p>hi there,<br>\nI’m fairly new to typst (I have been using Latex before), and in latex i could create trees using the forest package. Is there any way to create trees in typst? From what i could find none of the packages do exactly what i need.<br>\nIn latex, by writing this in the preamble:</p>\n<pre data-code-wrap=\"latex\"><code class=\"lang-latex\">\\usepackage[edges]{forest}\n\\forestset{\n\tmydefault/.style={\n\t\tfor tree={\n\t\t\tdraw,\n\t\t\tcircle,\n\t\t\tminimum size=1cm,\n\t\t\tinner sep=2pt,\n\t\t\ts sep=1cm,\n\t\t\tl=1.5cm\n\t\t}\n\t}\n}\n</code></pre>\n<p>and this in the code:</p>\n<pre data-code-wrap=\"latex\"><code class=\"lang-latex\">\\begin{forest}\n                mydefault\n                [2 [1] [4 [3] [5]]]\n\\end{forest}\n</code></pre>\n<p>It would create this:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/c/c2051ebb26b0cb718e4c5a4929523ae3c6715316.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/c2051ebb26b0cb718e4c5a4929523ae3c6715316\" title=\"WhatsApp Image 2025-05-25 at 10.54.20_285b170b\"><img src=\"https://forum.typst.app/uploads/default/original/2X/c/c2051ebb26b0cb718e4c5a4929523ae3c6715316.jpeg\" alt=\"WhatsApp Image 2025-05-25 at 10.54.20_285b170b\" data-base62-sha1=\"rGnB8cNNIa5S2gz8mHdX8IwiOZo\" width=\"211\" height=\"164\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">WhatsApp Image 2025-05-25 at 10.54.20_285b170b</span><span class=\"informations\">211×164 5.54 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "hi there,\nI'm fairly new to typst (I have been using Latex before), and in latex i could create trees using the forest package. Is there any way to create trees in typst? From what i could find none of the packages do exactly what i need.\nIn latex, by writing this in the preamble:\n```latex\n\\usepackage[edges]{forest}\n\\forestset{\n\tmydefault/.style={\n\t\tfor tree={\n\t\t\tdraw,\n\t\t\tcircle,\n\t\t\tminimum size=1cm,\n\t\t\tinner sep=2pt,\n\t\t\ts sep=1cm,\n\t\t\tl=1.5cm\n\t\t}\n\t}\n}\n```\nand this in the code:\n```latex\n\\begin{forest}\n                mydefault\n                [2 [1] [4 [3] [5]]]\n\\end{forest}\n```\nIt would create this:\n![WhatsApp Image 2025-05-25 at 10.54.20_285b170b|211x164](upload://rGnB8cNNIa5S2gz8mHdX8IwiOZo.jpeg)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 37,
      "score": 167.4,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1651
    },
    {
      "id": 13118,
      "post_number": 2,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-05-25T15:48:45.647Z",
      "updated_at": "2025-05-25T15:48:45.647Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/michael_ronin\">@Michael_Ronin</a>, welcome to the forum! I’ve changed your question post’s title and added a tag to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Michael_Ronin, welcome to the forum! I’ve changed your question post’s title and added a tag to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 36,
      "score": 12.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 13119,
      "post_number": 3,
      "username": "Netzwerk2",
      "name": "",
      "created_at": "2025-05-25T16:05:54.843Z",
      "updated_at": "2025-05-25T16:06:34.330Z",
      "cooked": "<p><code>cetz</code> has a <a href=\"https://github.com/cetz-package/cetz/blob/master/gallery/tree.typ\" rel=\"noopener nofollow ugc\">tree example</a></p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#import \"@preview/cetz:0.3.4\": canvas, draw, tree\n\n#set page(width: auto, height: auto, margin: .5cm)\n\n#let data = (\n  [A], ([B], [C], [D]), ([E], [F])\n)\n\n#canvas({\n  import draw: *\n\n  set-style(content: (padding: .2),\n    fill: gray.lighten(70%),\n    stroke: gray.lighten(70%))\n\n  tree.tree(data, spread: 2.5, grow: 1.5, draw-node: (node, ..) =&gt; {\n    circle((), radius: .45, stroke: none)\n    content((), node.content)\n  }, draw-edge: (from, to, ..) =&gt; {\n    line((a: from, number: .6, b: to),\n         (a: to, number: .6, b: from), mark: (end: \"&gt;\"))\n  }, name: \"tree\")\n\n  // Draw a \"custom\" connection between two nodes\n  let (a, b) = (\"tree.0-0-1\", \"tree.0-1-0\",)\n  line((a, .6, b), (b, .6, a), mark: (end: \"&gt;\", start: \"&gt;\"))\n})\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/4/41e0a3c2fd1b4a4422c688600655e5d7b4b3e956.png\" data-download-href=\"https://forum.typst.app/uploads/default/41e0a3c2fd1b4a4422c688600655e5d7b4b3e956\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/original/2X/4/41e0a3c2fd1b4a4422c688600655e5d7b4b3e956.png\" alt=\"image\" data-base62-sha1=\"9oMk55ofwb5PdD25RxSvUJBp3IW\" width=\"391\" height=\"278\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">391×278 11.2 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "`cetz` has a [tree example](https://github.com/cetz-package/cetz/blob/master/gallery/tree.typ)\n\n```typst\n#import \"@preview/cetz:0.3.4\": canvas, draw, tree\n\n#set page(width: auto, height: auto, margin: .5cm)\n\n#let data = (\n  [A], ([B], [C], [D]), ([E], [F])\n)\n\n#canvas({\n  import draw: *\n\n  set-style(content: (padding: .2),\n    fill: gray.lighten(70%),\n    stroke: gray.lighten(70%))\n\n  tree.tree(data, spread: 2.5, grow: 1.5, draw-node: (node, ..) => {\n    circle((), radius: .45, stroke: none)\n    content((), node.content)\n  }, draw-edge: (from, to, ..) => {\n    line((a: from, number: .6, b: to),\n         (a: to, number: .6, b: from), mark: (end: \">\"))\n  }, name: \"tree\")\n\n  // Draw a \"custom\" connection between two nodes\n  let (a, b) = (\"tree.0-0-1\", \"tree.0-1-0\",)\n  line((a, .6, b), (b, .6, a), mark: (end: \">\", start: \">\"))\n})\n```\n\n![image|391x278](upload://9oMk55ofwb5PdD25RxSvUJBp3IW.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 35,
      "score": 52.0,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 394
    }
  ],
  "scraped_at": "2025-06-10T09:47:18.760544"
}
{
  "topic_metadata": {
    "id": 4281,
    "title": "How to add a sticker on the right margin of the page?",
    "slug": "how-to-add-a-sticker-on-the-right-margin-of-the-page",
    "posts_count": 5,
    "created_at": "2025-05-25T15:27:53.600Z",
    "last_posted_at": "2025-05-25T19:03:59.688Z",
    "views": 47,
    "like_count": 2,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "Andrew",
    "tags": [
      "layout",
      "graphics"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 169
  },
  "posts": [
    {
      "id": 13117,
      "post_number": 1,
      "username": "Andrew_Duncan",
      "name": "Andrew Duncan",
      "created_at": "2025-05-25T15:27:53.677Z",
      "updated_at": "2025-05-25T19:07:44.562Z",
      "cooked": "<p>Hi,</p>\n<p>I would like to add a sticker on the right side of my paragraph. I need to include some text on the sticker. Any help is welcome.</p>\n<p>Thank you.</p>",
      "raw": "Hi,\n\nI would like to add a sticker on the right side of my paragraph. I need to include some text on the sticker. Any help is welcome.\n\nThank you.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 10.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1560
    },
    {
      "id": 13129,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-25T17:53:32.469Z",
      "updated_at": "2025-05-25T17:53:32.469Z",
      "cooked": "<p>Hi. On the right side of the page or on the right side of the paragraph? Is this just a raster image?</p>",
      "raw": "Hi. On the right side of the page or on the right side of the paragraph? Is this just a raster image?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 10.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13130,
      "post_number": 3,
      "username": "Andrew_Duncan",
      "name": "Andrew Duncan",
      "created_at": "2025-05-25T17:57:08.572Z",
      "updated_at": "2025-05-25T17:57:08.572Z",
      "cooked": "<p>On the right side of the paragraph.</p>",
      "raw": "On the right side of the paragraph.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 5.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1560
    },
    {
      "id": 13131,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-25T18:22:23.518Z",
      "updated_at": "2025-05-25T18:23:36.976Z",
      "cooked": "<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let sticker(size, ..args) = circle(\n  fill: green,\n  radius: 3em * size,\n  ..args,\n  align(center + horizon, text(1em * size, black, upper[sticker])),\n)\n#set page(\n  background: {\n    place(horizon + right, dx: -2mm, rotate(-20deg, sticker(1)))\n    place(top + right, dx: 8mm, dy: -8mm, rotate(20deg, sticker(2)))\n  },\n  foreground: place(bottom + right, sticker(3)),\n)\n#set par(justify: true)\n\n#lorem(100)\n\n#lorem(100)\n\n#lorem(100)\n\n#lorem(100)\n\n#lorem(100)\n\n#lorem(100)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/1/17f81290d9e4c48476fa7f0c4b6c8365229bd2b0.png\" data-download-href=\"https://forum.typst.app/uploads/default/17f81290d9e4c48476fa7f0c4b6c8365229bd2b0\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/1/17f81290d9e4c48476fa7f0c4b6c8365229bd2b0_2_358x500.png\" alt=\"image\" data-base62-sha1=\"3q2tqW0ktvmsIzRVqlfh5klcahW\" width=\"358\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/1/17f81290d9e4c48476fa7f0c4b6c8365229bd2b0_2_358x500.png, https://forum.typst.app/uploads/default/optimized/2X/1/17f81290d9e4c48476fa7f0c4b6c8365229bd2b0_2_537x750.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/1/17f81290d9e4c48476fa7f0c4b6c8365229bd2b0_2_716x1000.png 2x\" data-dominant-color=\"232E25\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">747×1041 257 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p><a href=\"https://typst.app/docs/reference/layout/page/#parameters-background\"><code>page.background</code></a><br>\n<a href=\"https://typst.app/docs/reference/layout/page/#parameters-foreground\"><code>page.foreground</code></a><br>\n<a href=\"https://typst.app/docs/reference/layout/place/\"><code>place</code></a></p>",
      "raw": "```typ\n#let sticker(size, ..args) = circle(\n  fill: green,\n  radius: 3em * size,\n  ..args,\n  align(center + horizon, text(1em * size, black, upper[sticker])),\n)\n#set page(\n  background: {\n    place(horizon + right, dx: -2mm, rotate(-20deg, sticker(1)))\n    place(top + right, dx: 8mm, dy: -8mm, rotate(20deg, sticker(2)))\n  },\n  foreground: place(bottom + right, sticker(3)),\n)\n#set par(justify: true)\n\n#lorem(100)\n\n#lorem(100)\n\n#lorem(100)\n\n#lorem(100)\n\n#lorem(100)\n\n#lorem(100)\n```\n\n![image|358x500](upload://3q2tqW0ktvmsIzRVqlfh5klcahW.png)\n\n[`page.background`](https://typst.app/docs/reference/layout/page/#parameters-background)\n[`page.foreground`](https://typst.app/docs/reference/layout/page/#parameters-foreground)\n[`place`](https://typst.app/docs/reference/layout/place/)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 25,
      "score": 25.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13132,
      "post_number": 5,
      "username": "Andrew_Duncan",
      "name": "Andrew Duncan",
      "created_at": "2025-05-25T19:03:59.688Z",
      "updated_at": "2025-05-25T19:03:59.688Z",
      "cooked": "<p>Hi Andrew,<br>\nThank you very much for your support.</p>",
      "raw": "Hi Andrew,\nThank you very much for your support.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 23,
      "score": 19.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1560
    }
  ],
  "scraped_at": "2025-06-10T09:47:18.054861"
}
{
  "topic_metadata": {
    "id": 4290,
    "title": "How to change image-var based on bool?",
    "slug": "how-to-change-image-var-based-on-bool",
    "posts_count": 4,
    "created_at": "2025-05-26T06:49:38.625Z",
    "last_posted_at": "2025-05-26T12:30:12.764Z",
    "views": 26,
    "like_count": 1,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "gezepi",
    "tags": [],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 247
  },
  "posts": [
    {
      "id": 13139,
      "post_number": 1,
      "username": "StTu",
      "name": "StTu",
      "created_at": "2025-05-26T06:49:38.717Z",
      "updated_at": "2025-05-26T06:51:04.112Z",
      "cooked": "<p>Hi,<br>\nI have a typ document with 2k lines. At several sections I have defined variables with content/images.<br>\nI now what to change the image dependend on a bool.<br>\nHowever I cannot use the var myimage2  due to the scope …<br>\nAny recommendation how to solve this?<br>\nMany thanks …</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let isLevelEasy = true\n\n= section 1\n#let myimage1 = image(\"image1\")\n// use myimage1 here\nmyimage1\n\n= section 2\n// I would like to define myimage2 as part of section2\n#if isLevelEasy {\n  let myimage2 = image(\"image2\")\n} else {\n  let myimage2 = image(\"image2_Easy\")\n}\n// I would like to use myimage2 here ... \n</code></pre>",
      "raw": "Hi,\nI have a typ document with 2k lines. At several sections I have defined variables with content/images.\nI now what to change the image dependend on a bool.\nHowever I cannot use the var myimage2  due to the scope ...\nAny recommendation how to solve this?\nMany thanks ... \n\n```typ\n#let isLevelEasy = true\n\n= section 1\n#let myimage1 = image(\"image1\")\n// use myimage1 here\nmyimage1\n\n= section 2\n// I would like to define myimage2 as part of section2\n#if isLevelEasy {\n  let myimage2 = image(\"image2\")\n} else {\n  let myimage2 = image(\"image2_Easy\")\n}\n// I would like to use myimage2 here ... \n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 13.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1654
    },
    {
      "id": 13141,
      "post_number": 2,
      "username": "gezepi",
      "name": "",
      "created_at": "2025-05-26T08:05:32.923Z",
      "updated_at": "2025-05-26T08:07:01.892Z",
      "cooked": "<p>You can declare the <code>myimage2</code> variable before the <code>if</code> block:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">= section 2\n//Create the variable\n#let myimage2 = none\n//Store an image in the variable\n#if isLevelEasy {\n  myimage2 = image(\"image2\")\n} else {\n  myimage2 = image(\"image2_Easy\")\n}\n//Display it here\n#myimage2\n</code></pre>\n<p>It can also be shortened by deciding which to use when declaring the variable:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">= section 2\n#let myimage2 = if isLevelEasy {image(\"image2\")} else {image(\"image2_Easy\")}\n#myimage2\n</code></pre>\n<p>Or, if you don’t actually need to save the image in a variable, you can simply return the correct image from within the <code>if</code> block which will then be displayed:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">= section 2\n#if isLevelEasy {\n  image(\"image2\")\n} else {\n  image(\"image2_Easy\")\n}\n</code></pre>",
      "raw": "You can declare the `myimage2` variable before the `if` block:\n```\n= section 2\n//Create the variable\n#let myimage2 = none\n//Store an image in the variable\n#if isLevelEasy {\n  myimage2 = image(\"image2\")\n} else {\n  myimage2 = image(\"image2_Easy\")\n}\n//Display it here\n#myimage2\n```\nIt can also be shortened by deciding which to use when declaring the variable:\n```\n= section 2\n#let myimage2 = if isLevelEasy {image(\"image2\")} else {image(\"image2_Easy\")}\n#myimage2\n```\n\nOr, if you don't actually need to save the image in a variable, you can simply return the correct image from within the `if` block which will then be displayed:\n```\n= section 2\n#if isLevelEasy {\n  image(\"image2\")\n} else {\n  image(\"image2_Easy\")\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 28.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 326
    },
    {
      "id": 13147,
      "post_number": 3,
      "username": "StTu",
      "name": "StTu",
      "created_at": "2025-05-26T10:22:44.226Z",
      "updated_at": "2025-05-26T10:22:44.226Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/gezepi\">@gezepi</a>,<br>\nthe “shortened version” is an elegant way to solve my problem.<br>\nThank you for your support …</p>",
      "raw": "Hi @gezepi,\nthe \"shortened version\" is an elegant way to solve my problem.\nThank you for your support ...",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 13,
      "score": 2.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1654
    },
    {
      "id": 13156,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-26T12:30:12.764Z",
      "updated_at": "2025-05-26T12:30:12.764Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"gezepi\" data-post=\"2\" data-topic=\"4290\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/g/C34CE0/48.png\" class=\"avatar\"> gezepi:</div>\n<blockquote>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let myimage2 = if isLevelEasy {image(\"image2\")} else {image(\"image2_Easy\")}\n</code></pre>\n</blockquote>\n</aside>\n<p>Or even shorter, if same arguments used:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let myimage2 = image(if isLevelEasy { \"image2\" } else { \"image2_Easy\" })\n</code></pre>",
      "raw": "[quote=\"gezepi, post:2, topic:4290\"]\n```typ\n#let myimage2 = if isLevelEasy {image(\"image2\")} else {image(\"image2_Easy\")}\n```\n[/quote]\n\nOr even shorter, if same arguments used:\n\n```typ\n#let myimage2 = image(if isLevelEasy { \"image2\" } else { \"image2_Easy\" })\n```",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 11,
      "score": 2.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:47:17.333279"
}
{
  "topic_metadata": {
    "id": 4293,
    "title": "How to check if current file is main?",
    "slug": "how-to-check-if-current-file-is-main",
    "posts_count": 4,
    "created_at": "2025-05-26T08:31:58.452Z",
    "last_posted_at": "2025-05-26T14:47:53.874Z",
    "views": 67,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Roberto",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 269
  },
  "posts": [
    {
      "id": 13143,
      "post_number": 1,
      "username": "legokol",
      "name": "legokol",
      "created_at": "2025-05-26T08:31:58.525Z",
      "updated_at": "2025-05-26T14:47:32.656Z",
      "cooked": "<p>Suppose I have a project, containing 2 files: <code>main.typ</code> and <code>chapter1.typ</code>. Main file <code>main.typ</code> includes chapter via <code>#include \"chapter1.typ\"</code>. However, I want to be able to compile <code>chapter1.typ</code> separately with different set-rules. So, I need something like</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\"># set ... if // is_main() ???\n</code></pre>\n<p>The question is how to implement such is_main function or something like that. I wasn’t able to find a simple way to achieve this, is there any?</p>",
      "raw": "Suppose I have a project, containing 2 files: `main.typ` and `chapter1.typ`. Main file `main.typ` includes chapter via `#include \"chapter1.typ\"`. However, I want to be able to compile `chapter1.typ` separately with different set-rules. So, I need something like\n```typ\n# set ... if // is_main() ???\n```\nThe question is how to implement such is_main function or something like that. I wasn't able to find a simple way to achieve this, is there any?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 35,
      "score": 67.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1655
    },
    {
      "id": 13144,
      "post_number": 2,
      "username": "Roberto",
      "name": "Roberto Giacomelli",
      "created_at": "2025-05-26T09:33:22.748Z",
      "updated_at": "2025-05-26T10:51:21.619Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/legokol\">@legokol</a> .<br>\nYou may use a solution based on values avalaible in memory as string and passed to the compiler as a key=value formatted data by the <code>--input</code> option.</p>\n<p>For example:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// this is a no_main.typ file\n#{\n  let is_main = sys.inputs.at( \"main\", default: \"true\")\n  if is_main == \"false\" {\n    [no main file]\n  } else {\n    [yes this is a main file]\n  }\n}\n</code></pre>\n<p>To obtain a no main typesetting, compile it with the command:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">&gt; typst compile --input main=false no_main.typ\n</code></pre>\n<p>Otherwise compile with the command:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">&gt; typst compile no_main.typ\n</code></pre>\n<p>At this point you need only to substitute the code in the <code>if</code> istruction to set up your document as desired.</p>\n<p>If you desire a preview based on the no main configuration switch the <code>if</code> true/false cases.<br>\nR.</p>",
      "raw": "Hi @legokol .\nYou may use a solution based on values avalaible in memory as string and passed to the compiler as a key=value formatted data by the `--input` option.\n\nFor example:\n\n```typ\n// this is a no_main.typ file\n#{\n  let is_main = sys.inputs.at( \"main\", default: \"true\")\n  if is_main == \"false\" {\n    [no main file]\n  } else {\n    [yes this is a main file]\n  }\n}\n```\n\nTo obtain a no main typesetting, compile it with the command:\n```\n> typst compile --input main=false no_main.typ\n```\nOtherwise compile with the command:\n```\n> typst compile no_main.typ\n```\n\nAt this point you need only to substitute the code in the `if` istruction to set up your document as desired.\n\nIf you desire a preview based on the no main configuration switch the `if` true/false cases.\nR.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 34,
      "score": 11.8,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 1471
    },
    {
      "id": 13157,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-26T12:34:56.626Z",
      "updated_at": "2025-05-26T12:34:56.626Z",
      "cooked": "<p>Hello. This is currently not directly possible without some hackery: <a href=\"https://github.com/typst/typst/issues/4502\" class=\"inline-onebox\">Entry point (main file) detection within Typst document for nested projects · Issue #4502 · typst/typst · GitHub</a>.</p>",
      "raw": "Hello. This is currently not directly possible without some hackery: https://github.com/typst/typst/issues/4502.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 26,
      "score": 20.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13185,
      "post_number": 4,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-05-26T14:47:53.874Z",
      "updated_at": "2025-05-26T14:47:53.874Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/legokol\">@legokol</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a><br>\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @legokol, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 22,
      "score": 19.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:47:16.596378"
}
{
  "topic_metadata": {
    "id": 4295,
    "title": "How to make multiple individual Headings?",
    "slug": "how-to-make-multiple-individual-headings",
    "posts_count": 4,
    "created_at": "2025-05-26T09:59:03.229Z",
    "last_posted_at": "2025-05-26T11:55:27.748Z",
    "views": 28,
    "like_count": 4,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "aarnent",
    "tags": [],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 135
  },
  "posts": [
    {
      "id": 13146,
      "post_number": 1,
      "username": "MFrey",
      "name": "",
      "created_at": "2025-05-26T09:59:03.323Z",
      "updated_at": "2025-05-26T09:59:03.323Z",
      "cooked": "<p>The result should be like this.</p>\n<p>1 First section<br>\n2 Second section<br>\n3 Third section</p>\n<p>A Thing A<br>\nB Thing B<br>\nC Thing C</p>\n<p>Problem is, new headings start counting at “K”, when i do:</p>\n<p><span class=\"hashtag-raw\">#set</span> heading(numbering: “A”)</p>\n<p>And i don’t know how i can reset the internal counter of the heading function</p>",
      "raw": "The result should be like this.\n\n1 First section\n2 Second section\n3 Third section\n\nA Thing A\nB Thing B\nC Thing C\n\nProblem is, new headings start counting at \"K\", when i do:\n\n#set heading(numbering: \"A\")\n\nAnd i don't know how i can reset the internal counter of the heading function",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 4.2,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1656
    },
    {
      "id": 13148,
      "post_number": 2,
      "username": "aarnent",
      "name": "",
      "created_at": "2025-05-26T10:30:32.401Z",
      "updated_at": "2025-05-26T10:30:32.401Z",
      "cooked": "<p>Hi, this is explained in the <a href=\"https://typst.app/docs/reference/introspection/counter/#modifying\">counter documentation</a>. In your case inserting <code>#counter(heading).update(0)</code> achieves what you want to do</p>",
      "raw": "Hi, this is explained in the [counter documentation](https://typst.app/docs/reference/introspection/counter/#modifying). In your case inserting `#counter(heading).update(0)` achieves what you want to do",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 20,
      "score": 39.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 501
    },
    {
      "id": 13150,
      "post_number": 3,
      "username": "MFrey",
      "name": "",
      "created_at": "2025-05-26T10:48:12.241Z",
      "updated_at": "2025-05-26T10:48:12.241Z",
      "cooked": "<p>Yeah i knew i was stupid. I didn’t think my solution would be in the counter documentation. Anyways, thanks for the fast reply.</p>",
      "raw": "Yeah i knew i was stupid. I didn't think my solution would be in the counter documentation. Anyways, thanks for the fast reply.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1656
    },
    {
      "id": 13154,
      "post_number": 4,
      "username": "Andrew_Duncan",
      "name": "Andrew Duncan",
      "created_at": "2025-05-26T11:55:27.748Z",
      "updated_at": "2025-05-26T11:55:27.748Z",
      "cooked": "<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#outline()\n\n#set heading(numbering: \"1\")\n= First section\n= Second section\n= Third section\n\n#counter(heading).update(0)\n\n#set heading(numbering: \"A\")\n\n= Thing A\n= Thing B\n= Thing C\n</code></pre>",
      "raw": "\n```typ\n#outline()\n\n#set heading(numbering: \"1\")\n= First section\n= Second section\n= Third section\n\n#counter(heading).update(0)\n\n#set heading(numbering: \"A\")\n\n= Thing A\n= Thing B\n= Thing C\n```",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 14,
      "score": 32.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1560
    }
  ],
  "scraped_at": "2025-06-10T09:47:15.712887"
}
{
  "topic_metadata": {
    "id": 4306,
    "title": "How to draw a decorative frame (rect with concave corners) around text?",
    "slug": "how-to-draw-a-decorative-frame-rect-with-concave-corners-around-text",
    "posts_count": 10,
    "created_at": "2025-05-26T18:54:33.408Z",
    "last_posted_at": "2025-05-28T12:52:49.110Z",
    "views": 135,
    "like_count": 4,
    "reply_count": 8,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "Andrew",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 1775
  },
  "posts": [
    {
      "id": 13190,
      "post_number": 1,
      "username": "svat",
      "name": "",
      "created_at": "2025-05-26T18:54:33.477Z",
      "updated_at": "2025-05-26T18:54:33.477Z",
      "cooked": "<p>I’m trying to replicate in Typst an existing book design (created in InDesign) that has decorative frames around certain text (quotes), with <em>concave</em> rounded corners and double-stroked borders (bold outer frame, and with a small padding, a less bold inner frame). It looks as in the image below (text blurred out to redact it):</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/5/5be21b6f43ce1c1d242c2a9e1d61d3d0b1e2150d.png\" data-download-href=\"https://forum.typst.app/uploads/default/5be21b6f43ce1c1d242c2a9e1d61d3d0b1e2150d\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/5/5be21b6f43ce1c1d242c2a9e1d61d3d0b1e2150d_2_690x352.png\" alt=\"image\" data-base62-sha1=\"d6PSH6q6JuUAmOn45Zxnfcs2gKV\" width=\"690\" height=\"352\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/5/5be21b6f43ce1c1d242c2a9e1d61d3d0b1e2150d_2_690x352.png, https://forum.typst.app/uploads/default/original/2X/5/5be21b6f43ce1c1d242c2a9e1d61d3d0b1e2150d.png 1.5x, https://forum.typst.app/uploads/default/original/2X/5/5be21b6f43ce1c1d242c2a9e1d61d3d0b1e2150d.png 2x\" data-dominant-color=\"EEEEEE\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">936×478 16.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>How can this be done in Typst? The frames are always the full width of the text block, but height should resize to that of the text contents (as <code>#rect</code> does by default).</p>",
      "raw": "I'm trying to replicate in Typst an existing book design (created in InDesign) that has decorative frames around certain text (quotes), with *concave* rounded corners and double-stroked borders (bold outer frame, and with a small padding, a less bold inner frame). It looks as in the image below (text blurred out to redact it):\n\n![image|690x352](upload://d6PSH6q6JuUAmOn45Zxnfcs2gKV.png)\n\nHow can this be done in Typst? The frames are always the full width of the text block, but height should resize to that of the text contents (as `#rect` does by default).",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 47.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1659
    },
    {
      "id": 13193,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-26T21:31:19.724Z",
      "updated_at": "2025-05-26T21:35:24.487Z",
      "cooked": "<p>Hello.</p>\n<p>IMO, if you are <em>trying</em> to do something, then it means you have some progress or something that you’ve tried, therefore this should be present in the post. So far you’ve only described and showed how it should look like and how can this be done. This sends conflicting signals, as if you are trying, but actually you didn’t try anything, which is not great. Perhaps a wrong verb was chosen.</p>\n<p>Here is something that looks like what you want, not sure about corner specifics:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let frame-shape(width: 10cm, height: 5cm, radius: 15pt, a: 0pt, ..args) = {\n  set curve.quad(relative: true)\n  set curve.line(relative: true)\n  curve(\n    ..args,\n    curve.move((0pt, radius)),\n    curve.line((0pt, height - radius * 2)), // Left\n    curve.quad((-a + radius, a), (radius, radius)), // Bottom-left\n    curve.line((width - radius * 2, 0pt)), // Bottom\n    curve.quad((a, a - radius), (radius, 0pt - radius)), // Bottom-right\n    curve.line((0pt, -height + radius * 2)), // Right\n    curve.quad((a - radius, -a), (-radius, -radius)), // Top-right\n    curve.line((-width + radius * 2, 0pt)), // Top edge\n    curve.quad((-a, -a + radius), (-radius, radius)), // Top-left\n  )\n}\n\n#let frame(\n  width: 10cm,\n  height: auto,\n  radius: 15pt,\n  inner: 2pt,\n  stroke: 1pt,\n  inner-stroke: 0.5pt,\n  body,\n) = {\n  layout(size =&gt; {\n    let body-block = block.with(width: width, inset: radius + inner)\n    let (height, body) = if height != auto {\n      (height, body-block(height: height, body))\n    } else {\n      let body = body-block(body)\n      (measure(body, ..size).height, body)\n    }\n    place(frame-shape(\n      width: width,\n      height: height,\n      radius: radius,\n      stroke: stroke,\n    ))\n    place(dx: inner, dy: inner, frame-shape(\n      width: width - inner * 2,\n      height: height - inner * 2,\n      radius: radius,\n      stroke: inner-stroke,\n      a: inner / 2,\n    ))\n    body\n  })\n}\n\n#set par(justify: true)\n\n#frame(lorem(25))\n\n#frame(width: 13cm)[\n  #align(center, lorem(5))\n\n  #align(center, lorem(7))\n\n  #lorem(59)\n\n  #lorem(6)\n]\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/5/5549199cc843157d604a1e41508dc01d320e1f4d.png\" data-download-href=\"https://forum.typst.app/uploads/default/5549199cc843157d604a1e41508dc01d320e1f4d\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/original/2X/5/5549199cc843157d604a1e41508dc01d320e1f4d.png\" alt=\"image\" data-base62-sha1=\"catct6vc5lLl01PfyYZWy06SrzT\" width=\"637\" height=\"479\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">637×479 78.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<hr>\n<p>About redacting. I don’t see why you can’t just remove the text and only leave the clean empty frame. Why going half-way and bother blurring if it’s not important anyway and can be stripped completely. A rule of thumb is to always avoid blurring, if you really don’t want to share the content, or it’s not important/relevant (it’s shape, etc).</p>",
      "raw": "Hello.\n\nIMO, if you are _trying_ to do something, then it means you have some progress or something that you've tried, therefore this should be present in the post. So far you've only described and showed how it should look like and how can this be done. This sends conflicting signals, as if you are trying, but actually you didn't try anything, which is not great. Perhaps a wrong verb was chosen.\n\nHere is something that looks like what you want, not sure about corner specifics:\n\n```typ\n#let frame-shape(width: 10cm, height: 5cm, radius: 15pt, a: 0pt, ..args) = {\n  set curve.quad(relative: true)\n  set curve.line(relative: true)\n  curve(\n    ..args,\n    curve.move((0pt, radius)),\n    curve.line((0pt, height - radius * 2)), // Left\n    curve.quad((-a + radius, a), (radius, radius)), // Bottom-left\n    curve.line((width - radius * 2, 0pt)), // Bottom\n    curve.quad((a, a - radius), (radius, 0pt - radius)), // Bottom-right\n    curve.line((0pt, -height + radius * 2)), // Right\n    curve.quad((a - radius, -a), (-radius, -radius)), // Top-right\n    curve.line((-width + radius * 2, 0pt)), // Top edge\n    curve.quad((-a, -a + radius), (-radius, radius)), // Top-left\n  )\n}\n\n#let frame(\n  width: 10cm,\n  height: auto,\n  radius: 15pt,\n  inner: 2pt,\n  stroke: 1pt,\n  inner-stroke: 0.5pt,\n  body,\n) = {\n  layout(size => {\n    let body-block = block.with(width: width, inset: radius + inner)\n    let (height, body) = if height != auto {\n      (height, body-block(height: height, body))\n    } else {\n      let body = body-block(body)\n      (measure(body, ..size).height, body)\n    }\n    place(frame-shape(\n      width: width,\n      height: height,\n      radius: radius,\n      stroke: stroke,\n    ))\n    place(dx: inner, dy: inner, frame-shape(\n      width: width - inner * 2,\n      height: height - inner * 2,\n      radius: radius,\n      stroke: inner-stroke,\n      a: inner / 2,\n    ))\n    body\n  })\n}\n\n#set par(justify: true)\n\n#frame(lorem(25))\n\n#frame(width: 13cm)[\n  #align(center, lorem(5))\n\n  #align(center, lorem(7))\n\n  #lorem(59)\n\n  #lorem(6)\n]\n```\n\n![image|637x479](upload://catct6vc5lLl01PfyYZWy06SrzT.png)\n\n---\n\nAbout redacting. I don't see why you can't just remove the text and only leave the clean empty frame. Why going half-way and bother blurring if it's not important anyway and can be stripped completely. A rule of thumb is to always avoid blurring, if you really don't want to share the content, or it's not important/relevant (it's shape, etc).",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 33,
      "score": 46.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13199,
      "post_number": 3,
      "username": "svat",
      "name": "",
      "created_at": "2025-05-26T23:13:55.526Z",
      "updated_at": "2025-05-26T23:15:41.715Z",
      "cooked": "<p>Thank you; that’s very helpful and informative!</p>\n<p>The only thing I’d like to be different is for the frame to have the same full width as other text blocks, without having to manually specifying a width. Here’s an example of what I mean (screenshot of output from this project: <a href=\"https://typst.app/project/rb5dNVT6kxOk8EwZawp0iN\" class=\"inline-onebox\">Typst</a> ):</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/6/6d8469a3ba60c63e1299829f2577d8c538f45797.jpeg\" data-download-href=\"https://forum.typst.app/uploads/default/6d8469a3ba60c63e1299829f2577d8c538f45797\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/6/6d8469a3ba60c63e1299829f2577d8c538f45797_2_358x500.jpeg\" alt=\"image\" data-base62-sha1=\"fCPJHluXuMEGzhpUMxiYPNTbeQf\" width=\"358\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/6/6d8469a3ba60c63e1299829f2577d8c538f45797_2_358x500.jpeg, https://forum.typst.app/uploads/default/optimized/2X/6/6d8469a3ba60c63e1299829f2577d8c538f45797_2_537x750.jpeg 1.5x, https://forum.typst.app/uploads/default/optimized/2X/6/6d8469a3ba60c63e1299829f2577d8c538f45797_2_716x1000.jpeg 2x\" data-dominant-color=\"EFEEEF\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">988×1378 181 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>As you can see, on the left the frame starts at the same x-coordinate as the text, but on the right the width is different — I guess I could measure the earlier blocks’ width and specify that, but wondering if there’s a way to specify the inner width (of the text) by subtracting the relevant amounts from the “current” width, then measure the height, then draw the frame with the relevant width and height.</p>\n<p>(About the earlier question: true, I said “trying” but included no code; I should have said I’m exploring whether it’s feasible to use Typst for this use-case; I’m still currently on page 3, and all I had for this specific issue was a <code>#rect</code> with rounded corners, which I thought wasn’t worth sharing. There are other issues I’m encountering like <a href=\"https://forum.typst.app/t/paragraph-indentation-seems-to-be-buggy/4308\" class=\"inline-onebox\">Paragraph indentation seems to be buggy</a> which may mean I have to give up on Typst, so it’s still in the early stages of exploration. Also the screenshot tool I used to take a screenshot of the original PDF didn’t allow redacting with black bars which would have been better, but only allowed blurring, which I agree is a weird choice! There is actually something relevant about the shape, namely placing the last line indented a bit to fit into the frame, but I’m willing to forgo that.)</p>",
      "raw": "Thank you; that's very helpful and informative!\n\nThe only thing I'd like to be different is for the frame to have the same full width as other text blocks, without having to manually specifying a width. Here's an example of what I mean (screenshot of output from this project: https://typst.app/project/rb5dNVT6kxOk8EwZawp0iN ):\n\n![image|358x500](upload://fCPJHluXuMEGzhpUMxiYPNTbeQf.jpeg)\n\nAs you can see, on the left the frame starts at the same x-coordinate as the text, but on the right the width is different — I guess I could measure the earlier blocks' width and specify that, but wondering if there's a way to specify the inner width (of the text) by subtracting the relevant amounts from the \"current\" width, then measure the height, then draw the frame with the relevant width and height.\n\n(About the earlier question: true, I said “trying” but included no code; I should have said I'm exploring whether it's feasible to use Typst for this use-case; I'm still currently on page 3, and all I had for this specific issue was a `#rect` with rounded corners, which I thought wasn't worth sharing. There are other issues I'm encountering like https://forum.typst.app/t/paragraph-indentation-seems-to-be-buggy/4308 which may mean I have to give up on Typst, so it's still in the early stages of exploration. Also the screenshot tool I used to take a screenshot of the original PDF didn't allow redacting with black bars which would have been better, but only allowed blurring, which I agree is a weird choice! There is actually something relevant about the shape, namely placing the last line indented a bit to fit into the frame, but I'm willing to forgo that.)",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 10.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1659
    },
    {
      "id": 13211,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-27T02:41:24.998Z",
      "updated_at": "2025-05-27T02:41:24.998Z",
      "cooked": "<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let frame-shape(width: 10cm, height: 5cm, radius: 15pt, a: 0pt, ..args) = {\n  set curve.quad(relative: true)\n  set curve.line(relative: true)\n  curve(\n    ..args,\n    curve.move((0pt, radius)),\n    curve.line((0pt, height - radius * 2)), // Left\n    curve.quad((-a + radius, a), (radius, radius)), // Bottom-left\n    curve.line((width - radius * 2, 0pt)), // Bottom\n    curve.quad((a, a - radius), (radius, 0pt - radius)), // Bottom-right\n    curve.line((0pt, -height + radius * 2)), // Right\n    curve.quad((a - radius, -a), (-radius, -radius)), // Top-right\n    curve.line((-width + radius * 2, 0pt)), // Top edge\n    curve.quad((-a, -a + radius), (-radius, radius)), // Top-left\n  )\n}\n\n#let frame(\n  width: 100%,\n  height: auto,\n  radius: 15pt,\n  inner: 2pt,\n  stroke: 1pt,\n  inner-stroke: 0.5pt,\n  body,\n) = {\n  layout(size =&gt; {\n    let body-block = block.with(width: width, inset: radius + inner)\n    let (height, body) = if height != auto {\n      (height, body-block(height: height, body))\n    } else {\n      let body = body-block(body)\n      (measure(body, ..size).height, body)\n    }\n    place(frame-shape(\n      width: width,\n      height: height,\n      radius: radius,\n      stroke: stroke,\n    ))\n    place(dx: inner, dy: inner, frame-shape(\n      width: width - inner * 2,\n      height: height - inner * 2,\n      radius: radius,\n      stroke: inner-stroke,\n      a: inner / 2,\n    ))\n    body\n  })\n}\n\n#set par(justify: true)\n\n#place(rect(width: 100%, height: 100%))\n#frame(lorem(50))\n#lorem(50)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/a/ac8cabcd23ad5c02454d1b5c01867ac11171e39e.png\" data-download-href=\"https://forum.typst.app/uploads/default/ac8cabcd23ad5c02454d1b5c01867ac11171e39e\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/a/ac8cabcd23ad5c02454d1b5c01867ac11171e39e_2_690x254.png\" alt=\"image\" data-base62-sha1=\"oCrvHECAmdWGDR9ICNJaIePsgnY\" width=\"690\" height=\"254\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/a/ac8cabcd23ad5c02454d1b5c01867ac11171e39e_2_690x254.png, https://forum.typst.app/uploads/default/original/2X/a/ac8cabcd23ad5c02454d1b5c01867ac11171e39e.png 1.5x, https://forum.typst.app/uploads/default/original/2X/a/ac8cabcd23ad5c02454d1b5c01867ac11171e39e.png 2x\" data-dominant-color=\"262626\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">822×303 70.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "```typ\n#let frame-shape(width: 10cm, height: 5cm, radius: 15pt, a: 0pt, ..args) = {\n  set curve.quad(relative: true)\n  set curve.line(relative: true)\n  curve(\n    ..args,\n    curve.move((0pt, radius)),\n    curve.line((0pt, height - radius * 2)), // Left\n    curve.quad((-a + radius, a), (radius, radius)), // Bottom-left\n    curve.line((width - radius * 2, 0pt)), // Bottom\n    curve.quad((a, a - radius), (radius, 0pt - radius)), // Bottom-right\n    curve.line((0pt, -height + radius * 2)), // Right\n    curve.quad((a - radius, -a), (-radius, -radius)), // Top-right\n    curve.line((-width + radius * 2, 0pt)), // Top edge\n    curve.quad((-a, -a + radius), (-radius, radius)), // Top-left\n  )\n}\n\n#let frame(\n  width: 100%,\n  height: auto,\n  radius: 15pt,\n  inner: 2pt,\n  stroke: 1pt,\n  inner-stroke: 0.5pt,\n  body,\n) = {\n  layout(size => {\n    let body-block = block.with(width: width, inset: radius + inner)\n    let (height, body) = if height != auto {\n      (height, body-block(height: height, body))\n    } else {\n      let body = body-block(body)\n      (measure(body, ..size).height, body)\n    }\n    place(frame-shape(\n      width: width,\n      height: height,\n      radius: radius,\n      stroke: stroke,\n    ))\n    place(dx: inner, dy: inner, frame-shape(\n      width: width - inner * 2,\n      height: height - inner * 2,\n      radius: radius,\n      stroke: inner-stroke,\n      a: inner / 2,\n    ))\n    body\n  })\n}\n\n#set par(justify: true)\n\n#place(rect(width: 100%, height: 100%))\n#frame(lorem(50))\n#lorem(50)\n```\n\n![image|690x254](upload://oCrvHECAmdWGDR9ICNJaIePsgnY.png)",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 26.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13213,
      "post_number": 5,
      "username": "svat",
      "name": "",
      "created_at": "2025-05-27T02:53:46.622Z",
      "updated_at": "2025-05-27T02:53:46.622Z",
      "cooked": "<p>Ah <code>width: 100%</code> was what I was missing; thank you!</p>\n<p>(Now I recall seeing example of such relative widths in the tutorial e.g. <a href=\"https://typst.app/docs/tutorial/formatting/\" class=\"inline-onebox\">Formatting – Typst Documentation</a> but I’m not sure where it’s documented more formally what <code>100%</code> means in a given context: does it always mean the width of the text block on the page? I guess it’s the current width being used to break lines in the current place, kind of like TeX’s current value of <code>\\hsize</code>.)</p>",
      "raw": "Ah `width: 100%` was what I was missing; thank you!\n\n(Now I recall seeing example of such relative widths in the tutorial e.g. https://typst.app/docs/tutorial/formatting/ but I'm not sure where it's documented more formally what `100%` means in a given context: does it always mean the width of the text block on the page? I guess it's the current width being used to break lines in the current place, kind of like TeX's current value of `\\hsize`.)",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 16.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1659
    },
    {
      "id": 13215,
      "post_number": 6,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-27T03:11:49.539Z",
      "updated_at": "2025-05-27T03:11:49.539Z",
      "cooked": "<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/docs/reference/layout/relative/\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/docs/reference/layout/relative/\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/docs/reference/layout/relative/\" target=\"_blank\" rel=\"noopener\">Relative Length Type – Typst Documentation</a></h3>\n\n  <p>Documentation for the Relative Length type.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<aside class=\"onebox githubblob\" data-onebox-src=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L11-L68\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L11-L68\" target=\"_blank\" rel=\"noopener\">github.com/typst/typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L11-L68\" target=\"_blank\" rel=\"noopener\">crates/typst-library/src/layout/rel.rs?plain=1</a></h4>\n\n<div class=\"git-blob-info\">\n  <a href=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L11-L68\" rel=\"noopener\"><code>2f1865743</code></a>\n</div>\n\n\n\n    <pre class=\"onebox\"><code class=\"lang-rs?plain=1\">\n      <ol class=\"start lines\" start=\"11\" style=\"counter-reset: li-counter 10 ;\">\n          <li>/// A length in relation to some known length.</li>\n          <li>///</li>\n          <li>/// This type is a combination of a [length] with a [ratio]. It results from</li>\n          <li>/// addition and subtraction of a length and a ratio. Wherever a relative length</li>\n          <li>/// is expected, you can also use a bare length or ratio.</li>\n          <li>///</li>\n          <li>/// # Relative to the page</li>\n          <li>/// A common use case is setting the width or height of a layout element (e.g.,</li>\n          <li>/// [block], [rect], etc.) as a certain percentage of the width of the page.</li>\n          <li>/// Here, the rectangle's width is set to `{25%}`, so it takes up one fourth of</li>\n          <li>/// the page's _inner_ width (the width minus margins).</li>\n          <li>///</li>\n          <li>/// ```example</li>\n          <li>/// #rect(width: 25%)</li>\n          <li>/// ```</li>\n          <li>///</li>\n          <li>/// Bare lengths or ratios are always valid where relative lengths are expected,</li>\n          <li>/// but the two can also be freely mixed:</li>\n          <li>/// ```example</li>\n          <li>/// #rect(width: 25% + 1cm)</li>\n      </ol>\n    </code></pre>\n\n\n  This file has been truncated. <a href=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L11-L68\" target=\"_blank\" rel=\"noopener\">show original</a>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "https://typst.app/docs/reference/layout/relative/\n\nhttps://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L11-L68",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 29,
      "score": 35.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13277,
      "post_number": 7,
      "username": "svat",
      "name": "",
      "created_at": "2025-05-27T13:55:15.783Z",
      "updated_at": "2025-05-27T13:55:15.783Z",
      "cooked": "<p><em>(Apologies if this is getting offtopic; I can start a new question or ask elsewhere if suggested…)</em></p>\n<p>Thank you; I’d read the documentation on relative lengths, but my question is more about: relative to what? For example, the source code link above suggests that often <code>25%</code>, <code>100%</code> etc are relative to “the width of the page”, but it also seems to make a distinction between that and “the page’s <em>full</em> width” (so the former apparently doesn’t include the margins). Is this documented anywhere? Also, as it says, in general these relative lengths are “relative to the container”, but how to figure out what the container is, i.e. what is the layout model? For example, in TeX: the page is a vbox made of a vertical list of hboxes (and glue), each of which was typically formed by breaking a horizontal list of boxes-and-glue (the paragraph). In Typst it appears there are different block-level elements: inline elements are collected into <a href=\"https://typst.app/docs/reference/model/par/\">paragraphs</a> but there are also <a href=\"https://typst.app/docs/reference/layout/block/\">block</a>, <a href=\"https://typst.app/docs/reference/visualize/rect/\">rect</a>, <a href=\"https://typst.app/docs/reference/layout/place/\">place</a>, etc — is there a full list of these elements somewhere? It would be useful for building a correct mental model of what’s going on, on a typical page.</p>",
      "raw": "*(Apologies if this is getting offtopic; I can start a new question or ask elsewhere if suggested…)*\n\nThank you; I'd read the documentation on relative lengths, but my question is more about: relative to what? For example, the source code link above suggests that often `25%`, `100%` etc are relative to “the width of the page”, but it also seems to make a distinction between that and “the page's _full_ width” (so the former apparently doesn't include the margins). Is this documented anywhere? Also, as it says, in general these relative lengths are “relative to the container”, but how to figure out what the container is, i.e. what is the layout model? For example, in TeX: the page is a vbox made of a vertical list of hboxes (and glue), each of which was typically formed by breaking a horizontal list of boxes-and-glue (the paragraph). In Typst it appears there are different block-level elements: inline elements are collected into [paragraphs](https://typst.app/docs/reference/model/par/) but there are also [block](https://typst.app/docs/reference/layout/block/), [rect](https://typst.app/docs/reference/visualize/rect/), [place](https://typst.app/docs/reference/layout/place/), etc — is there a full list of these elements somewhere? It would be useful for building a correct mental model of what's going on, on a typical page.",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 10.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1659
    },
    {
      "id": 13296,
      "post_number": 8,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-27T17:28:35.959Z",
      "updated_at": "2025-05-27T17:29:41.559Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"svat\" data-post=\"7\" data-topic=\"4306\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/svat/48/3123_2.png\" class=\"avatar\"> svat:</div>\n<blockquote>\n<p>I’d read the documentation on relative lengths, but my question is more about: relative to what?</p>\n</blockquote>\n</aside>\n<p>Doesn’t the documentation answers this?</p>\n<aside class=\"quote no-group\" data-username=\"svat\" data-post=\"7\" data-topic=\"4306\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/svat/48/3123_2.png\" class=\"avatar\"> svat:</div>\n<blockquote>\n<p>how to figure out what the container is</p>\n</blockquote>\n</aside>\n<p>Anything that creates a new region: rect, block, box, pad, etc. And default page/header/footer body.</p>\n<aside class=\"quote no-group\" data-username=\"svat\" data-post=\"7\" data-topic=\"4306\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/svat/48/3123_2.png\" class=\"avatar\"> svat:</div>\n<blockquote>\n<p>is there a full list of these elements somewhere?</p>\n</blockquote>\n</aside>\n<p>No, but you can request it.</p>",
      "raw": "[quote=\"svat, post:7, topic:4306\"]\nI’d read the documentation on relative lengths, but my question is more about: relative to what?\n[/quote]\n\nDoesn't the documentation answers this?\n\n[quote=\"svat, post:7, topic:4306\"]\nhow to figure out what the container is\n[/quote]\n\nAnything that creates a new region: rect, block, box, pad, etc. And default page/header/footer body.\n\n[quote=\"svat, post:7, topic:4306\"]\nis there a full list of these elements somewhere?\n[/quote]\n\nNo, but you can request it.",
      "reply_to_post_number": 7,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 26,
      "score": 10.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13319,
      "post_number": 9,
      "username": "svat",
      "name": "",
      "created_at": "2025-05-27T23:06:38.759Z",
      "updated_at": "2025-05-27T23:06:38.759Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"8\" data-topic=\"4306\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>Doesn’t the documentation answers this?</p>\n</blockquote>\n</aside>\n<p>No, it just says “A length in relation to some known length” when the crucial question is <em>what</em> the known length is. Is there some other page I should be looking at?</p>\n<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"8\" data-topic=\"4306\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>Anything that creates a new region: rect, block, box, pad, etc. And default page/header/footer body.</p>\n</blockquote>\n</aside>\n<p>Ah thanks, “region” is another term new to me that seems important to understand; what does it mean / where can I learn more about it? And what’s the difference between “page” and “body”, given that (for widths) “100% of the page” also seems to mean “100% of the body”?</p>\n<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"8\" data-topic=\"4306\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>No, but you can request it.</p>\n</blockquote>\n</aside>\n<p>Yes thanks that would be useful; where can I request this?</p>",
      "raw": "[quote=\"Andrew, post:8, topic:4306, full:true\"]\nDoesn’t the documentation answers this?\n[/quote]\n\nNo, it just says “A length in relation to some known length” when the crucial question is *what* the known length is. Is there some other page I should be looking at?\n\n[quote=\"Andrew, post:8, topic:4306, full:true\"]\nAnything that creates a new region: rect, block, box, pad, etc. And default page/header/footer body.\n[/quote]\n\nAh thanks, “region” is another term new to me that seems important to understand; what does it mean / where can I learn more about it? And what's the difference between “page” and “body”, given that (for widths) “100% of the page” also seems to mean “100% of the body”?\n\n[quote=\"Andrew, post:8, topic:4306, full:true\"]\nNo, but you can request it.\n[/quote]\n\nYes thanks that would be useful; where can I request this?",
      "reply_to_post_number": 8,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 21,
      "score": 9.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1659
    },
    {
      "id": 13352,
      "post_number": 10,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-28T12:52:49.110Z",
      "updated_at": "2025-05-28T12:52:49.110Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"svat\" data-post=\"9\" data-topic=\"4306\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/svat/48/3123_2.png\" class=\"avatar\"> svat:</div>\n<blockquote>\n<p>No, it just says “A length in relation to some known length” when the crucial question is <em>what</em> the known length is.</p>\n</blockquote>\n</aside>\n<p>This is a quote from the very first paragraph. There are 2 distinct sections that describe <em>what</em> the known length is.</p>\n<aside class=\"onebox githubblob\" data-onebox-src=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L17\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L17\" target=\"_blank\" rel=\"noopener\">github.com/typst/typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L17\" target=\"_blank\" rel=\"noopener\">crates/typst-library/src/layout/rel.rs?plain=1</a></h4>\n\n<div class=\"git-blob-info\">\n  <a href=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L17\" rel=\"noopener\"><code>2f1865743</code></a>\n</div>\n\n\n\n    <pre class=\"onebox\"><code class=\"lang-rs?plain=1\">\n      <ol class=\"start lines\" start=\"7\" style=\"counter-reset: li-counter 6 ;\">\n          <li></li>\n          <li>use crate::foundations::{cast, ty, Fold, Repr, Resolve, StyleChain};</li>\n          <li>use crate::layout::{Abs, Em, Length, Ratio};</li>\n          <li></li>\n          <li>/// A length in relation to some known length.</li>\n          <li>///</li>\n          <li>/// This type is a combination of a [length] with a [ratio]. It results from</li>\n          <li>/// addition and subtraction of a length and a ratio. Wherever a relative length</li>\n          <li>/// is expected, you can also use a bare length or ratio.</li>\n          <li>///</li>\n          <li class=\"selected\">/// # Relative to the page</li>\n          <li>/// A common use case is setting the width or height of a layout element (e.g.,</li>\n          <li>/// [block], [rect], etc.) as a certain percentage of the width of the page.</li>\n          <li>/// Here, the rectangle's width is set to `{25%}`, so it takes up one fourth of</li>\n          <li>/// the page's _inner_ width (the width minus margins).</li>\n          <li>///</li>\n          <li>/// ```example</li>\n          <li>/// #rect(width: 25%)</li>\n          <li>/// ```</li>\n          <li>///</li>\n          <li>/// Bare lengths or ratios are always valid where relative lengths are expected,</li>\n      </ol>\n    </code></pre>\n\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<aside class=\"onebox githubblob\" data-onebox-src=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L44\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L44\" target=\"_blank\" rel=\"noopener\">github.com/typst/typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L44\" target=\"_blank\" rel=\"noopener\">crates/typst-library/src/layout/rel.rs?plain=1</a></h4>\n\n<div class=\"git-blob-info\">\n  <a href=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L44\" rel=\"noopener\"><code>2f1865743</code></a>\n</div>\n\n\n\n    <pre class=\"onebox\"><code class=\"lang-rs?plain=1\">\n      <ol class=\"start lines\" start=\"34\" style=\"counter-reset: li-counter 33 ;\">\n          <li>/// width, you have a few options (this highly depends on your exact use case):</li>\n          <li>///</li>\n          <li>/// 1. Set page margins to `{0pt}` (`[#set page(margin: 0pt)]`)</li>\n          <li>/// 2. Multiply the ratio by the known full page width (`{21cm * 69%}`)</li>\n          <li>/// 3. Use padding which will negate the margins (`[#pad(x: -2.5cm, ...)]`)</li>\n          <li>/// 4. Use the page [background](page.background) or</li>\n          <li>///    [foreground](page.foreground) field as those don't take margins into</li>\n          <li>///    account (note that it will render the content outside of the document</li>\n          <li>///    flow, see [place] to control the content position)</li>\n          <li>///</li>\n          <li class=\"selected\">/// # Relative to a container</li>\n          <li>/// When a layout element (e.g. a [rect]) is nested in another layout container</li>\n          <li>/// (e.g. a [block]) instead of being a direct descendant of the page, relative</li>\n          <li>/// widths become relative to the container:</li>\n          <li>///</li>\n          <li>/// ```example</li>\n          <li>/// #block(</li>\n          <li>///   width: 100pt,</li>\n          <li>///   fill: aqua,</li>\n          <li>///   rect(width: 50%),</li>\n          <li>/// )</li>\n      </ol>\n    </code></pre>\n\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<aside class=\"quote no-group\" data-username=\"svat\" data-post=\"9\" data-topic=\"4306\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/svat/48/3123_2.png\" class=\"avatar\"> svat:</div>\n<blockquote>\n<p>“region” is another term new to me that seems important to understand; what does it mean / where can I learn more about it?</p>\n</blockquote>\n</aside>\n<p>From reading the Typst source code.</p>\n<aside class=\"onebox githubblob\" data-onebox-src=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/regions.rs?plain=1#L5-L13\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/regions.rs?plain=1#L5-L13\" target=\"_blank\" rel=\"noopener\">github.com/typst/typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/regions.rs?plain=1#L5-L13\" target=\"_blank\" rel=\"noopener\">crates/typst-library/src/layout/regions.rs?plain=1</a></h4>\n\n<div class=\"git-blob-info\">\n  <a href=\"https://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/regions.rs?plain=1#L5-L13\" rel=\"noopener\"><code>2f1865743</code></a>\n</div>\n\n\n\n    <pre class=\"onebox\"><code class=\"lang-rs?plain=1\">\n      <ol class=\"start lines\" start=\"5\" style=\"counter-reset: li-counter 4 ;\">\n          <li>/// A single region to layout into.</li>\n          <li>#[derive(Debug, Copy, Clone, Hash)]</li>\n          <li>pub struct Region {</li>\n          <li>    /// The size of the region.</li>\n          <li>    pub size: Size,</li>\n          <li>    /// Whether elements should expand to fill the regions instead of shrinking</li>\n          <li>    /// to fit the content.</li>\n          <li>    pub expand: Axes&lt;bool&gt;,</li>\n          <li>}</li>\n      </ol>\n    </code></pre>\n\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>I think the new docs should be enough for practical use. If not, then create a new issue.</p>\n<aside class=\"quote no-group\" data-username=\"svat\" data-post=\"9\" data-topic=\"4306\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/svat/48/3123_2.png\" class=\"avatar\"> svat:</div>\n<blockquote>\n<p>And what’s the difference between “page” and “body”, given that (for widths) “100% of the page” also seems to mean “100% of the body”?</p>\n</blockquote>\n</aside>\n<p>“Body” is a contextual term, page isn’t. Page’s body/footer/header have the same width of <code>page.width - page.margin.left - page.margin.right</code>.</p>\n<aside class=\"quote no-group\" data-username=\"svat\" data-post=\"9\" data-topic=\"4306\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/svat/48/3123_2.png\" class=\"avatar\"> svat:</div>\n<blockquote>\n<p>where can I request this?</p>\n</blockquote>\n</aside>\n<p><a href=\"https://github.com/typst/typst/issues/new?template=3-docs.yml\">https://github.com/typst/typst/issues/new?template=3-docs.yml</a></p>",
      "raw": "[quote=\"svat, post:9, topic:4306\"]\nNo, it just says “A length in relation to some known length” when the crucial question is *what* the known length is.\n[/quote]\n\nThis is a quote from the very first paragraph. There are 2 distinct sections that describe *what* the known length is.\n\nhttps://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L17\n\nhttps://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/rel.rs?plain=1#L44\n\n[quote=\"svat, post:9, topic:4306\"]\n“region” is another term new to me that seems important to understand; what does it mean / where can I learn more about it?\n[/quote]\n\nFrom reading the Typst source code.\n\nhttps://github.com/typst/typst/blob/2f1865743fc162682d324548da9d385a1686215f/crates/typst-library/src/layout/regions.rs?plain=1#L5-L13\n\nI think the new docs should be enough for practical use. If not, then create a new issue.\n\n[quote=\"svat, post:9, topic:4306\"]\nAnd what’s the difference between “page” and “body”, given that (for widths) “100% of the page” also seems to mean “100% of the body”?\n[/quote]\n\n\"Body\" is a contextual term, page isn't. Page's body/footer/header have the same width of `page.width - page.margin.left - page.margin.right`.\n\n[quote=\"svat, post:9, topic:4306\"]\nwhere can I request this?\n[/quote]\n\n<https://github.com/typst/typst/issues/new?template=3-docs.yml>",
      "reply_to_post_number": 9,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 20,
      "score": 4.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:47:14.995894"
}
{
  "topic_metadata": {
    "id": 4307,
    "title": "How to set different horizontal margins for footer and body?",
    "slug": "how-to-set-different-horizontal-margins-for-footer-and-body",
    "posts_count": 6,
    "created_at": "2025-05-26T19:58:46.674Z",
    "last_posted_at": "2025-05-27T08:45:05.528Z",
    "views": 56,
    "like_count": 2,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 6,
    "accepted_answer_username": "SillyFreak",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 5,
    "word_count": 636
  },
  "posts": [
    {
      "id": 13191,
      "post_number": 1,
      "username": "Gert",
      "name": "Gert",
      "created_at": "2025-05-26T19:58:46.761Z",
      "updated_at": "2025-05-27T05:07:18.240Z",
      "cooked": "<p>I’m a newbie, learning by example from the documentation and guides.</p>\n<p>In my company template (in Word) that I want to mimic in Typst, the footer is wider than the body of the text.</p>\n<p>Is it possible to have a horizontal page margin (say 5mm left and right) to allow for a wide footer and have the body typeset with larger horizontal margins (say 19mm)?</p>\n<p>Or can I have a fake footer for which I would place elements absolutely on every page (except on the titlepage)?</p>",
      "raw": "I'm a newbie, learning by example from the documentation and guides. \n\nIn my company template (in Word) that I want to mimic in Typst, the footer is wider than the body of the text. \n\nIs it possible to have a horizontal page margin (say 5mm left and right) to allow for a wide footer and have the body typeset with larger horizontal margins (say 19mm)? \n\nOr can I have a fake footer for which I would place elements absolutely on every page (except on the titlepage)?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 19.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1637
    },
    {
      "id": 13195,
      "post_number": 2,
      "username": "ssotoen",
      "name": "",
      "created_at": "2025-05-26T21:37:31.795Z",
      "updated_at": "2025-05-26T21:37:31.795Z",
      "cooked": "<p>You can insert a block with a custom width into the footer:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(\n  // needs center alignment, otherwise the block\n  // will trail off the right edge of the page\n  footer: context align(\n    center,\n    block(\n      width: page.width - 2 * 5mm,\n      // alignment is inherited, so you probably\n      // want to reset it to left\n      align(left)[\n        This footer is wider than the text area.\n      ]\n    )\n  )\n)\n</code></pre>",
      "raw": "You can insert a block with a custom width into the footer:\n\n```typ\n#set page(\n  // needs center alignment, otherwise the block\n  // will trail off the right edge of the page\n  footer: context align(\n    center,\n    block(\n      width: page.width - 2 * 5mm,\n      // alignment is inherited, so you probably\n      // want to reset it to left\n      align(left)[\n        This footer is wider than the text area.\n      ]\n    )\n  )\n)\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 3.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 331
    },
    {
      "id": 13196,
      "post_number": 3,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-05-26T21:40:31.917Z",
      "updated_at": "2025-05-26T21:40:31.917Z",
      "cooked": "<p>I set up this example document to demonstrate:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#{\n  set page(width: 10cm, height: 10cm)\n  set page(margin: (x: 19mm, y: 19mm))\n  set page(footer: {\n    show: pad.with(x: -14mm)\n    block(fill: green, width: 100%, height: 100%)[This is the footer]\n  }, background: {\n    set align(left + top)\n    block(fill: white, width: 100%, height: 100%)[This is the background]\n  })\n  block(fill: yellow, width: 100%, height: 100%)[This is the main page area]\n}\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/80cca148325120fe3017d9a92b96bdc816e49bc7.png\" data-download-href=\"https://forum.typst.app/uploads/default/80cca148325120fe3017d9a92b96bdc816e49bc7\" title=\"Scratchpad(3)\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/80cca148325120fe3017d9a92b96bdc816e49bc7_2_375x375.png\" alt=\"Scratchpad(3)\" data-base62-sha1=\"inpx6E9jmV3tVvNHtRgkjUbpijZ\" width=\"375\" height=\"375\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/8/80cca148325120fe3017d9a92b96bdc816e49bc7_2_375x375.png, https://forum.typst.app/uploads/default/optimized/2X/8/80cca148325120fe3017d9a92b96bdc816e49bc7_2_562x562.png 1.5x, https://forum.typst.app/uploads/default/original/2X/8/80cca148325120fe3017d9a92b96bdc816e49bc7.png 2x\" data-dominant-color=\"E9E976\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Scratchpad(3)</span><span class=\"informations\">567×567 30.2 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Drawing a little is useful to see what’s going on. I used your desired margin of 19mm, but with a smaller page size just to make demonstration easier.</p>\n<p>As you can see we can add negative padding to the footer, that should pull it out horizontally so that effectively there’s only 5 mm x-margin left for the footer while rest of the page uses the configured 19mm margin.</p>",
      "raw": "I set up this example document to demonstrate:\n\n```typst\n#{\n  set page(width: 10cm, height: 10cm)\n  set page(margin: (x: 19mm, y: 19mm))\n  set page(footer: {\n    show: pad.with(x: -14mm)\n    block(fill: green, width: 100%, height: 100%)[This is the footer]\n  }, background: {\n    set align(left + top)\n    block(fill: white, width: 100%, height: 100%)[This is the background]\n  })\n  block(fill: yellow, width: 100%, height: 100%)[This is the main page area]\n}\n```\n\n![Scratchpad(3)|500x500, 75%](upload://inpx6E9jmV3tVvNHtRgkjUbpijZ.png)\n\nDrawing a little is useful to see what's going on. I used your desired margin of 19mm, but with a smaller page size just to make demonstration easier.\n\nAs you can see we can add negative padding to the footer, that should pull it out horizontally so that effectively there's only 5 mm x-margin left for the footer while rest of the page uses the configured 19mm margin.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 13197,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-26T21:52:50.993Z",
      "updated_at": "2025-05-26T21:55:13.717Z",
      "cooked": "<p>Hello. If the footer must be wider than the page body, then you will have to use something like <a href=\"https://typst.app/docs/reference/layout/pad/\"><code>pad</code></a> inside the <a href=\"https://typst.app/docs/reference/layout/page/#parameters-footer\"><code>page.footer</code></a>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(margin: (x: 19mm, y: 2cm), footer: context {\n  pad(x: -page.margin.left + 5mm, counter(page).display())\n})\n</code></pre>\n<p>Here is a visual example:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(margin: (x: 19mm, y: 2cm))\n#set page(footer: context {\n  let page-number = counter(page).display()\n  let margin = 5mm\n  // pad(x: -page.margin.left + margin, rect(width: 100%, height: 100%))\n  // pad(x: -page.margin.left + margin, page-number)\n  pad(x: -page.margin.left + margin, {\n    block(width: 100%, height: 100%, stroke: 1pt, page-number)\n  })\n})\n#set page(background: rect(width: 100%, height: 100%))\n#place(rect(width: 100%, height: 100%))\n#lorem(100)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/7/70a46678c4ab3b5317995934a69eacfd92f0e13c.png\" data-download-href=\"https://forum.typst.app/uploads/default/70a46678c4ab3b5317995934a69eacfd92f0e13c\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/7/70a46678c4ab3b5317995934a69eacfd92f0e13c_2_354x500.png\" alt=\"image\" data-base62-sha1=\"g4tHz33USPPRb2GTgNRNqh5S1YM\" width=\"354\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/7/70a46678c4ab3b5317995934a69eacfd92f0e13c_2_354x500.png, https://forum.typst.app/uploads/default/optimized/2X/7/70a46678c4ab3b5317995934a69eacfd92f0e13c_2_531x750.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/7/70a46678c4ab3b5317995934a69eacfd92f0e13c_2_708x1000.png 2x\" data-dominant-color=\"121212\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">740×1044 46.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p><a href=\"https://typst.app/docs/reference/layout/page/#parameters-footer-descent\"><code>page.footer-descent</code></a></p>",
      "raw": "Hello. If the footer must be wider than the page body, then you will have to use something like [`pad`](https://typst.app/docs/reference/layout/pad/) inside the [`page.footer`](https://typst.app/docs/reference/layout/page/#parameters-footer).\n\n```typ\n#set page(margin: (x: 19mm, y: 2cm), footer: context {\n  pad(x: -page.margin.left + 5mm, counter(page).display())\n})\n```\n\nHere is a visual example:\n\n```typ\n#set page(margin: (x: 19mm, y: 2cm))\n#set page(footer: context {\n  let page-number = counter(page).display()\n  let margin = 5mm\n  // pad(x: -page.margin.left + margin, rect(width: 100%, height: 100%))\n  // pad(x: -page.margin.left + margin, page-number)\n  pad(x: -page.margin.left + margin, {\n    block(width: 100%, height: 100%, stroke: 1pt, page-number)\n  })\n})\n#set page(background: rect(width: 100%, height: 100%))\n#place(rect(width: 100%, height: 100%))\n#lorem(100)\n```\n\n![image|354x500](upload://g4tHz33USPPRb2GTgNRNqh5S1YM.png)\n\n[`page.footer-descent`](https://typst.app/docs/reference/layout/page/#parameters-footer-descent)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 18,
      "score": 23.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13233,
      "post_number": 5,
      "username": "Gert",
      "name": "Gert",
      "created_at": "2025-05-27T08:21:52.889Z",
      "updated_at": "2025-05-27T08:21:52.889Z",
      "cooked": "<p>Thank you for your quick responses. So far, three solutions (TIMTOWTDI :-) ). As a newbie, I have no idea how similar they are conceptually and if there is a “preference” for one of the three…</p>",
      "raw": "Thank you for your quick responses. So far, three solutions (TIMTOWTDI :-) ). As a newbie, I have no idea how similar they are conceptually and if there is a \"preference\" for one of the three...",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 8.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1637
    },
    {
      "id": 13235,
      "post_number": 6,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-05-27T08:45:05.528Z",
      "updated_at": "2025-05-27T08:45:05.528Z",
      "cooked": "<p>I think there are two aspects here:</p>\n<p><em>How to get the desired footer width:</em></p>\n<ul>\n<li>bluss sets the width manually based on your numbers</li>\n<li>ssotoen uses <code>context</code> and <code>page.width</code></li>\n<li>Andrew uses <code>context</code> and<code>page.margin</code></li>\n</ul>\n<p>The first is a bit simpler, until you change the margins. Then having the <code>context</code> will save you some extra work.</p>\n<p><em>How to size the footer:</em></p>\n<ul>\n<li>ssotoen just overflows the footer: the block is explicitly wider than the footer. For that to work, the block is centered (so it overflows equally on both sides), and then inside the block, content is left-aligned again.</li>\n<li>bluss and Andrew both use padding to fit more into the footer space. IMO this is the cleaner solution, since it works without overflowing.</li>\n</ul>\n<p>In total I’d probably go with Andrew’s solution. It’s basically the same as bluss’s, but it is more “automatic” by using <code>context</code> <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "I think there are two aspects here:\n\n_How to get the desired footer width:_\n- bluss sets the width manually based on your numbers\n- ssotoen uses `context` and `page.width`\n- Andrew uses `context` and`page.margin`\n\nThe first is a bit simpler, until you change the margins. Then having the `context` will save you some extra work.\n\n_How to size the footer:_\n- ssotoen just overflows the footer: the block is explicitly wider than the footer. For that to work, the block is centered (so it overflows equally on both sides), and then inside the block, content is left-aligned again.\n- bluss and Andrew both use padding to fit more into the footer space. IMO this is the cleaner solution, since it works without overflowing.\n\nIn total I'd probably go with Andrew's solution. It's basically the same as bluss's, but it is more \"automatic\" by using `context` :slight_smile:",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 16,
      "score": 28.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:47:14.232619"
}
