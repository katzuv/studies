{
  "topic_metadata": {
    "id": 3947,
    "title": "Can alignment be changed from the 2nd line on in a paragraph?",
    "slug": "can-alignment-be-changed-from-the-2nd-line-on-in-a-paragraph",
    "posts_count": 5,
    "created_at": "2025-05-06T10:03:16.663Z",
    "last_posted_at": "2025-05-06T12:19:14.005Z",
    "views": 50,
    "like_count": 5,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "sijo",
    "tags": [
      "alignment",
      "text"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 291
  },
  "posts": [
    {
      "id": 12028,
      "post_number": 1,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2025-05-06T10:03:16.772Z",
      "updated_at": "2025-05-09T13:54:36.111Z",
      "cooked": "<p>I’d like to achieve the following:</p>\n<ul>\n<li>The first line is left-aligned</li>\n<li>If the text spills onto the second line, it should be right-aligned from the second line on.</li>\n</ul>\n<p>Something like that:</p>\n<pre data-code-wrap=\"txt\"><code class=\"lang-txt\">Forever young\nI want to be forever young\nDo you really want to live \n                   forever?\nForever and ever\n</code></pre>\n<p>Is this possible (without inserting linebreaks etc. manually)?</p>",
      "raw": "I'd like to achieve the following: \n- The first line is left-aligned\n- If the text spills onto the second line, it should be right-aligned from the second line on. \n\nSomething like that:\n```txt\nForever young\nI want to be forever young\nDo you really want to live \n                   forever?\nForever and ever\n```\n\nIs this possible (without inserting linebreaks etc. manually)?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 28.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    },
    {
      "id": 12029,
      "post_number": 2,
      "username": "sijo",
      "name": "",
      "created_at": "2025-05-06T11:23:05.343Z",
      "updated_at": "2025-05-06T11:23:54.880Z",
      "cooked": "<p>Why would the first line stop at “young” if you don’t have a manual linebreak? (I’m trying to understand the desired output)</p>",
      "raw": "Why would the first line stop at \"young\" if you don't have a manual linebreak? (I'm trying to understand the desired output)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 8.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 12035,
      "post_number": 3,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2025-05-06T11:34:35.591Z",
      "updated_at": "2025-05-06T11:50:34.646Z",
      "cooked": "<p>Ah yes. My example has four lines of the chorus of that song. It happens to be that the third line is too long to fit the container width, so the line is broken. What I want is that the broken part is right-aligned. So basically similar to a <code>hanging-indent</code> but a “hanging-alignment”.</p>\n<p>Edit: I have tried to work with lists here (but with an insivible marker) but for those not even <code>set par(hanging-indent: true)</code> works.</p>",
      "raw": "Ah yes. My example has four lines of the chorus of that song. It happens to be that the third line is too long to fit the container width, so the line is broken. What I want is that the broken part is right-aligned. So basically similar to a `hanging-indent` but a \"hanging-alignment\".\n\n\nEdit: I have tried to work with lists here (but with an insivible marker) but for those not even `set par(hanging-indent: true)` works.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 8.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    },
    {
      "id": 12037,
      "post_number": 4,
      "username": "sijo",
      "name": "",
      "created_at": "2025-05-06T12:07:15.155Z",
      "updated_at": "2025-05-06T12:07:21.602Z",
      "cooked": "<p>For justified text you could do something like</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(width: 6cm)\n#set par(justify: true)\n\n#let f(it) = layout(size =&gt; {\n   it.children.split(linebreak()).map(array.join).map(x =&gt; {\n      if measure(x).width &gt; size.width {\n         box(width: 100%, align(right, x))\n      } else {\n         x + linebreak()\n      }\n   }).join()\n})\n\n#f[\n   Forever young\\\n   I want to be forever young\\\n   Do you really want to live forever?\\\n   Forever and ever\n]\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/7/75977a0f2bc166f46ccf4d4c166872298eed71ea.png\" alt=\"image\" data-base62-sha1=\"gMgoTF1n85C8blNOUAeylBtjKdQ\" width=\"210\" height=\"122\"></p>\n<p>but for ragged text I don’t know… It seems that this would require hooking up into the paragraph shaping algorithm, after the linebreaks have been decided but before the final result. You can do this in LuaTeX but I don’t think Typst supports that yet.</p>",
      "raw": "For justified text you could do something like\n\n```typ\n#set page(width: 6cm)\n#set par(justify: true)\n\n#let f(it) = layout(size => {\n   it.children.split(linebreak()).map(array.join).map(x => {\n      if measure(x).width > size.width {\n         box(width: 100%, align(right, x))\n      } else {\n         x + linebreak()\n      }\n   }).join()\n})\n\n#f[\n   Forever young\\\n   I want to be forever young\\\n   Do you really want to live forever?\\\n   Forever and ever\n]\n```\n\n![image|280x163, 75%](upload://gMgoTF1n85C8blNOUAeylBtjKdQ.png)\n\nbut for ragged text I don't know... It seems that this would require hooking up into the paragraph shaping algorithm, after the linebreaks have been decided but before the final result. You can do this in LuaTeX but I don't think Typst supports that yet.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 4,
      "reads": 15,
      "score": 98.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 12041,
      "post_number": 5,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2025-05-06T12:19:14.005Z",
      "updated_at": "2025-05-06T12:19:14.005Z",
      "cooked": "<p>Thank you, this works for me!</p>",
      "raw": "Thank you, this works for me!",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 14,
      "score": 17.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    }
  ],
  "scraped_at": "2025-06-10T09:48:17.227131"
}
{
  "topic_metadata": {
    "id": 3949,
    "title": "Can Typst detect the current column?",
    "slug": "can-typst-detect-the-current-column",
    "posts_count": 2,
    "created_at": "2025-05-06T11:25:52.434Z",
    "last_posted_at": "2025-05-06T11:33:42.928Z",
    "views": 40,
    "like_count": 1,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "sijo",
    "tags": [
      "layout",
      "layout-containers"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 170
  },
  "posts": [
    {
      "id": 12031,
      "post_number": 1,
      "username": "Hurtleberry",
      "name": "Hurtleberry",
      "created_at": "2025-05-06T11:25:52.592Z",
      "updated_at": "2025-05-06T11:25:52.592Z",
      "cooked": "<p>I have a two-column layout. I’d like to insert symbols in the appropriate margin (left or right) at certain points in the text. Ideally I could do this automatically. Automatically adding symbols is straightforward, but I’m not sure of the best way to automatically determine the appropriate margin to place them in.</p>\n<p>Currently I’m using</p>\n<pre><code class=\"lang-auto\">  set text(blue)\n  underline(overline[*#words*])\n  place(left, dy: -1.5em, dx: -1.5cm, block(image(\"Handout.png\", width: 1cm)))\n}\n</code></pre>\n<p>to insert the images whenever I tag a keyword.</p>\n<p>I think I could use <strong>location</strong> and then run calculations vs. page size to work out whether it’s the left or right column, and place it appropriately, but if there’s a more elegant way that would be great.</p>",
      "raw": "I have a two-column layout. I'd like to insert symbols in the appropriate margin (left or right) at certain points in the text. Ideally I could do this automatically. Automatically adding symbols is straightforward, but I'm not sure of the best way to automatically determine the appropriate margin to place them in.\n\nCurrently I'm using \n```#let hd(words) = {\n  set text(blue)\n  underline(overline[*#words*])\n  place(left, dy: -1.5em, dx: -1.5cm, block(image(\"Handout.png\", width: 1cm)))\n}\n```\n\nto insert the images whenever I tag a keyword.\n\nI think I could use **location** and then run calculations vs. page size to work out whether it's the left or right column, and place it appropriately, but if there's a more elegant way that would be great.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 14.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1553
    },
    {
      "id": 12034,
      "post_number": 2,
      "username": "sijo",
      "name": "",
      "created_at": "2025-05-06T11:33:42.928Z",
      "updated_at": "2025-05-06T12:45:21.520Z",
      "cooked": "<p>Hi, welcome to the Typst forum! The idea you suggest is the only way I know of to do this. Note that you can get the current location with the <a href=\"https://typst.app/docs/reference/introspection/here/\">here</a> function.</p>",
      "raw": "Hi, welcome to the Typst forum! The idea you suggest is the only way I know of to do this. Note that you can get the current location with the [here](https://typst.app/docs/reference/introspection/here/) function.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 22,
      "score": 24.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 332
    }
  ],
  "scraped_at": "2025-06-10T09:48:16.515186"
}
{
  "topic_metadata": {
    "id": 3950,
    "title": "How to add chapter names to header or footers?",
    "slug": "how-to-add-chapter-names-to-header-or-footers",
    "posts_count": 8,
    "created_at": "2025-05-06T11:28:08.747Z",
    "last_posted_at": "2025-05-14T07:16:48.619Z",
    "views": 199,
    "like_count": 4,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "vmartel08",
    "tags": [
      "header-footer"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 318
  },
  "posts": [
    {
      "id": 12032,
      "post_number": 1,
      "username": "Andrew_Duncan",
      "name": "Andrew Duncan",
      "created_at": "2025-05-06T11:28:08.850Z",
      "updated_at": "2025-05-06T16:25:33.511Z",
      "cooked": "<p>I have made a typst research document (10 chapters), and I need to dynamically add the chapter name to the footer for each chapter. Can you please help me with this. Thank you.</p>",
      "raw": "I have made a typst research document (10 chapters), and I need to dynamically add the chapter name to the footer for each chapter. Can you please help me with this. Thank you.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 39,
      "score": 367.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1560
    },
    {
      "id": 12060,
      "post_number": 2,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-05-06T16:22:42.351Z",
      "updated_at": "2025-05-06T16:22:42.351Z",
      "cooked": "<p>Hi there <a class=\"mention\" href=\"/u/andrew_duncan\">@Andrew_Duncan</a>, welcome to the Typst Forum.</p>\n<p>Packages like <a href=\"https://typst.app/universe/package/chic-hdr\" class=\"inline-onebox\">chic-hdr – Typst Universe</a> and <a href=\"https://typst.app/universe/package/hydra\" class=\"inline-onebox\">hydra – Typst Universe</a> will provide the functionality you are looking for.</p>\n<p>Also, if you search on the forum for either <em>footer</em> or <em>header</em>, you will find lots of examples relating to your question, such as:</p>\n<aside class=\"quote\" data-post=\"1\" data-topic=\"2992\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/i/85291D/48.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/how-to-set-headers-and-page-numbers-with-alternating-text-on-even-and-odd-pages/2992\">How to set headers and page numbers with alternating text on even and odd pages?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    I want to set my book template to show even pages aligned left with “# | chapter number” and odd pages aligned right with “book title | #”, but I can’t quite figure out how within the header/page numbering documentation. \nmost likely will need separate sections for each chapter, but that’s fine. \nalso want the page numbers to start on the first chapter (page 7 in the file) and preferably be hidden on blank pages\n  </blockquote>\n</aside>\n\n<p>Also: <a href=\"https://typst.app/docs/guides/page-setup-guide/#specific-pages\" class=\"inline-onebox\">Page setup guide – Typst Documentation</a> will give you hints on how to achieve this manually.</p>",
      "raw": "Hi there @Andrew_Duncan, welcome to the Typst Forum. \n\nPackages like https://typst.app/universe/package/chic-hdr and https://typst.app/universe/package/hydra will provide the functionality you are looking for. \n\nAlso, if you search on the forum for either _footer_ or _header_, you will find lots of examples relating to your question, such as:\n\nhttps://forum.typst.app/t/how-to-set-headers-and-page-numbers-with-alternating-text-on-even-and-odd-pages/2992?u=vmartel08\n\nAlso: https://typst.app/docs/guides/page-setup-guide/#specific-pages will give you hints on how to achieve this manually.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 38,
      "score": 42.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 12068,
      "post_number": 4,
      "username": "Andrew_Duncan",
      "name": "Andrew Duncan",
      "created_at": "2025-05-06T18:34:33.598Z",
      "updated_at": "2025-05-06T18:34:33.598Z",
      "cooked": "<p>Thank you for the clarifications.</p>",
      "raw": "Thank you for the clarifications.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 36,
      "score": 12.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1560
    },
    {
      "id": 12112,
      "post_number": 5,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-05-07T21:59:51.456Z",
      "updated_at": "2025-05-07T21:59:51.456Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/andrew_duncan\">@Andrew_Duncan</a> also check this post <a href=\"https://forum.typst.app/t/why-does-my-header-code-no-longer-work-in-typst-0-13/3940/2\" class=\"inline-onebox\">Why does my header code no longer work in Typst 0.13? - #2 by Andrew</a> which has a useful snippet if you want to do it without a package:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let current-chapter-title() = context {\n  let headings = query(heading.where(level: 1).before(here()))\n  if headings == () { panic(\"At least one heading must be defined.\") }\n  headings.last().body\n}\n\n#set page(footer: current-chapter-title())\n\n= Heading\n\n</code></pre>\n<p>Have you found a solution that works for you?</p>",
      "raw": "@Andrew_Duncan also check this post https://forum.typst.app/t/why-does-my-header-code-no-longer-work-in-typst-0-13/3940/2?u=vmartel08 which has a useful snippet if you want to do it without a package:\n\n```typ\n#let current-chapter-title() = context {\n  let headings = query(heading.where(level: 1).before(here()))\n  if headings == () { panic(\"At least one heading must be defined.\") }\n  headings.last().body\n}\n\n#set page(footer: current-chapter-title())\n\n= Heading\n\n``` \n\nHave you found a solution that works for you?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 31,
      "score": 46.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 12187,
      "post_number": 6,
      "username": "Andrew_Duncan",
      "name": "Andrew Duncan",
      "created_at": "2025-05-09T14:11:23.588Z",
      "updated_at": "2025-05-09T14:11:23.588Z",
      "cooked": "<p>Thank you for the hint. This solution is simple, it shows the current chapter title in the footer. Typst package chic-hdr looks good as well.</p>",
      "raw": "Thank you for the hint. This solution is simple, it shows the current chapter title in the footer. Typst package chic-hdr looks good as well.",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 9.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1560
    },
    {
      "id": 12188,
      "post_number": 7,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-05-09T14:18:43.654Z",
      "updated_at": "2025-05-09T14:18:43.654Z",
      "cooked": "<p>Please mark the post you consider the closest answer to your question with a <img src=\"https://forum.typst.app/images/emoji/apple/white_check_mark.png?v=12\" title=\":white_check_mark:\" class=\"emoji\" alt=\":white_check_mark:\" loading=\"lazy\" width=\"20\" height=\"20\"> to flag it as a solution for others to find it in the future <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"> Tks</p>",
      "raw": "Please mark the post you consider the closest answer to your question with a :white_check_mark: to flag it as a solution for others to find it in the future :slight_smile: Tks",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 20,
      "score": 48.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 12392,
      "post_number": 8,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-05-13T17:23:43.245Z",
      "updated_at": "2025-05-13T17:23:43.245Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/andrew_duncan\">@Andrew_Duncan</a>, glad you got a satisfying answer! I’ve marked it <img src=\"https://forum.typst.app/images/emoji/apple/white_check_mark.png?v=12\" title=\":white_check_mark:\" class=\"emoji\" alt=\":white_check_mark:\" loading=\"lazy\" width=\"20\" height=\"20\"> as the solution, so that others can more easily find it later – don’t forget next time <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hi @Andrew_Duncan, glad you got a satisfying answer! I’ve marked it :white_check_mark: as the solution, so that others can more easily find it later – don’t forget next time :slight_smile:",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 15,
      "score": 7.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 12426,
      "post_number": 9,
      "username": "Andrew_Duncan",
      "name": "Andrew Duncan",
      "created_at": "2025-05-14T07:16:48.619Z",
      "updated_at": "2025-05-14T07:16:48.619Z",
      "cooked": "<p>Hi,<br>\nThank you for the tip.<br>\nKind regards</p>",
      "raw": "Hi,\nThank you for the tip.\nKind regards",
      "reply_to_post_number": 8,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 15,
      "score": 2.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1560
    }
  ],
  "scraped_at": "2025-06-10T09:48:15.605918"
}
{
  "topic_metadata": {
    "id": 3958,
    "title": "How to display a zero-level chapter (with figure) in the PDF outline?",
    "slug": "how-to-display-a-zero-level-chapter-with-figure-in-the-pdf-outline",
    "posts_count": 3,
    "created_at": "2025-05-06T13:41:45.380Z",
    "last_posted_at": "2025-05-06T15:55:13.070Z",
    "views": 36,
    "like_count": 0,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "flokl",
    "tags": [
      "scripting",
      "figures"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 212
  },
  "posts": [
    {
      "id": 12046,
      "post_number": 1,
      "username": "bowentan",
      "name": "Bowen",
      "created_at": "2025-05-06T13:41:45.553Z",
      "updated_at": "2025-05-06T13:41:45.553Z",
      "cooked": "<p>I followed the guide book for <a href=\"https://sitandr.github.io/typst-examples-book/book/typstonomicon/chapters.html\" rel=\"noopener nofollow ugc\">zero-chapter</a>. But I found the chapter levels not expectedly listed in the outline of PDF viewer, which was like:<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/0/0b3fa6b94ed8a96e49da30a1c43cdb0a8b068816.png\" alt=\"CleanShot 2025-05-06 at 21.37.56@2x\" data-base62-sha1=\"1BvCI7zGwDDXK2vnbNE0cvg0sTQ\" width=\"664\" height=\"240\"></p>\n<p>Is there any way to list the chapter level as the first level in PDF outline? Like the following:</p>\n<pre data-code-wrap=\"txt\"><code class=\"lang-txt\">|- I Chapter\n|--- Chap Heading\n|----- Sub Heading\n|- II Chapter again\n|--- Chap Heading\n|--- Chap Heading\n|----- Sub Heading\n|------- Sub Sub Heading\n</code></pre>\n<p>according to the guide.</p>",
      "raw": "I followed the guide book for [zero-chapter](https://sitandr.github.io/typst-examples-book/book/typstonomicon/chapters.html). But I found the chapter levels not expectedly listed in the outline of PDF viewer, which was like:\n![CleanShot 2025-05-06 at 21.37.56@2x|664x240](upload://1BvCI7zGwDDXK2vnbNE0cvg0sTQ.png)\n\nIs there any way to list the chapter level as the first level in PDF outline? Like the following:\n```txt\n|- I Chapter\n|--- Chap Heading\n|----- Sub Heading\n|- II Chapter again\n|--- Chap Heading\n|--- Chap Heading\n|----- Sub Heading\n|------- Sub Sub Heading\n```\naccording to the guide.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 48.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1554
    },
    {
      "id": 12054,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2025-05-06T15:31:25.356Z",
      "updated_at": "2025-05-06T15:32:38.655Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/bowentan\">@bowentan</a>, there was just recently a showcase post about it here <a href=\"https://forum.typst.app/t/part-independent-section/3906\" class=\"inline-onebox\">Part independent section</a>. I personally use:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let chapter(body) = heading(level: 1, body)\n\n#set heading(\n  offset: 1,\n  numbering: (chap, ..nums) =&gt; {\n  if nums.pos().len() == 0 {\n    numbering(\"I\", chap)\n  } else {\n    numbering(\"1.1\", ..nums)\n  }\n})\n\n#outline()\n\n\n#chapter[Chapter One]\n= Section One\n== Subsection\n#chapter[Chapter Two]\n= Section One\n== Subsection\n= Section Two\n</code></pre>\n<p>Typst does currently not include the numbering in the PDF bookmarks, see <a href=\"https://github.com/typst/typst/issues/2416\">#2416</a>.</p>",
      "raw": "Hi @bowentan, there was just recently a showcase post about it here https://forum.typst.app/t/part-independent-section/3906?u=flokl. I personally use:\n```typ\n#let chapter(body) = heading(level: 1, body)\n\n#set heading(\n  offset: 1,\n  numbering: (chap, ..nums) => {\n  if nums.pos().len() == 0 {\n    numbering(\"I\", chap)\n  } else {\n    numbering(\"1.1\", ..nums)\n  }\n})\n\n#outline()\n\n\n#chapter[Chapter One]\n= Section One\n== Subsection\n#chapter[Chapter Two]\n= Section One\n== Subsection\n= Section Two\n```\nTypst does currently not include the numbering in the PDF bookmarks, see [#2416](https://github.com/typst/typst/issues/2416).",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 13.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 12057,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-06T15:55:13.070Z",
      "updated_at": "2025-05-06T15:55:13.070Z",
      "cooked": "<p>You can post this variation in <a href=\"https://forum.typst.app/t/part-independent-section/3906\" class=\"inline-onebox\">Part independent section</a>, as closely related. Easier to find both under one topic. Some might prefer one or another.</p>",
      "raw": "You can post this variation in https://forum.typst.app/t/part-independent-section/3906, as closely related. Easier to find both under one topic. Some might prefer one or another.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 3.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:48:14.877158"
}
{
  "topic_metadata": {
    "id": 3975,
    "title": "How to define document metadata once and access it in other functions?",
    "slug": "how-to-define-document-metadata-once-and-access-it-in-other-functions",
    "posts_count": 5,
    "created_at": "2025-05-07T06:59:32.270Z",
    "last_posted_at": "2025-05-07T16:38:37.146Z",
    "views": 71,
    "like_count": 2,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "aarnent",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 326
  },
  "posts": [
    {
      "id": 12077,
      "post_number": 1,
      "username": "fungai2000",
      "name": "",
      "created_at": "2025-05-07T06:59:32.367Z",
      "updated_at": "2025-05-13T17:05:50.616Z",
      "cooked": "<p>In my main.typ file, I have defined my document’s metadata:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set document(\n  title: [My book],\n  author: \"Name Surname\",\n  description: [Abstract],\n  date: auto\n)\n</code></pre>\n<p>Is there a way to access the values of the title, author, etc. in other functions?</p>\n<p>At the moment, I am defining the same title, author, etc. information again in <code>let</code> functions, and then accessing those when I come to create my title and front matter pages.</p>",
      "raw": "In my main.typ file, I have defined my document's metadata:\n\n```typ\n#set document(\n  title: [My book],\n  author: \"Name Surname\",\n  description: [Abstract],\n  date: auto\n)\n```\n\nIs there a way to access the values of the title, author, etc. in other functions?\n\nAt the moment, I am defining the same title, author, etc. information again in `let` functions, and then accessing those when I come to create my title and front matter pages.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 119.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 1518
    },
    {
      "id": 12079,
      "post_number": 2,
      "username": "aarnent",
      "name": "",
      "created_at": "2025-05-07T07:29:04.634Z",
      "updated_at": "2025-05-07T07:31:21.815Z",
      "cooked": "<p>You can access these using <a href=\"https://typst.app/docs/reference/context/\">context</a>. So for example,</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#context document.title\n</code></pre>\n<p>Or if you want to use those values in a function, do</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let my-func(arg) = context {\n    // stuff here\n    let title = document.title\n    // more stuff here\n}\n</code></pre>\n<p>BTW, you can make your code blocks have correct syntax highlighting by adding the <code>typ</code> tag, like</p>\n<pre><code class=\"lang-auto\">```typ\n\n```\n</code></pre>",
      "raw": "You can access these using [context](https://typst.app/docs/reference/context/). So for example,\n\n```typst\n#context document.title\n```\n\nOr if you want to use those values in a function, do\n\n```typst\n#let my-func(arg) = context {\n    // stuff here\n    let title = document.title\n    // more stuff here\n}\n```\n\nBTW, you can make your code blocks have correct syntax highlighting by adding the `typ` tag, like\n\n````\n```typ\n\n```\n````",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 22,
      "score": 19.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 501
    },
    {
      "id": 12081,
      "post_number": 3,
      "username": "fungai2000",
      "name": "",
      "created_at": "2025-05-07T08:42:15.071Z",
      "updated_at": "2025-05-13T17:06:33.072Z",
      "cooked": "<p>Thank you very much for this!</p>\n<p>It seems to work perfectly for content blocks (like the title or description in my example above). However, for strings (like the author), I am getting the following output on my title page:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">(\"Name Surname\",)\n</code></pre>\n<p>rather than:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">Name Surname\n</code></pre>\n<p>Aside from the <code>#set document</code> function I already mentioned above, I have the following in my file:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let author(content) = context {\n  set text(size: 12pt)\n  document.author\n}\n</code></pre>\n<p>and on the title page:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#title[]\n#subtitle[]\n#author[]\n</code></pre>\n<p>Might you have an idea what I am doing wrong or how to solve for this?</p>",
      "raw": "Thank you very much for this!\n\nIt seems to work perfectly for content blocks (like the title or description in my example above). However, for strings (like the author), I am getting the following output on my title page:\n\n```typc\n(\"Name Surname\",)\n```\nrather than:\n```typ\nName Surname\n```\n\nAside from the `#set document` function I already mentioned above, I have the following in my file:\n\n```typ\n#let author(content) = context {\n  set text(size: 12pt)\n  document.author\n}\n```\nand on the title page:\n```typ\n#title[]\n#subtitle[]\n#author[]\n```\n\nMight you have an idea what I am doing wrong or how to solve for this?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 8.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 1518
    },
    {
      "id": 12101,
      "post_number": 4,
      "username": "fungai2000",
      "name": "",
      "created_at": "2025-05-07T15:51:35.138Z",
      "updated_at": "2025-05-07T15:58:27.238Z",
      "cooked": "<p>I seem to have stumbled upon the answer over on the <a href=\"https://discord.com/channels/1054443721975922748/1088371919725793360/1226168847908999249\" rel=\"noopener nofollow ugc\">Discord channel</a> by <a class=\"mention\" href=\"/u/dipamsen\">@dipamsen</a> :</p>\n<pre><code class=\"lang-auto\">document.author.first()\n</code></pre>\n<p>It is explained there that <code>author</code> is actually a list of strings for multiple authors, so the <code>first</code> command gets the first element in the list.</p>\n<p>Thanks to both <a class=\"mention\" href=\"/u/aarnent\">@aarnent</a> and <a class=\"mention\" href=\"/u/dipamsen\">@dipamsen</a> for getting me to the goal.</p>",
      "raw": "I seem to have stumbled upon the answer over on the [Discord channel](https://discord.com/channels/1054443721975922748/1088371919725793360/1226168847908999249) by @dipamsen :\n\n```(typ)\ndocument.author.first()\n```\n\nIt is explained there that `author` is actually a list of strings for multiple authors, so the `first` command gets the first element in the list. \n\nThanks to both @aarnent and @dipamsen for getting me to the goal.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 3.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 1518
    },
    {
      "id": 12108,
      "post_number": 5,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-05-07T16:38:37.146Z",
      "updated_at": "2025-05-07T16:38:37.146Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/fungai2000\">@fungai2000</a>, glad you managed to solve it. I’ve marked <a class=\"mention\" href=\"/u/aarnent\">@aarnent</a>’s answer as a solution - let me know if you still need further help.</p>",
      "raw": "Hey @fungai2000, glad you managed to solve it. I've marked @aarnent's answer as a solution - let me know if you still need further help.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 18.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:48:14.165868"
}
{
  "topic_metadata": {
    "id": 3983,
    "title": "How can I create graphical elements in a loop?",
    "slug": "how-can-i-create-graphical-elements-in-a-loop",
    "posts_count": 5,
    "created_at": "2025-05-07T15:25:43.003Z",
    "last_posted_at": "2025-05-13T19:55:44.634Z",
    "views": 97,
    "like_count": 5,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "janekfleper",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 390
  },
  "posts": [
    {
      "id": 12089,
      "post_number": 1,
      "username": "Lukipuki",
      "name": "Lukas",
      "created_at": "2025-05-07T15:25:43.144Z",
      "updated_at": "2025-05-07T15:26:32.066Z",
      "cooked": "<p>I try to create n little colored squares aligned in a horizontal line. I seem to fail in every way that I try. Adding squares to a list seems impossible. My latest attempt was to map from a range to squares:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let n = 5\n#range(n).map(ang =&gt; [#square(fill: color.hsl(ang * 1deg, 100%, 50%))])\n</code></pre>\n<p>I get the following output (sorry, I cannot copy the code).<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/3/36b3b05f3b17ea657b9e3558b0bc78530725588a.png\" alt=\"Screenshot 2025-05-07 171947\" data-base62-sha1=\"7NULrt9miCQ1mMJfthJNkZ30GEy\" width=\"347\" height=\"110\"><br>\nthe squares are not rendered somehow. What am I doing wrong here?</p>\n<p>I want to align the squares inside a math function (in color though)</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$ f( #sym.qed #sym.qed ... ) $\n</code></pre>",
      "raw": "I try to create n little colored squares aligned in a horizontal line. I seem to fail in every way that I try. Adding squares to a list seems impossible. My latest attempt was to map from a range to squares:\n```typ\n#let n = 5\n#range(n).map(ang => [#square(fill: color.hsl(ang * 1deg, 100%, 50%))])\n```\nI get the following output (sorry, I cannot copy the code).\n![Screenshot 2025-05-07 171947|347x110](upload://7NULrt9miCQ1mMJfthJNkZ30GEy.png)\nthe squares are not rendered somehow. What am I doing wrong here?\n\nI want to align the squares inside a math function (in color though)\n```typ\n$ f( #sym.qed #sym.qed ... ) $\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 76.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1568
    },
    {
      "id": 12104,
      "post_number": 2,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-05-07T15:52:10.276Z",
      "updated_at": "2025-05-07T17:27:31.963Z",
      "cooked": "<p>The function <code>.map()</code> always returns an array, see <a href=\"https://typst.app/docs/reference/foundations/array/#definitions-map\" class=\"inline-onebox\">Array Type – Typst Documentation</a>. If you want to turn the array into content, you could for example use the function <code>.join()</code> or pass the array elements to the function <code>stack()</code>. There might be even more options to actually show the squares, but this should be enough to get you started.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let n = 5\n#let squares = range(n).map(ang =&gt; [#square(fill: color.hsl(ang * 1deg, 100%, 50%))])\n#squares.join()\n#stack(dir: ltr, spacing: 1em, ..squares)\n</code></pre>\n<p>Note that you could also change the color of the symbol <code>sym.qed</code> if you don’t want to draw arbitrary shapes. If all symbols should have the same color, you can use a show-set rule</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show sym.qed: set text(red)\n$ f( #sym.qed #sym.qed ... ) $\n</code></pre>\n<p>If you want to color the qed symbols individually, you can define a function that returns the symbol in a specific color</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let c-qed(color) = text(color, sym.qed)\n$ f( #c-qed(blue) #c-qed(red) ... ) $\n</code></pre>",
      "raw": "The function `.map()` always returns an array, see https://typst.app/docs/reference/foundations/array/#definitions-map. If you want to turn the array into content, you could for example use the function `.join()` or pass the array elements to the function `stack()`. There might be even more options to actually show the squares, but this should be enough to get you started.\n\n```typ\n#let n = 5\n#let squares = range(n).map(ang => [#square(fill: color.hsl(ang * 1deg, 100%, 50%))])\n#squares.join()\n#stack(dir: ltr, spacing: 1em, ..squares)\n```\n\nNote that you could also change the color of the symbol `sym.qed` if you don't want to draw arbitrary shapes. If all symbols should have the same color, you can use a show-set rule\n\n```typ\n#show sym.qed: set text(red)\n$ f( #sym.qed #sym.qed ... ) $\n```\n\nIf you want to color the qed symbols individually, you can define a function that returns the symbol in a specific color\n\n```typ\n#let c-qed(color) = text(color, sym.qed)\n$ f( #c-qed(blue) #c-qed(red) ... ) $\n```",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 3,
      "reads": 32,
      "score": 61.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 12120,
      "post_number": 3,
      "username": "Lukipuki",
      "name": "Lukas",
      "created_at": "2025-05-08T15:43:38.692Z",
      "updated_at": "2025-05-08T15:43:38.692Z",
      "cooked": "<p>thank you very much!<br>\nThat is really helpful!</p>",
      "raw": "thank you very much!\nThat is really helpful!",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 9.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1568
    },
    {
      "id": 12408,
      "post_number": 4,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-05-13T19:54:50.121Z",
      "updated_at": "2025-05-13T19:54:50.121Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"janekfleper\" data-post=\"2\" data-topic=\"3983\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/j/8F38B1/48.png\" class=\"avatar\"> janekfleper:</div>\n<blockquote>\n<p>f you want to turn the array into content, you could for example use the function <code>.join()</code></p>\n</blockquote>\n</aside>\n<p>Note you can also use a for loop instead. Basically, these two are equivalent:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">range(n).map(i =&gt; ...).join()\n// and\nfor i in range(n) { ... }\n</code></pre>",
      "raw": "[quote=\"janekfleper, post:2, topic:3983\"]\nf you want to turn the array into content, you could for example use the function `.join()`\n[/quote]\n\nNote you can also use a for loop instead. Basically, these two are equivalent:\n```typc\nrange(n).map(i => ...).join()\n// and\nfor i in range(n) { ... }\n```",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 2,
      "reads": 15,
      "score": 33.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 12409,
      "post_number": 5,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-05-13T19:55:44.634Z",
      "updated_at": "2025-05-13T19:55:44.634Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/lukipuki\">@Lukipuki</a>, if you feel the response you got has sufficiently answered your question, be sure to give it a checkmark <img src=\"https://forum.typst.app/images/emoji/apple/ballot_box_with_check.png?v=12\" title=\":ballot_box_with_check:\" class=\"emoji\" alt=\":ballot_box_with_check:\" loading=\"lazy\" width=\"20\" height=\"20\">. This will help others find the solution in the future. If something is missing, please let us know what so we can resolve your issue. Thanks!</p>",
      "raw": "Hi @Lukipuki, if you feel the response you got has sufficiently answered your question, be sure to give it a checkmark :ballot_box_with_check:. This will help others find the solution in the future. If something is missing, please let us know what so we can resolve your issue. Thanks!",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 15,
      "score": 3.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:48:13.442783"
}
{
  "topic_metadata": {
    "id": 3984,
    "title": "How to `show` an outline at each level 1 heading for all its child headings?",
    "slug": "how-to-show-an-outline-at-each-level-1-heading-for-all-its-child-headings",
    "posts_count": 4,
    "created_at": "2025-05-07T18:29:50.054Z",
    "last_posted_at": "2025-05-09T11:17:48.504Z",
    "views": 85,
    "like_count": 5,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "Andrew",
    "tags": [
      "outline"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 398
  },
  "posts": [
    {
      "id": 12110,
      "post_number": 1,
      "username": "miles-1",
      "name": "miles",
      "created_at": "2025-05-07T18:29:50.214Z",
      "updated_at": "2025-05-13T17:19:48.389Z",
      "cooked": "<p>I am hoping to use a <code>show</code> rule to insert an outline at each level 1 heading, where these outlines only show the child headings of each level 1 heading. In other words (assuming no deeper heading levels than 2), for each level 1 heading there should be one outline which shows all the level 2 headings that occur before the next level 1 heading. The idea is like a section table of contents.</p>\n<p>I’ve found something that works, but I’m worried I’m overcomplicating things. <strong>Is there an easier way to do this?</strong></p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set heading(numbering: \"(1.1)\")\n\n#show heading.where(level:1): it =&gt; {\n  it\n  let future-level-1-headings = query(selector(heading.where(level:1)).after(here(), inclusive: false))\n  let child-heading-selector = selector(heading.where(level:2)).after(here())\n  outline(\n    title:none, \n    target: if future-level-1-headings.len() &gt; 0 {\n      child-heading-selector.before(future-level-1-headings.at(0).location())\n    } else {\n      child-heading-selector\n    }\n  )\n}\n\n=\n==\n==\n==\n=\n==\n==\n==\n=\n==\n==\n==\n</code></pre>\n<p>Here are some things I can see that would make this easier:</p>\n<ol>\n<li>a way to select children headers directly instead of between</li>\n<li>a <code>location</code> object like the one returned for <code>here()</code> except for the end of the document (would help simplify the <code>if</code> statement)</li>\n<li>a way to get the subsequent level one heading directly</li>\n</ol>\n<p><strong>Are any of these listed options possible in typst?</strong></p>",
      "raw": "I am hoping to use a `show` rule to insert an outline at each level 1 heading, where these outlines only show the child headings of each level 1 heading. In other words (assuming no deeper heading levels than 2), for each level 1 heading there should be one outline which shows all the level 2 headings that occur before the next level 1 heading. The idea is like a section table of contents.\n\nI've found something that works, but I'm worried I'm overcomplicating things. **Is there an easier way to do this?**\n\n```typst\n#set heading(numbering: \"(1.1)\")\n\n#show heading.where(level:1): it => {\n  it\n  let future-level-1-headings = query(selector(heading.where(level:1)).after(here(), inclusive: false))\n  let child-heading-selector = selector(heading.where(level:2)).after(here())\n  outline(\n    title:none, \n    target: if future-level-1-headings.len() > 0 {\n      child-heading-selector.before(future-level-1-headings.at(0).location())\n    } else {\n      child-heading-selector\n    }\n  )\n}\n\n=\n==\n==\n==\n=\n==\n==\n==\n=\n==\n==\n==\n```\n\nHere are some things I can see that would make this easier:\n1. a way to select children headers directly instead of between \n2. a `location` object like the one returned for `here()` except for the end of the document (would help simplify the `if` statement)\n3. a way to get the subsequent level one heading directly\n\n**Are any of these listed options possible in typst?**",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 155.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 177
    },
    {
      "id": 12111,
      "post_number": 2,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-05-07T19:08:57.598Z",
      "updated_at": "2025-05-07T19:08:57.598Z",
      "cooked": "<p>You can use a show rule for the outline entries that hides the sections from other chapters. I will leave the decision whether this is simpler than your current solution up to you. <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading.where(level: 1): it =&gt; {\n  it\n\n  let heading-number = counter(heading).get().at(0)\n  show outline.entry: it =&gt; {\n    if counter(heading).at(it.element.location()).at(0) == heading-number { it }\n  }\n\n  outline(\n    title: none, \n    target: heading.where(level: 2)\n  )\n}\n</code></pre>\n<p>I would also ask you to change the category of your post to <a class=\"hashtag-cooked\" href=\"/c/questions/5\" data-type=\"category\" data-slug=\"questions\" data-id=\"5\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>Questions</span></a>.</p>",
      "raw": "You can use a show rule for the outline entries that hides the sections from other chapters. I will leave the decision whether this is simpler than your current solution up to you. :slight_smile:\n\n```typ\n#show heading.where(level: 1): it => {\n  it\n\n  let heading-number = counter(heading).get().at(0)\n  show outline.entry: it => {\n    if counter(heading).at(it.element.location()).at(0) == heading-number { it }\n  }\n\n  outline(\n    title: none, \n    target: heading.where(level: 2)\n  )\n}\n```\n\nI would also ask you to change the category of your post to #questions.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 28,
      "score": 35.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 12176,
      "post_number": 3,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-05-09T10:43:45.090Z",
      "updated_at": "2025-05-09T10:43:45.090Z",
      "cooked": "<p>For future reference, an unmaintained package exists under the name <a href=\"https://typst.app/universe/package/minitoc/\">“minitoc”</a>, which uses the first approach (query heading in-between).</p>\n<p>I find <a class=\"mention\" href=\"/u/janekfleper\">@janekfleper</a>’s approach much more elegant though!</p>",
      "raw": "For future reference, an unmaintained package exists under the name [\"minitoc\"](https://typst.app/universe/package/minitoc/), which uses the first approach (query heading in-between).\n\nI find @janekfleper's approach much more elegant though!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 9.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 12181,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-09T11:17:48.504Z",
      "updated_at": "2025-05-09T11:17:48.504Z",
      "cooked": "<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/suboutline:0.3.0\": suboutline\n#set heading(numbering: \"1.1.\")\n#show heading.where(level: 1): it =&gt; it + suboutline()\n\n= Heading\n== Heading\n#lorem(20)\n\n=== Heading\n#lorem(30)\n\n== Heading\n#lorem(10)\n\n= Heading 2\n== Heading\n#lorem(20)\n\n=== Heading\n#lorem(30)\n\n== Heading\n#lorem(10)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/4/4dd01b864f88c9dc500315ff4696d84f9323aa4d.png\" data-download-href=\"https://forum.typst.app/uploads/default/4dd01b864f88c9dc500315ff4696d84f9323aa4d\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/4/4dd01b864f88c9dc500315ff4696d84f9323aa4d_2_352x374.png\" alt=\"image\" data-base62-sha1=\"b6mDhgY0BbdaIRZBhSjHfSJ1V8N\" width=\"352\" height=\"374\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/4/4dd01b864f88c9dc500315ff4696d84f9323aa4d_2_352x374.png, https://forum.typst.app/uploads/default/optimized/2X/4/4dd01b864f88c9dc500315ff4696d84f9323aa4d_2_528x561.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/4/4dd01b864f88c9dc500315ff4696d84f9323aa4d_2_704x748.png 2x\" data-dominant-color=\"0B0B0B\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">760×807 103 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "```typ\n#import \"@preview/suboutline:0.3.0\": suboutline\n#set heading(numbering: \"1.1.\")\n#show heading.where(level: 1): it => it + suboutline()\n\n= Heading\n== Heading\n#lorem(20)\n\n=== Heading\n#lorem(30)\n\n== Heading\n#lorem(10)\n\n= Heading 2\n== Heading\n#lorem(20)\n\n=== Heading\n#lorem(30)\n\n== Heading\n#lorem(10)\n```\n\n![image|470x499, 75%](upload://b6mDhgY0BbdaIRZBhSjHfSJ1V8N.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 22,
      "score": 49.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:48:12.685678"
}
{
  "topic_metadata": {
    "id": 3987,
    "title": "How to create something like #emph, but it jumps to a certain place in the pdf?",
    "slug": "how-to-create-something-like-emph-but-it-jumps-to-a-certain-place-in-the-pdf",
    "posts_count": 15,
    "created_at": "2025-05-08T08:04:17.026Z",
    "last_posted_at": "2025-05-12T09:39:53.590Z",
    "views": 141,
    "like_count": 5,
    "reply_count": 13,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 13,
    "accepted_answer_username": "Eric",
    "tags": [
      "scripting",
      "referencing"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 1034
  },
  "posts": [
    {
      "id": 12115,
      "post_number": 1,
      "username": "Amasica",
      "name": "Erik Oberländer",
      "created_at": "2025-05-08T08:04:17.173Z",
      "updated_at": "2025-05-13T19:18:08.656Z",
      "cooked": "<p>How can I create something like <span class=\"hashtag-raw\">#emph</span>, where, when I press on it in the final pdf, it jumps to where it was mentioned first in maybe a <span class=\"hashtag-raw\">#define</span> thing in the pdf?</p>\n<p>Kinda like refs, but a little different</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">== Definition (strict)\nA function is called #define[strict], if $epi(f)$ is a strict set\n\n== Example\n$f(x) := x^2$ is a #word[strict] function</code></pre>",
      "raw": "How can I create something like #emph, where, when I press on it in the final pdf, it jumps to where it was mentioned first in maybe a #define thing in the pdf?\n\nKinda like refs, but a little different\n\n```typ\n== Definition (strict)\nA function is called #define[strict], if $epi(f)$ is a strict set\n\n== Example\n$f(x) := x^2$ is a #word[strict] function",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 49,
      "score": 54.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1438
    },
    {
      "id": 12116,
      "post_number": 2,
      "username": "sijo",
      "name": "",
      "created_at": "2025-05-08T08:19:34.235Z",
      "updated_at": "2025-05-08T08:19:34.235Z",
      "cooked": "<p>You can create links with the <code>link</code> function, and generate a label for each definition using the <code>label</code> function:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let define(it) = [#emph(it)#label(\"define:\" + it.text)]\n#let word(it) = link(label(\"define:\" + it.text), emph(it))\n\n#let epi = math.op(\"epi\")\n\n== Definition (strict)\nA function is called #define[strict], if $epi(f)$ is a strict set\n\n#pagebreak()\n\n== Example\n$f(x) := x^2$ is a #word[strict] function\n</code></pre>",
      "raw": "You can create links with the `link` function, and generate a label for each definition using the `label` function:\n\n```typ\n#let define(it) = [#emph(it)#label(\"define:\" + it.text)]\n#let word(it) = link(label(\"define:\" + it.text), emph(it))\n\n#let epi = math.op(\"epi\")\n\n== Definition (strict)\nA function is called #define[strict], if $epi(f)$ is a strict set\n\n#pagebreak()\n\n== Example\n$f(x) := x^2$ is a #word[strict] function\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 49,
      "score": 14.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 12124,
      "post_number": 3,
      "username": "Amasica",
      "name": "Erik Oberländer",
      "created_at": "2025-05-08T16:26:40.168Z",
      "updated_at": "2025-05-08T16:26:40.168Z",
      "cooked": "<p>Ok that works pretty well, but could you also somehow just make a function which creates a label and then just reference it normally?</p>\n<p>I tried ti do it myself, but I can’t get around the limit that you can’t label text<br>\nIs there something invisible you can reference? That would be extremely helpful</p>",
      "raw": "Ok that works pretty well, but could you also somehow just make a function which creates a label and then just reference it normally?\n\nI tried ti do it myself, but I can't get around the limit that you can't label text\nIs there something invisible you can reference? That would be extremely helpful",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 42,
      "score": 13.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1438
    },
    {
      "id": 12129,
      "post_number": 4,
      "username": "sijo",
      "name": "",
      "created_at": "2025-05-08T18:32:30.048Z",
      "updated_at": "2025-05-08T18:32:30.048Z",
      "cooked": "<p>Can you show a minimal example of what you tried that doesn’t work?</p>",
      "raw": "Can you show a minimal example of what you tried that doesn't work?",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 41,
      "score": 13.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 12130,
      "post_number": 5,
      "username": "Amasica",
      "name": "Erik Oberländer",
      "created_at": "2025-05-08T18:49:40.154Z",
      "updated_at": "2025-05-08T18:49:40.154Z",
      "cooked": "<p>I tried a lot of things, but mainly just figures (I sadly don’t have the code anymore as it was very frustrating), but these had the problem that they caused newlines and when I hid them, the reference didn’t work because it was attached to nothing.</p>\n<p>I also prompted ChatGPT and Gemini, but they tried to use metadata(), but this also can’t be referenced.</p>\n<p>Basically the only thing I need is either an invisible figure I can reference and then actually use the reference or the ability to reference words.</p>",
      "raw": "I tried a lot of things, but mainly just figures (I sadly don't have the code anymore as it was very frustrating), but these had the problem that they caused newlines and when I hid them, the reference didn't work because it was attached to nothing.\n\nI also prompted ChatGPT and Gemini, but they tried to use metadata(), but this also can't be referenced.\n\nBasically the only thing I need is either an invisible figure I can reference and then actually use the reference or the ability to reference words.",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 39,
      "score": 17.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1438
    },
    {
      "id": 12131,
      "post_number": 6,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2025-05-08T19:12:01.391Z",
      "updated_at": "2025-05-08T19:12:01.391Z",
      "cooked": "<p>With a show rule on <code>ref</code>, you can allow references on all kinds of elements, so you can do something like this.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let define(word) = emph[#word#label(word.text)]\n\n#show ref: it =&gt; {\n  if query(it.target) == ([#str(it.target)],) {\n    // The only element with the target label is the\n    // definition text containing the label name, so\n    // just show and link to that definition.\n    emph(link(it.target, str(it.target)))\n  } else {\n    it\n  }\n}\n</code></pre>\n<p>Then, you can combine the <code>#define[..]</code> function call with normal references like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">== Definition (strict)\nA function is called #define[strict], if $epi(f)$ is a strict set\n\n== Example\n$f(x) := x^2$ is a @strict function\n</code></pre>",
      "raw": "With a show rule on `ref`, you can allow references on all kinds of elements, so you can do something like this.\n\n```typ\n#let define(word) = emph[#word#label(word.text)]\n\n#show ref: it => {\n  if query(it.target) == ([#str(it.target)],) {\n    // The only element with the target label is the\n    // definition text containing the label name, so\n    // just show and link to that definition.\n    emph(link(it.target, str(it.target)))\n  } else {\n    it\n  }\n}\n```\n\nThen, you can combine the `#define[..]` function call with normal references like this:\n```typ\n== Definition (strict)\nA function is called #define[strict], if $epi(f)$ is a strict set\n\n== Example\n$f(x) := x^2$ is a @strict function\n```",
      "reply_to_post_number": 5,
      "reply_count": 3,
      "quote_count": 0,
      "like_count": 2,
      "reads": 37,
      "score": 52.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 12133,
      "post_number": 7,
      "username": "Amasica",
      "name": "Erik Oberländer",
      "created_at": "2025-05-08T19:30:59.834Z",
      "updated_at": "2025-05-08T19:30:59.834Z",
      "cooked": "<p>Thanks that works great, now how can I add something like an empty reference? I tried to add an input parameter and that worked, but if I understand your logic correctly, it won’t work when every invisible Label has the same invisible character</p>",
      "raw": "Thanks that works great, now how can I add something like an empty reference? I tried to add an input parameter and that worked, but if I understand your logic correctly, it won't work when every invisible Label has the same invisible character",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 11.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1438
    },
    {
      "id": 12134,
      "post_number": 8,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2025-05-08T19:44:48.653Z",
      "updated_at": "2025-05-08T19:44:48.653Z",
      "cooked": "<p>I’m not sure what to imagine by an empty reference, as there has to be some way you want to identify what to link to.</p>",
      "raw": "I'm not sure what to imagine by an empty reference, as there has to be some way you want to identify what to link to.",
      "reply_to_post_number": 7,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 11.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 12138,
      "post_number": 9,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-08T20:43:35.755Z",
      "updated_at": "2025-05-08T20:43:35.755Z",
      "cooked": "<p>Inversion condition makes it shorter and easier to read (well, not the <code>([#str(it.target)],)</code> part):</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show ref: it =&gt; {\n  if query(it.target) != ([#str(it.target)],) { return it }\n  // The only element with the target label is the\n  // definition text containing the label name, so\n  // just show and link to that definition.\n  emph(link(it.target, str(it.target)))\n}\n</code></pre>",
      "raw": "Inversion condition makes it shorter and easier to read (well, not the `([#str(it.target)],)` part):\n\n```typ\n#show ref: it => {\n  if query(it.target) != ([#str(it.target)],) { return it }\n  // The only element with the target label is the\n  // definition text containing the label name, so\n  // just show and link to that definition.\n  emph(link(it.target, str(it.target)))\n}\n```",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 6.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12161,
      "post_number": 10,
      "username": "Amasica",
      "name": "Erik Oberländer",
      "created_at": "2025-05-09T05:42:24.332Z",
      "updated_at": "2025-05-09T05:42:24.332Z",
      "cooked": "<p>Like an empty character I can put somewhere with a reference</p>",
      "raw": "Like an empty character I can put somewhere with a reference",
      "reply_to_post_number": 8,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 5.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1438
    },
    {
      "id": 12163,
      "post_number": 11,
      "username": "Amasica",
      "name": "Erik Oberländer",
      "created_at": "2025-05-09T06:13:57.399Z",
      "updated_at": "2025-05-09T06:13:57.399Z",
      "cooked": "<p>Actually, how could you make this work with stuff with space in them (for example in my case “strict convex”), I tried replacing \" \" with “-” and then converting it back but I’m not sure how to implement that logic</p>",
      "raw": "Actually, how could you make this work with stuff with space in them (for example in my case \"strict convex\"), I tried replacing \" \" with \"-\" and then converting it back but I'm not sure how to implement that logic",
      "reply_to_post_number": 6,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 15.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1438
    },
    {
      "id": 12180,
      "post_number": 12,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-09T11:01:23.670Z",
      "updated_at": "2025-05-09T11:01:23.670Z",
      "cooked": "<p>You can’t use sugar syntax for referencing such labels.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#figure[] #label(\" \")\n#ref(label(\" \"))\n</code></pre>\n<aside class=\"onebox githubissue\" data-onebox-src=\"https://github.com/typst/typst/issues/5776#issuecomment-2629114366\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/typst/typst/issues/5776#issuecomment-2629114366\" target=\"_blank\" rel=\"noopener\">github.com/typst/typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"github-row\">\n  <div class=\"github-icon-container\" title=\"Issue\" data-github-private-repo=\"false\">\n\t  <svg width=\"60\" height=\"60\" class=\"github-icon\" viewBox=\"0 0 14 16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg>\n  </div>\n\n  <div class=\"github-info-container\">\n    <h4>\n      <a href=\"https://github.com/typst/typst/issues/5776#issuecomment-2629114366\" target=\"_blank\" rel=\"noopener\">Empty labels should not be allowed</a>\n    </h4>\n\n    <div class=\"github-info\">\n      <div class=\"date\">\n        opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2025-01-29\" data-time=\"11:23:30\" data-timezone=\"UTC\">11:23AM - 29 Jan 25 UTC</span>\n      </div>\n\n\n      <div class=\"user\">\n        <a href=\"https://github.com/EpicEricEE\" target=\"_blank\" rel=\"noopener\">\n          <img alt=\"EpicEricEE\" src=\"https://forum.typst.app/uploads/default/original/1X/c05c45e6fc6b38b34566598ca5e8d323040f8d3e.png\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\" data-dominant-color=\"1E1E1E\">\n          EpicEricEE\n        </a>\n      </div>\n    </div>\n\n    <div class=\"labels\">\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          scripting\n        </span>\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          syntax\n        </span>\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          change request\n        </span>\n    </div>\n  </div>\n</div>\n\n  <div class=\"github-row\">\n    <p class=\"github-body-container\">### Description\n\nAttaching an empty label to a figure (or other element) as in\n`<span class=\"show-more-container\"><a href=\"\" rel=\"noopener\" class=\"show-more\">…</a></span><span class=\"excerpt hidden\">``typ\n#figure(rect(), caption: [...]) #label(\"\")\n```\nallows you to reference it with just `@`, which should probably not be allowed.\n\n### Reproduction URL\n\n_No response_\n\n### Operating system\n\nWeb app, Windows\n\n### Typst version\n\n- [x] I am using the latest version of Typst</span></p>\n  </div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "You can't use sugar syntax for referencing such labels.\n\n```typ\n#figure[] #label(\" \")\n#ref(label(\" \"))\n```\n\nhttps://github.com/typst/typst/issues/5776#issuecomment-2629114366",
      "reply_to_post_number": 11,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 6.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12193,
      "post_number": 13,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2025-05-09T16:50:05.393Z",
      "updated_at": "2025-05-09T16:52:10.632Z",
      "cooked": "<p>I see, that is also possible. Here is a more robust (and slightly more complex) way that allows arbitrary content in definitions and automatically attaches usable labels (with hyphens instead of spaces and other non-letter characters):</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let to-label(body) = {\n  // Convert body to string, replace non-letter characters with\n  // hyphens, and ensure that it doesn't end with a hyphen.\n  import \"@preview/t4t:0.4.2\": get\n  label(get.text(body)\n    .replace(regex(\"[^\\p{L}\\p{N}\\-]+\"), \"-\")\n    .trim(\"-\", at: end))\n}\n\n#let define(word) = emph[#word#to-label(word)]\n\n#show ref: it =&gt; {\n  // Elements that are referencable by default and whose\n  // reference appearance should not be overridden.\n  let referencable = (figure, math.equation, heading, footnote)\n  \n  if it.element == none { return it }\n  if it.element.func() in referencable { return it }\n  if it.target != to-label(it.element) { return it }\n  // If the target element's body matches the label, show the\n  // reference as the element's body linked to the definition.\n  emph(link(it.target, it.element))\n}\n</code></pre>\n<p>This would allow referencing something like <code>#define[strict convex]</code> with <code>@strict-convex</code>.</p>\n<details>\n<summary>\nQuick note why <code>referencable</code> elements are excluded\n</summary>\n<p>To not intefere with standard references, elements which are already referencable are excluded. For example, in the case</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#figure(rect[Hello], caption: [A rectangle.]) &lt;Hello&gt;\n</code></pre>\n<p>the label <code>&lt;Hello&gt;</code> matches the text inside the rectangle, so the figure would have mistakenly been treated as a definition, replacing the “Figure 1” with a copy of the figure itself.</p>\n</details>",
      "raw": "I see, that is also possible. Here is a more robust (and slightly more complex) way that allows arbitrary content in definitions and automatically attaches usable labels (with hyphens instead of spaces and other non-letter characters):\n```typ\n#let to-label(body) = {\n  // Convert body to string, replace non-letter characters with\n  // hyphens, and ensure that it doesn't end with a hyphen.\n  import \"@preview/t4t:0.4.2\": get\n  label(get.text(body)\n    .replace(regex(\"[^\\p{L}\\p{N}\\-]+\"), \"-\")\n    .trim(\"-\", at: end))\n}\n\n#let define(word) = emph[#word#to-label(word)]\n\n#show ref: it => {\n  // Elements that are referencable by default and whose\n  // reference appearance should not be overridden.\n  let referencable = (figure, math.equation, heading, footnote)\n  \n  if it.element == none { return it }\n  if it.element.func() in referencable { return it }\n  if it.target != to-label(it.element) { return it }\n  // If the target element's body matches the label, show the\n  // reference as the element's body linked to the definition.\n  emph(link(it.target, it.element))\n}\n```\n\nThis would allow referencing something like `#define[strict convex]` with `@strict-convex`.\n\n<details>\n<summary>\nQuick note why <code>referencable</code> elements are excluded\n</summary>\n\nTo not intefere with standard references, elements which are already referencable are excluded. For example, in the case\n```typ\n#figure(rect[Hello], caption: [A rectangle.]) <Hello>\n```\nthe label `<Hello>` matches the text inside the rectangle, so the figure would have mistakenly been treated as a definition, replacing the \"Figure 1\" with a copy of the figure itself.\n\n</details>",
      "reply_to_post_number": 11,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 27,
      "score": 40.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 12325,
      "post_number": 14,
      "username": "Amasica",
      "name": "Erik Oberländer",
      "created_at": "2025-05-12T09:23:29.016Z",
      "updated_at": "2025-05-12T09:23:29.016Z",
      "cooked": "<p>And could there be a way to reference something invisible?<br>\nLike I tried it with a figure, but then the ref part doesn’t work anymore</p>",
      "raw": "And could there be a way to reference something invisible?\nLike I tried it with a figure, but then the ref part doesn't work anymore",
      "reply_to_post_number": 13,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 9.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1438
    },
    {
      "id": 12328,
      "post_number": 15,
      "username": "Amasica",
      "name": "Erik Oberländer",
      "created_at": "2025-05-12T09:39:53.590Z",
      "updated_at": "2025-05-13T19:18:35.769Z",
      "cooked": "<p>Actually nevermind, I got it to work with</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">show ref: it =&gt; {\n    if it.element.has(\"body\") and it.element.body == [ ] {\n      return emph(link(it.target, label-to-string(it.target)), bold: false)\n    } \n    \n    let referencable = (figure, math.equation, heading, footnote)\n    \n    if it.element == none { return it }\n    if it.element.func() in referencable { return it }\n    if it.target != to-label(it.element) { return it }\n    \n    emph(link(it.target, it.element), bold: false)\n  }\n</code></pre>\n<p>and</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let to-label(body) = {\n  // Convert body to string, replace non-letter characters with\n  // hyphens, and ensure that it doesn't end with a hyphen.\n  import \"@preview/t4t:0.4.2\": get\n  label(get.text(body)\n    .replace(regex(\"[^\\p{L}\\p{N}\\-]+\"), \"-\")\n    .trim(\"-\", at: end))\n}\n\n#let label-to-string(string) = str(string).replace(\"-\", \" \")\n\n#let define(word, hide: false) = {\n  if hide {\n    [\n      #figure(\n        [ ],\n      )\n      #to-label(word)\n      #v(0fr)\n    ]\n    // emph[#word#to-label(word)]\n  } else {\n    emph[#word#to-label(word)]\n  }\n}\n\n</code></pre>",
      "raw": "Actually nevermind, I got it to work with \n\n```typc\nshow ref: it => {\n    if it.element.has(\"body\") and it.element.body == [ ] {\n      return emph(link(it.target, label-to-string(it.target)), bold: false)\n    } \n    \n    let referencable = (figure, math.equation, heading, footnote)\n    \n    if it.element == none { return it }\n    if it.element.func() in referencable { return it }\n    if it.target != to-label(it.element) { return it }\n    \n    emph(link(it.target, it.element), bold: false)\n  }\n```\n\nand\n\n```typ\n#let to-label(body) = {\n  // Convert body to string, replace non-letter characters with\n  // hyphens, and ensure that it doesn't end with a hyphen.\n  import \"@preview/t4t:0.4.2\": get\n  label(get.text(body)\n    .replace(regex(\"[^\\p{L}\\p{N}\\-]+\"), \"-\")\n    .trim(\"-\", at: end))\n}\n\n#let label-to-string(string) = str(string).replace(\"-\", \" \")\n\n#let define(word, hide: false) = {\n  if hide {\n    [\n      #figure(\n        [ ],\n      )\n      #to-label(word)\n      #v(0fr)\n    ]\n    // emph[#word#to-label(word)]\n  } else {\n    emph[#word#to-label(word)]\n  }\n}\n\n```",
      "reply_to_post_number": 14,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 4.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1438
    }
  ],
  "scraped_at": "2025-06-10T09:48:11.956228"
}
{
  "topic_metadata": {
    "id": 3992,
    "title": "How to show Roman and Arabic page numbers correctly in the table of contents?",
    "slug": "how-to-show-roman-and-arabic-page-numbers-correctly-in-the-table-of-contents",
    "posts_count": 2,
    "created_at": "2025-05-08T16:46:58.003Z",
    "last_posted_at": "2025-05-08T17:04:02.975Z",
    "views": 58,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Eric",
    "tags": [
      "outline",
      "numbering"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 343
  },
  "posts": [
    {
      "id": 12127,
      "post_number": 1,
      "username": "sabo28",
      "name": "",
      "created_at": "2025-05-08T16:46:58.100Z",
      "updated_at": "2025-05-13T17:07:47.353Z",
      "cooked": "<p>Hi everyone,</p>\n<p>I’m working on a document in Typst where I want to use different page numbering styles:</p>\n<ul>\n<li>The <strong>front matter</strong> (e.g. table of contents) should use <strong>Roman numerals</strong> (I, II, III, …).</li>\n<li>The <strong>main content</strong> should use <strong>Arabic numerals</strong> (1, 2, 3, …).</li>\n<li>In the <strong>footer</strong>, this works fine with:</li>\n</ul>\n<pre><code class=\"lang-auto\">#set page(footer: context [\n  #set text(size: 10pt)\n  #align(center)[#counter(page).display(\"I\")]\n])\n</code></pre>\n<p>However, the problem is that in the <strong>table of contents</strong> (<code>#outline()</code>), the page numbers are <strong>still displayed in Arabic numerals</strong>, even if they are shown in Roman numerals in the footer.</p>\n<p>Important notes:<br>\nI can’t use <code>#set page(numbering: \"I\")</code> because I need the <strong>page numbers to be displayed in 10pt font</strong>, and this setting doesn’t allow me to control the text size of the numbers in the footer.</p>\n<p>Is there a way to make <code>#outline()</code> reflect the <strong>actual display format</strong> of the page numbers – Roman or Arabic – depending on the section? In other words: Can I make the page numbers in the TOC match what is shown in the footer?</p>\n<p>And if this isn’t directly supported, is there a workaround (e.g. with <code>#show outline.entry</code> or <code>counter(page).at(...)</code>) to conditionally change the format shown in the TOC based on section or page number?</p>\n<p>Thanks in advance for your help! <img src=\"https://forum.typst.app/images/emoji/apple/pray.png?v=12\" title=\":pray:\" class=\"emoji\" alt=\":pray:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hi everyone,\n\nI'm working on a document in Typst where I want to use different page numbering styles:\n\n* The **front matter** (e.g. table of contents) should use **Roman numerals** (I, II, III, …).\n* The **main content** should use **Arabic numerals** (1, 2, 3, …).\n* In the **footer**, this works fine with:\n```\n#set page(footer: context [\n  #set text(size: 10pt)\n  #align(center)[#counter(page).display(\"I\")]\n])\n```\nHowever, the problem is that in the **table of contents** (`#outline()`), the page numbers are **still displayed in Arabic numerals**, even if they are shown in Roman numerals in the footer.\n\nImportant notes:\nI can't use `#set page(numbering: \"I\")` because I need the **page numbers to be displayed in 10pt font**, and this setting doesn't allow me to control the text size of the numbers in the footer.\n\nIs there a way to make `#outline()` reflect the **actual display format** of the page numbers – Roman or Arabic – depending on the section? In other words: Can I make the page numbers in the TOC match what is shown in the footer?\n\nAnd if this isn't directly supported, is there a workaround (e.g. with `#show outline.entry` or `counter(page).at(...)`) to conditionally change the format shown in the TOC based on section or page number?\n\nThanks in advance for your help! 🙏",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 159.0,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1571
    },
    {
      "id": 12128,
      "post_number": 2,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2025-05-08T17:04:02.975Z",
      "updated_at": "2025-05-08T17:05:31.648Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"sabo28\" data-post=\"1\" data-topic=\"3992\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/85291D/48.png\" class=\"avatar\"> sabo28:</div>\n<blockquote>\n<p>I can’t use <code>#set page(numbering: \"I\")</code> because I need the <strong>page numbers to be displayed in 10pt font</strong>, and this setting doesn’t allow me to control the text size of the numbers in the footer.</p>\n</blockquote>\n</aside>\n<p>Yes you can and have to use this for the outline to know about it. However, you can combine this with your custom footer, where you can just display the counter with the currently set page numbering instead of hard-coding it to <code>\"I\"</code>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(numbering: \"I\", footer: context {\n  set text(size: 10pt)\n  align(center, counter(page).display()) // Automatically uses page.numbering\n})\n\n/* Front matter with roman numbering */\n\n#set page(numbering: \"1\")\n\n/* Main content with arabic numbering */\n</code></pre>",
      "raw": "[quote=\"sabo28, post:1, topic:3992\"]\nI can’t use `#set page(numbering: \"I\")` because I need the **page numbers to be displayed in 10pt font**, and this setting doesn’t allow me to control the text size of the numbers in the footer.\n[/quote]\n\nYes you can and have to use this for the outline to know about it. However, you can combine this with your custom footer, where you can just display the counter with the currently set page numbering instead of hard-coding it to `\"I\"`:\n\n```typ\n#set page(numbering: \"I\", footer: context {\n  set text(size: 10pt)\n  align(center, counter(page).display()) // Automatically uses page.numbering\n})\n\n/* Front matter with roman numbering */\n\n#set page(numbering: \"1\")\n\n/* Main content with arabic numbering */\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 2,
      "reads": 19,
      "score": 53.8,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    }
  ],
  "scraped_at": "2025-06-10T09:48:11.185535"
}
{
  "topic_metadata": {
    "id": 3993,
    "title": "How do I automatically change colspan of data cells that are from a single column?",
    "slug": "how-do-i-automatically-change-colspan-of-data-cells-that-are-from-a-single-column",
    "posts_count": 6,
    "created_at": "2025-05-08T19:22:58.529Z",
    "last_posted_at": "2025-05-08T21:35:48.066Z",
    "views": 46,
    "like_count": 2,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "Andrew",
    "tags": [
      "tables",
      "data-loading"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 1340
  },
  "posts": [
    {
      "id": 12132,
      "post_number": 1,
      "username": "redjonzaci",
      "name": "Redjon Zaci",
      "created_at": "2025-05-08T19:22:58.650Z",
      "updated_at": "2025-05-11T15:38:38.529Z",
      "cooked": "<p>i tried my best to make as small a reproduction i could and the below is what i came up with. what i mean with the title is i have a column title (Commodity Description) and i need to span 2 columns. but i want cells under that column title to span 2 columns as well.</p>\n<p>i have below my Typst template and JSON data, and i confirm it works if you input it in Typst app.</p>\n<p>this is what it looks like:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/3/34af32abcee936cc48316a1d307cc18a9faa6fb1.png\" data-download-href=\"https://forum.typst.app/uploads/default/34af32abcee936cc48316a1d307cc18a9faa6fb1\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/3/34af32abcee936cc48316a1d307cc18a9faa6fb1_2_690x151.png\" alt=\"image\" data-base62-sha1=\"7w4bFQAyyk1RH4h6wUu3yxSaF8J\" width=\"690\" height=\"151\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/3/34af32abcee936cc48316a1d307cc18a9faa6fb1_2_690x151.png, https://forum.typst.app/uploads/default/original/2X/3/34af32abcee936cc48316a1d307cc18a9faa6fb1.png 1.5x, https://forum.typst.app/uploads/default/original/2X/3/34af32abcee936cc48316a1d307cc18a9faa6fb1.png 2x\" data-dominant-color=\"E1E0E0\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">984×216 44.1 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Hot Dogs and Grand Total need to occupy both columns of Commodity Description</p>\n<p>Typst:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set text(font: \"Public Sans\", size: 7pt, top-edge: 0.4em)\n\n#let data = json(\"data-repro.json\").shipments.at(0)\n\n#if data.carrierInfo.tableInfo.len() &gt; 4 {\n\nfor page in data.carrierInfo.supplementalPages {\n\nlet supplementalCarrierInformation = [  \n  #table(\n    columns: (10),\n    align: center+bottom,\n    table.cell(colspan: 2, inset: (top: 15pt), align: bottom)[#strong[Handling Unit]],\n    table.cell(colspan: 2, inset: (top: 15pt))[#strong[Package Unit]],\n    table.cell()[],\n    table.cell()[],\n    table.cell(colspan: 2, rowspan: 2)[\n      #strong[Commodity Description]\n      #linebreak()\n      Commodities require special or additional care or attention in handling or stowing must be so marked and packaged as to ensure safe transport with ordinary care. See Section 2(e) or NMFC Item 360\n    ],\n    table.cell(colspan: 2, inset: (top: 15pt))[#text(red)[#strong[LTL Only]]],\n    table.cell()[#strong[Qty]],\n    table.cell()[#strong[Type]],\n    table.cell()[#strong[Qty]],\n    table.cell()[#strong[Type]],\n    table.cell()[#strong[Weight]],\n    table.cell()[#strong[H/M]],\n    table.cell()[#strong[Class]],\n    table.cell()[#strong[NMFC]],\n    ..for row in page {(  \n      ..for value in row.values() {(\n        table.cell()[\n            #value\n        ],\n      )}\n    )},\n    [],\n    [],\n    [],\n    [],\n    [],\n    [],\n    table.cell()[Grand Total],\n  )\n]\n\n\ngrid(\n  columns: (1fr, 1fr),\n  inset: 5pt,\n  stroke: black,\n  grid.cell(colspan: 2)[#supplementalCarrierInformation]\n)\n\n}\n\n}\n</code></pre>\n<p>JSON:</p>\n<pre data-code-wrap=\"json\"><code class=\"lang-json\">{\n  \"shipments\": [\n    {\n      \"carrierInfo\": {\n        \"tableInfo\": [\n          {\n            \"huQty\": 4,\n            \"huType\": \"PALLET\",\n            \"packageQty\": 10,\n            \"packageType\": \"BOX\",\n            \"weight\": 5400,\n            \"hazmat\": null,\n            \"commodity\": \"Hot Dogs\",\n            \"class\": 60,\n            \"nmfc\": null,\n            \"bolPreview\": null\n          },\n          {\n            \"huQty\": null,\n            \"huType\": null,\n            \"packageQty\": null,\n            \"packageType\": null,\n            \"weight\": 1000,\n            \"hazmat\": null,\n            \"commodity\": \"Ketchup\",\n            \"class\": 70,\n            \"nmfc\": null,\n            \"bolPreview\": null\n          },\n          {\n            \"huQty\": null,\n            \"huType\": null,\n            \"packageQty\": null,\n            \"packageType\": null,\n            \"weight\": 1000,\n            \"hazmat\": null,\n            \"commodity\": \"Mustard\",\n            \"class\": 55,\n            \"nmfc\": null,\n            \"bolPreview\": null\n          },\n          {\n            \"huQty\": null,\n            \"huType\": null,\n            \"packageQty\": 8,\n            \"packageType\": \"BAG\",\n            \"weight\": 500,\n            \"hazmat\": null,\n            \"commodity\": \"Rolls\",\n            \"class\": 92.5,\n            \"nmfc\": null,\n            \"bolPreview\": null\n          },\n          {\n            \"huQty\": null,\n            \"huType\": null,\n            \"packageQty\": null,\n            \"packageType\": null,\n            \"weight\": 500,\n            \"hazmat\": null,\n            \"commodity\": \"Buns\",\n            \"class\": 92.5,\n            \"nmfc\": null,\n            \"bolPreview\": null\n          }\n        ],\n        \"supplementalPages\": [\n          [\n            {\n              \"huQty\": 4,\n              \"huType\": \"PALLET\",\n              \"packageQty\": 10,\n              \"packageType\": \"BOX\",\n              \"weight\": 5400,\n              \"hazmat\": null,\n              \"commodity\": \"Hot Dogs\",\n              \"class\": 60,\n              \"nmfc\": null,\n              \"bolPreview\": null\n            }\n          ]\n        ]\n      }\n    }\n  ]\n}\n</code></pre>",
      "raw": "i tried my best to make as small a reproduction i could and the below is what i came up with. what i mean with the title is i have a column title (Commodity Description) and i need to span 2 columns. but i want cells under that column title to span 2 columns as well.\n\ni have below my Typst template and JSON data, and i confirm it works if you input it in Typst app.\n\nthis is what it looks like:\n\n![image|690x151](upload://7w4bFQAyyk1RH4h6wUu3yxSaF8J.png)\n\nHot Dogs and Grand Total need to occupy both columns of Commodity Description\n\nTypst:\n\n```typ\n#set text(font: \"Public Sans\", size: 7pt, top-edge: 0.4em)\n\n#let data = json(\"data-repro.json\").shipments.at(0)\n\n#if data.carrierInfo.tableInfo.len() > 4 {\n\nfor page in data.carrierInfo.supplementalPages {\n\nlet supplementalCarrierInformation = [  \n  #table(\n    columns: (10),\n    align: center+bottom,\n    table.cell(colspan: 2, inset: (top: 15pt), align: bottom)[#strong[Handling Unit]],\n    table.cell(colspan: 2, inset: (top: 15pt))[#strong[Package Unit]],\n    table.cell()[],\n    table.cell()[],\n    table.cell(colspan: 2, rowspan: 2)[\n      #strong[Commodity Description]\n      #linebreak()\n      Commodities require special or additional care or attention in handling or stowing must be so marked and packaged as to ensure safe transport with ordinary care. See Section 2(e) or NMFC Item 360\n    ],\n    table.cell(colspan: 2, inset: (top: 15pt))[#text(red)[#strong[LTL Only]]],\n    table.cell()[#strong[Qty]],\n    table.cell()[#strong[Type]],\n    table.cell()[#strong[Qty]],\n    table.cell()[#strong[Type]],\n    table.cell()[#strong[Weight]],\n    table.cell()[#strong[H/M]],\n    table.cell()[#strong[Class]],\n    table.cell()[#strong[NMFC]],\n    ..for row in page {(  \n      ..for value in row.values() {(\n        table.cell()[\n            #value\n        ],\n      )}\n    )},\n    [],\n    [],\n    [],\n    [],\n    [],\n    [],\n    table.cell()[Grand Total],\n  )\n]\n\n\ngrid(\n  columns: (1fr, 1fr),\n  inset: 5pt,\n  stroke: black,\n  grid.cell(colspan: 2)[#supplementalCarrierInformation]\n)\n\n}\n\n}\n```\n\nJSON:\n\n```json\n{\n  \"shipments\": [\n    {\n      \"carrierInfo\": {\n        \"tableInfo\": [\n          {\n            \"huQty\": 4,\n            \"huType\": \"PALLET\",\n            \"packageQty\": 10,\n            \"packageType\": \"BOX\",\n            \"weight\": 5400,\n            \"hazmat\": null,\n            \"commodity\": \"Hot Dogs\",\n            \"class\": 60,\n            \"nmfc\": null,\n            \"bolPreview\": null\n          },\n          {\n            \"huQty\": null,\n            \"huType\": null,\n            \"packageQty\": null,\n            \"packageType\": null,\n            \"weight\": 1000,\n            \"hazmat\": null,\n            \"commodity\": \"Ketchup\",\n            \"class\": 70,\n            \"nmfc\": null,\n            \"bolPreview\": null\n          },\n          {\n            \"huQty\": null,\n            \"huType\": null,\n            \"packageQty\": null,\n            \"packageType\": null,\n            \"weight\": 1000,\n            \"hazmat\": null,\n            \"commodity\": \"Mustard\",\n            \"class\": 55,\n            \"nmfc\": null,\n            \"bolPreview\": null\n          },\n          {\n            \"huQty\": null,\n            \"huType\": null,\n            \"packageQty\": 8,\n            \"packageType\": \"BAG\",\n            \"weight\": 500,\n            \"hazmat\": null,\n            \"commodity\": \"Rolls\",\n            \"class\": 92.5,\n            \"nmfc\": null,\n            \"bolPreview\": null\n          },\n          {\n            \"huQty\": null,\n            \"huType\": null,\n            \"packageQty\": null,\n            \"packageType\": null,\n            \"weight\": 500,\n            \"hazmat\": null,\n            \"commodity\": \"Buns\",\n            \"class\": 92.5,\n            \"nmfc\": null,\n            \"bolPreview\": null\n          }\n        ],\n        \"supplementalPages\": [\n          [\n            {\n              \"huQty\": 4,\n              \"huType\": \"PALLET\",\n              \"packageQty\": 10,\n              \"packageType\": \"BOX\",\n              \"weight\": 5400,\n              \"hazmat\": null,\n              \"commodity\": \"Hot Dogs\",\n              \"class\": 60,\n              \"nmfc\": null,\n              \"bolPreview\": null\n            }\n          ]\n        ]\n      }\n    }\n  ]\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 12,
      "score": 12.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1570
    },
    {
      "id": 12135,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-08T20:25:01.029Z",
      "updated_at": "2025-05-08T20:55:10.342Z",
      "cooked": "<p>Hello. First of all, please read how to properly add code blocks in <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a>.</p>\n<aside class=\"quote no-group quote-modified\" data-username=\"reknih\" data-post=\"1\" data-topic=\"11\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/reknih/48/3_2.png\" class=\"avatar\"><a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11/1\">How to post in the Questions category</a></div>\n<blockquote>\n<p>If your question pertains to a bit of Typst markup you have problems with, put it in the question body! You can syntax-highlight Typst code by wrapping it in ` ```typ … ````. It will then look like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set font(size: 12pt)\n\nHello from *Typst* at $ pi.var + 1 $ o'clock!\n</code></pre>\n<p>If you need to highlight a code or math mode snippet instead, the language tags <code>typc</code> and <code>typm</code> do that, respectively.</p>\n<p>It would be great if you could post the <strong>smallest possible code samples</strong> that allow people to see what your problem is.</p>\n</blockquote>\n</aside>\n<p>Next, your code is not small at all, but at least the result is reproducible. Try to cut away anything that doesn’t change the output and is not the main point of the example. Like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let data = ```json\n[\n  [\n    {\n      \"huQty\": 4,\n      \"huType\": \"PALLET\",\n      \"packageQty\": 10,\n      \"packageType\": \"BOX\",\n      \"weight\": 5400,\n      \"hazmat\": null,\n      \"commodity\": \"Hot Dogs\",\n      \"class\": 60,\n      \"nmfc\": null,\n      \"bolPreview\": null\n    }\n  ]\n]\n```.text\n\n#let supplementalPages = json(bytes(data))\n\n#set text(size: 7pt, top-edge: 0.4em)\n\n#for page in supplementalPages {\n  rect(table(\n    columns: 10,\n    align: center + bottom,\n    table.header(\n      table.cell(colspan: 2, inset: (top: 15pt))[*Handling Unit*],\n      table.cell(colspan: 2)[*Package Unit*],\n      [],\n      [],\n      table.cell(colspan: 2, rowspan: 2)[\n        *Commodity Description* \\\n        Commodities require special or additional care or attention in handling or stowing must be so marked and packaged as to ensure safe transport with ordinary care. See Section 2(e) or NMFC Item 360\n      ],\n      table.cell(colspan: 2, text(red)[*LTL Only*]),\n      [*Qty*],\n      [*Type*],\n      [*Qty*],\n      [*Type*],\n      [*Weight*],\n      [*H/M*],\n      [*Class*],\n      [*NMFC*],\n    ),\n    ..page.map(row =&gt; row.values().map(v =&gt; [#v])).flatten(),\n    table.cell(x: 6)[Grand Total],\n  ))\n}\n</code></pre>\n<p>Though you don’t have to put data in the same file.</p>\n<hr>\n<aside class=\"quote no-group\" data-username=\"redjonzaci\" data-post=\"1\" data-topic=\"3993\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/r/F7602B/48.png\" class=\"avatar\"> redjonzaci:</div>\n<blockquote>\n<p>what i mean with the title is i have a column title (Commodity Description) and i need to span 2 columns. but i want cells under that column title to span 2 columns as well.</p>\n</blockquote>\n</aside>\n<p>What I’m reading is that you need to make “Commodity Description” cell to be 2 columns wide which you already did. And as for cells under that, I read that you want to do</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">    ..page\n      .map(row =&gt; row\n        .values()\n        .enumerate()\n        .filter(((i, _)) =&gt; i != 7)\n        .map(((i, v)) =&gt; if i == 6 { table.cell(colspan: 2)[#v] } else [#v]))\n      .flatten(),\n    table.cell(x: 6, colspan: 2)[Grand Total],\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/e/efb6ac318aaa75d2b71da387de0d2b249076c874.png\" data-download-href=\"https://forum.typst.app/uploads/default/efb6ac318aaa75d2b71da387de0d2b249076c874\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/e/efb6ac318aaa75d2b71da387de0d2b249076c874_2_690x119.png\" alt=\"image\" data-base62-sha1=\"ycBumzJLaiSt15XsrqJpD6Y3v3m\" width=\"690\" height=\"119\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/e/efb6ac318aaa75d2b71da387de0d2b249076c874_2_690x119.png, https://forum.typst.app/uploads/default/original/2X/e/efb6ac318aaa75d2b71da387de0d2b249076c874.png 1.5x, https://forum.typst.app/uploads/default/original/2X/e/efb6ac318aaa75d2b71da387de0d2b249076c874.png 2x\" data-dominant-color=\"313131\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">770×133 26.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>And as a result completely discard second subcolumn because left cells need 2 columns. Making left and right cells 2 columns wide is impossible, because the parent uses only 2 columns total, not 4. So this is the part that I don’t understand at all.</p>\n<p>You can read about table basics in <a href=\"https://typst.app/docs/guides/table-guide/\" class=\"inline-onebox\">Table guide – Typst Documentation</a>.</p>",
      "raw": "Hello. First of all, please read how to properly add code blocks in https://forum.typst.app/t/how-to-post-in-the-questions-category/11.\n\n[quote=\"reknih, post:1, topic:11\"]\nIf your question pertains to a bit of Typst markup you have problems with, put it in the question body! You can syntax-highlight Typst code by wrapping it in ` ```typ ... ````. It will then look like this:\n\n```typ\n#set font(size: 12pt)\n\nHello from *Typst* at $ pi.var + 1 $ o'clock!\n```\n\nIf you need to highlight a code or math mode snippet instead, the language tags `typc` and `typm` do that, respectively.\n\nIt would be great if you could post the **smallest possible code samples** that allow people to see what your problem is.\n[/quote]\n\nNext, your code is not small at all, but at least the result is reproducible. Try to cut away anything that doesn't change the output and is not the main point of the example. Like this:\n\n`````typ\n#let data = ```json\n[\n  [\n    {\n      \"huQty\": 4,\n      \"huType\": \"PALLET\",\n      \"packageQty\": 10,\n      \"packageType\": \"BOX\",\n      \"weight\": 5400,\n      \"hazmat\": null,\n      \"commodity\": \"Hot Dogs\",\n      \"class\": 60,\n      \"nmfc\": null,\n      \"bolPreview\": null\n    }\n  ]\n]\n```.text\n\n#let supplementalPages = json(bytes(data))\n\n#set text(size: 7pt, top-edge: 0.4em)\n\n#for page in supplementalPages {\n  rect(table(\n    columns: 10,\n    align: center + bottom,\n    table.header(\n      table.cell(colspan: 2, inset: (top: 15pt))[*Handling Unit*],\n      table.cell(colspan: 2)[*Package Unit*],\n      [],\n      [],\n      table.cell(colspan: 2, rowspan: 2)[\n        *Commodity Description* \\\n        Commodities require special or additional care or attention in handling or stowing must be so marked and packaged as to ensure safe transport with ordinary care. See Section 2(e) or NMFC Item 360\n      ],\n      table.cell(colspan: 2, text(red)[*LTL Only*]),\n      [*Qty*],\n      [*Type*],\n      [*Qty*],\n      [*Type*],\n      [*Weight*],\n      [*H/M*],\n      [*Class*],\n      [*NMFC*],\n    ),\n    ..page.map(row => row.values().map(v => [#v])).flatten(),\n    table.cell(x: 6)[Grand Total],\n  ))\n}\n`````\n\nThough you don't have to put data in the same file.\n\n---\n\n[quote=\"redjonzaci, post:1, topic:3993\"]\nwhat i mean with the title is i have a column title (Commodity Description) and i need to span 2 columns. but i want cells under that column title to span 2 columns as well.\n[/quote]\n\nWhat I'm reading is that you need to make \"Commodity Description\" cell to be 2 columns wide which you already did. And as for cells under that, I read that you want to do\n\n```typc\n    ..page\n      .map(row => row\n        .values()\n        .enumerate()\n        .filter(((i, _)) => i != 7)\n        .map(((i, v)) => if i == 6 { table.cell(colspan: 2)[#v] } else [#v]))\n      .flatten(),\n    table.cell(x: 6, colspan: 2)[Grand Total],\n```\n\n![image|690x119](upload://ycBumzJLaiSt15XsrqJpD6Y3v3m.png)\n\nAnd as a result completely discard second subcolumn because left cells need 2 columns. Making left and right cells 2 columns wide is impossible, because the parent uses only 2 columns total, not 4. So this is the part that I don't understand at all.\n\nYou can read about table basics in https://typst.app/docs/guides/table-guide/.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 12,
      "score": 172.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12136,
      "post_number": 3,
      "username": "redjonzaci",
      "name": "Redjon Zaci",
      "created_at": "2025-05-08T20:36:12.618Z",
      "updated_at": "2025-05-08T20:43:52.570Z",
      "cooked": "<p>thanks a lot for the reply <a class=\"mention\" href=\"/u/andrew\">@Andrew</a>!<br>\ni now understand how to add Typst code blocks.<br>\nthe only problem now is that the filtered out values need to actually be under the Class column.</p>\n<p>i wanted a way to “push” those values under the Class column and the way i thought about it was that Hot Dogs and the values under that needed to occupy the full colspan of Commodity Description.</p>\n<p>basically i don’t want to lose any values, just push those to the right.</p>\n<p>does this make better sense?</p>",
      "raw": "thanks a lot for the reply @Andrew!\ni now understand how to add Typst code blocks.\nthe only problem now is that the filtered out values need to actually be under the Class column.\n\ni wanted a way to \"push\" those values under the Class column and the way i thought about it was that Hot Dogs and the values under that needed to occupy the full colspan of Commodity Description.\n\nbasically i don't want to lose any values, just push those to the right.\n\ndoes this make better sense?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 10,
      "score": 12.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1570
    },
    {
      "id": 12139,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-08T20:54:18.958Z",
      "updated_at": "2025-05-08T20:54:18.958Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"redjonzaci\" data-post=\"3\" data-topic=\"3993\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/r/F7602B/48.png\" class=\"avatar\"> redjonzaci:</div>\n<blockquote>\n<p>i now understand how to add Typst code blocks.</p>\n</blockquote>\n</aside>\n<p>If you do, please update your post so that it uses appropriate syntax highlighting for Typst and JSON.</p>\n<aside class=\"quote no-group\" data-username=\"redjonzaci\" data-post=\"3\" data-topic=\"3993\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/r/F7602B/48.png\" class=\"avatar\"> redjonzaci:</div>\n<blockquote>\n<p>i wanted a way to “push” those values under the Class column and the way i thought about it was that Hot Dogs and the values under that needed to occupy the full colspan of Commodity Description.</p>\n<p>basically i don’t want to lose any values, just push those to the right.</p>\n<p>does this make better sense?</p>\n</blockquote>\n</aside>\n<p>Then why do you span the top cell 2 columns? Don’t do it and you won’t have to push anything.</p>\n<details><summary>code</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#for page in supplementalPages {\n  rect(table(\n    columns: page.first().len() - 1,\n    align: center + bottom,\n    table.header(\n      table.cell(colspan: 2, inset: (top: 15pt))[*Handling Unit*],\n      table.cell(colspan: 2)[*Package Unit*],\n      [],\n      [],\n      table.cell(rowspan: 2)[\n        *Commodity Description* \\\n        Commodities require special or additional care or attention in handling or stowing must be so marked and packaged as to ensure safe transport with ordinary care. See Section 2(e) or NMFC Item 360\n      ],\n      table.cell(colspan: 2, text(red)[*LTL Only*]),\n      [*Qty*],\n      [*Type*],\n      [*Qty*],\n      [*Type*],\n      [*Weight*],\n      [*H/M*],\n      [*Class*],\n      [*NMFC*],\n    ),\n    ..page.map(row =&gt; row.values().map(v =&gt; [#v])).flatten(),\n    table.cell(x: 6)[Grand Total],\n  ))\n}\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/d/de6fb71e2e6d643be41e6c0a37c05603652f3330.png\" data-download-href=\"https://forum.typst.app/uploads/default/de6fb71e2e6d643be41e6c0a37c05603652f3330\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/d/de6fb71e2e6d643be41e6c0a37c05603652f3330_2_690x119.png\" alt=\"image\" data-base62-sha1=\"vJLlxjfm6jX7IWttFTYvSF5bwbK\" width=\"690\" height=\"119\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/d/de6fb71e2e6d643be41e6c0a37c05603652f3330_2_690x119.png, https://forum.typst.app/uploads/default/original/2X/d/de6fb71e2e6d643be41e6c0a37c05603652f3330.png 1.5x, https://forum.typst.app/uploads/default/original/2X/d/de6fb71e2e6d643be41e6c0a37c05603652f3330.png 2x\" data-dominant-color=\"313131\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">771×133 26.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</details>",
      "raw": "[quote=\"redjonzaci, post:3, topic:3993\"]\ni now understand how to add Typst code blocks.\n[/quote]\n\nIf you do, please update your post so that it uses appropriate syntax highlighting for Typst and JSON.\n\n[quote=\"redjonzaci, post:3, topic:3993\"]\ni wanted a way to “push” those values under the Class column and the way i thought about it was that Hot Dogs and the values under that needed to occupy the full colspan of Commodity Description.\n\nbasically i don’t want to lose any values, just push those to the right.\n\ndoes this make better sense?\n[/quote]\n\nThen why do you span the top cell 2 columns? Don't do it and you won't have to push anything.\n\n<details><summary>code</summary>\n\n```typ\n#for page in supplementalPages {\n  rect(table(\n    columns: page.first().len() - 1,\n    align: center + bottom,\n    table.header(\n      table.cell(colspan: 2, inset: (top: 15pt))[*Handling Unit*],\n      table.cell(colspan: 2)[*Package Unit*],\n      [],\n      [],\n      table.cell(rowspan: 2)[\n        *Commodity Description* \\\n        Commodities require special or additional care or attention in handling or stowing must be so marked and packaged as to ensure safe transport with ordinary care. See Section 2(e) or NMFC Item 360\n      ],\n      table.cell(colspan: 2, text(red)[*LTL Only*]),\n      [*Qty*],\n      [*Type*],\n      [*Qty*],\n      [*Type*],\n      [*Weight*],\n      [*H/M*],\n      [*Class*],\n      [*NMFC*],\n    ),\n    ..page.map(row => row.values().map(v => [#v])).flatten(),\n    table.cell(x: 6)[Grand Total],\n  ))\n}\n```\n\n![image|690x119](upload://vJLlxjfm6jX7IWttFTYvSF5bwbK.png)\n\n</details>",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 10,
      "score": 7.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12141,
      "post_number": 5,
      "username": "redjonzaci",
      "name": "Redjon Zaci",
      "created_at": "2025-05-08T21:25:06.580Z",
      "updated_at": "2025-05-08T21:25:06.580Z",
      "cooked": "<p>thanks a lot for all the help and feedback <a class=\"mention\" href=\"/u/andrew\">@Andrew</a>! i have updated my code blocks, and if you have a suggestion for a more proper post title, i can update it too.</p>",
      "raw": "thanks a lot for all the help and feedback @Andrew! i have updated my code blocks, and if you have a suggestion for a more proper post title, i can update it too.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 10,
      "score": 22.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1570
    },
    {
      "id": 12142,
      "post_number": 6,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-08T21:35:48.066Z",
      "updated_at": "2025-05-08T21:37:20.224Z",
      "cooked": "<p>Well, it’s hard to do it without putting the answer in it. And also, the answer would be still different from the question because the actual problem differs from the OP.</p>\n<p>How do I automatically change colspan of data cells from one column?</p>\n<p>But the answer, after understanding how table supposed to look like, would be to <em>not</em> add colspan to the top cell in the column (and reduce columns number).</p>",
      "raw": "Well, it's hard to do it without putting the answer in it. And also, the answer would be still different from the question because the actual problem differs from the OP.\n\nHow do I automatically change colspan of data cells from one column?\n\nBut the answer, after understanding how table supposed to look like, would be to *not* add colspan to the top cell in the column (and reduce columns number).",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 10,
      "score": 2.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:48:10.455896"
}
{
  "topic_metadata": {
    "id": 3997,
    "title": "Why do i get an empty cell in my table if the condition is false?",
    "slug": "why-do-i-get-an-empty-cell-in-my-table-if-the-condition-is-false",
    "posts_count": 5,
    "created_at": "2025-05-08T23:48:30.054Z",
    "last_posted_at": "2025-05-09T00:36:44.149Z",
    "views": 55,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "PgBiel",
    "tags": [
      "scripting",
      "tables"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 669
  },
  "posts": [
    {
      "id": 12145,
      "post_number": 1,
      "username": "redjonzaci",
      "name": "Redjon Zaci",
      "created_at": "2025-05-08T23:48:30.152Z",
      "updated_at": "2025-05-09T00:15:36.449Z",
      "cooked": "<p>the below conditions are inside a table:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">    ..#if data.carrierInfo.tableInfo.len() &gt; 4 {\n      (\n      table.cell(x: 6, colspan: 1, rowspan: 5, align: center + horizon)[\n        *SEE SUPPLEMENT TO THE BILL OF LADING*\n      ],\n        []\n      )\n    },\n    ..#if data.carrierInfo.tableInfo.len() &lt;= 4 {\n      data.carrierInfo.tableInfo.map(row =&gt; row.pairs().filter(pair =&gt; pair.at(0) != \"bolPreview\").map(pair =&gt; pair.at(1))).flatten().map(value =&gt; [#value])\n    },\n</code></pre>\n<p>i first had the first condition as follows:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">    ..#if data.carrierInfo.tableInfo.len() &gt; 4 {\n      table.cell(x: 6, colspan: 1, rowspan: 5, align: center + horizon)[\n        *SEE SUPPLEMENT TO THE BILL OF LADING*\n      ],\n    },\n</code></pre>\n<p>when it was like above, i would get an empty first cell in my table, even though the condition was false.</p>\n<p>when i changed the first condition to be like below, i didn’t get the empty first cell anymore:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">    ..#if data.carrierInfo.tableInfo.len() &gt; 4 {\n      (\n        table.cell(x: 6, colspan: 1, rowspan: 5, align: center + horizon)[\n          *SEE SUPPLEMENT TO THE BILL OF LADING*\n        ],\n        []\n      )\n    },\n</code></pre>\n<p>why do you think the way it was didn’t work and why it works when i return a sequence?</p>",
      "raw": "the below conditions are inside a table:\n\n```typ\n    ..#if data.carrierInfo.tableInfo.len() > 4 {\n      (\n      table.cell(x: 6, colspan: 1, rowspan: 5, align: center + horizon)[\n        *SEE SUPPLEMENT TO THE BILL OF LADING*\n      ],\n        []\n      )\n    },\n    ..#if data.carrierInfo.tableInfo.len() <= 4 {\n      data.carrierInfo.tableInfo.map(row => row.pairs().filter(pair => pair.at(0) != \"bolPreview\").map(pair => pair.at(1))).flatten().map(value => [#value])\n    },\n```\n\ni first had the first condition as follows:\n\n```typ\n    ..#if data.carrierInfo.tableInfo.len() > 4 {\n      table.cell(x: 6, colspan: 1, rowspan: 5, align: center + horizon)[\n        *SEE SUPPLEMENT TO THE BILL OF LADING*\n      ],\n    },\n```\n\nwhen it was like above, i would get an empty first cell in my table, even though the condition was false.\n\nwhen i changed the first condition to be like below, i didn't get the empty first cell anymore:\n\n```typ\n    ..#if data.carrierInfo.tableInfo.len() > 4 {\n      (\n        table.cell(x: 6, colspan: 1, rowspan: 5, align: center + horizon)[\n          *SEE SUPPLEMENT TO THE BILL OF LADING*\n        ],\n        []\n      )\n    },\n```\n\nwhy do you think the way it was didn't work and why it works when i return a sequence?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 13,
      "score": 187.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1570
    },
    {
      "id": 12147,
      "post_number": 2,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-05-09T00:15:21.108Z",
      "updated_at": "2025-05-09T00:15:21.108Z",
      "cooked": "<p>Your example doesn’t compile for me:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">Error: cannot spread content\n   ╭─[/main.typ:9:3]\n   │\n 9 │   ..if true { table.cell[Hello!] }\n───╯\n</code></pre>\n<p>Which leads me to suspect that you were typing <code>if condition { cell }</code> without the spread operator before <code>if</code> (the two dots <code>..</code>).</p>\n<p>Note that:</p>\n<ul>\n<li><code>if condition { body }</code>, without an <code>else</code>, is a shorthand for <code>if condition { body } else { none }</code>. This means that, when the condition failed, it’d insert <code>none</code> into the table, which is equivalent to an empty cell.</li>\n<li><code>..args</code>, where <code>args</code> is an array (positional) or dictionary (named arguments), is <strong>the only way to pass a variable amount of arguments</strong> to a function. That is, if you want to pass 0 or 1 arguments depending on a condition (your case), or any amount of arguments unknown until the code is run, you must use an array like you are doing.\n<ul>\n<li>This is because the spread operator <code>..</code> simply passes all values in the array as arguments. If the array is empty, nothing is passed:<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">func(..(1, 2, 3)) == func(1, 2, 3)\nfunc(..()) == func(..none) = func()\n</code></pre>\n</li>\n</ul>\n</li>\n<li>Remember that your <code>..if condition { body }</code> is a shorthand for <code>..if condition { body } else { none }</code>, so when your condition is successful, it will expand the array returned by <code>body</code> into table cell arguments, but when the condition fails, it will be <code>..none</code> which is itself a shorthand for <code>..()</code>, i.e. don’t pass any additional arguments. That’s why your new version works.</li>\n<li>So, the old version did not work as it did not use the spread operator, and would instead attempt to add a <code>none</code> cell.</li>\n</ul>\n<p>If you want to read more about this, this documentation page talks about it: <a href=\"https://typst.app/docs/reference/foundations/arguments/\" class=\"inline-onebox\">Arguments Type – Typst Documentation</a></p>",
      "raw": "Your example doesn't compile for me:\n\n```typ\nError: cannot spread content\n   ╭─[/main.typ:9:3]\n   │\n 9 │   ..if true { table.cell[Hello!] }\n───╯\n```\n\nWhich leads me to suspect that you were typing `if condition { cell }` without the spread operator before `if` (the two dots `..`).\n\nNote that:\n- `if condition { body }`, without an `else`, is a shorthand for `if condition { body } else { none }`. This means that, when the condition failed, it'd insert `none` into the table, which is equivalent to an empty cell.\n- `..args`, where `args` is an array (positional) or dictionary (named arguments), is **the only way to pass a variable amount of arguments** to a function. That is, if you want to pass 0 or 1 arguments depending on a condition (your case), or any amount of arguments unknown until the code is run, you must use an array like you are doing.\n   - This is because the spread operator `..` simply passes all values in the array as arguments. If the array is empty, nothing is passed:\n     ```typc\n     func(..(1, 2, 3)) == func(1, 2, 3)\n     func(..()) == func(..none) = func()\n     ```\n- Remember that your `..if condition { body }` is a shorthand for `..if condition { body } else { none }`, so when your condition is successful, it will expand the array returned by `body` into table cell arguments, but when the condition fails, it will be `..none` which is itself a shorthand for `..()`, i.e. don't pass any additional arguments. That's why your new version works.\n- So, the old version did not work as it did not use the spread operator, and would instead attempt to add a `none` cell.\n\nIf you want to read more about this, this documentation page talks about it: https://typst.app/docs/reference/foundations/arguments/",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 13,
      "score": 2.6,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 12148,
      "post_number": 3,
      "username": "redjonzaci",
      "name": "Redjon Zaci",
      "created_at": "2025-05-09T00:20:58.567Z",
      "updated_at": "2025-05-09T00:20:58.567Z",
      "cooked": "<p>you’re right in what you suspected, sorry about that!<br>\nand thanks a lot, i’ve got so much to learn about Typst!</p>",
      "raw": "you're right in what you suspected, sorry about that!\nand thanks a lot, i've got so much to learn about Typst!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 12,
      "score": 47.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1570
    },
    {
      "id": 12150,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-09T00:27:46.547Z",
      "updated_at": "2025-05-09T00:36:28.139Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"redjonzaci\" data-post=\"1\" data-topic=\"3997\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/r/F7602B/48.png\" class=\"avatar\"> redjonzaci:</div>\n<blockquote>\n<p>the below conditions are inside a table</p>\n</blockquote>\n</aside>\n<p>If <code>..</code> is a spread operator, then you can’t use raw <code>#</code> in code mode, it just won’t compile.</p>\n<p>The example indeed does not compile, for the above reason, and because the column number is not known. Default in 1 and <code>x: 6</code> is invalid for it. You also don’t show how <code>data</code> is defined. It just so happen that I recognize this data structure from <a href=\"https://forum.typst.app/t/how-do-i-make-a-cells-colspan-depend-on-the-column-title-in-my-data/3993\" class=\"inline-onebox\">How do i make a cell's colspan depend on the column title (in my data)?</a>. Otherwise, we can only pretend that it’s <code>#let data = (carrierInfo: (tableInfo: range(5)))</code>, which will still fail for the last complex function chaining.</p>",
      "raw": "[quote=\"redjonzaci, post:1, topic:3997\"]\nthe below conditions are inside a table\n[/quote]\n\nIf `..` is a spread operator, then you can't use raw `#` in code mode, it just won't compile.\n\nThe example indeed does not compile, for the above reason, and because the column number is not known. Default in 1 and `x: 6` is invalid for it. You also don't show how `data` is defined. It just so happen that I recognize this data structure from https://forum.typst.app/t/how-do-i-make-a-cells-colspan-depend-on-the-column-title-in-my-data/3993. Otherwise, we can only pretend that it's `#let data = (carrierInfo: (tableInfo: range(5)))`, which will still fail for the last complex function chaining.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 13,
      "score": 2.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12152,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-09T00:36:44.149Z",
      "updated_at": "2025-05-09T00:36:44.149Z",
      "cooked": "<p>For the chaining, you can make it more readable by destructuring the pair:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">    data\n      .carrierInfo\n      .tableInfo\n      .map(row =&gt; row\n        .pairs()\n        .filter(((key, _)) =&gt; key != \"bolPreview\")\n        .map(((_, value)) =&gt; value))\n      .flatten()\n      .map(value =&gt; [#value])\n</code></pre>\n<p>Or even shorter:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">    data\n      .carrierInfo\n      .tableInfo\n      .map(row =&gt; row\n        .pairs()\n        .filter(((key, _)) =&gt; key != \"bolPreview\")\n        .map(((_, value)) =&gt; [#value]))\n      .flatten()\n</code></pre>",
      "raw": "For the chaining, you can make it more readable by destructuring the pair:\n\n```typc\n    data\n      .carrierInfo\n      .tableInfo\n      .map(row => row\n        .pairs()\n        .filter(((key, _)) => key != \"bolPreview\")\n        .map(((_, value)) => value))\n      .flatten()\n      .map(value => [#value])\n```\n\nOr even shorter:\n\n```typc\n    data\n      .carrierInfo\n      .tableInfo\n      .map(row => row\n        .pairs()\n        .filter(((key, _)) => key != \"bolPreview\")\n        .map(((_, value)) => [#value]))\n      .flatten()\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 13,
      "score": 17.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:48:09.716914"
}
{
  "topic_metadata": {
    "id": 3999,
    "title": "How to keep exercise and solution together in source, but render them separately?",
    "slug": "how-to-keep-exercise-and-solution-together-in-source-but-render-them-separately",
    "posts_count": 13,
    "created_at": "2025-05-09T01:03:25.255Z",
    "last_posted_at": "2025-05-13T06:24:25.608Z",
    "views": 176,
    "like_count": 11,
    "reply_count": 8,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 10,
    "accepted_answer_username": "Andrew",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 2121
  },
  "posts": [
    {
      "id": 12154,
      "post_number": 1,
      "username": "John",
      "name": "John",
      "created_at": "2025-05-09T01:03:25.436Z",
      "updated_at": "2025-05-09T17:07:55.379Z",
      "cooked": "<p>I’d like to keep the typst source code for exercises and solutions in the same place. The exercises should be rendered in place. But the solutions should be collected and rendered in a section at the end, with links back to the exercises.</p>\n<p>I’ve seen several exam-like packages. But I don’t think I’ve seen this feature.<br>\nMy use case is a book-like (or monograph) document. I currently just do it manually, adding labels, skipping back and forth.</p>\n<p>If I knew scripting better, I suppose I could put the content into an array with labels, and process it at the end.  But I just started with typst.</p>",
      "raw": "I'd like to keep the typst source code for exercises and solutions in the same place. The exercises should be rendered in place. But the solutions should be collected and rendered in a section at the end, with links back to the exercises.\n\nI've seen several exam-like packages. But I don't think I've seen this feature.\nMy use case is a book-like (or monograph) document. I currently just do it manually, adding labels, skipping back and forth.\n\nIf I knew scripting better, I suppose I could put the content into an array with labels, and process it at the end.  But I just started with typst.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 46,
      "score": 164.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1572
    },
    {
      "id": 12172,
      "post_number": 2,
      "username": "Blaz",
      "name": "Blaz",
      "created_at": "2025-05-09T09:56:25.160Z",
      "updated_at": "2025-05-09T09:56:25.160Z",
      "cooked": "<p>Maybe you can do something like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let show-solutions = true\n#let all-problems = state(\"all-problems\", ())\n\n#let problem(title: \"Example title\", statement: [], solution: []) = {\n  // Collect our title and solution into our all-problems state\n  context {\n    let current-problems = all-problems.get()\n    current-problems.push((title: title, solution: solution, location: here()))\n    all-problems.update(current-problems)\n  }\n  // Display the statement\n  [\n    == #title #label(title)\n    #statement\n  ]\n}\n\n= Problem list\n\n#problem(\n  title: \"Basic arithmetic\",\n  statement: [\n    1. 1+1 = ?\n    2. 2+1 = ?\n  ],\n  solution: [\n    1. 1+1 = 2\n    2. 2+1 = 3\n  ]\n)\n\n#problem(\n  title: \"More stuff\",\n  statement: [\n    1. something\n  ],\n  solution: [\n    1. some solution\n  ]\n)\n\n\n#if show-solutions [\n    #pagebreak()\n    = Solutions\n    #context {\n      let problems = all-problems.get()\n      for p in problems [\n        == #p.title #link(p.location, text(blue)[(go to problem)]) \n        #p.solution\n      ]\n    }\n]\n</code></pre>\n<h1><a name=\"p-12172-breakdown-1\" class=\"anchor\" href=\"#p-12172-breakdown-1\"></a>Breakdown</h1>\n<ol>\n<li>The <code>show-solutions</code> flag allows you to switch between rendering or not rendering the solutions.</li>\n<li>We have the <code>#problem</code> wrapper for our problems. This enables writing the problems and solutions in the same place in your source file.</li>\n<li>As variables defined outside our functions are read-only, we have to use <a href=\"https://typst.app/docs/reference/introspection/state/\">state</a> in order to keep track of our solutions and show them at the end. Notice that the <code>get</code> function for state is contextual, so we have to use <code>context</code> when using it.</li>\n<li>For each problem we store its title, solution and location so we can link back to it.</li>\n</ol>\n<p>I assumed that you want to write a problem and its solution in the same place. If not, you can ignore all the state stuff and the problem wrapper and just “statically” write the solutions in the <code>if</code> block.</p>",
      "raw": "Maybe you can do something like this:\n```typ\n#let show-solutions = true\n#let all-problems = state(\"all-problems\", ())\n\n#let problem(title: \"Example title\", statement: [], solution: []) = {\n  // Collect our title and solution into our all-problems state\n  context {\n    let current-problems = all-problems.get()\n    current-problems.push((title: title, solution: solution, location: here()))\n    all-problems.update(current-problems)\n  }\n  // Display the statement\n  [\n    == #title #label(title)\n    #statement\n  ]\n}\n\n= Problem list\n\n#problem(\n  title: \"Basic arithmetic\",\n  statement: [\n    1. 1+1 = ?\n    2. 2+1 = ?\n  ],\n  solution: [\n    1. 1+1 = 2\n    2. 2+1 = 3\n  ]\n)\n\n#problem(\n  title: \"More stuff\",\n  statement: [\n    1. something\n  ],\n  solution: [\n    1. some solution\n  ]\n)\n\n\n#if show-solutions [\n    #pagebreak()\n    = Solutions\n    #context {\n      let problems = all-problems.get()\n      for p in problems [\n        == #p.title #link(p.location, text(blue)[(go to problem)]) \n        #p.solution\n      ]\n    }\n]\n```\n\n# Breakdown\n\n1. The `show-solutions` flag allows you to switch between rendering or not rendering the solutions.\n2. We have the `#problem` wrapper for our problems. This enables writing the problems and solutions in the same place in your source file.\n3. As variables defined outside our functions are read-only, we have to use [state](https://typst.app/docs/reference/introspection/state/) in order to keep track of our solutions and show them at the end. Notice that the `get` function for state is contextual, so we have to use `context` when using it.\n4. For each problem we store its title, solution and location so we can link back to it.\n\nI assumed that you want to write a problem and its solution in the same place. If not, you can ignore all the state stuff and the problem wrapper and just \"statically\" write the solutions in the `if` block.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 45,
      "score": 49.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 98
    },
    {
      "id": 12177,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-09T10:49:07.813Z",
      "updated_at": "2025-05-09T10:49:07.813Z",
      "cooked": "<p>You are using <code>all-problems.get()</code> and <code>all-problems.update(current-problems)</code> in the same context, which always(?) leads to the converge issue, provided this happens 5 times. And it does here, if there are 5+ problems:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let show-solutions = true\n#let all-problems = state(\"all-problems\", ())\n\n#let problem(title: \"Example title\", statement: [], solution: []) = context {\n  let current-problems = all-problems.get()\n  current-problems.push((title: title, solution: solution, location: here()))\n  all-problems.update(current-problems)\n  [\n    == #title #label(repr(title))\n    #statement\n  ]\n}\n\n= Problem list\n\n#for n in range(1, 6) {\n  problem(title: [Problem #n])\n}\n\n#if show-solutions [\n  #pagebreak()\n  = Solutions\n  #context {\n    for p in all-problems.get() [\n      == #p.title #link(p.location, text(blue)[(go to problem)])\n      #p.solution\n    ]\n  }\n]\n</code></pre>\n<p>To fix this, you should pass closure to the update function instead of overriding the value. Also the title can’t be content, because of the label, which is “fixed” with <code>repr()</code> content wrapper.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let show-solutions = true\n#let all-problems = state(\"all-problems\", ())\n\n#let problem(title: \"Example title\", statement: [], solution: []) = context {\n  let problem = (title: title, solution: solution, location: here())\n  all-problems.update(problems =&gt; problems + (problem,))\n  [\n    == #title #label(repr(title))\n    #statement\n  ]\n}\n\n= Problem list\n\n#for n in range(1, 6) {\n  problem(title: [Problem #n])\n}\n\n#if show-solutions [\n  #pagebreak()\n  = Solutions\n  #context {\n    for p in all-problems.get() [\n      == #p.title #link(p.location, text(blue)[(go to problem)])\n      #p.solution\n    ]\n  }\n]\n</code></pre>",
      "raw": "You are using `all-problems.get()` and `all-problems.update(current-problems)` in the same context, which always(?) leads to the converge issue, provided this happens 5 times. And it does here, if there are 5+ problems:\n\n```typ\n#let show-solutions = true\n#let all-problems = state(\"all-problems\", ())\n\n#let problem(title: \"Example title\", statement: [], solution: []) = context {\n  let current-problems = all-problems.get()\n  current-problems.push((title: title, solution: solution, location: here()))\n  all-problems.update(current-problems)\n  [\n    == #title #label(repr(title))\n    #statement\n  ]\n}\n\n= Problem list\n\n#for n in range(1, 6) {\n  problem(title: [Problem #n])\n}\n\n#if show-solutions [\n  #pagebreak()\n  = Solutions\n  #context {\n    for p in all-problems.get() [\n      == #p.title #link(p.location, text(blue)[(go to problem)])\n      #p.solution\n    ]\n  }\n]\n```\n\nTo fix this, you should pass closure to the update function instead of overriding the value. Also the title can't be content, because of the label, which is \"fixed\" with `repr()` content wrapper.\n\n\n```typ\n#let show-solutions = true\n#let all-problems = state(\"all-problems\", ())\n\n#let problem(title: \"Example title\", statement: [], solution: []) = context {\n  let problem = (title: title, solution: solution, location: here())\n  all-problems.update(problems => problems + (problem,))\n  [\n    == #title #label(repr(title))\n    #statement\n  ]\n}\n\n= Problem list\n\n#for n in range(1, 6) {\n  problem(title: [Problem #n])\n}\n\n#if show-solutions [\n  #pagebreak()\n  = Solutions\n  #context {\n    for p in all-problems.get() [\n      == #p.title #link(p.location, text(blue)[(go to problem)])\n      #p.solution\n    ]\n  }\n]\n```",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 4,
      "reads": 44,
      "score": 73.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12192,
      "post_number": 4,
      "username": "John",
      "name": "John",
      "created_at": "2025-05-09T16:12:36.695Z",
      "updated_at": "2025-05-09T16:12:36.695Z",
      "cooked": "<p>This is a great start. I had looked at the abbr package as a model for collecting things in a dict and then pulling things out and rendering them. But what you have here is closer to a complete solution. I’ll mark the topic as solved once I play with it a bit. I guess I’ll end up putting it in a public package.</p>\n<p>I don’t need to code much for my current role. I’ve been disciplined about not coding (it’s such a time sink). But there are so many things I could use to improve my notes that I know would be not too much work… “Stop me before I code again”.</p>",
      "raw": "This is a great start. I had looked at the abbr package as a model for collecting things in a dict and then pulling things out and rendering them. But what you have here is closer to a complete solution. I'll mark the topic as solved once I play with it a bit. I guess I'll end up putting it in a public package.\n\nI don't need to code much for my current role. I've been disciplined about not coding (it's such a time sink). But there are so many things I could use to improve my notes that I know would be not too much work... \"Stop me before I code again\".",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 40,
      "score": 23.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1572
    },
    {
      "id": 12195,
      "post_number": 5,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-05-09T17:08:31.339Z",
      "updated_at": "2025-05-09T17:08:31.339Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/john\">@John</a>, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @John, welcome to the forum! I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 39,
      "score": 22.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 12205,
      "post_number": 6,
      "username": "Blaz",
      "name": "Blaz",
      "created_at": "2025-05-09T21:52:48.839Z",
      "updated_at": "2025-05-09T21:52:48.839Z",
      "cooked": "<p>Thanks for fixing it!</p>",
      "raw": "Thanks for fixing it!",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 39,
      "score": 27.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 98
    },
    {
      "id": 12350,
      "post_number": 7,
      "username": "John",
      "name": "John",
      "created_at": "2025-05-12T16:43:50.556Z",
      "updated_at": "2025-05-12T16:43:50.556Z",
      "cooked": "<p>I’d like to have the exercises numbered with the major part following the heading major part. For example, “Exercise 2.1”, “Exercise 2.2”, etc. for exercises in the second major heading.</p>\n<p>The, the solution should refer to these numbers. Something like “Solution Exercise 2.1: solution text” with the number linking back to the statement in the text.</p>\n<p>The following almost does this. But, each number in the solution is actually the number for the previous exercise. (And the first exercise number in the solutions is 0.0)</p>\n<p>exercises.typ:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let all-problems = state(\"all-problems\", ())\n#let c = counter(\"problem\")\n\n#let problem(statement: [], solution: none) = context {\n    let head_maj = counter(heading).get().at(0)\n    let prob_maj = c.get().at(0)\n    if prob_maj == 0 {\n        let head_min = counter(heading).get().at(1, default: 1)\n        c.update((head_maj, head_min))\n    } else if head_maj == prob_maj {\n        c.step(level: 2)\n    } else {\n        c.update((head_maj, 1))\n    }\n    [\n        _Exercise_  #context emph(c.display()): #statement #label(repr(c))\\\n    ]\n    let prob_maj = c.get().at(0)\n    let prob_min = c.get().at(1, default: 0)\n    let problem = (solution: solution, location: here(), number: (prob_maj, prob_min)) // c.get())\n    all-problems.update(problems =&gt; problems + (problem,))\n}\n\n#let display-solutions() = {\n    context {\n        for p in all-problems.get() {\n            if p.solution != none {\n                let maj = p.number.at(0, default: 1)\n                let min = p.number.at(1, default: 1)\n                [_Solution:_ #link(p.location, [_Exercise_ #emph[#maj\\.#min]]) #h(1em) #p.solution\\ \\ ]\n            }\n        }\n    }\n}\n</code></pre>\n<p>Then used in a document</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set heading(numbering: \"1.1\")\n\n#import \"/lib/exercises.typ\": problem, display-solutions\n\n= First Chapter\n\n#problem(\n    statement: [What is $1 + 1$ ?],\n    solution: [The answer is $2$]\n)\n\n#problem(\n    statement: [What is $1 + 2$ ?],\n    solution: [The answer is $3$]\n)\n\n= Second Chapter\n\n#problem(\n    statement: [Then what is $1 + 3$ ?],\n    solution: [The answer is $4$]\n)\n\n= The Solutions\n\n#display-solutions()\n</code></pre>",
      "raw": "I'd like to have the exercises numbered with the major part following the heading major part. For example, \"Exercise 2.1\", \"Exercise 2.2\", etc. for exercises in the second major heading.\n\nThe, the solution should refer to these numbers. Something like \"Solution Exercise 2.1: solution text\" with the number linking back to the statement in the text.\n\nThe following almost does this. But, each number in the solution is actually the number for the previous exercise. (And the first exercise number in the solutions is 0.0)\n\nexercises.typ:\n```typst\n#let all-problems = state(\"all-problems\", ())\n#let c = counter(\"problem\")\n\n#let problem(statement: [], solution: none) = context {\n    let head_maj = counter(heading).get().at(0)\n    let prob_maj = c.get().at(0)\n    if prob_maj == 0 {\n        let head_min = counter(heading).get().at(1, default: 1)\n        c.update((head_maj, head_min))\n    } else if head_maj == prob_maj {\n        c.step(level: 2)\n    } else {\n        c.update((head_maj, 1))\n    }\n    [\n        _Exercise_  #context emph(c.display()): #statement #label(repr(c))\\\n    ]\n    let prob_maj = c.get().at(0)\n    let prob_min = c.get().at(1, default: 0)\n    let problem = (solution: solution, location: here(), number: (prob_maj, prob_min)) // c.get())\n    all-problems.update(problems => problems + (problem,))\n}\n\n#let display-solutions() = {\n    context {\n        for p in all-problems.get() {\n            if p.solution != none {\n                let maj = p.number.at(0, default: 1)\n                let min = p.number.at(1, default: 1)\n                [_Solution:_ #link(p.location, [_Exercise_ #emph[#maj\\.#min]]) #h(1em) #p.solution\\ \\ ]\n            }\n        }\n    }\n}\n```\n\nThen used in a document\n```typst\n#set heading(numbering: \"1.1\")\n\n#import \"/lib/exercises.typ\": problem, display-solutions\n\n= First Chapter\n\n#problem(\n    statement: [What is $1 + 1$ ?],\n    solution: [The answer is $2$]\n)\n\n#problem(\n    statement: [What is $1 + 2$ ?],\n    solution: [The answer is $3$]\n)\n\n= Second Chapter\n\n#problem(\n    statement: [Then what is $1 + 3$ ?],\n    solution: [The answer is $4$]\n)\n\n= The Solutions\n\n#display-solutions()\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 11.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1572
    },
    {
      "id": 12352,
      "post_number": 8,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-12T17:50:33.421Z",
      "updated_at": "2025-05-12T17:52:07.183Z",
      "cooked": "<p>I don’t follow on the numbering logic, but the issue is that you fetch updated counter state within the same context where it was updated. It won’t work, you need a new context.</p>\n<details><summary>Code</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let all-problems = state(\"all-problems\", ())\n#let problem-counter = counter(\"problem\")\n\n#let problem(statement: [], solution: none) = context {\n  let heading-numbers = counter(heading).get()\n  let head-maj = heading-numbers.first()\n  let prob-maj = problem-counter.get().first()\n  if prob-maj == 0 {\n    let head-min = heading-numbers.at(1, default: 1)\n    problem-counter.update((head-maj, head-min))\n  } else if head-maj == prob-maj {\n    problem-counter.step(level: 2)\n  } else {\n    problem-counter.update((head-maj, 1))\n  }\n  context {\n    let label = label(repr(problem-counter))\n    let problem-number = problem-counter.display()\n    par[_Exercise #problem-number:_ #statement#label]\n    let prob_maj = problem-counter.get().first()\n    let prob_min = problem-counter.get().at(1, default: 0)\n    let problem = (\n      solution: solution,\n      location: here(),\n      number: (prob_maj, prob_min),\n    )\n    all-problems.update(problems =&gt; problems + (problem,))\n  }\n}\n\n#let display-solutions() = context {\n  for p in all-problems.get() {\n    if p.solution != none {\n      let maj = p.number.at(0, default: 1)\n      let min = p.number.at(1, default: 1)\n      let exercise-link = link(p.location, emph[Exercise #maj.#min])\n      par[_Solution:_ #exercise-link #h(1em) #p.solution]\n    }\n  }\n}\n\n#set heading(numbering: \"1.1\")\n\n= First Chapter\n\n#problem(statement: [What is $1 + 1$ ?], solution: [The answer is $2$])\n\n#problem(statement: [What is $1 + 2$ ?], solution: [The answer is $3$])\n\n= Second Chapter\n\n#problem(statement: [Then what is $1 + 3$ ?], solution: [The answer is $4$])\n\n= The Solutions\n\n#display-solutions()\n</code></pre>\n</details>\n<p>You also get and override <code>problem-counter</code> in the same context, which is probably bad, but I don’t know how to get converge warning. Probably because the counter doesn’t update itself with its previous value, but rather with other counter’s value. I guess in its current form, it’s fine.</p>",
      "raw": "I don't follow on the numbering logic, but the issue is that you fetch updated counter state within the same context where it was updated. It won't work, you need a new context.\n\n<details><summary>Code</summary>\n\n```typ\n#let all-problems = state(\"all-problems\", ())\n#let problem-counter = counter(\"problem\")\n\n#let problem(statement: [], solution: none) = context {\n  let heading-numbers = counter(heading).get()\n  let head-maj = heading-numbers.first()\n  let prob-maj = problem-counter.get().first()\n  if prob-maj == 0 {\n    let head-min = heading-numbers.at(1, default: 1)\n    problem-counter.update((head-maj, head-min))\n  } else if head-maj == prob-maj {\n    problem-counter.step(level: 2)\n  } else {\n    problem-counter.update((head-maj, 1))\n  }\n  context {\n    let label = label(repr(problem-counter))\n    let problem-number = problem-counter.display()\n    par[_Exercise #problem-number:_ #statement#label]\n    let prob_maj = problem-counter.get().first()\n    let prob_min = problem-counter.get().at(1, default: 0)\n    let problem = (\n      solution: solution,\n      location: here(),\n      number: (prob_maj, prob_min),\n    )\n    all-problems.update(problems => problems + (problem,))\n  }\n}\n\n#let display-solutions() = context {\n  for p in all-problems.get() {\n    if p.solution != none {\n      let maj = p.number.at(0, default: 1)\n      let min = p.number.at(1, default: 1)\n      let exercise-link = link(p.location, emph[Exercise #maj.#min])\n      par[_Solution:_ #exercise-link #h(1em) #p.solution]\n    }\n  }\n}\n\n#set heading(numbering: \"1.1\")\n\n= First Chapter\n\n#problem(statement: [What is $1 + 1$ ?], solution: [The answer is $2$])\n\n#problem(statement: [What is $1 + 2$ ?], solution: [The answer is $3$])\n\n= Second Chapter\n\n#problem(statement: [Then what is $1 + 3$ ?], solution: [The answer is $4$])\n\n= The Solutions\n\n#display-solutions()\n```\n\n</details>\n\nYou also get and override `problem-counter` in the same context, which is probably bad, but I don't know how to get converge warning. Probably because the counter doesn't update itself with its previous value, but rather with other counter's value. I guess in its current form, it's fine.",
      "reply_to_post_number": 7,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 26.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12353,
      "post_number": 9,
      "username": "John",
      "name": "John",
      "created_at": "2025-05-12T18:18:03.014Z",
      "updated_at": "2025-05-12T18:18:03.014Z",
      "cooked": "<p>Great, this works, and neatens the code up a bit. That’s the first typst code I wrote (other than the simplest functions).</p>\n<p>I replaced your <code>par</code> by <code>block</code> because “display” math equations cannot go inside paragraphs.</p>\n<p>The numbering logic so far is just “Excersise x.y”, where <code>x</code> is the major part of the heading counter, and y restarts at <code>1</code> in each heading. In other words, I am following a standard that is common in text books.</p>\n<p>I am not sure that this is the numbering I want in the end because my top level sections are really long; I may want to include the next heading level in the exercise. But, I wanted to start with something that is correct.</p>\n<p>To make it fancier, I might allow a user to pass a function (if this can be done in typst) or else options, to customize how solutions are displayed.</p>\n<p>The other thing would be to distinguish exercises by section, so that solutions could be organized by chapter.  But those can be added later.</p>",
      "raw": "Great, this works, and neatens the code up a bit. That's the first typst code I wrote (other than the simplest functions).\n\nI replaced your `par` by `block` because \"display\" math equations cannot go inside paragraphs.\n\nThe numbering logic so far is just \"Excersise x.y\", where `x` is the major part of the heading counter, and y restarts at `1` in each heading. In other words, I am following a standard that is common in text books.\n\nI am not sure that this is the numbering I want in the end because my top level sections are really long; I may want to include the next heading level in the exercise. But, I wanted to start with something that is correct.\n\nTo make it fancier, I might allow a user to pass a function (if this can be done in typst) or else options, to customize how solutions are displayed.\n\nThe other thing would be to distinguish exercises by section, so that solutions could be organized by chapter.  But those can be added later.",
      "reply_to_post_number": 8,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 16.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1572
    },
    {
      "id": 12355,
      "post_number": 10,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-12T19:03:45.662Z",
      "updated_at": "2025-05-12T19:03:45.662Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"John\" data-post=\"9\" data-topic=\"3999\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/j/5C0B42/48.png\" class=\"avatar\"> John:</div>\n<blockquote>\n<p>The numbering logic so far is just “Excersise x.y”, where <code>x</code> is the major part of the heading counter, and y restarts at <code>1</code> in each heading. In other words, I am following a standard that is common in text books.</p>\n</blockquote>\n</aside>\n<p>It’s not “the major part of the heading counter”, it’s the number of the top-/1st level heading. It’s not a versioning schema, it sounds confusing. Also y doesn’t restart after each heading, only after the top-level heading. Which is indeed a common per-section numbering, like in <a href=\"https://typst.app/universe/package/subpar\" class=\"inline-onebox\">subpar – Typst Universe</a> and <a href=\"https://typst.app/universe/package/i-figured\" class=\"inline-onebox\">i-figured – Typst Universe</a>.</p>\n<p>Here is a simple solution:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let all-problems = state(\"all-problems\", ())\n#let problem-counter = counter(\"problem\")\n\n#let problem(statement: [], solution: none) = {\n  problem-counter.step()\n  context {\n    let h1-num = counter(heading).get().first()\n    let problem-number = numbering(\"1.1\", h1-num, ..problem-counter.get())\n    let name = [Exercise #problem-number]\n    let problem = (solution: solution, location: here(), name: name)\n    all-problems.update(problems =&gt; problems + (problem,))\n    block[_#name:_ #statement]\n  }\n}\n\n#let display-solutions() = context for p in all-problems.get() {\n  if p.solution == none { continue }\n  let exercise-link = link(p.location, emph(p.name))\n  block[_Solution:_ #exercise-link#h(1em)#p.solution]\n}\n\n#set heading(numbering: \"1.1\")\n#show heading.where(level: 1): it =&gt; it + problem-counter.update(0)\n\n= First Chapter\n\n#problem(statement: [What is $1 + 1$ ?], solution: [The answer is $2$])\n\n#problem(statement: [What is $1 + 2$ ?], solution: [The answer is $3$])\n\n== Sub\n\n#problem(statement: [What is $1 + 3$ ?], solution: [The answer is $4$])\n\n= Second Chapter\n\n#problem(statement: [Then what is $1 + 4$ ?], solution: [The answer is $5$])\n\n= The Solutions\n\n#display-solutions()\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/d/d7ab13c20550c8f9dcef28d88438afe7157d58b6.png\" alt=\"image\" data-base62-sha1=\"uLTbC1RA4Ywx5WpSAtAgU37I3ky\" width=\"290\" height=\"385\"></p>",
      "raw": "[quote=\"John, post:9, topic:3999\"]\nThe numbering logic so far is just “Excersise x.y”, where `x` is the major part of the heading counter, and y restarts at `1` in each heading. In other words, I am following a standard that is common in text books.\n[/quote]\n\nIt's not \"the major part of the heading counter\", it's the number of the top-/1st level heading. It's not a versioning schema, it sounds confusing. Also y doesn't restart after each heading, only after the top-level heading. Which is indeed a common per-section numbering, like in https://typst.app/universe/package/subpar and https://typst.app/universe/package/i-figured.\n\nHere is a simple solution:\n\n```typ\n#let all-problems = state(\"all-problems\", ())\n#let problem-counter = counter(\"problem\")\n\n#let problem(statement: [], solution: none) = {\n  problem-counter.step()\n  context {\n    let h1-num = counter(heading).get().first()\n    let problem-number = numbering(\"1.1\", h1-num, ..problem-counter.get())\n    let name = [Exercise #problem-number]\n    let problem = (solution: solution, location: here(), name: name)\n    all-problems.update(problems => problems + (problem,))\n    block[_#name:_ #statement]\n  }\n}\n\n#let display-solutions() = context for p in all-problems.get() {\n  if p.solution == none { continue }\n  let exercise-link = link(p.location, emph(p.name))\n  block[_Solution:_ #exercise-link#h(1em)#p.solution]\n}\n\n#set heading(numbering: \"1.1\")\n#show heading.where(level: 1): it => it + problem-counter.update(0)\n\n= First Chapter\n\n#problem(statement: [What is $1 + 1$ ?], solution: [The answer is $2$])\n\n#problem(statement: [What is $1 + 2$ ?], solution: [The answer is $3$])\n\n== Sub\n\n#problem(statement: [What is $1 + 3$ ?], solution: [The answer is $4$])\n\n= Second Chapter\n\n#problem(statement: [Then what is $1 + 4$ ?], solution: [The answer is $5$])\n\n= The Solutions\n\n#display-solutions()\n```\n\n![image|290x385](upload://uLTbC1RA4Ywx5WpSAtAgU37I3ky.png)",
      "reply_to_post_number": 9,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 28,
      "score": 20.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12360,
      "post_number": 11,
      "username": "John",
      "name": "John",
      "created_at": "2025-05-12T20:13:30.168Z",
      "updated_at": "2025-05-12T20:13:30.168Z",
      "cooked": "<p>One thing that bothers me a bit is that this looks inefficient, like it makes a lot of order n copies.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">problems =&gt; problems + (problem,)\n</code></pre>\n<p>I made a few attempts to modify the content. But I’m kind of flying blind.</p>",
      "raw": "One thing that bothers me a bit is that this looks inefficient, like it makes a lot of order n copies.\n```typst\nproblems => problems + (problem,)\n```\nI made a few attempts to modify the content. But I'm kind of flying blind.",
      "reply_to_post_number": 9,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 15.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1572
    },
    {
      "id": 12361,
      "post_number": 12,
      "username": "John",
      "name": "John",
      "created_at": "2025-05-12T20:33:02.325Z",
      "updated_at": "2025-05-12T20:35:35.825Z",
      "cooked": "<p>I realize that these aren’t version numbers. But version numbers and the heading counter are sometimes represented in the same way, as a tuple of integers. And they both represent hierarchical organization. Of course, it’s better to use more appropriate language. I mean, I don’t want to start talking about a patch level headings.</p>\n<p>I was not clear when I wrote “y restarts at <code>1</code> in each heading”. I meant that it restarts at one at each top-level heading only. Both your previous solution and your latest do this correctly (assuming this is what one wants— I did)<br>\nBut, I like your latest code better. It looks cleaner and more flexible to me.</p>",
      "raw": "I realize that these aren't version numbers. But version numbers and the heading counter are sometimes represented in the same way, as a tuple of integers. And they both represent hierarchical organization. Of course, it's better to use more appropriate language. I mean, I don't want to start talking about a patch level headings.\n\nI was not clear when I wrote \"y restarts at `1` in each heading\". I meant that it restarts at one at each top-level heading only. Both your previous solution and your latest do this correctly (assuming this is what one wants--- I did)\nBut, I like your latest code better. It looks cleaner and more flexible to me.",
      "reply_to_post_number": 11,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 10.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1572
    },
    {
      "id": 12370,
      "post_number": 13,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-13T06:24:25.608Z",
      "updated_at": "2025-05-13T06:24:25.608Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"John\" data-post=\"11\" data-topic=\"3999\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/j/5C0B42/48.png\" class=\"avatar\"> John:</div>\n<blockquote>\n<p>One thing that bothers me a bit is that this looks inefficient, like it makes a lot of order n copies.</p>\n</blockquote>\n</aside>\n<p>If you like how fast the compilation is, then don’t bother with memory. Typst tries to be as efficient internally as it can, even if sometimes it looks inefficient in the code. Though it’s not perfect.</p>\n<aside class=\"quote no-group\" data-username=\"John\" data-post=\"12\" data-topic=\"3999\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/j/5C0B42/48.png\" class=\"avatar\"> John:</div>\n<blockquote>\n<p>a patch level headings</p>\n</blockquote>\n</aside>\n<p>The headings are only identified by their ordinal levels. The more appropriate/correct language you use, the easier it is to get the message across.</p>",
      "raw": "[quote=\"John, post:11, topic:3999\"]\nOne thing that bothers me a bit is that this looks inefficient, like it makes a lot of order n copies.\n[/quote]\n\nIf you like how fast the compilation is, then don't bother with memory. Typst tries to be as efficient internally as it can, even if sometimes it looks inefficient in the code. Though it's not perfect.\n\n[quote=\"John, post:12, topic:3999\"]\na patch level headings\n[/quote]\n\nThe headings are only identified by their ordinal levels. The more appropriate/correct language you use, the easier it is to get the message across.",
      "reply_to_post_number": 11,
      "reply_count": 0,
      "quote_count": 2,
      "like_count": 0,
      "reads": 22,
      "score": 4.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:48:08.997296"
}
{
  "topic_metadata": {
    "id": 400,
    "title": "How do I automatically label my headings, figures, equations?",
    "slug": "how-do-i-automatically-label-my-headings-figures-equations",
    "posts_count": 6,
    "created_at": "2024-09-17T08:36:16.840Z",
    "last_posted_at": "2025-02-17T17:25:09.527Z",
    "views": 738,
    "like_count": 4,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "scripting",
      "referencing"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 1158
  },
  "posts": [
    {
      "id": 1523,
      "post_number": 1,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-09-17T08:36:16.941Z",
      "updated_at": "2025-02-22T08:45:57.262Z",
      "cooked": "<p>With a large number of referenceable content, it may become bothersome to label and references elements manually. Automatically generating labels for content based on their body (headings), caption (figures) is an interesting approach but can also pollute your autocompletion field quickly.</p>\n<p>Depending on your preferences, you may prefer manually labelling, having all content addressable, or some in-between solution.</p>",
      "raw": "With a large number of referenceable content, it may become bothersome to label and references elements manually. Automatically generating labels for content based on their body (headings), caption (figures) is an interesting approach but can also pollute your autocompletion field quickly. \n\nDepending on your preferences, you may prefer manually labelling, having all content addressable, or some in-between solution.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 100,
      "score": 2900.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 1524,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-09-17T08:37:52.270Z",
      "updated_at": "2024-09-17T08:44:07.526Z",
      "cooked": "<p>The methods below are implemented for headings, but remain valid for figures. The only difference are the fields accessed. In the case of a figure, one may want to use the caption to generate the label text.</p>\n<h2><a name=\"p-1524-approach-1-naive-show-rule-error-1\" class=\"anchor\" href=\"#p-1524-approach-1-naive-show-rule-error-1\"></a>Approach 1: naive show rule (error)</h2>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading: it =&gt; {\n  let key = lower(it.body.text.replace(\" \", \"-\"))\n  [#it #label(key)]\n}\n\n= Long Heading with long title\nSee @long-heading-with-long-title.,\n</code></pre>\n<p>cf. <a href=\"https://github.com/typst/typst/issues/2926\" rel=\"noopener nofollow ugc\">Programmatically attaching labels to locatable elements #2926</a></p>\n<p>As mentionned in the issue above, this simple approach results in an error: <code>label &lt;...&gt; does not exist in the document</code>.</p>\n<p>As of <span class=\"discourse-local-date\" data-date=\"2024-09-17\" data-email-preview=\"2024-09-17T00:00:00Z UTC\">2024-09-17T00:00:00Z</span>, it is still the case.</p>\n<h2><a name=\"p-1524-approach-2-invisible-figure-workaround-2\" class=\"anchor\" href=\"#p-1524-approach-2-invisible-figure-workaround-2\"></a>Approach 2: invisible figure workaround</h2>\n<p>Starting from the final result, you may obtain the following, where content is addressable even though no label is explictly defined.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">= Test\n@test\n\n== Test 2 ah $x y z$ #rect(fill: black) test\n\n@test-2-ah-x-y-z--test\n</code></pre>\n<details>\n<summary>\nOutput</summary>\n<p><img src=\"https://forum.typst.app/uploads/default/original/1X/76fabc2aafc5d2961184391f194fdeacfbe829be.png\" alt=\"image\" data-base62-sha1=\"gYxxpg8mIPb3qLQbvTHMnlLlGDY\" width=\"193\" height=\"270\"></p>\n</details>\n<h3><a name=\"p-1524-complete-code-3\" class=\"anchor\" href=\"#p-1524-complete-code-3\"></a>Complete code</h3>\n<p>You may simply copy the entire code below for your purposes.</p>\n<details>\n<summary>\nCode</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let heading-numbering = \"1.1\"\n#set heading(numbering: heading-numbering)\n#let to-string(content) = {\n  if content.has(\"text\") and type(content.text) == \"string\" {\n    content.text\n  } else if content.has(\"children\") {\n    content.children.map(to-string).join(\"\")\n  } else if content.has(\"body\") {\n    to-string(content.body)\n  } else if content == [ ] {\n    \" \"\n  }\n}\n#show heading: it =&gt; {\n  let key = lower(to-string(it).replace(\" \", \"-\"))\n  return [\n    #it\n    #v(-1em)\n    #figure(\n      kind: \"heading\",\n      numbering: (..numbers) =&gt; numbering(heading-numbering, ..(counter(heading).get())),\n      supplement: \"Section\",\n    )[]\n    #label(key)\n  ]\n}\n</code></pre>\n</details>\n<h3><a name=\"p-1524-technical-details-4\" class=\"anchor\" href=\"#p-1524-technical-details-4\"></a>Technical details</h3>\n<p>This approach relies on:</p>\n<ol>\n<li><code>show heading</code>  rule adding an invisible, referenceable figure</li>\n<li>a <code>to-string</code> conversion function for the <code>heading.body</code></li>\n</ol>\n<h4><a name=\"p-1524-numbering-5\" class=\"anchor\" href=\"#p-1524-numbering-5\"></a>numbering</h4>\n<p>In order to reference heading, you need to define the numbering<sup class=\"footnote-ref\"><a href=\"#footnote-1524-1\" id=\"footnote-ref-1524-1\">[1]</a></sup> scheme first. As an example, <code>\"1.1\"</code> is enough.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let heading-numbering = \"1.1\"\n#set heading(numbering: heading-numbering)\n</code></pre>\n<h4><a name=\"p-1524-to-string-6\" class=\"anchor\" href=\"#p-1524-to-string-6\"></a><code>to-string</code></h4>\n<p>The content to string function comes from GitHub issue <span class=\"hashtag-raw\">#3876</span><sup class=\"footnote-ref\"><a href=\"#footnote-1524-2\" id=\"footnote-ref-1524-2\">[2]</a></sup>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let to-string(content) = {\n  if content.has(\"text\") and type(content.text) == \"string\" {\n    content.text\n  } else if content.has(\"children\") {\n    content.children.map(to-string).join(\"\")\n  } else if content.has(\"body\") {\n    to-string(content.body)\n  } else if content == [ ] {\n    \" \"\n  }\n}\n</code></pre>\n<h4><a name=\"p-1524-show-heading-rule-7\" class=\"anchor\" href=\"#p-1524-show-heading-rule-7\"></a><code>show heading</code> rule</h4>\n<p>In order:</p>\n<ol>\n<li>We generate the label key, replacing spaces by <code>-</code></li>\n<li>Return the heading content by juxtaposing<br>\na. the original heading<br>\nb. negative vertical space to remove the linebreak<br>\nc. the figure used for labelling</li>\n</ol>\n<p>Notice that the figure must folllow the <code>heading-numbering</code> scheme and the <code>counter(heading)</code>.<sup class=\"footnote-ref\"><a href=\"#footnote-1524-3\" id=\"footnote-ref-1524-3\">[3]</a></sup></p>\n<p>From this point, it is fairly simple to customize the generation rule for your own purposes, e.g.,  only generate level 1 heading labels, determine the heading supplement according to the level, etc.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading: it =&gt; {\n  let key = lower(to-string(it).replace(\" \", \"-\"))\n  return [\n    #it\n    #v(-1em)\n    #figure(\n      kind: \"heading\",\n      numbering: (..numbers) =&gt; numbering(heading-numbering, ..(counter(heading).get())),\n      supplement: \"Section\",\n    )[]\n    #label(key)\n  ]\n}\n</code></pre>\n<hr class=\"footnotes-sep\">\n\n<ol class=\"footnotes-list\">\n<li id=\"footnote-1524-1\" class=\"footnote-item\"><p><a href=\"https://typst.app/docs/reference/model/heading/#parameters-numbering\">Heading numbering</a> <a href=\"#footnote-ref-1524-1\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"footnote-1524-2\" class=\"footnote-item\"><p><a href=\"https://github.com/typst/typst/discussions/3876#discussioncomment-9016808\" rel=\"noopener nofollow ugc\">Turning content into string #3876</a><br>\n <a href=\"#footnote-ref-1524-2\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n<li id=\"footnote-1524-3\" class=\"footnote-item\"><p><a href=\"https://typst.app/docs/reference/introspection/counter/\">Introspection: counter</a> <a href=\"#footnote-ref-1524-3\" class=\"footnote-backref\">↩︎</a></p>\n</li>\n</ol>",
      "raw": "The methods below are implemented for headings, but remain valid for figures. The only difference are the fields accessed. In the case of a figure, one may want to use the caption to generate the label text.\n\n## Approach 1: naive show rule (error)\n\n```typ\n#show heading: it => {\n  let key = lower(it.body.text.replace(\" \", \"-\"))\n  [#it #label(key)]\n}\n\n= Long Heading with long title\nSee @long-heading-with-long-title.,\n```\ncf. [Programmatically attaching labels to locatable elements #2926](https://github.com/typst/typst/issues/2926)\n\nAs mentionned in the issue above, this simple approach results in an error: `label <...> does not exist in the document`. \n\nAs of [date=2024-09-17], it is still the case.\n\n## Approach 2: invisible figure workaround\n\nStarting from the final result, you may obtain the following, where content is addressable even though no label is explictly defined.\n\n```typ\n= Test\n@test\n\n== Test 2 ah $x y z$ #rect(fill: black) test\n\n@test-2-ah-x-y-z--test\n```\n[details=\"Output\"]\n![image|193x270](upload://gYxxpg8mIPb3qLQbvTHMnlLlGDY.png)\n[/details]\n\n### Complete code\n\nYou may simply copy the entire code below for your purposes. \n\n[details=\"Code\"]\n```typ\n#let heading-numbering = \"1.1\"\n#set heading(numbering: heading-numbering)\n#let to-string(content) = {\n  if content.has(\"text\") and type(content.text) == \"string\" {\n    content.text\n  } else if content.has(\"children\") {\n    content.children.map(to-string).join(\"\")\n  } else if content.has(\"body\") {\n    to-string(content.body)\n  } else if content == [ ] {\n    \" \"\n  }\n}\n#show heading: it => {\n  let key = lower(to-string(it).replace(\" \", \"-\"))\n  return [\n    #it\n    #v(-1em)\n    #figure(\n      kind: \"heading\",\n      numbering: (..numbers) => numbering(heading-numbering, ..(counter(heading).get())),\n      supplement: \"Section\",\n    )[]\n    #label(key)\n  ]\n}\n```\n[/details]\n\n### Technical details\nThis approach relies on:\n1. `show heading`  rule adding an invisible, referenceable figure\n2. a `to-string` conversion function for the `heading.body`\n\n#### numbering\n\nIn order to reference heading, you need to define the numbering^[[Heading numbering](https://typst.app/docs/reference/model/heading/#parameters-numbering)] scheme first. As an example, `\"1.1\"` is enough.\n\n```typ\n#let heading-numbering = \"1.1\"\n#set heading(numbering: heading-numbering)\n```\n\n#### `to-string`\n\nThe content to string function comes from GitHub issue #3876^[[Turning content into string #3876](https://github.com/typst/typst/discussions/3876#discussioncomment-9016808)\n].\n\n```typ\n#let to-string(content) = {\n  if content.has(\"text\") and type(content.text) == \"string\" {\n    content.text\n  } else if content.has(\"children\") {\n    content.children.map(to-string).join(\"\")\n  } else if content.has(\"body\") {\n    to-string(content.body)\n  } else if content == [ ] {\n    \" \"\n  }\n}\n```\n\n#### `show heading` rule\n\nIn order:\n1. We generate the label key, replacing spaces by `-`\n2. Return the heading content by juxtaposing\na. the original heading\nb. negative vertical space to remove the linebreak\nc. the figure used for labelling\n\nNotice that the figure must folllow the `heading-numbering` scheme and the `counter(heading)`.^[[Introspection: counter](https://typst.app/docs/reference/introspection/counter/)]\n\nFrom this point, it is fairly simple to customize the generation rule for your own purposes, e.g.,  only generate level 1 heading labels, determine the heading supplement according to the level, etc.\n\n```typ\n#show heading: it => {\n  let key = lower(to-string(it).replace(\" \", \"-\"))\n  return [\n    #it\n    #v(-1em)\n    #figure(\n      kind: \"heading\",\n      numbering: (..numbers) => numbering(heading-numbering, ..(counter(heading).get())),\n      supplement: \"Section\",\n    )[]\n    #label(key)\n  ]\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 102,
      "score": 240.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 1643,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2024-09-17T14:36:14.078Z",
      "updated_at": "2024-09-17T14:36:14.078Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"quachpas\" data-post=\"2\" data-topic=\"400\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/q/662200/48.png\" class=\"avatar\"> quachpas:</div>\n<blockquote>\n<p>As of <span class=\"discourse-local-date\" data-date=\"2024-09-17\" data-email-preview=\"2024-09-17T00:00:00Z UTC\">2024-09-17T00:00:00Z</span>, it is still the case.</p>\n</blockquote>\n</aside>\n<p>Oh, neat feature. Here is a link about how date/time can be inserted: <a href=\"https://meta.discourse.org/t/insert-date-time-question/140792/8\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Insert Date / Time Question - #8 by david - Support - Discourse Meta</a>. Now I can make my posts even better.</p>",
      "raw": "[quote=\"quachpas, post:2, topic:400\"]\nAs of [date=2024-09-17], it is still the case.\n[/quote]\n\nOh, neat feature. Here is a link about how date/time can be inserted: https://meta.discourse.org/t/insert-date-time-question/140792/8. Now I can make my posts even better.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 75,
      "score": 50.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 1671,
      "post_number": 4,
      "username": "Enivex",
      "name": "Enivex",
      "created_at": "2024-09-17T16:00:11.006Z",
      "updated_at": "2024-09-17T16:00:11.006Z",
      "cooked": "<p>I can’t imagine wanting this over manually picking labels, but it’s interesting that it’s possible.</p>",
      "raw": "I can't imagine wanting this over manually picking labels, but it's interesting that it's possible.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 71,
      "score": 19.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 5
    },
    {
      "id": 1716,
      "post_number": 5,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-09-18T06:50:53.241Z",
      "updated_at": "2024-09-18T06:50:53.241Z",
      "cooked": "<p>To be fair, I may or may not have too many headings … Also, most of the time, I end up writing the heading title, or the figure caption exactly as I did above, but manually. I just too the obvious next step, which was to automate it!</p>",
      "raw": "To be fair, I may or may not have too many headings ... Also, most of the time, I end up writing the heading title, or the figure caption exactly as I did above, but manually. I just too the obvious next step, which was to automate it!",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 68,
      "score": 33.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 8753,
      "post_number": 6,
      "username": "Simon_Schneider",
      "name": "Simon  Schneider",
      "created_at": "2025-02-17T17:25:09.527Z",
      "updated_at": "2025-02-17T17:25:09.527Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/quachpas\">@quachpas</a> Thank you so much!<br>\nI ran into the issue described in your first approach and your post was a god send.</p>\n<p>To avoid duplicate labels (since I often have multiple headings with the same name in different chapters) I’ve expanded your approach 2 to generate hierarchical labels. As this tends to generate very long label keys, I’ve added the option to override the default key generation using the headings supplement field.</p>\n<pre><code class=\"lang-auto\">#heading(supplement: [h1])[Section 1]\n@h1\n\n== Section 1.1\n@h1-section-1.1\n\n#heading(supplement: [-], level: 2)[Section 1.2]\nAuto labeling has been disabled for this heading using the supplement field value `[-]`.\n\n== Section 1.3\n@h1-section-1.3\n\n=== Section 1.3.1\n@h1-section-1.3-section-1.3.1\n\n=== Section 1.3.2\n@h1-section-1.3-section-1.3.2\n\n== Section 1.4\n@h1-section-1.4\n\n= Section 2\n@section-2\n</code></pre>\n<details>\n<summary>\nFull Code</summary>\n<pre><code class=\"lang-auto\">#let heading-numbering = \"1.\"\n#set heading(numbering: heading-numbering)\n\n#let to-string(content) = {\n  if content.has(\"text\") and type(content.text) == \"string\" {\n    content.text\n  } else if content.has(\"children\") {\n    content.children.map(to-string).join(\"\")\n  } else if content.has(\"body\") {\n    to-string(content.body)\n  } else if content == [ ] {\n    \" \"\n  }\n}\n\n#show heading: it =&gt; context {\n  // give users the option to disable auto labeling\n  if it.supplement == [-] {\n    return it\n  }\n  let get_label_key = it =&gt; {\n    if it.supplement == [] {\n      // if no supplement is provided, use the heading text to generate the label\n      return lower(to-string(it).trim().replace(\" \", \"-\"))\n    } else {\n      // if a supplement is provided, use the supplement to generate the label\n      return lower(to-string(it.supplement).trim().replace(\" \", \"-\"))\n    }\n  }\n\n  // recursively construct hierarchical label key\n  let prev = query(selector(heading).before(here())).rev()\n  let key = \"\"\n  let level = it.level\n  for heading in prev {\n    if level == 1 {\n      break\n    }\n    if heading.level &gt;= level {\n      continue\n    }\n    level -= 1\n    key = get_label_key(heading) + \"-\" + key\n  }\n  key = key + get_label_key(it)\n\n  // return the heading with the auto-generated label\n  return [\n    #it\n    // unfortunately there is an issue with attaching programmatically attaching labels to headings (see https://github.com/typst/typst/issues/2926)\n    // therefore we have to use a fake figure to attach the label to the heading\n    #v(-1em)\n    #figure(\n      kind: \"heading\",\n      numbering: (..numbers) =&gt; numbering(heading-numbering, ..(counter(heading).get())),\n      supplement: \"Section\",\n    )[]\n    #label(key)\n    //#key // print the label key for debugging\n  ]\n}\n#set heading(numbering: (..numbers) =&gt; numbering((..nums) =&gt; nums.pos().map(str).join(\".\"), ..numbers), supplement: [])\n\n\n\n#heading(supplement: [h1])[Section 1]\n@h1\n\n== Section 1.1\n@h1-section-1.1\n\n#heading(supplement: [-], level: 2)[Section 1.2]\nAuto labeling has been disabled for this heading using the supplement field value `[-]`.\n\n== Section 1.3\n@h1-section-1.3\n\n=== Section 1.3.1\n@h1-section-1.3-section-1.3.1\n\n=== Section 1.3.2\n@h1-section-1.3-section-1.3.2\n\n== Section 1.4\n@h1-section-1.4\n\n= Section 2\n@section-2\n</code></pre>\n</details>",
      "raw": "@quachpas Thank you so much!\nI ran into the issue described in your first approach and your post was a god send.\n\nTo avoid duplicate labels (since I often have multiple headings with the same name in different chapters) I've expanded your approach 2 to generate hierarchical labels. As this tends to generate very long label keys, I've added the option to override the default key generation using the headings supplement field.\n\n```\n#heading(supplement: [h1])[Section 1]\n@h1\n\n== Section 1.1\n@h1-section-1.1\n\n#heading(supplement: [-], level: 2)[Section 1.2]\nAuto labeling has been disabled for this heading using the supplement field value `[-]`.\n\n== Section 1.3\n@h1-section-1.3\n\n=== Section 1.3.1\n@h1-section-1.3-section-1.3.1\n\n=== Section 1.3.2\n@h1-section-1.3-section-1.3.2\n\n== Section 1.4\n@h1-section-1.4\n\n= Section 2\n@section-2\n```\n\n\n[details=\"Full Code\"]\n\n```\n#let heading-numbering = \"1.\"\n#set heading(numbering: heading-numbering)\n\n#let to-string(content) = {\n  if content.has(\"text\") and type(content.text) == \"string\" {\n    content.text\n  } else if content.has(\"children\") {\n    content.children.map(to-string).join(\"\")\n  } else if content.has(\"body\") {\n    to-string(content.body)\n  } else if content == [ ] {\n    \" \"\n  }\n}\n\n#show heading: it => context {\n  // give users the option to disable auto labeling\n  if it.supplement == [-] {\n    return it\n  }\n  let get_label_key = it => {\n    if it.supplement == [] {\n      // if no supplement is provided, use the heading text to generate the label\n      return lower(to-string(it).trim().replace(\" \", \"-\"))\n    } else {\n      // if a supplement is provided, use the supplement to generate the label\n      return lower(to-string(it.supplement).trim().replace(\" \", \"-\"))\n    }\n  }\n\n  // recursively construct hierarchical label key\n  let prev = query(selector(heading).before(here())).rev()\n  let key = \"\"\n  let level = it.level\n  for heading in prev {\n    if level == 1 {\n      break\n    }\n    if heading.level >= level {\n      continue\n    }\n    level -= 1\n    key = get_label_key(heading) + \"-\" + key\n  }\n  key = key + get_label_key(it)\n\n  // return the heading with the auto-generated label\n  return [\n    #it\n    // unfortunately there is an issue with attaching programmatically attaching labels to headings (see https://github.com/typst/typst/issues/2926)\n    // therefore we have to use a fake figure to attach the label to the heading\n    #v(-1em)\n    #figure(\n      kind: \"heading\",\n      numbering: (..numbers) => numbering(heading-numbering, ..(counter(heading).get())),\n      supplement: \"Section\",\n    )[]\n    #label(key)\n    //#key // print the label key for debugging\n  ]\n}\n#set heading(numbering: (..numbers) => numbering((..nums) => nums.pos().map(str).join(\".\"), ..numbers), supplement: [])\n\n\n\n#heading(supplement: [h1])[Section 1]\n@h1\n\n== Section 1.1\n@h1-section-1.1\n\n#heading(supplement: [-], level: 2)[Section 1.2]\nAuto labeling has been disabled for this heading using the supplement field value `[-]`.\n\n== Section 1.3\n@h1-section-1.3\n\n=== Section 1.3.1\n@h1-section-1.3-section-1.3.1\n\n=== Section 1.3.2\n@h1-section-1.3-section-1.3.2\n\n== Section 1.4\n@h1-section-1.4\n\n= Section 2\n@section-2\n```\n[/details]",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 31,
      "score": 31.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 871
    }
  ],
  "scraped_at": "2025-06-10T09:58:49.725719"
}
{
  "topic_metadata": {
    "id": 4004,
    "title": "How to automatically split the box between multi-columns for text adaptation?",
    "slug": "how-to-automatically-split-the-box-between-multi-columns-for-text-adaptation",
    "posts_count": 4,
    "created_at": "2025-05-09T05:03:30.262Z",
    "last_posted_at": "2025-05-13T17:18:17.122Z",
    "views": 44,
    "like_count": 0,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "janekfleper",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 338
  },
  "posts": [
    {
      "id": 12160,
      "post_number": 1,
      "username": "Zhihao_Li",
      "name": "Zhihao Li",
      "created_at": "2025-05-09T05:03:30.366Z",
      "updated_at": "2025-05-09T05:04:51.899Z",
      "cooked": "<h1><a name=\"p-12160-function-1\" class=\"anchor\" href=\"#p-12160-function-1\"></a>Function</h1>\n<p>I have defined a concept box which can include the texts in the color box. Th codes are as follows.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let concept-box(color: color, body: content) = box(\n  stroke: color,\n  fill: white,\n  radius: 3pt,\n  inset: 6pt,\n  width: auto,\n)[\n  #body\n]\n</code></pre>\n<h1><a name=\"p-12160-problom-2\" class=\"anchor\" href=\"#p-12160-problom-2\"></a>Problom</h1>\n<p>However, as shown in the following figure, the second box is just unbreakable between multi-columns, resulting that the whole box is displayed in the second column with much empty space in the first column.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/f/fefff11b5d40d206bd2df3cbb5a7a5a5bf9b25e8.png\" data-download-href=\"https://forum.typst.app/uploads/default/fefff11b5d40d206bd2df3cbb5a7a5a5bf9b25e8\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/f/fefff11b5d40d206bd2df3cbb5a7a5a5bf9b25e8_2_393x500.png\" alt=\"image\" data-base62-sha1=\"AnPD4Xw0XQjOipfLr36ZlJffEYE\" width=\"393\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/f/fefff11b5d40d206bd2df3cbb5a7a5a5bf9b25e8_2_393x500.png, https://forum.typst.app/uploads/default/optimized/2X/f/fefff11b5d40d206bd2df3cbb5a7a5a5bf9b25e8_2_589x750.png 1.5x, https://forum.typst.app/uploads/default/original/2X/f/fefff11b5d40d206bd2df3cbb5a7a5a5bf9b25e8.png 2x\" data-dominant-color=\"F5F4F6\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">599×761 87.4 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>The usage of concept box is shown as the following codes.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#concept-box(body: [\n  #inline(\"FLAME Model\", color-box.at(0))\n  The pretrained parameters of FLAME are included in the file of `flame2023.pkl`.\n  The pretrained parameters especially the `shapedirs` are used to generate relatively common 3D face. Through the finetuning, also means tracking, the `posedirs` and `shapedirs` will be updated by blendshape coefficients for fitting the target face. \n\n  #inline(\"Landmark Embeddings\", color-box.at(0))\n  Using the pretrained model of `landmark_embedding_with_eyes.npy`, we can extract the mesh index of each landmark. In FLAME, it uses the 70 landmarks to keep the face more accurate.\n  - `full_lmk_faces_idx`: record the mesh index of each landmark.\n  - `full_lmk_bary_coords`: the weights of three vertices in a triangle mesh to calculate the landmark position using barycentric coordinates.\n], color: color-box.at(0))\n</code></pre>\n<h1><a name=\"p-12160-desiration-3\" class=\"anchor\" href=\"#p-12160-desiration-3\"></a>Desiration</h1>\n<p>So, how to split the box into two parts in order to it can adapt to the two columns? That is, just make the second box use the left space in the first column.</p>\n<p>Thanks for your help.</p>",
      "raw": "# Function\n\nI have defined a concept box which can include the texts in the color box. Th codes are as follows.\n```typst\n#let concept-box(color: color, body: content) = box(\n  stroke: color,\n  fill: white,\n  radius: 3pt,\n  inset: 6pt,\n  width: auto,\n)[\n  #body\n]\n```\n\n# Problom\n\nHowever, as shown in the following figure, the second box is just unbreakable between multi-columns, resulting that the whole box is displayed in the second column with much empty space in the first column.\n\n![image|393x500](upload://AnPD4Xw0XQjOipfLr36ZlJffEYE.png)\n\nThe usage of concept box is shown as the following codes.\n```typst\n#concept-box(body: [\n  #inline(\"FLAME Model\", color-box.at(0))\n  The pretrained parameters of FLAME are included in the file of `flame2023.pkl`.\n  The pretrained parameters especially the `shapedirs` are used to generate relatively common 3D face. Through the finetuning, also means tracking, the `posedirs` and `shapedirs` will be updated by blendshape coefficients for fitting the target face. \n\n  #inline(\"Landmark Embeddings\", color-box.at(0))\n  Using the pretrained model of `landmark_embedding_with_eyes.npy`, we can extract the mesh index of each landmark. In FLAME, it uses the 70 landmarks to keep the face more accurate.\n  - `full_lmk_faces_idx`: record the mesh index of each landmark.\n  - `full_lmk_bary_coords`: the weights of three vertices in a triangle mesh to calculate the landmark position using barycentric coordinates.\n], color: color-box.at(0))\n```\n\n# Desiration\n\nSo, how to split the box into two parts in order to it can adapt to the two columns? That is, just make the second box use the left space in the first column.\n\nThanks for your help.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 38.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1573
    },
    {
      "id": 12166,
      "post_number": 2,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-05-09T08:36:05.948Z",
      "updated_at": "2025-05-09T08:36:50.755Z",
      "cooked": "<p>The splitting will work if you use <a href=\"https://typst.app/docs/reference/layout/block/\"><code>block()</code></a> instead of <a href=\"https://typst.app/docs/reference/layout/box/\"><code>box()</code></a>. A block is breakable by default (you can also disable this) and will correctly split between the two columns.</p>",
      "raw": "The splitting will work if you use [`block()`](https://typst.app/docs/reference/layout/block/) instead of [`box()`](https://typst.app/docs/reference/layout/box/). A block is breakable by default (you can also disable this) and will correctly split between the two columns.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 8.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 12174,
      "post_number": 3,
      "username": "Zhihao_Li",
      "name": "Zhihao Li",
      "created_at": "2025-05-09T10:24:41.050Z",
      "updated_at": "2025-05-09T10:24:41.050Z",
      "cooked": "<p>Very appreciated. <code>block()</code> works well.</p>",
      "raw": "Very appreciated. `block()` works well.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 14,
      "score": 12.8,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1573
    },
    {
      "id": 12391,
      "post_number": 4,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-05-13T17:18:17.122Z",
      "updated_at": "2025-05-13T17:18:17.122Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/zhihao_li\">@Zhihao_Li</a>, glad you got a satisfying answer! I’ve marked it <img src=\"https://forum.typst.app/images/emoji/apple/white_check_mark.png?v=12\" title=\":white_check_mark:\" class=\"emoji\" alt=\":white_check_mark:\" loading=\"lazy\" width=\"20\" height=\"20\"> as the solution, so that others can more easily find it later – don’t forget next time <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hi @Zhihao_Li, glad you got a satisfying answer! I've marked it :white_check_mark: as the solution, so that others can more easily find it later -- don't forget next time :slight_smile:",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 9,
      "score": 1.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:48:08.245730"
}
{
  "topic_metadata": {
    "id": 4008,
    "title": "Is there a package for common typography rules?",
    "slug": "is-there-a-package-for-common-typography-rules",
    "posts_count": 5,
    "created_at": "2025-05-09T10:58:45.850Z",
    "last_posted_at": "2025-05-14T03:43:37.314Z",
    "views": 133,
    "like_count": 4,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "Andrew",
    "tags": [
      "packages",
      "typography"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 652
  },
  "posts": [
    {
      "id": 12179,
      "post_number": 1,
      "username": "gour",
      "name": "Saša Janiška",
      "created_at": "2025-05-09T10:58:46.017Z",
      "updated_at": "2025-05-10T06:18:54.970Z",
      "cooked": "<p>Hello,</p>\n<p>I’ve asked the other day on Discord how is one supposed to prepare content to typeset typographical stuff like em-dash, en-dash, ellipsis etc. I’ve found one <a href=\"https://www.flother.is/til/typst-em-dash-show-rule/\" rel=\"noopener nofollow ugc\">post</a> and wonder whether this is the recommended way or is there something else.</p>\n<p>The answer was that this is the way, but wonder if there is some pre-prepared packaged to handle such things which are pretty common in LateX world?</p>",
      "raw": "Hello,\n\nI've asked the other day on Discord how is one supposed to prepare content to typeset typographical stuff like em-dash, en-dash, ellipsis etc. I've found one [post](https://www.flother.is/til/typst-em-dash-show-rule/) and wonder whether this is the recommended way or is there something else.\n\nThe answer was that this is the way, but wonder if there is some pre-prepared packaged to handle such things which are pretty common in LateX world?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 45,
      "score": 19.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 335
    },
    {
      "id": 12183,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-09T12:11:55.671Z",
      "updated_at": "2025-05-10T10:33:06.931Z",
      "cooked": "<p>Hello. It depends on how you are going to write the dash in the source code. I didn’t find any package for dashes, and it is not package-worthy if all you want is one small text show rule. You can use predefined symbol names though:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show \" \" + sym.dash.em + \" \": it =&gt; {\n  let space = sym.space.nobreak.narrow\n  space + sym.dash.em + space\n}\n\ntest --- test\n</code></pre>\n<p>Or the shortest way, sacrificing easily seeing which exact characters are used:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show \" — \": \" — \"\n</code></pre>\n<p>If you need more customizability, then you can use <a href=\"https://typst.app/docs/reference/layout/h/\"><code>h()</code></a>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show \" — \": h(0.1pt) + \"—\" + h(0.1pt)\n</code></pre>\n<p>To remove repetition:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show \" — \": ((h(0.1pt),) * 2).intersperse(\"—\").join()\n#show \" — \": range(2).map(_ =&gt; h(0.1pt)).intersperse(\"—\").join()\n</code></pre>\n<p>Or with a helper function:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let wrap(it, with) = with + it + with\n#show \" — \": wrap(\"—\", h(0.1pt))\n#show \" — \": wrap([---], sym.space.nobreak.narrow)\n</code></pre>",
      "raw": "Hello. It depends on how you are going to write the dash in the source code. I didn't find any package for dashes, and it is not package-worthy if all you want is one small text show rule. You can use predefined symbol names though:\n\n```typ\n#show \" \" + sym.dash.em + \" \": it => {\n  let space = sym.space.nobreak.narrow\n  space + sym.dash.em + space\n}\n\ntest --- test\n```\n\nOr the shortest way, sacrificing easily seeing which exact characters are used:\n\n```typ\n#show \" — \": \" — \"\n```\n\nIf you need more customizability, then you can use [`h()`](https://typst.app/docs/reference/layout/h/):\n\n```typ\n#show \" — \": h(0.1pt) + \"—\" + h(0.1pt)\n```\n\nTo remove repetition:\n\n```typ\n#show \" — \": ((h(0.1pt),) * 2).intersperse(\"—\").join()\n#show \" — \": range(2).map(_ => h(0.1pt)).intersperse(\"—\").join()\n```\n\nOr with a helper function:\n\n```typ\n#let wrap(it, with) = with + it + with\n#show \" — \": wrap(\"—\", h(0.1pt))\n#show \" — \": wrap([---], sym.space.nobreak.narrow)\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 45,
      "score": 74.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12396,
      "post_number": 3,
      "username": "gour",
      "name": "Saša Janiška",
      "created_at": "2025-05-13T17:59:35.249Z",
      "updated_at": "2025-05-13T17:59:35.249Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"2\" data-topic=\"4008\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>Hello. It depends on how you are going to write the dash in the source code. I didn’t find any package for dashes, and it is not package-worthy if all you want<br>\nis one small text show rule.</p>\n</blockquote>\n</aside>\n<p>Thank you very much for your input!</p>\n<p>I was thinking about the package since it is not a question just about writing a dash, iow. there are several special characters (elipsis, protected space etc.) which are taken for granted when using LaTeX, but I get your point that creating show rules is the way to go in Typst- <img src=\"https://forum.typst.app/images/emoji/apple/sunglasses.png?v=12\" title=\":sunglasses:\" class=\"emoji\" alt=\":sunglasses:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "[quote=\"Andrew, post:2, topic:4008, full:true\"]\nHello. It depends on how you are going to write the dash in the source code. I didn't find any package for dashes, and it is not package-worthy if all you want \nis one small text show rule.\n[/quote]\n\nThank you very much for your input!\n\nI was thinking about the package since it is not a question just about writing a dash, iow. there are several special characters (elipsis, protected space etc.) which are taken for granted when using LaTeX, but I get your point that creating show rules is the way to go in Typst- :sunglasses:",
      "reply_to_post_number": 2,
      "reply_count": 2,
      "quote_count": 1,
      "like_count": 0,
      "reads": 27,
      "score": 20.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 335
    },
    {
      "id": 12404,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-13T19:31:53.742Z",
      "updated_at": "2025-05-13T19:34:37.598Z",
      "cooked": "<p>No, not everything should use text show rule. See <a href=\"https://github.com/typst/typst/issues/5209\" class=\"inline-onebox\">Clarify the (intended) use of `show \"word\": \"substitution\"` vs. `let word = \"supstitution\"; word` · Issue #5209 · typst/typst · GitHub</a>. Typst does have all special characters in <a href=\"https://typst.app/docs/reference/symbols/sym\">one single place</a>, but how you include in your markup is a different topic. It’s recommended to create a variable and use it as a shorthand. Besides, show rules can’t always be applied because of text complexity/edge cases.</p>",
      "raw": "No, not everything should use text show rule. See https://github.com/typst/typst/issues/5209. Typst does have all special characters in [one single place](https://typst.app/docs/reference/symbols/sym), but how you include in your markup is a different topic. It's recommended to create a variable and use it as a shorthand. Besides, show rules can't always be applied because of text complexity/edge cases.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 10.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12423,
      "post_number": 5,
      "username": "PgBiel",
      "name": "",
      "created_at": "2025-05-14T03:43:37.314Z",
      "updated_at": "2025-05-14T03:43:37.314Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"gour\" data-post=\"3\" data-topic=\"4008\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/gour/48/317_2.png\" class=\"avatar\"> gour:</div>\n<blockquote>\n<p>it is not a question just about writing a dash</p>\n</blockquote>\n</aside>\n<p>Just in case this isn’t known, I’ll share that there is a full list of available shorthands here: <a href=\"https://typst.app/docs/reference/symbols/#shorthands\" class=\"inline-onebox\">Symbols – Typst Documentation</a></p>\n<ul>\n<li><code>--</code> for en dash</li>\n<li><code>---</code> for em dash</li>\n<li><code>...</code> for ellipsis</li>\n</ul>\n<aside class=\"quote no-group\" data-username=\"gour\" data-post=\"3\" data-topic=\"4008\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/gour/48/317_2.png\" class=\"avatar\"> gour:</div>\n<blockquote>\n<p>creating show rules is the way to go in Typst- <img src=\"https://forum.typst.app/images/emoji/apple/sunglasses.png?v=12\" title=\":sunglasses:\" class=\"emoji\" alt=\":sunglasses:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n</blockquote>\n</aside>\n<p>Yeah, if you want to customize every occurrence of a certain special character, using a show rule just on that character is the way to go.</p>\n<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"4\" data-topic=\"4008\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>No, not everything should use text show rule.</p>\n</blockquote>\n</aside>\n<p>I believe they weren’t necessarily referring to text show rules. But yes, be careful to not use a text show rule when you could use a variable or function instead (e.g. to apply some specific styling or display a constant multiple times).</p>\n<p>In this case a text show rule is appropriate as it is about changing the styling of the document. In other words, if a package inserts text with an em dash, you want that em dash to be affected, so a global text show rule makes sense. But you wouldn’t want the word “number” from another package to be affected when creating a constant named “number”, for example, so you should create a  <em>variable</em> named <code>number</code> instead of a show rule on that word.</p>",
      "raw": "[quote=\"gour, post:3, topic:4008\"]\nit is not a question just about writing a dash\n[/quote]\n\nJust in case this isn't known, I'll share that there is a full list of available shorthands here: https://typst.app/docs/reference/symbols/#shorthands\n\n- `--` for en dash\n- `---` for em dash\n- `...` for ellipsis\n\n[quote=\"gour, post:3, topic:4008\"]\ncreating show rules is the way to go in Typst- :sunglasses:\n[/quote]\n\nYeah, if you want to customize every occurrence of a certain special character, using a show rule just on that character is the way to go.\n\n[quote=\"Andrew, post:4, topic:4008\"]\nNo, not everything should use text show rule.\n[/quote]\n\nI believe they weren't necessarily referring to text show rules. But yes, be careful to not use a text show rule when you could use a variable or function instead (e.g. to apply some specific styling or display a constant multiple times).\n\nIn this case a text show rule is appropriate as it is about changing the styling of the document. In other words, if a package inserts text with an em dash, you want that em dash to be affected, so a global text show rule makes sense. But you wouldn't want the word \"number\" from another package to be affected when creating a constant named \"number\", for example, so you should create a  _variable_ named `number` instead of a show rule on that word.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 2,
      "like_count": 2,
      "reads": 21,
      "score": 34.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:48:07.535604"
}
{
  "topic_metadata": {
    "id": 4010,
    "title": "How to get size of image when using ratio scaling?",
    "slug": "how-to-get-size-of-image-when-using-ratio-scaling",
    "posts_count": 3,
    "created_at": "2025-05-09T18:12:25.074Z",
    "last_posted_at": "2025-05-09T18:57:07.376Z",
    "views": 50,
    "like_count": 2,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "scripting",
      "layout",
      "graphics"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 167
  },
  "posts": [
    {
      "id": 12197,
      "post_number": 1,
      "username": "miles-1",
      "name": "miles",
      "created_at": "2025-05-09T18:12:25.282Z",
      "updated_at": "2025-05-09T18:12:25.282Z",
      "cooked": "<p>In the following code, the measurement of the image is reported to be <code>(width: 0pt, height: 0pt)</code> when using ratios for sizes. I can understand why, as the variable <code>k</code> might be reused in a different context where it could be a different size. <strong>How can I get the size of one use of the image?</strong> I’ve tried using <code>label</code>s, moving around where <code>context</code> is used, and trying things with additional variables inside <code>context</code>, all to no avail.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let k = image(\"1.png\", width: 100%)\n\n#context [\n  #k\n  #measure(k)\n]\n</code></pre>",
      "raw": "In the following code, the measurement of the image is reported to be `(width: 0pt, height: 0pt)` when using ratios for sizes. I can understand why, as the variable `k` might be reused in a different context where it could be a different size. **How can I get the size of one use of the image?** I've tried using `label`s, moving around where `context` is used, and trying things with additional variables inside `context`, all to no avail.\n\n```typst\n#let k = image(\"1.png\", width: 100%)\n\n#context [\n  #k\n  #measure(k)\n]\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 95.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 177
    },
    {
      "id": 12199,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-09T18:44:54.019Z",
      "updated_at": "2025-05-09T18:44:54.019Z",
      "cooked": "<p><a href=\"https://typst.app/docs/reference/layout/measure/\" class=\"inline-onebox\">Measure Function – Typst Documentation</a> :</p>\n<blockquote>\n<p>By default an infinite space is assumed, so the measured dimensions may not necessarily match the final dimensions of the content. If you want to measure in the current layout dimensions, you can combine <code>measure</code> and <a href=\"https://typst.app/docs/reference/layout/layout/\"><code>layout</code></a>.</p>\n</blockquote>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#layout(size =&gt; measure(k, ..size))\n</code></pre>\n<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/docs/reference/layout/layout/\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/docs/reference/layout/layout/\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/docs/reference/layout/layout/\" target=\"_blank\" rel=\"noopener\">Layout Function – Typst Documentation</a></h3>\n\n  <p>Documentation for the `layout` function.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "https://typst.app/docs/reference/layout/measure/ :\n> By default an infinite space is assumed, so the measured dimensions may not necessarily match the final dimensions of the content. If you want to measure in the current layout dimensions, you can combine `measure` and [`layout`](https://typst.app/docs/reference/layout/layout/).\n\n\n```typ\n#layout(size => measure(k, ..size))\n```\nhttps://typst.app/docs/reference/layout/layout/",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 24,
      "score": 24.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12200,
      "post_number": 3,
      "username": "miles-1",
      "name": "miles",
      "created_at": "2025-05-09T18:57:07.376Z",
      "updated_at": "2025-05-09T18:57:07.376Z",
      "cooked": "<p>Yet another instance of me not reading the docs close enough</p>",
      "raw": "Yet another instance of me not reading the docs close enough",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 23,
      "score": 19.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 177
    }
  ],
  "scraped_at": "2025-06-10T09:48:06.795399"
}
{
  "topic_metadata": {
    "id": 4018,
    "title": "How to reproduce a stress diagram image in Typst?",
    "slug": "how-to-reproduce-a-stress-diagram-image-in-typst",
    "posts_count": 11,
    "created_at": "2025-05-10T16:26:02.263Z",
    "last_posted_at": "2025-05-11T19:47:42.394Z",
    "views": 136,
    "like_count": 5,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 7,
    "accepted_answer_username": "Andrew",
    "tags": [
      "graphics",
      "lilaq"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 961
  },
  "posts": [
    {
      "id": 12231,
      "post_number": 1,
      "username": "TlidYou",
      "name": "TlidYou",
      "created_at": "2025-05-10T16:26:02.389Z",
      "updated_at": "2025-05-11T16:56:28.504Z",
      "cooked": "<p>Hi everyone,</p>\n<p>I’m trying to recreate a stress diagram in Typst that includes:</p>\n<ul>\n<li>A grid with labeled axes (Normal stress vs. Shear stress)</li>\n<li>A straight line representing a failure envelope (starting from the cohesion intercept)</li>\n<li>Several circular data points along the line</li>\n<li>An annotated point labeled (320, 138)</li>\n<li>A text box in the top-right corner showing <code>c = 34 kN/m²</code> and <code>ϕ = 20°</code></li>\n</ul>\n<p>Here’s the reference image I’m trying to replicate:<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/8a99a479635a821a582c7952b7efdc6aa78f7fb6.png\" data-download-href=\"https://forum.typst.app/uploads/default/8a99a479635a821a582c7952b7efdc6aa78f7fb6\" title=\"page_295 conv 1\"><img src=\"https://forum.typst.app/uploads/default/original/2X/8/8a99a479635a821a582c7952b7efdc6aa78f7fb6.png\" alt=\"page_295 conv 1\" data-base62-sha1=\"jM74eYkie5y6ybTXV4InGDwxGZM\" width=\"690\" height=\"412\" data-dominant-color=\"F2F1F1\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">page_295 conv 1</span><span class=\"informations\">1174×702 14.2 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\nI’ve started writing some code using lilaq</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/lilaq:0.1.0\" as lq\n\n#let xs = (100, 200, 300, 400)\n\n#lq.diagram(\n  width: 15cm, \n  height: 7cm,\n  ylim: (30, 350),\n  xlim: (0, 450),\n  margin: (x: 5%),\n  title: [Data],\n  xlabel: $sigma_n | k N\\/m^2$, \n  ylabel: $tau | k N\\/m^2$,\n\n  lq.scatter(xs, (72.2, 105.6, 144.4, 177.7), mark: \"s\", label: [A]),\n \n)\n</code></pre>\n<p>Thanks a lot in advance for your help!</p>",
      "raw": "Hi everyone,\n\nI'm trying to recreate a stress diagram in Typst that includes:\n\n* A grid with labeled axes (Normal stress vs. Shear stress)\n* A straight line representing a failure envelope (starting from the cohesion intercept)\n* Several circular data points along the line\n* An annotated point labeled (320, 138)\n* A text box in the top-right corner showing `c = 34 kN/m²` and `ϕ = 20°`\n\nHere’s the reference image I'm trying to replicate:\n![page_295 conv 1|690x412](upload://jM74eYkie5y6ybTXV4InGDwxGZM.png)\nI've started writing some code using lilaq\n\n```typ\n#import \"@preview/lilaq:0.1.0\" as lq\n\n#let xs = (100, 200, 300, 400)\n\n#lq.diagram(\n  width: 15cm, \n  height: 7cm,\n  ylim: (30, 350),\n  xlim: (0, 450),\n  margin: (x: 5%),\n  title: [Data],\n  xlabel: $sigma_n | k N\\/m^2$, \n  ylabel: $tau | k N\\/m^2$,\n\n  lq.scatter(xs, (72.2, 105.6, 144.4, 177.7), mark: \"s\", label: [A]),\n \n)\n```\nThanks a lot in advance for your help!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 47,
      "score": 49.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1467
    },
    {
      "id": 12232,
      "post_number": 2,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-05-10T16:59:46.483Z",
      "updated_at": "2025-05-10T22:40:45.294Z",
      "cooked": "<p>Hi there <a class=\"mention\" href=\"/u/tlidyou\">@TlidYou</a>,</p>\n<p>Nice job getting accustomed to using <code>Lilaq</code>. It is worth mentioning that <code>Lilaq</code> is now v. 0.3.0 and should be imported using:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/lilaq:0.2.0\" as lq //0.3.0 waiting for PR to be released\n</code></pre>\n<p>What can we help you with exactly? Your question is obviously about reproducing the image, but it seems what you are looking for is some advice on how to use <code>Lilaq</code> for that purpose, am I correct?</p>\n<p>If so, could you please give a more precise description of what you are looking for (change <a href=\"https://lilaq.org/docs/tutorials/marks\" class=\"inline-onebox\">Marks − Lilaq</a> for example) and how we can help?</p>\n<p>Or are you just looking for someone to replicate the whole thing for you instead?</p>\n<p>Also please tag your question with the appropriate tags (such as <a class=\"hashtag-cooked\" href=\"/tag/lilaq\" data-type=\"tag\" data-slug=\"lilaq\" data-id=\"160\"><span class=\"hashtag-icon-placeholder\"><svg class=\"fa d-icon d-icon-square-full svg-icon svg-node\"><use href=\"#square-full\"></use></svg></span><span>lilaq</span></a>) for traceability.</p>",
      "raw": "Hi there @TlidYou, \n\nNice job getting accustomed to using `Lilaq`. It is worth mentioning that `Lilaq` is now v. 0.3.0 and should be imported using:\n\n```typ \n#import \"@preview/lilaq:0.2.0\" as lq //0.3.0 waiting for PR to be released\n```\nWhat can we help you with exactly? Your question is obviously about reproducing the image, but it seems what you are looking for is some advice on how to use `Lilaq` for that purpose, am I correct? \n\nIf so, could you please give a more precise description of what you are looking for (change https://lilaq.org/docs/tutorials/marks for example) and how we can help? \n\nOr are you just looking for someone to replicate the whole thing for you instead?\n\nAlso please tag your question with the appropriate tags (such as #lilaq) for traceability.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 45,
      "score": 29.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 12233,
      "post_number": 3,
      "username": "TlidYou",
      "name": "TlidYou",
      "created_at": "2025-05-10T19:36:18.292Z",
      "updated_at": "2025-05-10T19:36:18.292Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/vmartel08\">@vmartel08</a><br>\nAs a new Typst user, my goal was to draw a line starting at the point (0,34) with a slope defined by a 20° angle.</p>",
      "raw": "Hi @vmartel08 \nAs a new Typst user, my goal was to draw a line starting at the point (0,34) with a slope defined by a 20° angle.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 43,
      "score": 13.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1467
    },
    {
      "id": 12236,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-10T22:31:14.236Z",
      "updated_at": "2025-05-10T22:31:14.236Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"vmartel08\" data-post=\"2\" data-topic=\"4018\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/vmartel08/48/1586_2.png\" class=\"avatar\"> vmartel08:</div>\n<blockquote>\n<p>It is worth mentioning that <code>Lilaq</code> is now v. 0.3.0 and should be imported using:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/lilaq:0.3.0\" as lq\n</code></pre>\n</blockquote>\n</aside>\n<p>It is version 0.2.0.</p>",
      "raw": "[quote=\"vmartel08, post:2, topic:4018\"]\nIt is worth mentioning that `Lilaq` is now v. 0.3.0 and should be imported using:\n\n```typ\n#import \"@preview/lilaq:0.3.0\" as lq\n```\n[/quote]\n\nIt is version 0.2.0.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 38,
      "score": 7.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12237,
      "post_number": 5,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-05-10T22:38:35.067Z",
      "updated_at": "2025-05-10T22:38:35.067Z",
      "cooked": "<p>Yes, my bad, the <a href=\"https://github.com/typst/packages/pull/2338\" class=\"inline-onebox\">lilaq:0.3.0 by Mc-Zen · Pull Request #2338 · typst/packages · GitHub</a> has not been released on Universe yet.</p>",
      "raw": "Yes, my bad, the https://github.com/typst/packages/pull/2338 has not been released on Universe yet.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 39,
      "score": 7.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 12238,
      "post_number": 6,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-05-10T23:39:27.711Z",
      "updated_at": "2025-05-10T23:39:27.711Z",
      "cooked": "<p>You seem to have a good start for the labels and dimensions. Try:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#lq.diagram(\n  lq.plot(\n    range(640),\n    range(640).map(x =&gt; 1/2.7475 * x + 34),\n    every: 100\n  ),\n  lq.scatter((320,),(138,), mark: \"o\"),\n\n  lq.place(95%, 20%, align: right, box(stroke: 1pt, inset: 2pt, [Some text \\ and more])\n  ),\n)\n</code></pre>",
      "raw": "You seem to have a good start for the labels and dimensions. Try:\n\n```typ\n#lq.diagram(\n  lq.plot(\n    range(640),\n    range(640).map(x => 1/2.7475 * x + 34),\n    every: 100\n  ),\n  lq.scatter((320,),(138,), mark: \"o\"),\n\n  lq.place(95%, 20%, align: right, box(stroke: 1pt, inset: 2pt, [Some text \\ and more])\n  ),\n)\n```",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 42,
      "score": 8.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 12240,
      "post_number": 7,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T00:52:55.006Z",
      "updated_at": "2025-05-13T15:16:54.962Z",
      "cooked": "<p>Hi. I have no idea how to make accurate arcs other than using CeTZ, so this is why I use it here (although I guess you don’t need it anyway):</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/lilaq:0.2.0\" as lq\n#import \"@preview/cetz:0.3.4\"\n\n#let slope = 20deg\n#let f(x) = calc.tan(slope) * x + 34\n\n#show: lq.set-tick(inset: 0pt)\n#show: lq.set-grid(stroke: black, stroke-sub: 0.5pt)\n#show: lq.set-diagram(cycle: (\n  it =&gt; {\n    set lq.style(stroke: 0.5pt + black)\n    it\n  },\n))\n\n// In the future, can be set with set lq.mark(stroke: black, fill: white)\n#let lq-scatter = lq.scatter.with(stroke: black, color: white)\n// In the future, can be set with set lq.style(stroke: black, fill: white)\n#let lq-rect = lq.rect.with(stroke: black, fill: white)\n\n#let point(x, y, size: 3mm, color: black, align: left, offset: 0.6em) = {\n  let body = {\n    set text(top-edge: \"bounds\", bottom-edge: \"bounds\")\n    box(fill: white)[$(#x, #y)$]\n  }\n  (\n    lq.scatter((x,), (y,), size: size, color: color),\n    lq.place(x, y, align: align, pad(offset, body)),\n  )\n}\n\n#let y-max = 400\n#let x-max = 640\n#lq.diagram(\n  width: 15cm,\n  height: 15cm * y-max / x-max,\n  ylim: (0, y-max),\n  xlim: (0, x-max),\n  yaxis: (tick-distance: 80, subticks: 1),\n  xaxis: (tick-distance: 80, subticks: 1),\n  xlabel: [Normal stress, $k N\\/m^2$],\n  ylabel: [Shear stress, $k N\\/m^2$],\n\n  let xs = lq.linspace(0, 590),\n  lq.plot(xs, xs.map(f), mark: none),\n\n  lq.line((520, 223), (555, 223), stroke: 0.5pt),\n  lq.place(520, 223, cetz.canvas({\n    cetz.draw.circle((0, 0), radius: 0.8, stroke: 0pt) // Positioning hack.\n    let arc = cetz.draw.arc.with(anchor: \"origin\")\n    arc((0, 0), start: 0deg, delta: slope, radius: 0.7, stroke: 0.5pt)\n  })),\n\n  let xs = (100, 200, 300, 400),\n  lq-scatter(xs, xs.map(f), size: 6mm),\n  // Coordinate-based size can be achieved with ellipse in the future.\n\n  ..point(320, 138),\n\n  lq-rect(400, 320, width: 160, height: 80),\n  lq.place(400 + 80, 320 + 40)[\n    #set par(leading: 0.4em)\n    $\n      c = 34 med k N\\/m^2 \\\n      phi.alt = 20 degree \\\n    $\n  ],\n)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/897e2a9968acb4d919084bc2bf8294d3663a0d9d.png\" data-download-href=\"https://forum.typst.app/uploads/default/897e2a9968acb4d919084bc2bf8294d3663a0d9d\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/897e2a9968acb4d919084bc2bf8294d3663a0d9d_2_690x441.png\" alt=\"image\" data-base62-sha1=\"jCjIRZH4BYX63xOZ6x8XbVnbl0h\" width=\"690\" height=\"441\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/8/897e2a9968acb4d919084bc2bf8294d3663a0d9d_2_690x441.png, https://forum.typst.app/uploads/default/original/2X/8/897e2a9968acb4d919084bc2bf8294d3663a0d9d.png 1.5x, https://forum.typst.app/uploads/default/original/2X/8/897e2a9968acb4d919084bc2bf8294d3663a0d9d.png 2x\" data-dominant-color=\"191919\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">810×518 34.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>With the upcoming Lilaq version, some stuff probably can be simplified, or maybe even right now.</p>\n<aside class=\"onebox githubissue\" data-onebox-src=\"https://github.com/lilaq-project/lilaq/issues/16\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/lilaq-project/lilaq/issues/16\" target=\"_blank\" rel=\"noopener\">github.com/lilaq-project/lilaq</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"github-row\">\n  <div class=\"github-icon-container\" title=\"Issue\" data-github-private-repo=\"false\">\n\t  <svg width=\"60\" height=\"60\" class=\"github-icon\" viewBox=\"0 0 14 16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg>\n  </div>\n\n  <div class=\"github-info-container\">\n    <h4>\n      <a href=\"https://github.com/lilaq-project/lilaq/issues/16\" target=\"_blank\" rel=\"noopener\">Feature Request: add ability to attach labels to points and lines</a>\n    </h4>\n\n    <div class=\"github-info\">\n      <div class=\"date\">\n        opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2025-04-06\" data-time=\"18:53:25\" data-timezone=\"UTC\">06:53PM - 06 Apr 25 UTC</span>\n      </div>\n\n\n      <div class=\"user\">\n        <a href=\"https://github.com/adrfantini\" target=\"_blank\" rel=\"noopener\">\n          <img alt=\"adrfantini\" src=\"https://forum.typst.app/uploads/default/original/2X/4/4159a3cae031dc39c6dcc13ca82ff6ff7324938c.jpeg\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\" data-dominant-color=\"675A54\">\n          adrfantini\n        </a>\n      </div>\n    </div>\n\n    <div class=\"labels\">\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          enhancement\n        </span>\n    </div>\n  </div>\n</div>\n\n  <div class=\"github-row\">\n    <p class=\"github-body-container\">Very often, one needs to label points in a plot so that each is associated with <span class=\"show-more-container\"><a href=\"\" rel=\"noopener\" class=\"show-more\">…</a></span><span class=\"excerpt hidden\">a string (or `content` in Typst).\n\nCurrently, I would say that the best way to do this in Lilaq is either:\n- to use `scatter` and pass stylised marks with the label content, with some offset\n- to use `place` and place a label for each mark, with some offset\n\nFor example:\n\n```\n#lq.diagram(\n  lq.plot((-1, 0, 1, 2, 3, 4), (3, 5, 4, 2, 1, 2)),\n  lq.place(0, 5, [Max], align: left),\n  lq.place(3, 1, [Min], align: right),\n)\n```\n\nWhich produces:\n![Image](https://github.com/user-attachments/assets/8b6b17ad-90b3-4ce4-90cc-3df81a4e406f)\n\nIt works... but it's not the best-looking result.\nTo improve it, one must manually fiddle with the position of the labels.\n\nThe primary objective is of course to properly dodge points and axes so that there is no overlap / clipping.\nThis often requires manual handling of each point label, which is time-consuming and error-prone.\n\nI believe this is a common enough usecase that it warrants its specific syntax, or at least a guide on how to do this in a simple way.\n\n---\n\nIn `ggplot`, which is my go-to reference for anything that relates to programmatic plotting, this is handled by `geom_label` with `nudge` and `alignement` parameters: https://ggplot2.tidyverse.org/reference/geom_text.html\nThe `alignement` parameter also as `inward` and `outward` built-ins which I think are pretty cool.\nThere is even an extension that specifically repels label so they do not overlap with other stuff, and it's awesome: https://ggrepel.slowkow.com\n\n---\n\nThe same applies to other kind of shapes, such as `lines` for example.\nIf using `cetz`, it is very easy to [anchor](https://cetz-package.github.io/docs/basics/coordinate-systems#anchor) some text to the middle of a line (even if curved!); that's really useful to label plot elements.</span></p>\n  </div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "Hi. I have no idea how to make accurate arcs other than using CeTZ, so this is why I use it here (although I guess you don't need it anyway):\n\n```typ\n#import \"@preview/lilaq:0.2.0\" as lq\n#import \"@preview/cetz:0.3.4\"\n\n#let slope = 20deg\n#let f(x) = calc.tan(slope) * x + 34\n\n#show: lq.set-tick(inset: 0pt)\n#show: lq.set-grid(stroke: black, stroke-sub: 0.5pt)\n#show: lq.set-diagram(cycle: (\n  it => {\n    set lq.style(stroke: 0.5pt + black)\n    it\n  },\n))\n\n// In the future, can be set with set lq.mark(stroke: black, fill: white)\n#let lq-scatter = lq.scatter.with(stroke: black, color: white)\n// In the future, can be set with set lq.style(stroke: black, fill: white)\n#let lq-rect = lq.rect.with(stroke: black, fill: white)\n\n#let point(x, y, size: 3mm, color: black, align: left, offset: 0.6em) = {\n  let body = {\n    set text(top-edge: \"bounds\", bottom-edge: \"bounds\")\n    box(fill: white)[$(#x, #y)$]\n  }\n  (\n    lq.scatter((x,), (y,), size: size, color: color),\n    lq.place(x, y, align: align, pad(offset, body)),\n  )\n}\n\n#let y-max = 400\n#let x-max = 640\n#lq.diagram(\n  width: 15cm,\n  height: 15cm * y-max / x-max,\n  ylim: (0, y-max),\n  xlim: (0, x-max),\n  yaxis: (tick-distance: 80, subticks: 1),\n  xaxis: (tick-distance: 80, subticks: 1),\n  xlabel: [Normal stress, $k N\\/m^2$],\n  ylabel: [Shear stress, $k N\\/m^2$],\n\n  let xs = lq.linspace(0, 590),\n  lq.plot(xs, xs.map(f), mark: none),\n\n  lq.line((520, 223), (555, 223), stroke: 0.5pt),\n  lq.place(520, 223, cetz.canvas({\n    cetz.draw.circle((0, 0), radius: 0.8, stroke: 0pt) // Positioning hack.\n    let arc = cetz.draw.arc.with(anchor: \"origin\")\n    arc((0, 0), start: 0deg, delta: slope, radius: 0.7, stroke: 0.5pt)\n  })),\n\n  let xs = (100, 200, 300, 400),\n  lq-scatter(xs, xs.map(f), size: 6mm),\n  // Coordinate-based size can be achieved with ellipse in the future.\n\n  ..point(320, 138),\n\n  lq-rect(400, 320, width: 160, height: 80),\n  lq.place(400 + 80, 320 + 40)[\n    #set par(leading: 0.4em)\n    $\n      c = 34 med k N\\/m^2 \\\n      phi.alt = 20 degree \\\n    $\n  ],\n)\n```\n\n![image|690x441](upload://jCjIRZH4BYX63xOZ6x8XbVnbl0h.png)\n\nWith the upcoming Lilaq version, some stuff probably can be simplified, or maybe even right now.\n\nhttps://github.com/lilaq-project/lilaq/issues/16",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 40,
      "score": 58.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12244,
      "post_number": 8,
      "username": "TlidYou",
      "name": "TlidYou",
      "created_at": "2025-05-11T07:49:40.272Z",
      "updated_at": "2025-05-11T07:49:40.272Z",
      "cooked": "<p>Thank you <a class=\"mention\" href=\"/u/andrew\">@Andrew</a>  and <a class=\"mention\" href=\"/u/vmartel08\">@vmartel08</a>  for your time.</p>",
      "raw": "Thank you @Andrew  and @vmartel08  for your time.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 36,
      "score": 37.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1467
    },
    {
      "id": 12290,
      "post_number": 9,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-05-11T19:23:23.926Z",
      "updated_at": "2025-05-11T19:23:23.926Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"7\" data-topic=\"4018\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>Hi. I have no idea how to make accurate arcs other than using CeTZ</p>\n</blockquote>\n</aside>\n<p>Is there a way to achieve this with Lilaq <a class=\"mention\" href=\"/u/mc-zen\">@Mc-Zen</a>? The CeTZ solution is quite easy to implement but I could not reproduce it with Lilaq…</p>",
      "raw": "[quote=\"Andrew, post:7, topic:4018\"]\nHi. I have no idea how to make accurate arcs other than using CeTZ\n[/quote]\n\nIs there a way to achieve this with Lilaq @Mc-Zen? The CeTZ solution is quite easy to implement but I could not reproduce it with Lilaq…",
      "reply_to_post_number": 7,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 29,
      "score": 10.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 936
    },
    {
      "id": 12293,
      "post_number": 10,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2025-05-11T19:35:14.947Z",
      "updated_at": "2025-05-11T19:35:14.947Z",
      "cooked": "<p>You could use <code>lq.path</code> to draw the arc manually I guess. I don’t know, would it be worth to add an <code>arc</code> primitive to Lilaq? Maybe. Using <code>tiptoe</code>, this wouldn’t be too hard.</p>",
      "raw": "You could use `lq.path` to draw the arc manually I guess. I don't know, would it be worth to add an `arc` primitive to Lilaq? Maybe. Using `tiptoe`, this wouldn't be too hard.",
      "reply_to_post_number": 9,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 10.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    },
    {
      "id": 12295,
      "post_number": 11,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T19:47:42.394Z",
      "updated_at": "2025-05-11T19:47:42.394Z",
      "cooked": "<p>I think so. I had to use it <a href=\"https://forum.typst.app/t/help-drawing-a-soil-profile-diagram-with-inclined-backfill-in-typst/3910/3\">here</a> too, though that was fully with CeTZ. I don’t know how common arcs are on diagrams, but I guess sometimes they are used.</p>",
      "raw": "I think so. I had to use it [here](https://forum.typst.app/t/help-drawing-a-soil-profile-diagram-with-inclined-backfill-in-typst/3910/3?u=andrew) too, though that was fully with CeTZ. I don't know how common arcs are on diagrams, but I guess sometimes they are used.",
      "reply_to_post_number": 10,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 5.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:48:06.079809"
}
{
  "topic_metadata": {
    "id": 4019,
    "title": "How to avoid the space inserted after a function call?",
    "slug": "how-to-avoid-the-space-inserted-after-a-function-call",
    "posts_count": 2,
    "created_at": "2025-05-10T19:38:22.485Z",
    "last_posted_at": "2025-05-10T19:58:22.480Z",
    "views": 39,
    "like_count": 1,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "janekfleper",
    "tags": [
      "scripting",
      "syntax"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 110
  },
  "posts": [
    {
      "id": 12234,
      "post_number": 1,
      "username": "Olaf",
      "name": "Olaf",
      "created_at": "2025-05-10T19:38:22.603Z",
      "updated_at": "2025-05-10T20:13:18.463Z",
      "cooked": "<p>When I apply a function to a section, a space is inserted after the call. How do I get rid of this space?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let noop(content) = [\n  #content\n]\n\n\n// These two lines generate the same output:\n\n#noop[abc]def\n\n#noop[abc] def\n</code></pre>",
      "raw": "When I apply a function to a section, a space is inserted after the call. How do I get rid of this space? \n\n\n```typ\n#let noop(content) = [\n  #content\n]\n\n\n// These two lines generate the same output:\n\n#noop[abc]def\n\n#noop[abc] def\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 54.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 418
    },
    {
      "id": 12235,
      "post_number": 2,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-05-10T19:58:22.480Z",
      "updated_at": "2025-05-10T19:58:47.506Z",
      "cooked": "<p>The space is inserted because of the newline characters that are part of your function. If you only want to show the content, you have to remove the newline characters (and spaces) around the content. Alternatively you could use curly braces to use the code mode in your function. Newline characters and spaces would be ignored in that case.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let noop(content) = [#content]\n// or\n#let noop(content) = {\n  content\n}\n</code></pre>",
      "raw": "The space is inserted because of the newline characters that are part of your function. If you only want to show the content, you have to remove the newline characters (and spaces) around the content. Alternatively you could use curly braces to use the code mode in your function. Newline characters and spaces would be ignored in that case.\n\n```typ\n#let noop(content) = [#content]\n// or\n#let noop(content) = {\n  content\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 21,
      "score": 19.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 69
    }
  ],
  "scraped_at": "2025-06-10T09:48:05.325316"
}
{
  "topic_metadata": {
    "id": 4020,
    "title": "How to define a color gradient over multiple paragraphs?",
    "slug": "how-to-define-a-color-gradient-over-multiple-paragraphs",
    "posts_count": 3,
    "created_at": "2025-05-10T23:59:24.433Z",
    "last_posted_at": "2025-05-13T18:49:31.014Z",
    "views": 58,
    "like_count": 2,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "styling"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 711
  },
  "posts": [
    {
      "id": 12239,
      "post_number": 1,
      "username": "AprilGrimoire",
      "name": "AprilGrimoire",
      "created_at": "2025-05-10T23:59:24.836Z",
      "updated_at": "2025-05-12T06:49:11.112Z",
      "cooked": "<p>Hi.</p>\n<p>Here is an example given in <a href=\"https://typst.app/universe/package/derive-it/\">derive-it</a>:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/2/2ec8db8c4210ab5863ea39c7233bc47744bb6298.png\" data-download-href=\"https://forum.typst.app/uploads/default/2ec8db8c4210ab5863ea39c7233bc47744bb6298\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/2/2ec8db8c4210ab5863ea39c7233bc47744bb6298_2_690x411.png\" alt=\"image\" data-base62-sha1=\"6FSixFS3hyJbQOO4Apl9iPZgj5C\" width=\"690\" height=\"411\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/2/2ec8db8c4210ab5863ea39c7233bc47744bb6298_2_690x411.png, https://forum.typst.app/uploads/default/optimized/2X/2/2ec8db8c4210ab5863ea39c7233bc47744bb6298_2_1035x616.png 1.5x, https://forum.typst.app/uploads/default/original/2X/2/2ec8db8c4210ab5863ea39c7233bc47744bb6298.png 2x\" data-dominant-color=\"FAF9FA\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1045×623 135 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>The color looks cool, but different texts have their individual color gradients. How to achieve the effect of a total overall color gradient independent of what text part some character belongs to?</p>\n<p>Thanks!</p>",
      "raw": "Hi.\n\nHere is an example given in [derive-it](https://typst.app/universe/package/derive-it/):\n\n![image|690x411](upload://6FSixFS3hyJbQOO4Apl9iPZgj5C.png)\n\nThe color looks cool, but different texts have their individual color gradients. How to achieve the effect of a total overall color gradient independent of what text part some character belongs to?\n\nThanks!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 20.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1309
    },
    {
      "id": 12250,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T11:58:58.489Z",
      "updated_at": "2025-05-13T19:51:00.333Z",
      "cooked": "<p>Hi, do you want this?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set par(justify: true)\n#set text(gradient.linear(red, blue, angle: 45deg))\n#range(11).map(_ =&gt; lorem(55)).intersperse(parbreak()).join()\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/95907fd294bc091dc74fad73511a66735b4c3be9.png\" data-download-href=\"https://forum.typst.app/uploads/default/95907fd294bc091dc74fad73511a66735b4c3be9\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/95907fd294bc091dc74fad73511a66735b4c3be9_2_167x250.png\" alt=\"image\" data-base62-sha1=\"ll6JlDgu8VoATpC5z4mDomRc1hn\" width=\"167\" height=\"250\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/95907fd294bc091dc74fad73511a66735b4c3be9_2_167x250.png, https://forum.typst.app/uploads/default/optimized/2X/9/95907fd294bc091dc74fad73511a66735b4c3be9_2_250x375.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/9/95907fd294bc091dc74fad73511a66735b4c3be9_2_334x500.png 2x\" data-dominant-color=\"221E22\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">589×878 387 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/docs/reference/visualize/gradient/#relativeness\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/docs/reference/visualize/gradient/#relativeness\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/docs/reference/visualize/gradient/#relativeness\" target=\"_blank\" rel=\"noopener\">Gradient Type – Typst Documentation</a></h3>\n\n  <p>Documentation for the Gradient type.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<hr>\n<p>The package uses a lot of containers, so, if you remove most of them:</p>\n<details><summary>Code</summary>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">    let index = [#(i+1).]\n\n    let tmpWidth = 0pt\n    let dependency = \"\"\n    if hasDependencies {\n      dependency = text(style: \"italic\", weight: \"regular\", [#dep])\n      tmpWidth = measure[#dependency #index #bl].width\n    } else {\n      tmpWidth = measure[#index #bl].width\n    }\n\n    if tmpWidth &gt; maxWidth {\n      maxWidth = tmpWidth\n    }\n\n    let ins = if indent == 0 {(x: 0pt, y: 0.5em)} else {(x: 0pt, y: 0pt)}\n    let numInset = if indent == 0 {(x: 0pt, y: 0.0pt)} else {(x: 0pt, y: 5pt)}\n\n    let line = \"\"\n    if hasDependencies {\n      line = [#[#dependency #index] #bl]\n    }\n\n    tupArr.push((line, rule))\n  }\n  tupArr = tupArr.map(a =&gt; [#box(width: maxWidth + 0em, a.at(0)) #h(1em) #a.at(1)])\n\n  text(weight: \"bold\",\n    block(\n      align(start,\n        stack(dir: ttb, spacing: 1em, ..tupArr)\n      )\n    )\n  )\n</code></pre>\n</details>\n<p>Then it looks more or less correct:</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/8/814f8143cb777a90b095c44d54b766498cb92312.png\" alt=\"image\" data-base62-sha1=\"irVVNwnfXgwr0CzpAbEZOwMMdGO\" width=\"190\" height=\"211\"></p>\n<p>If all boxes are removed from <code>ded-nat()</code>, then you can get a single source of gradient color:</p>\n<details><summary>Code</summary>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let ded-nat(stcolor: black, arr: array) = context {\n  let strart = (top: 0em, right: 0em, bottom: 0em, left: 1pt + stcolor)\n  let strend = (\n    top: 0em,\n    right: 0em,\n    bottom: 1pt + stcolor,\n    left: 1pt + stcolor,\n  )\n\n  // check if the first line's array has 4 items (w/dependencies) or not\n  let (hasDependencies, lineSize) = if arr.at(0).len() == 4 { (true, 4) } else {\n    (false, 3)\n  }\n\n  let maxDepWidth = if hasDependencies {\n    arr.fold(0pt, (accum, it) =&gt; {\n      let sz = measure[#it.at(0)].width\n      if sz &gt; accum { sz } else { accum }\n    })\n  } else {\n    0pt\n  }\n\n  let maxWidth = 0pt\n  let tupArr = ()\n\n  for (i, line) in arr.enumerate(start: 0) {\n    if i == 0 {\n      derive-it-internal-validate-line(line, i + 1)\n    }\n\n    let (dep, indent, formula, rule) = if hasDependencies {\n      line\n    } else {\n      (\"\", line.at(0), line.at(1), line.at(2))\n    }\n\n\n    let isLastIndented = (\n      (arr.len() &gt; i + 1)\n        and (\n          {\n            let ix = if hasDependencies { 1 } else { 0 }\n            let next-line = arr.at(i + 1)\n            derive-it-internal-validate-line(\n              next-line,\n              i + 1,\n              line-size: lineSize,\n            )\n            next-line.at(ix)\n          }\n            &lt; indent\n        )\n    )\n\n    let bl = formula\n\n    for i in range(0, indent) {\n      let inset = if i != 0 { 0pt } else { 0pt }\n\n      let str = if i == 0 and isLastIndented {\n        strend\n      } else { strart }\n\n      if indent &gt; 0 and i &lt; indent - 1 {\n        inset = -5pt\n      }\n    }\n    let index = [#(i + 1).]\n\n    let tmpWidth = 0pt\n    let dependency = \"\"\n    if hasDependencies {\n      dependency = text(style: \"italic\", weight: \"regular\", [#dep])\n      tmpWidth = measure[#dependency #index #bl].width\n    } else {\n      tmpWidth = measure[#index #bl].width\n    }\n\n    if tmpWidth &gt; maxWidth {\n      maxWidth = tmpWidth\n    }\n\n    let ins = if indent == 0 { (x: 0pt, y: 0.5em) } else { (x: 0pt, y: 0pt) }\n    let numInset = if indent == 0 { (x: 0pt, y: 0.0pt) } else {\n      (x: 0pt, y: 5pt)\n    }\n\n    tupArr.push(([#dependency #index #bl], rule))\n  }\n  tupArr = tupArr.map(a =&gt; [#a.at(0) #h(1em) #a.at(1)])\n\n  text(weight: \"bold\", align(start, stack(dir: ttb, spacing: 1em, ..tupArr)))\n}\n</code></pre>\n</details>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/derive-it:0.1.3\": *\n\n#set text(weight: \"bold\", fill: gradient.linear(red, blue, angle: 45deg))\n#ded-nat-boxed(stcolor: gradient.linear(red, blue), arr: (\n  (\"1\", 0, $forall x (P x) and forall x (Q x)$, \"PR\"),\n  (\"2\", 0, $forall x (P x -&gt; R x)$, \"PR\"),\n  (\"1\", 0, $forall x (P x)$, \"S 1\"),\n  (\"1\", 0, $P a$, \"IU 3\"),\n  (\"2\", 0, $P a -&gt; R a$, \"IU 2\"),\n  (\"1,2\", 0, $R a$, \"MP 4, 5\"),\n  (\"1,2\", 0, $forall x (R x)$, \"GU 6\"),\n))\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/7/767913fca88978095c73f04ccbc1d30277858794.png\" alt=\"image\" data-base62-sha1=\"gU3KvlutfRFTTY6u72i9b4SFiio\" width=\"201\" height=\"259\"></p>\n<p>So, you either fork it, or ask author for gradient to be able to be uniform.</p>",
      "raw": "Hi, do you want this?\n\n```typ\n#set par(justify: true)\n#set text(gradient.linear(red, blue, angle: 45deg))\n#range(11).map(_ => lorem(55)).intersperse(parbreak()).join()\n```\n\n![image|335x500, 50%](upload://ll6JlDgu8VoATpC5z4mDomRc1hn.png)\n\nhttps://typst.app/docs/reference/visualize/gradient/#relativeness\n\n---\n\nThe package uses a lot of containers, so, if you remove most of them:\n\n<details><summary>Code</summary>\n\n```typc\n    let index = [#(i+1).]\n\n    let tmpWidth = 0pt\n    let dependency = \"\"\n    if hasDependencies {\n      dependency = text(style: \"italic\", weight: \"regular\", [#dep])\n      tmpWidth = measure[#dependency #index #bl].width\n    } else {\n      tmpWidth = measure[#index #bl].width\n    }\n\n    if tmpWidth > maxWidth {\n      maxWidth = tmpWidth\n    }\n\n    let ins = if indent == 0 {(x: 0pt, y: 0.5em)} else {(x: 0pt, y: 0pt)}\n    let numInset = if indent == 0 {(x: 0pt, y: 0.0pt)} else {(x: 0pt, y: 5pt)}\n\n    let line = \"\"\n    if hasDependencies {\n      line = [#[#dependency #index] #bl]\n    }\n\n    tupArr.push((line, rule))\n  }\n  tupArr = tupArr.map(a => [#box(width: maxWidth + 0em, a.at(0)) #h(1em) #a.at(1)])\n\n  text(weight: \"bold\",\n    block(\n      align(start,\n        stack(dir: ttb, spacing: 1em, ..tupArr)\n      )\n    )\n  )\n```\n\n</details>\n\nThen it looks more or less correct:\n\n![image|380x422, 50%](upload://irVVNwnfXgwr0CzpAbEZOwMMdGO.png)\n\nIf all boxes are removed from `ded-nat()`, then you can get a single source of gradient color:\n\n<details><summary>Code</summary>\n\n```typ\n#let ded-nat(stcolor: black, arr: array) = context {\n  let strart = (top: 0em, right: 0em, bottom: 0em, left: 1pt + stcolor)\n  let strend = (\n    top: 0em,\n    right: 0em,\n    bottom: 1pt + stcolor,\n    left: 1pt + stcolor,\n  )\n\n  // check if the first line's array has 4 items (w/dependencies) or not\n  let (hasDependencies, lineSize) = if arr.at(0).len() == 4 { (true, 4) } else {\n    (false, 3)\n  }\n\n  let maxDepWidth = if hasDependencies {\n    arr.fold(0pt, (accum, it) => {\n      let sz = measure[#it.at(0)].width\n      if sz > accum { sz } else { accum }\n    })\n  } else {\n    0pt\n  }\n\n  let maxWidth = 0pt\n  let tupArr = ()\n\n  for (i, line) in arr.enumerate(start: 0) {\n    if i == 0 {\n      derive-it-internal-validate-line(line, i + 1)\n    }\n\n    let (dep, indent, formula, rule) = if hasDependencies {\n      line\n    } else {\n      (\"\", line.at(0), line.at(1), line.at(2))\n    }\n\n\n    let isLastIndented = (\n      (arr.len() > i + 1)\n        and (\n          {\n            let ix = if hasDependencies { 1 } else { 0 }\n            let next-line = arr.at(i + 1)\n            derive-it-internal-validate-line(\n              next-line,\n              i + 1,\n              line-size: lineSize,\n            )\n            next-line.at(ix)\n          }\n            < indent\n        )\n    )\n\n    let bl = formula\n\n    for i in range(0, indent) {\n      let inset = if i != 0 { 0pt } else { 0pt }\n\n      let str = if i == 0 and isLastIndented {\n        strend\n      } else { strart }\n\n      if indent > 0 and i < indent - 1 {\n        inset = -5pt\n      }\n    }\n    let index = [#(i + 1).]\n\n    let tmpWidth = 0pt\n    let dependency = \"\"\n    if hasDependencies {\n      dependency = text(style: \"italic\", weight: \"regular\", [#dep])\n      tmpWidth = measure[#dependency #index #bl].width\n    } else {\n      tmpWidth = measure[#index #bl].width\n    }\n\n    if tmpWidth > maxWidth {\n      maxWidth = tmpWidth\n    }\n\n    let ins = if indent == 0 { (x: 0pt, y: 0.5em) } else { (x: 0pt, y: 0pt) }\n    let numInset = if indent == 0 { (x: 0pt, y: 0.0pt) } else {\n      (x: 0pt, y: 5pt)\n    }\n\n    tupArr.push(([#dependency #index #bl], rule))\n  }\n  tupArr = tupArr.map(a => [#a.at(0) #h(1em) #a.at(1)])\n\n  text(weight: \"bold\", align(start, stack(dir: ttb, spacing: 1em, ..tupArr)))\n}\n```\n\n</details>\n\n```typ\n#import \"@preview/derive-it:0.1.3\": *\n\n#set text(weight: \"bold\", fill: gradient.linear(red, blue, angle: 45deg))\n#ded-nat-boxed(stcolor: gradient.linear(red, blue), arr: (\n  (\"1\", 0, $forall x (P x) and forall x (Q x)$, \"PR\"),\n  (\"2\", 0, $forall x (P x -> R x)$, \"PR\"),\n  (\"1\", 0, $forall x (P x)$, \"S 1\"),\n  (\"1\", 0, $P a$, \"IU 3\"),\n  (\"2\", 0, $P a -> R a$, \"IU 2\"),\n  (\"1,2\", 0, $R a$, \"MP 4, 5\"),\n  (\"1,2\", 0, $forall x (R x)$, \"GU 6\"),\n))\n```\n\n![image|201x259](upload://gU3KvlutfRFTTY6u72i9b4SFiio.png)\n\nSo, you either fork it, or ask author for gradient to be able to be uniform.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 24,
      "score": 64.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12401,
      "post_number": 3,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2025-05-13T18:49:31.014Z",
      "updated_at": "2025-05-13T18:49:31.014Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/aprilgrimoire\">@AprilGrimoire</a>, thanks for your question! If you feel the response you got has sufficiently answered your question, be sure to give it a checkmark <img src=\"https://forum.typst.app/images/emoji/apple/ballot_box_with_check.png?v=12\" title=\":ballot_box_with_check:\" class=\"emoji\" alt=\":ballot_box_with_check:\" loading=\"lazy\" width=\"20\" height=\"20\">. This will help others find the solution in the future. If something is missing, please let us know what so we can resolve your issue. Thanks!</p>",
      "raw": "Hi @AprilGrimoire, thanks for your question! If you feel the response you got has sufficiently answered your question, be sure to give it a checkmark :ballot_box_with_check:. This will help others find the solution in the future. If something is missing, please let us know what so we can resolve your issue. Thanks!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 14,
      "score": 2.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:48:04.585724"
}
{
  "topic_metadata": {
    "id": 4022,
    "title": "How to use custom symbols as marks on fletcher arrows?",
    "slug": "how-to-use-custom-symbols-as-marks-on-fletcher-arrows",
    "posts_count": 7,
    "created_at": "2025-05-11T04:13:10.702Z",
    "last_posted_at": "2025-05-11T13:36:45.439Z",
    "views": 54,
    "like_count": 8,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "Jollywatt",
    "tags": [
      "cetz",
      "figures",
      "fletcher"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 532
  },
  "posts": [
    {
      "id": 12243,
      "post_number": 1,
      "username": "MJ.0",
      "name": "MJ",
      "created_at": "2025-05-11T04:13:10.812Z",
      "updated_at": "2025-05-11T04:13:10.812Z",
      "cooked": "<p>The goal is to draw simple diagrams to visualize different kinds of intervals on the number line, is it possible to define simple custom marks for fletcher arrows like shown below?:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#diagram($ a edge(\"[-]\") &amp; b $) // or ]-[ , [-[ , (-) and so on\n</code></pre>\n<p>I tried <code>marks: (\"[\",\"]\")</code> with no success!<br>\nIs this achievable through fletcher or even another method?</p>",
      "raw": "The goal is to draw simple diagrams to visualize different kinds of intervals on the number line, is it possible to define simple custom marks for fletcher arrows like shown below?:\n\n```typ\n#diagram($ a edge(\"[-]\") & b $) // or ]-[ , [-[ , (-) and so on\n```\n\nI tried `marks: (\"[\",\"]\")` with no success!\nIs this achievable through fletcher or even another method?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 19,
      "score": 98.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1455
    },
    {
      "id": 12252,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T12:43:52.116Z",
      "updated_at": "2025-05-11T12:44:20.025Z",
      "cooked": "<p>It’s all documented in <a href=\"https://github.com/Jollywatt/typst-fletcher/blob/master/docs/manual.pdf?raw=true\">the manual</a>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/fletcher:0.5.7\" as fletcher: *\n#fletcher.MARKS.update(m =&gt; {\n  let new-marks = (\n    \"]\": (\n      size: 5,\n      dir: ltr,\n      draw: mark =&gt; draw.line(\n        (-mark.size, mark.size),\n        (0, mark.size),\n        (0, -mark.size),\n        (-mark.size, -mark.size),\n        fill: none,\n      ),\n    ),\n    \"[\": (inherit: \"]\"),\n    \")\": (\n      size: 5,\n      dir: ltr,\n      draw: mark =&gt; draw.arc(\n        (0, 0),\n        start: -90deg,\n        stop: 90deg,\n        radius: mark.size,\n        fill: none,\n        anchor: \"origin\",\n      ),\n    ),\n    \"(\": (inherit: \")\"),\n  )\n  m + new-marks\n})\n\n#diagram({\n  node((0, 0))[$a$]\n  edge(\"[-]\")\n  node((1, 0))[$b$]\n\n  node((0, 1))[$a$]\n  edge(\"(-)\")\n  node((1, 1))[$b$]\n})\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/2/2758c171da5208ec000aca851712d28882682580.png\" alt=\"image\" data-base62-sha1=\"5C4Mk9AWmw9nomUXp4vjY4uAeY0\" width=\"136\" height=\"143\"></p>",
      "raw": "It's all documented in [the manual](https://github.com/Jollywatt/typst-fletcher/blob/master/docs/manual.pdf?raw=true).\n\n```typ\n#import \"@preview/fletcher:0.5.7\" as fletcher: *\n#fletcher.MARKS.update(m => {\n  let new-marks = (\n    \"]\": (\n      size: 5,\n      dir: ltr,\n      draw: mark => draw.line(\n        (-mark.size, mark.size),\n        (0, mark.size),\n        (0, -mark.size),\n        (-mark.size, -mark.size),\n        fill: none,\n      ),\n    ),\n    \"[\": (inherit: \"]\"),\n    \")\": (\n      size: 5,\n      dir: ltr,\n      draw: mark => draw.arc(\n        (0, 0),\n        start: -90deg,\n        stop: 90deg,\n        radius: mark.size,\n        fill: none,\n        anchor: \"origin\",\n      ),\n    ),\n    \"(\": (inherit: \")\"),\n  )\n  m + new-marks\n})\n\n#diagram({\n  node((0, 0))[$a$]\n  edge(\"[-]\")\n  node((1, 0))[$b$]\n\n  node((0, 1))[$a$]\n  edge(\"(-)\")\n  node((1, 1))[$b$]\n})\n```\n\n![image|182x191, 75%](upload://5C4Mk9AWmw9nomUXp4vjY4uAeY0.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 17,
      "score": 38.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12255,
      "post_number": 3,
      "username": "Jollywatt",
      "name": "Joseph Wilson",
      "created_at": "2025-05-11T13:09:57.133Z",
      "updated_at": "2025-05-11T13:17:06.545Z",
      "cooked": "<p>This is great. Here’s a slight tweak ensuring the correct use of the <code>rev</code> mark property, and using the <code>tip/tail-origin/end</code> properties to make the alignments look right:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/fletcher:0.5.7\" as fletcher: diagram, node, edge\n#fletcher.MARKS.update(m =&gt; {\n  import fletcher.cetz.draw\n  m + (\n    \"]\": (\n      rev: false,\n      size: 6,\n      depth: 3,\n      draw: mark =&gt; draw.line(\n        (-mark.depth, mark.size),\n        (0, mark.size),\n        (0, -mark.size),\n        (-mark.depth, -mark.size),\n        fill: none,\n      ),\n      tail-origin: mark =&gt; -mark.depth,\n    ),\n    \"[\": (inherit: \"]\", rev: true),\n    \")\": (\n      rev: false,\n      size: 8,\n      angle: 50deg,\n      draw: mark =&gt; draw.arc(\n        (0, 0),\n        start: -mark.angle,\n        stop: mark.angle,\n        radius: mark.size,\n        fill: none,\n        anchor: \"origin\",\n      ),\n      tail-end: mark =&gt; mark.size,\n      tip-end: mark =&gt; mark.size,\n      tip-origin: mark =&gt; mark.size,\n      tail-origin: mark =&gt; mark.size*calc.cos(mark.angle),\n    ),\n    \"(\": (inherit: \")\", rev: true),\n  )\n})\n\n#diagram(spacing: (20mm, 5mm), $\n  a edge(\"[-]\") &amp; b edge(\"(-)\") &amp; c \\\n  a edge(\"]-[\") &amp; b edge(\")-(\") &amp; c \\\n$)\n\n#table(\n  columns: 2,\n  fletcher.mark-debug(\"(\"),\n  fletcher.mark-demo(\"(\"),\n  fletcher.mark-debug(\"[\"),\n  fletcher.mark-demo(\"[\"),\n)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/7/76d10f420f3a9d8e5027086a8549244ae824014f.png\" data-download-href=\"https://forum.typst.app/uploads/default/76d10f420f3a9d8e5027086a8549244ae824014f\" title=\"Screenshot 2025-05-11 at 14.16.56\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/7/76d10f420f3a9d8e5027086a8549244ae824014f_2_399x500.png\" alt=\"Screenshot 2025-05-11 at 14.16.56\" data-base62-sha1=\"gX6ftD9lBP1Wf8IIOYIqSrRI34X\" width=\"399\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/7/76d10f420f3a9d8e5027086a8549244ae824014f_2_399x500.png, https://forum.typst.app/uploads/default/optimized/2X/7/76d10f420f3a9d8e5027086a8549244ae824014f_2_598x750.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/7/76d10f420f3a9d8e5027086a8549244ae824014f_2_798x1000.png 2x\" data-dominant-color=\"EDEDEC\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2025-05-11 at 14.16.56</span><span class=\"informations\">1158×1448 86.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "This is great. Here's a slight tweak ensuring the correct use of the `rev` mark property, and using the `tip/tail-origin/end` properties to make the alignments look right:\n```typ\n#import \"@preview/fletcher:0.5.7\" as fletcher: diagram, node, edge\n#fletcher.MARKS.update(m => {\n  import fletcher.cetz.draw\n  m + (\n    \"]\": (\n      rev: false,\n      size: 6,\n      depth: 3,\n      draw: mark => draw.line(\n        (-mark.depth, mark.size),\n        (0, mark.size),\n        (0, -mark.size),\n        (-mark.depth, -mark.size),\n        fill: none,\n      ),\n      tail-origin: mark => -mark.depth,\n    ),\n    \"[\": (inherit: \"]\", rev: true),\n    \")\": (\n      rev: false,\n      size: 8,\n      angle: 50deg,\n      draw: mark => draw.arc(\n        (0, 0),\n        start: -mark.angle,\n        stop: mark.angle,\n        radius: mark.size,\n        fill: none,\n        anchor: \"origin\",\n      ),\n      tail-end: mark => mark.size,\n      tip-end: mark => mark.size,\n      tip-origin: mark => mark.size,\n      tail-origin: mark => mark.size*calc.cos(mark.angle),\n    ),\n    \"(\": (inherit: \")\", rev: true),\n  )\n})\n\n#diagram(spacing: (20mm, 5mm), $\n  a edge(\"[-]\") & b edge(\"(-)\") & c \\\n  a edge(\"]-[\") & b edge(\")-(\") & c \\\n$)\n\n#table(\n  columns: 2,\n  fletcher.mark-debug(\"(\"),\n  fletcher.mark-demo(\"(\"),\n  fletcher.mark-debug(\"[\"),\n  fletcher.mark-demo(\"[\"),\n)\n```\n\n![Screenshot 2025-05-11 at 14.16.56|399x500](upload://gX6ftD9lBP1Wf8IIOYIqSrRI34X.png)",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 16,
      "score": 53.2,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 713
    },
    {
      "id": 12257,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T13:11:55.053Z",
      "updated_at": "2025-05-11T13:14:54.013Z",
      "cooked": "<p>Yeah, I wanted to ask why it auto-reverses anyway? I wanted to pass something similar, but since it does it automatically anyway, I just straight up inherited those so that it doesn’t panic.</p>\n<p>Is <code>rev</code> built-in property that is somehow being auto-enabled for one shorthand and not enabled for the other? Like auto-mirror or something.</p>",
      "raw": "Yeah, I wanted to ask why it auto-reverses anyway? I wanted to pass something similar, but since it does it automatically anyway, I just straight up inherited those so that it doesn't panic.\n\nIs `rev` built-in property that is somehow being auto-enabled for one shorthand and not enabled for the other? Like auto-mirror or something.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 3.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12259,
      "post_number": 5,
      "username": "MJ.0",
      "name": "MJ",
      "created_at": "2025-05-11T13:18:37.867Z",
      "updated_at": "2025-05-11T13:20:02.675Z",
      "cooked": "<p>Thank you both for the detailed answers. I tried to mark them both as answers XD.</p>\n<p>I was generally aware of the method both of you used to use custom mark, but found it a bit more nuanced that I could chew at first glance, so I came checking if there was a simpler way to do it before having to tackle the proper way. your example helped me understand the process.</p>\n<p>and maybe even these marks could make it in the standard fletcher marks collection sometime in the future as they seem common enough!</p>",
      "raw": "Thank you both for the detailed answers. I tried to mark them both as answers XD.\n\nI was generally aware of the method both of you used to use custom mark, but found it a bit more nuanced that I could chew at first glance, so I came checking if there was a simpler way to do it before having to tackle the proper way. your example helped me understand the process.\n\nand maybe even these marks could make it in the standard fletcher marks collection sometime in the future as they seem common enough!",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 16,
      "score": 33.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1455
    },
    {
      "id": 12260,
      "post_number": 6,
      "username": "Jollywatt",
      "name": "Joseph Wilson",
      "created_at": "2025-05-11T13:22:13.900Z",
      "updated_at": "2025-05-11T13:22:13.900Z",
      "cooked": "<p>Agreed! Feel free to add a feature request or PR at <a href=\"https://github.com/Jollywatt/typst-fletcher/issues\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">GitHub · Where software is built</a> — it would get added pretty quickly.</p>",
      "raw": "Agreed! Feel free to add a feature request or PR at https://github.com/Jollywatt/typst-fletcher/issues — it would get added pretty quickly.",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 16,
      "score": 28.2,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 713
    },
    {
      "id": 12263,
      "post_number": 7,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T13:36:45.439Z",
      "updated_at": "2025-05-11T13:36:45.439Z",
      "cooked": "<aside class=\"onebox githubpullrequest\" data-onebox-src=\"https://github.com/Jollywatt/typst-fletcher/pull/103\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/Jollywatt/typst-fletcher/pull/103\" target=\"_blank\" rel=\"noopener\">github.com/Jollywatt/typst-fletcher</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"github-row\" data-github-private-repo=\"false\">\n\n\n\n    <div class=\"github-icon-container\" title=\"Pull Request\">\n      <svg width=\"60\" height=\"60\" class=\"github-icon\" viewBox=\"0 0 12 16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z\"></path></svg>\n    </div>\n\n  <div class=\"github-info-container\">\n\n\n\n      <h4>\n        <a href=\"https://github.com/Jollywatt/typst-fletcher/pull/103\" target=\"_blank\" rel=\"noopener\">feat: add `bracket` and `parenthesis` marks</a>\n      </h4>\n\n    <div class=\"branches\">\n      <code>Jollywatt:master</code> ← <code>Andrew15-5:bracket-parenthesis-marks</code>\n    </div>\n\n      <div class=\"github-info\">\n        <div class=\"date\">\n          opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2025-05-11\" data-time=\"13:36:33\" data-timezone=\"UTC\">01:36PM - 11 May 25 UTC</span>\n        </div>\n\n        <div class=\"user\">\n          <a href=\"https://github.com/Andrew15-5\" target=\"_blank\" rel=\"noopener\">\n            <img alt=\"Andrew15-5\" src=\"https://forum.typst.app/uploads/default/original/1X/8c66fc8b1c207ba90488266df18b206a61b1fc49.png\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\" data-dominant-color=\"707C3A\">\n            Andrew15-5\n          </a>\n        </div>\n\n        <div class=\"lines\" title=\"1 commits changed 1 files with 37 additions and 0 deletions\">\n          <a href=\"https://github.com/Jollywatt/typst-fletcher/pull/103/files\" target=\"_blank\" rel=\"noopener\">\n            <span class=\"added\">+37</span>\n            <span class=\"removed\">-0</span>\n          </a>\n        </div>\n      </div>\n  </div>\n</div>\n\n  <div class=\"github-row\">\n    <p class=\"github-body-container\">See https://forum.typst.app/t/4022/6.</p>\n  </div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "https://github.com/Jollywatt/typst-fletcher/pull/103",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 16,
      "score": 18.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:48:03.846507"
}
{
  "topic_metadata": {
    "id": 4024,
    "title": "How to do delete outline prefix number",
    "slug": "how-to-do-delete-outline-prefix-number",
    "posts_count": 2,
    "created_at": "2025-05-11T11:37:13.403Z",
    "last_posted_at": "2025-05-11T11:44:06.648Z",
    "views": 48,
    "like_count": 3,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "layout",
      "outline",
      "numbering"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 148
  },
  "posts": [
    {
      "id": 12248,
      "post_number": 1,
      "username": "HuangMI",
      "name": "HuangMI",
      "created_at": "2025-05-11T11:37:13.507Z",
      "updated_at": "2025-05-14T06:35:02.159Z",
      "cooked": "<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#outline(title: \"\")\n#set heading(numbering: \"1.1\")\n= 第一章\n\n== 正数和负数\n== 正数和负数\n\n= 第二章\n\n== 正数和负数\n== 正数和负数\n=== 正数和负数\n==== 正数和负数\n\n= 第三章\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/4/436b0d59247d0c4542cae0cede9fa9c3b0bc5ab5.png\" data-download-href=\"https://forum.typst.app/uploads/default/436b0d59247d0c4542cae0cede9fa9c3b0bc5ab5\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/4/436b0d59247d0c4542cae0cede9fa9c3b0bc5ab5_2_653x500.png\" alt=\"image\" data-base62-sha1=\"9CplCj6q6KSQuY1pFP16SeDkojH\" width=\"653\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/4/436b0d59247d0c4542cae0cede9fa9c3b0bc5ab5_2_653x500.png, https://forum.typst.app/uploads/default/original/2X/4/436b0d59247d0c4542cae0cede9fa9c3b0bc5ab5.png 1.5x, https://forum.typst.app/uploads/default/original/2X/4/436b0d59247d0c4542cae0cede9fa9c3b0bc5ab5.png 2x\" data-dominant-color=\"F2F1F1\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">960×735 61.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "```typ\n#outline(title: \"\")\n#set heading(numbering: \"1.1\")\n= 第一章\n\n== 正数和负数\n== 正数和负数\n\n= 第二章\n\n== 正数和负数\n== 正数和负数\n=== 正数和负数\n==== 正数和负数\n\n= 第三章\n```\n\n![image|653x500](upload://9CplCj6q6KSQuY1pFP16SeDkojH.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 30.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1479
    },
    {
      "id": 12249,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T11:44:06.648Z",
      "updated_at": "2025-05-12T04:10:48.945Z",
      "cooked": "<p>With the new helper functions, you can just skip <code>it.prefix()</code>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show outline.entry: it =&gt; {\n  link(it.element.location(), it.indented(none, it.inner()))\n}\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/b/bfb65f3fdbe7534a0b161699352333a6a08f037f.png\" alt=\"image\" data-base62-sha1=\"rlXVuc3aZrZRtvcqNImQOHN4GIv\" width=\"605\" height=\"190\"></p>\n<p>Also, <code>#outline(title: \"\")</code> is not the same as <code>#outline(title: none)</code>. If you don’t need title, then use <code>none</code>, otherwise it will be present with no text. You can also use <code>set text(lang: \"zh\")</code> many things to be localized to Chinese.</p>\n<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/docs/reference/model/outline/#definitions-entry-definitions-indented\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/docs/reference/model/outline/#definitions-entry-definitions-indented\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/docs/reference/model/outline/#definitions-entry-definitions-indented\" target=\"_blank\" rel=\"noopener\">Outline Function – Typst Documentation</a></h3>\n\n  <p>Documentation for the `outline` function.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<hr>\n<p>If you need to remove just top-level numbers:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show outline.entry: it =&gt; {\n  let prefix = if it.element.func() != heading or it.element.level != 1 {\n    it.prefix()\n  }\n  link(it.element.location(), it.indented(prefix, it.inner()))\n}\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/5/5bc36c9fcdc169413fc6a957ebcb0f2966e8f79e.png\" alt=\"image\" data-base62-sha1=\"d5M8XlzbTRFeFURTiQWwqDRSbtI\" width=\"592\" height=\"185\"></p>",
      "raw": "With the new helper functions, you can just skip `it.prefix()`:\n\n```typ\n#show outline.entry: it => {\n  link(it.element.location(), it.indented(none, it.inner()))\n}\n```\n\n![image|605x190](upload://rlXVuc3aZrZRtvcqNImQOHN4GIv.png)\n\n\nAlso, `#outline(title: \"\")` is not the same as `#outline(title: none)`. If you don't need title, then use `none`, otherwise it will be present with no text. You can also use `set text(lang: \"zh\")` many things to be localized to Chinese.\n\nhttps://typst.app/docs/reference/model/outline/#definitions-entry-definitions-indented\n\n---\n\nIf you need to remove just top-level numbers:\n\n```typ\n#show outline.entry: it => {\n  let prefix = if it.element.func() != heading or it.element.level != 1 {\n    it.prefix()\n  }\n  link(it.element.location(), it.indented(prefix, it.inner()))\n}\n```\n\n![image|592x185](upload://d5M8XlzbTRFeFURTiQWwqDRSbtI.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 3,
      "reads": 26,
      "score": 60.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:48:03.095134"
}
{
  "topic_metadata": {
    "id": 4026,
    "title": "Can you merge 2 zeros from 2 axis in Lilaq?",
    "slug": "can-you-merge-2-zeros-from-2-axis-in-lilaq",
    "posts_count": 15,
    "created_at": "2025-05-11T12:52:41.243Z",
    "last_posted_at": "2025-05-11T20:07:45.043Z",
    "views": 78,
    "like_count": 5,
    "reply_count": 13,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 12,
    "accepted_answer_username": "Mc-Zen",
    "tags": [
      "lilaq"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 1059
  },
  "posts": [
    {
      "id": 12253,
      "post_number": 1,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T12:52:41.503Z",
      "updated_at": "2025-05-11T12:52:41.503Z",
      "cooked": "<p>From <a href=\"https://forum.typst.app/t/how-to-reproduce-an-image-in-typst/4018/7\" class=\"inline-onebox\">How to Reproduce an Image in Typst? - #7 by Andrew</a>, I thought I can do <code>shared-zero</code> from CeTZ, but I can’t find such option. Does it exist?</p>",
      "raw": "From https://forum.typst.app/t/how-to-reproduce-an-image-in-typst/4018/7?u=andrew, I thought I can do `shared-zero` from CeTZ, but I can't find such option. Does it exist?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 30.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12258,
      "post_number": 2,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2025-05-11T13:14:24.733Z",
      "updated_at": "2025-05-11T13:14:24.733Z",
      "cooked": "<p>No, there is no such option but you can install a tick filter for the y axis to remove the 0 tick. This should result exactly in the looks of the initial figure from that blog post.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#lq.diagram(\n  yaxis: (filter: (value, _) =&gt; value != 0)\n)\n</code></pre>\n<p>This is explained in <a href=\"https://lilaq.org/docs/tutorials/axis#arrows-and-schoolbook-styles\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Axis configuration − Lilaq</a>.</p>",
      "raw": "No, there is no such option but you can install a tick filter for the y axis to remove the 0 tick. This should result exactly in the looks of the initial figure from that blog post. \n\n```typ\n#lq.diagram(\n  yaxis: (filter: (value, _) => value != 0)\n)\n```\n\nThis is explained in https://lilaq.org/docs/tutorials/axis#arrows-and-schoolbook-styles.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 28,
      "score": 40.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    },
    {
      "id": 12266,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T14:04:57.637Z",
      "updated_at": "2025-05-11T14:04:57.637Z",
      "cooked": "<p>Okay, but can I then offset this one label to the left so that it looks like a merged zero?</p>",
      "raw": "Okay, but can I then offset this one label to the left so that it looks like a merged zero?",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 10.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12270,
      "post_number": 4,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2025-05-11T16:24:16.802Z",
      "updated_at": "2025-05-11T16:24:16.802Z",
      "cooked": "<p>In this case I suggest omitting both zeros and using <a href=\"https://lilaq.org/docs/reference/place\" rel=\"noopener nofollow ugc\">place − Lilaq</a> to manually add a 0 at the position of your liking.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#lq.diagram(\n  xaxis: (filter: (value, _) =&gt; value != 0),\n  yaxis: (filter: (value, _) =&gt; value != 0),\n  lq.place(\n    0, 0, move(dx: -.75em, dy: .75em)[$0$]\n  )\n)\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/f/ffab07241c007e6b71a013fe443dec453b577e3d.png\" alt=\"image\" data-base62-sha1=\"AtKbbZvym5auSEYXhWaH038asep\" width=\"374\" height=\"247\"></p>\n<p>With <code>show tick.where(value: 0): move(dx: 1em)</code> this will one day be easy with user-defined types.</p>",
      "raw": "In this case I suggest omitting both zeros and using [place − Lilaq](https://lilaq.org/docs/reference/place) to manually add a 0 at the position of your liking. \n\n```typ\n#lq.diagram(\n  xaxis: (filter: (value, _) => value != 0),\n  yaxis: (filter: (value, _) => value != 0),\n  lq.place(\n    0, 0, move(dx: -.75em, dy: .75em)[$0$]\n  )\n)\n```\n![image|499x330, 75%](upload://AtKbbZvym5auSEYXhWaH038asep.png)\n\n\nWith `show tick.where(value: 0): move(dx: 1em)` this will one day be easy with user-defined types.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 9.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    },
    {
      "id": 12277,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T17:29:31.028Z",
      "updated_at": "2025-05-11T19:58:24.209Z",
      "cooked": "<p>Hmm. While this works</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/lilaq:0.2.0\" as lq\n\n#let omit-zero = (filter: (v, _) =&gt; v != 0)\n#let shared-zero = {\n  lq.place(0, 0, align: top + right, move(dx: -0.5em, dy: 0.5em)[$0$])\n}\n\n#let y-max = 400\n#let x-max = 640\n#lq.diagram(\n  ylim: (0, y-max),\n  xlim: (0, x-max),\n  yaxis: (ticks: range(y-max + 1, step: 80), subticks: 1, ..omit-zero),\n  xaxis: (ticks: range(x-max + 1, step: 80), subticks: 1, ..omit-zero),\n  grid: (stroke: black, stroke-sub: 0.5pt),\n  shared-zero,\n)\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/a/ae077aaa22b07b227e2c3ae2a1488ed98a0affc7.png\" alt=\"image\" data-base62-sha1=\"oPx6rjReEC4lQJeBVuqc8CaJRiv\" width=\"243\" height=\"162\"></p>\n<p>I wanted to get a single variable that will do both things and just spread it. But for that you need to fold the axis dictionaries. Is there some way to do that?</p>",
      "raw": "Hmm. While this works\n\n```typ\n#import \"@preview/lilaq:0.2.0\" as lq\n\n#let omit-zero = (filter: (v, _) => v != 0)\n#let shared-zero = {\n  lq.place(0, 0, align: top + right, move(dx: -0.5em, dy: 0.5em)[$0$])\n}\n\n#let y-max = 400\n#let x-max = 640\n#lq.diagram(\n  ylim: (0, y-max),\n  xlim: (0, x-max),\n  yaxis: (ticks: range(y-max + 1, step: 80), subticks: 1, ..omit-zero),\n  xaxis: (ticks: range(x-max + 1, step: 80), subticks: 1, ..omit-zero),\n  grid: (stroke: black, stroke-sub: 0.5pt),\n  shared-zero,\n)\n```\n\n![image|487x325, 50%](upload://oPx6rjReEC4lQJeBVuqc8CaJRiv.png)\n\nI wanted to get a single variable that will do both things and just spread it. But for that you need to fold the axis dictionaries. Is there some way to do that?",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 9.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12279,
      "post_number": 6,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2025-05-11T17:38:20.518Z",
      "updated_at": "2025-05-11T17:38:20.518Z",
      "cooked": "<p>Do you mean</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let shared-zero = arguments(\n  xaxis: (..),\n  yaxis: (..),\n  lq.place(0, 0, align: top + right, move(dx: -0.5em, dy: 0.5em)[$0$])\n)\n\n#lq.diagram(\n  ..shared-zero\n)\n</code></pre>",
      "raw": "Do you mean \n```typ\n#let shared-zero = arguments(\n  xaxis: (..),\n  yaxis: (..),\n  lq.place(0, 0, align: top + right, move(dx: -0.5em, dy: 0.5em)[$0$])\n)\n\n#lq.diagram(\n  ..shared-zero\n)\n```",
      "reply_to_post_number": 5,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 14.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    },
    {
      "id": 12280,
      "post_number": 7,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2025-05-11T17:41:21.396Z",
      "updated_at": "2025-05-11T17:41:21.396Z",
      "cooked": "<p>By the way: I believe one always needs to embrace the utilized medium to some amount. With handwritten notes for example you can do different things than with a computer. One is easily tempted to copy habits from one medium to another but it is also appropriate to adapt style to what’s given.</p>\n<p>An example are arrows on top of variables for denoting vectors. They are pretty and work well when handwritten but in print, it just works better to use bold, upright letters in most cases (LaTeX for example is notoriously bad with vector arrows, they’re always clashing with parentheses and stuff).</p>\n<p>Omitting zeros is a thing that often needs manual tailoring and as soon as the two axes don’t start exactly at zero, it gets awkward.</p>\n<p>This is a matter of taste of course and I’m not here to teach style − quite the contrary I’m very happy to battle-test Lilaq for possible features − but in this case I don’t necessarily think that the two zeros look bad (if you want my opinion). In <a href=\"https://forum.typst.app/t/how-to-reproduce-a-stress-diagram-image-in-typst/4018\">How to reproduce a stress diagram image in Typst? - Questions - Typst Forum</a>, it btw looks like the 0 is the regular one from the x-axis and just the one from the y-axis is missing.</p>",
      "raw": "\nBy the way: I believe one always needs to embrace the utilized medium to some amount. With handwritten notes for example you can do different things than with a computer. One is easily tempted to copy habits from one medium to another but it is also appropriate to adapt style to what's given. \n\nAn example are arrows on top of variables for denoting vectors. They are pretty and work well when handwritten but in print, it just works better to use bold, upright letters in most cases (LaTeX for example is notoriously bad with vector arrows, they're always clashing with parentheses and stuff). \n\nOmitting zeros is a thing that often needs manual tailoring and as soon as the two axes don't start exactly at zero, it gets awkward. \n\nThis is a matter of taste of course and I'm not here to teach style − quite the contrary I'm very happy to battle-test Lilaq for possible features − but in this case I don't necessarily think that the two zeros look bad (if you want my opinion). In [How to reproduce a stress diagram image in Typst? - Questions - Typst Forum](https://forum.typst.app/t/how-to-reproduce-a-stress-diagram-image-in-typst/4018), it btw looks like the 0 is the regular one from the x-axis and just the one from the y-axis is missing.",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 19,
      "score": 23.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    },
    {
      "id": 12283,
      "post_number": 8,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T18:17:00.707Z",
      "updated_at": "2025-05-11T18:17:00.707Z",
      "cooked": "<p>Yes, but with folding magic.</p>",
      "raw": "Yes, but with folding magic.",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12284,
      "post_number": 9,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T18:17:44.948Z",
      "updated_at": "2025-05-11T18:17:44.948Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Mc-Zen\" data-post=\"7\" data-topic=\"4026\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/mc-zen/48/234_2.png\" class=\"avatar\"> Mc-Zen:</div>\n<blockquote>\n<p>In <a href=\"https://forum.typst.app/t/how-to-reproduce-a-stress-diagram-image-in-typst/4018\">How to reproduce a stress diagram image in Typst? - Questions - Typst Forum </a>, it btw looks like the 0 is the regular one from the x-axis and just the one from the y-axis is missing.</p>\n</blockquote>\n</aside>\n<p>There is no space for Y axis zero regardless.</p>",
      "raw": "[quote=\"Mc-Zen, post:7, topic:4026\"]\nIn [How to reproduce a stress diagram image in Typst? - Questions - Typst Forum ](https://forum.typst.app/t/how-to-reproduce-a-stress-diagram-image-in-typst/4018), it btw looks like the 0 is the regular one from the x-axis and just the one from the y-axis is missing.\n[/quote]\n\nThere is no space for Y axis zero regardless.",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 19,
      "score": 3.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12286,
      "post_number": 10,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2025-05-11T18:53:51.557Z",
      "updated_at": "2025-05-11T18:53:51.557Z",
      "cooked": "<p>What do you mean by “folding the axis dictionaries”?</p>",
      "raw": "What do you mean by \"folding the axis dictionaries\"?",
      "reply_to_post_number": 8,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    },
    {
      "id": 12288,
      "post_number": 11,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T19:05:56.326Z",
      "updated_at": "2025-05-11T19:05:56.326Z",
      "cooked": "<p>I have <code>(ticks: range(x-max + 1, step: 80), subticks: 1)</code> and I need to merge it with <code>(filter: ...)</code>. But you can’t do this all in one sweep without some trick.</p>\n<p>I guess the only solution would be to pass axis settings to a function that will add shared zero stuff. But semantically, this doesn’t make sense.</p>",
      "raw": "I have `(ticks: range(x-max + 1, step: 80), subticks: 1)` and I need to merge it with `(filter: ...)`. But you can't do this all in one sweep without some trick.\n\nI guess the only solution would be to pass axis settings to a function that will add shared zero stuff. But semantically, this doesn't make sense.",
      "reply_to_post_number": 10,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12292,
      "post_number": 12,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2025-05-11T19:32:07.583Z",
      "updated_at": "2025-05-11T19:32:07.583Z",
      "cooked": "<p>Ah, so you want to separate the “share the zero” from “display these particular ticks”. How about:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show: lq.set-diagram(\n  xaxis: (filter: (value, _) =&gt; value != 0),\n  yaxis: (filter: (value, _) =&gt; value != 0)\n)\n\n#let shared-zero = {\n  lq.place(0, 0, align: top + right, move(dx: -0.5em, dy: 0.5em)[$0$])\n}\n\n#lq.diagram(\n  ylim: (0, 400),\n  xlim: (0, 640),\n  xaxis: (tick-distance: 80, subticks: 1),\n  yaxis: (tick-distance: 80, subticks: 1),\n  shared-zero,\n)\n</code></pre>\n<p>Different to cetz-plot, the property <code>axis.ticks</code> should only be used as a last resort since this approach does not react to changes in the data − there are many ways to deal with this in other ways like <code>axis.tick-distance</code> or passing something like <code>(density: 80%)</code> to <code>axis.tick-args</code>.</p>\n<p>But I know, the ticking tutorial has not been written yet and so there is no proper guide on these matters currently …</p>",
      "raw": "Ah, so you want to separate the \"share the zero\" from \"display these particular ticks\". How about:\n```typ\n#show: lq.set-diagram(\n  xaxis: (filter: (value, _) => value != 0),\n  yaxis: (filter: (value, _) => value != 0)\n)\n\n#let shared-zero = {\n  lq.place(0, 0, align: top + right, move(dx: -0.5em, dy: 0.5em)[$0$])\n}\n\n#lq.diagram(\n  ylim: (0, 400),\n  xlim: (0, 640),\n  xaxis: (tick-distance: 80, subticks: 1),\n  yaxis: (tick-distance: 80, subticks: 1),\n  shared-zero,\n)\n```\nDifferent to cetz-plot, the property `axis.ticks` should only be used as a last resort since this approach does not react to changes in the data − there are many ways to deal with this in other ways like `axis.tick-distance` or passing something like `(density: 80%)` to `axis.tick-args`. \n\nBut I know, the ticking tutorial has not been written yet and so there is no proper guide on these matters currently ...",
      "reply_to_post_number": 11,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 16,
      "score": 23.2,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 9
    },
    {
      "id": 12297,
      "post_number": 13,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T19:57:23.597Z",
      "updated_at": "2025-05-11T19:57:23.597Z",
      "cooked": "<p>Oh… set rules… I guess this works. They should fold everything correctly, because I remember how <a class=\"mention\" href=\"/u/pgbiel\">@PgBiel</a> worked on this.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/lilaq:0.2.0\" as lq\n\n#let omit-zero = (filter: (v, _) =&gt; v != 0)\n#let shared-zero = {\n  lq.place(0, 0, align: top + right, move(dx: -0.5em, dy: 0.5em)[$0$])\n}\n\n#show: lq.set-diagram(yaxis: omit-zero, xaxis: omit-zero)\n\n#lq.diagram(\n  ylim: (0, 400),\n  xlim: (0, 640),\n  yaxis: (tick-distance: 80, subticks: 1),\n  xaxis: (tick-distance: 80, subticks: 1),\n  grid: (stroke: black, stroke-sub: 0.5pt),\n  shared-zero,\n)\n</code></pre>\n<p>This looks… pretty damn good. I just need to get used to this set rules stuff. Some things here, other things there.</p>",
      "raw": "Oh... set rules... I guess this works. They should fold everything correctly, because I remember how @PgBiel worked on this.\n\n```typ\n#import \"@preview/lilaq:0.2.0\" as lq\n\n#let omit-zero = (filter: (v, _) => v != 0)\n#let shared-zero = {\n  lq.place(0, 0, align: top + right, move(dx: -0.5em, dy: 0.5em)[$0$])\n}\n\n#show: lq.set-diagram(yaxis: omit-zero, xaxis: omit-zero)\n\n#lq.diagram(\n  ylim: (0, 400),\n  xlim: (0, 640),\n  yaxis: (tick-distance: 80, subticks: 1),\n  xaxis: (tick-distance: 80, subticks: 1),\n  grid: (stroke: black, stroke-sub: 0.5pt),\n  shared-zero,\n)\n```\n\nThis looks... pretty damn good. I just need to get used to this set rules stuff. Some things here, other things there.",
      "reply_to_post_number": 12,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 8.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12302,
      "post_number": 14,
      "username": "Mc-Zen",
      "name": "Mc-Zen",
      "created_at": "2025-05-11T20:05:14.931Z",
      "updated_at": "2025-05-11T20:05:41.916Z",
      "cooked": "<p>Yep :) you can even configure the grid through a set rule:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show: lq.set-grid(stroke: black, stroke-sub: 0.5pt)\n</code></pre>\n<p>Could be one that’s worth it. I’ve just no idea how to bring the <code>shared-zero</code> in without doing it manually. But still, it’s not too bad now.</p>",
      "raw": "Yep :) you can even configure the grid through a set rule:\n\n```typ\n#show: lq.set-grid(stroke: black, stroke-sub: 0.5pt)\n```\nCould be one that's worth it. I've just no idea how to bring the `shared-zero` in without doing it manually. But still, it's not too bad now.",
      "reply_to_post_number": 13,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 8.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 9
    },
    {
      "id": 12303,
      "post_number": 15,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-11T20:07:45.043Z",
      "updated_at": "2025-05-11T20:07:45.043Z",
      "cooked": "<p>I know, I already used it in one of our other million threads today.</p>",
      "raw": "I know, I already used it in one of our other million threads today.",
      "reply_to_post_number": 14,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 18.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:48:02.396203"
}
